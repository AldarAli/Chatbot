Characterization of Real Internet Paths by Means of Packet Loss Analysis
Luis Sequeira, Juli´an Fern´andez-Navajas, Jose Saldana
Communications Technology Group (GTC)-Arag´on Inst. of Engeneering Research (I3A)
Dpt. IEC. Ada Byron Building. EINA Univ. Zaragoza
Zaragoza, Spain
Email: {sequeira, navajas, jsaldana}@unizar.es
Abstract—The behaviour of the routers’ buffer may affect the
Quality of Service (QoS) of network services under certain
conditions, since it may modify some trafﬁc characteristics, as
delay or jitter, and may also drop packets. As a consequence,
the characterization of the buffer is interesting, especially when
multimedia ﬂows are transmitted and even more if they transport
information with real-time requirements. This work presents a
packet loss analysis with the aim of determining the technical and
functional characteristics of the real buffers (as, e.g., behaviour,
size, limits, input and output rate) of a network path. An im-
proved methodology is considered in which two different buffers
are concatenated. It permits the estimation of some parameters
of the intermediate buffers (size, input and output rate) in a
network path including different devices across the Internet. The
method presented in this paper permits the characterization of
commercial router buffer by means of the analysis of the dropped
packets in the buffer.
Keywords-Buffer size; queueing; unattended measurements.
I.
INTRODUCTION
The number of users of multimedia services (e.g., video-
conferencing and Voice over IP, VoIP) grows every day and
they generate an increasingly signiﬁcant amount of trafﬁc over
the Internet. At the same time, users demand a good experience
with these services. In this context, Internet Service Providers
(ISP’s) have to grant a high performance network with a certain
degree of Quality of Service (QoS), especially when the access
networks have to support to real-time applications.
Traditionally, the available bandwidth between two end-
to-end devices has been used as a parameter that can give a
rough idea of the expected quality. But nowadays, we know
that QoS is also affected by the behaviour of the intermediate
buffers, which is mainly determined by their size and their
management policies. As it was observed in [1], the policies
implemented by the router buffer may cause different packet
loss behaviour, and may also modify the quality of the service
(VoIP in that case, measured in terms of R-factor, Transmission
Rating Factor). The inﬂuence of the router buffer on another
real-time service (i.e., an online game) was studied in [2],
showing the mutual relationship between the size and policies
of the buffer, and the obtained subjective quality, which mainly
depends on delay and jitter in this case. The results show
that small buffers present better characteristics for maintaining
delay and jitter in adequate levels, at the cost of increasing
packet loss. In addition, buffers whose size is measured in
packets also increase packets loss.
Many access network devices are designed for big packets,
typical of services requiring bulk data transfers [3], such as e-
mail, web browsing or File Transfer Protocol (FTP). However,
other applications (e.g., P2P (Peer to Peer) video streaming,
online games, etc.) generate high rates of small packets, so the
routers may experience problems to manage this trafﬁc, since
their processing capacity can become a bottleneck if they have
to manage too many packets per second [4]. Finally, in P2P-
TV services, the generation of high rates of small packets [5]
may penalize the video packets and consequently the peer’s
behaviour within a P2P structure may not be as expected.
As a consequence of the increase of the amount of small
packets generated by emerging services, certain network points
may become critical bottlenecks, mainly in access networks. In
addition, bottlenecks may also appear at critical points of high-
performance networks, being the discarding in router queues
the main cause of packet loss. So, the design characteristics
of router buffers and the implemented scheduling policies, are
of primary importance in order to ensure the correct delivery
of the trafﬁc of different applications and services.
Buffers are used as a trafﬁc regulation mechanism in
network devices. Mid and low-end routers, which do not imple-
ment advanced trafﬁc management mechanisms, are commonly
used in access networks. Thus, the buffer size becomes an
important design parameter. The buffer can be measured in
different ways: maximum number of packets, amount of bytes,
or even queueing time limit [6] [7]. Moreover, the buffer must
play an important role when planning a network because it can
inﬂuence the packet loss of different services and applications.
Therefore, the QoS of the services can be affected by the size
of the buffer and its scheduling policies.
Hence, the characterization of the technical and functional
parameters of this device becomes critical when trying to
provide certain levels of QoS. This knowledge can be useful
for applications and services in order to make correct decisions
in the way the trafﬁc is generated. As a consequence, if the size
and the behaviour of the buffer are known, some techniques
can be used so as to improve link utilization, e.g., multiplexing
a number of small packets into a big one, fragmentation, etc.
However, a problem appears when using these techniques:
device manufacturers do not include all the implementation
details in the technical speciﬁcations of the devices, but just
part of them, mainly those related to the technology used.
Thus, if a communication has to cross different networks over
the Internet, some knowledge about the device’s characteristics
80
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-324-7
ICDS 2014 : The Eighth International Conference on Digital Society

Figure 1.
A particular buffer behaviour.
or the buffer’s behaviour will be interesting. For these situa-
tions, our group is currently working on the development of a
tool able to discover some characteristics of the buffer and its
behaviour. The ﬁnal objective is to permit these measurements
not only when physical access to the System Under Test (SUT)
is granted, but also in the case of only having remote access.
The paper is organized as follows: Section II discusses the
related work. The test methodology is presented in Section III.
The next section covers the experimental results, and the paper
ends with the conclusions.
II.
RELATED WORK
A. Buffer issues
Buffers are used to reduce packet loss by absorbing tran-
sient bursts of trafﬁc when routers cannot forward them at that
moment. They are instrumental in keeping output links fully
utilized during congestion times.
The so-called rule of thumb has been used to obtain the
amount of buffering needed at a router’s output interface [8]
but in [9], a small buffer model was proposed, in which buffer
size is obtained by the capacity, C, round-trip time, RTT and
the number of ﬂows, N, so, B = C × RTT/
√
N. In [10],
it was suggested the use of even smaller buffers, called tiny
buffers, considering a size of some tens of packets.
Traditional First In First Out (FIFO) queues accept a new
packet when there is enough space. However, this is not
the only buffer behaviour in commercial devices. In [11], a
particular buffer behaviour was observed and characterized:
once the buffer gets completely full, no more packets are
accepted until a certain amount of memory is available. Thus,
an upper limit and a lower limit can be deﬁned (see Fig. 1):
when the upper limit is reached, no more packets are accepted
until the size of the buffer corresponds to the lower limit.
Figure 2.
A typical topology in end-to-end communication.
Figure 3.
Topology used for tests.
III.
IMPROVED METHODOLOGY FOR THE
CHARACTERIZATION OF INTERNET PATHS
When trafﬁc is crossing a network in an end-to-end com-
munication (Fig. 2), all the packets traverse a high number of
network devices which may drop packets in some cases. The
network path is uncertain for most applications and services
which usually only measure the available bandwidth, in order
to limit the generated trafﬁc and rarely to smooth it. So,
we proposed a method to discover and describe network
characteristics which may be useful to correctly modify the
trafﬁc by applications. One of the premise of the present work
is that most of the network characteristics can be explained by
buffers characteristics.
In a previous work [12], we described a methodology
to determine the technical and functional characteristics of
buffers (as e.g., behaviour, size, limits, input and output rate)
of a network path even when more that one buffer is in the
path, ﬁnding interesting results but with some inaccuracies
when obtaining input rate estimations and buffer size. An
improvement of this methodology is presented in this article.
A. Test procedure
The scheme of the tests is shown in Fig. 3. There is a
System Under Test (SUT), which may be either a single device
or an entire network. The test is based on the sending of a burst
of UDP (User Datagram Protocol) packets from the Source to
the Destination machine, so as to produce a buffer overﬂow in
the SUT.
81
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-324-7
ICDS 2014 : The Eighth International Conference on Digital Society

Figure 4.
Estimating packets in concatenated queues with remote access.
Figure 5.
Estimating packets in queue in remote access (particular case).
B. New methodology
The methodology is based on the premise that the output
rate can be obtained from trafﬁc capture at the destination
device. This output rate depends on the technology used in
each case (Ehternet, WiFi). The output rate can be determined
because the remote capture includes the n received packets
in t seconds, and packet length is known. For calculating the
input rate, we know the amount of transmitted packets n +
m (received and dropped packets respectively) in t seconds.
Where m can be known since all the packets have a unique
identiﬁer. With this information, the output and input rates can
be estimated only from the data contained in the destination.
In Fig. 4, the Transmitted trace corresponds to the input of
Buffer 1; Received 1 is the output trace of Buffer 1; Received 2
is the output trace of Buffer 2, and it is the only available trace
in order to determinate all the link characteristics. Dropped
packets are the grey ones.
Fig. 5 represents an example in which two buffers are
concatenated, Buffer 1 has an upper limit and a lower limit,
as described in [11]; Buffer 2 uses the traditional FIFO policy.
These two buffers will ﬁll when R1 > R2 > R3. When Buffer
1 gets into overﬂow, it drops packets until a certain amount
of memory is available, so it will discard a burst of packets.
Buffer 2 has a different behaviour in congestion time because
if a packet gets out, another one can get into the buffer, so
packets will not be discarded in bursts. This ﬁgure clearly
shown two different packet loss patterns which corresponds to
each buffer.
TABLE I.
EQUATIONS FOR ESTIMATING BUFFER PARAMETERS OF FIG.
4.
Rate
Buffer size
R3 = nrx
tr2 × packetsize
LBuffer1 =
T′
r
1
R1−R2
+ 1
R2
R2 =
nrx+m′
tx
tn
× packetsize
LBuffer2 =
Tr1
1
R2−R3
+ 1
R3
R1 =
nrx+mtx+m′
rx
tr2
× packetsize
Analysing the Fig. 4, we can deduce the rates R and the
buffer length LBuffer from the remote capture, we can obtain
all the parameters using the expressions shown in Table I,
which corresponds to the same variables. In theses equations,
the most important parameters are the m values because they
correspond to the packet loss pattern of each buffer and they
give information about the buffer size. The m values are
determined by observing the packet loss patterns and it is given
by: m = number of patterns.
We have described the methodology using an example, in
which a buffer that drops one packet at a time, is concatenated
with other which drops packets in bursts, so the m values
or patterns can be easily determined. With the aim of test
our methodology, the next section presents a more complex
scenario with two concatenated buffers whose packet loss is
in burst.
82
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-324-7
ICDS 2014 : The Eighth International Conference on Digital Society

Figure 6.
Topology used for estimating the buffer size in wired and wireless network.
IV.
EXPERIMENTAL RESULTS
Real tests have been deployed in a testbed and results are
analysed according to the procedures cited above. Tests have
been performed for two different conditions: a single buffer
overﬂow and two different concatenated buffers. The tests are
repeated using different values for the packet size and the
bandwidth.
A. Laboratory environment
We have implemented a controlled network environment
in order to study two different devices: a switch (3COM)
and an access point (Linksys WAP54G). The topology is
shown in Fig. 6 in which different bandwidth limits were
set in the hubs and the access points in order to create a
bottleneck to be measured. With the proposed methodology,
we will characterize the output buffers of the switch and the
access point. Real machines have been used (Linux kernel
2.6.38 − 7, Intel® CoreT M i3 CPU 2.4 GHz) for sending
and receiving the test packets, in order to identify the buffer
behaviour of the devices across the network path.
B. Test procedure
The test is based on the sending of a burst of UDP packets
from the source to the destination, so as to produce a buffer
overﬂow on the different devices. The test is intended to ﬁnd
out the bottlenecks that appear, and whether they have the same
or different behaviour, according to the size of the sent packets.
This test is repeated using different amounts of bandwidth for
R1 (8, 12, 16, 20 Mbps). The wireless link is set to 11 Mbps.
Packets of different sizes (200, 400, 1000, 1500 bytes) are used
so as to determine if the buffer is measured in number of
packets or in bytes. This information will also be useful to
determine the packet size that generates the best results. This
allows us to discover when the effect of bottlenecks appears
and it will also be useful to determine if the size of the packets
may modify the output rate after the bottleneck.
Once the communication is set, we capture the trafﬁc on
the end device. This procedure generates a remote capture in
the destination host which is analyzed in order to estimate the
bandwidth, packet loss and buffer size. The accuracy of these
estimations is compared with the one obtained in previous
works [11] to validate the method proposed in the present
work.
C. Packet loss patron analysis
1) Finding the number of patterns: When the trafﬁc tra-
verses the SUT, packets are lost according to different patterns.
If we are able to identify them, this can give us useful
information about the number of the buffers in the path. With
the aim of ﬁnding a number of patterns, we made a study
of the packet loss using different amounts of input bandwidth
(8, 12, 16 and 20 Mbps) which may correspond at the same
number of bottlenecks. All the transmitted packets have a
length of 1500 bytes.
Fig. 7 shows the results for this test. The charts show
different packet loss patrons which can be determined by
observing the groups of packets around the same packet loss
value (see coloured eclipses). The 8Mbps graphic, when the
input rate is under 10Mbps (switch maximum output rate) we
can observe that packet loss remains below under 50 packets.
There are only a buffer effect, corresponding to the access
point WIFI buffer. The 12, 16 and 20Mbps graphic shows
that appear three group of packet loss patron. First of them
is similar than to the 8Mbps graphic, corresponding to the
access point WIFI buffer because the output rate of the switch
is set to 10 Mbps, so the input rate of the access point has no
variations. A second group have packet loss close to 125, 160
and 205 corresponding to the switch buffer. As expected,
packet loss increases when input rate grows. But, also, a third
group of packet loss is observed and it corresponds to the sum
of the packet loss produced by switch and the access point,
so this effect is present when both devices drop packets at the
same time.
83
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-324-7
ICDS 2014 : The Eighth International Conference on Digital Society

Figure 7.
Packet loss patron in the switch and the access point for different bandwidth amounts when packet size is 1500 bytes.
Figure 8.
Packet loss patron in the access point for different packet sizes when the bandwidth is 8 Mbps.
2) Analyzing the effect of the packet length: In this case
we developed two different tests. In the ﬁrst test, we have
selected a bandwidth of 8 Mbps with the aim of producing an
overﬂow on the second buffer (AP1) but not on the ﬁrst one
(Switch). The test is repeated using packets of 200, 400, 1000
and 1500 bytes. The results are shown in Fig. 8, where
different packet loss patterns can be observed.
The amount of lost packets is roughly the same for every
test (Fig. 8) and they correspond to the ones obtained in
Fig. 7, due to the relationship between the buffer size and
the input and output rate of the access point buffer. In the
WIFI technology, the output rate increases when packet size
increases, so packet loss value is affected by packet length,
and it decreases for bigger packets. In addition, packet loss
has less dispersion when packet size is bigger.
In the second test (Fig. 9), we used a ﬁxed bandwidth of
20 Mbps in order to ﬂood both buffers. This test allow again us
to characterize the relationship between packet size and packet
loss pattern. But in this case, the situation is more complex
since there are two effects concatenated corresponding to the
two buffers. The explanation is similar to the Fig. 7 and 8.
There are three groups of packet loss patterns and the different
values of the results occurs because the variability of the
buffers output rate, which depends on the packets sizes.
3) Estimating the buffer size: We obtained the buffer size
for the switch and the access point using to the proposed
methodology but analyzing one buffer at a time according to
each pattern, and eliminating the effect of the other buffer. In
both cases, the appearance of a buffer with upper limit and
lower limit is observed, which maximum size is roughly 120
84
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-324-7
ICDS 2014 : The Eighth International Conference on Digital Society

Figure 9.
Packet loss patron in the switch and the access point for different packet sizes when the bandwidth is 20 Mbps.
packets for the switch and 50 packets for the access point. The
more noteworthy is that results are similar that the estimates
that we done, in previous works, with isolated buffers.
V.
CONCLUSION
This article has presented a packet loss analysis, which
is useful in order to describe the technical and functional
characteristics of commercial buffers on a network path. This
characterization is important, taking into account that the
buffer may modify the trafﬁc characteristics.
Tests using commercial devices have been deployed in a
controlled laboratory scenario, including wired and wireless
devices. Accurate results of the buffer size and other param-
eters have been obtained when there is physical access to the
“System Under Test”. In case of having no direct access to the
system, an acceptable estimation can also be obtained.
As future work, the method has to progress in order to
improve the accuracy, especially when measuring the input
rate when a wireless link is in the network path. Moreover, it
would be interesting to discuss how to use the measures to infer
on the buffering strategies, which could then lead to transport
protocol adjustments that would consider these strategies to
maximize QoS.
ACKNOWLEDGMENT
This work has been partially ﬁnanced by the European
Social Fund in collaboration with the Government of Arag´on,
CPUFLIPI Project (MICINN TIN2010-17298), Ibercaja Obra
Social, Project of C´atedra Telef´onica, University of Zaragoza,
Banco Santander and Fundaci´on Carolina.
REFERENCES
[1]
J. Saldana, J. Fern´andez-Navajas, J. Ruiz-Mas, J. Murillo, E. V. Navarro,
and J. I. Aznar, “Evaluating the inﬂuence of multiplexing schemes
and buffer implementation on perceived VoIP conversation quality.”
Computer Networks, vol. 56, no. 7, May, 2012, pp. 1893–1919.
[2]
J. Saldana, J. Fern´andez-Navajas, J. Ruiz-Mas, E. V. Navarro, and
L. Casadesus, “The effect of router buffer size on subjective gaming
quality estimators based on delay and jitter.” in CCNC.
IEEE, Jan.
2012, pp. 482–486.
[3]
S. Tang, Y. Lu, J. M. Hernndez, F. A. Kuipers, and P. V. Mieghem,
“Topology Dynamics in a P2PTV Network.” in Networking, ser. Lecture
Notes in Computer Science, L. Fratta, H. Schulzrinne, Y. Takahashi, and
O. Spaniol, Eds.
Springer, May, 2009, pp. 326–337.
[4]
W. chang Feng, F. Chang, W. chi Feng, and J. Walpole, “Provisioning
on-line games: a trafﬁc analysis of a busy counter-strike server.” in
Internet Measurement Workshop.
ACM, Feb. 2002, pp. 151–156.
[5]
B. Fallica, Y. Lu, F. Kuipers, R. Kooij, and P. V. Mieghem, “On
the Quality of Experience of SopCast,” in Next Generation Mobile
Applications, Services and Technologies, 2008. NGMAST ’08. The
Second International Conference on, Sept. 2008, pp. 501–506.
[6]
A. Vishwanath, V. Sivaraman, and G. N. Rouskas, “Considerations for
Sizing Buffers in Optical Packet Switched Networks.” in INFOCOM.
IEEE, Mar. 2009, pp. 1323–1331.
[7]
A. Dhamdhere and C. Dovrolis, “Open issues in router buffer sizing.”
Computer Communication Review, vol. 36, no. 1, Jul. 2006, pp. 87–92.
[8]
C. Villamizar and C. Song, “High performance TCP in ANSNET,”
SIGCOMM Comput. Commun. Rev., vol. 24, no. 5, Oct. 1994, pp.
45–60.
[9]
G. Appenzeller, I. Keslassy, and N. McKeown, “Sizing router buffers.”
in SIGCOMM, R. Yavatkar, E. W. Zegura, and J. Rexford, Eds. ACM,
Feb. 2004, pp. 281–292.
[10]
M. Enachescu, Y. Ganjali, A. Goel, N. McKeown, and T. Roughgarden,
“Part III: routers with very small buffers.” Computer Communication
Review, vol. 35, no. 3, Feb. 2005, pp. 83–90.
[11]
L. Sequeira, J. Fernandez-Navajas, J. Saldana, and L. Casadesus,
“Empirically characterizing the buffer behaviour of real devices,” in
Performance Evaluation of Computer and Telecommunication Systems
(SPECTS), 2012 International Symposium on, Jul. 2012, pp. 1–6.
[12]
L. Sequeira, J. Fernandez-Navajas, and J. Saldana, “Characterization of
the Buffers in Real Internet Paths,” in Performance Evaluation of Com-
puter and Telecommunication Systems (SPECTS), 2013 International
Symposium on, Toronto, Canada, Jul. 2013, pp. 155–160.
85
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-324-7
ICDS 2014 : The Eighth International Conference on Digital Society

