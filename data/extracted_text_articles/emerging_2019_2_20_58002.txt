A Method of Feature Extraction from Time-Frequency Images  
of Vibration Signals in Faulty Bearings for Classification Purposes 
Dorel Aiordachioaie 
”Dunarea de Jos” University of Galati 
Electronics and Telecom. Department 
Galati, Romania 
e-mail: Dorel.Aiordachioaie@ugal.ro
Theodor D. Popescu 
National Institute for Research 
and Development in Informatics 
Bucharest, Romania 
e-mail: Theodor.Popescu@ici.ro 
Bogdan Dumitrascu 
”Dunarea de Jos” University of Galati 
Electronics and Telecom. Department 
Galati, Romania 
e-mail: Bogdan.Dumitrascu@ugal.ro
Abstract—Time-frequency image processing is considered in 
the context of change detection and diagnosis purposes of 
bearings with faults and vibration signal processing. The 
analysis of these images reveals some difficulties in obtaining 
accurate results in classification. Some images are different 
compared to other images from the same set. New images are 
obtained by applying a criterion based on the contours 
generated by the main components of the analyzed time-
frequency image. The transformed images are less complex, 
and could be with white and black only. Features based on 
statistical moments are considered, selected and used to define 
discriminant functions, which could improve the results of the 
classification. The features include the number of the contours, 
the average area defined by the contours, the variance of the 
areas and the Renyi entropies.  
Keywords-signal; 
vibration; 
image; 
time-frequency 
transform; signal processing; feature selection; classification. 
I.
INTRODUCTION
An important activity in industry, for safe work and 
quality of the products, is the Change Detection and 
Diagnosis (CDD) of various processes. These two activities 
are parts of wider domain, called condition-based and 
predictive maintenance, as described in some excellent 
books with theory and applications [1] [2] [3]. In the field of 
vibrational processes, i.e., processes which generates 
mechanical vibrations, with or without faults or damages, 
advanced signal processing algorithms are intensively used 
to elaborate accurate and robust algorithms for process 
diagnosis  [4] [5] [6].  
One of the more complex signal processing method is 
based on time-frequency transform, and next on time-
frequency images, as described in [7] [8] [9]. The structure 
of such processing chain is presented in Figure 1. Signals 
from the process under study are pre-processed both on 
continuous and discrete time, mainly by filtering and scaling. 
Next, a time sliding window is considered for the 
computation 
of 
the 
time-frequency 
transform. 
The 
parameters of the sliding window depend on the statistical 
properties of the analyzed signals, to meet the condition of 
the statistical stationarity. The coefficients of the time-
frequency transform are considered as elements of an image. 
From this point all processing steps are based on image 
processing, for various tasks, as fault detection and 
diagnosis.  
Figure  1. The block structure of signal processing for CDD  
This work considers the last block before diagnosis, i.e., 
image processing for classification purposes. The previous 
processing blocks, mainly for signal processing, i.e., data 
acquisition and pre-processing, time-frequency transforms, 
are described in the Sections of the paper. Direct 
classification of time-frequency images do not offer always 
the best results in CDD activities, as described in [10] [11]. It 
is the main objective of this paper to define algorithms for 
feature selection and extraction, in order to expect better 
results of the classification and diagnosis purposes.  
The rest of this paper is organized as follows. Section II 
describes the basic transforms applied to the vibrating 
signals, i.e., time-frequency and Renyi entropy. Section III 
describes the data which was used for experiments, including 
time-frequency images. Section IV addresses the proposed 
method for feature selection. Section V goes into the results 
of the experiments. The conclusion and acknowledgement 
close the article. 
II.
SIGNAL TRANSFORMS
Signal transforms are used to compute specific features 
of the analyzed signal or to change the analysis system, e.g., 
time-frequency transforms, or to compute and extract other 
relevant features, e.g., the Renyi entropy.  
A. Time-Frequency Transform 
Time-frequency transforms are advanced processing 
techniques for data processing, and especially for data 
coming from non-stationary signals. A general theoretical 
framework is presented in [12] [13]. Examples of signals and 
applications are audio signals [14], mechanical vibrations 
[15] or biomedical signals [16].  
If x(t) is a continuous (possible complex) signal, the 
time-frequency transforms can be obtained from the general 
formula [20] 
34
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-740-5
EMERGING 2019 : The Eleventh International Conference on Emerging Networks and Systems Intelligence

 



   



j udud d
j
j t
e
t
x
x t
t
Cx







 



 


( , )
2
2
4
1
)
( ,
*
2
         (1) 
where 
( , )
  
is the kernel function, which imposes the 
properties of the distribution, and "*" denotes complex 
conjugation. If the kernel function is 1, then the Wigner 
distribution is obtained.  
For the case where x(t) is an analytical signal, the Wigner 
distribution is called the Wigner-Ville distribution (WVD)  
[17]. This distribution satisfies a large number of desirable 
mathematical properties, as described in the specialized 
literature [18] [19]. In particular, the WVD is always real-
valued; it preserves time and frequency shifts and satisfies 
the marginal properties. It has also some drawbacks, as the 
apparition of the cross-terms. This is the reason for using the 
Choi-Williams Distribution (CWD) where the kernel 
function is [12] 



2
2 /
exp
( , )


  


                     (2) 
This distribution function adopts exponential kernel to 
suppress the cross-term that results from the components that 
differ in both time and frequency centers.  
The discrete WVD is defined by [13] 















N
n
k
m
j
k T
n
x
x kT
N
n m
W
N
k
)
(2
) ) exp
((
)
(
2
1
)
,
(
*
1
0

       (3) 
It is informal to verify that W(n,m) is a periodic function 
of period 2N in both time and frequency. The last 
relationship 
shows 
that 
in 
the 
range
1
2
,1 0
2
0






N
m
N
n
, representing one period, the 
WVD 
needs 
only 
be 
calculated 
over 
the 
range
1
,1 0
0






N
m
N
n
, having an area of one quarter 
that of the complete period.  
The coefficients of the time-frequency transform define 
an image, which will be called a Time-Frequency Image 
(TFI).  
B. Entropy Transform 
The objective of the section is to introduce a criterion to 
describe the time-frequency images, from content point of 
view, before measuring the similarities for classification 
purposes. The start point is the registration process of the 
image, as pre-processing step before classification of these 
images. 
Common algorithms for image registration could use: 
translation, on x and y directions; rigid processing, which 
means translation plus rotation; similarity, which means 
translation, rotation and scaling; affine transformation, which 
considers translation, rotation, scaling, and shearing. The 
choice of one of them is based mainly on the content of the 
image, the sources and the number of the images which are 
considered for registration. Simple registration methods of 
the images, from the content point of view, use intensity-
based registration algorithms. As complexity rises, feature-
based is more indicated. Details and examples are available 
in many references [20] [21]. 
The registration time is rapidly growing from translation 
to affine transformation. Sometimes, for complex transforms 
- like affine, the registration process could diverge. This is 
the reason to consider new methods valid for time-frequency 
images – in general – and in the case of bearings, in 
particular. The proposed procedure considers a number of 
maxima which will be considered as reference, i.e., their 
positions remain unchanged during and after registration.  
Based on the above remarks, a criterion based on the 
image similarity is promoted, in order to select/decide if an 
image of the set could be registered or not. In principle, if the 
similarity with the reference image is low, then the 
registration of that image is skipped. The similarity is 
evaluated based on information content with the help of 
Renyi entropy. Definition of the alpha order Renyi entropy 
from [22] is considered as 








  
dtdf
u v dudv
I
I t f
HR



, )
(
( , )
log
1
1
( )
2
I
    (4) 
     By discretization of this measure by setting 
t=n Δt

 and  
Z
f n k
f=k


Δ , ,
 yields 
)
(
log
]'
,'
[
[ , ]
log
1
1
)
(
2
2
f
t
n k
I
I n k
HR
 








  



 I
     (5) 
Depending on the processed data, a number of images from 
the data set will be discarded, i.e., not considered for the 
registration step, as in [24]. The rejected images have very 
low similarity comparing with the prototype of the 
considered set and could come from some transient 
processes during the raw signal acquisition stage. 
III.
DATA DESCRIPTION AND IMAGE ANALYSIS
Data were considered for the case of faults in bearings, 
available from [23], and briefly described in Table I. Three 
types of faults are available, like F1 (Inner race), F2 (Ball) 
and F3 (Outer race). The case F0 means no faults. Vibration 
data from four sizes of the faults are available. The data set 
has the advantage of consistency, by considering faults from 
incipient/small size (0.007") to a larger one (0.028").  
The sampling rate is 12,000 Hz, the motor load is 0 hp, 
and all data are from drive end bearing (DE). A set of four 
classes of patterns are considered as: C#0 – no faults, defined 
35
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-740-5
EMERGING 2019 : The Eleventh International Conference on Emerging Networks and Systems Intelligence

by d0; C#1 –inner race, defined by {d1, d6, d9, d14}; C#2 – 
ball, defined by {d2, d7, d10, d15}; C#3-outer race defined 
by {d3, d8, d11}. The vectors d4, d5, d12, and d13
correspond to other sites of the transducers. 
TABLE I.  
 DATA TEST SET
Faults 
Fault 
size 
F0 
F1 
F2 
F3 
Free 
Inner 
Race 
Ball 
Outer 
Race 
0.000“ 
d0 
- 
- 
- 
0.007" 
- 
d1 
d2 
    d3, d4, d5 
0.014" 
- 
d6 
d7 
         d8 
0.021" 
- 
d9 
d10 
d11, d12, d13 
0.028" 
- 
d14 
d15 
- 
IV.
THE PROPOSED METHOD
Taking into account the results obtained by other 
methods, e.g., [10] [11], a method to select the important 
features of the time-frequency image and to define a new set 
of features, is developed. The method considers the content 
of the image by taking images with a pre-defined number of 
peaks, e.g., 1 to 3, depending on the complexity of the 
image. Thus, a new image is considered and defined in 
terms of contours, defined by the above peaks, which will 
be called transformed images or contour-based images 
(CBI).  
In the set of the four next figures, i.e., Figure 2 to Figure  
5, the raw/original images and the transformed images are 
presented, for all four classes, i.e., C#1 to C#4. On blue 
background, the set of the registered images are presented. 
Registration is made on the set of the images obtained from 
the frames of each record/file, as described in [24]. These 
images are considered as the prototypes of the classes. 
The transformed images are presented on white 
background. A primary analysis of these images reveals 
some interesting properties: 
a)
the common content of the images is of vertical lines, 
as C#1(1,6,9), C#3(3,11,12); 
b)
the class C#2 has a very complex patterns, for all cases 
(2,7,10, and 15); 
c)
The classes C#1 and C#3 have some strange patterns, 
C#1(14) and C#3(8). Keeping all these images will 
damage the final classification, so images with high 
dissimilarity are removed from processing. 
In order to extract the right information/features from 
the transformed images, the following elements are 
considered 
in 
defining 
the 
necessary 
features 
for 
classifications: 
i)
the number of contours, Nc, as a measure of the 
complexity; 
ii)
the area of the polygons, Ac, as a measure of the 
spreading on horizontal plane; 
iii) the variance of the above areas, var(Ac), as a measure 
of the complexity; 
iv) the average of the area of the polygons, E{Ac}; 
v)
the mean of the squared values of areas, E{A2
c}; 
vi) the Renyi entropy of transformed images, RH. 
A vector of features could be defined by using the 
above variables, as 
4,3,2,1
,
var
2




 

i
RH
A
A
(Ac)
A
N
c
c
c
c
if
   (6) 
Figure  2. Class #0. Original and transformed image. 
Figure  3.  Class #1. Original and transformed images.  
36
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-740-5
EMERGING 2019 : The Eleventh International Conference on Emerging Networks and Systems Intelligence

For each data vector d from a class, the vector fi is 
evaluated, and matrix of features is obtained for each class, 
as 


4,1
,
...
4
2
1


j
j
f
f
f
F
               (7) 
Figure  4. Class #2. Original and transformed images 
The effect of the features is estimated by a general 
discriminant matrix 
4,1
) , ,
(
, )
(
3
0
3
0
2


  


k j
k j
D
k
j
j
k
F
F
         (8) 
or, by considering only the distinct classes, by the 
discriminant functions 

4,1 
, ,
,
|)
( ,




j k j
j k
k
E D k j
Dm
      (9) 
or 

4,1 
, ,
,
|)
( ,
var




j k j
j k
k
D k j
Dv
      (10) 
Figure  5. Class #3. Original and transformed images. 
V.
RESULTS OF THE EXPERIMENTS
From various experiments, the best results are presented 
in Table II. Figure 6 presents the features space, composed 
from the first three normalized features, and the values of the 
discriminant functions. The best structure of the feature 
vector, as result of the maximum variance, Dv, is offered on 
the first line with a value of 6.23. 
TABLE II.  
 DISCRIMINANT VALUES
No
Feature vector
Dm
Dv
1 




RH
A
A
N
2
c
c
c
3.88 
6.23 
2 

RH
A
N
c
c
var(Ac)
3.79 
5.64 
3 

 Ac
var(Ac)
c
c
A
N
4.34 
4.33 
37
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-740-5
EMERGING 2019 : The Eleventh International Conference on Emerging Networks and Systems Intelligence

Figure  6. Feature space and the discriminant values 
        The unnormalized values are presented in the 
following. A column is used for a class. The first column is 
for class #0, i.e., free of faults. The next column are for 
classes 1, 2 and 3. For class C#0, because only one vector is 
available, the next three vectors are considered identically 
with the first one. 
J1m = 
     23   150   179   204 
     23     25     86   138 
     23     16   173     12 
     23   143     48     69 
J2m = 
    896.10    94.20  184.68  200.69 
    896.10  405.73  143.06  181.46 
    896.10  539.86  191.68  465.38 
    896.10  128.87  457.87  180.73 
J3m =  1.0e+06 * 
    3.1544    0.2217    0.4132    0.5623 
    3.1544    1.3166    0.4640    0.3623 
    3.1544    1.3451    0.7012    0.9783 
    3.1544    0.5633    1.3616    0.4031 
J4m = 
    4.4006    6.0824    5.9316    5.6459 
    4.4006    4.2532    5.8992    6.1837 
    4.4006    4.6008    5.7734    4.0958 
    4.4006    6.2462    5.3046    5.4525 
    Next, the features are organized in classes, one column 
for a parameter, and one line for a data vector of the same 
class. In this way, the parametric matrices from PC1 to PC4 
are obtained and used in the computation of the discriminant 
functions. 
           PC1 = 
0.1127    1.0000    1.0000    0.7235 
0.1667    1.0000    1.0000    0.7116 
0.1329    1.0000    1.0000    0.7622 
0.1608    1.0000    1.0000    0.7045 
PC2 = 
0.7353    0.1051    0.0703    1.0000 
0.1812    0.4528    0.4174    0.6878 
0.0925    0.6025    0.4264    0.7969 
1.0000    0.1438    0.1786    1.0000 
PC3 = 
0.8775    0.2061    0.1310    0.9752 
0.6232    0.1596    0.1471    0.9540 
1.0000    0.2139    0.2223    1.0000 
0.3357    0.5110    0.4317    0.8492 
            PC4 = 
1.0000    0.2240    0.1783    0.9282 
1.0000    0.2025    0.1148    1.0000 
0.0694    0.5193    0.3101    0.7094 
0.4825    0.2017    0.1278    0.8729 
VI.
CONCLUSION
The objective of the paper was to find a solution to the 
classification problem, based on time-frequency images, 
which are quite modest with data of faulty bearings. The 
previous solutions have implemented feature selection and 
extraction based on the parameters of the first component of 
the processed images.  
At this stage, two major improvements could be 
considered. The first one is based on image analysis and 
registration. Analysis of the images to be registered shows 
that it is possible to have images which are very different 
compared to others from the same class. These must be 
rejected from the registration process. The second direction, 
which was promoted in this paper, uses a transformed image 
that contains contours of the time-frequency image. The 
selection of the features is based on the statistical moments, 
as average, variance and squared average values of the areas 
of the contours. Information based features is also used, by 
promotion of the Renyi entropy.  
The preliminary results show an improvement in the 
feature space, in the sense of clustering, and the possibility to 
obtain right classification results based on proposed 
dissimilarities functions. 
In the nearest future a performance comparison of the 
proposed method with some classical methods based on 
similarity computation will be considered. 
ACKNOWLEDGMENT
The work was partly supported by the Romanian Council 
for 
Research 
(UEFISCDI) 
under 
Grant 
224/2014, 
“Experimental model for change detection and diagnosis of 
vibrational processes using advanced measuring and analysis 
techniques model-based  (VIBROCHANGE)”. 
REFERENCES
[1]
J. H. Williams, A. Davies, and P. R. Drake (Eds),  Condition-
based Maintenance and Machine Diagnostics, Springer, 1994. 
[2]
L. Fedele, Methodologies and Techniques for Advanced 
Maintenance, Springer, 2011. 
38
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-740-5
EMERGING 2019 : The Eleventh International Conference on Emerging Networks and Systems Intelligence

[3]
M. Bengtsson, E. Olsson, P. Funk, and M. Jackson, 
“Technical Design of Condition Based Maintenance System”, 
Proceedings of the 8th Congress, University of Tennessee – 
Maintenance and Reliability Center, Knoxville, USA, May 
2nd – 5th, 2004, Paper III. 
[4]
K. Shin and J. K. Hammond, Fundamental of Signal 
Processing for Sound and Vibration Eng., John Wiley & Sons 
Ltd, 2008. 
[5]
D. M. Yang, A. F. Stronach, and P. MacConnell, “The 
Application of Advanced Signal Processing Techniques to 
Induction 
Motor 
Bearing 
Condition 
Diagnosis”, 
P. 
Meccanica, Springer, 2003, vol  38(2), pp 297-308. 
[6]
D. Mironovs and A. Mironov, “Vibration based signal 
processing algorithm for modal characteristics change 
assessment”, AIP Conference Proceedings 2029, 020043, 
2018, pp.1-10. 
[7]
B. Boashash (Ed), Time-Frequency Signal Analysis and 
Processing, Elsevier, 2016. 
[8]
L. Stankovic, M. Dakovic, and T. Thayaparan, Time-
Frequency Signal Analysis with Applications, Artech House, 
2014. 
[9]
M. Boufenar, S. Rechak, and M. Rezig, “Time-Frequency 
Analysis Techniques Review and Their Application on Roller 
Bearings Prognostics”. In: Fakhfakh T., Bartelmus W., Chaari 
F., Zimroz R., Haddar M. (eds) Condition Monitoring of 
Machinery in Non-Stationary Operations. Springer, Berlin, 
Heidelberg, 2012. 
[10] D. Aiordachioaie and Th. D. Popescu, “Change Detection by 
Feature Extraction and Processing from Time-Frequency 
Images”, IEEE 10th Int. Conf. on Electronics, Computers and 
Artificial Intelligence  (ECAI), Iasi, Romania, 2018, pp.1-7. 
[11] D. Aiordachioaie, N. Nistor, and M. Andrei, “Change 
Detection in Time-Frequency Images by Feature Processing 
in Compressed Spaces”, IEEE 24th Int. Symp. for Design and 
Technology 
in 
Electronic Packaging 
(SIITME), 
Iași, 
Romania, 2018, pp.181-186 . 
[12] E. Sejdic, I. Djurovic, and J. Jiang, “Time–frequency feature 
representation using energy concentration: An overview of 
recent advances”, Digital Signal Processing, 19, 2009, pp. 
153-183. 
[13] Q. Zhu, Y. Wang, and G. Shen, “Comparison and 
Application of Time-Frequency Analysis Methods for 
Nonstationary Signal Processing”. In: Lin S., Huang X. 
(eds) Advanced Research on Computer Education, 
Simulation and Modeling. CESM 2011. Communications 
in Computer and Information Science, vol 175. Springer, 
Berlin, Heidelberg, 2011. 
[14] M. Karjalainen and V. Pulkki, Communication Acoustics: An 
Introduction to Speech, Audio and Psychoacoustics, John 
Wiley & Sons, 2015. 
[15] F. Al-Badour, M. Sunar, and L. Cheded, “Vibration analysis 
of rotating machinery using time–frequency analysis and 
wavelet techniques”, MSSP, vol. 25 (6), 2011, pp. 2083-2101. 
[16] M. Akay, Time Frequency and Wavelets in Biomedical 
Signal Processing, Wiley-IEEE Press, 1997. 
[17] P. D. McFadden and W. Wang, Time-Frequency Domain 
Analysis of Vibration Signals for Machinery Diagnostics. (I) 
Introduction to the Wigner-Ville Distribution, University of 
Oxford, Report OUEL 1859/92, 1990. 
[18] L. Debnath, The Wigner-Ville Distribution and Time-
Frequency Signal Analysis. In: Wavelet Transforms and 
Their Applications, Birkhäuser, Boston, MA, 2002. 
[19] L. Cohen, “Time-Frequency distributions-A review”, Proc. 
IEEE, Vol. 77, pp. 941-981, July 1989. 
[20] G. A. Ardeshir, Image Registration Principles, Tools and 
Methods, Springer, 2012. 
[21] I. N. Bankman (Ed.), Handbook of Medical Image 
Processing and Analysis, Elsevier, 2009. 
[22] R. G. Baraniuk, P. Flandrin, A. J. E. M. Janssen, and O. J. J. 
Michel, “Measuring Time–Frequency Information Content 
Using the Rényi Entropies”, IEEE Transactions on 
Information Theory, vol. 47(4), 2001, pp. 1391-1409. 
[23] Case Western Reserve University, Bearing Data Center, At: 
http://csegroups.case.edu/bearingdatacenter/home, Retrieved: 
06, 2019.  
[24] D. Aiordachioaie and S. M. Pavel, “Qualitative Analysis of 
the Time-Frequency Images of Vibrations in Faulty 
Bearings”, IEEE 11th Int. Conf. on Electronics, Computers 
and Artificial Intelligence  (ECAI), Pitesti, Romania, 2019, 
pp. 1-6. 
39
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-740-5
EMERGING 2019 : The Eleventh International Conference on Emerging Networks and Systems Intelligence

