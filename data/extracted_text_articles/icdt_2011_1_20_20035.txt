Constant-rate Adaptive Space-time Code Selection
Technique for Wireless Communications
Dimas Mavares Terán
Electronic engineering department
Universidad Nacional Politécnica (UNEXPO)
Barquisimeto,Venezuela
email:dmavares@unexpo.edu.ve
Rafael P. Torres
Communications department
Universidad de Cantabria
Santander, España
email:torresrp@unican.es
Roberto A. Uzcátegui
Electronic engineering department
Universidad Nacional Politécnica (UNEXPO)
Barquisimeto, Venezuela
email:ruzcategui@unexpo.edu.ve
Abstract—A constant-rate space-time code selection technique
for transmit antenna diversity systems is proposed. The proposed
technique selects both the space-time code and the number of
transmitter antennas through a comparison of equivalent SISO
channels with a set of predetermined threshold levels, using
only four bits for feedback. The constant-rate transmission is
based in the inclusion of a complementary transmission mode,
which is used whenever no equivalent SISO channel’s envelope
is found to be over the threshold levels. Simulation results
show that the proposed technique outperforms other adaptive
transmission techniques, while in comparison with its variable-
rate counterpart, there is an increase in spectral efﬁciency with
a slight penalty performance. Additionally to a constant-rate
transmission, the new techniques makes BER performance almost
independent of the relative velocity between the transmitter and
the receiver. 12 .
Index Terms—Space-time coding, adaptive transmission, an-
tenna selection, wireless communications, baseband signal pro-
cessing.
I. INTRODUCTION
Transmit antenna diversity (TAD) is one of the tools to
be applied to construct multiple-input multiple-out (MIMO)
systems, which are expected to contribute to providing the high
data rates needed by fourth generation wireless systems. One
way to implement TAD is by using space-time block codes
(STBC), obtaining an open loop system whenever channel
state information (CSI) is not available at the transmitter end
[1], [2]. Closed-loop systems are designed to take advantage
of the CSI at the transmission end. However, they are limited
by the need to maintain the amount of data in the feedback
channel as low as possible. Channel feedback information is
one important issue when designing transmit systems.
Several structures that combine antenna selection techniques
with space-time coding have been proposed in [3]–[7]. In [7],
it was shown that selection of antenna subsets in conjunction
with space-time codes produces an increase in the mean
signal to noise ratio (SNR), maintaining the diversity order.
In this paper, a modiﬁcation of the space-time code selection
technique (STCS) described in [8], [9] is proposed, which
1The authors gratefully acknowledge ﬁnancial support for this work from
the Regional Fund for Digital Innovation in Latin America and The Caribbean
(FRIDA).
2This work was also partially supported by the Spanish Ministry of Science
and Innovation (project number TEC2008-02730).
allows to obtain a constant-rate transmission. In the former
STCS technique, the STBC and the antennas to be used were
selected through a comparison of the equivalent single-input
single-output (SISO) channel envelopes (taken as a linear
combination of Rayleigh channel envelopes) with a set of
predetermined threshold levels. A no-transmission mode was
selected whenever no equivalent SISO channel satisﬁed the
predetermined conditions, producing a slight average spectral
efﬁciency penalty, generally no higher than 10%. However,
such non-constant rate transmission could prevent its use in
constant-rate applications. The proposed modiﬁcation corrects
this drawback by sustituing the non-transmission mode by a
complementary mode, which consist in transmitting with a
predetermined code. In our test, it was found that transmitting
with a single antenna was the most convenient choice, thanks
to the fastest recovery of the Rayleigh channel compared to
other equivalent SISO channels.
Monte Carlo simulations show that, using the complemen-
tary mode, almost the same bit-error rate (BER) performance
than the variable-rate STCS (VR-STCS) is achieved, but with-
out any spectral efﬁciency penalty. Additionally, simulations
over a range of Doppler frequencies show that the performance
of the new technique is almost independent of the relative
velocity between the transmitter and the receiver.
The remainder of the paper is organized as follows. In Sec-
tion II, the system model is introduced. Section III describes
the new space-time code algorithm. In Section IV, simulation
results are shown and discussed. Finally, Section V ends the
paper with the conclusions.
II. SYSTEM MODEL
In the communication system model, four transmitter and
one receiver antennas are employed. Initially, the transmitter
sends pilot symbols to perform the vector channel estimation
at the receiver. The equivalent SISO channel envelopes are
compared with a given set of threshold levels, which are
previously chosen according to the mobile speed. Afterwards,
the receiver decides on the space-time code and the transmit
antennas to use, and sends this decision to the transmitter.
Transmission is adapted to that decision, which is maintained
until the next decision instant, when the process is repeated.
7
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

The transmission is assumed to occur in ﬂat frequency cha-
nnels. The squared envelopes of the equivalent SISO channels
using an orthogonal STBC (OSTBC) are given by
α2
nT =
nT
X
k=1
r2
k,
(1)
where nT and r2
k represent the number of transmitter antennas
and the square of Rayleigh distributed channel envelopes,
respectively. It is well known that αnT follows a Nakagami-
nT distribution [10] with a mean value of ΩnT = 2nT. Its
probability density function is given by
pN(x) =
 nT
Ω2nT
nT xnT −1
Γ(nT ) e−nT x/Ω2nT .
(2)
The received signal can be expressed by the following in-
put/output relationship:
Y = SnTFH + V,
(3)
where H is the 4x1 channel vector, SnT is a 4x4 space-time
coding matrix, F is a 4x4 permutation and selection matrix
and V is the 1x4 noise vector. The matrix SnT may take the
following structures, based on the space-time codes proposed
in [1] and [2], depending on the number of selected antennas
[8], [9]:
S1 =




s0
0
0
0
s1
0
0
0
s2
0
0
0
s3
0
0
0



 ,
(4)
S2 =




s0
s1
0
0
−s∗
1
s∗
0
0
0
s2
s3
0
0
−s∗
3
s∗
2
0
0



 ,
(5)
S3 =






s0
s1
s2
√
2
0
−s∗
1
s∗
0
s2
√
2
0
s∗
2
√
2
s∗
2
√
2
(−s0−s∗
0+s1−s∗
1)
2
0
s∗
2
√
2
− s∗
2
√
2
(s1+s∗
1+s0−s∗
0)
2
0






,
(6)
S4 =






s0
s1
s2
√
2
s2
√
2
−s∗
1
s∗
0
s2
√
2
− s2
√
2
s∗
2
√
2
s∗
2
√
2
(−s0−s∗
0+s1−s∗
1)
2
(s0−s∗
0−s1−s∗
1)
2
s∗
2
√
2
− s∗
2
√
2
(s1+s∗
1+s0−s∗
0)
2
− (s0+s∗
0+s1−s∗
1)
2






.
(7)
III. SELECTION ALGORITHM
In this section, the selection algorithm, which is carried
out at the receiver baseband in the discrete-time domain,
is described. The selection algorithm is based on the com-
parison of possible equivalent SISO channels with a set of
four threshold levels, which are selected depending on the
maximum Doppler frequency. Since the decision should be
maintained until new feedback information is available, it is
not sufﬁcient to make it based only on instantaneous CSI;
it should also take into account the rate of change of the
equivalent SISO channel envelope. As the rate of change of
the fading envelope decreases with nT , it could be established
that, in order to select an equivalent SISO channel only when
its envelope is above a predeﬁned threshold level during a
given period of time, the lower the number of antennas that
comprise the channel, the higher the requirements for selecting
it. For a given instantaneous BER objective, equivalent SISO
channels for larger nT values will take more time to drop
to the envelope level that produces such an instantaneous
BER objective. Therefore, the highest threshold level (ρ1)
will correspond to the one-antenna equivalent SISO channels,
while the lowest threshold level (ρ4) will correspond to the
four-antennas equivalent SISO channel. Then, the selection
algorithm proceeds as follows:
• Step 1: Once the receiver obtains the CSI (which can
be estimated based on a pilot sequence sent by the
transmitter using all the transmitter antennas), it compares
individually the Rayleigh fading envelopes with threshold
ρ1. If one or more of these envelopes are detected to
be over ρ1, the corresponding transmitter antennas are
marked as selected and the procedure jumps to step 6.
• Step 2: The receiver compares all the Nakagami-2 fading
envelopes with ρ2. If one or more of these envelopes are
detected to be over ρ2, all the transmitter antennas which
compose the detected envelopes are marked as selected
and the procedure jumps to step 6.
• Step 3: The receiver compares all the Nakagami-3 fading
envelopes with ρ3. If one or more of these envelopes are
detected to be over ρ3, all the transmitter antennas which
compose the detected envelopes are marked as selected
and the procedure jumps to step 6.
• Step 4: The receiver compares the Nakagami-4 fading
envelope with ρ4. If it is detected to be over ρ4, all
the transmitter antennas are marked as selected and the
procedure jumps to step 6.
• Step 5: This step is reached only if no Nakagami-k fading
envelope is detected to be over ρk. In this case, the highest
envelope’s Rayleigh channel is selected, that is, a single
antenna is selected.
• Step 6 The receiver constructs the permutation and selec-
tion matrix F and sends it to the transmitter.
The only form of feedback is given by the permutation and
selection matrix F. It is ﬁrst set as a permutation matrix of
order four with the ﬁrst nT columns of the identity matrix
corresponding to the position of the selected antennas. Finally,
as F should specify nT (for selecting the corresponding SnT),
its last 4 − nT rows are set to zero.
For example, if antennas 1 and 4 are selected, matrix F
should permute columns 2 and 4 of S2. Then,
F =




1
0
0
0
0
0
0
1
0
0
0
0
0
0
0
0



 .
(8)
At the transmitter end, the number of ones in F speciﬁes
nT , and the antenna selection into that code is performed
8
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

directly through the product SnTF. Notice that the overhead
transmitting matrix F is limited to 4 bits.
The main difference between this procedure and that stated
in [8] resides in the inclusion of step 5, in which the highest en-
velope’s Rayleigh channel is selected whenever no Nakagami-
k fading envelope is detected to be over ρk in previous steps.
In this condition, it is likely that all SISO equivalent channels
have a low instant envelope value. The selection of a single
antenna is based on the fastest recovery of the Rayleigh
channel, compared with Nakagami-k channels, for k > 1.
IV. RESULTS
For the simulations, symbol-synchronous receiver sampling
and ideal timing have been assumed. Uncorrelated narrow-
band Rayleigh channels were used, modeled as a circular
complex Gaussian variable with zero mean and unit standard
deviation. For simplicity, a zero-delay feedback channel and
perfect channel estimation at the receiver have been assumed.
Maximum likelihood detection was employed in reception.
The transmitter power was maintained constant indepen-
dently of the number of transmitter antennas in use, distri-
buting it evenly over them. The symbol time was Ts = 3.2µs
and the carrier frequency fc = 3.5 GHz. The normalized
Doppler frequency of the simulated channels was 1.28×10−4,
3.84 × 10−4, 6.4 × 10−4 y 8.95 × 10−4, corresponding to
mobile speeds of approximately v = 12 km/h, 37 km/h, 62
km/h and 86 km/h, respectively. Pilot symbols used for channel
selection (feed-forward and feedback STCS information) were
inserted every 140 symbols. Then, for the test channels, a ﬁxed
feedback spacing of 140 symbols was used, which corresponds
to 10%, 30%, 50% and 70% of the channels’ coherence time
(TC), when using the relationship between TC and fd stated
by
TC =
9
16πfd
.
(9)
In order to obtain the same average spectral efﬁciency (3
b/s/Hz) when using the different SnT matrices, an 8 phase
shift keeing (8PSK) modulation was used when selecting one
or two transmitters, while 16 quadrature amplitud modulation
(16QAM) was used when selecting three or four transmitters.
No channel coding was used. Threshold levels were found
for an instantaneous BER objective equal to 1.2 × 10−3 (for
details about the how theshold levels were obtained, see [8]).
The threshold levels values used in the simulations were ρ1 =
ρ2 = −0.43 dB,ρ3 = ρ4 = −1 dB.
To present the simulation results, comparisons should be
make with closed loop multiple-input single output (MISO)
system techniques that use four radio frequency (RF) chains,
i.e., to use four tranmitter antennas and a single receiver
antenna. A considerable effort has been focused on research
regarding MIMO systems, such as in spatial multiplexing and
linear precoding [11]–[16]. However, such systems require
more than one receiver antenna; in fact, they usually require
more receiver than transmitter antennas. The combination of
beamforming and orthogonal STBC (OSTBC-BF) proposed in
[17] and the combination of orthogonal STBC with adaptive
sub-group antenna encoding (OSTBC-SGE) proposed in [18]
are, to the authors’ knowledge, two of the most recent closed
loop MISO systems with four transmitter antennas found in
the literature. As OSTBC-BF requires weighting the transmit
signal with a complex channel vector, 512 bits (four complex
numbers in standard IEEE 754 double precision) feedback
were established for this technique, with the intention of
disassociate system performance with feedback information
accuracy. On the other hand, OSTBC-SGE requires only four
bits feedback.
Figs. 1 to 4 show the BER performance of the constant-
rate STCS (CR-STCS), that is, our proposed technique which
uses the complementary transmission mode, in comparison
with the variable rate STCS (VR-STCS), the OSTBC-SGE
and the OSTBC-BF as a function of the SNR for different
relative velocities between the transmitter and the receiver.
Additionally, the VR-STCS average spectral efﬁciency is
shown. In general, it can be seen that the CR-STCS slightly
sacriﬁces the BER with respect to the VR-STCS, but this
sacriﬁce is compensated with a larger and constant average
spectral efﬁciency. Furthermore, it can be noticed that the BER
performance of the CR-STCS hardly depends on the relative
velocity of the receiver.
In Fig. 1 the aforementioned systems are compared for a
velocity v = 12 km/h. It can be seen that the difference
in performance between CR-STCS and VR-STCS is around
0.3dB for a BER= 1 × 10−3 and 1dB for a BER= 1 × 10−5.
Compared to the OSTBC-BF and OSTBC-SGE techniques, a
signiﬁcant SNR gain is obtained. For example, for a BER=
1 × 10−3, 4.8dB and 6.2dB are respectively obtained.
s11
Eb/No (dB)
BER
Throughput of the VR-STCS technique as a function of Eb/N0
2.8906
2.8895
2.9105
2.8911
2.8889
2.9086
CR-STCS
VR-STCS
OSTBC-BF
2
4
6
8
10
12
14
16
18
10−6
10−5
10−4
10−3
10−2
10−1
1
Fig. 1: BER and throughput comparison of the proposed
technique (CR-STCS) with other schemes for a speed of 12
km/h. The throughputs of CR-STCS, OSTBC-BF and
OSTBC-SGE techniques are constant at 3b/s/Hz.
In Fig. 2 the velocity is v = 37km/h, and when comparing
CR-STCS and VR-STCS a difference of around 0.6 and 1.8dB
9
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

can be observed for a BER equal to 1 × 10−3 and 1 × 10−5,
respectively. However, the spectral efﬁciency, besides being
constant, is a 6% higher than with VR-STCS. Regarding
OSTBC-BF y OSTBC-SGE, again it can be noticed a BER
difference of around 5dB and 7dB for a BER= 1 × 10−3.
Eb/No (dB)
BER
Throughput of the VR-STCS technique as a function of Eb/N0
2.801
2.7961
2.8171
2.7848
2.7936
2.7993
OSTBC-SGE
CR-STCS
VR-STCS
OSTBC-BF
2
4
6
8
10
12
14
16
18
10−6
10−5
10−4
10−3
10−2
10−1
1
Fig. 2: BER and throughput comparison of the proposed
technique (CR-STCS) with other schemes for a speed of 37
km/h. The throughputs of CR-STCS, OSTBC-BF and
OSTBC-SGE techniques are constant at 3b/s/Hz.
Figs. 3 and 4, containing results for v = 62km/h and v =
86km/h, show the same trend. For v = 62km/h the CR-STCS
suffers a performance degradation with respect to VR-STCS
of around 0.7dB and 1.5dB, for a BER equal to 1 × 10−3
and 1 × 10−5, respectively. For v = 86km/h, the degradation
is around 1 and 2dB. In comparison with OSTBC-BF and
OSTBC-SGE, SNR gains higher than 6dB are obtained for
a BER= 1 × 10−3. The increase of spectral efﬁciency with
respect to VR-STCS is higher than 10%. It can be noticed
that VR-STCS achieves a high BER performance through the
rate sacriﬁce. As CR-STCS maintains a constant rate, there is
a higher degradation of CR-STCS in terms of SNR compared
with VR-STCS. However, results show that BER performance
and rate are maintained by the proposed technique.
Finally, Fig. 5 shows the conﬁdence intervals with 95% of
conﬁdence for the Monte Carlo simulation for a velocity v =
12 km/h (see Fig. 1). The ﬂuctuation of the results from the
different simulations is noticeable only for the lowest BER
values. In general, only BER results close to 1 × 10−6 or
lower show a signiﬁcant uncertainty. This is a consecuence of
using a large amount of samples, which increments with the
SNR. As a general rule, for low SNRs half a million samples
were used, as no BER lower than 1 × 10−3 was expected.
For medium SNRs 1 million samples were used, expecting a
BER higher than 1 × 10−4. Finally, for high SNRs 3 millions
samples were used.
Eb/No (dB)
BER
Throughput of the VR-STCS technique as a function of Eb/N0
2.6943
2.7022
2.6973
2.7071
2.7129
2.7149
OSTBC-SGE
CR-STCS
VR-STCS
OSTBC-BF
2
4
6
8
10
12
14
16
18
10−6
10−5
10−4
10−3
10−2
10−1
1
Fig. 3: BER and throughput comparison of the proposed
technique (CR-STCS) with other schemes for a speed of 62
km/h. The throughputs of CR-STCS, OSTBC-BF and
OSTBC-SGE techniques are constant at 3b/s/Hz.
Eb/No (dB)
BER
Throughput of the VR-STCS technique as a function of Eb/N0
2.6194
2.6286
2.6214
2.6529
2.6372
2.6392
OSTBC-SGE
CR-STCS
VR-STCS
OSTBC-BF
2
4
6
8
10
12
14
16
18
10−6
10−5
10−4
10−3
10−2
10−1
1
Fig. 4: BER and throughput comparison of the proposed
technique (CR-STCS) with other schemes for a speed of 86
km/h. The throughputs of CR-STCS, OSTBC-BF and
OSTBC-SGE techniques are constant at 3b/s/Hz.
V. CONCLUSIONS
An
adaptive space-time code selection
technique for
constant-rate transmit diversity wireless systems has been
proposed. The proposed technique selects both the space-time
code and the antennas to be energized, using the instantaneous
channel state information and comparing it with a set of
predeﬁned threshold levels. In case no channel satisﬁes the
established conditions, a complementary mode is chosen, in
10
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

Throughput of the VR-STCS technique as a function of Eb/N0
2.8906
2.8895
2.9105
2.8911
2.8889
2.9086
Eb/No
BER
OSTBC-SGE
CR-STCS
VR-STCS
OSTBC-BF
2
4
6
8
10
12
14
16
18
10−6
10−5
10−4
10−3
10−2
10−1
1
Fig. 5: Conﬁdence intervals of the simulation results for a
speed of 12 km/h (see Fig. 1).
which a single antenna is selected. The addition of the com-
plementary mode allows to obtain a constant-rate transmission
without sacriﬁcing the spectral efﬁciency. Simulation results
show that, when considering the channel state information
obsolescence, the proposed technique widely outperforms
other adaptive transmission techniques. Regarding the original
space-time code selection technique, which provides a variable
rate-transmission, the proposed technique slightly sacriﬁces
the BER performance, in no more than 2dB in the worst
case (for high relative velocity and high SNRs), but attains
more than a 10% increment in spectral efﬁciency. Finally, the
proposed technique achieves a more stable BER performance
with respect to the relative velocity between transmitter and
receiver.
REFERENCES
[1] S. Alamouti, “A simple transmit diversity technique for wireless commu-
nications,” IEEE Journal on Selected Areas in Communications, vol. 16,
no. 8, pp. 1451–1458, Oct. 1998.
[2] V. Tarokh, H. Jafarkhani, and A. Calderbank, “Space-time block coding
for wireless communications: performance results,” IEEE Journal on
Selected Areas in Communications, vol. 17, pp. 451–460, Mar. 1999.
[3] M. Katz, E. Tiirola, and J. Ylitalo, “Combining space-time block coding
with diversity antenna selection for improved downlink performance,” in
IEEE 54th Vehicular Technology Conference (VTC 2001), vol. 1, Atlantic
City, NJ, USA, Oct. 2001, pp. 178–182.
[4] Z. Chen, J. Yuan, B. Vucetic, and Z. Zhou, “Performance of Alamouti
scheme with transmit antenna selection,” Electronic Letters, vol. 39,
no. 23, pp. 1666–1668, Nov. 2003.
[5] I. Bahceci and T. M. Duman, “Antenna selection for multiple-antenna
transmission systems: performance analysis and code construction,”
IEEE Transactions on Information Theory, vol. 49, pp. 2669–2681, Oct.
2003.
[6] W. Wong and E. Larsson, “Orthogonal space-time block coding with
antenna selection and power allocation,” Electronic Letters, vol. 39,
no. 4, pp. 379–381, Feb. 2003.
[7] D. Gore. and A. Paulraj, “MIMO antenna subset selection with space-
time coding,” IEEE Transactions on Signal Processing, vol. 50, no. 10,
pp. 2580–2588, Oct. 2002.
[8] D. Mavares and R. P. Torres, “Space-time code selection for transmit
antenna diversity systems,” IEEE Transactions on Vehicular Technology,
vol. 57, no. 1, pp. 620–629, Jan. 2008.
[9] ——, “Space-time code selection for transmit antenna diversity sys-
tems,” in Proceedings of the First Mobile Computing and Wireless
Communication International Conference, 2006 (MCWC 2006), 2006,
pp. 83–87.
[10] H. Shin and J. H. Lee, “Exact symbol error probability of orthogonal
space-time block codes,” in GLOBECOM 2002 - IEEE Global Teleco-
mmunications Conference, vol. 21, no. 1, Nov. 2002, pp. 1206–1210.
[11] D. Lu and D. So, “Performance based receive antenna selection for
V-BLAST systems,” IEEE Transactions on Wireless Communications,
vol. 8, no. 1, p. 214, Jan. 2009.
[12] H. Lee, S. Park, and I. Lee, “Orthogonalized spatial multiplexing for
closed-loop MIMO systems,” IEEE Transactions on Communications,
vol. 55, no. 5, p. 1044, May 2007.
[13] C.-Y. Chen, A. Sezgin, J. Ciofﬁ, and A. Paulraj, “Antenna selection
in space-time block coded systems: Performance analysis and low-
complexity algorithm,” IEEE Transactions on Signal Processing, vol. 56,
no. 7, p. 3303, Jul. 2008.
[14] Y. Kim, H. Lee, S. Park, and I. Lee, “Optimal precoding for orthogonal-
ized spatial multiplexing in closed-loop MIMO systems,” IEEE Journal
on Selected Areas in Communications, vol. 26, no. 8, p. 1556, Oct. 2008.
[15] Y. Fu, C. Tellambura, and W. Krzymien, “Limited-feedback precoding
for closed-loop multiuser MIMO OFDM systems with frequency off-
sets,” IEEE Transactions on Wireless Communications, vol. 7, no. 11,
p. 4155, Nov. 2008.
[16] Y. Kakishima, T. Kawamura, H. Taoka, and T. Nakamura, “Suboptimal
precoding vector selection scheme combined with frequency domain
scheduling for closed-loop MIMO transmission in LTE-advanced up-
link,” in 2010 IEEE 21st International Symposium on Personal Indoor
and Mobile Radio Communications (PIMRC), 2010, p. 2466.
[17] G. Jöngren, M. Skoglund, and B. Ottersten, “Combining beamforming
and orthogonal space-time block coding,” IEEE Transactions on Infor-
mation Theory, vol. 48, no. 3, pp. 611–627, Mar. 2002.
[18] J. Wu, H. Horng, J. Zhang, J. Olivier, and C. Xiao, “Combining
orthogonal space time block codes with adaptive sub-group antenna
encoding,” Intern. J. Wireless Info. Networks, vol. 12, pp. 179–186, Jul.
2005.
11
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

