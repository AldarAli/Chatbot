89
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Weapon Detection and Classification Based on Time-Frequency Analysis of 
Electromagnetic Transient Images  
Abdalrahman Al-Qubaa and Gui Yun Tian 
School of Electrical, Electronic and Computer Engineering 
Newcastle University, Newcastle upon Tyne, NE1 7RU, UK 
Abd.qubaa@ncl.ac.uk, g.y.tian@ncl.ac.uk 
 
Abstract—Terrorist groups, hijackers, and people hiding guns 
and knives are a constant and increasing threat. Concealed weapon 
detection has become one of the greatest challenges facing the law 
enforcement community today. The fact that most weapons are 
made from metallic materials makes electromagnetic detection 
methods the most prominent and preferred approach for concealed 
weapon detection. Each weapon has a unique electromagnetic 
fingerprint, determined by its size, shape and physical composition. 
A new detection system developed at Newcastle University that uses 
a walk-through metal detector with a Giant Magneto-Resistive 
sensor array has been utilized in this study. The system enables a 
two-dimensional image to be constructed from measured signals 
and used in later image processing. This paper addresses weapon 
detection using time and frequency feature extraction techniques 
based on this new system. The study also employs and compares 
two classiﬁcation techniques for potential automated classiﬁcation. 
Experimental results using guns and non-gun objects in controlled 
and non-controlled environments have demonstrated the potential 
and efficiency of the new system. The classification capabilities of 
the system could be developed to the point that individuals could 
pass through the system without the need to take off other metallic 
objects. The proposed techniques have the potential to produce 
major 
improvements 
in 
automatic 
weapon 
detection 
and 
classification. 
Keywords-sensor 
array; 
electromagnetic 
imaging; 
weapon 
detection; feature extraction; airport security. 
I. 
 INTRODUCTION  
This paper, based on previous work from Al-Qubaa et al. [1], 
presents new results for the proposed weapon detection and 
classification system. There is a growing need for effective, quick 
and reliable security methods and techniques using new 
screening devices to identify weapon threats. Electromagnetic 
(EM) weapon detection has been used for many years, but object 
identification and discrimination capabilities are limited [2]. 
Many approaches and systems/devices have been proposed and 
realised for security in airports, railway stations, courts, etc. The 
fact that most weapons are made of metallic materials makes EM 
detection methods the most prominent and systems/devices built 
on the principle of EM induction have been prevalent for many 
years for the detection of suspicious metallic items carried 
covertly [3]. Walk-through metal detectors (WTMDs) and hand-
held metal detectors (HHMDs) are commonly used as devices for 
detecting metallic weapons and contraband items using an EM 
field. Most WTMD and HHMD units use active EM techniques 
to detect metal objects [4][5]. Active EM means that the detector 
sets up a field with a source coil and this field is used to probe the 
environment. The applied/primary field induces eddy currents in 
the metal under inspection, which then generate a secondary 
magnetic field that can be sensed by a detector coil. The rate of 
decay and the spatial behaviour of the secondary field are 
determined by the conductivity, magnetic permeability, shape, 
and size of the target. Sets of measurements can then be taken 
and used to recover the position, the size and the shape of the 
objects. 
Many other EM imaging techniques have been used in 
WTMDs. These methods include microwave [6], millimetre 
waves [7], terahertz waves [8], infrared imaging [9], and X-ray 
imaging which has been used for luggage inspections in airports 
[10]. All these approaches have advantages and disadvantages 
linked to operating range, material composition of the weapon, 
penetrability and attenuation factors. 
Weapon detection systems currently available are primarily 
used to detect metal and have a high false alarm rate because they 
work by adjusting a threshold to discriminate between threat 
items and personal items, depending on the mass of the object. 
This leads to an increase in the false alarm level [11] [12]. Also, 
the human body can affect the sensitivity of the detector as when 
dealing with low conductivity or small materials, the human body 
can give a stronger signal than the material. This can cause the 
material to pass undetected, giving poor reliability [13]. 
Advanced signal processing algorithms have been used to 
analyse the magnetic field change generated when a person 
passes through a portal. Then pattern recognition and 
classification techniques can be used to calculate the probability 
that the acquired magnetic signature correlates to a weapon, or 
whether it is a non-weapon response [14]. 
 Extracting distinct features from the EM signal is imperative 
for the proper classification of these signals. Feature extraction 
techniques are transforming the input image into a set of features. 
In other words, feature extraction is the use of a reduced 
representation, not a full representation, of an image to solve 
pattern recognition problems with sufficient accuracy. Extract or 
generate features from the EM signal is common method for 
metal detection and classification to represent the possible targets 
of interest. Feature extraction using Time-Frequency analysis has 
been used for stationary targets of backscattered signal [15]. 
Features are extracted from scattered field of a given candidate 
target from the joint time-frequency plane to obtain a single 
characteristic feature vector that can effectively represent the 
target of concern. Joint time frequency analysis was used to 
overcome the limitation of using the Fourier transform (FT) 
series to represent the EM signals which is require an infinite 
number of sinusoid functions [16]. The sinusoid function 

90
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
provides a feasible way of computing the power spectrum for EM 
signal, which is serves as unique fingerprint of the weapon 
detection response to various targets, i.e., weapons, cell phones, 
etc. [17]. 
The literature review revealed that wavelet transform (WT) 
are a successful method for the signal representation of time 
series data such as EM signals [14][18]. WT has been used to 
represent time series data such as ECG waveforms and mine 
signal detection [19]. The WT can be thought of as an extension 
of the classic FT except operating on a multi-resolution basis. 
The results obtained from [20] verify that the WT based 
technique produces features that are suitable for detect and 
identify metallic targets signal data. 
After Feature extraction step, the images can be displayed for 
operator-assisted weapon detection or fed into a weapon 
detection module for automated weapon detection and 
classification. In [21], authors present an artificial neural network 
(ANN)-based 
scheme 
for 
metal 
target 
detection 
and 
classification. The proposed strategy involved the use of various 
neural networks schemes for performing feature extraction and 
classification tasks. It was shown that the use of an ANN in 
multispectral wavelengths provided a useful tool for target 
detection and classification. In [14], a case study on classifying 
metal detector signal for automated target discrimination is 
conducted. In this research an adaptive resonance theory 
networks was used and the results indicate that ANN has a vital 
role to improve the performance of classification. In [10], 
probabilistic ANN classifier used to classifies the extracted 
weapon candidate regions into threat and non-threat objects. The 
proposed framework is evaluated on a perfect database consisting 
of various weapons in different size, type of gun and real images 
and 96.48% accuracy rate has been obtained. In [22], the ANN 
used to differentiate between different target types such as a 
Glock or a starter pistol. A combination of techniques is 
presented that enables handguns to be effectively detected at 
standoff distances. Late time responses that allow threat from 
innocent objects (e.g., mobile phones, keys, etc.) to be 
distinguished from handguns. Information about the optical depth 
separation of the scattering corners, and the degree and shape of 
cross polarization allows ANN to successfully detect handguns in 
that research. 
Support Vector Machine (SVM) has been used recently as   a 
new machine learning methods. SVM is a concept in statistics 
and computer science for a set of related supervised learning 
methods that analyse data and recognize patterns, used for 
classification and regression analysis [23]. In [24], the authors 
revisit an attractively simple model for EM induction response of 
a metallic object using SVM to train and produce reliable gross 
characterization of objects based on the inferred tensor elements 
as discriminators. They focusing on gross shape and especially 
size to evaluate the classiﬁcation success of different SVM 
formulations for different kinds of objects, and noticed that SVM 
has an inherent limitation that it takes a very long time to yield an 
answer in some instances. In [25], the problem of classiﬁcation 
metallic objects using their EM induction response is solved by 
decomposing that response into coefﬁcients and then using SVM 
and ANN to process those coefﬁcients. The performance of each 
method is compared. Since it demonstrate that there is no simple 
relationship between sizes of objects and the overall magnitude 
of their coefﬁcients, learning algorithms are necessary and useful 
in classifying these objects. When trained on all types of objects, 
both the ANN and the SVM are able to classify all objects with a 
good degree of accuracy. In addition, both methods show an 
ability to generalize for noisy test data when trained with noisy 
data.  
A new detection system developed at Newcastle University 
[26] and built in a lab using an ex-service CEIA WTMD, with 
the addition of a Giant Magneto-Resistive (GMR) sensor array 
to capture the EM scattered data from any metallic objects, is 
used in this study.  
The contributions of this paper are: firstly, improve the 
characterization capabilities of the new detection system through 
investigation of the effect of different orientations as well as the 
effect of concealed weapons. Secondly, investigate the 
feasibility of extraction features from WT and FT for weapon 
detection. Thirdly, automatically recognize and classify metallic 
threat objects by using of Support Vector Machine (SVM) and 
Artificial Neural Network (ANN) as classifiers. 
The rest of this paper is organized as follows. Firstly, the 
system design and principles of operation are introduced in 
Section II. Next, system efficiency and test validity are reported 
in Section III, which is followed by details of the feature 
extraction methods used in Section IV. Section V explains the 
classification techniques used. Section VI demonstrates the 
classification test bed setup. Classification results are discussed 
in Sections VII. Finally, the conclusion is outlined in VIII. 
II. 
SYSTEM DESIGN AND PRINCIPLES OF OPERATION 
In this section, a brief description of the detection system will 
be given with the EM images capturing condition. 
A.  System design 
The system used for the experimental tests is based around an 
array of NVE GMR sensors used in conjunction with the 
excitation coil in an ex-service CEIA (Construction Electronics 
Industrial Automation) WTMD. Figure 1 shows a block diagram 
of the system, the new system being converted from a typical 
walk through metal detector system. The signals from the sensor 
array are amplified using an array of signal amplifiers based on 
an INA111 instrumentation amplifier. Data acquisition is 
performed using an 80 channel PXI based National Instruments 
data acquisition system. The use of the PXI based system allows 
data to be acquired on 40 channels at a rate of 125kS/s, or 80 
channels at a rate of 62.5kS/s. The channel count is further 
increased to a maximum of 160 by the use of multiplexer circuits. 
A variable excitation waveform is provided by a function 
generator, the signal from which is also used for data acquisition 
synchronisation. 
The AAL002-02 GMR sensors were chosen because of their 
sensitivity and noise suppression compared with other common 
sensors such as Hall Effect models. The L in the sensor model 
name indicates that low hysteresis (maximum 2%) GMR material 
has been used to fabricate the sensor. This was chosen because it 
was initially intended to utilise an applied magnetic field varying 

91
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
from 0 to a maximum value and the lower hysteresis would 
minimise errors at low fields. However, after initial tests it was 
found that a more stable signal could be achieved by biasing the 
sensor response into its linear region using a DC offset 
superimposed on the excitation signal.  
After several experimental studies the GMR sensor array was 
superimposed on the coil found inside the arch coil panel. The 
coil was positioned after taking an x-ray of the WTMD panel, 
and making investigation for signal measurements as shown in 
Figure 2. 
 
 
Figure 1. Proposed EM system (a) Block diagram, (b) System setup in the 
laboratory [34]. 
 
 
Figure 2. Coil position inside the WTMD panel. 
B. Electromagnetic field imaging 
Figure 3 illustrates the different metallic objects and their 
equivalent EM field images. The samples represent common 
threats and personal objects carried by people.  
The tests were carried out using a 40 sensor array and a 
sample rate of 125 kHz. Thus, the temporal EM field distribution 
as the object moves past the array can be determined. The sensors 
array is aligned with the coil to pick up any distortions in the 
applied field due to the presence of metallic materials. Five 
experiments were carried out with each item and their capturing 
condition being summarized also in [26]. 
The interaction between the applied field and any sensor in 
the array can be captured and the pulse response from a group of 
sensors can be stored by moving the objects, as shown in Figure 
4. If no object is present in the WTMD, the field measured by the 
sensor is unchanged; the presence of a metallic object causes 
distortion of the field, which can then be measured by the sensor. 
 
       Replica-gun 
 
Kitchen-knife 
 
Scissors 
 
 
 
 
Figure 3. Samples with the equivalent EM images. 
 
 
 
 
20
40
60
80
100
120
140
5
10
15
20
25
30
35
40
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
a) 
b) 

92
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 4. Object test set-up. 
In the proposed system, pulsed excitation is applied to the 
coil. Pulsed excitation provides the opportunity to apply an 
interrogating field with rich frequency components in a single 
waveform. In the tests detailed in this paper, a pulse repetition 
frequency of 500Hz was used with a pulse width of 1ms and an 
applied current of 0.5A – 1.5A.  
III. 
SYSTEM EFFICIENCY AND TEST VALIDITY  
This section explains different experimental setups used 
during tests to improve the ability and efficiency of the detection 
system. Also, repeatability is examined to check the validity and 
to confirm the measurements. 
A. Different orientation experimental setups 
To check validity of the proposed system, experiments were 
carried out to study the reflected signals from objects under 
different orientations. 
Figure 6 shows the test set-up for different orientations. The 
objects were moved past the array dynamically and data were 
taken while the object was moving. Data were taken with the 
samples orientated in three directions.  
The results of the orientation test for the kitchen knife sample 
are shown in Figure 6. It can be seen from the images that the 
feature map follows a fairly predictable evolution with the 
rotation of the object; in the x-direction and y-direction the object 
appears as a dipole distribution, with the rotation of the 
distribution correlating to the rotation of the object. In the z-
direction, only one end of the “dipole” is presented to the array, 
so a uni-polar distribution is observed.  
 
 
Figure 5. Orientation Test set-up 
 
Figure 6. Different orientation results from kitchen knife sample test. 
A similar trend follows for all objects; the object appears as 
two peaks in the feature map and as the object is rotated, this 
distribution is rotated from the x-direction image to the y-
direction image. The z-direction, though, exhibits a clear uni-
polar distribution; this is mainly due to the dimensional 
configuration of the sensor array. 
B. Real weapon experimental setup 
In order to verify the new system effectiveness using real 
threatening items, a series of tests using real handguns was 
carried out. This section reports some of the results from these 
tests. 
Six real handguns are used (borrowed from a police station) 
and the specifications of these handguns are listed in Table 1. 
Figure 7a shows the handguns in the sample holder constructed 
for the tests and there reflected EM images are shown in Figure 
7b. The holder was configured to ensure that the samples retained 
a constant and comparable distance and orientation with respect 
to the array during each pass through the system. 
 
  Table 1. SPECIFICATION FOR THE ALL HANDGUNS. 
Sample 
Description 
1 
Small revolver – 0.38” Smith & Wesson – 
Deactivated. 
2 
Revolver – 0.38” Enfield service revolver – 
Deactivated. 
3 
Large automatic – 9mm Glock G17 – Live. 
4 
Large automatic – 0.45 Colt M1911 – Replica. 
5 
Small revolver – Brocock Puma air pistol – Live. 
6 
Small automatic – 7.65mm Walther – 
Deactivated. 
 
The test samples were representative of a range of handguns 
which would be of interest for detection. In general, it is unlikely 
that the deactivated weapons would give a drastically different 
response to the same live weapon. Although the presence of 
   x-direction                   y-direction                    z-direction 
 
 
20
40
60
80
100
120
140
5
10
15
20
25
30
35
40
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
 
 
20
40
60
80
100
120
140
5
10
15
20
25
30
35
40
-0.6
-0.4
-0.2
0
0.2
0.4
 
 
20
40
60
80
100
120
140
5
10
15
20
25
30
35
40
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4

93
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
ammunition clearly increases the volume of material within the 
arch, it would not affect results significantly. 
 
 
 
Figure 7. Handgun samples (a) In sample holder, and (b) Reflected EM image 
results. 
The first set of tests was carried out in the same way as the 
previous detection tests (explained in Section II above). Results 
are shown in Figure 7b and are generally good, as would be 
expected for the controlled test setup. The one exception is 
sample 4, the replica gun, which is very difficult to locate in the 
test results. It had the lowest amplitude response and therefore 
the poorest signal to noise ratio. 
It is notable that samples 2 and 3 gave similar results, 
responding to a type of dipole distribution, indicative of a 
ferromagnetic object made predominantly from a single type of 
metal. The simple form of distribution also indicates that there is 
very little metal in the handle of these objects, and the array saw 
them as a simple tube/block of metal. 
Another test setup for the uncontrolled walk-through tests 
using real handguns is shown in Figure 8a. The handguns were 
carried in the inside jacket pocket of an individual walking 
through the arch. Test results are shown in Figure 8b. The EM 
images for the objects are clearly compressed along the x-axis 
compared to the controlled tests, due to the object moving 
through the arch at a greater speed; however, the actual 
distributions remain very similar. 
 
 
       
                 
Figure 8. Walk-through test (a) Test set-up, (b) Results for all hand guns from 
the walk-through test. 
Figure 9. EM images for the sample #3 - a) Controlled, b) Uncontrolled tests. 
Sensor number
Time - s
Sample #1 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-0.01
-0.005
0
0.005
0.01
Sensor number
Time - s
Sample #2 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-0.015
-0.01
-0.005
0
0.005
0.01
0.015
Sensor number
Time - s
Sample #3 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-0.04
-0.03
-0.02
-0.01
0
0.01
0.02
0.03
0.04
Sensor number
Time - s
Sample #4 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-4
-3
-2
-1
0
1
2
3
4x 10
-3
Sensor number
Time - s
Sample #5 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-0.01
-0.005
0
0.005
0.01
Sensor number
Time - s
Sample #6 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-0.02
-0.015
-0.01
-0.005
0
0.005
0.01
0.015
0.02
b) 
a) 
      Sample #1   
     Sample #2                                 Sample #3 
   Sample #4   
 Sample #5  
                         Sample #6 
      Sample #1   
  Sample #2                     Sample #3 
      Sample #4   
  Sample #5                     Sample #6 
Sensor number
Time - s
Sample #1 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-6
-4
-2
0
2
4
6
x 10
-3
Sensor number
Time - s
Sample #2 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-5
0
5
x 10
-3
Sensor number
Time - s
Sample #3 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-0.02
-0.015
-0.01
-0.005
0
0.005
0.01
0.015
0.02
Sensor number
Time - s
Sample #4 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-4
-3
-2
-1
0
1
2
3
4
x 10
-3
Sensor number
Time - s
Sample #5 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-5
0
5
x 10
-3
Sensor number
Time - s
Sample #6 - VDC
 
 
2
4
6
5
10
15
20
25
30
35
40
-5
0
5
x 10
-3
b) 
Sample #1  
 
Sample #2  
                 Sample #3 
Sample #4  
 
Sample #5  
                 Sample #6 
a) 
b) 

94
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 9 shows the EM images for the controlled and walk-
through tests using the handgun sample #3. The results from the 
walk-through test have been expanded along the horizontal axis 
compared to Figure 8b to aid comparison. Comparison of the 
plots shows that although the controlled and walk-through tests 
did not give identical results, the general form of the EM 
signatures was roughly similar. Thus, using appropriate analysis 
techniques it can be ascertained that the signatures are from 
similar, if not the same object. 
C. Measurement Stability  
In this subsection, system stability is checked by examining 
the repeatability of the experimental tests using a simple 
amplitude calculation. The overall amplitude change for each EM 
signal is plotted for five repetitions of the test for all handgun 
samples. The overall amplitude change is computed by 
subtracting the maximum from the minimum value of each EM 
signal received. The results are plotted in Figure 10 for both the 
controlled and walk-through test. It can be seen from Figure 10a 
that, the controlled test has the greatest repeatability. As well as 
the data trend is similar for the walk-through test as showed in 
Figure 10b. 
 
 
Figure 10. Overall amplitude change for (a) Controlled test, (b) Walk-through 
test. 
IV. 
FEATURE EXTRACTION TECHNIQUES 
Features were extracted from two different techniques (FT 
and WT). A brief background of FT and WT will be provided, 
with the motivation behind their use. In addition to detailed the 
feature extractions algorithm. 
A. Fourier Transform (FT) 
The Fourier series provides an alternative way to represent 
data; instead of representing the signal amplitude as a function 
of time, we represent the signal by how much information is 
contained at different frequencies. Fourier analysis is important 
in data acquisition as it allows one to isolate certain frequency 
ranges. The bridge between time and frequency representation is 
the FT. The signal can be decomposed as a weighted sum of 
sinusoid functions. This provides a feasible way of computing 
the power spectrum for a signal. Fast FT (FFT) is a fast 
algorithm of the discrete FT that represents the signals in the 
frequency domain. The power spectrum serves as the fingerprint 
of the analysed signal [16]. The absolute value will provide the 
total amount of information contained at a given frequency [27], 
and the square of the absolute value is considered the power of 
the signal. In this work the power spectrum (PS) of FFT for each 
EM image using the outcomes from the control test were utilised 
as a feature; each sample gave different PS, as shown in Figure 
11.  
The PS results will be (n*m), so to reduce the data size 
before applied to the classifier, Principle component analysis 
(PCA) techniques [28] was applied and first three PCA 
components were selected as it represent a 99.6% of the data 
variance. Figure 12 shows the behaviour of the PCA feature 
vectors extracted from the FFT process. The test was done using 
the six handguns with the different other not-threat objects. It is 
clear from the figure that the handgun #4 gives very low 
response because it consists of plastic material as well as the 
mobile phone object gives high response because it is full 
charged. Figure 13 shows the flowchart of the gun classification 
procedure using FFT features. 
B. Wavelet Transform (WT) 
In contrast to FFT, Wavelet analysis is useful in 
decomposing 
a 
time 
series 
into 
time-frequency 
space 
simultaneously. The analysis provides information about both 
the amplitude of any "periodic" signals within the series, and 
how this amplitude varies with time. WT can be considered as 
an extension of the classic FFT except that it operates on a 
multi-resolution basis. This multi-resolution property enables a 
signal to be decomposed into a number of different resolutions. 
Each resolution represents a particular coarseness of the signal. 
Preservation of spatial information is another property of WT 
after transformation. This enables the identification of areas in 
the original signal that correspond to particular characteristics 
present in the WT data [29].  
 
1
2
3
4
5
6
0
0.02
0.04
0.06
0.08
0.1
REPEATABILITY - CONTROLLED TEST
Amplitude
Sample number
 
 
Rep 1
Rep 2
Rep 3
Rep 4
Rep 5
1
2
3
4
5
6
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
REPEATABILITY - WALK-THRU, FULL ARRAY
Amplitude
Sample number
 
 
Rep 1
Rep 2
Rep 3
Rep 4
Rep 5
a) 
b) 

95
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 11. Part of the power spectrum of (a) Handgun, (b) Mobile Phone. 
 
Figure 12. Feature vector extracted from the FFT process for 10 objects , #1-#6 
are threat items (handgun samples) and the others (#7-#10) are not-threat items 
(Camera, House Key, Phone and Pen) as sorted number in the figure 
respectively. 
 
Figure 13. Flowcharts of the detailed gun classification procedure using FFT 
features. 
The motivation behind using WT came from a preliminary 
analysis of the raw metal detector signal data. Literature proves 
that WT can be applied successfully as a method of signal 
representation of time series data. An example of this, is its 
application to electrocardiogram signals, which share a similar 
resemblance to metal detector signals [30][31]. Previous research 
also verifies that WT can be used to produce suitable features 
from metal detector data for target classification [14][32]. 
In this study, a discrete WT has been used. ‘Discrete’ refers 
to its discrete sets of dilation and translation factors, and discrete 
sampling of the signal. At a given scale, J, a finite number of 
translations were used in applying multi resolution analysis to 
obtain a finite number of scaling and wavelet coefficients. The 
signal can be represented in terms of the following coefficients 
(Eq. 1) [33]: 
 
         (   )  ∑     
 
   ( )  ∑
∑       ( )
 
 
   
  
        (1) 
 
where    are the scaling functions, CJk are the scaling 
coefficients,     are the mother wavelets and djk are the wavelet 
coefficients.. The first term in Eq. (1) gives the low resolution 
approximation of the signal, while the second term gives the 
detailed information at resolutions from the original down to the 
current resolution J. Daubechies order 4 has been selected from 
the wavelet family and three levels of wavelet decomposition 
have been computed [32].  
1
2
3
4
5
6
7
8
9
10
10
-17
10
-16
10
-15
10
-14
10
-13
10
-12
10
-11
10
-10
10
-9
10
-8
10 objects
FFT Features (Log Scales)
 
 
PCA1
PCA2
PCA3
0
50
100
150
200
250
300
-2
0
2
4
6
8
10
12
14
16
18
20
Frequency
Power Spectrum
0
50
100
150
200
250
300
0
5
10
15
20
25
30
35
40
Frequency
Power Spectrum
a) 
b) 
FFT 
EM Signal 
 
Classifier 
Guns  
Not-Guns 
 
PCA 
      PCA1   PCA2  PCA3 
Power Spectrum (n*m) 
 

96
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Three types of statistical operation were selected from the 
wavelet approximation coefficients (LL) domain to be 
considering as a unique feature for each object, namely Entropy, 
standard deviation (STD) and root mean square error (RMSE). 
Figure 14 shows the ENT, STD and RMSE features for the three 
WT levels using same 10 objects in the previous test, the six 
handguns and the others are the not-threat objects. It can be seen 
from the figure that these feature give good indication to identify 
between handguns and the other objects. However, some of the 
not-threat objects are close to the handguns features, such that 
the entropy of the house key for instance. This leads to combine 
wavelet features with the FFT features to give a good 
classification result.   
 
 
Figure 14.Wavelet features for 10 objects, #1-#6 are threat items (handgun 
samples) and the others (#7-#10) are not-threat items (Camera, House Key, 
Phone and Pen) as sorted number in the figure respectively, for one level WT 
analysis. 
As a result, each EM image had three types of features with 
three levels of decompositions. Thus, a feature vector was 
generated consisting of nine values to be fed to the classifiers. A 
flowchart of the gun classification procedure using the control 
test and features obtained from the WT coefficient is shown in 
Figure 15. 
V. 
CLASSIFICATION TECHNIQUES 
In this work, two different types of classification techniques 
have been applied and compared to evaluate the features which 
extracted from the new system and to adopt the efficient 
classification technique for an automated process. In previous 
work [1], the classification of different objects was performed 
using cross correlation technique. In this work, the classification 
has been performed using ANN and SVM techniques. 
A. Classification using Artificial Neural Network (ANN) 
Neural networks are widely used in pattern recognition and 
classification since they do not need any information about the 
probability distribution and the priori probabilities of different 
classes. In this study, two feature vectors (WT and FFT) were 
used as an input to an ANN classifier alone and in combination 
with each other to find out the most suitable features for 
classification. 
 
 
Figure 15. Flowchart of the gun classification procedure using discrete WT 
features. 
 
 
A three layered ANN classifier was used: input, hidden and 
output layer. The input layer use the input feature vector element 
N, the hidden layer consisted of 2N nodes with the sigmoid 
activation function. The output layer consisted of one node (for 
our study, symbolizing whether it is a gun or not) with a linear 
activation function. The ANN classifier utilized a training 
function based on Levenberg-Marquardt optimization [34]. All 
ANN parameters are summarized in Table 2. 
 
Table 2. ARTIFICIAL NEURAL NETWORK PARAMETERS. 
No. of nodes in Input layer 
: 
Same no. of used feature 
vector elements (N). 
No of nodes in Hidden layer 
: 
Double no. of used 
feature (2N). 
No of nodes in Output layer 
: 
One node (Gun or not). 
Transfer function 
: 
‘logsig’ for hidden layer, 
‘purelin’ for output layer 
Training function 
: 
‘trainlm’ 
Max number of Epochs 
: 
10000 
Min performance gradient 
: 
1e-10 
1
2
3
4
5
6
7
8
9
10
0
0.5
1
1.5
2
2.5
3
10 Objects
WT Features
 
 
ENT.
RMSE
STD
Three-level WT 
Electromagnetic Signal 
 
Feature extraction 
Entropy  
STD 
RMSE 
Feature vector 
 
Classifier 
Guns  
  Not-Guns 
 
LL-1   LL-2   LL-3 
 

97
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
B.  Classification using Support Vector Machine (SVM) 
SVM is a concept in statistics and computer science for a set 
of related supervised learning methods that analyse data and 
recognize patterns. It is used for classification and regression 
analysis. SVM tackle classification problems by nonlinearly 
mapping input data into high-dimensional feature spaces, 
wherein a linear decision hyper plane separates the two 
considered classes. Different kernel functions nonlinearly maps 
samples into the higher dimensional space. Among them, the 
RBF Kernel is the most generally used. In many pattern 
recognition applications, SVM generalization performance is 
either similar or significantly better than other competing 
methods. In opposition to ANN, SVM have few hyper 
parameters to be adjusted [35].  
In this work, a SVM based method was used as a second 
classification method to make a comparison with the results of 
ANN. The four feature vectors were normalised to the range [-1, 
+1] in each column first. The advantages of scaling are that it 
avoids attributes in greater numeric ranges dominating those in 
small numeric ranges, and it avoids numerical difficulties during 
calculation. In this work, the Radial Basis Function (RBF) was 
used as a kernel (K), as in Eq. 2 [23]: 
 
 (     )      (          ) 
    
(2) 
                   
The RBF kernel nonlinearly maps samples into a higher 
dimensional space. Thus, it can handle the case when the 
relation between class labels and attributes is nonlinear. 
Furthermore, the linear kernel is a special case of RBF. Finally, 
the RBF kernel has fewer numerical difficulties. The LIBSVM, 
a library for SVM developed by Chang and Lin [23], was used 
in this work. After training data using SVM, the model was 
obtained for prediction of known objects. The model was tested 
using the training data to identify the classification rate. 
 
VI. 
CLASSIFICATION TESTBED SETUP 
Experiments were conducted with the new EM system to 
classify between guns and non-gun objects. The sample group 
consisted of twelve different objects. Six of the objects were 
handguns, while the others were commonly used objects that 
contain metallic parts. The specifications of all objects used are 
given in Table 3. 
The handgun samples represent the most common weapons 
seized by the police; of particular interest is sample #5, the blank 
firer, which had been converted to fire live ammunition by the 
welding of another barrel to the existing mechanism, and the 
replica hand gun, sample #6, commonly used by armed robbers 
as a threat.  
All samples constructed for the tests were controlled by a 
sample holder. The holder was configured to ensure that the 
samples retained a constant and comparable distance and 
orientation with respect to the array during each pass through the 
system. All weapon sample compositions included steel, with 
several incorporating other materials such as zinc alloy, 
aluminium, and polymers. 
 
 
Table 3. OBJECTS USED IN EXPERIMENTAL TEST: (A) REAL GUNS 
AND (B) COMMONLY USED OBJECTS. 
 
     (a) Real Guns 
 
(b) Other Objects  
#1 
Small revolver  0.516g 
#7 
Mobile phone  
#2 
Small semi-automatic 
0.637g 
#8 
wristwatch 
#3 
Medium revolver  
0.937g 
#9 
House Key 
#4 
Medium semi-automatic 
0.689g 
#10 
Screwdriver 
#5 
Converted blank firer 
0.800g 
#11 
Scissors 
#6 
Replica1  1.140g 
#12 
Kitchen knife 
 
 
Differences between two EM signals for two different 
objects were found to be close to the differences between two 
EM signals for the same object in two tests [26]. This conclusion 
was used to increase the number of samples; each object was 
tested five times using the new system to generate five EM 
samples for the same object. Hence, for the twelve objects under 
test, six were guns and six were non-gun objects, 60 EM 
samples were generated. Based on this, the classifier was trained 
using 48 samples for all objects (four for each object) while the 
remaining 12 samples were used as test samples as explained in 
Table 4. 
 
Table 4. DATA SET OF THE WORK 
Total No. of Images used= 60 
No. of training images 
= 48 
No. of testing images 
= 12 
   Guns 
Non-Guns 
Guns 
Non-Guns 
24 
24 
6 
6 
 
VII. 
CLASSIFICATION RESULTS AND DISCUSSION 
In this section, an assessment of the proposed features for 
object classification is carried out using the two classification 
methods.  
Firstly, each type of feature vector individually provides for 
the ANN and SVM as inputs. The results are shown in Table 5 
and 6 respectively. It can be seen from the tables that there is a 
major difference between ANN and SVM, that while the overall 
classification rates are largest when using the ANN classifier, 
the SVM classifier is more sensitive and shows 0% misdetection 
of the guns group. Although both classification methods give a 
high detection rate in terms of handgun objects, both methods 
give a high misdetection rate for non-gun objects. This is 
because training on these objects is not efficient due to the 

98
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
diversity in their sizes, shapes and materials. The classification 
results could be improved using a larger database size [35]. 
 
Table 5. RESULTS OF ANN FOR EACH FEATURE VECTOR. 
Feature 
vector 
Hidden 
layer 
neurons  
Objects Correctly  
classified 
 
Incorrectly 
classified 
 
Classification 
rate 
WT 
18 
Gun 
5 
1 
83% 
Non-Gun 
5 
1 
83% 
 
10 
2 
83% 
FFT 
6 
Gun 
5 
1 
83% 
Non-Gun 
3 
3 
50% 
 
8 
4 
67% 
 
Table 6. RESULTS OF SVM FOR EACH FEATURE VECTOR. 
Feature 
vector 
Objects Correctly 
classified 
 
Incorrectly 
classified 
 
Classification 
rate 
WT 
Gun 
6 
0 
100% 
Non-Gun 
2 
4 
33% 
 
8 
4 
67% 
FFT 
Gun 
6 
0 
100% 
Non-Gun 
1 
5 
16% 
 
7 
5 
58% 
 
Figure 16 shows the classification results with the average 
error from the ANN and SVM techniques. 
 
 
Figure 16. Classification rate results of ANN and SVM using WT and FFT 
features. 
 
VIII. CONCLUSION AND FUTURE WORK 
This paper has demonstrated an EM metal detector system 
and investigated the feasibility of object identification and 
classification. In comparison with conventional induction based 
WTMDs, the  new GMR array based system has shown great 
potential in objects classification as the samples are made from 
mixed material is identified. Whereas the induction based 
WTMD can only discriminate between metal and non-metal 
object, this system has taken it a step further. Results obtained 
using the WT and FFT-based features have been given in detail 
to show the validity of the new system. The proposed features is 
more advanced in object characterisation as it depends on the 
amplitude distribution of the EM field making training possible 
using a database of objects; unlike traditional thresholding 
adopted in the induction based system, which largely depends on 
material volume. These features were utilized to classify 12 
objects. Six were real handguns and six were different 
commonly used metallic items. The real handguns were 
examined in a controlled and uncontrolled environment such 
that the handguns were either controlled by a holder or carried 
on the inside of a jacket pocket of an individual walking through 
an arch. A comparison between two classification methods, 
ANN and SVM, showed promising results for detecting and 
classifying objects in security applications of EM signal. To 
conclude, WT features, due to their spatial frequency properties, 
showed almost better classification rates than FFT features, 
which have frequency properties. In terms of classifiers, ANN 
classification techniques have a better classification rate in 
general. However, SVM had very high sensitivity and showed 
very low false negative alarm (100% classification rate) in terms 
of handgun samples. These initial results aimed to identify 
possible methodologies for analysis and classify of EM signals.  
For future work, the classification capabilities of the system 
could be developed to the point that individuals pass through the 
system without removing metallic objects from their person. 
This would be realised through “training” the system to identify 
threat objects by presenting the system with a wide variety of 
threat and non-threat objects. Further work can also utilize more 
EM features for accurate detection and classification of threat 
objects. 
ACKNOWLEDGMENT 
This project is funded under the Innovative Research Call in 
Explosives and Weapons Detection (2007), a cross-government 
programme sponsored by a number of government departments 
and agencies under the CONTEST strategy. The authors would 
like 
to 
thank 
cross-government 
departments 
for 
joint 
experimental tests. 
REFERENCES 
[1] 
A. Al-Qubaa, G. Tian, and J. Wilson, “Electromagnetic Imaging System 
for Weapon Detection and Classification”, Proc. Fifth International 
Conference on Sensor Technologies and Applications, SENSORCOM 
2011, August 21-27, 2011, Nice, pp. 317-321, IARIA XPS Press, ISBN: 
978-1-61208-144-1. 
[2] 
A. Agurto, Y. Li, G. Y. Tian, N. Bowring, and S. Lockwood, “A Review 
of Concealed Weapon Detection and Research in Perspective”, 
Proceedings of the 2007 IEEE International Conference on Networking, 
Sensing and Control, London, pp. 443-448, 2007.  
[3] 
C. A. Dionne, J. J. Schultz, R. A. Murdock, and S. A. Smith, “Detecting 
Buried Metallic Weapons in A Controlled Setting using a Conductivity 
Meter”, Forensic Science International, vol. 208, pp. 18-24, 2011. 
[4] 
CEIA 
Security 
Metal 
Detectors. 
[On-line 
09.10.2012] 
http://www.ceia.net/security.  
15%
25%
35%
45%
55%
65%
75%
85%
WT
FFT
Classification rate 
ANN
SVM
Error Averaged

99
International Journal on Advances in Systems and Measurements, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/systems_and_measurements/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
[5] 
 N. G. Paulter, “Users' Guide for Hand-Held and Walk-Through Metal 
Detectors”, NIJ Guide 600-00, NCJ 184433, Office of Science and 
Technology, U.S. Department of Justice, Washington, DC 20531, 2001. 
[On-line 09.10.2012] http://www.nij.gov/pubs-sum/184433.htm.  
[6] 
D. M. Sheen, D. L. McMakin, and T. E. Hall, “Three-Dimensional 
Millimetre-Wave Imaging for Concealed Weapon Detection”, IEEE 
transactions on microwave theory and techniques, vol. 49, pp. 1581-1592, 
2001. 
[7] 
S. Yeom, D.-S. Lee, Y. Jang, M.-K. Lee, and S.-W. Jung, “Real-Time 
Concealed-Object Detection and Recognition with Passive Millimeter 
Wave Imaging”, Opt. Express, Vol. 20, pp. 9371-9381, 2012. 
[8] 
K. B. Cooper, R. J. Dengler, N. Llombart, B. Thomas, G. Chattopadhyay, 
and P. H. Siegel, “THz Imaging Radar for Standoff Personnel Screening”, 
Terahertz Science and Technology, IEEE Transactions on, vol. 1, pp. 169-
182, 2011. 
[9] 
C. Siu-Yeung and T. Nanda-Pwint, “Using Infrared Imaging Technology 
for Concealed Weapons Detection and Visualization”, in TENCON 2010 
- IEEE Region 10 Conference, pp. 228-233, 2010. 
[10] H. Pourghassem, O. Sharifi-Tehrani, and M. Nejati, “A Novel Weapon 
Detection Algorithm in X-Ray Dual-Energy Images Based on Connected 
Component Analysis and Shape Features”, Australian Journal of Basic 
and Applied Sciences, vol. 5, pp. 300-307, 2011. 
[11] US Department of Justice, “Final Report - Demonstration of a Concealed 
Weapons Detection System Using Electromagnetic Resonances”, January 
2001. 
[On-line 
09.10..2012] 
http://www.ncjrs.gov/pdffiles1/nij/grants/190134.pdf. 
J. Ashcroft, D. J. Daniels, and S. V. Hart, “Walk-Through Metal Detectors 
for use in Concealed Weapon and Contraband Detection”, U.S. 
Department of Justice, Office Justice Programs, National Institute of 
Justice, 
2003. 
[On-line 
22.06.2012] 
http://www.nij.gov/pubs-
sum/193510.htm. 
[12] H. M. Chen, S. Lee, R. M. Rao, M. Slamani, and P. K. Varshney, 
“Imaging for Concealed Weapon Detection”, IEEE Signal Processing 
Magazine, Vol. 22, pp. 52-61, 2005. 
[13] M. Tran, C. Lim, C. Abeynayake, and L. Jain, “Feature Extraction and 
Classification of Metal Detector Signals Using the Wavelet Transform 
and the Fuzzy ARTMAP Neural Network”, Journal of Intelligent & Fuzzy 
Systems: Applications in Engineering and Technology, Vol. 21, pp.89-99, 
2010. 
[14] G. Turhan-Sayan, “Real Time Electromagnetic Target Classification 
Using a Novel Feature Extraction Technique with Pca-Based Fusion”, 
Antennas and Propagation, IEEE Transactions on, vol. 53, pp. 766-776, 
2005. 
[15] D. Kotter, L. Roybal, and R. E. Polk, “Detection and Classification of 
Concealed Weapons using a Magnetometer-based Portal”, SPIE 
proceeding, Sensors and Command, Control, Communications, and 
Intelligence (C3I) Technologies for Homeland Defence and Law 
Enforcement, vol. 4708, pp. 145-155, 2002. 
[16] G.Y. Chen and B. Kegl, “Feature Extraction using Radon, Wavelet and 
Fourier Transform”, Systems, Man and Cybernetics, 2007. ISIC. IEEE 
International Conference on ,  pp.1020-1025, 2007. 
[17] H. Krüger and H. Ewald, “Signal Processing and Pattern Recognition for 
Eddy 
Current 
Sensors, 
used 
for 
Effective 
Land-Mine 
Detection”, Autonomous and Intelligent Systems, vol. 6752, pp. 294-302, 
2011. 
[18] F. Zhang and M. Li, “Wavelet Analysis Method of Harmonics and 
Electromagnetic Interference in Coal Mines”, Mining Science and 
Technology (China), vol. 20, pp. 576-580, 2010. 
[19] M. Tran and C. Abeynayake, “Evaluation of the Continuous Wavelet 
Transform for Feature Extraction of Metal Detector Signals in Automated 
Target Detection: New Advances in Intelligent Decision Technologies”, K. 
Nakamatsu, G. Phillips-Wren, L. Jain, and R. Howlett, Eds., ed: Springer 
Berlin/Heidelberg, vol. 199, pp. 245-253, 2009. 
[20] M. Xi, M. R. Azimi-Sadjadi, T. Bin, A. C. Dubey, and N. H. Witherspoon, 
“Detection of Mines and Minelike Targets Using Principal Component 
and Neural-Network Methods”, Neural Networks, IEEE Transactions on, 
vol. 9, pp. 454-463, 1998. 
[21] A. A. David, B. Nicholas, D. R. Nacer, S. Matthew, G. Elizabeth, H. 
Stuart, and A. Ali, “A Multifaceted Active Swept Millimetre-Wave 
Approach to the Detection of Concealed Weapons”, Millimetre Wave and 
Terahertz Sensors and Technology. Edited by Krapels, Keith A.; Salmon, 
Neil A., Proceedings of the SPIE, vol. 7117, pp. 711707-711707-10, 2008. 
[22] C. C. Chang and C. J. Lin, “LIBSVM: A Library for Support Vector 
Machines”, ACM Transactions on Intelligent Systems and Technology, 
vol. 2, 2011. 
[23] J. Fernandez, B. Barrowes, K. O’Neill, K. Paulsen, I. Shamatava, F. 
Shubitidze, and K. Sun, "Evaluation of SVM Classiﬁcation of Metallic 
Objects Based on a Magneticdipole Representation", presented at the 
Detection and Remediation Technologies for Mines and Minelike Targets 
XI, 2006. 
[24] Z. Beijia, K. O'Neill, K. Jin Au, and T. M. Grzegorczyk, “Support Vector 
Machine and Neural Network Classification of Metallic Objects Using 
Coefficients of the Spheroidal MQS Response Modes”,  Geoscience and 
Remote Sensing, IEEE Transactions on, vol. 46, pp. 159-171, 2008. 
[25] G. Tian, A. Al-Qubaa, and J. Wilson, “Design of an Electromagnetic 
Imaging System for Weapon Detection based on GMR Sensor Arrays”, 
Sensors & Actuators A, vol. 174, pp. 75-84, 2012. 
[26] Computing Fourier Series and Power Spectrum with MATLAB, [ On-line 
09.10.2012]. http://faculty.olin.edu/bstorey/Notes/Fourier.pdf. 
[27] A. Sophian, G. Tian, D. Taylor, and J. Rudlin, “A Feature Extraction 
Technique Based on Principal Component Analysis for Pulsed Eddy 
Current NDT”, NDT&E International, vol. 36, pp. 37-41, 2003. 
[28] H.G.Stark, “Wavelets and Signal Processing: An Application-based 
Introduction”, Springer, Heidelberg, 2005. 
[29] S. Mahmoodabadi, A. Ahmadian, M. Abolhasan, M. Eslami, and J. 
Bidgoli, “ECG Feature Extraction Based on Multiresolution Wavelet 
Transform”, 27th IEEE Annual International Conference of the 
Engineering in Medicine and Biology Society, pp. 3902-3905, 2005. 
[30] Q. Zhao and L. Zhang, “ECG Feature Extraction and Classification Using 
Wavelet Transform and Support Vector Machines”, International 
Conference on Neural Networks and Brain, ICNN&B, pp. 1089-1092, 
2005. 
[31] M. Tran, and C. Abeynayake, “Evaluation of the  Continuous Wavelet 
Transform for Feature Extraction of Metal Detector Signals in Automated 
Target Detection”, New Advances in Intelligent Decision Technologies, 
Springer, Heidelberg, pp. 245-253, 2009. 
[32] K. Amolins, Y. Zhang, and P. Dare, “Wavelet Based Image Fusion 
Techniques: An Introduction, Review and Comparison”, ISPRS Journal of 
Photogrammetry and Remote Sensing, vol. 62, pp. 249-263, 2007. 
[33] H. Demuth, M. Beale, “Neural Network Toolbox for use with MATLAB”, 
Mathworks, Inc. Natick, MA , 2002. 
[34] M. Curilem, M. Chac n, G. Acuña, S. Ulloa, C. Pardo, C. Defilippi, and 
A. Madrid, “Comparison of Artificial Neural Networks and Support 
Vector Machines for Feature Selection in Electrogastrography Signal 
Processing”, Engineering in Medicine and Biology Society, Annual 
International Conference of the IEEE, pp. 2774-2777,  2010. 

