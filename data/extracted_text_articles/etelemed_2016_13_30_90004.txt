Smartphone-based Optical System for Blood Coagulation Self-monitoring 
Ramji Sitaraman Lakshmanan and Vitaly Efremov 
Biomedical Diagnostics Institute 
Dublin City University 
Dublin, Ireland 
e-mail: ramji.lakshmanan@dcu.ie; vitaly.efremov@dcu.ie
 
 
Abstract— Blood coagulation self-monitoring is vital in modern 
day 
healthcare, 
in 
particular 
supporting 
patients 
on 
anticoagulant therapy. Commercially-available coagulation 
self-monitoring devices are typically based on conventional 
end-point-based haemostatic tests and, measuring clotting time 
within a narrow range of values being connected to specific 
aspects of clot formation. In the present study, novel optical 
method combined with a smartphone was applied to measure 
the clotting time. The method was utilised for analysis of 
normal whole blood (WB) sample coagulation, activated by 
various tissue factor (TF) concentrations. The results 
demonstrated the ability of such a system to measure a wide 
range of clotting time values with appropriate level of accuracy 
and precision similar to standard thromboelastography (TEG). 
Significantly, the use of a smartphone as an optical detector 
and signal processor potentiates system miniaturisation, 
pertinent to high levels of functionality, cost-efficiency and 
user-friendliness.   
Keywords-blood coagulation; nephelometry; clotting time; 
light scattering; smartphone. 
I. 
 INTRODUCTION 
Oral anticoagulation therapy is prescribed for both 
prophylactic and therapeutic use for patients at increased risk 
of thromboembolism including ones with mechanical heart 
valves [1]. In current practice, the efficacy of anticoagulation 
therapy is routinely determined by blood coagulation 
monitoring. This monitoring is typically based on a clotting 
time value measurement, specifically the time (in seconds) 
taken by method of blood sample activation to commence 
the coagulation process. Clotting time has a simple 
unambiguous interpretation. Its lower value corresponds to 
high blood coagulability and hence, increased risk of 
thromboembolism whereas higher clotting time values 
indicate increased bleeding risk. Furthermore, clotting time 
depends not only on patients’ blood coagulability but also on 
the chosen method of coagulation activation. The oral 
anticoagulation drugs such as warfarin, heparin and many 
others became commercially available more than 60 years 
ago and their dosage monitoring was initially carried out in 
stationary 
clinical 
laboratories. 
More 
specifically, 
coagulation monitoring during a therapeutic regime is of 
critical importance for dosage control, since it provides key 
information about actual drug efficiency and reduces the risk 
of potential bleeding as a result of therapeutic overdose.  In 
current practice, compact coagulometry devices for home-
based self-monitoring are available [2]. The self-monitoring 
makes it possible to reduce the number of visits to clinics 
and optimise the resources of a local health-care system. 
Here, the patient collects a small volume of a blood sample 
with a finger-prick at the time agreed with by a clinical 
specialist, loads it on the device using an appropriate 
mechanism of transfer and records the clotting time value 
detected by the device, which is presented as a measurement 
output. Results are typically obtained in relatively short 
times, ultimately improving patient care and empowering 
patients as it allows them to take more responsibility for their 
own health [3]. 
There are several blood coagulation self-monitoring 
devices available on the market [2][4][5]. The absolute 
majority of these are designed to adapt some of the 
traditional laboratory assay of coagulation for use in self-
monitoring. These conventional assays measure clotting time 
via the intrinsic and extrinsic pathways of the coagulation 
cascade, and selected methods of activation include 
prothrombin time (PT) and activated partial thromboplastin 
time (aPTT). Each assay measures a different part of the 
coagulation cascade. For example, PT uses TF as an 
activator of coagulation via the extrinsic pathway, and is 
sensitive to the effect of many widely-used anticoagulation 
drugs such as warfarin. Moreover, the PT is the only 
coagulation assay which to-date has been effectively 
standardised via the International Normalisation Ratio (INR), 
which explains why the PT assay is the most commonly-used 
in coagulation self-monitoring systems. In contrast, the aPTT 
assay uses negatively-charged contact activation material 
such as glass or kaolin in the presence of phospholipids as an 
activator of coagulation via the intrinsic pathway. This test is 
sensitive to the effect of anti-coagulants such as heparin. A 
panel of self-monitoring devices have been developed to 
essentially automate these assays through the integration of 
mechanical, 
optical, 
and 
electrochemical 
detection 
methodologies. One of the most recognisable device is the 
Roche CoaguCheck [2][4][5], which combines the PT/INR 
assay with microfluidics and a sample warming module. In 
the original device, a blood sample is applied to a disposable 
test strip containing activation reagents and iron filings. 
Next, an electromagnetic field moves the fillings, which is 
detected optically. As clot forms it prevents this movement, 
and the corresponding time where optical signal decays are 
returned to the end-user as the clotting time values. The 
Alere INRatio [5] also uses PT/INR assay and employs 
251
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-470-1
eTELEMED 2016 : The Eighth International Conference on eHealth, Telemedicine, and Social Medicine (with DIGITAL HEALTHY LIVING 2016 / MATH 2016)

electrochemical impedance measurements to determine 
clotting time. However, both systems are not compatible 
with mobile devices, such as smartphones. 
Although blood coagulation self-monitoring devices take 
a quite strong position on the market, there are at least two 
critical aspects that need to be addressed. Firstly, current 
devices typically measure clotting time only within narrow 
range of values since they are specifically adapted to be used 
with certain conventional coagulation assays. This is a quite 
serious limitation for the monitoring of the effect of specific 
and/or atypical anticoagulation drugs. For instance, a 
PT/INR-based device is usually tuned to provide effective 
resolution of clotting time values not exceeding 60 seconds, 
whereas many current therapeutic strategies require the rate 
of coagulation monitoring to be decreased to facilitate 
measurement (see, e.g., [6] where diluted TF activation is 
used and clotting time exceeds normally 4-5 minutes). 
Moreover, Siemens Healthcare has recently published a 
report where the applicability of the standard laboratory 
assays for the monitoring of the effect of novel drugs is 
analyzed [7]. The results set forth in the report show that PT, 
APTT, and other conventional coagulation assays are less 
sensitive or not sensitive to a number of novel effective 
anticoagulants such as thrombin inhibitors (e.g., dabigatran, 
argatroban) and direct 
factor 
FXa inhibitors 
(e.g., 
rivaroxaban).  These novel drugs offer greater advantages 
over the traditional anticoagulants such as warfarin or 
unfractionated heparin which present the aforementioned 
well-documented drawbacks. Therefore, the extension of the 
dynamic range of measured clotting time values seems to be 
crucial for the ongoing evolution of self-monitoring devices. 
In an ideal case scenario, the device should have almost 
unlimited dynamic range, such as that afforded through 
thromboelastograph (TEG). TEG offers assays similar to the 
conventional assays that investigate the intrinsic and the 
extrinsic pathway of coagulation [8] and is notwithstanding 
its deficits, is considered as one of the gold standard in 
coagulation monitoring in clinical laboratories. TEG is not a 
self-monitor since it is too expensive, is not compact and has 
a level of operational complexity. Hence, reaching the 
TEG’s level of performance and functionality but in the form 
of simple and compact device is an actual challenge for the 
biomedical diagnostic industry in developing innovative 
assays monitoring the onset of coagulation. 
Other imperfections of the current coagulation self-
monitoring devices include their poor compatibility with the 
modern 
telecommunication 
technologies. 
A 
simple 
connection to a smartphone with a specific application (App) 
on-board may deliver a new level of functionality, 
communicability and user-friendliness.  
A novel optical method for blood coagulation monitoring 
is presented in this work. The method is based on recording 
of an optical signal acquired from a whole blood (WB) 
sample. The physical principle is optical nephelometry [9] 
where intensity of the light scattered by red blood cells 
(RBC) during their sedimentation is recorded. The time at 
which the fibrin clot becomes strong enough to stop the RBC 
sedimentation process is returned as the clotting time. The 
method has a wide dynamic range of measured clotting time 
values and is successfully implemented in the form of a 
compact device where a smartphone is used as the optical 
detector and the signal processor.  
The paper is organized in four sections. In Section 2, the 
assay methodology, optical system operation principle and 
software algorithm are presented. In Section 3, the results are 
presented and compared to TEG. Finally, in Section 4, the 
conclusions are evidenced. 
II. 
MATERIALS AND METHODS 
A. Preparation of blood samples 
Normal healthy controls were recruited at Dublin City 
University and patients with cardiovascular disease or 
individuals taking anti-platelet medication (e.g. Aspirin) 
were excluded from the study. Venous blood was collected 
from the antecubital vein with minimum stasis, and was 
citrated to provide a final sodium citrate concentration of 
10.5mmol/L. Blood was stored at 370C for a period no 
longer than 60 min post-collection. Coagulation was 
activated by diluted tissue factor reagent (Dade Innovin®) 
which was obtained from Sysmex. Three types of TF reagent 
dilution (0.29, 2.9 or 29.0 pM) were used. A 10uL aliquot of 
TF and 10uL of saline were added to a vial containing 100 
uL of whole blood (WB) sample, maintained at 37°C, and 
incubated for 5 minutes. Pre-warmed (37°C) 10uL of CaCl2 
(100 mM) was added to this vial and 20uL of this mixture 
was introduced into measurement cuvette and immediately 
transferred to the measurement chamber of the optical 
system. 
B. Optical System 
The system’s optical layout is shown on Figure 1. The 
measurement chamber consists of a rectangular hole in a 
black nylon panel body sealed with a transparent plastic 
window from below. The polycarbonate rectangular cuvette 
containing the WB sample is loaded vertically to the 
measurement chamber. The black nylon panel body also 
contains a rectangular-shape adit with a mirror on its distal 
end to collect the light scattered by the sample via one of the 
four cuvette walls. The proximal end of the adit is sealed by 
a transparent light collection window being in direct optical 
contact with the lower half of measurement chamber volume. 
The system also comprises a source of collimated light, a 
warming module and an optical focusing module. The source 
of collimated light is a diode laser module with focusing 
elements (wavelength:650nm, power: 3mW, spot diameter: 
~1mm) located directly above the measurement chamber. 
The focusing module comprises a mirror, apertures and 
lenses to deliver the light from the adit’s mirror to an optical 
detector pupil. Finally, a Samsung Galaxy S3 smartphone 
was used as the optical signal processor with its main camera 
being used as the optical detector. 
The operational principle of the system is very similar to 
nephelometry. Here, a laser light beam passes through the 
liquid sample introduced into the measurement chamber. If 
the chamber is empty or the sample is transparent, the light 
passes through the chamber with no scattering and minimal 
loss of intensity. However, when the analytical sample is 
252
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-470-1
eTELEMED 2016 : The Eighth International Conference on eHealth, Telemedicine, and Social Medicine (with DIGITAL HEALTHY LIVING 2016 / MATH 2016)

 
 
  
turbid, this effects light scattering in a wide range of spatial 
angles. In this analysis, the scattering indicatrix depends on 
sample thickness, chamber geometry, and the concentration 
and shape of the light-scattering particles in the sample of 
interest. There are numerous examples of technologies with 
diagnostic applications which are based on interactions of 
red light with blood cells, and one may find typical scattering 
indicatrices elsewhere (see, e.g., [10]). The part of the 
scattered light leaving the measurement chamber through the 
light collection window is delivered to the smartphone 
camera pupil. The advanced design of the system could also 
incorporate a panel of microfluidic channels and additional 
chambers for blood sample preparation, incubation, mixing 
with specific reagents. However, the current design does not 
integrate these features. 
The customized software (Android App) driving the 
camera, recording and processing the optical signal was 
written in Processing© 2 Java-style language with the use of 
Android® Development Tools and Ketai© library. The App 
takes the 640x480 pixel image every 0.25 sec and crops it in 
order to operate with its central region (100x100 pixel) 
where the light spot is located. The red colour channel is 
used only. When 3 images are taken and cropped, the camera 
signal value, CS, is calculated as follows: 

CS = {RPIi
1+RPIi
2+RPIi
3}/7650000

where RPIi
1,2,3 is the red-channel pixel intensity in a 
format of 8-bit number (0-255 scale) for the first, second and 
third images taken, respectively. Summation is set for the 
entire 100x100 pixel array, i.e., for a total of 10,000 pixels. 
The 
result 
of 
summation 
is 
then 
divided 
by 
7650000=255x3x100x100, i.e., by a product of maximal 
single pixel intensity value, the number of images taken and 
the size of the pixel array.  
Figure 1. Optical schematics of the blood coagulation monitoring system 
and its actual implementation based on Samsung Galaxy S3 smartphone. 
Thus, CS is proposed to be a normalised value 
characterising a luminosity level in the range from 0 to 1, 
i.e., from absolute darkness to a camera saturation level 
respectively. The App generates CS values every 1.0 sec and 
stores it in a phone memory. Further, the signal time-course, 
CS = CS(t), alongside with the key diagnostic indices 
characterising coagulation can be directly seen on the 
smartphone screen or transferred to a PC via a USB port 
connection. The App also comprises an interface for the 
camera adjustment procedure, which is recommended to be 
completed before every signal recording session in order to 
provide 
reproducible 
results 
and 
maximise 
camera 
sensitivity. The user-friendly adjustment routine involves 
firstly switching the laser module off, and subsequently 
adjusting the camera to its “auto-settings” mode with the 
focus being set to “infinity”. Auto-adaptation of the camera 
to absolute darkness makes its sensitivity intensely high, and 
close to the limit afforded by Android hardware drivers. 
Next, the “auto-settings” mode is locked following which the 
laser module can be switched on. At this stage, the camera is 
ready for the sensitive measurement and reproducible signal 
recording.  
III. 
RESULTS AND DISCUSSION 
Typical time-courses of the camera signal recorded by 
the system for normal WB samples are presented in Figure 2. 
For these initial measurements, coagulation was not activated 
and the observed monotonous increase in camera signal can 
be explained by the continuous sedimentation of RBCs onto 
the sensor surface, with haematocrit concentrations directly 
influencing red light scattering efficiency. During the initial 
stages of signal recording, WB samples can be identified as a 
suspension of homogenously-distributed cells in plasma. As 
RBCs sediment, there is a proportional increase in the 
concentration of cells at the bottom of the chamber, and an 
inverse decrease in cell concentration at the top of the 
chamber. 
Figure 2. Camera signal recorded for not coagulating blood samples 
collected from 3 normal healthy individuals. 
253
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-470-1
eTELEMED 2016 : The Eighth International Conference on eHealth, Telemedicine, and Social Medicine (with DIGITAL HEALTHY LIVING 2016 / MATH 2016)

 
  
Figure 3. Camera signal recorded for coagulating blood sample collected 
from 1 normal healthy individual and activated by different TF 
concentrations.  
Concomitantly, the camera signal also increases since the 
light-receiving window is located at the lower half of the 
measurement chamber volume, and is in proximity to the 
sedimenting RBCs. The suspension of cells tends to reach its 
final state where the lower part of the volume is occupied by 
RBC mass, with the almost transparent plasma layer settling 
on top of this. It is important to note that the camera signal 
doesn’t stop increasing during at least 1000 sec of the test 
when non-coagulating blood samples are selected for 
analysis. RBC count and sedimentation rate are the 
physiological parameters which can directly affect the 
scattered light intensity. The variable normal range is one 
contributing factor to the differences observed in the signal. 
A second contributing the factor the observed differences in 
the signal is due to the fact that the liquid sample is housed 
in the open-top cuvette and, hence, its upper layer forms a 
meniscus playing the role of a lens with optical 
characteristics which are challenging to predict. In order to 
perform an adequate comparative analysis, it seems 
reasonable to normalise time-course by the signal value 
corresponding to some point in the beginning of the reading. 
 Figure 3 represents the camera signal time-courses in the 
normalised form recorded for a WB sample collected from 
the same healthy individual and activated by 4 different 
concentrations of TF, namely 29pM, 2.9pM, 0,29pM and 
0pM (non-coagulating). Every time-course is normalized by 
its value corresponding to 40sec after start of the test. One 
can see that the profile of the RBC sedimentation curve has 
deviated (at approximately 80s) from its normal course 
during coagulation.  This point of deviation can be 
interpreted as the state of a sample where the fibrin clot 
becomes strong enough to prevent the RBC sedimentation 
process, and the corresponding time can be measured as the 
clotting time. Moreover, if TF concentration is higher the 
deviation is observed earlier, strongly suggesting that it is 
indeed indicative of the start of the coagulation process. 
Moreover, the time-course tends to decrease after the break-
point since the growing fibrin network influences the 
scattering characteristics of the sample. 
Figure 4. Clotting time determination by the threshold binary function. The 
results correspond to the camera signal time courses presented on Figure 3. 
Indeed, single fibrin fibres can be presented as thin and 
long cylinders with a diameter from 50 to 200nm [11], i.e., 
comparable with the quarter of the light wavelength. Hence, 
the fibrin network is a quite effective scattering object 
preventing straight light propagation through the sample and 
reducing its intensity at the lower half of the measurement 
chamber where the light collection window is located. 
In order to measure actual clotting time based on the 
above measurement outputs, a simple data processing 
algorithm was developed. Here,TBF(t) is a threshold binary 
function taking two possible values of -1 or +1 indicating 
two possible states of a blood sample, namely “coagulating” 
or “non-coagulating” respectively. The CS value is being 
updated every 1.0 sec during the test. Let’s consider the time 
series, CS50(t), containing 50 CS values following the current 
CS=CS(t) value. Let A(t) and SEA(t) be the first coefficient 
(slope) of linear regression for CS50(t) and its standard error 
respectively.  

TBF(t) = sign(A(t) — 2SEA(t)).

One can see that the TBF(t) function indicates “non- 
coagulating state” (TFB(t)=+1) only where the slope of the 
camera signal time-course takes the statistically significant 
positive value. If the slope cannot be determined by linear 
regression or its value is negative the TBF(t) function 
indicates “coagulating state” (TFB(t)=-1). Thus, the time 
where threshold binary function changes its value can be 
returned as the clotting time (see Figure 4). One obvious 
weakness of the algorithm is that it requires > 50 seconds to 
make a decision since the clotting time is detected 
retrospectively. On the contrary, a strong point of the 
algorithm is the low risk of false clot detection insofar as 
TFB(t) function value is always equal to +1 for a non- 
coagulating blood sample. Other strong point is that TFB(t) 
function changes its sign only once and there are no multiple 
shifts for all three coagulating samples. Therefore, the 
algorithm 
provides 
unambiguous 
clotting 
time 
determination. 
254
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-470-1
eTELEMED 2016 : The Eighth International Conference on eHealth, Telemedicine, and Social Medicine (with DIGITAL HEALTHY LIVING 2016 / MATH 2016)

  
 
Figure 5. Comparison of clotting time values measured by the presented 
optical system and TEG for 5 healthy individuals and 3 TF levels. 
As previously mentioned, clotting time depends not only 
on the blood sample coagulability but also on concentration 
and type of activation reagent. Coagulation self-monitoring 
device is supposed to use some standardized assay. If 
activation assay is based on TF, its concentration should be 
fixed in order to capture and recognise actual coagulability 
status of a sample.  
In the present study, the real patients with abnormal 
coagulability and/or taking anticoagulation drugs were not 
available for examination. Thus, the inverse methodology 
was applied where 3 different TF concentrations were used 
for coagulation activation for conventionally normal blood 
coagulability status. In order to approve the method 
relevance and estimate the dynamic range of detectable 
clotting time values 5 normal healthy individuals were 
examined. The results then were compared to TEG. Scatter-
plots for the clotting times evaluated by the presented system 
versus TEG R-values (clotting time equivalent in terms of 
TEG) are presented in Figure 5. Total number of data points 
is equal to 3x5=15, and we demonstrate a strong correlation 
between the two methods. 
The 
fitting 
line 
intercept 
parameter 
equal 
to 
approximately 5 sec indicates the existence of an offset in the 
clotting time values measured by the two methods. Figure 6 
represents the offset value along the measured clotting times. 
One may note that the system accuracy tends to be lower for 
the slower blood coagulation process. The delay in clot 
detection can be explained in terms of the optical system 
measurement principles. Here, a clot is detected only when 
the fibrin network is strong (or mature) enough to stop the 
RBC sedimentation, i.e., at some time after the actual 
physical appearance of the first fibrin fibres in the sample 
volume.  
Nonetheless, the agreement between the system 
presented herein and the gold standard TEG is appropriate, 
and the offset can be corrected by more advanced data 
processing algorithms in the future system. 
 
Figure 6. Bland-Altman plot for the presented optical system and TEG for 
5 healthy individuals and 3 different TF levels. 
IV. 
CONCLUSION 
Here, a novel optical coagulation monitoring method was 
developed and implemented in a form of compact system 
where a commercially-available smartphone is used as the 
optical detector and the signal processor. The customized 
Android App was developed to calibrate and drive the 
smartphone camera, record the optical signal during the test 
and process the data in order to return clotting time value 
being the main output parameter of the monitoring. The data 
processing algorithm provides low risk of false clot detection 
and precise clotting time measurement. 
The method was approved by the series of clotting time 
measurements with tissue factor activation assay for 5 
normal healthy individuals and 3 tissue factor concentrations. 
The results correlate well with the gold standard 
thromboelastography method, and demonstrate the ability of 
the method to measure a wide range of clotting time values 
with high levels of precision. The use of a smartphone as a 
part 
of 
future 
self-monitoring 
system 
can 
provide 
compatibility with modern telecommunication technologies, 
high level of functionality, cost-efficiency and user-
friendliness. 
ACKNOWLEDGMENT 
The work was supported by the Science Foundation 
Ireland under Grant No. 14/TIDA/2443. 
REFERENCES 
[1] T. Christensen, “Self-management of oral anticoagulation 
therapy - Methodological and clinical aspects,” Dannish Med. 
Bull., 58(5), B4284, 2011.  
[2] L. Harris, V. Castro-Lopez, and A. Killard, “Coagulation 
monitoring devices: Past, present, and future at the point of 
care,” Trends Anal. Chem., 50, 2013, pp. 85–95.  
[3] M. Bissell and F. Sanfilippo, “Empowering patients with 
point-of-care testing,” Trends Biotechnol., 20, 2002, pp.269–
270. 
255
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-470-1
eTELEMED 2016 : The Eighth International Conference on eHealth, Telemedicine, and Social Medicine (with DIGITAL HEALTHY LIVING 2016 / MATH 2016)

[4] A. van den Besselaar and M. Hoekstra, “Long-term stability 
and reproducibility of CoaguChek test strips,” Thromb. 
Haemost., 93(6), 2005, pp. 1189-1192.  
[5] A. van den Besselaar, F. van der Meer, C. Abdoel, and E. 
Witteveen, “Analytical accuracy and precision of two novel 
Point-of-Care systems for INR determination,” Thrombosis 
Research, 135(3), 2015, pp. 526-531.  
[6] S. Butenas, C. van’t Veer, and K. Mann, ““Normal” 
Thrombin Generation,” Blood, 94(7), 1999, pp. 2169-2178. 
[7] D. Funk, “ Coagulation assays and anticoagulant monitoring,” 
Hematol. Am. Soc. Hematol. Educ. Program. 2012, pp. 460–
465. 
[8] M. 
Thakur 
and 
A. 
Ahmed, 
“A 
Review 
of 
Thromboelastography,” Int. J. Perioperative Ultrasound and 
Appl. Techn., 1(1), 2012, pp. 25-29. 
[9] H. Oishi, Y. Hatayama, H. Shiraishi, Y. Miyashita, and Y. 
Sakata, 
“Development 
of 
a 
multifunctional 
laser 
nephelometer using backward light scattering detection for 
clinical diagnosis of blood coagulation and fibrinolysis,” 
Industrial Metrology, 1(1), 1990, pp. 55-58. 
[10] M. Yurkin et al., “Experimental and theoretical study of light 
scattering by individual mature red blood cells by use of 
scanning 
flow 
cytometry 
and 
a 
discrete 
dipole 
approximation,” Appl. Opt., 44(25), 2005, pp. 5249-5256. 
[11] E. Ryan, L. Mockros, J. Weisel, and L. Lorand, “Structural 
Origins of Fibrin Clot Rheology,” Biophys. J., 77, 1999, pp. 
2813-2826. 
 
 
 
 
256
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-470-1
eTELEMED 2016 : The Eighth International Conference on eHealth, Telemedicine, and Social Medicine (with DIGITAL HEALTHY LIVING 2016 / MATH 2016)

