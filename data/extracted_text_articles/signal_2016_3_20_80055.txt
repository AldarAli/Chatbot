Time to Digital Converter Transfer Function Improvement using 
Poisson Process Events 
Timoth√© Turko1, Anastasia Skilitsi2, Wilfried Uhring1, Jean-Pierre Le Normand1, Norbert Dumas1, Foudil 
Dadouche1, J√©r√©mie L√©onard2 
1)ICube, UMR 7357, Universit√© de Strasbourg and CNRS, 23, rue du Loess, 67037 Strasbourg, France 
2) Institut de Physique et Chimie des Mat√©riaux de Strasbourg & Labex NIE, Universit√© de Strasbourg, CNRS UMR 7504, 
23 rue du Loess, 67034 Strasbourg Cedex, France 
Email: wilfried.uhring@unistra.fr 
 
Abstract‚Äî This paper introduces a fast and efficient method to 
characterize a Time to Digital Converter (TDC) transfer 
function using Poisson process events. We propose a correction 
method appropriate for ASIC as well as discrete or FPGA 
TDCs, to be implemented on a post process unit located after the 
Time to Digital Converter. We then apply the presented method 
to a case study that demonstrates the efficiency of the correction 
by measuring the fluorescence lifetime of a test fluorophore by 
time-correlated single photon counting (TCSPC) with and 
without correction. The results show a much nicer signal and 
better fitting with a 3-fold improvement of the fluorescence 
lifetime accuracy. 
Keywords - Time to Digital Converter; TDC; Poisson Process; 
SPAD; Characterization; Correction; Fluorescence Lifetime 
I. 
 INTRODUCTION 
With the apparition of low cost Single Photon Avalanche 
Diodes (SPAD) fabricated in standard CMOS technologies, 
more and more applications based on Time of Flight (TOF) 
measurements are emerging such as active 3D video cameras 
[1]. These systems need to measure a precise time duration 
separating two physical events such as a laser pulse generated 
by a laser diode and a photon detection event by the SPAD. 
By TOF measurement, it is possible to deduce the distances 
traveled by the photon. To measure this fast event duration, 
Time to Digital Converters (TDCs) are commonly used to 
convert the physical time information into digital information 
ready for a processing unit. Several techniques can be 
employed to design a TDC such as Tapped Delay Line, Delay 
Locked Loop, Gate Ringed Oscillator, etc. Those functions 
can be implemented on ASIC or FPGA targets [2]. 
The TDC transfer function includes some major and/or 
minor flaws, resulting from conception and/or fabrication 
defects and uncertainties. Certain elements of the TDC chain 
are slower or faster than others, resulting in a systematic error 
that will appear on the transfer function (nonlinearity error, 
missing bins, etc.). The aim of this paper is to present a 
characterization method and a simple corrective patch to 
improve all type of TDCs [3]. It is organized as follows: 
Section II gives a brief description of the TDC measurement 
principle, Section III describes the characterization method 
based on the measurement of Poisson Process Events. A 
simple correction method is introduced in Section IV and 
tested in Section V. We demonstrate its efficiency in a case 
study where the fluorescence lifetime of a fluorophore is 
determined by time correlated single photon counting 
(TCSPC) [4] carried out with a FPGA-based TDC.  
II. 
OPERATION PRINCIPLE OF A TDC  
A TDC is an electronic system used to measure time 
intervals between two physical events. The first event 
generates an electrical signal, which initiates the time 
measurement. The second event generates a second signal 
that ends the time measurement. 
The time measurement is generally divided in two 
different processes as shown on Figure 1, corresponding to 
fine and coarse time scales. First, the first signal starts the 
coarse measurement that is synchronous with the system 
clock. The fine measurement is also triggered by the first 
signal but it is an asynchronous measurement of the time. The 
fine counter is used to measure with a sub-clock period 
precision the duration between the signal trigger and the first 
edge of the clock signal. In order to have the same precision 
between the stop signal and the last clock edge, a second fine 
counter is used, see (1). The fine measurement unit is the most 
critical element of the whole TDC because the time resolution 
is mainly related to its precision. According to this timing 
diagram, the total measured time is expressed as follows: 
 
Tm = TFine1 + TCoarse ‚Äì TFine2 = N‚àôTclk + T Fine1 ‚Äì TFine2 (1) 
 
 
Figure 1. Operation principle of a Time-to-Digital Converter 
III. 
TDC CHARACTERIZATION WITH POISSON PROCESS 
EVENTS 
In order to create a correction method applicable to any 
type of TDC, the proposed method relies on data post 
processing. The first step of the proposed method is the 
50
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-487-9
SIGNAL 2016 : The First International Conference on Advances in Signal, Image and Video Processing

characterization of the TDC. The approach consists in 
measuring a perfectly uniform distribution of temporal events 
in order to evaluate the accuracy of all TDC bins. Bin 
accuracy refers to the temporal size of each bin. Indeed, if a 
bin of the TDC is temporally larger than it should be, it 
gathers more events from the uniform distribution and thus 
the total count of this bin is higher. Inversely, a smaller bin 
shows a total count proportionally lower than expected. A 
perfect generator of random uncorrelated events is a SPAD 
that detects photons generated by a ‚Äúcontinuous wave‚Äù (CW) 
light source such as a battery-powered Light-Emitting Diode 
(LED). Indeed, the single photon detection is well known to 
be an ideal Poisson Process which is completely uniform and 
uncorrelated. 
An ideal TDC should detect the exact same number of 
photons per time bin, resulting in a flat histogram. If a defect 
appears on the TDC chain, the error is temporally static. This 
means that if the measurement is done several times the same 
error will occur every time and a Fixed Pattern Noise (FPN) 
will appear on the measured histogram. In addition, due to 
Poisson statistics, on each measurement, a random noise is 
added to each bin such that a bin with a value N is affected 
by a random value equal to ‚àöùëÅ rms leading to a signal to 
noise ratio of the bin value also equal to ‚àöùëÅ. Thus one must 
ensure that the detected FPN is not due to the random noise 
of the measurement by checking that its value is well above 
‚àöùëÅ. 
 
 
Figure 2. TDC FPN measured over a range of 40 ns by the detection of a 
large number of non-correlated Poisson events 
 
For example, the histogram displayed in Figure 2 results 
from a 10 seconds acquisition under a counting rate of 1800 
kHz with the FPGA based TDC described in [5] with a 
temporal resolution of 89 ps over a range of 40 ns. In the 
specific case of this TDC, the fine counter is a Tapped Delay 
Line made of 56 elementary delay cells of 89 ps for a total 
length of 5 ns. This fine TDC counter is thus periodically 
reinitialized every 5 ns when the coarse counter is 
incremented. Hence the overall FPN of the TDC is the 
periodic repetition of the FPN characterizing the 5-ns-long 
tapped delay line used for the fine TDC counter. Figure 3 
displays a zoom on this 5-ns long FPN motif. 
 
 
Figure 3. FPN corresponding to the fine TDC counter, periodically 
repeated every 5ns (coarse counter). Red line indicates the mean bin value. 
 
The overall photon accumulation time is large enough that 
the uncertainty ‚àöùëÅ due to Poisson statistic on the average 
number N of photons per bin becomes much less than the 
detected variation of N from bin to bin, i.e., the FPN 
amplitude (see Figure 3). The observed FPN is coming out 
from the delay mismatch of the tapped delay line used for the 
fine TDC counter. 
Another method for Poisson process events generation 
using a SPAD is to exploit the photodetector dark count rate 
originating from thermal activation at ambient temperature. 
Figure 4 displays the FPN histogram characterizing the fine 
counter upon accumulating dark counts for over 10 minutes 
when the SPAD is maintained in pitch dark. The dark count 
rate is 250 Hz in this case. We note that the FPN is very 
similar to that of Figure 3, as expected, since it is a property 
of the TDC, independent of the process (light or dark counts) 
generating the Poisson distributed events. However, the FPN 
characterization with a CW light source is much faster 
(higher counting rate) and therefore preferred. Other light 
sources like day light and neon light (100 Hz frequency) have 
been tested yielding the same FPN histogram. 
. 
 
Figure 4. TDC FPN histogram measured from the dark counts generated by 
the SPAD 
 
51
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-487-9
SIGNAL 2016 : The First International Conference on Advances in Signal, Image and Video Processing

The above FPN measurement can be used to retrieve the 
TDC transfer function without the need of a complex delay 
generator. As mentioned before, if a bin of the TDC is 
temporally larger than the mean bin size, its number of counts 
is correspondingly increased. Consequently, the absolute 
time TDC transfer function can be extracted from the bin 
values with: 
 
 
1
1
( )
n
i
M
i
i
i
T
TDC n
bin
M
bin
ÔÄΩ
ÔÄΩ
ÔÉó
ÔÉ•
ÔÉ•
  
(1) 
 
Where T is the total time range, M is the total number of TDC 
bins in the time range T. The extracted transfer function of 
the TDC over the 5-ns time range of the fine counter is 
presented in Figure 5. The linear fit allows the 
characterization of the Integral Non Linearity of the TDC. 
The results obtained with this method are consistent with the 
measurements reported in [5]. 
 
 
Figure 5,a. Transfer function of the 5-ns long tapped Delay Line of the fine 
counter of the TDC, characterized with cw light illumination of a SPAD 
 
 
Figure 5,b. INL of the 5-ns long tapped Delay Line of the fine counter of 
the TDC, characterized with cw light illumination of a SPAD 
IV. 
CORRECTION METHOD 
The FPN evidenced in Figure 2 being a systematic bias, it 
will also affect histograms recorded in TCSPC experiments. 
Moreover, it can be used to define a scaling factor for each 
bin so as to correct, by post-processing, the TDC transfer 
function. This factor is simply the deviation of the count 
number of each bini of the reference FPN histogram relative 
to the average value (red line in Figure 3), such that the 
corrected bin count binci is given by: 
 
 
1
1
M
i
i
i
i
bin
M
binc
bin
ÔÄΩ
ÔÄΩ
ÔÉ•
  
(2) 
 
Where M is the total number of TDC bins in the reference 
FPN histogram. The correction applied to the FPN histogram 
leads to a completely flat histogram, by construction. 
V. 
CASE STUDY  
In the following, the characterized TDC is used in a 
TCSPC experiment to measure the fluorescence lifetime of 
fluorescein dissolved in water buffered at pH = 7.4. 
A picosecond, 405-nm laser pulse [6] excites the 
fluorescence. The fluorescence signal is detected by a SPAD 
and the arrival time of individual photons relative to the 
previous laser pulse is measured and stored by the TDC on 
the FPGA board. Figure 6 shows the raw measurement 
without applying the TDC correction. 
 
Figure 6. Fluorescence decay without correction 
 
The imperfect transfer function of the TDC creates a static 
pattern (FPN) at the origin of the periodic glitches in the raw 
histogram. The 5-ns periodicity of the FPN is clearly seen in 
this data. The fit to a mono-exponential decay yield a lifetime 
of 4.21 ns ¬±0.08 ns. 
52
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-487-9
SIGNAL 2016 : The First International Conference on Advances in Signal, Image and Video Processing

 
Figure 7. Fluorescence decay with correction 
 
The same data are post-processed by applying to each bin 
count the correction factor introduced above, and the 
corrected data are plotted in Figure 7. The FPN is very 
efficiently attenuated, and the extracted fluorescence lifetime 
is now 4.19 ns with an error of ¬±0.02 ns, in very good 
agreement with the expected value for fluorescein at pH=7.4 
[4]. 
VI. 
CONCLUSION 
A fast and efficient correction method to improve the 
transfer function of a Time to Digital Converter is presented. 
The approach is based on the measurement of a large number 
of Poisson process events generated by a simple SPAD 
lightened by a CW light source. In addition, this 
characterization process permits the measurement of the TDC 
transfer function without the need for any expensive delay 
generator to calibrate the device. The proposed correction is a 
post process operation, and thus can be implemented for any 
type of TDC. Its efficiency is demonstrated in a proof of 
principle TCSPC experiment. The function transfer correction 
method is simple, fast, efficient, and does not require 
hardware design changes of the TDC. 
 
REFERENCES 
[1] E. Charbon, M. Fishburn, R. Walker, R. Henderson and C. Niclass, 
‚ÄúSPAD-based sensors TOF Range-Imaging Cameras‚Äù, Springer-Verlag, F 
Remondino and D Stoppa ed. Berlin Heidelberg, 2013, pp 11‚Äì38, doi: 
10.1007/978-3-642-27523-4_2. 
[2] J. Y. Won, S. I. Kwon, H. S. Yoon, G. B. Ko, J. W. Son and J. S. Lee, 
‚ÄúDual-Phase Tapped-Delay-Line Time-to-Digital Converter With On-the-
Fly Calibration Implemented in 40 nm FPGA,‚Äù in IEEE Transactions on 
Biomedical Circuits and Systems, vol. 10, no. 1, pp. 231-242, 2016. doi: 
10.1109/TBCAS.2015.2389227 
[3] M. Fishburn, L. H. Menninga, C. Favi and E. Charbon, ‚ÄúA 19.6 ps, 
FPGA-Based TDC With Multiple Channels for Open Source Applications,‚Äù 
in IEEE Transactions on Nuclear Science, vol. 60, no. 3, pp. 2203-2208, 
June 2013.doi: 10.1109/TNS.2013.2241789 
[4] J√©r√©mie L√©onard, Norbert Dumas, Jean-Pascal Causs√©, Sacha 
Maillot,Naya Giannakopoulou, Sophie Barrea and Wilfried Uhring, ‚ÄúHigh-
throughput time-correlated single photon counting‚Äù, in Lab Chip, 2014, 14, 
4338, August 2014, DOI: 10.1039/c4lc00780h 
[5] Foudil Dadouche, Timoth√© Turko, Wilfried Uhring, Imane Malass, 
J√©r√©my Bartringer, Jean-Pierre Le Normand, ‚ÄúDesign  
Methodology of TDC on Low Cost FPGA Targets,‚Äù in Sensors & 
Transducers Journal, vol 193, no. 10, pp 123-134, October 2015 
[6] W. Uhring, V. Zint, J. Bartringer, ‚ÄúA low-cost high-repetition-rate 
picosecond laser diode pulse generator,‚Äù Photonics Europe Proc. of SPIE, 
Vol. 5452, 2004. 545038, doi:10.1117/12.545038. 
 
 
 
 
 
53
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-487-9
SIGNAL 2016 : The First International Conference on Advances in Signal, Image and Video Processing

