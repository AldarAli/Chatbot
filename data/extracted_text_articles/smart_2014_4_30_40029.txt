Energy Monitoring in Smart Buildings Using Wireless Sensor Networks
Percival Magpantay‡, Igor Paprotny†, Rafael Send∗, Qiliang Xu∗, Chris Sherman∗
Louis Alarcon ‡, Richard White ∗ and Paul Wright ∗
∗University of California, Berkeley
Email: rsend@berkeley.edu, qlxu@berkeley.edu, ctsherman@berkeley.edu, rwhite@eecs.berkeley.edu, pwright@me.berkeley.edu
†University of Illinois, Chicago
Email: papronty@uic.edu
‡University of the Philippines - Diliman
Email: louis.alarcon@up.edu.ph, mong@eee.upd.edu.ph,
Abstract—In this work, we present the implementation and
deployment of a wireless sensor network for the monitoring
of electric energy uses in smart buildings. This wireless sensor
network is based on our newly-developed Granular Radio EnErgy-
sensing Node (GREEN), which consists of a micro-controller, a
radio, a battery and a giant magnetoresistive (GMR) magnetic
ﬁeld sensor. The GREEN node can be easily attached to a
current-carrying conductor for proximity-based electric current
measurement. The intent of this article is to fully disclose the
information regarding the design, fabrication and implementation
of this GREEN-based wireless sensor network used as an electric
energy monitoring system. It should be noted that the wireless
sensing platform is not limited to energy monitoring, but can also
be well adopted in other applications and deployment settings.
Keywords–Smart Building, Wireless Sensor Networks, Energy
Sensing
I.
INTRODUCTION
Energy efﬁciency in smart buildings relies on a reduction
in overall usage and also Demand Response (DR) to offset
non-essential peak energy usage. These economic goals then
depend on information about the energy usage of individual
Circuit breaker box
Main breaker
Individual breaker
sensor
sensor
sensor
sensor
sensor
sensor
sensor
sensor
GREEN node
IEEE Standard 
802.15.4
Figure 1: Schematic of a GREEN-based stick-on electricity
monitoring systems for circuit breaker panels.
appliances. Retroﬁtting existing systems for commercial build-
ings and households requires that voltage and current sensing
devices be as non-intrusive as possible for ease of integration
and ease of deployment. Presently, buildings are retroﬁtted
by installing clamp-on submeters into circuit breaker panels
to monitor the electricity usage in each individual circuit.
However, the installation of such systems is very expensive
as it requires the use of certiﬁed electricians and a scheduled
shutdown of electrical services. In our previous work [1],
[2], we proposed a stick-on submetering system that allows
the electric currents going through the circuit breakers to
be measured from multipoint magnetic ﬁeld measurements
on the surface of breaker panels (also see in Fig. 1). Since
the sensors can be easily attached on the surface of panels,
the installation cost of this system is one-tenth the cost of
any clamp-on meters. There are many commercially available
wireless platforms [3], [4], [5], [6], [7] that can be used to
establish a wireless sensor network for transmission of data
collected from the circuit breaker stick-on sensors. However,
as the available space on the circuit breaker panels is often
limited, the footprint of the entire wireless sensor node is
desired to be as small as possible and none of the commercial
platforms has so far met this requirement. Therefore, a compact
wireless sensor node, called “The Granular Radio EnErgy-
sensing Node (GREEN)” was designed and fabricated. With
a footprint of only 1cm2, it allows for easy installation and
more accurate placement, which in turn allows for increased
granularity of measurements of the electric currents [8]. This
paper presents complete information on the operation and
programming of the nodes. It can be seen that they can be
used widely in smart building applications and many other
“smart environments”. The remainder of the paper is structured
as follows, Sec. II presents the speciﬁc wireless technology
that we’ve developed for the smart buildings. In Sec. III, we
describe the wireless sensor networks and the lightweight mesh
networking. In Sec. IV, we show an example of the wireless
monitoring and the stack of prototypes it employs to transmit
the data. Lastly, in Sec. V, we summarize our ﬁndings and
show directions of future work.
II.
SPECIFIC TECHNOLOGY TO SUPPORT SMART
BUILDINGS
Granular Radio EnErgy-sensing Node (GREEN, see Fig.
2) is a 0.56cm3 wireless stick-on node for non-intrusive
energy monitoring applications [3]. Our target application is to
wirelessly monitor the electricity usage from electrical circuit
78
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-363-6
SMART 2014 : The Third International Conference on Smart Systems, Devices and Technologies

Figure 2: GREEN beside a 1-cent coin (left) and GREEN 3D model [8]
breaker panel, power cords of any device (lighting, appliances,
electric vehicles, etc.), and critical loads on distribution and
transmission cables. Shown in Fig. 3 are GREENs three
Figure 3: GREEN block diagram
main blocks along with the components that comprise each
block. An analog AA002-02 GMR (Giant Magnetic Resonator)
sensor from NVE Corporation is the main component of
the Current Sensor block. This is interfaced to an Atmel
Atmega2564RFR2 microcontroller with integrated Zigbee-
compliant radio. The sizes of these two main component chips
together with a 3V coin cell battery and a capacitor allowed
the GREEN node to have a very small form factor, as shown
in Fig. 4. Despite its size, the GREEN microcontroller/radio
board (Fig. 4) managed to contain the common digital serial
communications (I2C, SPI, USART) that are available in
the Atmega2564RFR2 chip. One port is readily available for
analog input, but the 4-pin programming port can also be
conﬁgured for analog interfaces, if needed. All ports can also
be used as basic digital input/output interfaces. This makes
Figure 4: GREEN microcontroller/radio board pin layout
the microcontroller/radio board ﬂexible to be interfaced with
different types of sensors and conﬁgurable for other types of
applications.
III.
WIRELESS SENSOR NETWORKS (WSN) &
LIGHTWEIGHT MESH
Fig. 5 shows an example of the wireless sensor network
(WSN) deployed in our work on smart buildings. In deploy-
ing a wireless sensor network using GREEN, we used the
Lightweight Mesh (LWMesh) software stack [9], [10] provided
by Atmel. BitClouds Zigbee Pro Stack [11] could also be used,
but it requires some porting since the Atmega2564RFR2 is not
readily supported. LWMesh software stack has provided pro-
gramming templates in C for peer-to-peer and basic wireless
sensor mesh networks. In this implementation, we used the
wireless sensor network conﬁguration. The provided projects
are already arranged as project ﬁles for the Atmel Studio IDE.
Although the templates are conﬁgured for Atmega256RFR2,
the same can be used for Atmega2564RFR2 (used in GREEN)
since they are both practically in the same family. To create a
79
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-363-6
SMART 2014 : The Third International Conference on Smart Systems, Devices and Technologies

wireless sensor network using LWMesh, three types of nodes
are created: non-routing nodes (end devices), routing nodes
(routers) and coordinator. End devices can receive or transmit
data when in range, but may not be available all the time (in
sleep modes, limited power). Nodes with routing capabilities
usually have continuous power and they relay the data coming
from other router nodes or an end device to a coordinator.
Coordinator/gateway nodes usually have continuous power
and directly interface with a server machine (computer). The
software stack can theoretically accommodate up to 65,535
nodes in one network. The address space is divided to non-
routing and routing nodes. For routing nodes, 0x0001 to
0x7FFF addresses can be assigned, while 0x8000 to 0xFFFF
are used for end devices. Address 0x0000 is used for the coor-
dinator node. The current state of GREEN requires the use of
Atmels JTAGICE 3 (or compatible programmer) to effectively
program and conﬁgure the individual nodes. Future works
would include the use of On-the-Air (OTA) programming for
ﬁrmware update and easy online reconﬁguration, when needed,
especially if a very dense network is deployed. A native routing
algorithm is already present in LWMesh. This made our work
easier to test the capability of the GREENs in building a sensor
network. Routing tables are automatically created and updated
when data is being routed. The routes created by the algorithm
may not be optimal.
IV.
WSN MONITORING AND PROTOCOL
LightWeight Mesh follows the IEEE 802.15.4 standard
frame format, but not the protocol stack itself. LightWeight
Mesh cannot receive and process IEEE 802.15.4 command
frames. Fig. 6 shows the general LightWeight mesh frame
format used by each node.
For the current setup, the data received by the coordinator
node is passed to the server (PC) via serial port. Fig. 7 shows
the data format sent by the coordinator to the server. User
programs able to access serial ports can now interpret this
data. For the network topology visualization, we used the WS-
NMonitor software program from BitCloud. This monitoring
software can show the real time topology formed network and
the sensor readings received by each node. It can also show the
RSSI and LQI for each link. Fig. 8 shows a sample screenshot
of the WSNMonitor Software, depicting the nodes and links
formed by the network.
Figure 5: A sample wireless sensor network
Figure 6: LightWeight mesh frame format
Figure 7: Data format
Figure 8: An example of the WSNMonitor Software
A logging program using Python to monitor the battery
Figure 9: Battery discharge curve: a coin-cell battery is able
to sustain the operation of the GREEN node continuously for
about 1 hr and 45 mins.
80
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-363-6
SMART 2014 : The Third International Conference on Smart Systems, Devices and Technologies

voltage of end nodes was also created. Fig. 9 shows a sample
battery voltage proﬁle of an end node. The node is transmit-
ting data every two seconds using the default format of the
LightWeight mesh stack (approximately 10ms) and then goes
to deep sleep mode. The node lasted for about 1 hour and 45
minutes in this example.
V.
CONCLUSION AND FUTURE WORK
The GREEN device is not limited to sensing magnetic
ﬁelds and currents, although this is an excellent demonstration.
Any sensor that interfaces via analog, serial, I2C, SPI or
digital I/O can be connected to the controller/radio. The only
requirement is that the sensors must be very low power so the
battery is able to provide a reasonable runtime. Even with this
restriction, the device has many potential applications in “smart
buildings, ranging from instrumenting the heavy equipment in
a machine room to monitoring environmental conditions. The
main advantage of the GREEN is that it presents an extremely
small, mesh networkable radio platform that is capable of
interfacing with a wide variety of input devices.
The future work of this project will focus on the large-scale
deployment of this wireless sensor network into buildings to
perform condition-based air quality and energy consumption
monitoring.
ACKNOWLEDGMENT
The Public Interest Energy Research Program of the Cali-
fornia Energy Commission funded the research. The University
of the Philippines, ERDT and BCDA-PCIEERD programs pro-
vided funds for the ﬁrst author as part of an expanding research
agreement with UC Berkeley. We thank all these organizations
for support and many other students and colleagues in the
College of Engineering, Berkeley.
REFERENCES
[1]
Q. Xu, M. Seidel, I. Paprotny, R. M. White, and P. K. Wright, “Inte-
grated centralized electric current monitoring system using wirelessly
enabled non-intrusive AC current sensors,” Sensors, 2011, pp. 1998–
2001.
[2]
Q. R. Xu, I. Paprotny, M. Seidel, R. M. White, and P. K. Wright, “Stick-
On Piezoelectromagnetic AC Current Monitoring of Circuit Breaker
Panels,” Sensors Journal, IEEE, vol. 13, no. 3, Mar. 2013, pp. 1055–
1064.
[3]
Texas
Instruments.
ez430-rf2500
development
tool
user’s
guide.
[Online].
Available:
http://www.ti.com/lit/ug/slau227e/slau227e.pdf
[retrieved: June, 2014]
[4]
Sentilla
Moteiv.
Tmote
sky
low
power
wireless
sensor
module.
[Online].
Available:
http://www.eecs.harvard.edu/ konrad/projects/shimmer/references/tmote-
sky-datasheet.pdf [retrieved: June, 2014]
[5]
Digi
International.
Xbee-pro
xsc.
[Online].
Avail-
able:
http://www.digi.com/products/wireless-wired-embedded-
solutions/zigbee-rf-modules/point-multipoint-rfmodules/xbee-pro-xsc
[retrieved: June, 2014]
[6]
D.
Networks.
Dust
networks.
[Online].
Available:
http://cds.linear.com/docs/en/datasheet/59012ipmf.pdf [retrieved: June,
2014]
[7]
Y.-H. C. et al., “PicoCube: a 1 cm 3 sensor node powered by harvested
energy,” the 45th annual conference, Jun. 2008, pp. 114–119.
[8]
R. Send, Q. R. Xu, I. Paprotny, R. M. White, and P. K. Wright,
“Granular Radio EnErgy-sensing Node (GREEN): A 0.56cm3 wireless
stick-on node for non-intrusive energy monitoring,” 2013 IEEE Sensors,
2013, pp. 1–4.
[9]
Atmel avr2130: Lightweight mesh developer guide. [Online]. Avail-
able:
http://www.atmel.com/Images/Atmel-42028-Lightweight-Mesh-
Developer-Guide Application-Note AVR2130.pdf
[retrieved:
June,
2014]
[10]
Atmel AVR2131: Lightweight Mesh Developer Guide. [Online]. Avail-
able:
http://www.atmel.com/images/atmel-42029-lightweight-mesh-
getting-started-guide application-note avr2131.pdf
[retrieved:
June,
2014]
[11]
Atmel AVR2052: Atmel BitCloud Quick Start Guide. [Online].
Available:
http://www.atmel.com/Images/Atmel-4200-BitCloud-SDK-
Quick-Start-Guide AP-Note AVR2052.pdf [retrieved: June, 2014]
81
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-363-6
SMART 2014 : The Third International Conference on Smart Systems, Devices and Technologies

