Trafﬁc and Monotone Random Walk of Particles:
Analytical and Simulation Results
Alexander P. Buslaev∗, Alexander G. Tatashev† and Andrew M. Yaroshenko‡
∗ Moscow Automobile And Road Construction State Technical University
Moscow, Russia
apal2006@yandex.ru
† Moscow University of Communications and Informatics
Moscow, Russia
a-tatashev@rambler.ru
‡ Moscow Automobile And Road Construction State Technical University
Moscow, Russia
andreijar@rambler.ru
Abstract - An analytical model of random walk of par-
ticles on one-dimensional lattices and two-dimensional
ones is considered. This model can be used for study of
trafﬁc on multi-lane road, trafﬁc on crossroads, etc. We
have obtained new exact formulas that allow to calcu-
late the average velocity of particles. The steady state
probabilities have been found also. We developed also
an appropriate simulation model. The values, obtained
with aid of analytical calculations, were compared with
simulation results, and the result of this comparison was
that the accordance of the models is good correspondence
of the values found with aid of the two models.
Keywords-stochastic models; random walk; multi-lane
trafﬁc; optimization.
I. INTRODUCTION AND FORMULATION OF PROBLEM
Models of random walk on a lattice, which are used
for the trafﬁc study, help to study characteristics of multi-
lane trafﬁc, the behaviour of trafﬁc on crossroads, etc. Such
models help to solve problems of trafﬁc optimization.
The appearance of cellular automata models in the prob-
lem of trafﬁc ﬂows is associated with publications of Nagel
et al. [1–2], which were published in mid-nineties. In [1–
2], the dependence of the average velocity and intensity of
trafﬁc on the model parameters was studied. The following
factors, which contribute to the activation of this approach
development, can be noted
1) Desire to explain the discrepancy between the solutions
of trafﬁc equations and experimental observations, which
discovered chaotic behaviour in the so-called unstable mode;
2) Desire to create models discrete in time and space
or only by one coordinate, which would be independent
of inﬁnite-dimensional models and take into account the
presence of individual behaviour of ”particles with motivated
behaviour”.
We enumerate papers known to us that contain exact
mathematical results and relate to the theme of our paper.
It has been noted that the scheme considered in [1–2]
is similar to monotone random walks on a lattice. This
theme has its own history. In particular, the papers of Soviet
mathematician Belyaev and his students [3, 4] are devoted
to trafﬁc ﬂows in the underground and contain exact results
for one-dimensional random walk (not only monotone).
There are a lot of experimental results obtained with aid
of cellular automata models. That is apparently due to the
relative availability of computational tools. A Russian math-
ematician Blank gave well-deﬁned statements and achieved
exact results in a number of important cases, [5–6].
For example, one of problem in this scope is the problem
of percolation of fast particles through a lattice with a slow
particles on it.
Here we are talking about exact estimates, while sim-
ulation results such as the experimental observation about
the signiﬁcant inﬂuence of the presence of heavy trucks on
trafﬁc intensity certainly exist.
In [7], a model of particles (vehicles) movement on a
multi-lane road was considered. In this model the velocity
of movement is the sum of determinate and stochastic
components, i.e., vmodel = vdeterm+vstochast. In the model
considered in [7] the determinate component of movement
corresponds to the background movement on lane and the
stochastic component corresponds to individual manoeuvres
of particles. Each lane corresponds to the sequence of cells.
The size of the cell is determined by the dynamic dimension
of the vehicle. The dynamic dimension takes into account the
safety requirement and depends on velocity of movement,
[8]. Stochastic movement is described by monotone walk
on cells of lane and the regular movement is described by
uniform movement of the lane, [7], [9].
44
Copyright (c) IARIA, 2011.     ISBN:  978-1-61208-169-4
SIMUL 2011 : The Third International Conference on Advances in System Simulation

In [10], a model of random walk on one-lane ring has
been considered. The formula has been found for the average
velocity of particles. This formula is a generalization of
formula, obtained in [5], for the model of random walk,
where randomness occurs only for initial conﬁguration of
particles.
In [11–13], models of random walk on a discrete lattice,
similar to models introduced in [7, 9], have been used for
the solving some problems of trafﬁc optimization.
The present work considers a stochastic model, which
describes movement of particles (vehicles) on the multi-
lane road. The steady state probabilities and the average
velocity of particles have been obtained. The conﬁgurations
of particles on the lattice determine the model states. The
limiting case is studied, in which the length of lane is
inﬁnitely large.
Some simulation models have been developed, which are
used for the study of characteristics of single-lane and multi-
lane movement.
The developed simulation models were realized using
Delphi 7 environment.
The volume of PC computers memory was sufﬁcient for
the case of nearly 200 cells of the lattice.
A minute of computer program time corresponds to nearly
500 units of discrete model time.
If the simulation time interval is equal nearly 30000 units
of discrete model time, the difference between values of
average particles velocities found with aid of simulation and
analytical models does not usually exceed 1 %.
II. SINGLE-LANE AND MULTI-LANE FLOWS
A. Single-lane ﬂows
Let us describe the stochastic model of movement on the
circle, which was considered in [10]. The ring contains n
cells and m < n particles. If at the current time there is
a particle in the cell and the next cell is empty then the
particle moves to the next cell with probability p. The steady
states probabilities and the average velocity of particles have
been found. States of the model are determined by the
conﬁgurations of particles on the lattice. As shown in [10],
the probabilities of states depend on the number of particle
clusters only.
Let us consider a mathematical model of movement on
the lane.
This model is the limiting case of the model studied in
[10]. In this case the number of cells is big. The formula
for average velocity v has been obtained:
v = 1 −
√
1 − 4rp(1 − r)
2r
,
(1)
where r is the ﬂow density, r = m/n.
In [10], a formula has been obtained for average velocity
v(n, m) of the stochastic movement on non-moving lane
for number of cells equal n, number of particles equal m,
Figure 1.
Average velocity (y-axis) of particle movement on the ring for n
equal to 10 (the upper curve), equal to 100 (the second curve from the top),
170 (the second curve from the bottom) and ∞ (the lower curve), simulation
for n = 30 (the second curve from the top). Values of density are indicated
on x-axis. The same curves are represented on both the diagrams but the
scale of left diagram is larger
and the probability of realization of attempt equal p. In
accordance with this formula
v(n, m) = n
m
min(m,n−m)
∑
k=1
Cp
(1 − p)k−1 Ck−1
m−1Ck−1
n−m−1,
where
C =


min(m,n−m)
∑
k=1
n
k · Ck−1
m−1Ck−1
n−m−1
1
(1 − p)k−1


−1
,
Ck
m is the number of combinations of k elements from m
ones.
Diagrams of v(n, m) for values of n, equal to 10, 100 and
170, and the diagram of function (1), which corresponds to
an inﬁnitely great value of n, is showed in Fig. 1. Value
of p is supposed to be equal to 0.5. In this ﬁgure the
corresponding values of the average velocity of particles,
which have been obtained by simulation, are also shown.
Interval of simulation was supposed to be equal to 10000
simulation steps.
In the case p ∼ 1 we have, using formula (1),
v ∼
{
1, 0 < r ≤ 1
2,
1
r − 1,
1
2 < r < 1,
that corresponds to the results of work [5], where a similar
model has been considered for p = 1.
In case p ∼ 0 we have
v ∼ p(1 − r).
Function (1) is convex on the ﬂow density. Due to this fact
the problem of the optimal distribution of particles on the
lanes has been solved for canalized movement. This problem
has been formulated in [11].
B.
Multi-lane ﬂows
A model of stochastic movement on torus was studied
(Fig. 2). There are several lanes. Each lane is a circle that
consists of some number of cells. The sections of the torus
are also circles and every section contains cells of different
45
Copyright (c) IARIA, 2011.     ISBN:  978-1-61208-169-4
SIMUL 2011 : The Third International Conference on Advances in System Simulation

Figure 2.
Torus
lanes. The movement of particles is monotone with respect
to each coordinate, i.e., the particles can move only in
one and the same direction for every coordinate. At the
current time with probability 1/2 the transition of particle
in the direction of the ﬁrst coordinate and with probability
1/2 the transition of particle in the direction of the second
coordinate is planned. The transitions in the given direction
are planned simultaneously for all the particles. But every
transition is realized with probability that does not depend on
behaviour of the other particles. Suppose that at the current
time the transition of particle in direction of s-th coordinate
is planned, s = 1, 2. If the particle is in cell (i, j) and the
next cell, in direction of the s-th coordinate, is empty, then
with probability 0 < ps < 1, which does not depend on
results of attempts of the other particles, the particle passes
to the next cell in the direction of s-th coordinate, s = 1, 2.
The states of the model correspond to conﬁgurations of
particles. It has been proved that in the case of small values
of probabilities p1 and p2 probabilities of all the states
are asymptotically equal to 1/N, where N is the number
of states. Exact formulas have been found for the average
velocity of movement. It is proved that the distribution of
particles on the lanes is hypergeometric for the number of
lanes equal 2 and a generalization of the hypergeometric
distribution if the number of particles is greater than 2.
The behaviour of the model is studied for the case of arbi-
trary values of p1 and p2 and great values of number of cells.
It occurs for this case that the particles are distributed on
the lanes uniformly. The average velocity can be calculated
using formula (1).
III. SIMULATION MODEL OF MULTI-LANE MOVEMENT.
COMPARISON WITH THE ANALYTICAL MODEL
A. The case of non-moving lane
A multi-lane trafﬁc simulation model has been developed.
We consider the case of non-moving lane, i.e. vdet =
0. The model contains a two-dimensional array. There are
K lanes. Each lane is a sequence of n cells. There are m
particles. The transitions of particles occur at integer time
steps. Each cell contains no more than one particle. If at
the current time the cell ahead of a particle is empty then it
passes to the next cell with probability p. If the cell ahead of
the particle is occupied and the neighbouring cell of another
lane is empty then the particle passes to the neighbouring
cell. If the both neighbouring cells on the other lanes are
empty then each of them can be chosen with probability
1/2. If two particles can come to the same cell the priority
is given to the particle that is located on the right.
The results of analytical calculations were compared with
the results of simulation.
The differences of the models are the following
1) Movement is monotone in direction of two coordinates
in the analytical model and movement is monotone in
direction of only coordinate in the simulation model.
2) In the analytical model all the lanes are inner.
3) In the simulation model collisions of particles are pre-
vented by restrictions on changing the lane. This collisions
are impossible in the analytical model as at each time the
transitions in direction of the only coordinate are allowed.
In the analytical model some simpliﬁcations are used and
analytical results can be obtained. The simulation model
describes the real situation more detailed.
In accordance with the rules of movement in the sim-
ulation model a particle moves to another lane if there is
another particle in the next cell ahead.
Therefore we should expect that the average velocity
of particles in this model will be slightly higher than the
average velocity of a particle in the mathematical model
(Section II), in which transitions to another lane are inde-
pendent of whether the cell, neighbouring to the cell to be
occupied, is empty or occupied.
In Figure 3 the results of analytical calculations and
results of simulation are given for the models of two-lane
movement. Values of ﬂow density and average velocity are
indicated on x-axis and y-axis respectively.
We suppose that the number of cells on each lane is equal
to 100. Let p and r be deﬁned as in Section II. Let v∗(r)
be the average velocity of a particle that has been found
by simulation and v∗∗(r) be the average velocity calculated
using formula (1). As it was expected the maximum value
of the relative differences
∆ = u∗(r) − u∗∗(r)
u∗(r)
is attained at r = 0.5 approximately. This can be explained
with the following. By small values of the ﬂow density
a situation, where particles pass to the other lane, occurs
rarely. By great values of ﬂow densities transitions of
particles to the other lane are complicated and therefore
occur also rarely.
As the number of cell on the torus tends to inﬁnity, the
average velocity converges to values calculated with the aid
of formula (1). Therefore data, represented in Fig. 3, give
an estimation of difference between values of the average
velocities in the analytical model of movement on torus and
the simulation model of multi-lane movement.
46
Copyright (c) IARIA, 2011.     ISBN:  978-1-61208-169-4
SIMUL 2011 : The Third International Conference on Advances in System Simulation

Figure 3.
Dependence of average velocity on density for p = 0.5.
Lower curve corresponds the analytical model. Upper curve corresponds
the simulation
Figure 4.
Results of comparing of the two-lane simulation model (the
upper curve) and model taking into account a determined component of
average velocity (the lower curve). Values of ﬂow density and average
velocity are indicated on x-axis and y-axis respectively.
B. Comparison with the analytical model, which takes into
account the determinate component of the trafﬁc velocity
In Section IIIa, the comparison of the values of average
velocities is represented. We compared also the values of
average velocities of particles in simulation and analytical
models, developed in [7, 9]. In these models the velocity
of movement is represented as sum of the determinate
component and the stochastic one. The approach using such
representation is mentioned in the Section I.
Results of comparison are represented in Fig. 4. This
comparison allows to estimate the differences between the
average velocities, which are obtained with the analytical
and simulation models. This difference can be explained by
that in the simulation model the particles can change lanes
and by this reason the average velocity of movement is some
higher.
As for models which are considered in Section IIIa the
maximum value of the relative differences between values
of velocities is attained at r = 0.5 approximately.
IV. THE ”RING WITH JUNCTIONS” MOVEMENT MODEL.
We consider simulation model of trafﬁc with crossroads,
that is ”ﬁgure-of-eight”. This model contains the main ring
and k rings of smaller size, each of that has one common
cell with the main ring, Fig. 5. The ﬂow passing such a cell
(crossroads) divides into two parts.
Figure 5.
Movement model ”ring with junctions”
Figure 6.
”Figure-of-eight” model
Some of them remain on the main ring and others begin
to move on the small ring.
In one of version of the model the particles coming to
the crossroads from the main ring have priority and in the
second version the particles coming to the crossroads from
the small ring have priority.
If k = 1 then we have the model of ”ﬁgure-of-eight”.
Each ring in the ”ﬁgure-of-eight” is represented by one-
dimensional array, Fig. 6. Two arrays have a common
cell, which is a model of cross-road. The common cell
is called cell 0. The ﬁrst ring contains n1 cells (1, j),
j = 1, 2, . . . , n1. The second cell contains n2 < n1 cells
(2, j), j = 1, 2, . . . , n2. Coming through the crossroads,
particles coming from the ﬁrst ring have priority over the
particles coming from the second ring.
So there are n = n1 + n2 + 1 cells in the model. There
are m < n1 particles. Each of them occupies one cell. There
is no more one particle in each cell. Transitions of particles
occur at integer time steps. If at integer time k the particle
47
Copyright (c) IARIA, 2011.     ISBN:  978-1-61208-169-4
SIMUL 2011 : The Third International Conference on Advances in System Simulation

Figure 7.
Comparison of diagrams of dependence of average velocity
on density for the ”ﬁgure-of-eight” (the lower curve) and one-lane ring
(the upper curve) models. The values of model parameters are supposed as
n1 = 20, n2 = 10, p = 0, 5. Values of ﬂow density and average velocity
are indicated and on x-axis and y-axis respectively.
occupies cell (i, j) and cell (i, j + 1) is empty then with
probability 0 < p < 1 this particle at time k +1 will occupy
cell (i, j + 1) and with probability 1 − p will occupy still
cell (i, j), j = 1, 2, . . . , ni − 1, i = 1, 2.
The results of comparison of values of average velocity
of particles in the ”ﬁgure-of-eight” model and the model of
one-lane movement on ring which contains the same number
of cells are represented, Fig. 7.
We can see in the ﬁgure that for values of m which are
sufﬁciently less than n1 differences between values, obtained
using two models, are small. For values of m, close to n2,
sharp decrease of the average velocity occurs. If m ≥ n2
movement stops in some number of simulation steps.
V. CONCLUSION AND FUTURE WORKS
An analytical model have been developed where trafﬁc
is represented by random walk. Exact results for trafﬁc
characteristics have been obtained.
We have developed simulation models taking into account
some features of real trafﬁc more detailed. The values, ob-
tained with aid of the analytical calculations, and simulation
results was compared. It allows to estimate the difference
between average velocities in models with different rules of
movement of particles.
We plan to use the simulation model so that it could help
to obtain new analytical results.
REFERENCES
[1] Nagel, K. and Schreckenberg, M. “A cellular automaton model
for freeway trafﬁc”, J. Phys. I France 2, 1992, pp. 2221-–2229.
[2] Schreckenberg, M., Schadschneider, A., Nagel, K., and Ito, N.
“Discrete stochastic models for trafﬁc ﬂow”, Phys. Rev. E.,
1995, vol. 51, pp. 2939–2949.
[3] Belyaev, Yu. and Zele, U. “A simpliﬁed model of movement
without overtaking”, Izv. AN SSSR, ser. ”Tekhn. kibernet”,
1969, N 3, pp. 17–21.
[4] Zele, U. “Generalizations of movement without overtaking”,
Izv. AN SSSR, ser. ”Tekhn. kibernet.”, 1972, N 5, pp. 100–
103.
[5] Blank, M. “Exact analysis of dynamical systems arising in
models of trafﬁc ﬂow”, Russian Mathematical Surveys, vol.
55, no. 3 (333), 2000, pp. 167–168.
[6] Blank, M. “Dynamics of trafﬁc jams: order and chaos”, Mosc.
Math. J., 1:1, 2001, pp. 1-26.
[7] Buslaev, A., Prikhodko, V., Tatashev, A., and Yashina, M.
“The deterministic-stochastic ﬂow model”, arXiv: physics/
0504139v1[physics/soc.-ph], vol. 20, Apr. 2005, pp. 1–21.
[8] Inose, H. and Hamada, T. ”Road trafﬁc control”, University of
Tokio Press, 1975.
[9] Buslaev, A., Novikov, A., Prikhodko, V., Tatashev, A., and
Yashina, M. “Stochastic and simulation approaches to opti-
mization of road trafﬁc”, Moscow, Mir, 2003.
[10] Buslaev, A. and Tatashev, A. “Particles ﬂow on the regular
polygon”, Journal of Concrete and Applicable Mathematics
(JCAAM), vol. 9, no. 4, 2011.
[11] Bugaev, A., Buslaev, A., Tatashev, A., and Yashina, M.
“Optimization of partially-connected ﬂows for deterministic-
stochastic model”, Trudy MFTI, vol. 2, no. 4(8), 2010. pp.
15–26.
[12] Bugaev, A., Buslaev, A., and Tatashev, A. “Monotone random
walk of particles on an integer number lane and LYuMen
problem”, Mat. modelirovanie, vol. 18, no. 12, 2006, pp. 19–
34.
[13] Bugaev, A., Buslaev, A., and Tatashev, A. “Simulation of seg-
regation of two-lane ﬂow of particles”, Mat. modelirovaniye,
vol. 20, no. 9, 2008, pp. 111–119.
48
Copyright (c) IARIA, 2011.     ISBN:  978-1-61208-169-4
SIMUL 2011 : The Third International Conference on Advances in System Simulation

