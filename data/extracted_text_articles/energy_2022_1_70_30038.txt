Performance of Linear Programming in Optimizing
the Energy Schedule of a Grid-connected Hybrid
System Compared to Particle Swarm Optimization
Hoda Elaouni
LUSAC Laboratory, University of Caen Normandy
Orange Innovation
Lannion, France
email: hoda.elaouni@unicaen.fr
Hussein Obeid
LUSAC Laboratory, University of Caen Normandy
Cherbourg, France
email: hussein.obeid@unicaen.fr
St´ephane LE Masson
Orange Innovation
Lannion, France
email: stephane.lemasson@orange.com
Hamid Gualous
LUSAC Laboratory, University of Caen Normandy
Cherbourg, France
email: hamid.gualous@unicaen.fr
Olivier Foucault
Orange Innovation
Lannion, France
email: olivier.foucault@orange.com
Abstract—This study aims to find a rapid and efficient method
for managing the energy of a Grid-connected hybrid system.
Thus, two optimization strategies, the Linear Programming (LP)
and the Particle Swarm Optimization (PSO), have been suggested
to minimize the operating cost of the hybrid system while
respecting the constraints of all the system components. Then,
a comparative study has been made between these two methods
(i.e., LP and PSO). Consequently, the operating cost obtained
using PSO algorithm is close to the one provided by the LP
algorithm. However, the PSO algorithm is slower than the LP
algorithm and requires different parameters to be chosen. Finally,
the impact of the battery initial state of charge on the operating
cost is studied.
Keywords—Linear Programming; Particle Swarm Optimization;
Optimization; Grid-connected hybrid system.
I. INTRODUCTION
The energy consumption of access networks represents a
principal part of telecommunications operators’ energy bills.
Several works [1] [2] have been initiated on sources, energy
storage, and their management to reduce this consumption
and the carbon footprint. Green production is a promising
way to overcome this fossil energy issue [3] [4]. Besides,
it is necessary to develop acceptable management methods
and technical tools guaranteeing network reliability [5]. In this
perspective, the notion of microgrid has appeared to resolve
part of this management problem. Indeed, it is an intelligent
system composed of green and local production as well as
a storage system to ensure the reliability of the system. An
energy management system provides an optimal configuration
and sizing with the economic management of exchanged
energy within. The maximization of economic efficiency and
reliability is undoubtedly the top of all research targets [6].
Different studies have been made to achieve this purpose. For
instance, in [6] a multi-objective optimization problem of op-
timizing the schedule of sources, as well as the import/export
power with the grid, has been solved using an optimization-
based approach called Branch and Bound method. In addition,
optimal energy management of microgrid, which constitutes of
a PV system and a storage system with minimum of cash flow
using dynamic programming technique has been suggested in
[7] [8]. A comparative study has been presented in [9] to
illustrate the efficiency of Linear Programming (LP) compared
to PSO and adaptive dynamic programming for an intelligent
home energy resources scheduling in the presence of uncertain
data. Hossain et al. [10] present a particle swarm optimization
for real-time application energy management to find optimal
battery control of a community microgrid. In [11], a fuzzy
logic-based energy management system for a residential grid-
connected system including renewable energy sources and
storage capability is suggested. The difference between this
study and the studies cited above occurs in the problem
formulation and the constraints to be respected. To optimize
the energy scheduling/management in a connected microgrid,
there are two types of methods: an exact optimization methods
that guarantee finding an optimal solution (e.g., LP) and
heuristic optimization methods that don’t guarantee that the
solution founded is optimal (e.g., PSO). In this study, both
algorithms LP and PSO are applied to find the optimal energy
scheduling of a grid-connected hybrid system. Furthermore,
three different scenarios are considered to provide a compar-
ison between these two algorithms. It is shown that the LP
algorithm is faster and does not require parameters to be tuned
which is not the case for PSO algorithm. On the other hand,
the impact of the initial state of charge of the battery on the
operating cost is studied for the LP algorithm.
The work is organized as shown: system description and
energy models of the architecture components are introduced
in Section II. These models will be used to calculate the
required parameters for optimization approaches. Section III
30
Copyright (c) IARIA, 2022.     ISBN:  978-1-61208-967-6
ENERGY 2022 : The Twelfth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

suggests two different methodologies for optimizing energy
planning with a minimum operating cost. In this section,
we introduce the objective function and constraints adopted
in each method. The results obtained by these approaches
are compared in Section IV. In addition, some assessment
has been established to show the robustness of the proposed
strategy.
II. SYSTEM DESCRIPTION
The architecture studied is a grid-connected hybrid system
composed of renewable energy sources, i.e., Photovoltaic and
Wind Turbine, batteries, and DC load as shown in Figure 1.
To reduce the energy loss, we assume that the battery should
be charged only by the remaining energy, this means when
the energy produced by renewable sources is greater than the
load demand. Otherwise, the energy left will be exchanged
with another local site. On the other hand, if the consumption
exceeds the production of the renewable source, the battery
will discharge to meet the remaining energy.
Figure 1. Grid-connected hybrid system architecture
A.
Photovoltaic model
The mathematical model for estimating the output power of
a PV module is a linear function of the solar radiation and the
ambient temperature [12]. It can be calculated as follows:
Ppv = Pp fcG(1+β(Tc −Tre f )
Gr
)
(1)
Tc = Ta +G((NOCT −20)
800
)
(2)
where Pp is the rated power under standard test conditions
(kW), fc is PV derating factor (88%), G is solar radia-
tion (W/m2), β is the temperature coefficient of efficiency
(−0.41%/°C), Gr is the standard amount radiation (1000
W/m2), Tref is standard test temperature (25°C), Tc is the
cell temperature (°C), Ta is the ambient temperature (°C) and
NOCT is the nominal operating cell temperature (45°C).
B. Wind Turbine model
To model the wind turbine, the mechanical power, which is
directly extracted from it, can be given by [13]
Pwt =





0.5CpSϕV 3,
if Vi ≤ V ≤ Vn
Pr,
ifVn ≤ V ≤ Vo
0,
otherwise
(3)
where Vn, Vi and Vo are the rated (11m/s), the cut-in (3.5m/s),
the cut-out (25m/s) wind speeds respectively, Cp is the power
coefficient, S is the turbine blades swept area (10.87m2), ϕ is
the air density (1.225kg/m3), V is the wind speed at hub height
H and Pr is the rated power. For the purpose of adjusting the
wind profile according to the height, the following equation
can be used [14]
V = V0( H
H0
)α
(4)
where V0 is the wind speed measured at the reference height
H0. α is the power law exponent depends on the nature of
terrain (0.14).
C. Battery model
Batteries are used to store excess power in the microgrid and
operate when the system has deficit power. At any hour, the
battery stored energy is related to the previous one and the
energy production and consumption situation of the system
during the time from t −1 and t as used in [10].
• Charging mode
Wb(t) = Wb(t −1)+(Wpv +Wwt −Wl)
(5)
• Discharging mode
Wb(t) = Wb(t −1)−(Wl −Wwt −Wpv)
(6)
where Wl is the energy consumption (kWh). Wpv, Wwt represent
the energy production by Photovoltaic module and Wind
turbine (kWh) respectively.
III. OPTIMIZATION ALGORITHM
The main goal of this paper is to minimize the operating
cost of the energy exchanged with the grid to obtain an
optimal energy schedule of the grid-connected hybrid system.
The optimization algorithm should ensure that the discharging
of the battery will be done during high demand, while the
charging will be done during high production, moreover, the
state of charge should be within upper and lower limits. In
addition, the battery must return to its initial state of charge at
the end of the optimization horizon to ensure that the system
has a stabilized energy balance for one cycle. To solve this
issue, we presume two methods of optimization explained
below:
A. Linear programming
This approach is based on the linear programming paradigm
that consists in minimizing or maximizing a given function
according to the following constrained scheme [9]:









max f(x) = cT x or min f(x) = cT x
subject to:
Ax ≤ b or Ax ≥ b orAeqx = beq
Where:
x ≥ 0,x ∈ Rn×1,A ∈ Rm×n,b ∈ Rm×1,
c ∈ Rn×1,Aeq ∈ Rp×n,beq ∈ Rp×1
(7)
In this approach, the decision variables for the economic
dispatch problem are as follows:
• The battery energy of charging and discharging (Wc and
Wd).
31
Copyright (c) IARIA, 2022.     ISBN:  978-1-61208-967-6
ENERGY 2022 : The Twelfth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

• The exchanged energy with the grid utility (Wg).
• The exchanged energy with another site (Wexch).
• The battery state of charge (SOC).
This means, in our case the vector x is chosen as follows:
[Wg,
Wc,
Wd,
SOC,
Wexch]T. The vector c is formed us-
ing (8)-(9). The right part of (10)-(12) represents the elements
of the matrix Aeq, and the left part of these equations are
used to form the vector beq. Matrix A contains the coefficients
multiply the decision variables in (13)-(18). The vector b
includes the upper and the lower limits of each variable.
The objective function in (8) aims to minimize the cost of the
energy purchased from the grid Wg when the consumption
is greater than the production as well as make profit by
exchanging the remaining energy with other site Wexch. And,
Cg in (8) represents the purchased energy price (0.2e/kWh).
minC =
T
∑
i=1
Wg(i)Cgk(i)
(8)
Where T is the energy management system period (e.g., one
day) and i is time interval (e.g., 1h). The parameter k is a
binary variable for the charging state of the battery. In fact,
k represents two constraints to be respected which are the
battery should not be discharged when the system has an
excess energy and vice versa. k is calculated in terms of the
load demand and renewable energy production, as described
in (9), where Wl, Wpv and Wwt are the load, solar PV and Wind
Turbine energy (kWh)
k(i) =
(
1,
if d(i) ≥ 0
0,
otherwise
(9)
d(i) = Wl(i)−Wpv(i)−Wwt(i)
(10)
Equation (11) guarantees that the battery will be charged
mostly by the renewable energy.
d(i) = k(i)(Wg(i)−Wd(i))+(k(i)−1)(Wc(i)−Wexch(i))
(11)
Equation (12) calculates the battery state of charge SOC
in each slot time i to maintain its values within the given
limitations in (13).
SOC(i+1) = SOC(i)+ (1−k(i))Wc +k(i)Wd
Ec
(12)
SOCmin ≤ SOC(i) ≤ SOCmax
(13)
Where Ec is the nominal energy of the battery[kWh]. The
inequalities (14)-(17) indicate the lower and upper bounds that
should be respected for the exchanged energy with the grid,
the external consumers, and the battery, respectively.
0 ≤ Wg(i) ≤ Wgmax
(14)
Wexch(i) ≥ 0
(15)
0 ≤ Pc(i) ≤ Pcmax
(16)
Pdmax ≤ Pd(i) ≤ 0
(17)
The ε refers to an admitted tolerance in the constraints concern
the charging of the battery in the end of the period of the
optimization T.
|SOC(T)−SOC(1)| ≤ ε
(18)
B. Particle swarm optimization
Its concept is based on the behavior of birds to compute
global optimization functions [10]. In PSO, each possible
solution is modeled as a particle that moves through the input
hyperspace, which can have numerous dimensions [15]. First
and foremost, each solution takes a random position with a
random velocity in the search space. At each iteration, the
particles move towards their best position, and therefore that
of their neighborhood, which corresponds to the optimum
position, by updating their velocity [16]. In this section,
the objective is similar, whereas the objective function has
presented differently. The first term in (19) refers to a penalty
applied in the case of the battery charged with the grid. The
decision variable in this methodology is only the exchanged
energy with the battery. For this strategy, the cost function is
described by (19) to reduce the electricity bill by minimizing
the exchanged energy with the grid. Indeed, according to the
difference between the load demand and the renewable energy
production, as well as the sign of the decision variable, the
penalty is applied to avoid the following scenarios:
• Charging or discharging the battery when the system is
in a steady state.
• Discharging the battery even if there is an excess of
energy.
• Energy left is not sufficient to charge the battery.
minC = P+
T
∑
i=1
Wg(i)Cg
(19)
The grid will meet the load when the consumption is greater
than the production. On the other hand, if the suppliers
transcend the load demand, the energy left will be exchanged
with other consumers.
d(i) = Wl(i)−Wpv(i)−Wwt(i)
(20)
Wg =
(
Wl(i)−d(i)+Wb(i),
if d(i) ≥ 0
0,
otherwise
(21)
Wexch =
(
−d(i)−Wb(i),
if d(i) ≤ 0
0,
otherwise
(22)
At each point of time, the program ensures that the solution
respects the constraints presented as follows:
Pbmin ≤ Pb(i) ≤ Pbmax
(23)
SOCmin ≤ SOC(i) ≤ SOCmax
(24)
0 ≤ Wg(i) ≤ Wgmax
(25)
Wexch(i) ≥ 0
(26)
|SOC(T)−SOC(1)| ≤ ε
(27)
IV. SIMULATION AND DISCUSSION
The considered system includes a DC load with a constant
rated power of 5 kW, a PV with an installed peak power of
69 kW, a Wind turbine with a rated power of 16 kW, and a
battery with a rated energy of 74 kWh.
32
Copyright (c) IARIA, 2022.     ISBN:  978-1-61208-967-6
ENERGY 2022 : The Twelfth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

TABLE I. PSO PARAMETERS
PSO
Number of variables
24
Number of iterations
300
population size
1000
Inertia coefficient
1
Damping ratio of inertia coefficient
0.99
Personal acceleration coefficient
2
Social acceleration coefficient
2
A. Comparative study
In this subsection, the performance of both algorithms
to provide the energy management for this aforementioned
system is compared through simulation results using Matlab.
Indeed, three scenarios have been tested (see Figures 2-4) to
find which approach is more efficient regarding some parame-
ters such as the operating cost, the computational time, and the
energy exchanged with other site. These scenarios present the
meteorological data at Lannion for three different months July,
May and October. In the simulations which follow, the period
is fixed as 24 hours, the initial state of charge is chosen as
SOC(1) = 80%, and the error between the final and the initial
values of SOC is taken as 3%, i.e., ε = 3% in Eqs.(18) and
(27). Moreover, the values of SOC(min) and SOC(max) have
been selected as SOC(min)=30% and SOC(max)=100%. The
optimization parameters for PSO algorithm are given in Table
I. In Figures 2-4, it can be observed that the energy dispatch
proposed by both methods for the three scenarios, are globally
similar. Indeed, when the PV and Wind turbine production is
more important than the load demand, the two approaches
suggest to charge the battery and transfer the remaining
energy to other consumers. But, the difference occurs when
the production is less than the demand. In this case, PSO
algorithm proposes to use the grid and the battery to meet
the load demand. Conversely, linear programming suggests
meeting the load by discharging only the battery. Besides, the
two strategies respect obviously the constraints about the final
value of the battery state of charge in all cases. Regarding
the computational time, the linear programming can find the
optimal solution within one minute. However, the PSO algo-
rithm takes more than one hour to find it, since its convergence
depends on the number of iterations and population size which
have been chosen big enough. Here, it should be mentioned
that if the number of iterations and population size have not
been adequately chosen, the convergence of PSO algorithm
cannot be ensured. The operating cost proposed by LP is less
expensive than the one proposed by PSO algorithm for all
scenarios, as it can be shown in TableII. On the other hand,
the PSO algorithm offers to exchange more energy compared
to other one since the battery discharges less than the first
technique as shown in the Figures 2-4.
To sum up, the LP finds quickly and efficiently the optimal
schedule of the considered system compared to the PSO
algorithm. Furthermore, as soon as the numbers of the decision
variables increase, the use of the PSO becomes avoidable. That
is due to the reason that, the PSO algorithm requires a lot of
parameters to be tuned.
TABLE II. OPERATING COST AND EXCHANGED ENERGY PRO-
POSED BY TWO APPROACHES.
Scenario
PSO
LP
C (e)
Wexch (kWh)
C (e)
Wexch (kWh)
Case 1
1.85
32
0.68
24
Case 2
2.61
27
1.18
18
Case 3
2.38
18.5
1.2
10
Where case 1, case 2, and case 3 represent the meteorological
data in July, May, and October, respectively.
B. Sensitivity analysis
In this part, some parameters will be analyzed using linear
programming. It treats the impact of the initial state of charge
on the operational cost and the energy sold to other sites over
24h.The values of the SOCmin, SOCmax, and ε are similar to
those used in the subsection A. However, the data that will
be used in this subsection are presented in Figure 2. Table III
shows that the minimum operational cost has been obtained
in the case where the battery initial level of energy is 70%.
Indeed, the purchased energy from the grid is zero as well
as the 70% of energy stored is sufficient to meet the load
and respect the constraint about the final value of the SOC.
Consequently, the exchanged energy with the other consumers
is the minimum because the most excess energy is used to
charge the battery. At the beginning of the optimization, if
the battery is fully charged or discharged, the operational
cost and the exchanged energy for the solution obtained
would be greater than the other scenarios. In other words,
the battery is less used in these cases in order to respect the
constraint about the final SOC. Figure 5, it represents the
energy schedule of the system aforementioned considering
the optimal value of the SOC(t0). As can be shown in the
Figure 5, the battery has completely discharged in the state of
deficit when the renewable sources production is insufficient.
Besides, it is remarkable that the excess energy has been
sufficient to charge completely the battery. For that reason,
the system has respected the constraints without using the
grid energy to meet the load like the other cases. To conclude,
the economic scenario to adopt is with SOC(t0) equals to
70% since the energy exchanged with the grid in this case is
zero.
TABLE III. OPERATING COST AND EXCHANGED ENERGY FOR
DIFFERENT VALUES OF THE INITIAL BATTERY STATE OF CHARGE
USING LP.
SOCint (%)
100
90
80
70
60
50
40
C (e)
2.61
1.64
0.68
0
0.46
1.42
2.39
Wexch (kWh)
39
31
24
19
22
30
37
33
Copyright (c) IARIA, 2022.     ISBN:  978-1-61208-967-6
ENERGY 2022 : The Twelfth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

(a)
(b)
(c)
(d)
Figure 2. (a) The PV and Wind turbine energy profile on 1st of July in Lannion. (b) The variation of the battery state of charge proposed by PSO and LP.
The energy scheduling on 1st of July using: (c) PSO and (d) LP.
(a)
(b)
(c)
(d)
Figure 3. (a) The PV and Wind turbine energy profile on 1st of May in Lannion.(b) The variation of the battery state of charge proposed by PSO and LP.
The energy scheduling on 1st of May using: (c) PSO and (d) LP.
V. CONCLUSION
This paper has applied two approaches for the optimal
energy scheduling of a Grid-connected hybrid system which
are the LP and the PSO algorithms. Then, a comparison has
been made to confirm the effectiveness and the rapidity of the
LP in front of the PSO algorithm in terms of computational
time and operational cost. Moreover, it is shown that the PSO
algorithm requires some parameters to be tuned to achieve
the convergence which is not the case for the LP.
On the other hand, a sensitivity analysis for the LP has
been studied also. The obtained results confirm that the LP
will be more effective if the battery starts with an initial
state of charge equal to 70%. As future works, a comparative
study between two exact optimization methods (i.e., LP
and Mixed-Integer linear programming (MILP)) will be
studied.
Furthermore,
the
LP-based
energy
management
will be combined with a sizing algorithm to optimize the
configuration of a grid-connected hybrid system. Moreover, a
34
Copyright (c) IARIA, 2022.     ISBN:  978-1-61208-967-6
ENERGY 2022 : The Twelfth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

(a)
(b)
(c)
(d)
Figure 4. (a) The PV and Wind turbine energy profile during on 1st of October in Lannion. (b) The variation of the battery state of charge using PSO and
LP. The energy scheduling on 1st of October using: (c) PSO and (d) LP.
Figure 5. The energy scheduling of the system studied on 1st of July in
Lannion
comparative study with the existing sizing algorithms will be
performed.
REFERENCES
[1] D. Emad, M. El-Hameed, M. Yousef, and A. El-Fergany, “Computational
methods for optimal planning of hybrid renewable microgrids: a com-
prehensive review and challenges,” Archives of Computational Methods
in Engineering, vol. 27, no. 4, pp. 1297–1319, 2020.
[2] R. Palma-Behnke, C. Benavides, F. Lanas, B. Severino, L. Reyes,
J. Llanos, and D. S´aez, “A microgrid energy management system based
on the rolling horizon strategy,” IEEE Transactions on smart grid, vol. 4,
no. 2, pp. 996–1006, 2013.
[3] D. Morin, Y. Stevenin, C. Grolleau, and P. Brault, “Evaluation of
performance improvement by model predictive control in a renewable
energy system with hydrogen storage,” International Journal of Hydro-
gen Energy, vol. 43, no. 45, pp. 21017–21029, 2018.
[4] C. Bordin, H. O. Anuta, A. Crossland, I. L. Gutierrez, C. J. Dent,
and D. Vigo, “A linear programming approach for battery degradation
analysis and optimization in offgrid power systems with solar energy
integration,” Renewable Energy, vol. 101, pp. 417–430, 2017.
[5] I. El Kafazi and R. Bannari, “Multiobjective scheduling-based energy
management system considering renewable energy and energy storage
systems: A case study and experimental result,” Journal of Control,
Automation and Electrical Systems, vol. 30, no. 6, pp. 1030–1040, 2019.
[6] L. N. An, T. T. M. Dung, and T. Quoc-Tuan, “Optimal energy man-
agement for an on-grid microgrid by using branch and bound method,”
in 2018 IEEE International Conference on Environment and Electrical
Engineering and 2018 IEEE Industrial and Commercial Power Systems
Europe (EEEIC/I&CPS Europe), pp. 1–5, IEEE, 2018.
[7] L. N. An and T. Quoc-Tuan, “Optimal energy management for grid
connected microgrid by using dynamic programming method,” in 2015
IEEE Power & Energy Society General Meeting, pp. 1–5, IEEE, 2015.
[8] M.-H. Laraki, B. Brahmi, C. Z. El-Bayeh, and M. H. Rahman, “Energy
management system for a stand-alone wind/diesel/bess/fuel-cell using
dynamic programming,” in 2021 18th International Multi-Conference
on Systems, Signals & Devices (SSD), pp. 1258–1263, IEEE, 2021.
[9] S. Squartini, M. Boaro, F. De Angelis, D. Fuselli, and F. Piazza, “Opti-
mization algorithms for home energy resource scheduling in presence of
data uncertainty,” in 2013 Fourth International Conference on Intelligent
Control and Information Processing (ICICIP), pp. 323–328, IEEE, 2013.
[10] M. A. Hossain, H. R. Pota, S. Squartini, F. Zaman, and J. M. Guerrero,
“Energy scheduling of community microgrid with battery cost using
particle swarm optimisation,” Applied Energy, vol. 254, p. 113723, 2019.
[11] D. Arcos-Aviles, J. Pascual, L. Marroyo, P. Sanchis, and F. Guinjoan,
“Fuzzy logic-based energy management system design for residential
grid-connected microgrids,” IEEE Transactions on Smart Grid, vol. 9,
no. 2, pp. 530–543, 2016.
[12] H. Lan, S. Wen, Y.-Y. Hong, C. Y. David, and L. Zhang, “Optimal
sizing of hybrid pv/diesel/battery in ship power system,” Applied energy,
vol. 158, pp. 26–34, 2015.
[13] S. Diaf, D. Diaf, M. Belhamel, M. Haddadi, and A. Louche, “A
methodology for optimal sizing of autonomous hybrid pv/wind system,”
Energy policy, vol. 35, no. 11, pp. 5708–5718, 2007.
[14] H. Borhanazad, S. Mekhilef, V. G. Ganapathy, M. Modiri-Delshad,
and A. Mirtaheri, “Optimization of micro-grid system using mopso,”
Renewable Energy, vol. 71, pp. 295–306, 2014.
[15] A. Moses, A. Landeros, and M. F. Abdel-Fattah, “Particle swarm
optimization for sizing hybrid power systems incorporating demand re-
sponse,” in 2018 IEEE 59th International Scientific Conference on Power
and Electrical Engineering of Riga Technical University (RTUCON),
pp. 1–7, IEEE, 2018.
[16] N. Lazaar, E. Fakhri, M. Barakat, H. Gualous, and J. Sabor, “Optimal
sizing of marine current energy based hybrid microgrid,” in Conference
on renewable energies and power quality, vol. 8, 2020.
35
Copyright (c) IARIA, 2022.     ISBN:  978-1-61208-967-6
ENERGY 2022 : The Twelfth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

