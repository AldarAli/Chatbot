Self-Consistent NLOS Detection in GNSS-Multi-Constellation
Based Localization under Harsh Conditions
Pierre Reisdorf, Gerd Wanielik
Technische Universit¨at Chemnitz
Reichenhainer Str. 70, 09126, Chemnitz, Germany
Email: firstname.lastname@etit.tu-chemnitz.de
Abstract—Nowadays, precise and reliable localization is a key
technology for many applications around the world. The lo-
calization should have an availability around the globe for a
minimum price and for each person. Localization with satellites
like Global Positioning System (GPS) or Glonass has become a
standard in the last years for outside positioning. Satellites are
available around the world and the positioning results are good
for many applications, except in restricted areas. In urban areas
in particular, the reception of the satellite signals is restricted.
Often, the signals are received under Non-Line-Of-Sight (NLOS)
conditions in these areas. Hence, a good approach should detect
NLOS and use knowledge to handle the NLOS measurements.
We implement a self-consistent approach to detect NLOS in the
measurement domain and use the information for the position
estimation process. In contrast to other existing approaches, we
need no external information or hardware.
Keywords–Global
Navigation
Satellite
System
(GNSS);
Non-Line-Of-Sight
(NLOS)
detection;
self-consistent;
multi-
constellation.
I.
INTRODUCTION
A reliable vehicle positioning is a crucial part of nearly
every Intelligent Transportation System (ITS). While the im-
portance of localization is obvious for certain applications such
as navigation, ﬂeet management, or location-based services
in general, future applications, such as vehicle-to-vehicle-
communications, which are solely based on absolute posi-
tioning, are currently the main driver behind the techno-
logical developments in this ﬁeld. Absolute localization as
implemented by Global Navigation Satellite Systems (GNSSs)
seems to be a promising technological candidate to solve
this task. Although many commercial vehicles are nowadays
equipped with low-cost GNSS receivers, such systems provide
only limited performance in dense urban areas. Especially,
when buildings or foliage are acting as reﬂection surfaces, so
called multipath errors which are caused by Non-Line-Of-Sight
(NLOS) measurements, happen to appear. A brief introduction
for Line-Of-Sight (LOS) and Non-Line-Of-Sight (NLOS) in
urban areas is shown in Figure 1. The reception of each satellite
signal depends on the position of the receiver and the satellite
to each other. Satellites S2 and S3 are in LOS, satellite S4 is
blocked and satellite S1 has NLOS. If such NLOS observations
are not handled carefully within the localization algorithm, an
unwanted bias is introduced in the ﬁnal position estimate.
The paper is structured in a related work section, followed
by an idea description, preliminary results and a section for
next steps regarding this topic.
Ego position
S4
S3
S2
S1
Object
Object
Line-of-sight
area
Figure 1. A typical situation in an urban area. This is a schematic
representation of the electronic waves emitted by the satellites.
II.
RELATED WORK
There are varying methods and approaches to detect and
handle NLOS detections. A good introduction and description
of different methods is given by Groves [1] and a good
taxonomy is given by Obst [2]. The current approaches detect
NLOS with additional hardware, special information like a 3D
map with building information [3] or based on the Receiver
Autonomous Integrity Monitoring (RAIM) concept with con-
sistency checking [4]. None of these methods works with raw
measurements, without additional information from external
resources and can detect or exclude several satellites.
Our approach detects NLOS without additional external
information and work as a self-consistent method.
III.
IDEA DESCRIPTION
The NLOS effect caused by different environments gener-
ates an additional error part in the pseudorange measurement,
besides the other common errors for example ionosphere,
troposphere or ephemeris. A pseudorange ρ is modeled after
[5] as
ρ = r + c(dt − dT) + de
(1)
de = dNLOS + dion + dtrop + deph + . . .
(2)
In Equation (1), c is the speed of light and r the true range
between the receiver and the satellite. The satellite clock error
dT will transmit from the satellite by the navigation message
23
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-643-9
VEHICULAR 2018 : The Seventh International Conference on Advances in Vehicular Systems, Technologies and Applications

of each satellite. The receiver clock error dt is unknown.
Equation (2) describes some additional errors like ionosphere,
troposphere, ephemeris or NLOS. There are various estimators
and models for the different errors except NLOS. NLOS
depends on the environment and the behavior is very dynamic.
The basic idea of our algorithm approach for detection of
NLOS is using jumps in different parameters of raw measure-
ments from a GNSS receiver. In more detail, the parameters
are Pseudorange, Signal-To-Noise-Ratio (SNR), Carrier Phase
or Doppler. A jump in this ﬁeld is deﬁned as an unusual strong
increase or decrease between two or more measurements. For
this purpose, we use a sliding window approach in post-
processing over the last x measurements and estimate at ﬁrst
step the mean or median over these measurements, without the
use of obvious outlier. This threshold is deﬁned by a static
long-term measurement campaign over multiple days. The
second step calculates the mean or median over the complete
dataset for each satellite and the result will be used in a third
step as a threshold for separating as LOS or NLOS.
In post-processing, our approach used the challenging
GNSS datasets from [6]. Therefore, we choose the data from
the Frankfurt Main scenario for the preliminary results in
Figures 2 and 3. In future work, we will use the other
challenging scenarios too.
In [2], there is a good taxonomy of the multipath/NLOS
problem. Our approach belongs to the class Fault detection/
outlier classiﬁcation and open a new branch.
IV.
PRELIMINARY RESULTS
The result of the NLOS detection with the parameter
pseudorange for GPS satellite 22 with the Novatel receiver is
shown in Figure 2. This method to classify data by a ground
truth with a Novatel receiver is described in detail in [2]. The
preliminary results of the current status with the jump detection
is shown in Figure 3. The results obtained with the parameters
SNR and carrier phase are similar. In contrast, the doppler
shows a lower rate of NLOS detection. All parameters need
a deeper investigation of the different behavior with a varying
size of the sliding window or other approaches to estimate the
thresholds.
Figure 2 shows the detection with a state of the art method.
Figure 3 depicts the state of the art method (red) and the jump
approach (orange) in one diagram. Our approach detects more
NLOS at the beginning of the dataset.
V.
NEXT STEPS
The current approach detects NLOS measurements and
excludes these measurements from the position estimation in a
next step. This approach is called fault detection and exclusion
(see taxonomy in [2]). In dense urban areas, the number of
LOS measurements could not be enough and no position ﬁx
is available. Hence, the next step behind the classiﬁcation
in NLOS and LOS is to use the knowledge of NLOS data
and estimate the pseudorange using this historic knowledge.
A simple estimator or a ﬁlter like Kalman-ﬁlter perform this
estimation process. By weighting several aspects of the jump
information from the parameters, we have a chance to estimate
a ﬁxed position with the satellite information. To estimate the
accuracy, we plan to implement an ego motion model and
a motion model for the satellites. Accordingly, we expect a
more stabilized estimation with this knowledge. Furthermore,
we extend the self-consisteny approach for multi-constellation
scenarios with GPS, Glonass, Galileo and Beidou.
3.2305
3.231
3.2315
3.232
3.2325
GPS second [s]
60
65
70
75
80
85
90
Pseudorange difference [m]
Ublox
Ublox NLOS Novatel
Figure 2. Ublox EVK-M8T (LEA-M8T) pseudorange measurements from
GPS satellite (PRN 22) with our Novatel OEM6 NLOS (red dots) detection.
3.2305
3.231
3.2315
3.232
3.2325
GPS second [s]
60
65
70
75
80
85
90
Pseudorange difference [m]
Ublox
Ublox NLOS Novatel
Ublox NLOS Jumps
Figure 3. Ublox EVK-M8T (LEA-M8T) pseudorange measurements from
GPS satellite (PRN 22) with our Novatel OEM6 NLOS (red) and our Jump
NLOS (orange) detection.
ACKNOWLEDGMENT
For
the
evaluation
and
generation
of
the
ground
truth, precise real-time corrections provided by axio-net
(http://www.axio-net.eu) were used.
REFERENCES
[1]
P. D. Groves, Z. Jiang, M. Rudi, and P. Strode, “A Portfolio Approach to
NLOS and Multipath Mitigation in Dense Urban Areas,” in ION GNSS
2013, 2013, pp. 3231 – 3247.
[2]
M. Obst, “Bayesian Approach for Reliable GNSS-based Vehicle Lo-
calization in Urban Areas,” Ph.D. dissertation, Technische Universit¨at
Chemnitz, 2015.
[3]
M. Obst, S. Bauer, and G. Wanielik, “Urban multipath detection and
mitigation with dynamic 3D maps for reliable land vehicle localiza-
tion,” in Position Location and Navigation Symposium (PLANS), 2012
IEEE/ION, April 2012, pp. 685 – 691.
[4]
B. Parkinson and J. Spilker, Global Positioning System: Theory and
Applications, ser. Global Positioning System.
American Institute of
Aeronautics and Astronautics, 1996, no. Bd. 1, chapter 5: Receiver
Autonomous Integrity Monitoring.
[5]
E. D. Kaplan and C. Hegarty, Understanding GPS : Principles and
Applications, 2nd ed.
Artech House, 2006.
[6]
P. Reisdorf, T. Pfeifer, J. Breßler, S. Bauer, P. Weissig, S. Lange,
G. Wanielik, and P. Protzel, “The problem of comparable gnss results
an approach for a uniform dataset with low-cost and reference data,” in
The Fifth International Conference on Advances in Vehicular Systems,
Technologies and Applications, M. Ullmann and K. El-Khatib, Eds.,
vol. 5, nov 2016, p. 8, iSSN: 2327-2058.
24
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-643-9
VEHICULAR 2018 : The Seventh International Conference on Advances in Vehicular Systems, Technologies and Applications

