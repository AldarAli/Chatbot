Impact of Scrambling-Exact Channel Estimation on HSDPA MIMO
Wolfgang Aichmann
Nokia Siemens Networks
D-89081 Ulm, Germany
Email: wolfgang.aichmann@nsn.com
Abstract—Multiple-input Multiple-output (MIMO) antenna
systems require a separate pilot signal for each transmitting
antenna for enabling the receiver to measure all physical chan-
nels separately. As scrambling operates with pseudorandom
sequences the auto-correlation is quasi-orthogonal with small
deviations from exact orthogonality. In this paper the impact
of these deviations is investigated, which is important especially
for estimating the channel impulse response. Therefore, an
analytical approach beyond simple correlation is proposed,
taking into account the full scrambling sequence. Link level
simulations show that the performance of high-speed down-
link packet access (HSDPA) MIMO systems is signiﬁcantly
improved, especially for very high data rates when dual stream
transmission is used in combination with cancellation of the
interference between the data streams.
Keywords-W-CDMA; HSDPA; MIMO; channel estimation;
scrambling; crosstalk; interference cancellation;
I. INTRODUCTION
Channel estimation plays an important role in wideband
code division multiple access (W-CDMA) networks, espe-
cially for very high data rates as they are achieved with
MIMO [1], [2]. It has therefore been topic of different
investigations, which go beyond the conventional correlation
approach. In [3], a novel type of linear minimum mean
square equalizer (LMMSE) was presented, which is able to
properly take into account all types of interference without
being too complex for implementation in real systems,
whereas [4] and [5] investigate smoothening the primary
channel estimates by appropriate ﬁltering and cancelling the
inter-antenna interference, respectively. An adaptive channel
estimator was proposed in [6] for system utilizing space time
transmit diversity.
In order to beneﬁt from diversity of transmitted signals
achieved either by separating the transmitting antennas spa-
tially or using different polarization directions, it is neces-
sary to measure all physical channels from each transmitting
to each receiving antenna, and transmission of more than
one data stream in MIMO systems is not possible at all
without resolving these channels individually (see, e.g., [7]).
Therefore, each transmitting antenna has to be fed with
a separate pilot sequence. For HSDPA systems [8], there
are deﬁned primary and secondary common pilot channels,
which are orthogonal either by using orthogonal symbol
patterns or by applying orthogonal spreading codes. In any
case, the coded pilot chip level sequences are scrambled.
As scrambling is a quasi-orthogonal but not an exact
orthogonal operation the channel information derived by the
receiver remains distorted even under conditions being ideal
beyond these distortions, i.e., absence of receiver noise and
additive white Gaussian noise (AWGN) channels. In [9], an
iterative approach was proposed to approximately handle
this phenomenon. Because equalization of the incoming
signal is cancelling the effect of multi-path propagation to
a considerable extent this effect does not play a role for
data detection itself. However, channel estimation, which is
needed for measuring the different propagation paths has to
work on un-equalized incoming data and thus is impacted
signiﬁcantly.
As long as only one pilot channel is present, the impact
is usually negligible: Although a certain amount of energy
is scattered by the scrambling operation into other codes or
pilot patterns, the general shape of the signal at the output of
the physical channel persists as the energy reduction is more
or less proportional to the available energy, i.e., slots with
low pilot signal strength also have a low absolute distortion
caused by scrambling. If there are however two or more pilot
sequences the relative error strongly increases as besides
’scattering out’ also ’scattering in’ has to be regarded: The
intrusion of energy from other codes also happens at time
(slot) positions where the respective ’target’ pilot signal is
weak or even vanishes, causing an error signal, which can
be much higher than the ’pure’ signal.
If MIMO is conﬁgured for more than one data stream
these streams will interfere with each other with strength de-
pending on the correlation of the different physical channels.
But this interference can effectively be reduced by interfer-
ence cancellation as all data streams have the same origin
and therefore are subject of the same channel conditions.
Furthermore, the receiver has to decode all data streams
anyway so that the additional effort of cancellation is lim-
ited. As interference cancellation is re-applying the channel
transformation to the already detected data, any error in
the estimated channel information takes effect three times,
namely at ﬁrst equalization, at re-application of the channel
operation in the course of the interference cancellation and
at re-equalization of the equivalent single stream data. Any
error in channel estimation therefore acts non-linearly on the
overall performance of the system.
The scrambling distortion is mainly signiﬁcant for very
79
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

high data rates where the respective user equipment (UE)
is served by the base station with all available resources.
This means that intra-cell interference (originating from
other users) is small, mainly caused by pilot and control
channels, which are known to the UE and can be suppressed.
Furthermore, these mentioned high data rates are achievable
under quite good radio conditions only, i.e., also the inter-
cell interference must be small. Therefore, a correlation-
based estimator might be sufﬁcient in that range of interest
but the impact of systematic scrambling induced distortion
should be removed.
As the receiver knows the scrambled pilot symbol patterns
as they are fed to the transmitting antennas it is possible to
calculate the distortion induced by scrambling analytically
as a function of the channel impulse response. Inverting this
function allows to extend the correlation algorithm such as
to take into account the distortion, leading to an estimated
channel impulse response being exact with respect to scram-
bling effects. Although a matrix operation is required to
solve the resulting equation system the corresponding matrix
elements depend only on the scrambling vector and can
hence be calculated once at the initial phase. As long as
the scrambling code is not changed, i.e., the UE does not
change the cell, these elements remain stable.
The remainder of this paper is organized as follows: In
Section II we give a brief description of MIMO inter-stream
interference and its cancellation as this is the main applica-
tion of the proposed improvement in channel estimation. In
Section III we then introduce the signal model with the basic
equations. They are required to describe the data transfer
through the physical channels to be measured by the UE
and will be used in Section IV for formulating the analytical
solution for scrambling-exact channel estimation. Section
V then demonstrates the gain of the proposed algorithm
with some results from link level simulation, followed by a
discussion of an efﬁcient implementation of the algorithm in
Section VI. After explaining why the deviation of scrambling
from orthogonality has no impact on data detection itself in
Section VII, we ﬁnally draw our conclusion in Section VIII.
II. CANCELLATION OF MIMO INTER-STREAM
INTERFERENCE
In W-CDMA HSDPA, the maximum possible data rate
has been and will be increased over the years especially
by using modulation schemes of higher order such as
16QAM or 64QAM and new modes of operation [10], [11].
The latter can be divided into two classes. The ﬁrst one
is extending the bandwidth by using two or even more
carriers. In that case, the procedures on physical layer remain
more or less untouched and are hence beyond our focus
here. The second one is the introduction of MIMO with
transferring several data streams in parallel using both the
same physical resources as well as the same spreading codes
Figure 1. Schematic overview about dual stream transmission in W-CDMA
HSDPA MIMO.
Figure 2.
Schematic overview about cancellation of inter-stream interfer-
ence.
[12]. Fig. 1 gives a schematic overview about MIMO dual
stream transmission.
Good channel estimation plays a signiﬁcant role for
effective data transmission, especially if high data rates
shall be reached. This is achieved by transmitting pilot
patterns with deﬁned power, which are used then by the
receiver to estimate the single channel coefﬁcients. Dual
stream transmission requires at least two antennas on both
transmitter and receiver side. To enable the receiver to
measure each physical channel separately, two different pilot
signals are sent. In HSDPA each one is fed to one of
the transmitting antennas [13], whereas each data stream is
distributed to both transmitting antennas with different phase
factors, the pre-coding weights. A pre-coding codebook with
four entries is deﬁned and the UE signals the index of the
pre-coding values, which yield the highest received power.
The pre-coding vector for the second data stream is then
taken orthogonal to the one of the ﬁrst stream in order to
allow the separation of the streams by the receiver. The
received power of the second stream usually is signiﬁcantly
lower due to more destructive interference of the beams
from the two transmitting antennas. For that reason, ﬁrst
and second stream often are refered as strong and weak one.
Further details are not important for the discussion here but
80
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

can be found in [12].
In conventional LMMSE equalizers as described, e.g., in
[14] both pre-coding weights and channel coefﬁcients are
needed to determine proper weights for calculation of soft
values of the received symbols, which then are passed to
the decoder. Although these equalizer weights are non-linear
in the channel impulse response the weight calculation is
the only place in the decoding chain where the estimated
channel coefﬁcients are required.
The separation of the streams on receiver side is possible
due to diversity of the physical channels between each
transmitting and receiving antenna either spatially or due
to different polarization properties of the affected antennas.
If the physical channels are correlated this separation of the
streams is feasible only to a certain extend and a substantial
inter-stream interference remains after equalizations, which
mainly effects the weaker of the two data streams. To keep
this stream decodable anyway requires the application of
a modulation and coding scheme with rather low transport
block size.
If, however, the ﬁrst data stream is decoded correctly,
the complete information for re-constructing its shape as it
reaches the receiver antennas is available at the receiver,
including the coefﬁcients of the physical channels. It is
therefore possible to subtract this contribution from the
overall incoming signal, leaving the stripped signal con-
taining only the signal of the second stream, and of course
noise and interference beyond inter-stream interference. This
cancellation of inter-stream interference thus allows higher
data rates also for the weaker data stream.
From the schematical display in Fig. 2 it becomes obvious
that now the estimated channel coefﬁcients are not applied
only once but three times, namely for the ﬁrst calculation of
the equalizer weights, for the re-construction of the stronger
signal as it reaches the antennas, and for the re-calculation
of the weights used for equalizing the remaining weaker
stream, which now requires single stream weights. As long
as the two data streams are not orthogonal at the reciever
side, which is usually the case if interference cancellation
is executed, application of dual stream weights implicitly
assigns within the equalizer equations a part of the stream
power to the other data stream, which is, however, no more
present. This both reduces the available signal over noise
ratio and distorts the signal, i.e., the data detection suffers
signiﬁcantly [15].
The increased impact of channel estimation errors in
presence of interference cancellation becomes obvious when
looking to the equation for the received soft values y2,IC of
the weaker second data stream at the equalizer output (see,
e.g., [16]).
y2,IC = w2,single [r − (1 − δ) · h · s1] .
(1)
To the re-spread and re-scrambled signal of the ﬁrst
Table I
NAMING CONVENTIONS FOR IMPORTANT VARIABLES
Received signal (single antenna)
r(l)
Sent signal (index i for Tx antenna)
si(l)
Channel impulse response (index i for Tx
antenna)
hi(l)
Scrambling code element of sequence j at
integer chip index n
cj(n)
Channel length
M + 1
Spreading sequence length
NSF
Oversampling factor
NOSF
Number of symbols required for CPICH
orthogonality
Northo
Number of symbols required for CPICH
orthogonality, measured in chips
N = chips per slot
Northo
data stream, s1, the channel impulse response h is re-
applied. Errors in channel estimation are accounted for by
the correction δ. As the main part of the overall received
signal r originates from the stronger ﬁrst data stream, both
terms in the bracket are of the same order of magnitude
and y2,IC is therefore quite sensitive to errors in the channel
estimation with leading order of δ. The additional contribu-
tion of δ implicitly contained in w2,single is present without
interference cancellation, too.
Of course it would be much easier to use directly the
stronger signal at the equalizer output instead of re-coding
the decoded one, especially as this would reduce the de-
tection delay. The beneﬁt of such a procedure however is
quite limited because such a signal still contains all noise
and interference contributions and not only errors from
channel estimation. It can even happen that the manipulated
signal obtained this way is worse than without interference
cancellation at all.
In Section V we will show that the performance of the
weaker data stream experiences a huge gain from improved
channel estimation, but also the stronger data stream as well
as the weaker one in absence of interference cancellation
beneﬁt from this procedure.
III. BASIC CHANNEL PILOT EQUATIONS
Throughout the rest of the paper, we use the naming con-
ventions listed in Table I. We assume that two transmitting
antennas are present, each fed with a separate pilot sequence,
namely s1 and s2. On chip level, i.e., after spreading, the
signals are then chip-wise multiplied with the elements of a
scrambling vector c, which has the length of a frame, i.e.,
38400 chips [17]. The scrambling sequence is known also to
the receiving UE, which can hence de-scramble the received
signal r by multiplication with the hermitian scrambling
vector, c†.
The W-CDMA scrambling sequences are constructed
from the pseudorandom complex-valued Gold sequences
[17] and hence their autocorrelation is quasi-orthogonal (see,
81
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

(a)
(b)
Figure 3.
Scalar product of scrambling vector with itself (red) and with another (blue) scrambling vector as function of shifted index.
e.g., [18]. This operation preserves both amplitude and phase
to a high extend if the applied scrambling vector matches
the one used on the transmitter side without shift in the chip
index as can be seen from the red curve at j = 0 in Fig. 3a.
On the other hand, de-scrambling with another scrambling
sequence (blue curve in Fig. 3a) or the same one but shifted
in the chip index yields an correlation result close to zero.
If really orthogonal instead of quasi-orthogonal codes would
be used non-matching de-scrambling would provide exactly
vanishing results. Scrambling is therefore a powerful means
for both separation of signals from different cells, which
use different scrambling codes, as well as for separation of
contributions of the same base station but propagating via
differently delayed paths, i.e., application of the same but
time-shifted scrambling sequence.
Fig. 3b shows the error caused by the deviation of scram-
bling vectors from orthogonality in more detail. Although
this error is in the range of a few percents only it can cause
a degradation of system performance, especially if advanced
receivers are used.
As we want to include oversampling and raised cosine
ﬁltering in our description, s and r are deﬁned in sub-chip
time steps l. For a single receiving antenna, the received
signal is then given by (see, e.g., [18], Section 1.3):
r(l) =
(2)
NOSF·M
X
k=0
c
l − k
NOSF
 
h1(k)s1
l − k
NOSF

+ h2(k)s2
l − k
NOSF

,
where ⌊· · · ⌋ denotes the interger part of the argument.
Usually, the raised cosine ﬁltering is counted for in the
channel impulse response h. The signal si, i ∈ {1, 2} up-
sampled with oversampling factor NOSF is then non-zero only
for integer arguments and hence only M terms contribute
to the summation in (2). For further receiving antennas the
same equation holds with the corresponding channel impulse
responses.
Although the conventional correlation approach of chan-
nel estimation, which de-scrambles the received signal ig-
noring the error made by this quasi-orthogonal operation
(see, e.g., [2]), allows to separate both signals from different
cells with different scrambling sequences c1 and c2 as well
as to separate different delays ∆j of the signals from the
same cell, it contains a systematic error. This error is visible
in Fig. 3 where the scalar product of a scrambling vector
with itself (red) and with another scrambling vector (blue)
is displayed. In both cases, the second vector is circularly
shifted in its index ∆j. In case of real orthogonality, only
the product of a scrambling vector with itself and matching
indices (red cross at ∆j = 0) would yield a non-vanishing
result.
In order to ﬁnd an exact solution for de-scrambling, we
build the projection of the received signal to the scrambling
vector but keep all terms resulting from deviation of scram-
bling from orthogonality:
l0+NSF
X
l=l0+1
c† (l) r(l + d) =
=
l0+NSF
X
l=l0+1
NOSF·M
X
k=0
c†(l)c
l − k + d
NOSF

·

h1(k)s1
l − k + d
NOSF

+ h2(k)s2
l − k + d
NOSF

≈
≈
h1(d)s1(l0) + h2(d)s2(l0).
(3)
The approximation in the last step applies the simpliﬁca-
tion of the correlation approach.
In (3), we introduced a start index l0 for summation
over chips in order to cope with handling of more than
one symbol. For the ﬁrst symbol, l0 = 0, for the second
82
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

one l0 = NSF , the spreading sequence length, and higher
symbol indices are related to the corresponding integer
multiples of NSF .
Although the scrambling vector c and its index l operate
on chips, both the received data r and the channel impulse
response function h are deﬁned on sub-chip level and
thus d and k take into account oversampling. During the
upsampling operation, the data vectors si, i ∈ {1, 2}, are
extended according to the oversampling factor by ﬁlling the
new elements with zeros. This means that all terms on the
right hand side of (3) with (l − k + d)/NOSF /∈ Z vanish
because the corresponding si = 0. If we now deﬁne
κl0,j(d, k)
≡
κl0,j(d − k) =
=
NOSF·NSF
X
l=l0+1
c†(l)c
l − k + d
NOSF

sj
l − k + d
NOSF

κl0,j(d − k)
=
0
∀d − k /∈ Z
ρl0(d)
=
NSF
X
l=l0+1
c†(l)r(l + d)
(4)
for a channel of length M + 1 measured in chip duration
equation (3) can be written as
ρl0(d) =
NOSF·M
X
k=0
[h1(k)κl0,1(d − k) + h2(k)κl0,2(d − k)] .
(5)
The correlative de-scrambling is contained in this formu-
lation as special case, namely setting κ(d − k) = δd,k. The
channel coefﬁcients are then directly given by ρ.
We are now able to split the summation into two parts,
namely one counting the chips and the other stepping
through the oversampling within each chip. With the def-
initions
d
=
NOSF
 d
NOSF

+ d
mod NOSF = ˆd + ˇd
ˆd
=
 d
NOSF

(6)
ˇd
=
d
mod NOSF
and assuming that l is an integer multiple of NOSF (gen-
erally spoken, oversampling can be accounted for in d) we
can write ﬁnally
ρl0( ˆd + ˇd) =
=
M
X
k=0
NOSF−1
X
j=0
h
h1(NOSFk + j)κl0,1( ˆd + ˇd − NOSFk − j)+
h2(NOSFk + j)κl0,2( ˆd + ˇd − NOSFk − j)
i
=
=
M
X
k=0
h
h1(NOSFk + ˇd)κl0,1( ˆd − NOSFk)+
h2(NOSFk + ˇd)κl0,2( ˆd − NOSFk)
i
.
(7)
In (7), we have separated integer and oversampled parts
in the sum of the right hand side of (5) by splitting
k = NOSF
 k
NOSF

+ j
j
k
NOSF
k
→k
−→
NOSFk + j,
(8)
i.e., the summation over k is restricted to run from 0 to M
whereas the oversampled indices are collected in j, which
runs from 0 to NOSF and ﬁnally is executed according to the
deﬁnition given in (4).
IV. SCRAMBLING-EXACT CHANNEL ESTIMATION
In [8], there are deﬁned different conﬁgurations for the
common pilot channel (CPICH) in W-CDMA systems. For
the usage in combination with MIMO, two of them are
relevant, namely either using only the primary CPICH spread
with code cSF1 of length 256 and orthogonal bit sequences on
the two transmitting antennas, or using the primary CPICH
on the ﬁrst and a secondary CPICH with code cSF2 on the
second transmitting antenna. The secondary CPICH than
must use the same bit sequence as the primary CPICH. The
same scrambling code for both cases is used in any case.
If two adjacent symbols are merged both options can
formally be described by a virtual spreading with length
512 where the effective spreading codes can be deﬁned
in the ﬁrst case as [cSF1 cSF1] and [cSF2 inv(cSF1)], and in the
second case as [cSF1 cSF1] and [cSF2 cSF2]. As long as the channel
estimation algorithm ﬁnally uses any ﬁltering procedure over
an even number of pilot symbols, both options are equivalent
with respect to the inﬂuence of scrambling. We will restrict
therefore the following investigations to the conﬁguration
with primary CPICH only and orthogonal bit sequences on
the two transmitting antennas.
A. Single Symbol Channel Estimation
If we want to calculate M + 1 coefﬁcients for both
channels, we need 2 · (M + 1) equations, i.e.,










ρl0(NOSF·0+ ˇd)
...
ρl0(NOSF·M+ ˇd)
...
ρl0(NOSF·(2M+1)+ ˇd)










= Kl0









h1(NOSF·0+ ˇd)
h2(NOSF·0+ ˇd)
...
h1(NOSF·M+ ˇd)
h2(NOSF·M+ ˇd)









, (9)
where the pilot scrambling matrix Kl0 is deﬁned as
83
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

(a)
(b)
Figure 4.
Real (a) and imagionary (b) part of odd columns of pilot scrambling matrix K for a single tap channel including raised cosine ﬁltering.
(a)
(b)
Figure 5.
Channel Impulse Response H averaged over all symbols of a frame (a) and calculated with averaged K (b).
Kl0 =
(10)










κl0,1(0)
κl0,2(0)
...
κl0,1(−M)
κl0,2(−M)
...
...
...
...
...
κl0,1(M)
κl0,2(M)
...
κl0,1(0)
κl0,2(0)
...
...
...
...
...
κl0,1(2M+1)
κl0,2(2M+1)
...
κl0,1(M+1)
κl0,2(M+1)










.
If the scrambling sequences would be completely orthog-
onal, the pilot scrambling matrix (10) would contain non-
zero elements (κj(0)) in the ﬁrst M + 1 rows only, i.e.,
rows M + 1 . . . 2M + 1, would not contribute at all to the
solution thus making K un-invertible. The accuracy of these
equations is therefore small even if the non-orthogonality of
scrambling is taken into account. To overcome this limitation
one has therefore either to average over at least as many
symbols as there are pilot sequences (see Section IV-B), or
the approach has to be extended such as to obtain equations
for each pilot symbol (see Section IV-C). This becomes
obvious when looking to the pilot scrambling matrix for
a single-tap channel including root raised cosine ﬁltering as
displayed in Fig. 4.
The upper half of K shows large real entries on the main
diagonal related to κ with argument 0, whereas the other
elements are dominated by the small scrambling correlation
coefﬁcients with arguments different from 0. As expected,
the calculation of the channel impulse response fails at least
partly even if afterwards an averaging over all symbols of a
frame is performed. This is shown in Fig. 5a for an AWGN
channel with raised cosine ﬁlter.
The channel coefﬁcients (at sampling positions) are ﬁnally
84
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

given by









h1(0)
h2(0)
...
h1(M)
h2(M)









= K−1
single,l0










ρl0(0)
...
ρl0(M)
...
ρl0(2M + 1)










.
(11)
B. Averaging Pilot Scrambling Matrix
The inaccuracy of the channel impulse response calculated
for a single symbol is caused by K being badly conditioned.
This can be improved by averaging both K → ⟨K⟩ and
ρ → ⟨ρ⟩. Although the general shape of the pilot scrambling
matrix is preserved by this operation the conditioning is now
about 10 orders of magnitude better and ⟨K⟩frame becomes
invertible. For an AWGN channel with raised cosine ﬁlter
it provides a perfectly estimated channel impulse response,
see Fig. 5b.
C. Twin Symbol Channel Estimation
The averaging procedure discussed in Section IV-B as-
sumes that K and ρ are statistically independent and the
averaging therefore factorizes and can be executed inde-
pendently. Inversion is then executed with the averaged
pilot scrambling matrix. The shown result implies that this
assumption is correct at least for a single tap channel
including root raised cosine ﬁlter.
There is, however, an alternative approach, which does
not need the above restriction: Both pilot scrambling matrix
and de-spread received signal vector are constructed using
two symbols with different pilot sequences,












ρl0(0)
...
ρl0(M)
ρl1(0)
...
ρl1(M)












= Ktwin,l0,1












h1(0)
h2(0)
...
...
h1(M)
h2(M)












,
(12)
where the pilot scrambling matrix Ktwin now is deﬁned as
Ktwin,l0,1 =
(13)












κl0,1(0)
κl0,2(0)
...
κl0,1(−M)
κl0,2(−M)
...
...
...
...
...
κl0,1(M)
κl0,2(M)
...
κl0,1(0)
κl0,2(0)
κl1,1(0)
κl1,2(0)
...
κl1,1(−M)
κl1,2(−M)
...
...
...
...
...
κl1,1(M)
κl1,2(M)
...
κl1,1(0)
κl1,2(0)












.
In the following, these symbols will be called twin
symbols if the two symbols are adjacent. The channel
coefﬁcients are then given by












h1(0)
h2(0)
...
...
h1(M)
h2(M)












= K−1
twin,l0,1












ρl0(0)
...
ρl0(M)
ρl1(0)
...
ρl1(M)












.
(14)
Now, all rows and columns of the pilot scrambling matrix
contain (at least) one main element as displayed in Fig. 6.
The real part shows two bars, one completely in the lower
half volume, the other in both half volumes. Whereas the
former belongs to equal pilot symbols for both channels,
the latter results from symbols of the second pilot being
inverse to the ones of the ﬁrst pilot.
The AWGN channel impulse response including raised
cosine ﬁlter calculated from the twin pilot correlation matrix
again matches perfectly with the ideal channel impulse
response, not only when averaged over all symbols of a
frame (see Fig. 7), but also for each twin symbol. This means
that no averaging is required in the absence of noise.
V. LINK LEVEL SIMULATIONS
In order to demonstrate the beneﬁt of the scrambling-exact
channel estimation we executed link level simulations for
a single UE moving with 3km/h and assuming a channel
of type Pedestrian A as it is deﬁned, e.g., in [19], table
1.2.2.2, Channel A. Two data streams were transmitted
in MIMO mode and for both the modulation and coding
scheme corresponding to entry 10 in the CQI mapping table
K [12] was used. The transmitting antennas were assumed to
be mounted crosswise diagonal (X), the receiving antennas
crosswise perpendicular vertical and horizontal (+) and
crosstalk between the polarization directions was allowed.
The basic model is displayed in Fig. 8.
The general relation between signals si, i ∈ {1, 2} sent
from antenna i and the signal rk received at antenna k is
then given by
rk
=

(a)
(b)
Figure 6.
Real (a) and imaginary (b) part of Pilot scrambling matrix Ktwin for one twin symbol.
(a)
(b)
Figure 7.
Twin Channel Impulse Response averaged over all symbols, compared with conventional correlation result and ideal case.
The block error rate (BLER) for each data stream was
determined as a function of SNR. As measure for per-
formance serve the SNRs for a working point (WP) at
10% BLER. The simulator operated on sub-chip level with
oversampling factor NOSF = 2, and also raised cosine ﬁltering
was included.
To demonstrate the enhanced impact of channel estimation
errors in case of cancelling inter-stream interference, Fig. 9
shows simulation results with channel estimation via the cor-
relation approach (denoted with corr) and with scrambling-
exact (twin) channel estimation for both interference cancel-
lation (IC) switched on and off. The respective SNR of the
working points measured in dB is given listed in the legend.
Regarding the results for the ﬁrst, stronger data stream
displayed with solid lines it can be seen that interference
cancellation has practically no impact on the performance,
the SNR difference of the working point is 0.1dB, whereas
scrambling exact channel estimation gains about 1.5dB.
Without interference cancellation, the situation is similar
also for the second, weaker data stream: The beneﬁt of
scrambling-exact channel estimation for the working point
is about 1.5dB, but a really huge gain is achieved if
interference cancellation and scrambling-exact channel es-
timation are combined: In this case, the working point is
shifted overall by more than 5dB. This result conﬁrms the
expectation of Section II where we explained the increased
impact of errors in channel estimation when the contribution
of the correctly decoded data stream is removed from the
incoming signal.
VI. RUNTIME-EFFICIENT IMPLEMENTATION
From the explanation in Section III it is clear that a
scrambling-exact channel estimation has to be paid with
increased implementation and runtime effort. Instead of
86
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 8.
Channel model including crosstalk between horizontal and
vertical polarized beams.
Figure 9.
Link level simulation results with simple correlation and
scrambling-exact channel estimation with and without interference cancel-
lation.
solving (5) in the correlative limit,
ρl0(d) = h1(d) + h2(d),
(16)
the elements κ of the pilot scrambling matrix K deﬁned in
(4) have to be calculated and the received signal convoluted
with the scrambling vector to be divided by K.
Fortunately, the pilot symbols s are ﬁx and the scrambling
code elements c are constant at least within a cell. This
allows executing the more expensive part, the calculation
of the matrix elements, in an initialisation phase during the
handover. Please note that the pilot scrambling matrix is
required only for decoding the HSDPA payload, not for the
control channels as the latter are not transmitted in MIMO
but in legacy SISO mode even if MIMO is active for the
respective UE.
The cheaper part is the division by K, a matrix of size
2(M +1)×2(M +1), which has to be executed permanently,
s
-
spreading
scrambling
channel
⊕
equalizer
≈ 1
-
de-spreading
de-scrambling
r
Figure 10.
Spreading and de-spreading chain for transmitted data.
i.e., during each update of the channel estimation as it is ap-
plied to the varying received pilot signal. As the dimensions
of K are comparable to the size of the LMMSE equalizer
matrix, which also contains matrix division and several
matrix multiplications, the equalization procedure can be
regarded as upper boundary for estimating the runtime effort
of this operation.
In principle it is possible to calculate the inverse of K in
advance, too, but this brings only minor beneﬁt as matrix
division and matrix multiplication are of similar complexity
for good conditioned matrix inversion. Even more important
is, however, the fact that the scrambling sequence c has
a length of 38400 [17] (number of chips in one frame)
and the inverse of all potential excerpts of it have to be
prepared if they shall be pre-calculated. Even if one restricts
to solving the channel estimation equation always within the
twin symbol boundaries, which have a length of 512 chips,
75 different matrices would have to be stored.
In the calculation of the matrix elements κ of (4) two types
of arguments occur, namely the summation index l and the
shifted index (l + d − k)/NOSF. Including the raised cosine
ﬁlter in the channel impulse response leaves the upsampled
but not yet ﬁltered signal for s, which is non-zero only for
integer arguments, reducing thus the number of elements
contributing to the sum to M + 1. The elements of κ hence
are non-zero only on chip-level,
κl0,j(k)
=
NSF
X
l=l0+1
c†(l)c(l + k)sj(l + k)
=
NSF
X
l=l0+1
c†(l)σj(l + k),
σj(i)
≡
c(i)sj(i).
(17)
Now, the elements for the required sequence of the
channel impulse response including the raised cosine ﬁlter,
k ∈ −M . . . M, can be calculated within one loop by just
circular shifting the index of σ by one step to the right with
increasing k. The matrix K is then constructed by cutting
out line-wise the required part of κ.
VII. SCRAMBLING IMPACT ON DATA DETECTION
The elaboration in the previous sections has shown the
signiﬁcant impact of scrambling on channel estimation and
87
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

hence rises the question how quasi-orthogonality of scram-
bling affects data detection. To discuss this in more detail we
will start with the data at the equalizer output and assume
that the data streams are well separated and the transmitted
signal before upsampling is re-constructed. We can then
restrict the discussion to the process chain as displayed in
Fig. 10.
This operation chain can formally be written as
r(l) =
NSF−1
X
k=0
c†(l + k)c(l + k)s(l + k).
(18)
From (18) we see that de-scrambling the data only makes
use of the normality but not of the quasi-orthogonal property
of scrambling as only coefﬁcients c at the same time
index l + k occur. De-scrambling the data is therefore not
affected by the deviation of scrambling sequences from
orthogonality. Of course quasi-orthogonality is required also
for data detection in order to remove interference from
other cells but this cannot be included correctly here as
otherwise both scrambling sequences and signal strengths of
all potential interferers would have to be known. In contrast
to the two pilot signals, interfering signals propagate along
different physical channels, which are especially different
from the channel relevant for both data and pilot signals
of the UE of interest. Therefore, it can be expected that
superposition of different interferers and equalisation with
channel coefﬁcients not matching these physical channels
the interfering signals propagate through will lead to a
further whitening of these contributions so that no systematic
error persists the interfering signals from other cells.
VIII. CONCLUSION
The usual procedure for estimating the radio channels
discards the small non-orthogonality of the autocorrelation
function of the pseudorandom scrambling sequence. As long
as only one pilot signal is transmitted this effect is negligible
as the error is more or less proportional to the strength of the
received pilot signal at the respective chip position. Delayed
multi-path taps bearing no pilot signal for the respective chip
are not affected at all.
The usage of multiple transmitting antennas, e.g., in
STTD or MIMO systems, allows to beneﬁt from spatial and
polarization diversity, which however requires to measure all
physical channels from each transmitting to each receiving
antenna. This is possible only if different pilot patterns (or
different linear combinations of them generated by different
pre-coding) are sent from the different transmitting anten-
nas. Ignoring deviation from orthogonality then causes that
energy scattered by scrambling out of a certain pilot pattern
will appear in another pilot pattern. This contribution is no
more proportional to the signal strength of the respective
pilot signal at the regarded chip. Also taps in fact containing
no pilot signal from the investigated chip position will
experience a signal contribution causing a huge relative
error.
It has to be emphasized that this error is present even in
case of pilot channels being fully separated, e.g., by cross
polarized wave fronts with each front bearing exactly one
pilot and receiving antennas oriented along the polarization
directions, as long as this fact is not known a priori on
receiving side: The estimator has to assume that signals
of both pilots are present at each receiving antenna and
hence misinterprets fractions scattered from the ’real’ pilot
by scrambling as contributions of the other pilot. Merely
a single pilot being present combined with the knowledge
about this fact on receiving side avoids this complication.
Due to the importance of channel estimation for reaching
high data rates, there are published many proposals for
improving the basic correlation approach, e.g., by ﬁltering
the primary channel estimates [4], cancelling inter-antenna
interference [5] or extending the RAKE correlation approach
to a LMMSE one [3] and thus taking into account all kinds
of interference. All of these suggestions can basically be
extended by scrambling-exact dealing the pilot patterns as
proposed in [1] even if we have investigated here only the
simple RAKE correlation approach, including appropriate
ﬁltering as described in [4], in the simulator.
Although the scrambling induced error does not occur in
data detection itself and is negligible in channel estimation
in many cases, high data rates in combination with MIMO
and transmission of two data streams require more accurate
channel estimation. This can be reached by taking into
account the scrambling sequence exactly in the channel esti-
mation algorithm. As in the correlation case, two symbols (in
case of two pilot signals) with different pilot code elements
are required to resolve the channels from both transmitting
antennas. Therefore, a twin symbol pilot scrambling matrix
is introduced with its inverse applied to the received signal
providing the channel impulse response.
The numerical effort of this approach is for sure higher
than the conventional correlation method. This effort how-
ever can at least partly be shifted to an initialization phase
because the pilot scrambling matrix only depends on the
scrambling sequence, the pilot patterns and the maximum
length of the channel but not on any quantities varying
with time. The complexity of an efﬁcient implementation
is then comparable to the one of an LMMSE equalizer.
Mainly the second (weaker) data stream beneﬁts from this
improved channel estimation if cancellation of inter-stream
interference is applied. In link level simulation it was shown
that its working point as function of SNR can be improved
by more than 5dB for 10% block error rate.
Currently it is discussed in 3GPP to extend MIMO to 4
data streams to be sent in parallel (see, e.g., [11]). As this
requires 4 pilot signals to be transmitted an even stronger
mutual distortion impact of pilot signals due to scrambling
can be expected. Although it is far from being clear how the
88
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

pilot scheme will be extended, scrambling induced deviation
from orthogonality has to be included in the course of its
deﬁnition.
ACKNOWLEDGMENT
The Author would like to thank Elke Hallmann and Klaus
Knoche for many inspiring discussions during this study.
REFERENCES
[1] W. Aichmann, Scrambling-Exact Channel Estimation in W-
CDMA Systems, in Proc. ICWMC, IARIA Luxembourg June
2011, p. 12-17. [Online] Available: http://www.thinkmind.org/
index.php?view=article&articleid=icwmc 2011 1 30 20028
[2] S. McBeath, M. Ahmed, and K. Rohani, Impact of imperfect
estimators on W-CDMA receiver performance with MIMO
antenna systems, in Proc. IEEE 58th Vehicular Technology
Conference (VTC 2003-Fall), vol. 2, Oct. 2003, pp. 1152-
1156. [Online]. Available: http://ieeexplore.ieee.org/ie15/9004/
28569/01285202.pdf?tp=&arnumber=1285202.
[3] Ch. Mehlf¨uhrer, and M. Rupp, Novel Tap-wise LMMSE Chan-
nel Estimation for MIMO W-CDMA, in Proc. 51st Annual
IEEE Globecom Conference, 2008, New Orleans, LA, USA,
Nov. 2008. [Online]. Available: http://publik.tuwien.ac.at/ﬁles/
PubDat 169129.pdf.
[4] B. Lindoff, Ch. ¨Ostberg, and H. Eriksson, Channel estima-
tion for the W-CDMA system, performance and robustness
analysis from a terminal perspective, in Proc. IEEE 49th
Vehicular Technology Conference (VTC 1999), vol. 2, July
1999, pp. 1565-1569. [Online] Available: http://ieeexplore.ieee.
org/iel5/6314/16887/00780649.pdf?tp=&arnumber=780649.
[5] I.R.S. Casella, E.S. Sousa, and P.J.E. Jeszensky, Chip space-
time block coding using iterative channel estimation with
inter-antenna interference cancellation for W-CDMA systems
using long scrambling codes, in Proc. IEEE 15th Interna-
tional Symposium on Personal, Indoor and Mobile Rdio Com-
munications, (PIMRC 2004), vol. 4, pp. 2313-2317. [On-
line] Available: http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=
&arnumber=1368732&isnumber=29952.
[6] j.-W. Choi and Y.-H. Lee, Evaluation of MIMO Transmission
for HSUPA, IEEE International Conference on Communica-
tions, 2003, vol. 1, pp. 748-752
[7] E. Dahlman, S. Parkvall, J. Sk¨’old, and P. Beming, 3G Evolu-
tion, HSPA and LTE for Mobile Broadband, 1st ed., Elsevier,
2007.
[8] 3GPP,
Technical
speciﬁcation
group
radio
access
net-
work; Physical channels and mapping of transport chan-
nels onto physical channels (FDD) (Tech. Spec. 25.211
V8.4.0), 2009. [Online]. Available: http://www.3gpp.org/ftp/
Specs/archive/25 series/25.211/.
[9] L. Fathi, G. Jourdain, and M. Arndt, A Bernoulli-Gaussian
Model
for
Multipath
Channel
Estimation
in
Downlink
WCDMA, IEEE/SP 13th Workshop on Statistical Signal Pro-
cessing, 2005, pp. 651-656
[10] H. Holma and A. Toskala, HSDPA/HSUPA for UMTS, John
Wiley & Sons, 2006.
[11] White
paper,
The
Evolution
of
HSPA,
4G
Americas,
2011,
[Online]
Available:
http://www.4gamericas.org/
documents/4G\%20Americas\%20White\%20Paper The\
%20Evolution\%20of\%20HSPA October\%202011x.pdf.
[12] 3GPP,
Technical
speciﬁcation
group
radio
access
net-
work; Physical layer procedures (FDD) (Tech. Spec. 25.214
V8.5.0), 2009. [Online]. Available: http://www.3gpp.org/ftp/
Specs/archive/25 series/25.214/.
[13] For HSUPA, it is suggested in 3GPP to use the same pre-
coding for pilot and data, which enables non-serving Node
Bs to decode the data without signalling them the pre-coding
index.
[14] M. Wrulich, S. Eder, I. Viering and M. Rupp, Efﬁcient Link-
to System Level Model for MIMO HSDPA, Proc. of the 4th
IEEE Broadband Wireless Access Workshop, New Orleans,
December, 2008.
[15] M. Wrulich, Ch. Mehlf¨uhrer and M. Rupp, Managing the
Interference Structure of MIMO HSDPA: A Multi-User In-
terference Aware MMSE Receiver with Moderate Complexity,
IEEE Transactions on Wireless Communications, 2010, vol. 9,
No. 4, pp. 1472-1482
[16] A.
Szabo,
Evaluation
of
MIMO
concepts
in
HSDPA
by
system
level
simulations,
Shaker
Verlag,
Aachen
2008.
[Online].
Available:
http://www.shaker.nl/
Online-Gesamtkatalog-Download/2011.09.12-14.18.08-192.
100.130.238-radB6669.tmp/3-8322-7822-2 INH.PDF
[17] 3GPP,
Technical
speciﬁcation
group
radio
access
net-
work; Spreading and modulation (FDD) (Tech. Spec. 25.213
V9.1.0), 2009. [Online]. Available: http://www.3gpp.org/ftp/
Specs/archive/25 series/25.213/.
[18] J. G. Proakis and M. Saleh, Digital Communications, 5th ed.,
McGraw-Hill, 2009.
[19] ETSI Technical Report, Universal Mobile Telecommunica-
tions System (UMTS); Selection Procedures for the Choice
of Radio Transmission Technologies of the UMTS (UMTS
30.03
version
3.2.0),
TR
101
112,
V3.2.0
(1998-04).
[Online]. Avalable: http://www.etsi.org/deliver/etsi tr/101100
101199/101112/03.02.00 60/tr 101112v030200p.pdf
[20] Markus Reinhardt, Analytical Performance Evaluation of
Downlink Beamforming with Power Control by Transmit Power
Limited Channel Inversion, AE ¨U Int. J. Electron. Commun.,
vol. 59, 2005, No. 2, pp. 1-7
89
International Journal on Advances in Telecommunications, vol 5 no 1 & 2, year 2012, http://www.iariajournals.org/telecommunications/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

