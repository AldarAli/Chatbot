Indirect Demand Side Management Program Under Real-Time Pricing  
in Smart Grids Using Oligopoly Market Model  
 
Poria Hasanpor Divshali1,2 and Bong Jun Choi1,2 
1 Department of Computer Science, The State University of New York (SUNY) Korea, Songdo, Incheon, Korea  
2 Department of Computer Science, Stony Brook University, New York, NY, USA 
Email: poriahd@gmail.com, bjchoi@sunykorea.ac.kr
 
 
Abstract—The rise in electricity demand, environmental 
concerns, and economic issues have increased the importance 
of demand response in recent years. Among different incentive 
methods of demand side management (DSM) programs, real-
time pricing (RTP) can adaptively control the electricity 
consumption while giving the decision authority to customers 
and satisfying the power system constraints. Although the 
existing RTP methods require a complicated computational 
process to determine the equilibrium point, this paper 
proposes a heuristic two-stage iterative method to quickly find 
the 
market 
equilibrium 
using 
the 
Cournot 
oligopoly 
competition model in a smart grid. The proposed method 
minimizes the cost for each customer by running a simple 
computational algorithm on each customer’s smart meter 
while also satisfying the power system constraints. The 
effectiveness and feasibility of the proposed method is 
demonstrated by conducting simulations in the IEEE 37-bus 
test system with about 1500 customers using real data sets of 
loads. The results show that the proposed technique can better 
manage the elastic loads in terms of power and cost in 
comparison with the existing methods and is quick enough to 
run in real-time. 
Keywords-Demand side management; Imperfect competition 
market; Indirect control; Real-time pricing; Smart grid; Smart 
meter. 
I. 
 INTRODUCTION 
Demand response (DR) can be defined as any change in 
electric usage of end-use customers from their normal 
consumption patterns in response to incentive payments 
designed to induce lower electricity use at times of high cost 
of electricity supply [1]. Under this definition, the demand 
side management (DSM) programs include all activities that 
alters the consumer’s demand profile to match the supply 
profile [2]. The idea of DSM is not new and it emerged in 
electrical systems in the 1970s and has evolved over the past 
four decades. The smart grid (SG), infrastructures such as 
two-way communication system are attracting more 
researchers to DSM concepts in recent years.  
Implementing DSM leads to technical and economic 
benefits for utilities and customers, if the number of 
participants is large enough. Customer motivation methods 
in DSM have a major role in the customers’ participation. 
The different motivation methods in DSM are surveyed into 
[3]. Generally, the motivation methods can be divided in two 
main categories: incentive based methods and time based 
methods. The incentive based programs offer payments to 
customers who reduce their electricity usage during periods 
of system need or stress [4]. However, in order to determine 
the amount of reduction, a baseline load threshold must be 
calculated for each customer, which is a complicated and 
imprecise procedure [5].  
In the time based programs, the price of consumption is 
varied based on the time of usage and can lead customers to 
transfer consumption to the off-peak period [6]. The time 
based program has two different subcategories. Some 
programs offer varying prices for different time periods but 
do not change prices based on customers’ decisions, e.g., the 
time of use (TOU) method. Some other programs consider 
the effects of customers’ decisions and change the price in 
real-time manner, e.g., real-time pricing (RTP) method. 
The TOU method has a critical drawback; since the price 
of each time period is independent from customers’ behavior 
and each customer decides individually, it is possible that all 
customers decide to simultaneously use in off peak period , 
causing a new “rebound” peak [7,8]. In order to solve this 
problem, retailers must determine the price of each time 
period based on the real-time consumption. Implementation 
of RTP method requires two-way real-time communication 
and complicated computational process for determining the 
optimum price [3]. This complication causes most of 
researchers employ direct methods to control demand, and 
minimize the total cost of the distribution grid by a central 
optimization technique [9,10]. However, using a direct 
control method takes away the decision authority from 
customers and produces adverse effects in the popularity and 
security of participants [11]. In addition, most of DSM 
methods do not pay attention to each customer’s profit, and 
as a result, customers tend to contribute less in DSM. In 
order to solve this problem, the authors of [12] propose a 
multi-agent framework to minimize the electricity bill of 
each household while considering the piecewise linear 
function for each customer’s cost. Still, the method neglects 
the correlation of loads with each other and cannot prevent 
rebounding peak.  
Implementing the RTP-based indirect DSM program 
involves the electrical market models with an oligopoly 
competition instead of the perfect competition model. 
Typically, there are two competitive market models: the 
perfect 
competition 
and 
the 
imperfect 
competition 
15
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-524-1
GREEN 2016 : The First International Conference on Green Communications, Computing and Technologies

(oligopoly) model. The perfect competition model, which 
assumes that the decision of each participant in market has 
no effect in the market price, is relatively simpler and so it 
has gained popularity in the power market. Although in the 
power system, the consumption of each customer alone has 
negligible effect in the whole network; in indirect controlling, 
due to customers sometimes making similar decisions, it may 
have a big effect on the power system. In this case, the power 
market cannot be modeled by a perfect competition, and in 
order to consider the effect of real-time behavior of 
customers, an imperfect competition or oligopoly model is 
more suitable. The implementation of an imperfect 
competition is much more complicated than a perfect one. 
For modeling oligopoly energy productions, the Cournot 
competition model is widely used [13]. However, using this 
model on the customer side, with many participants, has 
more complexity. Since customers cannot neglect their 
energy consumption, they can only shift it to another time 
period; therefore, the energy consumption of each time 
depends on the consumption of other time periods. On the 
other hand, the energy price of different time periods 
depends on the total network consumption and loss in that 
time period. Consequently, in the Cournot model, the energy 
price of each time interval depends on the consumption of all 
customers in the present and the future time periods. The 
authors of [14] employ a Cournot competition to model a 
dynamic price for an intelligent building but they make some 
simplifying assumptions, such as linear inverse demand 
curve or having exclusive energy storage device to solve the 
problem, which limits the implementation of their technique. 
Another weak point of existing research in DSM is that 
most of them do not consider the power system limits such 
as the electrical lines’ overloading, power stability, power 
loss, and so on. A game-theoretic real-time price market to 
maximize the profit of each participant is proposed in [15]. 
However, their method does not have the ability to consider 
nonlinear power flow equations. 
In this paper, we propose a new heuristic two-stage 
technique to implement indirect DSM program under RTP 
method. This technique can quickly find the optimum power 
of each customer in a decentralize manner to minimize their 
own cost while satisfying the technical constraints of the 
power system. The main contributions of this paper are 
summarized as follows: 
• 
Proposes a dynamic RTP-based DSM program using 
a Cournot imperfect competition market model 
preventing rebound peak. 
• 
Implements an indirect charging technique that gives 
the decision authority to all customers. 
• 
Minimizes the cost of each customer individually 
instead of considering whole the network cost (all 
customers together). 
• 
Proposes a heuristic two-stage iterative method to 
quickly find the market equilibrium point. 
• 
Considers the power issues such as power loss or 
lines overload using nonlinear power flow equations. 
• 
Solves systems with nonlinear constraints and non-
convex cost function.  
The rest of this paper is organized as follows. The 
mathematical modeling of the RTP-based indirect DSM is 
presented in Section II. A proposed heuristic method is 
explained in Section III. The simulation network and the 
simulation results are detailed in Section IV. Finally, we 
conclude in Section V. 
II. 
RTP-BASED INDIRECT DSM MODEL 
In this RTP-based indirect DSM program, each customer 
wants to schedule its appliances to minimize its cost by 
considering the influence of other customers based on the 
Cournot oligopoly model. It is assumed that each customer 
has two types of loads: inelastic loads, which cannot be 
shifted, such as lightings, and elastic loads, such as wet 
appliances, which can shift during a defined time period. 
When one appliance starts to operate it should continue its 
operation until the given task is done. In this case, each 
customer should determine the optimum time of turning 
elastic loads on, while satisfying the network and its own 
constraints. The objective function of this optimization 
problem is defined as follows: 
 
,
0,
,
0,
0,
,
1
Min
( ). ( )
e i
k
d ik
k
ik
n
t
t
e ik
t
k
t t
Obj
P
t
t
π
+
=
=
= ∑ ∑
               
(1) 
where Pe,ik (t) is the active power of the i-th customer’s k-th 
elastic appliance in time t; t0,ik is the starting time of the k-th 
appliance; td,ik is the time duration that the appliance need to 
finish its task; ne,i is the number of i-th customer’s elastic 
appliances; π(t) is the market price and it is updated based on 
the total real-time power consumption of the network in each 
time interval as follows: 
 
( )
( )
( )
( )
,
,
,
1
1
,
ne i
n
ie i
e ik
loss
i
k
t
S
P
t
P
t
P
t
π
=
=




=
+
+












∑
∑
  
(2) 
where n is the number of customers, Pie,i(t) is the inelastic 
power of i-th customer; Ploss is the power loss of the 
electrical grid; and S is the power grid supply function 
calculated from supply side management (SSM) program or 
the supply curve giving the cost of the supplied energy for 
the power grid. The power loss of the network can be 
calculated as follows [16]: 
 
(
)
1
1
cos
,
m
m
loss
i
k
ik
i
k
ik
i
k
P
V V Y
δ
δ
θ
=
=
=
−
−
∑∑
  
(3) 
where |Vi| and δi are the magnitude and phase of i-th bus 
voltage, |Vk| and δk are the magnitude and phase of k-th bus 
voltage, respectively; m is the number of network buses; and 
|Yik| and θik are the magnitude and phase of the grid 
admittance matrix, respectively. The voltage of all buses can 
be calculated from nonlinear power flow equations as 
described 
in 
many 
literatures. 
In 
this 
paper, 
a 
backward/forward sweep method, which considered to be the 
best appropriate method for distribution electrical networks, 
is implemented [17]. Since these equations are nonlinear, 
many DSM programs optimize the system neglecting the 
power loss and power constraints. However, in practice, the 
DSM program should consider the power network 
16
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-524-1
GREEN 2016 : The First International Conference on Green Communications, Computing and Technologies

First stage:
Customer side
Pe,i 
Pe,1 
Pe,2 
π(t)=π new 
π(t)
Customer 1
Customer 2
Customer i
Measure
 Pie(t)and Qie(t)
Inelastic demand 
Prediction
Market price 
prediction
π(t)
Second stage: 
Grid side
Backward/Forward power flow calculation
Update market price 
(Algorithm 2)
 πnew, πmin , πmax
πs(t)-π(t)<ε 
πmax-πmin<ε 
No
No
Assign residual power
(Algorithm 3)
End of interval t
t=t+1
Yes
Yes
PE,1 (t)
PE,2 (t)
PE,n (t)
Eopt
P
Calculate the supply price πS
1-st appliance
2-ns appliance
k-th appliance
Algorithm 1
Pe,ik(t+1) Pe,ik(t)
Pe,ik(t0,k+td,ik)
 
Figure 1. The proposed method to solve the RTP-based indirect DSM 
 
constraints in addition to each customer constraints. The 
overload of power lines and voltage bus regulation 
constraints are as follows: 
 
( )
,max
,
k
k
I
t
I
t
<
∀   
(4) 
 
( )
min
max
,
j
V
V
t
V
t
<
<
∀   
(5) 
where Ik(t) is the magnitude of k-th branch current in time t; 
Ik,max is the k-th branch capacity; Vmin and Vmax are the 
minimum and maximum levels of voltage of the network, 
respectively. 
Furthermore, each customer has some 
individual constrains. First, their task should be finished 
before the desired time, so the starting time should be 
selected as follows: 
 
0,
,
,
,
ik
end ik
d ik
t
t
t
t
k
≤
<
−
∀
  
(6) 
where t is the present time interval, and tend,ik is the desired 
finishing time of i-th customer’s k-th appliance. Second, each 
customer has a specific maximum allowable demand. 
Therefore, the total consumption of i-th customer in each 
time interval should satisfy the following constraint: 
( )
( )
,
,
2
2
2
,
,
,
,
max,
1
1
( )
( )
,
e i
e i
n
n
ie i
e ik
ie i
e ik
i
k
k
p
t
p
t
Q
t
Q
t
S
t
=
=




+
+
+
≤
∀












∑
∑
 (7) 
where Qie,i (t) is the inelastic reactive power of the i-th 
customer in time t; Qe,ik (t) is the reactive power of the i-th 
customer’s k-th elastic appliance in time t; and Smax,i is the 
maximum allowable apparent power of i-th customer. 
Consequently, the mathematical model of the RTP-based 
indirect DSM program using the Cournot oligopoly 
competition model is as follows: 
( )
( )
( )
,
,
0,
,
0,
,
0,ik
,
,
,
1
1
1
,
1 if t=t
,
1
1
1
Min
( ) .
( )..
( )
. .
.
.
.cos(
),
PowerFlowequations [21]
e i
e i
ik
e i
k
d ik
n
n
n
e ik
ie i
e ik
loss
t
k
i
k
n
t
t
P
e ik
k
t
m
m
pe
e
e
loss
i
k
ik
j
k
ik
i
k
Obj
P
t
S
P
t
P
t
P
t
P
s t
P
V
V
Y
τ
τ
π
τ
δ
δ
θ
=
=
=
+
=
= +
=
=




=
+
+












+
=
−
−
∑
∑
∑
∑
∑
∑∑
( )
( )
,
,
,max
min
max
0,
,
,
2
2
2
,
,
,
,
max,
1
1
,
( )
( )
,
( )
( )
,
,
,
,
.
,
,
e i
e i
e
k
k
e
j
ik
end ik
d ik
n
n
ie i
e ik
ie i
e ik
i
k
k
I
t
I
V
V
t
V
t
t
t
p
t
p
t
k
t
k
t
t
k
t
t
Q
t
Q
t
S
=
=
<
<
<
≤
<
−




+
+
+
≤












∀
∀
∀
∀
∀
∀
∀
∑
∑
  (8) 
where πP(τ) is the predicted energy price for future times. 
The equilibrium point (real-time price) of the network can be 
calculated from solving the above optimization problem by 
each customer, simultaneously. In order to solve this 
optimization problem, each customer should predict its own 
consumption for the future times and estimate other 
customers’ consumptions in the present time and future 
times. Furthermore, this is a nonlinear non-convex multi-
objective optimization problem with many variables, and it 
cannot be solved in this form. In the next Section, a heuristic 
two-stage iterative method to quickly calculate the Nash 
equilibrium point of the network is proposed. 
III. 
THE TWO-STAGE HEURISTIC METHOD 
This Section presents a heuristic two-stage iterative 
method to solve the RTP-based indirect DSM program 
optimizing problem in (8). In this method, a modified 
optimization 
problem, 
which 
neglects 
the 
network 
constraints and the dependency of price to other customers’ 
decisions, is solved in the first stage by each customer. The 
second stage calculates the whole network states and 
compensates the modification of the first stage using an 
iterative algorithm to approach the equilibrium. Figure 1 
illustrates the mechanism of the proposed method. 
A. First Stage: Customer Side 
In the first stage, customers minimize their cost regarding 
the local constraints in a given price. In this case, the 
optimization problem of (8) converts to (9) as follows: 
( )
( )
,
0,
,
0,
0,
,
,
,
1
0,
,
,
2
2
2
,
,
,
,
max,
1
1
Min
( ).
( )
. .
,
,
( )
( )
.
e i
k
d ik
ik
ik
e i
e i
n
t
t
e ik
d
t
k
t t
ik
end ik
d ik
n
n
ie i
e ik
ie i
e ik
i
k
k
Obj
P
t
t
s t
t
t
t
t
k
p
t
p
t
Q
t
Q
t
S
π
+
=
=
=
=
=
≤
<
−
∀




+
+
+
≤












∑ ∑
∑
∑
(9) 
17
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-524-1
GREEN 2016 : The First International Conference on Green Communications, Computing and Technologies

Algorithm 1: First stage – Minimizing customer cost (9) 
1: Order the i-th customers’ elastic appliances from the smallest tend,ik - 
td,ik (k=1) to the largest tend,ik - td,ik  (k=ne,i). 
2: For k=1 to ne,i do 
3: 
Calculate cost 
0,
,
0,
, ( ). ( )
k
d ik
ik
t
t
e ik
t t
P
t
t
π
+
∑ =
 for 
0,
,
,
( ,
).
ik
end ik
d ik
t
t t
t
∈
−
 
4: 
Check constraint:
( )
( )
2
2
2
,
,
,
,
max,
1
1
(
( ))
(
( ))
k
k
ie i
e il
ie i
e il
i
l
l
P
t
P
t
Q
t
Q
t
S
=
=
+
+
+
≤
∑
∑
 
for all t. 
5: Select the cheapest costs that satisfy the constraint. 
 
 
Figure 2. The demand and supply curve in a rational power market; a) 
a general form; b) when customers decide similar 
Algorithm 2: Second stage - part 1, calculating πnew,πmin, πmax 
1: If πd
 < πs then πmin =max(πmin , πd
 ) else πmax =min(πmax , πd
 ) 
2: πnew = ( πmin + πmax ) / 2. 
 
where πd (t) is a given market price, which is updated for 
time interval t by the second stage to consider the 
dependency of each customer to other customers and 
network constraints. Although, the optimization problem of 
(9) is much easier to solve than (8) and some of the existing 
optimization methods can be used to solve this problem, this 
paper propose a heuristic method to quickly find the 
optimum solution of (9). As our method only use the simple 
mathematical operation, it can be implemented in simple 
computing devices such as smart meters. 
In order to accelerate the calculation process, the 
proposed technique schedules each appliance separately. The 
algorithm orders the plugged elastic appliances of i-th 
customer in time t from the appliance with the smallest to the 
largest desired finishing time, and then the starting time of 
each appliance is selected sequentially so that the cost 
becomes minimum. In other words, the algorithm gives a 
higher priority to the appliance that should finish its task 
sooner than others and has fewer options. In order to 
determine the starting time (t0,ik), the electricity cost of the 
task for different starting times are calculated and the 
cheapest one that satisfies (7) is selected. Algorithm 1 details 
the first stage of the proposed heuristic method to solve (9). 
B. Second Stage: Grid Side 
In the first stage, the optimum consumption of each 
customer in the given demand price (πd) is calculated. In the 
second stage, the supply price (πs) for the total power of the 
network is calculated and if the prices are not same, the price 
of the first stage is updated to approach the equilibrium point. 
Generally, in a rational power market, a supply curve is a 
non-decreasing function and a demand curve is a non-
increasing function; and the Nash equilibrium point is the 
intersection of these two curves (as shown in Figure 2.a). In 
this case, if πs is greater than π, the price of the equilibrium 
point (π*) is also greater than π, and vice versa.  
The proposed algorithm uses this idea and bisects the 
difference between these two prices (πs - πd) to find the 
equilibrium point. Algorithm 2 details the process of finding 
the new price (πnew) for the next iteration. In this algorithm, 
πmin and πmax are the upper and lower limits of the 
equilibrium price, respectively. In order to satisfy the 
network constraints, a controlling price is added into πnew to 
control the consumption of each bus. 
In the indirect method, since each customer wants to 
minimize its own cost, they may make a similar decision and 
collectively cause sudden changes in the demand curve as 
shown in Figure 2.b. In this case, although the proposed 
bisectional method converges to the equilibrium price (πmin ≈ 
πmax), the consumption power cannot be calculated from the 
demand curve due to the sudden changes in this curve. The 
algorithm calculates the consumption power from inverse 
supply curve and assigns the difference between P* and 
P(πmax), called the residual power, to some random 
customers by changing their price from πmax to πmin. This 
little change has no effect on the market price but changes 
their power consumption. In a real system with different 
appliances and different consumption behavior of customers, 
the occurrence probability of this problem is very low. Still, 
the proposed algorithm can be used to handle the problem. 
Algorithm 3 details the proposed method to handle this 
problem. 
IV. 
CASE STUDY 
A. Simulation Setup 
For our simulation, the IEEE-37 bus test system is 
selected. Figure 3 shows the single line diagram of this 
system and the line data and the maximum power of each 
bus is taken from [18]. We generate the load profiles based 
on homes with different appliances and customer behavior 
modeled in [19]. For this purpose, a group of different home 
profiles (without wet appliances) are created by the simulator 
given in [20] as inelastic loads; then the adequate number of 
them, randomly, is assigned to each bus to consume the same 
maximum power reported as in [18]. This procedure results 
in 1491 customers connected to the different buses 
consuming about 14.5 MWh in each day. This high-
consumption inelastic profile helps us to show the 
effectiveness of the proposed method in a power system 
under stressed. 
18
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-524-1
GREEN 2016 : The First International Conference on Green Communications, Computing and Technologies

1
2
3
4
5
6
7
23
24
22
8
36
25
35
10
9
11
26
12
13
29
28
14
15
16
33
34
32
30
31
27
18
17
19
20
21
37
 
Figure 3. The IEEE-37 bus test system  
 
Algorithm 3: Second stage-part 2, allocating residual power. 
1: Select πmax as π*. 
2: Calculate P (πmax) from Algorithm 1. 
3: Calculate P* from supply curve. 
4: Pres = P* - P (πmax) 
3: While Pres >0 do  
4: 
Select a customer randomly, change its price to πmin, and 
calculate ∑Pe,ik (πmin). 
5: 
Pres = Pres - (∑Pe,ik (πmin) - ∑Pe,ik (πmax) ) 
 
 
Figure 4. The average consumption profile of elastic appliances 
 
We consider two different elastic appliances: dish washer 
and clothes washer with tumble dryer. The average 
consumption profiles of them is shown in Figure 4. These 
profiles are the hardest profiles to handle for the proposed 
algorithm due to a long time consumption period and a high 
difference of energy consumption during the period. When 
these appliances start to operate, they should operate until the 
task is completed. However, the price may change in future 
time intervals and this can become a source of error in the 
proposed method. Still, the simulation results in the next 
Section show that the proposed method can still manage this 
problem well.  
It is assumed that customers use the dish washer with the 
probability of 50 % in each day and they turn it on between 8 
and 10 am and the task needs to be done before 6 to 9 am of 
the next day with the uniform distribution. The clothes 
washer is plugged into the network between 10 and 12 am 
with probability of 50% and the task needs to be done before 
10 to 12 am of the next day with the uniform distribution. 
These elastic appliances add about 5.5 MWh to total energy 
consumption of the network. 
As shown below in (10), the supply function is calculated 
so that the average price for off-peak and on-peak time of 
inelastic loads equal to 4 and 17 ¢/kW according to [21]. 
2
(
)
3.77
7.
1.41
4.
5.32
2,
total
total
total
S P
E
P
E
P
E
=
−
+
−
+
−
 
(10) 
where Ptotal is the total input power of the network including 
power loss. In this simulation the error of inelastic power 
prediction and price forecasting is modeled by a normal 
distribution with standard deviation equals to three per cent.  
B. Simulation Results 
The proposed two-stage method solving the RTP based 
indirect DSM program is implemented in MATLAB 
platform using a computer with an 8-core 2.3 GHz CPU and 
8 GB RAM. We consider different cases as listed below: 
• 
Case 1: The network without elastic loads. 
• 
Case 2: The network with the elastic loads and 
without DSM program (i.e., flat rating program). 
• 
Case 3: The network with the elastic loads and with 
TOU based DSM program [21]. 
• 
Case 4: The network with the elastic loads and with 
the proposed RTP based indirect DSM program. 
 Figure 5 shows the total active power and the marginal 
cost of energy production in different cases. The system 
without elastic loads is shown in case 1 (details are shown in 
Figure 6). In this case, the demand peak is equal to 1045 kW 
and the maximum marginal cost is equal to 0.32 $/kW. 
Without DSM program (case 2), each appliance consumes 
the power as soon as it connects to the network. In this case, 
a demand peak (1908 kW), which is much higher than the 
inelastic demand peak is created around noon and increases 
the maximum marginal cost to 1.16 $/kW. The TOU based 
DSM program (case 3) has low energy tariff during off-peak 
periods, which attracts the elastic loads to consume power in 
these periods. In this case, a new rebound peak is generated 
as shown in Figure 5. The rebound peak in this case is equal 
to 1654 kW and the maximum marginal cost is 0.85$/kW. 
Table I compares the peak power, the energy loss during 
each day, the maximum marginal cost, the total energy cost, 
and the minimum bus voltage in different cases.  
Figure 6 shows the total active power of elastic 
appliances in the proposed method. Customers, in order to 
avoid expensive electricity price, schedule their elastic loads 
when the real-time price is low. As a result, none of the 
elastic loads consumes energy between the hours of 17 and 
23. This strategy leads the peak power of network and the 
maximum marginal cost of the production to remain constant 
although the energy consumption increased by 38%. Table I 
shows that the total cost of energy supplied in the proposed 
method (2849 $) is about half of the total cost of energy 
supplied in the flat rate (5617 $) or TOU based (5250 $) 
program. 
19
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-524-1
GREEN 2016 : The First International Conference on Green Communications, Computing and Technologies

 
Figure 5. Comparison between cases 1-4: (a) total active power, b) marginal cost 
 
Figure 6. Comparation between the proposed method (case 4) and inealstic loads (case 1): a) total active power, b) the real time price 
The results show that the total elastic power consumption 
has some small local peak. These local peaks are happen 
because the method is an indirect one and each customer 
decides independently, and we consider the worst load 
profiles, which have a large operating period. Using load 
profiles, which has less dependency during time, such as 
water heaters or electrical vehicles, can improve the results 
even more. 
Figure 7 shows the worst voltage profiles of different 
cases. In cases 2 and 3, because system has a high peak 
demand, the voltage of some buses drop lower than 95%, 
while the proposed method (case 4), has voltage profile 
exactly same as case 1 due to the peak load control. In cases 
1 and 4, the worst voltage drop occurs on bus 26 at 19:20’. 
The number of iterations and the calculation time for 
each time interval are shown in Figure 8. As each customer 
optimizes its consumption, the proposed method can quickly 
find the equilibrium point. In this implementation, each time 
interval is assumed equal to 10 minutes long, which is a 
practical assumption in SGs. However, the proposed 
algorithm can be employed for time intervals less than one 
minute due to fast calculation. 
V. 
CONCLUSION  
The environmental concern and shortage in fossil fuel is 
increasing the penetration level of renewable energy sources 
in the electrical grids. The uncontrollable nature of output 
power produced by renewable source makes a DSM program 
more imperative in the modern power grid. In this paper, a 
new RTP-based indirect DSM program using an imperfect 
competition market in smart grids is proposed. The indirect 
DSM program gives the decision authority to customers and 
can attract more customers to participate in the program, 
while the imperfect competition market model prevents the 
rebounding peak and satisfies the power system constraints. 
Although, the indirect demand control in an imperfect 
competition market leads to a complicated nonlinear non-
convex multi-objective optimization problem, this paper 
proposes a heuristic two-stage iterative method to quickly 
solve the problem. The method is implemented in MATLAB 
on the IEEE 37-bus test system to analyze the effectiveness 
of the method. The test system includes about 1500 
customers with actual load profiles and different elastic 
appliances. The results show that the proposed method 
solves the problem quickly enough for real-time application 
and it decreases energy cost of individual customers and 
TABLE I. 
 PERFORMANCE COMPARISON OF DIFFERENT CASES 
 
Peak power 
(kW) 
Energy loss 
(kWh) 
Maxi price 
($/kW) 
Total energy 
cost ($) 
Mini voltage 
(%) 
Case 1 (Base line) 
1045 
262 
0.317 
1710 
95.1 
Case 2 (Without DSM) 
1908 
583 
1.156 
5617 
90.2 
Case 3 (TOU based DSM) 
1654 
559 
0.850 
5250 
91.3 
Case 4 (Proposed) 
1045 
443 
0.317 
2849 
95.1 
 
20
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-524-1
GREEN 2016 : The First International Conference on Green Communications, Computing and Technologies

 
Figure 7.  The worst voltage profiles 
 
 
Figure 8.  The numebr of itterations and the calculation time for each 
time interval 
power loss, and also maintain power system constraints, such 
as voltage regulation, within their limits. 
ACKNOWLEDGMENT 
This research was funded by the MSIP (Ministry of 
Science, ICT and Future Planning), Korea, under the "ICT 
Consilience Creative Program" (IITP-2015-R0346-15-1007) 
supervised by the IITP (Institute for Information & 
communications Technology Promotion) and under the 
"Basic Science Research Program" (2013R1A1A10104 89, 
2015R1C1A1A01053788) through the NRF (National 
Research Foundation). 
REFERENCES 
[1] "Benefits of demand response in electricity markets and 
recommendations for achieving them. A report to the United 
States Congress pursuant to section 1252 of the Energy Policy 
Act of 2005," ed. US Washington, DC: US Washington, DC: 
Department of Energy.[ https://www.smartgrid.gov/files/ 
Benefits_Demand_Response_in_Electricity_Markets_Recom
mendati_200608.pdf] (20 Jun 2016). 
[2] M. Alizadeh, X. Li, Z. Wang, A. Scaglione, and R. Melton, 
"Demand-side management in the smart grid: Information 
processing for the power switch," Signal Processing 
Magazine, IEEE, vol. 29, Issue.5, 2012, pp. 55-67. 
[3] J. S. Vardakas, N. Zorba, and C. V. Verikoukis, "A Survey on 
Demand Response Programs in Smart Grids: Pricing Methods 
and Optimization Algorithms," Communications Surveys & 
Tutorials, IEEE, vol. 17, Issue.1, 2015, pp. 152-178. 
[4] M. Parvania and M. Fotuhi-Firuzabad, "Demand response 
scheduling by stochastic SCUC," Smart Grid, IEEE 
Transactions on, vol. 1, Issue.1, 2010, pp. 89-98. 
[5] S. Braithwait, "Behavior modification," Power and Energy 
Magazine, IEEE, vol. 8, Issue.3,2010, pp. 36-45. 
[6] A. W. Berger and F. C. Schweppe, "Real time pricing to assist 
in 
load 
frequency 
control," 
Power 
Systems, 
IEEE 
Transactions on, vol. 4, Issue.3, 1989, pp. 920-926. 
[7] A. Safdarian, M. Fotuhi-Firuzabad, and M. Lehtonen, "A 
distributed algorithm for managing residential demand 
response in smart grids," Industrial Informatics, IEEE 
Transactions on, vol. 10, Issue.4, 2014, pp. 2385-2393. 
[8] T.-H. Chang, M. Alizadeh, and A. Scaglione, "Real-time 
power balancing via decentralized coordinated home energy 
scheduling," Smart Grid, IEEE Transactions on, vol. 4,. 
Issue.3, , 2013pp. 89-98. 
[9] P. McNamara and S. McLoone, "Hierarchical Demand 
Response for Peak Minimization Using Dantzig-Wolfe 
Decomposition," Smart Grid, IEEE Transactions on, vol. 6, 
Issue.6, 2015, pp. 2807-2815. 
[10] T. Logenthiran, D. Srinivasan, and T. Z. Shun, "Demand side 
management in smart grid using heuristic optimization," 
Smart Grid, IEEE Transactions on, vol. 3, Issue.3, 2012, pp. 
1244-1252. 
[11] M.S. Kuran, A.C, Viana, L, Iannone, D, Kofman, G, 
Mermoud, and J.P. Vasseur, "A Smart Parking Lot 
Management System for Scheduling the Recharging of 
Electric Vehicles," Smart Grid, IEEE Transactions on, vol. 6, 
Issue.6, 2015, pp. 2942-2953. 
[12] Z. Wang and R. Paranjape, "Optimal residential demand 
response for multiple heterogeneous homes with real-time 
price prediction in ashould be a spacemultiagent framework," 
IEEE Trans. Smart Grid 2015, 10.1109/TSG.2015.2479557 
[13] D.S. Kirschen, G. Strbac, "Fundamentals of Power System 
Economic". John Wiley & Sons: West Sussex, UK, 2004 
[14] Q.D. La, Y.W.E.Chan, B.-H. Soong, "Power management of 
intelligent buildings facilitated by smart grid: A market 
approach," IEEE Trans. Smart Grid 2016, 7, 1389–1400. 
[15] T. Namerikawa, N. Okubo, R. Sato, Y. Okawa, and M. Ono, 
"Real-Time Pricing Mechanism for Electricity Market With 
Built-In Incentive for Participation," Smart Grid, IEEE 
Transactions on, vol. 6, Issue. 6, 2015, pp.2714-2724. 
[16] J. G. Grainger and W. D. Stevenson Jr, Power System 
Analysis. India McGraw-Hill Education, Dec 1, 2003  
[17] G. Chang, S. Chu, and H. Wang, "An improved 
backward/forward sweep load flow algorithm for radial 
distribution systems," Power Systems, IEEE Transactions on, 
vol. 22, Issue.2, 2007, pp. 882-884. 
[18] A. Al-Hinai, K. Sedhisigarchi, and A. Feliachi, "Stability 
enhancement of a distribution network comprising a fuel cell 
and a microturbine," presented at the Power Engineering 
Society General Meeting, 2004. IEEE, Denvor, colorado,USA, 
June, 2004. 
[19] I. Richardson, M. Thomson, D. Infield, et al., "Domestic 
electricity use: A high-resolution energy demand model," 
Energy and Buildings, vol. 42, Issue. 10, 2010,pp. 1878-1887. 
[20] Richardson, I.T. Domestic electricity demand model-
simulation 
example. 
Availabe 
online: 
https://dspace.lboro.ac.uk/dspace-jspui/handle/2134/5786 (19 
May 2016). 
[21] SmartGridCity pricing plan comparison chart. Availabe 
online: http://smartgridcity.xcelenergy.com/media/pdf/SGC-
pricing-plan-chart.pdf (19 May 2016) 
21
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-524-1
GREEN 2016 : The First International Conference on Green Communications, Computing and Technologies

