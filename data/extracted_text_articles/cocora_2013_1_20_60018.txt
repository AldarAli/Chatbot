Efficiency of Opportunistic Spectrum Sensing by Sequential Change Detection in 
Cognitive Radio 
 
Karsten Husby, Arne Lie, Jan-Erik Håkegård 
Communication Systems 
SINTEF ICT 
Trondheim, Norway 
karsten.husby@sintef.no 
 
 
Abstract—A critical point in cognitive radio spectrum sensing 
is the ability to detect presence and absence of primary users 
as fast as possible at very low SNR. In this paper, sequential 
power detection by cumulative sum and recursive generalized 
likelihood ratio test is used to detect free spectral slots of 
opportunity. The benefits of these change detection algorithms 
are the adaptive sensing window, the low processing burden 
and the optimality in sense of maximum likelihood. A 
spectrum utilization efficiency metric is proposed that put a 
cost on late detections as well as on false alarms that might give 
rise to harmful interference into the primary system. The 
efficiency metric is then simulated versus the size of the free 
slot of opportunity and for different SNR. The detectors 
presented are found useful for cognitive radio.  
Keywords-Cognitive radio; CUSUM; GLRT; Hypothesis 
testing; Maximum likelihood estimation; 
I. 
 INTRODUCTION 
Algorithms for quick detection under noisy conditions 
have been in use since the 1920s. The first control chart 
originated from Bell Labs, where Dr. Shewhart set up 
control limits based upon the Bell curve to find out if a 
process was in control or out of control.  
Later, an improved method based on an intuitive 
cumulative sum was proposed [1]. This method is now 
named CUSUM, and is closely related to the Neyman-
Pearson test that tries to distinguish between two hypotheses 
[2][3][4] when the probability density function (PDF) for 
both is known in advance.  
Another popular, but often regarded as a high 
complexity test, is the generalized likelihood ratio test 
(GLRT), where unknown parameters are part of the PDF of 
the process. Because this test is based on maximum 
likelihood estimation (MLE), it is asymptotically optimal 
for a large number of applications. However, for systems 
requiring a low false alarm probability, a huge amount of 
data needs to be stored and processed before an optimal 
decision can be made [8][9][10][11][12][13]. This is 
particularly troublesome in high bandwidth systems. 
For cognitive radio spectrum sensing, high performance 
and low processing burden detectors are wanted. Recursion 
is often an efficient processing method, and in this paper, 
focus is put on low processing burden recursive change 
detection algorithms that also offer certain optimality in the 
maximum likelihood (ML) sense. One useful recursive 
algorithm is the CUSUM detector, which is optimal for a 
given signal to noise ratio (SNR). Structures of parallel 
CUSUM detectors that are optimal for several SNRs may be 
implemented and lead to GLRT type of detectors. One 
particularly useful detector is the recursive GLRT detector 
called R-GLRT [5].  
In cognitive radio secondary users need to detect when to 
transmit or not. This involves both power turn-off and power 
turn-on detection. All knowledge about the primary user 
transmit timing and the free window of opportunity W is also 
important. If this window is unknown it becomes important 
to estimate W or at least transmit packets short enough not to 
interfere with the primary user at power turn-on. Detectors 
both for on and off detection are presented but estimation of 
W is considered outside the scope of the paper.  
This paper contributes in the area of spectrum sensing 
for opportunistic cognitive radio networks using the well-
known CUSUM detector and the novel R-GLRT detector at 
very low SNR where the processing burden of other GLRT 
type detectors is significant. Both CUSUM and R-GLRT are 
very efficient algorithms that do not saturate when the 
amount of collected data grows. Due to their optimality, 
these detectors give increased spectral utilization. An 
efficiency metric is presented to quantify the performance 
offered by these detectors. 
This paper is organized as follows. After a system 
introduction in Section II, the CUSUM detector and  
R-GLRT detector are presented in Section III. In Section IV 
both algorithms are simulated, and in Section V their impact 
when used in a cognitive radio system is found based on the 
spectrum efficiency metric. 
II. 
MULTIPLE HYPOTHESES SYSTEM MODEL 
The detector operates on an increasing number of n input 
samples x(i), 
1:
i
n
=
 supplied from any sensor circuitry 
such as a bandpass filter, a FFT processor, a cyclostationary 
feature processor, or a Kalman filter matched to the 
parameter whose change is to be detected. The samples are 
assumed to be independent and identically distributed 
although such a limitation is not always required according 
to [16]. Without loss of generality x(i) is assumed normal 
distributed with mean value µ and standard deviation σ ; i.e., 
 
(
( ); )
( )
( ,
)
p x i
N
N
θ
θ
µ σ
=
=
 
(1) 
Immediately after an unknown sample number m the 
primary user either turns off or on its transmitter. This is 
defined as the change point 
7
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-267-7
COCORA 2013 : The Third International Conference on Advances in Cognitive Radio

 
[
0 : ]
m
n
∈
 
(2) 
Before and at the change point m, we have ( )
x i  N(θ0). 
After the change point for i
> m
, we have ( )
x i  N(θ1). It is 
necessary to handle all possible 
n +1
 different change points 
m as separate hypotheses Hm meaning that the m first 
samples belong to N(θ0) and the rest to N(θ1). In [5] it is 
established that CUSUM and R-GLRT are detectors that 
solves this multiple hypotheses problem. 
III. 
CUSUM AND R-GLRT CHANGE DETECTION 
It has been proven [7] that the CUSUM test only needs 
to investigate the sequential sum of the log likelihood ratio 
(LLR) between two probabilities to reach asymptotic 
optimal performance as long as both θ0 and θ1 are known in 
advance. It has also been proven that CUSUM is optimal for 
all finite thresholds γ [4] . The LLR is 
 
(
)
(
)
0
1
( )
( ( )
ln
ln
;
)
( ( );
)
LLR i
x i
p x i
p
θ
θ
−
=
 
(3) 
which in case of the normal distribution is 
 
(
)
(
)
1
2
2
0
1
2
2
0
0
1
( )
( )
ln
2
)
2
(
x i
x i
LLR i
µ
µ
σ
σ
σ
σ
−
−


=
−
+




 (4) 
The sum LLR is very efficiently implemented in 
recursive form. The cumulative sum C is started from an 
initial value C(0) that affects the transient response of the 
CUSUM. It is possible to improve the performance if C(0) 
is increased to balance out the transient. This is called fast 
initial response (FIR) CUSUM [14][15]. In this paper,  
C(0) = 0, even though the R-GLRT algorithm also will 
benefit from FIR. The CUSUM recursive programming step 
is 
 
( )
(
1)
( )
C i
C i
+ LLR i
=
−
 
(5) 
for 
1:
i
n
=
. For the traditional single sided CUSUM 
algorithm, only the final value C(n) is stored for later use. In 
addition, the maximum value of C at the change point is 
stored as 
  
(
)
max
( )
M
C i
=
 
(6) 
The CUSUM stopping time becomes 
 
{
}
( )
min
:
T
n M
C n
γ
=
−
>
 
(7) 
The average run length ARL1 is the average stopping 
time when all samples are
( 1
N θ )
. ARL0 is the average 
stopping time when all samples are N(θ0) and is equivalent 
to the mean duration between false alarms.  
The R-GLRT detector simultaneously runs parallel 
CUSUMs  
,
0,
1,
u s
u
s
C
L
+ L
=
  
 
(8) 
indexed by u to adapt to different prior statistics θ0,u for 
1:
i
n
=
  
 
(
)
0
0,
0,
,
( )
(
1)
( ( );
ln
)
u
u
u
x
i
p
i
L
L
i
θ
=
−
+
 
(9) 
and indexed by s to adapt to different θ1,s statistics after the 
change point. 
(
)
(
)
1,
1,
1,
( )
(
1)
ln
( );
s
s
s
L
i
L
i
p x i θ
=
−
−
          (10) 
The ML solution, which is already inherently part of the 
traditional CUSUM [5] is then solved recursively in 
multiple dimensions that includes the unknown statistics 
before and after the change point as well as the MLE of the 
change point itself ˆm . 
 
[
]
( )
(
)
,
1,
arg m x
ˆ ˆ ˆ
, ,
a
u s
s
M
L
n
u s m =
−
  
(11) 
The stopping time under these constraints becomes  
 
{
}
ˆ ˆ
ˆ
ˆ
ˆ ˆ
,
0,
1,
,
(
m n
)
)
i
:
(
u s
u
s
u s
T
n
L
n
L
n
M
γ
−
=
−
>
 
(12) 
IV. 
CHANGE DETECTION SIMULATIONS 
Simulations are done in MATLAB by a flexible  
R-GLRT detector that handles any number of pre change 
parameter sets θ0,u and any number of post change 
parameter sets θ1,s. If the number of possible pre change 
parameter sets and post change parameter sets are only one 
then the R-GLRT algorithm collapse into the traditional 
CUSUM algorithm.  
The simulations show how well these detectors are able 
to detect a sudden shift in variance. The signal to noise ratio 
generating the change is defined as  
 
(
)
2
2
2
0
1
1
0
2
2
0
1
(
)
min
,
SNR
µ
µ
σ
σ
σ
σ
−
+
−
=
 
(13) 
For detection of a change in variance, the mean values 
are disregarded by setting µ0 = µ1 = 0. To detect primary 
user power turn-on, 
2
0
1
σ
=
 and 
2
2
2
1
0
p
σ
σ
σ
=
+
, where the 
primary user power is represented by
2
p
σ . To detect primary 
user turn-off, 
12
1
σ
=
 and 
2
2
2
0
1
p
σ
σ
σ
=
+
. In both cases the 
primary user power is swept.  
Results from a simulation of ARL for detection of 
sudden power turn-on and turn-off are given in Fig. 1. ARL0 
should be as high as possible and ARL1 should be as low as 
possible. Note that the power turn-on detection is slightly 
better than the power turn-off detection both with regard to 
detection speed and false alarm at the optimum SNR which 
in this example is -3dB. It is important to note that the 
detection of primary user power turn-on or the detection of 
primary user power turn-off leads to different ARL although 
the algorithm is almost the same. 
 
-10
-8
-6
-4
-2
0
2
4
6
2
4
6
8
10
12
14
16
ln(ARL)
SNR dB
ARL1 (circle) and ARL0
for power turn off
ARL0 (circle) and ARL1
for power turn on
 
Figure  1.  ARL for unknown power turn-on and off of two CUSUM 
detectors with γ=6 running equal but swapped sets of parameters θ.  
8
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-267-7
COCORA 2013 : The Third International Conference on Advances in Cognitive Radio

One obvious difference for CUSUM is that detecting an 
unknown power turn-on gives improved detection speed if 
the power (SNR) is increased. Opposite, while detecting an 
unknown power turn-off the detection speed is almost 
constant independent of the apriori SNR.  
A. The SNR wall problem 
The CUSUM detector needs knowledge about θ0 and θ1 
for optimal performance. The R-GLRT detector is able to 
pick the most likely θ0 and θ1 when they are not known in 
advance. Therefore unknown power levels both before and 
after the change point can be controlled. However, if the 
system noise floor is not properly calibrated it is impossible 
to distinguish between the power from an actual primary user 
or the unknown power from the detector itself. This 
eventually leads to the so-called SNR wall problem [17]. It is 
therefore obvious that some kind of automatic noise floor 
calibration is needed to prepare the detectors for accurate 
operation. In such a setting the R-GLRT detector is not only 
capable of giving stopping information but also valuable 
tracking information to refresh any estimate of the detector 
set noise σ0. While important, this topic is anyway outside 
the scope of this paper. 
B. Primary user turn-on detection 
The ARL for an unknown power turn-on is presented in 
Fig.  2. As illustrated, the two CUSUMs are quite robust to 
SNR offsets from their most optimal design points. 
Therefore the discretization of the continuous parameter 
space can be done by a relatively small number of parallel 
CUSUMs when setting up the R-GLRT algorithm. The 
simulation shows that this R-GLRT algorithm reaches 
almost identical stopping times compared to each of the 
single CUSUMs at their best SNR.  
C. Primary user turn-off detection 
Fast and reliable turn-off detection is considered very 
important for cognitive radio applications. One complicating 
factor is the presence of multiple primary users at different 
power level turning off their transmitters at unknown 
change points.  
 
 
 
It turns out that it is more complicated to detect the last 
(and sometimes the weakest) primary user power turn-off 
than the first primary user power turn-on. For example, 
assume 2 primary users, one strong and the other one at 
weak power. They transmit both for a long time. During this 
period the R-GLRT integrate prior statistics for all different 
θ0,u. The algorithm is however not capable of collecting any 
useful information about the weaker transmitter. If the 
stronger primary user turns off its carrier, the assumption of 
a constant (but unknown) θ0 no longer holds, and the R-
GLRT will have to trust the stopping condition from the 
CUSUM running on the weak power setting independent of 
the potential higher likelihood and faster stopping times 
from other CUSUMs.The R-GLRT detector is therefore not 
very well adapted to the task of detecting all primary users 
power turn off. 
The CUSUM detector is on the other hand well adapted 
for such a task. In this case the mean detection speed versus 
different SNR becomes constant while the false alarm 
probability is reduced when the power is increased as 
illustrated in Fig. 1. This kind of detector behavior is 
conservative and not far from the wanted behavior. While it 
is possible to achieve faster detection speeds for higher SNR 
using the R-GLRT detector, the detection of power off has 
to be given with a certain confidence for the power being 
below a certain level. One single CUSUM is in fact capable 
of doing this task in ML optimal manner for all γ. Therefore 
we entirely focus on the CUSUM detector for power off 
detection. 
The CUSUM power off detector is simulated for three 
different SNR as depicted in Fig. 3, Fig. 4 and Fig. 5. In 
these Figs interpolated ARL values are fitted based on 
 
0
0
1
1
ARL
k e
ARL
k
γ
γ
≈
≈
 
(14) 
Closed form expressions of ARL are difficult to derive. It 
is however obvious that the mean likelihood growth is linear 
for constant θ. Therefore ARL1 becomes asymptotically 
linear to γ. Our simulations also strongly indicate that ARL0 
is asymptotically linear to eγ . 
 
 
 
Figure  2.  ARL1 for unknown power turn-on of two CUSUM detectors 
optimal at -12dB and 0 dB compared with ARL1 from R-GLRT containing 
three CUSUM detectors each optimal at -12, -6 and 0dB. ARL0  for no shift 
equals 132000 for all. 
1
2
3
4
5
6
7
4
6
8
10
12
14
Turn off CUSUM SNR=-9dB, k0 = 306, k1 = 241  
ln(ARL)
γ
 
 
ARL0 simulated
ARL0 interpolated
ARL1 simulated
ARL1 interpolated
 
Figure  3.  ARL for power turn off versus γ. 
9
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-267-7
COCORA 2013 : The Third International Conference on Advances in Cognitive Radio

 
 
 
The empirical asymptotic solutions (14) are therefore 
well suited to find ARL at larger thresholds where 
simulations are cumbersome 
V. 
COGNITIVE RADIO SENSING EFFICIENCY 
In this chapter the sequential change detection 
algorithms are linked to cognitive radio opportunistic 
spectrum utilization. A spectral efficiency metric is defined 
that express how well the available spectrum is utilized. 
There are two terms that contribute to this metric. They are 
the correct transmissions factor ηc and the faulty 
transmissions penalty ηf. ηf is also to be understood as the 
maximum interference ratio into the primary system if a 
primary user is doing a continuous transmit operation. The 
total spectrum efficiency metric is defined by subtracting 
these two terms after weighting them equally 
 
c
f
η
η
η
=
−
 
(15) 
Correct transmissions are defined as transmissions done 
when the channel is idle during a free window of W 
consecutive samples. The utilization of this window is 
   
1
c
W
ARL
W
η
−
=
 
(16) 
where the length of the secondary user transmission is  
W-ARL1. If ARL1 approaches zero, the utilization approaches 
unity which is the highest possible. If 
ARL1
≥ W
, no mean 
successful utilization is possible. The second term of the 
spectral efficiency is the penalty when interfering into the 
primary user spectrum 
 
1
1
0
f
W
ARL
W
ARL
ARL
η
−
=
−
+
 
(17) 
where W-ARL1+ARL0 is the average length between each  
faulty transmission. The efficiency metric η approaches its 
optimal value unity if ARL1 << W << ARL0. Note that the 
idle window size W is assumed either known or estimated 
by the secondary users. Once the primary user turn-off 
change point ˆm is detected at the stopping time instant T, 
the secondary user is assumed to be capable of transmitting 
a packet with duration W+ ˆm -T before the free slot of 
opportunity closes after W samples. If in doubt about the 
size of W and the accuracy of ˆm , the secondary user may 
decide to turn off early to allow itself to search for the 
primary user turn-on to update estimates of W. The 
cognitive radio spectral efficiency in case of correct 
knowledge of W and negligible variance of ˆm becomes 
 
1
1
1
0
W
k
W
k
W
W
k
k eγ
γ
γ
η
γ
−
−
≈
−
−
+
 
(18) 
From this equation it is possible to find the maximum 
efficiency for a given SNR and W by varying γ. The result is 
given in Fig. 6. It is thinkable to utilize short windows of 
opportunity if the SNR from all primary users is known to 
be high. However, at an SNR of -21 dB, at least 12,000,000 
free samples are needed to give an utilization higher than 
95%. All different CUSUMs, independent of SNR 
optimality set point, surprisingly need the same threshold γ 
for a given efficiency. For example at 95% efficiency a 
threshold of 10.8 is needed. At 97.5% efficiency the 
threshold has to be increased to 12.4 regardless of CUSUM 
SNR setting. 
It is also important to check out ηf versus η. This is given 
in Fig. 7. With a total efficiency of 95% the maximum 
interference ratio into the primary system becomes 0.43%. 
 
 
1
2
3
4
5
6
7
10
12
14
16
18
20
Turn off CUSUM SNR=-21dB, k0 = 61118, k1 = 52303  
ln(ARL)
γ
 
 
ARL0 simulated
ARL0 interpolated
ARL1 simulated
ARL1 interpolated
 
Figure  5.  ARL for power turn off. 
1
2
3
4
5
6
7
6
8
10
12
14
16
Turn off CUSUM SNR=-15dB, k0 = 3807, k1 = 3119  
ln(ARL)
γ
 
 
ARL0 simulated
ARL0 interpolated
ARL1 simulated
ARL1 interpolated
 
Figure  4.  ARL for power turn off. 
10
4
10
5
10
6
10
7
10
8
80
85
90
95
100
 γ  =7.9
 γ  =9.1
 γ  =10.8
 γ  =12.4
W
η %
SNR=-9dB
SNR=-15dB
SNR=-21dB
 
Figure  6.  Maximum spectrum efficiency utilization η versus W for 
three different CUSUMs and their individual SNR at optimal γ.  
10
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-267-7
COCORA 2013 : The Third International Conference on Advances in Cognitive Radio

 
 
If on the other hand the thresholds of all CUSUMs are 
frozen to for example 10.8, then the spectrum efficiency 
versus W becomes modified as shown in Fig. 8.  Because 
the threshold now is constant, the efficiency will begin to 
drop when W increase above a certain maximum length. In 
this situation the penalty ηf due to longer faulty 
transmissions starts to increase. To avoid this burden for the 
primary user system, an adaptive threshold setting versus W 
is necessary. 
The spectral efficiency found here is close to the results 
given in [6] using a predefined fixed window length. The 
main difference and the benefit of recursive sequential 
detection compared to block based sensing is that the 
sensing window length is not chosen in advance but rather is 
decided by the algorithm itself as soon as the predefined 
likelihood is reached. As a consequence, sequential 
detection is more robust to variable conditions. Another 
complicating factor of block based sensing is the need for 
synchronization or sliding window techniques to maintain 
an optimum start with respect to the unknown change point. 
VI. 
CONCLUSION 
Two algorithms for ML optimal change detection have 
been presented and compared for cognitive radio 
application. The R-GLRT achieves as expected better 
performance under unknown SNR conditions particularly 
for power on detection. Power off detection is very well 
handled by the traditional CUSUM detector. For 95% 
spectrum efficiency utilization a free window of 50,000 
samples is needed at SNR=-9dB, 700,000 free samples is 
needed for SNR=-15dB and 12,000,000 free samples is 
needed for SNR=-21dB. It is shown that the interference 
level against the primary users in this case is 0.43% 
independent of SNR. 
The processing burden of the R-GLRT as simulated in 
this paper, is about 20 additions per input sample and unlike 
traditional GLRT completely independent of observation 
window size and threshold setting. Therefore both the 
traditional CUSUM and the R-GLRT algorithm are 
particularly useful in cognitive radio when doing lengthy 
estimations at low SNR and low probability of false alarm. 
REFERENCES 
[1] E.S. Page, “Continuous inspection schemes,” Biometcrica, 
1954, vol. 41, pp.100-115. 
[2] S. M. Kay, Fundamentals of statistical signal processing  
Volume II Detection theory,  Prentice hall, 2009. 
[3] M. Basseville, I. V. Nikiforov, Detection of Abrupt Changes: 
Theory and Application, Previously published by Prentice-
Hall Inc. 
[4] H. Vincent Poor and O. Hadjiliadis, Quickest Detection, 
Cambridge University Press, 2009. 
[5] K. Husby, A. Lie, and J. E. Håkegård, “Quickest recursive 
GLRT Maximum Likelihood change detection,” 2012, 
unpublished. 
[6] A. M. Wylinski, M. Nekovee, and Y. T. Hou, Cognitive radio 
communications and networks, Principles and Practice, 
Academic Press, 2010. 
[7] G. Lorden, “Procedures for reacting to a change in 
distribution,” The Annals of Mathematical Statistics 1971, 
vol. 42, No. 6, 1897-1908. 
[8] G. J. Ross, D. K. Tasoulis, and N. M. Adams, “Sequential 
monitoring of a Bernoulli sequence when the pre-change 
parameter is unknown,” Comput Stat, doi: 10.1007/s00180-
012-0311-7, Springer-Verlag, 2012.  
[9] H. Li, C. Li, and H. Dai, “Quickest Spectrum Sensing in 
Cognitive Radio,” 42nd Annual Conference on Information 
Sciences and Systems, doi: 10.1109/CISS.2008.4558521, pp. 
203-208, 2008. 
[10] L. Lai, Y. Fan, and H. Vincent Poor, “Quickest Detection in 
Cognitive 
Radio: 
A 
Sequential 
Change 
Detection 
Framework,” doi: 10.1109/GLOCOM.2008.ECP.567, pp. 1-5,  
IEEE GLOBECOM, 2008. 
[11] G. Verdier, N. Hilgert, and J. P. Vila, “Optimality of CUSUM 
Rule Approximations in Change-Point Detection Problems: 
Application to Nonlinear State–Space Systems,” IEEE 
Transactions on information theory, vol. 54, No. 11, pp. 5102-
5112, November 2008. 
[12] F. Gustafsson, “The marginalized likelihood ratio test for 
detecting abrupt changes,” Automatic Control, IEEE 
Transactions on 41(1): pp. 66-78, 1996. 
[13] T. 
Kerr, 
“Decentralized 
Filtering 
and 
Redundancy 
Management for Multisensor Navigation,” Aerospace and 
Electronic Systems, IEEE Transactions on AES-23(1): pp. 83-
119, 1987. 
[14] J. M. Lucas and R. B. Crosier, “Fast Initial Response for 
CUSUM Quality-Control schemes: Give your CUSUM a 
head start,” Technometrics, vol. 24, NO. 3, August 1982 
[15] J. Lee, S. Pullen, and P. Enge, “Sigma-mean monitoring for 
the local area augmentation of GPS,” Aerospace and 
Electronic Systems, IEEE Transactions on 42(2): pp. 625-635, 
2006. 
[16] G. V. Moustakides, “Quickest detection of abrupt changes for 
a class of random processes,” Information Theory, IEEE 
Transactions on 44(5): pp. 1965-1968, 1998. 
[17] R. Tandra and A. Sahai, “SNR Walls for Signal Detection,” 
IEEE Journal of selected topics in signal processing, vol. 2, 
NO. 1, pp. 4-17, doi: 10.1109/JSTSP.2007.914879, Feb 2008. 
80
85
90
95
100
0
1
2
3
η  %
ηf %
Figure  7.  Primary system interference ηf versus total spectral efficiency 
η in percent at optimal γ.  
10
4
10
5
10
6
10
7
10
8
90
92
94
96
98
100
W
η %
SNR=-15dB
SNR=-9dB
SNR=-21dB
 
Figure  8.  Spectrum efficiency utilization η versus W and SNR for 
three different CUSUM having equal thresholds γ=10.8. 
11
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-267-7
COCORA 2013 : The Third International Conference on Advances in Cognitive Radio

