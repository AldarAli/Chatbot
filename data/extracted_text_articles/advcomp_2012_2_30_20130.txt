Hybridizing Direct and Indirect Optimal Control Approaches
for Aircraft Conﬂict Avoidance
Lo¨ıc Cellier, Sonia Caﬁeri
Lab. MAIAA
´Ecole Nationale de l’Aviation Civile
Toulouse, France
Email: {loic.cellier, sonia.caﬁeri}@enac.fr
Fr´ed´eric Messine
´ENS ´E ´EIHT - IRIT
Universit´e de Toulouse
Toulouse, France
Email: frederic.messine@n7.fr
Abstract—Aircraft conﬂict avoidance is a crucial issue aris-
ing in air trafﬁc management. The problem is to keep a given
separation distance for aircraft along their trajectories. We
focus on an optimal control model based on speed regulation
to achieve aircraft separation. We propose a solution strategy
based on the decomposition of the problem and on the
hybridization of a direct and an indirect method applied on
the obtained subproblems. Numerical results show that the
proposed approach is promising in terms of reduction of
computing time for conﬂict avoidance.
Keywords-air trafﬁc management; conﬂict avoidance; speed
regulation; optimal control; Pontryagin’s maximum principle.
I. INTRODUCTION
In the context of Air Trafﬁc Control (ATC), motivated
by safety and efﬁciency reasons, tools for decision support
are requested. To avoid the risk of collision, distances of
separation must be respected. It is said that two aircraft are
in conﬂict if the distances between them are less than 5 NM
horizontally and 1000 ft vertically (1 NM (nautical mile) =
1852 m and 1 ft (feet) = 0.3048 m).
Various methods of conﬂict detection and resolution have
been proposed (see e.g., [8]). They are based on different
strategies that can be exploited to achieve aircraft separation,
such as trajectory (heading), ﬂight level or velocity changes.
Evolutionary computation based algorithms are widely
studied in this context [5]. They are, in general, low time-
consuming, but the global optimal solution and even a
feasible solution (without conﬂicts) is not garanteed to
be achieved in a given time. Several models of optimal
control also appeared in this domain [1, 10, 11]. They are
mainly based on changes of aircraft trajectories, putting the
trajectory as a command on the system.
Recently, the European project ERASMUS (En-Route Air
trafﬁc Soft Management Ultimate System) [2] considered
speed regulation and suggested a small velocity change
range to enable a subliminal control, that is a speed control
which is even not perceived and is performed without
informing air trafﬁc controllers. Velocity change approaches
have also been recently studied in the context of mixed
integer linear and nonlinear programming [4, 9, 11].
This work focuses on aircraft conﬂict avoidance problems
solved through speed regulation. We propose an optimal
control approach keeping the ﬂight trajectories and focusing
on velocity variations.
The paper is organized as follows. First, in Section II,
we present an optimal control model for the addressed air
trafﬁc control problem which should be solved by small
speed changes. In Section III, we propose stategies to deal
with computational complexity. Particularly, we propose a
decomposition of the problem by considering different time
periods such that the separation constraints have to be
imposed only in the time periods when the aircraft conﬂicts
potentially occurr. In Section IV, we present an analytical
resolution based on the Pontryagin’s maximum principle
(PMP) in the other time periods, i.e., the ones where conﬂict
have already been solved. In Section V, we discuss numerical
results issued to the methods. In Section VI, conclusions are
drawn.
II. OPTIMAL CONTROL MODEL
THROUGH VELOCITY REGULATION
We present an optimal control model to achieve separation
based on speed changes only, keeping the aircraft trajectories
unchanged. The acceleration, ui respective to each aircraft
i, is then the command on the system.
In model (P), xi, vi and ui are respectively the position,
the velocity and the acceleration (control) of aircraft i,
with I = {1, ...,n} and n the number of aircraft involved;
aircraft are expected to be at the same altitude (planar
conﬁguration, same ﬂight level). For each aircraft i, velocity
vi and acceleration ui are bounded (i.e., belonging to [vi, vi]
and [ui, ui] respectively).
We note by t, t0 and tf the time, the initial time and ﬁnal
time respectively. Moreover, D is the minimum required
horizontal separation distance between two aircraft and di
is the direction (heading) of the ith aircraft. The ﬁnal time
tf of maneuvers is ﬁxed and identical for all aircraft. The
mathematical model is the following:
42
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-237-0
ADVCOMP 2012 : The Sixth International Conference on Advanced Engineering Computing and Applications in Sciences

(P)



































min
u
n
X
i=1
Z tf
t0
u2
i (t)dt
˙vi(t) = ui(t)
∀t ∈ [t0, tf ], ∀i ∈ I
˙xi(t) = vi(t)di
∀t ∈ [t0, tf ], ∀i ∈ I
ui ≤ ui(t) ≤ ui
∀t ∈ [t0, tf ], ∀i ∈ I
vi ≤ vi(t) ≤ vi
∀t ∈ [t0, tf ], ∀i ∈ I
xi(t0) = x0
i
vi(t0) = v0
i
∀i ∈ I
xi(tf) = xf
i
vi(tf) = vf
i
∀i ∈ I
D2− ∥ xi(t) − xj(t) ∥2≤ 0
∀t ∈ [t0, tf ], ∀i < j
We choose to minimize a quadratic energy-dependent cost
function depending on speed variations. This criterion takes
into account the contribution of each aircraft and also limits
the penalization inequality between the aircraft.
Note that one of the main difﬁculties on this optimal
control model is given by the constraints on the state
variables v and x. In the next section, we present resolution
approaches tailored on the problem to achieve its efﬁcient
solution.
III. SOLUTION APPROACH BY
DECOMPOSITION OF THE PROBLEM
A typical solution approach for an optimal control prob-
lem like (P) is based on the application of a direct method.
It is based on a time discretization and leads to the solution
of a nonlinear (continuous) optimization problem (NLP),
which can be solved by standard NLP local solvers. For (P),
the corresponding NLP problem can be difﬁcult to solve
for large-scale problems, mainly due to the large number
of variables and constraints. The complexity of the NLP
corresponding to the direct method is O(np) for the number
of variables and O(n2p + p2) for the number of constraints,
where n and p are the number of aircraft and the number
of time subdivisions respectively. For example, even on a
simple conﬂict problem, with only 2 aircraft and a time
window equals to 30′ (with time subdivision equals to 15′′)
the corresponding nonlinear problem has more than 240
variables and 9000 constraints.
We ﬁrst recall that, in order to perform aircraft separation,
a detection of potential conﬂict regions and a resolution step
have to be carried out. The two steps can be performed at
the same time by applying a direct method.
We propose to distinguish two discretization steps. The
ﬁrst one, for the detection, has to be tight enough to check
if all constraints are respected. The second one, for the
resolution, is used to decide the time frequency at which
values the controls are computed and it can be larger than
the previous one. For example, we used 15′′ for the detection
and 1′ or 5′ for the resolution. As discussed in Section
V, this strategy allows to reduce the number of variables
and constraints of the nonlinear optimization problem to be
solved.
Another possibility is to perform a pre-processing step to
detect potential conﬁcts. Given aircraft predicted trajectories,
one can check intersections of the trajectories and identify
spatial regions where the separation constraints must be
checked [7]. Once the different regions have been localized,
one can exploit this information to devise a speciﬁc strategy
of resolution aimed at reducing the computational complex-
ity of the problem at hand. The main contribution of this
paper is a strategy based on problem decomposition and
related hybridization of optimal control solution methods.
Let zone be the region where for an aircraft pair separation
constraints have to be veriﬁed and postzone be the following
region where all the conﬂicts have been solved and when the
aircraft are already separated.
For each aircraft i, let xenter
i
be the ﬁrst (by chronological
order) 3D trajectory point for which there exists an aircraft j
(j ̸= i) such that the Euclidean distance between xenter
i
and
the straight line corresponding to the jth aircraft predicted
3D trajectory is equal to the separation standard D. For each
aircraft i, let t1
i be the time to reach xenter
i
using the highest
speed vi. Dually, for each aircraft i, let xexit
i
be the last 3D
trajectory point for which there exists an aircraft j such that
the Euclidean distance between xexit
i
and the straight line
corresponding to the jth aircraft predicted 3D trajectory is
equal to the separation standard D. For each aircraft i, let
t2
i the time to reach xexit
i
using the lower speed vi.
For n aircraft, setting the entry zone time equals to
t1
:= mini∈{1,...,n} t1
i
and the exit zone time t2
:=
maxi∈{1,...,n} t2
i , we deﬁne conﬂict time phases for the
whole problem. The zone and postzone correspond respec-
tively to the time periods [t1, t2] and [t2, tf],
The postzone being characterized by the absence of sepa-
ration contraints, it represents a subproblem easier to solve
than the initial problem deﬁned on the whole time horizon.
We can apply the PMP [3] as discussed in the next section
on the postzone. On the remaining time window, the direct
method is applied. Numerical integrators of Euler-type are
used to approximate the ordinary differential equations de-
scribing the system dynamic and different time discretization
steps mentioned above are exploited.
IV. APPLICATION OF THE
PONTRYAGIN’S MAXIMUM PRINCIPLE
Without the separation constraint (difﬁcult state con-
straints), we can easily apply the PMP, which gives us an
analytical solution. In the postzone (time window [t2, tf]),
as the aircraft conﬂicts have been solved, the necessity to
check separation constraint does not exist anymore. The
velocity and acceleration constraints are checked a posteri-
ori. Hence, for each aircraft i the following optimal control
sub-problem (Pi) can be solved independently. We recall
the assumption that aircraft are expected to be at the same
43
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-237-0
ADVCOMP 2012 : The Sixth International Conference on Advanced Engineering Computing and Applications in Sciences

altitude (planar conﬁguration, same ﬂight level) so that two-
components vectors appear in the formulation. The distinc-
tion between the two components of the direction (heading)
vector di = (dX
i , dY
i )T and the distinction between the
position components xi = (xX
i , xY
i )T have been done to
make easier the formalism.
(Pi)

























min
ui
Z tf
t2
u2
i (t)dt
˙vi(t) = ui(t)
∀t ∈ [t2, tf ]
˙xX
i (t) = vi(t)dX
i
∀t ∈ [t2, tf ]
˙xY
i (t) = vi(t)dY
i
∀t ∈ [t2, tf ]
xX
i (t2) = x
Xt2
i
xY
i (t2) = x
Yt2
i
vi(t2) = vt2
i
xX
i (tf) free
xY
i (tf) free
vi(tf) = vtf
i
We apply on (Pi) the indirect method. We introduce the
co-state variables zi
0, zi
1, zi
2, zi
3, where zi
1, zi
2, zi
3 are associ-
ated to xX
i , xY
i and respectively vi. Writing the Hamiltonian
Hi
=
zi
0u2
i + zi
1vidX
i + zi
2vidY
i + zi
3ui ,
the co-state equations are:
˙zi
1 = − ∂Hi
∂xX
i
= 0 , ˙zi
2 = − ∂Hi
∂xY
i
= 0 ,
˙zi
3 = −∂Hi
∂vi
= −(zi
1dX
1 + zi
2dY
1 ) .
By ﬁxing zi
0 = −1, by using the PMP [3], we obtain:
u∗
i = argmin
ui
Hi = zi
3
2 .
Solving the differential system composed by state and co-
state equations and introducing six real constants Ai, Bi, Ci,
Di, Ei and Fi, we obtain:
(Si)





















































zi
1(t) = Ai
and
zi
2(t) = Bi ,
zi
3(t) = −(AidX
i + BidY
i )t + Ci ,
ui(t) = −AidX
i + BidY
i
2
t + Ci
2 ,
vi(t) = −AidX
i + BidY
i
4
t2 + Ci
2 t + Di ,
xX
i (t) = −Ai(dX
i )2 + BidX
i dY
i
12
t3
+ Ci
4 dX
i t2 + DidX
i t + Ei ,
xY
i (t) = −AidX
i dY
i + Bi(dY
i )2
12
t3
+ Ci
4 dY
i t2 + DidY
i t + Fi .
From the terminal (position) conditions, xX
i (tf) is free
and xY
i (tf) is free, the PMP implies (transversality condi-
tions: zi
1(tf) = 0, zi
2(tf) = 0, see [3]) that the real constants
Ai and Bi are both equal to zero. This reveals that the
optimal control corresponds to a constant acceleration.
This optimal acceleration depends only on the initial and
ﬁnal velocities (vt2
i
and vtf
i ) and on the time window ex-
tremities (t2 and tf). More precisely, we obtain the following
solution system for each instant t belonging to [t2, tf]:















































ui(t) = vtf
i − vt2
i
tf − t2
,
vi(t) = vtf
i − vt2
i
tf − t2
(t − tf) + vtf
i
,
xX
i (t) = vtf
i − vt2
i
tf − t2
dX
i
t2
2 + (vtf
i − vtf
i − vt2
i
tf − t2
tf)dX
i t
− (vtf
i − vt2
i
tf − t2
(t2 − tf) + vtf
i )dX
i t2 + x
Xt2
i
,
xY
i (t) = vtf
i − vt2
i
tf − t2
dY
i
t2
2 + (vtf
i − vtf
i − vt2
i
tf − t2
tf)dY
i t
− (vtf
i − vt2
i
tf − t2
(t2 − tf) + vtf
i )dY
i t2 + x
Yt2
i
.
Hence, starting from t2, the problem can be analytically
solved. Thus, just a discretization of the time window [t0, t2]
is needed.
V. NUMERICAL RESULTS
In this section, we discuss numerical results obtained
by applying the proposed strategies to solve the conﬂict
avoidance problem. A computer 2.53 GHz / 4 Go RAM
and the MatLab v. 7 environment are used. Data problems
were randomly generated with the following characterics.
The trajectory paths are straight. The horizontally separation
norm is 5 NM. Most of the aircraft have a small operating
time (i.e., time before the ﬁrst potential conﬂict), which
is less than 15′. Velocities are bounded, based on the
ERASMUS project, by a small speed range, namelly: [vt0
i −
6%vt0
i , vt0
i + 3%vt0
i ] (where vt0
i
is the initial velocity of
aircraft i). Acceleration are bounded, based on Eurocontrol’s
base of aircraft data [6], namelly ui = −ui = 4000 NM / h2.
Terminal conditions are returning to the initial velocities
(vt0
i ) at ﬁnal time (tf = 30′). The number of aircraft,
the collision proximity (i.e., the minimal distance between
aircraft which could occur if no maneuvers are done), and
the initial aircraft velocities are reported in Table I.
In Table II, we compare the results obtained by applying
a direct method, with detection step and resolution step
equal to 15′′ and 1′ respectively, on the whole time window
(without considering the postzone) and the results obtained
by decomposing the problem and applying the direct and
the indirect methods as described in the previous sections.
44
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-237-0
ADVCOMP 2012 : The Sixth International Conference on Advanced Engineering Computing and Applications in Sciences

Table I
TEST PROBLEMS CHARACTERISTICS: NUMBER OF AIRCRAFT, COLLISION
PROXIMITY, AND INITIAL VELOCITY FOR PROBLEMS WITH 4 AND 6 AIRCRAFT.
instances
number of aircraft
collision proximity
initial velocity
pb n4a
4
0 NM
400 NM / h
pb n4b
4
2 NM
400 NM / h
pb n6b
6
2 NM
400 NM / h
pb n6c
6
3 NM
400 NM / h
Table II
COMPARISON OF NUMERICAL RESULTS OBTAINED WITHOUT AND WITH
APPLICATION OF THE PMP ON THE POSTZONE : VALUE OF OBJECTIVE FUNCTION,
NUMBER OF ITERATIONS, CPU TIME, FOR 4 AIRCRAFT PROBLEMS.
Application of the PMP on the POSTZONE
without
with
instances
objective
it.
time
objective
it.
time
pb n4a
1.8 × 104
258
22′
1.9 × 104
148
1′54′′
pb n4b
8.0 × 103
228
16′30′′
1.0 × 104
188
3′20′′
From Table II, we can see that with the application of
the PMP on the postzone, the CPU times are signiﬁcantly
reduced with respect to the classical resolution based on
the direct method applied on the whole time window, up
to 90% (see pb n4a). The application of the PMP on the
postzone allows us to tackle larger aircraft conﬂict avoidance
problems because it reduces the time window where the
direct method is applied, hence it reduces the number of
variables and constraints of the NLP. We can then solve 6
aircraft conﬂict avoidance problems, as show in Table III,
we compare results obtained by using different resolution
time discretization steps. Like in Table II, the detection step
is 15′′ and we applied the PMP on the postzone.
Table III
COMPARISON OF NUMERICAL RESULTS WITH DIFFERENT CONTROL TIME
DISCRETIZATION STEPS: VALUE OF OBJECTIVE FUNCTION, NUMBER OF
ITERATIONS, CPU TIME, FOR 6 AIRCRAFT PROBLEMS.
Control time DISCRETIZATION step
1′
5′
instances
objective
it.
time
objective
it.
time
pb n6b
1.6 × 104
342
21′
1.7 × 104
43
0′35′′
pb n6c
1.0 × 104
317
20′
1.0 × 104
51
0′44′′
From Table III, we emphasize the importance of the
resolution time discretization step. We can see that with the
resolution step equals to 5′, the CPU times are signiﬁcantly
reduced with respect to the conﬁguration with the resolution
step equals to 1′, up to 97% (see pb n6b). The two above
comparisons (Tables II and III) show, on the one hand, the
advantage of the application of the PMP on the postzone, and
on the other hand, the beneﬁt to hybridize the two methods
to solve larger aircraft conﬂict avoidance problems.
VI. CONCLUSION
We considered an optimal control model for aircraft
conﬂict resolution based on speed changes. We proposed a
strategy based on hybridization of the direct method applied
to the conﬂict zone and the indirect method applied to
postzone where conﬂicts have been solved. First numerical
results validate our approach. They show that the proposed
decomposition strategy is beneﬁcial in the context of the
considered control problem, signiﬁcantly reducing the com-
putational time for solving the aircraft conﬂict avoidance
problem.
REFERENCES
[1] A. Bicchi, A. Marigo, G. Pappas, M. Pardini, G. Parlan-
geli, C. Tomlin, and S.S. Sastry, Decentralized air trafﬁc
management systems: performance and fault tolerance, IFAC
International Workshop on Motion Control, Grenoble, FRA,
pp. 279 − 284, 1998.
[2] D. Bonini, C. Dupr´e, and G. Granger, How ERASMUS can
support an increase in capacity in 2020. In Proceedings of the
7th International Conference on Computing, Communication
and Control Technologies: CCCT 2009, Orlando, Florida,
2009.
[3] A.E. Bryson and Y.-C. Ho, Applied optimal control – optimiza-
tion, estimation and control, Taylor & Francis Group, 1975.
[4] S. Caﬁeri, P. Brisset, and N. Durand, A mixed integer opti-
mization model for air trafﬁc deconﬂiction, In Toulouse Global
Optimization workshop, Toulouse, FRA, pp. 27 − 30, 2010.
[5] N. Durand, J-.M. Alliot, and J. Noailles, Automatic aircraft
conﬂict resolution using genetic algorithms, In proceedings of
the Symposium on Applied Computing, Philadelphia, ACM,
1996.
[6] Eurocontrol Experimental Center. User manual for the base of
aircraft data, Technical report, Eurocontrol, 2004.
[7] H. Huang and C. Tomlin, A network-based approach to en-
route sector aircraft trajectory planning, American Institute of
Aeronautics and Astronautics, 2009.
[8] J.K. Kuchar and L.C. Yang, A review of conﬂict detection and
resolution modeling methods, IEEE Transactions on Intelligent
Transportations Systems, vol. 1, no. 4, pp. 179 − 189, 2000.
[9] D. Rey, C. Rapine, R. Fondacci, and N.-E. El Faouzi, Technical
report on the minimization of potential air conﬂict using speed
control, Technical report, Laboratoire d’Ing´enierie Circulation
Transport, IFSTTAR, 2011.
[10] C. Tomlin, G.J. Pappas, and S.S. Sastry, Conﬂict resolution
for air trafﬁc management : a case study in multi-agent hybrid
systems, IEEE Transactions on Automatic Control, vol. 43, no.
4, pp. 509 − 521, 1998.
[11] A. Vela, S. Solak, W. Singhose, and J.-P. Clarke, A mixed
integer program for ﬂight level assignement and speed control
for conﬂict resolution, In Joint 48th IEEE Conference on
Decision and Control and 28th Chinese Control conference,
Shanghai, China, pp. 5219 − 5226, 2009.
45
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-237-0
ADVCOMP 2012 : The Sixth International Conference on Advanced Engineering Computing and Applications in Sciences

