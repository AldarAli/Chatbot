The Adaptive Content and Contrast-aware Technique for Visible Watermarking* 
 
Min-Jen Tsai and Jung Liu 
Institute of Information Management  
National Chiao Tung University,  R.O.C. 
mjtsai@cc.nctu.edu.tw 
rongrong211@gmail.com 
Ching-Hua Chuang  
Department of Information Management, Tahwa 
Institute of Technology, R.O.C. 
chuang@thit.edu.tw 
 
 
Abstract—The efficiency of a digital image watermarking 
technique depends on the preservation of visually significant 
information. This is attained by embedding the watermark 
transparently with the maximum possible strength. This paper 
presents an Adaptive approach for still image in which the 
watermark embedding process employs the wavelet transform 
and incorporates Human Visual System (HVS) characteristics. 
The sensitivity of a human observer to contrast with respect to 
spatial frequency is described by the Contrast Sensitivity 
Function (CSF). The strength of the watermark within the 
decomposition sub-bands is adjusted according to this 
sensitivity. Moreover, the watermark embedding process is 
carried over the sub-band coefficients by the analysis of Noise 
Visibility Function (NVF) in which the distortions are less 
noticeable. Such unique design is novel and the experimental 
evaluation of the proposed method shows excellent results in 
terms of robustness and transparency. 
Keywords- Image Watermarking; HVS; CSF; wavelet.  
I. 
 INTRODUCTION 
Due to the advancement of digital technologies and rapid 
communication network deployment, digital images are now 
widely distributed on the Internet or via other digital devices. 
Digital image allows an unlimited number of copies from an 
“original”, people can acquire or distribute the images 
without any reduction in quality through both authorized and 
unauthorized distribution channels. With the ease of editing 
and reproduction, protection of the intellectual property right 
and authentication of digital multimedia becomes an 
important issue. 
In recent years, digital watermarking has been 
extensively studied and regarded as a potentially effective 
means for protecting copyright ownership of digital media 
content [1], since it makes possible the embedding of secret 
information in the digital content to identify the copyright 
owner. Many researchers have invented various visible 
watermarking schemes to protect copyrights. From the 
literature survey, Chen [2] proposed a visible watermarking 
mechanism to embed a watermark by a statistic approach. 
They divided the image into equal-sized blocks and 
calculated the standard deviation of those pixels in block. 
They later calculated the embedding ratio of watermark into 
the corresponding pixels for watermarking. Chen et al. [3] 
describe an approach for adaptive visible watermarking 
based on the analysis of the threshold value of the image 
using Otsu’s threshold to select the best embedding strength 
of the watermark at a particular position. Huang and Tang [4] 
presented a contrast sensitive visible watermarking scheme 
with the assistance of human visual system (HVS). They 
computed the contrast sensitive function (CSF) mask from 
discrete wavelet transform domain and used a square 
function to determine the mask weights for each sub-band. 
At last, they adjusted the embedding weights based on the 
block classification with the texture sensitivity of HVS. Tsai 
[5] incorporated the collaboration of CSF and noise visible 
function (NVF) for HVS models and proposed a new visible 
watermarking technique where the intensity of the 
watermark in different regions of the image depends on the 
underlying content of the image and humans’ sensitivity to 
spatial frequencies. However, the previous works extended 
the following issues: 
1. 
Since the applications of visible watermarking are 
often limited to content browsing or previewing, content 
viewers are annoyed at degraded visual quality. Therefore, 
the embedded patterns should be unobtrusive. However, the 
robustness of watermarking and quality of the digital content 
are generally conflicted with each other.  
2. 
The embedding factors for watermarking emphasize 
different 
weights 
in 
various 
frequency 
domains. 
Subsequently, certain thresholds should be examined 
carefully during the design of watermarking schemes. 
The goal of this paper is to present an adaptive visible 
watermarking algorithm (ACOCOA) with a novel contrast 
sensitivity function masking for wavelet based watermarking 
method which considers the characteristics in different 
frequency domain. The main contribution of this paper is to 
leverage the knowledge of Contrast Sensitivity Function and 
Noise Visibility Function to embed low energy in the area 
where the sensitivity of CSF is high and vice versa. The 
experimental results demonstrate that the proposed technique 
improves the watermarked image quality, translucence and 
robustness of the watermarking. 
The rest of this paper is organized as follows. In Section 
2, we will give the detailed description of the proposed 
theoretical approach for watermarking technical. In Section 3, 
numerical results and discussion are illustrated to justify the 
proposed approach. Finally, the conclusion is drawn in 
Section 4. 
 
 
38
ICSNC 2011 : The Sixth International Conference on Systems and Networks Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-166-3

II. 
THE ACOCOA WATERMARKING ALGORITHM 
The most important requirements in the visible 
watermarking scheme are the robustness and translucence, 
but unfortunately they are in confliction with each other. If 
we increase the energy of watermark to improve its 
robustness, the problem we get is perceptual translucence 
decreasing with less image fidelity and vice versa. We find 
the critical factor “HVS” in providing the good translucence 
of the watermarked image and a better robustness [4]. HVS 
research offers the mathematical models about how humans 
see the world. Hemanmi [6] applied uniform quantization 
noise to measure the psychovisual sensitivity in wavelet sub-
bands within an image and showed the results that human 
vision has different sensitivity from various spatial 
frequencies (frequency sub-bands). The HVS by using the 
contrast sensitive function (CSF) and noise visibility 
function (NVF) is integrated in this study and will be 
explained in brief as following: 
A. CSF (Contrast Sensitive Function) 
Mannos and Sakrison [7] originally presented a model of 
the CSF for luminance (or grayscale) images is given as 
follows: 
1.1
(0.114
)
( )
2.6 (0.0192
0.114
)
f
H f
f
e






                    (1) 
where 
2
2
x
y
f
f
f


 is 
the 
spatial 
frequency 
in 
cycles/degree of visual angle (fx and fy are the spatial 
frequencies in the horizontal and vertical directions, 
respectively). The HVS is most sensitive to normalized 
spatial frequencies between 0.025 and 0.125 and less 
sensitive to low and high frequencies.  
CSF masking [8], [9] is one way to apply the CSF in the 
discrete wavelet domain. CSF masking refers to the method 
of weighting the wavelet coefficients relative to their 
perceptual importance. In [9], the DWT CSF mask utilizes 
the information in all of the approximation sub-bands as well 
as all of the detail sub-bands to yield 11 unique weights in 
the mask. All of the weights are normalized so that the 
lowest weight is equal to one. The 11 weights of DWT CSF 
mask are shown in Figure 1 after 5-level wavelet pyramidal 
DWT decomposition and the HVS is most sensitive to the 
distortion in mid-frequency regions (level 3) and sensitivity 
falls off as the frequency value drifts on both sides (level 1, 2, 
4 and 5). The square function in [4] is applied to approximate 
the effect of CSF masking. The adequate modulation rate 

  
for each sub-band is determined by: 
2
2
(7.20
)
0.01
7.20
r




 
(2) 
where r  represents the wavelet coefficient CSF of the 
perceptual importance weight for each sub-band where λ 
denotes the decomposition level.  
B. NVF (Noise Visibility Function) 
Alexander et al. [10] presented a stochastic approach 
based on the computation of a NVF (Noise Visibility 
Function) that characterizes the local image properties and 
identifies texture and edge regions. This allows us to 
determine the optimal watermark locations and strength for 
the watermark embedding stage. The adaptive scheme based 
on NVF calculated from stationary GG model is superior to 
other schemes, which is defined as follows: 
1.00 (0.75)
2.33 (0.46)
2.33 (0.46)
4.74 (0.12)
3.75 (0.23)
3.55 
(0.26)
3.48 
(0.27)
HL1
HH1
LH1
HH2
LH2
HL2
HH3
LH3
HL3
3.21 
(0.31)
3.48 
(0.27)
7.20 
(0.01)
4.74 (0.12)
5.30 
(0.08)
5.30 
(0.08)
3.55 
(0.26)
3.48 
(0.27)
3.78
(0.23)
 
Figure 1.  A five-level wavelet pyramidal decomposition. rλ(βλ,θ) values 
for each level λ are indicated at the center of each band. 
 
Figure 2.  The sensitivity curve of CSF, inverse CSF, square function and 
proposed cruve. 
TABLE I.  
ADAPTIVE CSF MASKING FOR A FIVE-LEVEL DWT 
Orien- 
tation 
Level 
1 
2 
3 
4 
5 
LL 
 
0.000001 
HL/ LH 0.599316 0.211279 0.031660 0.032198 0.031905 
HH 
1.000000 0.341371 0.005418 0.031905 0.030574 
 
39
ICSNC 2011 : The Sixth International Conference on Systems and Networks Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-166-3

2
,
,
,
I
x y
x y
x y
w
NVF
w



 
(3) 
where 
2
,
,
[ ( )] /
x y
x y
w
r


  


 and 
2
I
  is the global variance of 
the 
original 
image.
( )
(3/ )/ (1/ )
 





, 
1
0
( )
u
s
s
e u
du




 
 (gamma function) and 
,
,
,
x y
x y
x y
I
I
I
r



,   
is the shape parameter and rx,y is determined by the local 
mean and the local variance. For most of real images, the 
shape parameter is in the range0.3
1
 
 . In our scheme, the 
estimated shape parameter for
  0.65
, and width of window 
is 1. 
C. Adaptive CSF masking 
The property of CSF is a measure of fundamental 
spatiochromatic of the HVS, and people are more sensitive 
in mid-frequency regions. Therefore, we need embed low 
intensity of visible watermarking in high sensitivity regions 
and vice versa. According to such observation, we can draw 
the inverse CSF as shown in Figure 2, which represents the 
embedding intensity allowed based on the study of HVS. 
Therefore, a good visible watermarking should embed low 
energy in mid-frequency regions from the plot of inverse 
CSF to avoid obtrusiveness and affect the visual quality. 
Consequently, the square function applied in [4-5] dose not 
match the perfect inverse CSF curve as shown in Figure 2 so 
they need to set certain thresholds to avoid adding too much 
energy in the low DWT frequency domains. In order to solve 
the problems and obtain the better watermarked image for 
HVS that contains the characteristics of robustness and 
translucence, we use the interpolation method to construct 
the Adaptive CSF masking to improve the HVS model for 
better image quality. From above discussion, we have 
proposed an Adaptive CSF masking, which is defined in 
formula (4) and tabulated the corresponding coefficients of 
the associated sub-bands in Table 1: 
Adaptive CSF masking = (1
( ))
H f
f


 
(4) 
Since LL band is very critical during the reconstruction 
of the image, a small value of parameter is derived in order 
to preserve the quality of watermarked image. According to 
such observation, we also draw the proposed curve as shown 
in Figure 2, which can help us to compare the different 
watermark weighting curve. 
D. ACOCOA Visible Watermarking Algorithm 
ACOCOA algorithm leverages the study of [5] and 
modifies the controlling parameters of watermark embedding 
based on the consideration of the image quality. The 
watermark embedding procedures are briefly described as 
following steps and the flow chart is shown in Figure 3: 
Step 1.  The original color image is converted in the color 
space domain from RGB to YCrCb. 
Step 2. By using Bi9/7 filter from [11], compute the 5-
level 2-D wavelet coefficients of Y component 
from original color image and grayscale logo 
watermark image. 
Step 3. Modify the DWT coefficients of the host image by 
Original Image
Color-space 
Conversion
(RGB to CrCb) 
DWT
Logo
Watermark 
Image
Innovated CSF 
Masking
+
Y
IDWT 
And
YCrCb to RGB
Watermarked Image
Watermark 
Embedding 
DWT
α, β
I
Perceptual 
Stochastic 
Model
I
NVF
w
Iw
CSF
NVF
 
 
Figure 3.  The flow chart of ACOCOA visible watermarking. 
TABLE II.  PSNR (DB) SUMMARY OF WATERMARKED COLOR IMAGES 
Method 
Image 
Method of [4] 
Method of [5] 
I-COCOA  
Lena 
26.78 
32.67 
36.21 
Lake 
26.03 
31.66 
33.95 
Peppers 
26.83 
32.48 
35.29 
F16 
27.96 
32.43 
34.87 
Tiffany 
27.57 
32.92 
34.64 
Splash 
25.68 
32.37 
36.78 
 
 
 
 
 
(a) 
(b) 
(c) 
(d) 
 
 
 
 
(e) 
(f) 
(g) 
(h) 
Figure 4.  The visual quality comparison of original and watermarked 
images. (a), (e) are original Lena, Lake images respectively. (b), 
(f) are watermarked images by the method of [4]. (c), (g) are 
watermarked images by the method of [5]. (d), (h) are 
watermarked images by the ACOCOA method. 
40
ICSNC 2011 : The Sixth International Conference on Systems and Networks Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-166-3

using the following equation: 
,
,
,
,
,
,
(
)
w
x y
x y
x y
x y
I
I
NVF
w
 
 







 
(5) 
Note: (x,y) indicates the spatial location. I and w are 
the decomposed wavelet coefficients of the original 
image and the logo watermark image. 
,
 
 and 
,
 
 
are scaling and embedding factors which are defined 
as below. 
,x y
NVF  is defined in formula (3). 
,
,
(1
) (1
( ))
NVFx y
H f
f
 





  
(6) 
,
,
1 0.7
 
 


 
 
(7) 
Step 4. Inverse transform the DWT coefficients of the 
original image to obtain the watermarked image. 
III. 
EXPERIMENTAL RESULTS 
The proposed visible watermarking algorithm has been 
implemented and intensively tested by using the widely 
available color images from USC image database [12] and 
the performance of 512512 experimental images are 
tabulated in Table 2 for comparison purpose. The grayscale 
watermark of logo image adopted in the experiments is a 
department logo and shown in Figure 3. 
In order to make a fair comparison with the method from 
[4], [5], it is better to embed the same watermark for the 
same cover image. However the watermark used in [4] is not 
available currently, we embed the logo watermark from 
Figure 3 to make the best effort for performance comparison. 
The performance analysis can be categorized as follows: 
A. PSNR (peak signal-to-noise ratios) 
The tabulated results from Table 2 disclose that our 
watermarking scheme can achieve higher PSNR values than 
the method in [4] and [5] where the PSNRs are generally 
below 33dB for different images. The low PSNRs have 
positive correlation with the degradation in image quality. 
This denotes the fidelity of images from our method is better 
than the traditions CSF based method. 
B. Visual Quality 
Figure 4 (a) and 4(e) illustrate the original cover images 
of Lena and Lake from [12], the results of watermarked 
images from [4] and [5] are compared with the proposed 
approach and the results are in Figure 4 (b)(c)(d) and 
(f)(g)(h).  
From Figure 4 (b)(c)(d) and (f)(g)(h) image pairs, the 
proposed method has the closest luminance maintenance 
compared with the original ones which are shown clearly and 
unobtrusive from the photos. The watermarked images by 
using [4] and [5] have more bright effect in the unmarked 
areas. To further compare the details from the watermarked 
images, Figure 5 (a)(e) are the close-ups of original images. 
Figure 5 (b)(f) are the close-ups of Figure 4 (b)(f) by using 
[4]’s method. Figure 5 (c)(g) are the close-ups of Figure 4 
(c)(g) by using [5]’s method. Figure 5 (d)(h) are the close-
ups of Figure 4 (d)(h) by using our proposed method. It is 
very clear that the watermark’s edges and thin lines are 
blurred and obtrusive in those images by using the method of 
[4] and [5] but the watermark patterns in our method still has 
sharp edge and the logo watermark is evidently embedded. 
C. JPEG 2000 Compression 
The robustness of the proposed visible watermark 
technique should be tested for compression attack. For JPEG 
 
 
 
 
(a) 
(b) 
(c) 
(d) 
 
 
 
 
(e) 
(f) 
(g) 
(h) 
Figure 5.  The visual quality comparison of close-ups for images in 
Figure 4 (a),(e) are original Lena, Lake images. (b),(f) are 
watermarked images by the method of [4]. (c),(g) are 
watermarked images by the method of [5]. (d),(h) are 
watermarked images by the ACOCOA method. 
 
 
 
 
(a) 
(b) 
(c) 
(d) 
Figure 6.  The visual quality comparison of close-ups for Tiffany image 
after JPEG 2000 compression. (a) original image, (b) 
watermarked image by the method of [4], (c) watermarked 
image by the method of [5], (d) watermarked images by the 
ACOCOA method. 
TABLE III.  PSNR (DB) SUMMARY OF WATERMARKED COLOR IMAGES 
BEFORE AND AFTER JPEG 2000 COMPRESSION. 
Method 
Image    
Method of [4] 
Method of [5] 
I-COCOA Approach 
(1) 
(2) 
(3) 
(1) 
(2) 
(3) 
(1) 
(2) 
(3) 
Lena 
26.78 24.40 28.41 32.67 27.06 28.52 36.21 27.92 28.69 
Lake 
26.03 23.02 26.30 31.66 25.06 26.61 33.95 25.72 27.04 
Peppers 26.83 24.44 28.42 32.48 27.03 28.50 35.29 27.83 28.75 
F16 
27.96 24.94 28.00 32.43 26.71 28.13 34.87 27.37 28.38 
Tiffany 27.57 25.09 28.60 32.92 27.36 28.71 34.64 27.86 28.93 
Splash 25.68 24.01 29.30 32.37 27.53 29.31 36.78 28.70 29.34 
Note:  
(1) means the PSNR values before the JPEG 2000 compression. 
(2) means the PSNR values after the JPEG 2000 compression. 
(3) means the PSNR values are compared between the  
compressed watermarked image and the watermarked image. 
41
ICSNC 2011 : The Sixth International Conference on Systems and Networks Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-166-3

2000 compression, software from [13] is adopted as the 
compression tool. Figure 6 (d) is the close-up of 
watermarked image after JPEG 2000 compression by the 
proposed method. It is apparent that the logo pattern is still 
evidently existed and recognized. The PSNR values before 
and after the JPEG 2000 compression are tabulated in Table 
3. The compression ratio is 100:3 between the uncompressed 
image and compressed image. 
Other attacks from [14] are also preformed and the 
experimental results are consistent with the above findings 
which indicate our visible watermarking scheme has better 
visual effect and high PSNR values than other schemes like 
[4] and [5]. In summary, an intensive comparison for 
proposed ACOCOA technique has been illustrated above. 
Therefore, we can conclude that the proposed method is 
more robust with better image quality than the algorithm in 
[4] and [5]. 
IV. 
CONCLUSION AND FUTURE WORKS 
In this study, we have proposed a novel watermarking 
technique I-COCOA where the intensity of the watermark in 
different regions of the image depends on the underlying 
content of the image and HVS to spatial frequencies for 
copyright protection. The Adaptive CSF masking is fine 
tuned for watermark embedding which results significant 
improvement in terms of the image quality, translucence and 
robustness of the watermarking. The experimental results 
demonstrate the proposed ACOCOA visible watermarking 
scheme has achieved high PSNR values with better visual 
fidelity and robustness to attacks than other schemes. 
ACKNOWLEDGMENT 
This work was partially supported by the National 
Science Council in Taiwan, Republic of China, under Grant 
NSC99-2410-H-009-053-MY2. 
REFERENCES 
[1] I.J. Cox, J. Kilian, F.T. Leighton, and T. Shamoon, “Secure spread 
spectrum watermarking for multimedia,” IEEE Transactions On 
Image Processing, vol. 6, no. 12, pp. 1673–1687, Dec. 1997. 
[2] P.M. Chen, “A visible watermarking mechanism using a statistic 
approach,” 5th International Conference on Signal Processing 
Proceedings, vol. 2, pp. 910–913, 2000. 
[3] J.J. Chen, T.M. Ng, A. Lakshminarayanan and H.K.Garg, “Adaptive 
visible watermarking using Otsu’s Thresholding,” International 
Conference on Computational Intelligence and Software Engineering, 
pp. 1–4, Dec. 2009. 
[4] B.B. Huang and S.X. Tang, “A contrast-sensitive visible 
watermarking scheme,” IEEE Multimedia, vol. 13, no.2, pp. 60–66, 
Apr.-Jun. 2006. 
[5] M.J. Tsai, “A Visible Watermarking Algorithm Based on the Content 
and Contrast Aware (COCOA) Technique,” Journal of Visual 
Communication and Image Representation, vol. 20, issue 5, pp. 323–
338, July 2009. 
[6] S.S. Hemami, “Visual Sensitivity Considerations for Subband 
Coding,” Proceedings of Thirty-first Asilomar Conference on Signals, 
Systems, and Computers, Pacific Grove, CA, vol. 1, pp. 652-656, 
Nov. 1997. 
[7] J.L. Mannos and D.J. Sakrison, “The effects of a visual fidelity 
criterion on the encoding of image,” IEEE Transactions on 
Information Theory, vol. 20, no. 4, pp. 525–536, July 1974. 
[8] D. Levický and P. Foriˇs, “Human Visual System Models in Digital 
Image Watermarking,” RADIOENGINEERING, vol.13, no. 4, pp. 38–
43, Dec. 2004. 
[9] A.P. Beegan, L.R. Iyer, and A.E. Bell, “Design and Evaluation of 
Perceptual Masks for Wavelet Image Compression,” IEEE Digital 
Signal Processing Workshop, IEEE CS Press, pp. 88–93, Oct. 2002. 
[10] S. V. Alexander, Z. A. Herrigel and N. Baumgaertner, “A stochastic 
approach to content adaptive digital image watermarking,” in Proc. 
3rd Int. Workshop Information Hiding, Dresden, Germany, pp. 211–
236, Sep. 1999. 
[11] A.B. Watson, G.Y. Yang, J.A. Solomon and J. Villasenor, “Visibility 
of wavelet quantization noise,” IEEE Transactions On Image 
Processing, vol. 6, no. 8, pp. 1164–1175, Aug. 1997. 
[12] USC SIPI – The USC-SIPI Image Database., Retrieved Aug. 18, 2011, 
from http://sipi.usc.edu/database/ 
[13] JPEG 2000 compression, Retrieved Aug. 18, 2011, from 
http://www.ece.uvic.ca/ ~mdadams/jasper/ 
[14] StirMark, 
Retrieved 
Aug. 
18, 
2011, 
from 
http://www.petitcolas.net/fabien/ 
software/StirMarkBenchmark_4_0_129.zip  
 
 
42
ICSNC 2011 : The Sixth International Conference on Systems and Networks Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-166-3

