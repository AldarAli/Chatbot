SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
7
The Design of Sparse and Non-Sparse FIR Filters using Linear Complementarity Problem
Approach
Muhammad Muzammal Naseer, Kamal Harb, Ahmad Nuseirat
Electrical Engineering Department
KFUPM/UOHB University, Saudi Arabia
Email: 1- muz.pak@gmail.com; 2- kamal harb@hotmail.com; 3- anuseirat@anu.edu.jo
Abstractâ€”In this article, the problem of linear phase ï¬nite
impulse response (FIR
Â¯ ) ï¬lter design is reconsidered as a
linear complementarity problem (LCP
Â¯
) with a weighting
strategy. The LCP is not an optimization technique because
there is no objective function to optimize; however, quadratic
programming, one of the applications of LCP, can be used
to ï¬nd an optimal solution for the 1D FIR ï¬lter. Quadratic
programs are an extremely important source of applications
of LCP; in fact, several algorithms for quadratic programs
are based on LCP. It has been shown that, by selecting
proper weights, the LCP approach is capable of producing
equiripple response. Since length of the impulse response of
discrete time ï¬lters is often an indicator of computational
cost, an algorithm is proposed that iteratively thins the
impulse response of a non-sparse ï¬lter. The resulting LCP
has been solved by a computationally effective Lemkeâ€™s
algorithm. Different examples are presented to illustrate the
efï¬ciency of the proposed methods.
Keywordsâˆ’Finite Impulse Response (FIR); Lemkeâ€™s al-
gorithm; Linear Comlimentarity Problem (LCP); Quadratic
Program(QP).
I. INTRODUCTION
The linear phase ï¬nite impulse response (FIR) ï¬lters
are essential in many applications and there are many well
documented techniques in literature for designing such
ï¬lters [1]â€“[10]. In [3], Vaidyanathan et. al designed the
linear phase FIR ï¬lters by minimizing a quadratic measure
of the error in the passband and stopband. In [4], Medlin
et. al introduced the Lagrange multiplier method to design
FIR ï¬lters for multirate applications. In [5], M. H. Er
and C. K. Siew presented the FIR ï¬lter design problem
as a quadratic program (QP) with quadratic constraints.
Rabiner [2] used the theory of linear programming to
design discrete time FIR ï¬lters with equiripple response.
Nuseirat [1] studied the design problem using the LCP
approach.
The classical LCP has been explicitly stated by Du val
in 1940 [11]. The LCP is not an optimization technique
as there is no objective function to optimize, however, QP,
one of the applications of LCP, can be used to ï¬nd an
optimal solution for the linear phase FIR ï¬lter. QPs are
extremely important source of application for the LCP.
There are several highly effective algorithms for solving
QPs that are based on the LCP [9] [11].
In ï¬lter design problems, it is required to optimize
a desired frequency response by minimizing an error
norm, which can be measured in L2 or Lâˆ norm. L2 is
known for its poor performance especially at band edges
(Gibbâ€²sPhenomenon). In [1], the author tried to improve
the performance by simply removing the transition region
from the error measure but the presented examples show
that a compromise has to be made at one of the band
edges.
We revisit the problem with a weighting strategy and
show that QP converted into LCP is capable of producing
equiripple response ï¬lters comparable with Park and Mc-
Clellan [6] who used polynomial interpolation technique
to solve for the desired ï¬lters. The resulted LCP-QP is
solved by the most robust Lemkeâ€™s algorithm. Based on
pivoting, Lemke is a direct algorithm. It is computationally
very effective as no matrix inversion is needed [1].
In many applications, the number of arithmetic opera-
tions indicate the cost of implementation, thus reducing
the length of impulse response that is designing sparse
ï¬lters is beneï¬cial not only in terms of computational
cost but also in hardware and energy consumption [13]
[14]. Sparse ï¬lters offer opportunity to omit the arithmetic
operations associated with zero-valued coefï¬cients. In this
article, a simple iterative algorithm is proposed to reduce
the number of coefï¬cients of a non-sparse ï¬lter.
This paper is organized as follows: Section II presents
the problem formulation, and shows the effect of LCP-
QP with weights on the design problem. Section III de-
scribes an iterative algorithm to thin the impulse response.
Section IV presents the discussion and simulation results.
Finally, we conclude in Section V.
II. PROBLEM FORMULATION
For simplicity of presentation, consider the frequency
response of type I FIR ï¬lter given by [1] [13] [14]:
H(w) =
Nâˆ’1
X
n=0
h(n)cos(Ï‰n),
(1)
where { hn} , n = 0, ..., N âˆ’ 1 is the impulse response.
Discretizing Ï‰ as Ï‰k|1 â‰¤ k â‰¤ L, the frequency response
in (1) can be written in the following matrix form:
H = Ch,
(2)

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
8
(a) a
(b) b
Figure 1. Performance comparison of LCP with and without weights compared with the optimal least square method. It is clear that with appropriate weights LCP
approach is capable of producing FIR ï¬lters with equiripple response.
where
C =
ï£®
ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£¯ï£°
1
cos(w1)
.
.
.
cos(Nw1)
.
.
.
.
.
.
.
.
.
.
.
.
1
cos(wm)
.
.
.
cos(Nwm)
.
.
.
.
.
.
.
.
.
.
.
.
1
cos(wL)
.
.
.
cos(NwL)
ï£¹
ï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£ºï£»
and
h =

h[0]
h[1]
.
.
.
h[N âˆ’ 1]
h[N]
T
Since LCP is solved for a positive vector, the impulse
response has to be written as a difference of two non-
negative vectors [1]:
h = h+ âˆ’ hâˆ’.
(3)
Using (2) and (3), the frequency response of a discrete
time ï¬lter becomes [1]:
H = Bd,
(4)
where B =
 C
âˆ’C 
and d =

h+
hâˆ’

. For a desired
frequency response D, error vector will be [1]:
E = Bd âˆ’ D.
(5)
The problem of ï¬nding h can be formulated by minimiz-
ing the squared error [1]:
Minimize
Îµ(d) = EÏ„E
Subject to
|W Ã— E| â‰¤ Î´,
(6)
where W is a strictly positive weighting vector and Î´, is
the tolerance scheme. The objective function in (6) can be
written as:
Îµ(d) = EÏ„E,
= (Bd âˆ’ D)Ï„ (Bd âˆ’ D) ,
= (dÏ„BÏ„ âˆ’ DÏ„) (Bd âˆ’ D) ,
= dÏ„BÏ„Bd âˆ’ dÏ„BÏ„D âˆ’ DÏ„Bd + DÏ„D,
= dÏ„BÏ„Bd âˆ’ 2dÏ„BÏ„D + DÏ„D.
Îµ(d) = 1
2dÏ„Qd âˆ’ dÏ„R + DÏ„D,
(7)
where d
âˆˆ
R2N+2 , Q = 2BÏ„B is symmetric and
semi-positive deï¬nite matrix and R = 2BÏ„D. The linear
constraints in problem (6) can be written in a compact
form as follows:
|W Ã— E| â‰¤ Î´
|Bd âˆ’ D| â‰¤ Î´
W

B
âˆ’B

|
{z
}
A
d â‰¤

D +
Î´
W
âˆ’D +
Î´
W

|
{z
}
b
.
(8)
In compact form, the above minimization problem be-
comes [1]:
Minimize
f(d) = 1
2dÏ„Qd âˆ’ dÏ„R + DÏ„D
Subject to
Ad â‰¤ b
d â‰¥ 0.
(9)
The Kuhn-Tucker necessary conditions for the above QP
in (9) are that there must exist vectors u âˆˆ R2N+2,
v âˆˆ
R2L,
Î» âˆˆ R2L such that [1] [9] [11]:
âˆ’ R + Qd + AÏ„Î» âˆ’ u = 0,
Ad + v = b,
u â‰¥ 0, v â‰¥ 0, d â‰¥ 0, Î» â‰¥ 0, uÏ„d = 0, vÏ„Î» = 0.
(10)

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
9
(a) a
(b) b
Figure 2. Performance comparison of LCP with and without weights compared with the optimal least square method. Again with appropriate weights, the LCP approach
produces equiripple response.
Clearly, this can be written as:

u
v

â‰¡

âˆ’R
b

+

Q
AÏ„
âˆ’A
0
 
d
Î»

,
u â‰¥ 0, v â‰¥ 0, d â‰¥ 0, Î» â‰¥ 0, uÏ„d = 0, vÏ„Î» = 0.
(11)
Thus, the minimization problem in (6) represents a LCP.
In a compact form, the LCP for the problem in (6) can be
written as [1]:
z âˆ’ Mw = q,
z â‰¥ 0,
w â‰¥ 0,
zÏ„w = 0,
(12)
where M =

Q
AÏ„
âˆ’A
0

,z =
 u
v

,w =
 d
Î»

and
q =
 âˆ’R
b

. If Q is semi positive deï¬nite then M is
also a semi positive semi-deï¬nite matrix [1] [11].
LCP Solver:
There are two main families of algorithms are available
to solve for the LCP(q,M) (12): a) direct algorithms and
b) indirect algorithms . In this research, the most robust
and direct Lemkeâ€™s algorithm [1] [9] [11] is used to solve
LCP (12).
A. Design Examples
In this section, a set of design examples are provided.
The objective here is to show various FIR ï¬lter designs
via LCP with and without weights compared with optimal
least square method. Figure 1 shows the design of 79th-
order linear phase lowpass FIR ï¬lter. The tolerance scheme
for the passband [0, 0.4Ï€] and stopband [0.45Ï€, Ï€] is 0.02
[1].
Another example of the 87th-order linear phase band-
pass FIR ï¬lter design is shown in Figure 2. Tolerance
schemes for the passband [0.35Ï€, 0.65Ï€] and stopband
[0, 0.3Ï€] , [0.7Ï€, Ï€] are 0.04 and 0.06 respectively [1].
Optimal Non-
Sparse 
Design via LCP
Find the smallest 
coefficient ğ’‰ğ’ğ’Šğ’
Put additional 
constraint 
ğ’‰ğ’ğ’Šğ’ = ğŸ
into QP (7)
Convert QP (7) 
into LCP (8)
Apply Lemke 
algorithm 
to solve LCP (8)
Sparse Filter 
Design
Terminate
Yes
NO
If 
Error < Threshold
Figure 3. LCP based successive thinning algorithm to design sparse FIR digital
ï¬lter.
Design examples show that with the appropriate weighting
strategy LCP method [1] can lead to FIR ï¬lters with
equiripple response.
III. SPARSE FILTER DESIGN USING LCP
Since in many applications, the number of arithmetic
operations indicate the cost of implementation, thus reduc-
ing the length of impulse response that is designing sparse
ï¬lters is beneï¬cial not only in term of computational
cost but also in hardware and energy consumption [13]
[14]. To test the performance of LCP in context of spares
ï¬lter designing, we proposed a simple algorithm shown
in Figure 3 that iteratively thins the impulse response of

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
10
TABLE I. PERFORMANCE OF LCP IN THE CONTEXT OF SPARSE AND NON-SPARSE FILTER DESIGN
No. of
Non-zero
zero
Max.pass-
band
Min.stop-
band
coefï¬cients
weights
weights
error
attenuation
[dB]
[dB]
79
79
0
0.0852
-40.2
79
61
18
0.1148
-37.57
61
61
0
0.1956
-32.89
(a) a
(b) b
Figure 4. Performance comparison of sparse and non-sparse ï¬lters with 61 non-zero co-coefï¬cients. This can be observed that sparse FIR ï¬lter designed by LCP offer
advantage, when compared to its equivalent non-sparse ï¬lter designed by LCP and optimal least square method.
a non-sparse ï¬lter. For successive thinning of the impulse
response, usually we start with higher no. of coefï¬cients
than required [13] [14].
Application of Successive thinning algorithm:
The successive thinning algorithm shown in Figure 3 is
applied on the 79th order non-sparse ï¬lter shown in Figure
4 with passband [0, 0.4Ï€] and stop-band [0.45Ï€, Ï€]. Figure
4 and Table I compare the sparse and non-sparse FIR ï¬lters
designed by LCP approach.
IV. DISCUSSION RESULTS
In [1], the author used quadratic measure to design dig-
ital ï¬lters via LCP without weights and tried to minimize
the effect of Gibbâ€™s phenomenon by ignoring the transition
band and simply removing it from the error measure. Thus,
the presented examples show that a compromise has to be
made at one of the band edges. However, the FIR examples
presented in sections II and III showed the efï¬ciency of
the proposed weighting strategy.
Moreover, it has been observed that, the LCP-solvers
like Lemkeâ€™s algorithm are very sensitive to the frequency
grid. Different passband to stopband frequency grid (p/s-
fg) ratio can lead to different solutions. The denser the
frequency grid in passband compared to the stop-band, the
smaller the error in passband but at a cost of increased
error in stopband and vice versa. To show the effect of
frequency grid ratio, a 95th order FIR ï¬lter with passband
[0, 0.11Ï€] and stopband [0.15Ï€, Ï€] designed by LCP is
shown in Figure 5.
V. CONCLUSION AND FUTURE WORK
In this paper, the problem of linear phase FIR ï¬lter
design is reconsidered as a LCP with a weighting strategy.
The LCP is not an optimization technique because there is
no objective function to optimize; thus, the design problem
of the linear phase 1D FIR ï¬lter is formulated via quadratic
programming, and then the equivalent semideï¬nite LCP
form is obtained by applying the Karush Kuhn Tucker
conditions. One advantage of LCP is its well-developed
theory because there are a number of algorithms available
to solve a particular LCP. In the case of an FIR ï¬lter, the
resulted semideï¬nite LCP is solved by the most robust
Lemkes algorithm. It is shown with simulations that with
a proper weighting strategy LCP can lead to equiripple
solution for 1D FIR ï¬lters. In addition, a simple but
effective algorithm is presented to design sparse FIR
ï¬lters. Sparse ï¬lters designed by the proposed successive
thinning algorithm outperform the non-sparse ï¬lters with
equal number of non-zero coefï¬cients.
Future work is in progress to extend the LCP technique
in order to design two dimensional FIR ï¬lter.
REFERENCES
[1] A. M. Al-Fahed Nuseirat, â€Design of linear phase FIR ï¬lters
via linear complementarity problem (LCP) approach,â€ Interna-

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
11
(a) a
(b) b
Figure 5. Performance of LCP designed FIR ï¬lters without weights. Effect of passband to stopband frequency grid (p/s-fg) ratio can be observed on Magnitude spectrum.
tional Journal of Circuit Theory and Applications Sept. 2005,
vol. 33, no. 5, pp. 353-364.
[2] L. R. Rabiner, â€The design of ï¬nite impulse response digital
ï¬lters using linear programming techniques,â€ Bell System Tech-
nical Journal Aug. 1972, vol. 51, no.6, pp. 1117-1198.
[3] P. P. Vaidyanathan and T. Q. Nguyen, â€Eigenï¬lters: a new
approach to least-square FIR ï¬lter design and applications
including Nyquist ï¬lters,â€ IEEE Transactions on Circuits and
Systems, Jan. 1987, vol. 34, no. 1, pp. 11-23.
[4] G. W. Medlin, J. W. Adams, and C.T. Leondes, â€Lagrange
multiplier approach to the design of FIR ï¬lters for multirate
applications,â€ IEEE Transactions on Circuits and Systems, Aug.
2002, vol. 35, no.10, pp. 1210-1219.
[5] M. H. Er and C. K. Siew, â€Design of FIR ï¬lters using quadratic
programming approach,â€ IEEE Transactions on Circuits and
Systems II Aug. 2002, vol. 42, no. 3, pp. 217-220.
[6] T. W. Parks and J. H. McClellan,â€Chebyshev approxima-
tion for nonrecursive digital ï¬lters with linear phase,â€ IEEE
Trans.Circuit Theory, Mar. 1972, vol. 19, pp. 189-194.
[7] V. R. Algazi, M. Suk, and R. Chong-Suck, â€Design of almost
minimax FIR ï¬lters in one and two dimensions by WLS tech-
nique,â€ IEEE Transactions on Circuits and Systems Jan. 2003,
vol. 33, no. 6, pp. 590-596.
[8] M. Lang, I. W. Selesnick, and C. S. Burrus, â€Constrained least
squares design of 2-D FIR ï¬lters,â€ IEEE Transactions on Signal
Processing, May 1996, vol. 44, no. 5, pp. 1234-1241.
[9] K. G. Murty, Linear Complementarity: Linear and Nonlinear
Programming, 1997.
[10] A. Chandra and S. Chattopadhyay,
â€Design optimization of
powers-of-two FIR ï¬lter using self-organizing random immi-
grants GA,â€ International Journal of Electronics, 2015, vol. 102,
no. 1, pp. 127-140.
[11] O. L. Mangasarian and J. S. Pang, â€The Linear Complementarity
Problem,â€ SIAM Journal on Matrix Analysis and Applications,
1995, Vol. 16, no. 2, pp. 359-368.
[12] A. Fischer, â€A Newton-Type Method for Positive-Semideï¬nite
Linear Complementarity Problems,â€ Journal of optimization the-
ory and applications, September 1995, vol. 86, no. 3, pp. 585-
608.
[13] T. Baran, D. Wei, and A. V. Oppenheim, â€Linear Programming
Algorithms for Sparse Filter Design,â€ IEEE Transaction on signal
processing, March 2010, no. 3, vol. 58, pp. 1605-1617.
[14] D. Wei, C. K. Sestok, and A. V. Oppenheim, â€Sparse Filter
Design Under a Quadratic Constraint:Low-Complexity Algo-
rithms,â€ IEEE Transaction on signal processing, Feb. 2013, no.
4, vol. 61, pp. 857-870.

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
12

