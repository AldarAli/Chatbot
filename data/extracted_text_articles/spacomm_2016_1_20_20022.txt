SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
7
The Design of Sparse and Non-Sparse FIR Filters using Linear Complementarity Problem
Approach
Muhammad Muzammal Naseer, Kamal Harb, Ahmad Nuseirat
Electrical Engineering Department
KFUPM/UOHB University, Saudi Arabia
Email: 1- muz.pak@gmail.com; 2- kamal harb@hotmail.com; 3- anuseirat@anu.edu.jo
Abstract—In this article, the problem of linear phase ﬁnite
impulse response (FIR
¯ ) ﬁlter design is reconsidered as a
linear complementarity problem (LCP
¯
) with a weighting
strategy. The LCP is not an optimization technique because
there is no objective function to optimize; however, quadratic
programming, one of the applications of LCP, can be used
to ﬁnd an optimal solution for the 1D FIR ﬁlter. Quadratic
programs are an extremely important source of applications
of LCP; in fact, several algorithms for quadratic programs
are based on LCP. It has been shown that, by selecting
proper weights, the LCP approach is capable of producing
equiripple response. Since length of the impulse response of
discrete time ﬁlters is often an indicator of computational
cost, an algorithm is proposed that iteratively thins the
impulse response of a non-sparse ﬁlter. The resulting LCP
has been solved by a computationally effective Lemke’s
algorithm. Different examples are presented to illustrate the
efﬁciency of the proposed methods.
Keywords−Finite Impulse Response (FIR); Lemke’s al-
gorithm; Linear Comlimentarity Problem (LCP); Quadratic
Program(QP).
I. INTRODUCTION
The linear phase ﬁnite impulse response (FIR) ﬁlters
are essential in many applications and there are many well
documented techniques in literature for designing such
ﬁlters [1]–[10]. In [3], Vaidyanathan et. al designed the
linear phase FIR ﬁlters by minimizing a quadratic measure
of the error in the passband and stopband. In [4], Medlin
et. al introduced the Lagrange multiplier method to design
FIR ﬁlters for multirate applications. In [5], M. H. Er
and C. K. Siew presented the FIR ﬁlter design problem
as a quadratic program (QP) with quadratic constraints.
Rabiner [2] used the theory of linear programming to
design discrete time FIR ﬁlters with equiripple response.
Nuseirat [1] studied the design problem using the LCP
approach.
The classical LCP has been explicitly stated by Du val
in 1940 [11]. The LCP is not an optimization technique
as there is no objective function to optimize, however, QP,
one of the applications of LCP, can be used to ﬁnd an
optimal solution for the linear phase FIR ﬁlter. QPs are
extremely important source of application for the LCP.
There are several highly effective algorithms for solving
QPs that are based on the LCP [9] [11].
In ﬁlter design problems, it is required to optimize
a desired frequency response by minimizing an error
norm, which can be measured in L2 or L∞ norm. L2 is
known for its poor performance especially at band edges
(Gibb′sPhenomenon). In [1], the author tried to improve
the performance by simply removing the transition region
from the error measure but the presented examples show
that a compromise has to be made at one of the band
edges.
We revisit the problem with a weighting strategy and
show that QP converted into LCP is capable of producing
equiripple response ﬁlters comparable with Park and Mc-
Clellan [6] who used polynomial interpolation technique
to solve for the desired ﬁlters. The resulted LCP-QP is
solved by the most robust Lemke’s algorithm. Based on
pivoting, Lemke is a direct algorithm. It is computationally
very effective as no matrix inversion is needed [1].
In many applications, the number of arithmetic opera-
tions indicate the cost of implementation, thus reducing
the length of impulse response that is designing sparse
ﬁlters is beneﬁcial not only in terms of computational
cost but also in hardware and energy consumption [13]
[14]. Sparse ﬁlters offer opportunity to omit the arithmetic
operations associated with zero-valued coefﬁcients. In this
article, a simple iterative algorithm is proposed to reduce
the number of coefﬁcients of a non-sparse ﬁlter.
This paper is organized as follows: Section II presents
the problem formulation, and shows the effect of LCP-
QP with weights on the design problem. Section III de-
scribes an iterative algorithm to thin the impulse response.
Section IV presents the discussion and simulation results.
Finally, we conclude in Section V.
II. PROBLEM FORMULATION
For simplicity of presentation, consider the frequency
response of type I FIR ﬁlter given by [1] [13] [14]:
H(w) =
N−1
X
n=0
h(n)cos(ωn),
(1)
where { hn} , n = 0, ..., N − 1 is the impulse response.
Discretizing ω as ωk|1 ≤ k ≤ L, the frequency response
in (1) can be written in the following matrix form:
H = Ch,
(2)

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
8
(a) a
(b) b
Figure 1. Performance comparison of LCP with and without weights compared with the optimal least square method. It is clear that with appropriate weights LCP
approach is capable of producing FIR ﬁlters with equiripple response.
where
C =


1
cos(w1)
.
.
.
cos(Nw1)
.
.
.
.
.
.
.
.
.
.
.
.
1
cos(wm)
.
.
.
cos(Nwm)
.
.
.
.
.
.
.
.
.
.
.
.
1
cos(wL)
.
.
.
cos(NwL)


and
h =

h[0]
h[1]
.
.
.
h[N − 1]
h[N]
T
Since LCP is solved for a positive vector, the impulse
response has to be written as a difference of two non-
negative vectors [1]:
h = h+ − h−.
(3)
Using (2) and (3), the frequency response of a discrete
time ﬁlter becomes [1]:
H = Bd,
(4)
where B =
 C
−C 
and d =

h+
h−

. For a desired
frequency response D, error vector will be [1]:
E = Bd − D.
(5)
The problem of ﬁnding h can be formulated by minimiz-
ing the squared error [1]:
Minimize
ε(d) = EτE
Subject to
|W × E| ≤ δ,
(6)
where W is a strictly positive weighting vector and δ, is
the tolerance scheme. The objective function in (6) can be
written as:
ε(d) = EτE,
= (Bd − D)τ (Bd − D) ,
= (dτBτ − Dτ) (Bd − D) ,
= dτBτBd − dτBτD − DτBd + DτD,
= dτBτBd − 2dτBτD + DτD.
ε(d) = 1
2dτQd − dτR + DτD,
(7)
where d
∈
R2N+2 , Q = 2BτB is symmetric and
semi-positive deﬁnite matrix and R = 2BτD. The linear
constraints in problem (6) can be written in a compact
form as follows:
|W × E| ≤ δ
|Bd − D| ≤ δ
W

B
−B

|
{z
}
A
d ≤

D +
δ
W
−D +
δ
W

|
{z
}
b
.
(8)
In compact form, the above minimization problem be-
comes [1]:
Minimize
f(d) = 1
2dτQd − dτR + DτD
Subject to
Ad ≤ b
d ≥ 0.
(9)
The Kuhn-Tucker necessary conditions for the above QP
in (9) are that there must exist vectors u ∈ R2N+2,
v ∈
R2L,
λ ∈ R2L such that [1] [9] [11]:
− R + Qd + Aτλ − u = 0,
Ad + v = b,
u ≥ 0, v ≥ 0, d ≥ 0, λ ≥ 0, uτd = 0, vτλ = 0.
(10)

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
9
(a) a
(b) b
Figure 2. Performance comparison of LCP with and without weights compared with the optimal least square method. Again with appropriate weights, the LCP approach
produces equiripple response.
Clearly, this can be written as:

u
v

≡

−R
b

+

Q
Aτ
−A
0
 
d
λ

,
u ≥ 0, v ≥ 0, d ≥ 0, λ ≥ 0, uτd = 0, vτλ = 0.
(11)
Thus, the minimization problem in (6) represents a LCP.
In a compact form, the LCP for the problem in (6) can be
written as [1]:
z − Mw = q,
z ≥ 0,
w ≥ 0,
zτw = 0,
(12)
where M =

Q
Aτ
−A
0

,z =
 u
v

,w =
 d
λ

and
q =
 −R
b

. If Q is semi positive deﬁnite then M is
also a semi positive semi-deﬁnite matrix [1] [11].
LCP Solver:
There are two main families of algorithms are available
to solve for the LCP(q,M) (12): a) direct algorithms and
b) indirect algorithms . In this research, the most robust
and direct Lemke’s algorithm [1] [9] [11] is used to solve
LCP (12).
A. Design Examples
In this section, a set of design examples are provided.
The objective here is to show various FIR ﬁlter designs
via LCP with and without weights compared with optimal
least square method. Figure 1 shows the design of 79th-
order linear phase lowpass FIR ﬁlter. The tolerance scheme
for the passband [0, 0.4π] and stopband [0.45π, π] is 0.02
[1].
Another example of the 87th-order linear phase band-
pass FIR ﬁlter design is shown in Figure 2. Tolerance
schemes for the passband [0.35π, 0.65π] and stopband
[0, 0.3π] , [0.7π, π] are 0.04 and 0.06 respectively [1].
Optimal Non-
Sparse 
Design via LCP
Find the smallest 
coefficient 𝒉𝒎𝒊𝒏
Put additional 
constraint 
𝒉𝒎𝒊𝒏 = 𝟎
into QP (7)
Convert QP (7) 
into LCP (8)
Apply Lemke 
algorithm 
to solve LCP (8)
Sparse Filter 
Design
Terminate
Yes
NO
If 
Error < Threshold
Figure 3. LCP based successive thinning algorithm to design sparse FIR digital
ﬁlter.
Design examples show that with the appropriate weighting
strategy LCP method [1] can lead to FIR ﬁlters with
equiripple response.
III. SPARSE FILTER DESIGN USING LCP
Since in many applications, the number of arithmetic
operations indicate the cost of implementation, thus reduc-
ing the length of impulse response that is designing sparse
ﬁlters is beneﬁcial not only in term of computational
cost but also in hardware and energy consumption [13]
[14]. To test the performance of LCP in context of spares
ﬁlter designing, we proposed a simple algorithm shown
in Figure 3 that iteratively thins the impulse response of

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
10
TABLE I. PERFORMANCE OF LCP IN THE CONTEXT OF SPARSE AND NON-SPARSE FILTER DESIGN
No. of
Non-zero
zero
Max.pass-
band
Min.stop-
band
coefﬁcients
weights
weights
error
attenuation
[dB]
[dB]
79
79
0
0.0852
-40.2
79
61
18
0.1148
-37.57
61
61
0
0.1956
-32.89
(a) a
(b) b
Figure 4. Performance comparison of sparse and non-sparse ﬁlters with 61 non-zero co-coefﬁcients. This can be observed that sparse FIR ﬁlter designed by LCP offer
advantage, when compared to its equivalent non-sparse ﬁlter designed by LCP and optimal least square method.
a non-sparse ﬁlter. For successive thinning of the impulse
response, usually we start with higher no. of coefﬁcients
than required [13] [14].
Application of Successive thinning algorithm:
The successive thinning algorithm shown in Figure 3 is
applied on the 79th order non-sparse ﬁlter shown in Figure
4 with passband [0, 0.4π] and stop-band [0.45π, π]. Figure
4 and Table I compare the sparse and non-sparse FIR ﬁlters
designed by LCP approach.
IV. DISCUSSION RESULTS
In [1], the author used quadratic measure to design dig-
ital ﬁlters via LCP without weights and tried to minimize
the effect of Gibb’s phenomenon by ignoring the transition
band and simply removing it from the error measure. Thus,
the presented examples show that a compromise has to be
made at one of the band edges. However, the FIR examples
presented in sections II and III showed the efﬁciency of
the proposed weighting strategy.
Moreover, it has been observed that, the LCP-solvers
like Lemke’s algorithm are very sensitive to the frequency
grid. Different passband to stopband frequency grid (p/s-
fg) ratio can lead to different solutions. The denser the
frequency grid in passband compared to the stop-band, the
smaller the error in passband but at a cost of increased
error in stopband and vice versa. To show the effect of
frequency grid ratio, a 95th order FIR ﬁlter with passband
[0, 0.11π] and stopband [0.15π, π] designed by LCP is
shown in Figure 5.
V. CONCLUSION AND FUTURE WORK
In this paper, the problem of linear phase FIR ﬁlter
design is reconsidered as a LCP with a weighting strategy.
The LCP is not an optimization technique because there is
no objective function to optimize; thus, the design problem
of the linear phase 1D FIR ﬁlter is formulated via quadratic
programming, and then the equivalent semideﬁnite LCP
form is obtained by applying the Karush Kuhn Tucker
conditions. One advantage of LCP is its well-developed
theory because there are a number of algorithms available
to solve a particular LCP. In the case of an FIR ﬁlter, the
resulted semideﬁnite LCP is solved by the most robust
Lemkes algorithm. It is shown with simulations that with
a proper weighting strategy LCP can lead to equiripple
solution for 1D FIR ﬁlters. In addition, a simple but
effective algorithm is presented to design sparse FIR
ﬁlters. Sparse ﬁlters designed by the proposed successive
thinning algorithm outperform the non-sparse ﬁlters with
equal number of non-zero coefﬁcients.
Future work is in progress to extend the LCP technique
in order to design two dimensional FIR ﬁlter.
REFERENCES
[1] A. M. Al-Fahed Nuseirat, ”Design of linear phase FIR ﬁlters
via linear complementarity problem (LCP) approach,” Interna-

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
11
(a) a
(b) b
Figure 5. Performance of LCP designed FIR ﬁlters without weights. Effect of passband to stopband frequency grid (p/s-fg) ratio can be observed on Magnitude spectrum.
tional Journal of Circuit Theory and Applications Sept. 2005,
vol. 33, no. 5, pp. 353-364.
[2] L. R. Rabiner, ”The design of ﬁnite impulse response digital
ﬁlters using linear programming techniques,” Bell System Tech-
nical Journal Aug. 1972, vol. 51, no.6, pp. 1117-1198.
[3] P. P. Vaidyanathan and T. Q. Nguyen, ”Eigenﬁlters: a new
approach to least-square FIR ﬁlter design and applications
including Nyquist ﬁlters,” IEEE Transactions on Circuits and
Systems, Jan. 1987, vol. 34, no. 1, pp. 11-23.
[4] G. W. Medlin, J. W. Adams, and C.T. Leondes, ”Lagrange
multiplier approach to the design of FIR ﬁlters for multirate
applications,” IEEE Transactions on Circuits and Systems, Aug.
2002, vol. 35, no.10, pp. 1210-1219.
[5] M. H. Er and C. K. Siew, ”Design of FIR ﬁlters using quadratic
programming approach,” IEEE Transactions on Circuits and
Systems II Aug. 2002, vol. 42, no. 3, pp. 217-220.
[6] T. W. Parks and J. H. McClellan,”Chebyshev approxima-
tion for nonrecursive digital ﬁlters with linear phase,” IEEE
Trans.Circuit Theory, Mar. 1972, vol. 19, pp. 189-194.
[7] V. R. Algazi, M. Suk, and R. Chong-Suck, ”Design of almost
minimax FIR ﬁlters in one and two dimensions by WLS tech-
nique,” IEEE Transactions on Circuits and Systems Jan. 2003,
vol. 33, no. 6, pp. 590-596.
[8] M. Lang, I. W. Selesnick, and C. S. Burrus, ”Constrained least
squares design of 2-D FIR ﬁlters,” IEEE Transactions on Signal
Processing, May 1996, vol. 44, no. 5, pp. 1234-1241.
[9] K. G. Murty, Linear Complementarity: Linear and Nonlinear
Programming, 1997.
[10] A. Chandra and S. Chattopadhyay,
”Design optimization of
powers-of-two FIR ﬁlter using self-organizing random immi-
grants GA,” International Journal of Electronics, 2015, vol. 102,
no. 1, pp. 127-140.
[11] O. L. Mangasarian and J. S. Pang, ”The Linear Complementarity
Problem,” SIAM Journal on Matrix Analysis and Applications,
1995, Vol. 16, no. 2, pp. 359-368.
[12] A. Fischer, ”A Newton-Type Method for Positive-Semideﬁnite
Linear Complementarity Problems,” Journal of optimization the-
ory and applications, September 1995, vol. 86, no. 3, pp. 585-
608.
[13] T. Baran, D. Wei, and A. V. Oppenheim, ”Linear Programming
Algorithms for Sparse Filter Design,” IEEE Transaction on signal
processing, March 2010, no. 3, vol. 58, pp. 1605-1617.
[14] D. Wei, C. K. Sestok, and A. V. Oppenheim, ”Sparse Filter
Design Under a Quadratic Constraint:Low-Complexity Algo-
rithms,” IEEE Transaction on signal processing, Feb. 2013, no.
4, vol. 61, pp. 857-870.

SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)
Copyright (c) IARIA, 2016. ISBN: 978-1-61208-453-4
12

