RSMA Receiver 
Sergei Semenov 
HiSilicon/Huawei 
Lund, Sweden 
e-mail: sergei.semenov@huawei.com 
 
 
Abstract—In this paper, we propose a new algorithm for the 
detection of Resource Spread Multiple-Access (RSMA) signal. 
The proposed algorithm provides a significant performance 
gain in comparison with other algorithms for the high spectral 
efficiency case with affordable complexity.  
Keywords-RSMA; 
NOMA; 
OLMA; 
message 
passing 
algorithm; projection based IC. 
I. 
 INTRODUCTION  
Resource spread multiple access (RSMA) is an overloaded 
multiple-access (OLMA) strategy, which is closely related to 
code-division multiple access (CDMA) [7] and interleave-
division multiple-access (IDMA) [8]. RSMA was proposed in 
[1][2] as a candidate for new radio (NR) uplink (UL) multiple 
access. 
Current 
assumption 
for 
RSMA 
receiver 
implementation is that very low rate channel coding is used in 
the system. In this case, quite simple approaches can be used 
for the RSMA receiver implementation. In [3], the use of two 
types of receivers was proposed: 
1. Match filter (MF): Each layer descrambles and de-
spreads the signal before passing it to the decoder. 
Detection is done by the Hermitian transpose of 
spreading/scrambling sequence matrix, which can be 
viewed as a match filter. 
2. MF+successive interference cancellation (SIC): Once 
a packet is decoded, then its waveform can be 
cancelled from the received waveform. The receiver 
re-attempts to decode unsuccessful packets. The 
iteration stops when no new packet needs to be 
decoded. 
This type of receiver can be used in Ultra Reliable Low 
Latency Communications (URLLC) scenario and to some 
extent in Massive Machine Type Communications (mMTC) 
scenario but it hardly can be used for Enhanced Mobile 
Broadband (eMBB) transmission since in this case, low 
spectral efficiency (SE) caused by usage of very low code rate 
is a drawback. Joint maximum likelihood (ML) detection 
provides the optimum performance but the complexity of this 
type of the receiver grows exponentially with the number of 
users. 
The message passing algorithm (MPA) can be used in the 
receiver for non-orthogonal MA employing low-density 
signatures like LDSMA [4] or SCMA and it provides good 
performance with affordable complexity. However, it cannot 
be applied directly to RSMA detection since RSMA does not 
use low-density signatures, i.e., the number of users colliding 
over one resource element (RE) is equal to the number of all 
users. 
In this paper, we propose to use a combination of MPA 
and projection based interference cancellation (IC) for RSMA 
signal detection. 
 
The rest of this paper is organized as follows. Section II 
describes the application of MPA for OLMA detection and the 
projection based IC. Section III describes the hybrid receiver 
combining MPA and projection based IC for RSMA 
detection. Simulation results are represented in Section IV. 
The conclusions close the article. 
II. 
MPA FOR OLMA DETECTION AND PROJECTION 
BASED IC 
A. MPA for LDSMA signal 
The application of MPA for the detection of the LDSMA 
signal is described in [4]. This application is based on the 
structure of the LDSMA signal. Users in LDSMA share the 
available REs in such a way that only limited number of users 
can transmit over a particular RE. 
The structure of this system can be described with the help 
of indicator matrix 𝐅𝑁×𝐾  defining the signals of K users 
spreading their signals over N REs. An example of indicator 
matrix for N = 12 and K = 16 is presented in Figure 1. 
 
Figure 1. Indicator matrix, 𝑲 = 𝟏𝟔, 𝑵 = 𝟏𝟐, 𝒅𝒖 = 𝟑 and 𝒅𝒄 = 𝟒. [4]. 
 
The position of ones in the nth row of the indicator matrix 
𝐅𝑁×𝐾 denotes the set of users who contribute their data at the 
nth symbol, while its kth column represents the set of symbols 
over which the user spreads his/her data. The maximum 
number of ones in each column 𝑑𝑢 indicates the maximum 
number of nonzero spread symbols, which can be located for 
each user among the 𝑁 possible time-frequency resources. It 
is also clearly seen that each spread symbol will collide in the 
 
96
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-562-3
AICT 2017 : The Thirteenth Advanced International Conference on Telecommunications

channel with 𝑑𝑐 (maximum number of ones in row) symbols 
from other users. 
If the indicator matrix has the same number of ones in each 
column, i.e., 𝑑𝑢 and also the same number of ones in each 
row, i.e., 𝑑𝑐 , but is not necessarily equal to 𝑑𝑢, then the 
structure is called regular indicator matrix, otherwise, it is 
called irregular indicator matrix.  
As can be seen from the description of the indicator matrix 
it corresponds to the description of the parity-check matrix of 
the LDPC code. Due to this fact, the idea of MPA used for 
decoding LDPC codes is applicable for LDSMA signal 
detection. 
An indicator matrix can be represented by a bidirectional 
bipartite factor graph. In Figure 2, the graph for the LDPC 
matrix shown in Figure 1 is illustrated. 
 
Figure 2. Factor graph representation of the indicator matrix shown in 
Figure 1 [4]. 
 
In this graph, the upper (variable) nodes {𝑢𝑘}, 𝑘 = 1, … , 𝐾 
are connected to the 𝐾 user transmitted symbols; the lower 
(function) nodes {𝑐𝑛}, 𝑛 = 1, … , 𝑁 represent N REs carrying 
the encoded information and being connected to the 
observations at these REs {𝑦𝑛}, 𝑛 = 1, … , 𝑁 ; the edges 
between indicate which REs are occupied by a user. From this 
graph, we find that there is an edge between pair (𝑐𝑖, 𝑢𝑗) if and 
only if the matrix element 𝐹𝑖𝑗 is nonzero. We see also that 
each node 𝑐𝑛 is connected to 𝑑𝑐 nodes and each node 𝑢𝑘 is 
connected to 𝑑𝑢 nodes. 
Let edge 𝑒𝑛,𝑘 be the edge that connects a function node 𝑐𝑛 
to a variable node 𝑢𝑘 . At the function node 𝑐𝑛, the local 
channel observation at the corresponding RE 𝑦𝑛 is made and 
is given by 
 
𝑝(𝑦𝑛|𝐱[𝑛]) =
1
√2𝜋𝜎
exp(− 1
2𝜎2 ‖𝑦𝑛 − 𝐠[𝑛]𝑇𝐱[𝑛]‖
2
), 
(1) 
where 𝐠[𝑛] and 𝐱[𝑛] is the set of channel coefficients and the 
set of transmitted symbols corresponding to non-zero 
elements in the nth row of the indicator matrix, i.e., 
corresponding to the users contributing to the nth RE. 
Each message being exchanged must be in the form of a 
vector of size |𝒜| comprising the reliability values for each of 
the possible values taken from the symbol constellation 
alphabet 𝒜. Note that, the message must be normalized such 
that the sum of all probability values for all alphabet symbols 
is one. LLRs can be used instead of probabilities. Then, the 
size of message is |𝒜| − 1. 
Let symbol 𝑦𝑛 be the symbol of observation. The message 
being sent from function node 𝑐𝑛 onto edge 𝑒𝑛,𝑘 is the product 
of the messages received from edges 𝑒𝑙,𝑛 (𝑙 ∈  𝜀𝑛\𝑘, where 𝜀𝑛 
is the set of 𝑑𝑐 variable nodes connected to the function node 
𝑐𝑛 defined by the nth row of index matrix 𝐅𝑁×𝐾 (variable node 
𝑢𝑘 must be excluded from this set)) with the local function at 
𝑐𝑛 and being summarized for the variable associated with the 
edge, i.e., 𝑥𝑘. Similarly, the variable node 𝑢𝑘 will send onto 
edge 𝑒𝑛,𝑘 a message, which is the product of the messages 
received from edges 𝑒𝑚,𝑘 (𝑚 ∈  𝜉𝑘\𝑛, where ξk is the set of 
𝑑𝑢 function nodes connected to the variable node 𝑢𝑘 defined 
by the kth column of index matrix 𝐅𝑁×𝐾  (function node 𝑐𝑛 
must be excluded from this set)).  
Let 𝜇𝑐𝑛←𝑢𝑘 and 𝜇𝑐𝑛→𝑢𝑘 be the message sent along edge 𝑒𝑛,𝑘 
from variable node 𝑢𝑘 and function node 𝑐𝑛, respectively. The 
message 𝜇𝑐𝑛←𝑢𝑘 gives an updated inference of 𝑥𝑘 based on the 
observation taken at symbols 𝑦𝑚, 𝑚 ∈ 𝜉𝑘\𝑛: 
 
𝜇𝑐𝑛←𝑢𝑘(𝑗) = log 𝑃𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎𝑗)
𝑃𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎0) =
∑
𝜇𝑐𝑚→𝑢𝑘(𝑗)
𝑚∈ 𝜉𝑘\𝑛
,
𝑗 = 1, … , |𝒜| − 1, 
(2) 
where 𝑎𝑗 ∈  𝒜  is the corresponding element of the 
constellation alphabet 𝒜. 
Appending the set of equations (2) with the additional 
restriction 
 
∑ 𝜆𝑛,𝑘𝑃𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎𝑗)
|𝒜|−1
𝑗=0
= 1, 
(3) 
where 𝜆𝑛,𝑘 is a normalizing coefficient, and solving this set of 
equations, we obtain   
 
𝑃𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎𝑗) =
exp (𝜇𝑐𝑛←𝑢𝑘(𝑗))
𝜆𝑛,𝑘 (∑
|𝒜|−1 exp(𝜇𝑐𝑛←𝑢𝑘(𝑖))
𝑖=0
)
, 
𝜇𝑐𝑛←𝑢𝑘(0) = 0. 
(4) 
The denominator in (4) is constant for all 𝑃𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎𝑗),
𝑗 = 0, … , |𝒜| − 1. Then (4) can be simplified to 
 
𝑃𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎𝑗) = exp (𝜆𝑛,𝑘
′
𝜇𝑐𝑛←𝑢𝑘(𝑗)), 
𝜇𝑐𝑛←𝑢𝑘(0) = 0. 
(5) 
where 𝜆𝑛,𝑘
′
 is the normalization coefficient and is chosen to 
satisfy (3), 𝜆𝑛,𝑘
′
= − log𝜆𝑛,𝑘. 
At the function node 𝑐𝑛, the inference of 𝑥𝑘 is updated and 
is given by 
 
𝜇𝑐𝑛→𝑢𝑘(𝑗) = log 𝑝𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎𝑗|𝑦𝑛, 𝐱[𝑛]\𝑥𝑘)
𝑝𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎0|𝑦𝑛,𝐱[𝑛]\𝑥𝑘) ,
𝑗 = 1, … , |𝒜| − 1. 
(6) 
Applying Bayes’ rule to the nominator and the 
denominator of (6) and taking into account that the a priori 
 
97
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-562-3
AICT 2017 : The Thirteenth Advanced International Conference on Telecommunications

pmf of 𝑥𝑘 should not be included in the computation of a 
posteriori pmf of 𝑥𝑘, we obtain 
 
𝜇𝑐𝑛→𝑢𝑘(𝑗)
= log 𝑝𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎𝑗|𝑦𝑛, 𝐱[𝑛]\𝑥𝑘)
𝑝𝑒𝑥𝑡,𝑛(𝑥𝑘 = 𝑎0|𝑦𝑛, 𝐱[𝑛]\𝑥𝑘)
= log 𝑝𝑒𝑥𝑡,𝑛(𝑦𝑛|𝐱[𝑛],𝑥𝑘 = 𝑎𝑗)𝑃(𝐱[𝑛]\𝑥𝑘)
𝑝𝑒𝑥𝑡,𝑛(𝑦𝑛|𝐱[𝑛],𝑥𝑘 = 𝑎0)𝑃(𝐱[𝑛]\𝑥𝑘),
𝑗 = 1, … , |𝒜| − 1. 
(7) 
Combining (1), (2), and (5) into (7), we can write a 
complete message being sent from the function node 𝑐𝑛 to the 
variable node 𝑢𝑘 onto the edge 𝑒𝑛,𝑘 as follows: 
 
 
𝜇𝑐𝑛→𝑢𝑘(𝑗)
= log
∑
exp (∑
𝜆𝑛,𝑙
′ 𝜇𝑐𝑛←𝑢𝑙
[𝐱[𝑛]] (𝑗)
𝑙∈ 𝜀𝑛\𝑘
− 1
2𝜎2 ‖𝑦𝑛 − 𝐠[𝑛]𝑇𝐱[𝑛]‖
2
)
𝐱[𝑛]∈𝒜𝑑𝑐,
𝑥𝑘=𝑎𝑗
∑
exp (∑
𝜆𝑛,𝑙
′ 𝜇𝑐𝑛←𝑢𝑙
[𝐱[𝑛]] (𝑗)
𝑙∈ 𝜀𝑛\𝑘
− 1
2𝜎2 ‖𝑦𝑛 − 𝐠[𝑛]𝑇𝐱[𝑛]‖
2
)
𝐱[𝑛]∈𝒜𝑑𝑐,
𝑥𝑘=𝑎0
=
max
𝐱[𝑛]∈𝒜𝑑𝑐,
𝑥𝑘=𝑎𝑗
∗ ( ∑ 𝜆𝑛,𝑙
′ 𝜇𝑐𝑛←𝑢𝑙
[𝐱[𝑛]] (𝑗)
𝑙∈ 𝜀𝑛\𝑘
− 1
2𝜎2 ‖𝑦𝑛 − 𝐠[𝑛]𝑇𝐱[𝑛]‖
2
)
−
max
𝐱[𝑛]∈𝒜𝑑𝑐,
𝑥𝑘=𝑎0
∗ ( ∑ 𝜆𝑛,𝑙
′ 𝜇𝑐𝑛←𝑢𝑙
[𝐱[𝑛]] (𝑗)
𝑙∈ 𝜀𝑛\𝑘
− 1
2𝜎2 ‖𝑦𝑛 − 𝐠[𝑛]𝑇𝐱[𝑛]‖
2
),
𝑗 = 1, … , |𝒜| − 1, 
(8) 
where 𝜇𝑐𝑛←𝑢𝑙
[𝐱[𝑛]]  denotes the message from variable node 𝑢𝑙 to 
function node 𝑐𝑛 corresponding to vector 𝐱[𝑛] and function 
max∗ is defined as 
 
max∗(𝑎, 𝑏) = log(𝑒𝑎 + 𝑒𝑏) = max(𝑎, 𝑏) + log(1 + 𝑒−|𝑎−𝑏|). 
(9) 
After the message arriving to variable nodes 𝑢𝑘 , 𝑘 =
1, … , 𝐾 have converged or the maximum iteration number has 
been reached, the variable nodes will use all messages 
received from all connected edges to calculate the final 
estimated inference for symbol 𝑥𝑘 , because now we are 
calculating the symbol estimate rather than an extrinsic 
information, and, except this detail, this is done in the same 
way as in (2) 
 
𝑃(𝑥𝑘 = 𝑎𝑗) = exp ( ∑ 𝜆𝑛,𝑘
′
𝜇𝑐𝑛→𝑢𝑘(𝑗)
𝑛∈ 𝜉𝑘
), 
𝜇𝑐𝑛→𝑢𝑘(0) = 0. 
(10) 
 
B. Projection based IC 
Another method used in hybrid RSMA receiver is the 
interference cancellation based on projection techniques. 
Consider the system model  
 
𝐲 = 𝐆𝐱 + 𝐧, 
(11) 
where 𝐲 is the received signal, 𝐱 is the vector, composed of 
the transmitted symbols of all users and 𝐧 is the noise vector. 
Matrix 𝐆 is the generalized channel matrix including both 
channel coefficients and user signatures. 
We denote the part of vector x corresponding to signal of 
interest by 𝐱T and the other part of vector 𝐱 corresponding to 
the interference by 𝐱Q. Then, the matrix 𝐆 can also be split 
into two parts corresponding to signal of interest and 
interference. Without loss of generality, we can assume that 
the first ∆ elements of vector 𝐱 and correspondingly first ∆ 
columns of matrix 𝐆 correspond to the signal of interest. 
Then, the matrix 𝐆 can be represented as follows: 
 
𝐆 = [𝐓, 𝐐].    
(12) 
And (11) can be represented as 
  
𝐲 = 𝐆𝐱 + 𝐧 = 𝐓𝐱𝑇 + 𝐐𝐱𝑄 + 𝐧. 
(13) 
The simplest solution to (13) wrt 𝐱𝑇 is to apply a ZF type 
receiver. It can be done with the help of the following 
correlation operation 
(𝐓𝐻𝐓)−𝟏𝐓𝐻𝐲 = (𝐓𝐻𝐓)−𝟏𝐓𝐻(𝐓𝐱𝑇 + 𝐐𝐱𝑄 + 𝐧)
= (𝐓𝐻𝐓)−𝟏𝐓𝐻𝐓𝐱𝑇
+ (𝐓𝐻𝐓)−𝟏𝐓𝐻𝐐𝐱𝑄 + (𝐓𝐻𝐓)−𝟏𝐓𝐻𝐧
= 𝐱𝑇 + (𝐓𝐻𝐓)−𝟏𝐓𝐻𝐐𝐱𝑄
+ (𝐓𝐻𝐓)−𝟏𝐓𝐻𝐧. 
(14) 
The main problem with the ZF type receiver solution (14) 
is the term corresponding to interference (𝐓𝐻𝐓)−𝟏𝐓𝐻𝐐𝐱𝑄. 
The main idea of interference mitigation is to project the 
received signal y onto a vector subspace that is orthogonal to 
the interference vector subspace (the subspace spanned by the 
columns of matrix Q). 
The projection is a linear transformation P from a vector 
space to itself such that it is idempotent, i.e., P2 = P. 
Let W be an underlying vector space. Suppose the 
subspaces U and V are the range and null space of P 
respectively. Then, the projection has these basic properties: 
1. P is the identity operator I on U: 
x
Px
x

 
U :
. 
2. W is a direct sum W = U ⊕ V. This means that every 
vector 
x W
 may be decomposed uniquely in the 
manner x = u + v, where 
uU
 and 
v V
. The 
decomposition is given by 
       𝐮 = 𝐏𝐱,   𝐯 = 𝐱 − 𝐏𝐱 = (𝐈 − 𝐏)𝐱. 
 
If the range U and the null space V are orthogonal 
subspaces, the projection P is an orthogonal projection. For 
orthogonal projection matrix P is Hermitian matrix, i.e., P = 
PH. If u1, ..., uk is a basis of U, and A is the matrix with these 
vectors as columns, then the projection is 
 
𝐏𝐀 = 𝐀(𝐀𝐻𝐀)−1𝐀𝐻. 
(15) 
Then the projection onto interference vector space, i.e., 
vector space spanned by columns of Q is defined by the matrix  
 
𝐏𝐐 = 𝐐(𝐐𝐻𝐐)−1𝐐𝐻, 
(16) 
and, correspondingly, the projection onto null vector space is 
defined by matrix 
98
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-562-3
AICT 2017 : The Thirteenth Advanced International Conference on Telecommunications

 
𝐏𝐐
⊥ = 𝐈 − 𝐏𝐐 = 𝐈 − 𝐐(𝐐𝐻𝐐)−1𝐐𝐻. 
(17) 
After projecting the received signal y onto the null space 
of Q, we obtain: 
 
 


.
)
(
)
(
)
(
)
(
P n
P Tx
Q n
Q Q
Q
Q Qx
Q Q Q
Q Tx
Q Q Q
n
Qx
Tx
Q y
Q Q Q
I
y
P
Q
Q
1
1
1
1
Q

















T
H
H
Q
H
H
T
H
H
Q
T
H
H
 
(18) 
Denote vector 𝐏𝐐
⊥𝐲 as 𝐲̅, vector 𝐏𝐐
⊥𝐧 as 𝐧̅ and matrix 𝐏𝐐
⊥𝐓 
as 𝐆̅. Then (18) can be written as 
 
𝐲̅ = 𝐆̅𝐱𝑻 + 𝐧̅. 
(19) 
Then, any appropriate method can be used to solve (19). 
For example, in [5] [6], RAKE receiver is used to solve (19). 
III. 
HYBRID RSMA RECEIVER 
It is not possible to apply MPA directly to RSMA signal 
detection since the indicator matrix corresponding to RSMA 
would be a unit matrix (matrix consisting of ones). In this 
case, the MPA cannot provide good results since 
corresponding graph contains cycles of length 4. Moreover, 
the complexity of the algorithm grows exponentially with the 
number of users. 
The drawback of the interference cancellation based on 
orthogonal projection is that if the number of interferers is 
high the attempt to map the received signal onto the null space 
of the interference leads to the distortion of the signal of 
interest as well. 
In this paper, we propose to combine these two methods 
to create a hybrid receiver of the RSMA signal. 
As it was mentioned above, since in RSMA all users 
collide over each RE, the indicator matrix for RSMA signal 
comprises unit matrix of dimension NxK, where N is the 
number of REs over which users are spreading their signals, 
and K is the number of users (𝑁 < 𝐾).  
We propose to choose some sparse matrix of size NxK 
with good properties (e.g., the corresponding graph should not 
contain cycles of short lengths and stopping sets) and use it as 
an indicator matrix. A good way to construct such a matrix 
could be to use a combinatorial design. 
Then, the general MPA described in equations (1)-(10) can 
be 
applied. 
However, 
before 
applying 
calculations 
corresponding to function nodes (8) the interference coming 
from interferers designated in the corresponding rows of the 
indicator matrix F must be nullified. 
For example, if the RSMA system with 16 users spreading 
the signals over 12 REs is considered, and matrix F 
represented in Figure 1 is chosen as an indicator matrix, before 
calculating messages from the function node 1 corresponding 
to 1st row of matrix F, the interference from users 1, 2, 4, 5, 6, 
7, 9, 11, 12, 14, 15, 16 should be nullified. And before 
calculating messages from the function node 2 the 
interference from users 1, 2, 3, 5, 6, 8, 9, 10, 11, 12, 14, 16 
must be cancelled. 
This step can be done with the help of projection based 
interference cancellation. We propose before calculating 
messages from the function node n, to collect the signatures 
of users corresponding to zeros in nth row of matrix F, in 
matrix of interference Q and projecting the received signal y 
onto the null space of Q like it is done in (18). However, we 
propose to avoid excessive noise enhancement and take the 
noise amplification into account when projecting the received 
signal onto the null space of Q. Due to this, the projection is 
slightly modified in accordance with MMSE solution: 
 

Q y
I
Q Q Q
I
y
P
1
Q
H
H





)
(
2
0
, 
(20) 
where 
2
0
  is the noise variance. 
Then calculation of message from the function node n can 
be done in accordance with (7)-(8) but in space skewed by the 
projection 𝐏𝐐
⊥, i.e., vector y in (7)-(8) should be substituted by 
skewed vector 𝐲̅ = 𝐏𝐐
⊥𝐲 and matrix G in (7)-(8) should be 
substituted by skewed matrix 𝐆̅ = 𝐏𝐐
⊥𝐓. 
The number of users to be cancelled should not exceed N. 
Otherwise matrix 
)
(
2
0I
Q Q


H
 can be singular. 
Taking into account the fact that in RSMA signal all users 
collide over all REs we can improve the calculation of (7)-(8) 
by calculating (7) simultaneously for a few components of 
vector y rather than for just one component with index n like 
it is done in (7). Now, the calculations (7)-(8) are done for all 
components of vector y corresponding to non-zero elements 
of column k in indicator matrix F except the component with 
index n. Actually, it means that the component of vector y
with index n in (7) should be substituted by vector 
 
y n
, where 
vector 
 
y n
 comprises vector y with zeros at the same 
positions where zeros are located in column k in indicator 
matrix F , and one more zero is located in the component with 
index n. And vector 𝐠[𝑛] in (8) should be substituted by matrix 
𝐆̅[𝑛]. The corresponding LLRs should be summed up.  Then 
this can be written as it is shown in (21). 
In fact, calculations in (21) can be considered as a joint 
ML detection of users corresponding to non-zero elements in 
row n of indicator matrix F. If we consider the implementation 
of the receiver in vector processor, the complexity of 
calculation (21) is the same as the complexity of calculation 
(8). And the calculation of message going from the function 
node in the form shown in (21) provides performance gain. 
The main complexity of the detector is contributed by 
calculation of (21), i.e., by the joint ML detection of users. As 
it was mentioned above, the complexity of the receiver grows 
exponentially with number of users to be detected jointly with 
the help of ML algorithm. Due to the sparsity of the indicator 
matrix F, the number of users to be detected jointly can be set 
to be constant or can grow very slowly. If the number of users 
to be detected jointly is set to be constant, the complexity of 
the receiver can be considered to be polynomial. 
 
 
99
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-562-3
AICT 2017 : The Thirteenth Advanced International Conference on Telecommunications

 
𝜇𝑐𝑛→𝑢𝑘(𝑗)
= log
∑
exp (∑
𝜆𝑛,𝑙
′ 𝜇𝑐𝑛←𝑢𝑙
[𝐱[𝑛]] (𝑗)
𝑙∈ 𝜀𝑛\𝑘
− 1
2𝜎2 ‖𝐲̅[𝑛] − 𝐆̅[𝑛]𝑇𝐱[𝑛]‖
2
)
𝐱[𝑛]∈𝒜𝑑𝑐,
𝑥𝑘=𝑎𝑗
∑
exp (∑
𝜆𝑛,𝑙
′ 𝜇𝑐𝑛←𝑢𝑙
[𝐱[𝑛]] (𝑗)
𝑙∈ 𝜀𝑛\𝑘
− 1
2𝜎2 ‖𝐲̅[𝑛] − 𝐆̅[𝑛]𝑇𝐱[𝑛]‖
2
)
𝐱[𝑛]∈𝒜𝑑𝑐,
𝑥𝑘=𝑎0
=
max
𝐱[𝑛]∈𝒜𝑑𝑐,
𝑥𝑘=𝑎𝑗
∗ ( ∑ 𝜆𝑛,𝑙
′ 𝜇𝑐𝑛←𝑢𝑙
[𝐱[𝑛]] (𝑗)
𝑙∈ 𝜀𝑛\𝑘
− 1
2𝜎2 ‖𝐲̅[𝑛] − 𝐆̅[𝑛]𝑇𝐱[𝑛]‖
2
)
−
max
𝐱[𝑛]∈𝒜𝑑𝑐,
𝑥𝑘=𝑎0
∗ ( ∑ 𝜆𝑛,𝑙
′ 𝜇𝑐𝑛←𝑢𝑙
[𝐱[𝑛]] (𝑗)
𝑙∈ 𝜀𝑛\𝑘
− 1
2𝜎2 ‖𝐲̅[𝑛] − 𝐆̅[𝑛]𝑇𝐱[𝑛]‖
2
),
𝑗 = 1, … ,|𝒜| − 1, 
(21
) 
 
The indicator matrix F should be chosen in such a way that 
at least in one row the set of zero elements corresponds to the 
weakest users if the information about signal power of 
different users is available at the receiver. 
If turbo-equalization processing is used, i.e., detector and 
decoder exchange the extrinsic information in a few iterations, 
it is better to change the indicator matrix F for each iteration 
allowing different users being cancelled with the help of 
projection based method for the same row of indicator matrix 
in different iterations. This step increases the channel diversity 
for different iterations. The simple way to obtain the new 
indicator matrix with the same good properties as the initial 
indicator matrix is to generate the new indicator matrix by 
permutation of columns of the initial indicator matrix. 
IV. 
SIMULATION RESULTS 
The simulation results are represented in Figure 3. 
Simulation results for 6 users over 4REs. QPSK, Code Rate = 1/3.. 
Simulations were done for 6 users occupying 4 RBs, meaning 
the overloading factor was 150%. The proposed algorithm, 
designated in plots by MPA+Proj is compared with 
Successive Interference Cancellation (SIC), and partial ML 
algorithms designated by ML3 and ML1. In partial ML 
algorithm, M users (M < K) are detected jointly while 
interference from other users is considered as a noise. This 
procedure is repeated a few times until all users are detected. 
In simulation, each user was detected at least twice. Then, the 
overlapping estimates were combined. In partial ML 
algorithm, the decoders’ output is not used for the interference 
cancellation. SIC receiver choses the most powerful user and 
decodes it first. Then, the bit estimates of this user are mapped 
to symbol estimates and canceled from the signal taking into 
account the channel estimates. Next, the same procedure is 
applied to the next user with highest power. At first iteration, 
SIC receiver uses partial ML detection, i.e., the most powerful 
user is detected jointly with other M-1 users (M < K). Starting 
from the second iteration, the interference cancellation 
procedure relies on decoders’ output only.  Since the ML 
detection is used at first iteration only the SIC receiver is 
vulnerable to the error propagation. Due to this reason only 
extrinsic information is used for IC. 
 
 
Figure 3. Simulation results for 6 users over 4REs. QPSK, Code Rate = 1/3. 
 
As can be seen from the plots in Figures 3-4, the proposed 
algorithm provides very high gain for the case of high spectral 
efficiency. For low code rates (low SE) the gain provided by 
the hybrid receiver decreases since in this case, all other 
algorithms start to work quite well.  
 
Figure 4. Simulation results for 6 users over 4REs. QPSK, Code Rate = 
1/10. 
 
 
V. 
CONCLUSION 
In this paper, a new hybrid algorithm to detect the RSMA 
signal is proposed. The proposed algorithm combines MPA 
and projection based IC and provides significant performance 
gain in comparison with other algorithms in the case of high 
SE. 
 
REFERENCES 
[1] 3GPP R1-163510 “Candidate NR Multiple Access Schemes,” 
Qualcomm Inc., Busan, Korea, 11th – 15th April 2016. 
[2] 3GPP R1-164688 “RSMA,” Qualcomm Inc., Nanjing,China, 
23rd – 27th May 2016. 
 
 
100
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-562-3
AICT 2017 : The Thirteenth Advanced International Conference on Telecommunications

[3] 3GPP R1-164689 “RSMA and SCMA 
comparison,” 
Qualcomm Inc., Nanjing,China, 23rd – 27th May 2016. 
[4] R. Hoshyar, F. P. Wathan, “Novel Low-Density Signature for 
Synchronous CDMA System Over AWGN Channel,” IEE 
Trans. On Signal Proc., Vol 56, No 4, April 2008. 
[5] J. Thomas, W. Kober, E. Olson, R. Krumvieda, "Interference 
cancellation in a signal", WO 03/030440 A1, 2001. 
[6] W. Kober, J. Thomas, M. Vis, "Rake receiver for spread 
spectrum signal demodulation", US 2002/0090025 A1, 2001. 
[7] G. Miao, J. Zander, K. W. Sung, B. Slimane, “Fundamentals of 
Mobile Data Networks,” Cambridge University Press, 2016. 
[8] Y. Chen, F. Schaich, T. Wild, "Multiple Access and 
Waveforms for 5G: IDMA and Universal Filtered Multi-
Carrier", Vehicular Technology Conference (VTC Spring) 
2014 IEEE 79th, pp. 1-5, 2014. 
101
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-562-3
AICT 2017 : The Thirteenth Advanced International Conference on Telecommunications

