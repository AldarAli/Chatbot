Application of the Simulation Attack
on Entanglement Swapping Based
QKD and QSS Protocols
Stefan Schauer and Martin Suda
Safety and Security Department
AIT Austrian Institute of Technology GmbH
Vienna, Austria
stefan.schauer@ait.ac.at, martin.suda.ﬂ@ait.ac.at
Abstract—We discuss the security of quantum key distribution
protocols based on entanglement swapping against collective
attacks. Therefore, we apply a generic version of a collective
attack strategy on the most general entanglement swapping
scenario used for key distribution. Further, we focus on basis
transformations, which are the most common operations per-
formed by the legitimate parties to secure the communication. In
this context, we show that the angles, which describe these basis
transformations can be optimized compared to an application
of the Hadamard operation. As a main result, we show that
the adversary’s information is reduced to a new minimum of
about 0.45, which is about 10% lower than in other protocols.
To become a better overview how and on which protocols this
generic version of a collective attack is applicable, the security of
different quantum key distribution and quantum secret sharing
protocols is discussed. Here we show that applying two basis
transformations using different angles the security of a particular
protocol can be increased by about 25%.
Keywords—quantum key distribution; entanglement swapping;
security analysis; optimal basis transformations.
I.
INTRODUCTION
The security of quantum key distribution (QKD) protocols
based on entanglement swapping has been discussed on the
surface so far. In a recent article [1], a novel attack strategy
and its implications on the security of entanglement swapping
based protocols was discussed. This attack strategy will be
referred to as simulation attack since the major idea is to
simulate the correlation between Alice’s and Bob’s measure-
ment results [2]. In this article, we want to take a closer look
at the application of the simulation attack on different QKD
and quantum secret sharing (QSS) protocols together with the
necessary improvements on the security of these protocols.
QKD is an important application of quantum mechanics
and QKD protocols have been studied at length in theory
and in practical implementations [3], [4], [5], [6], [7], [8],
[9], [10]. Most of these protocols focus on prepare and
measure schemes, where single qubits are in transit between
the communication parties Alice and Bob. The security of these
protocols has been discussed in depth and security proofs have
been given for example in [11], [12], [13]. In addition to these
prepare and measure protocols, several protocols based on the
phenomenon of entanglement swapping have been introduced
[14], [15], [16], [17], [18]. In these protocols, entanglement
swapping is used to obtain correlated measurement results
between the legitimate communication parties. In other words,
each party performs a Bell state measurement and due to
entanglement swapping their results are correlated and further
on used to establish a secret key.
Entanglement swapping has been introduced by Bennett et
al. [19], Zukowski et al. [20] as well as Yurke and Stolen
[21], respectively. It provides the unique possibility to generate
entanglement from particles that never interacted in the past.
In detail, Alice and Bob exchange two Bell states of the form
|Φ+⟩12 and |Φ+⟩34 such that afterwards Alice is in possession
of qubits 1 and 3 and Bob of qubits 2 and 4 (cf. (2) in Figure
1). The overall state can now be written as
|Φ+⟩12 ⊗ |Φ+⟩34 = 1
2

|Φ+⟩|Φ+⟩ + |Φ−⟩|Φ−⟩
+|Ψ+⟩|Ψ+⟩ + |Ψ−⟩|Ψ−⟩

1324
(1)
Then, Alice performs a complete Bell state measurement
on the two qubits 1 and 3 in her possession, and at the
same time the qubits 2 and 4 at Bob’s side collapse into
a Bell state although they originated at completely different
sources. Moreover, the state of Bob’s qubits depends on Alice’s
measurement result (cf. (4) in Figure 1). As presented in
eq. (1), Bob always obtains the same result as Alice when
performing a Bell state measurement on his qubits.
So far, it has only been shown that QKD protocols based
on entanglement swapping are secure against intercept-resend
attacks and basic collective attacks (cf. for example [14], [15],
[17]). Therefore, we analyze a general version of a collective
attack where the adversary tries to simulate the correlations
between Alice and Bob [2]. A basic technique to secure these
protocols is to use a basis transformation, usually a Hadamard
operation, similar to the prepare and measure schemes men-
tioned above, to make it easier to detect an adversary. In
[1], the application of general basis transformations about
the angles θA and θB has been discussed and it has been
shown that the information of an adversary can be reduced
to a minimum of ≃ 0.45. Based on these results we analyze
the security of three different protocols with respect to the
137
International Journal on Advances in Systems and Measurements, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/systems_and_measurements/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

simulation attack. In the course of that, we are going to
identify, which values for θA and θB are optimal for these
protocols such that an adversary has only a minimum amount
of information on the secret key.
In the next section, we are going to shortly review the
simulation attack, a generic collective attack strategy where
an adversary applies a six-qubit state to eavesdrop Bob’s mea-
surement result. A detailed discussion of this attack strategy
can be found in [2]. In Section III, we discuss the security
of entanglement swapping based QKD protocols against the
simulation attack in general. Here, we are focusing on the
application of one and two basis transformations and review
the optimal angles for these transformations. In the following
sections, we discuss the application of the simulation attack
on three different protocols: on the prepare & measure QKD
protocol by Bennett, Brassard, and Mermin [5] in Section IV,
on the entanglement swapping based QKD protocol by Song
[17] in Section V and on the QSS protocol by Cabello [16]
in Section VI. We will shortly review each of these protocols
and provide a detailed security analysis with respect to an
application of the simulation attack. At the end, we summarize
the results and give a short outlook on the next steps into this
topic.
II.
THE SIMULATION ATTACK STRATEGY
In entanglement swapping based QKD protocols like [14],
[15], [16], [17], [18] Alice and Bob rest their security check on
the correlations between their respective measurement results
coming from the entanglement swapping (cf. eq. (1)). If these
correlations are violated to a certain amount, Alice and Bob
have to assume that an eavesdropper is present. In 2000,
Zhang, Li, and Guo presented an attack strategy, where Eve
entangles herself with both parties and manages to obtain full
information about the shared key [23]. This collective attack
was improved in a previous article [2] to the simulation attack
and extended to a speciﬁc protocol [18] following this basic
idea: the adversary Eve tries to ﬁnd a multi-qubit state, which
preserves the correlation between the two legitimate parties.
Further, she introduces additional qubits to distinguish between
Alice’s and Bob’s respective measurement results. If she is able
to ﬁnd such a state, Eve stays undetected during her interven-
tion and is able to obtain a certain amount of information
about the key. The simulation attack can be generalized to
arbitrary entanglement swapping based QKD protocols in a
straight forward way, as described in the following paragraphs.
It has been pointed out in detail in [2] that Eve uses
four qubits to simulate the correlations between Alice and
Bob and she further introduces additional systems, i.e., |ϕi⟩,
to distinguish between Alice’s different measurement results.
This leads to the state
|δ⟩ = 1
2

|Φ+⟩|Φ+⟩|ϕ1⟩ + |Φ−⟩|Φ−⟩|ϕ2⟩
|Ψ+⟩|Ψ+⟩|ϕ3⟩ + |Ψ−⟩|Ψ−⟩|ϕ4⟩

P RQST U
(2)
which is a more general version than described in [2]. This
state preserves the correlation of Alice’s and Bob’s measure-
ment results coming from the entanglement swapping (cf. eq.
Alice
Bob
|Φ+⟩
|Φ+⟩
1
2
3
4
(1)
Alice
Bob
Tθ
(2)
Alice
Bob
Tθ
(3)
Alice
Bob
3
1
4
2
|Ψ+⟩
|Ψ+⟩
(4)
Fig. 1.
Illustration of a standard setup for an entanglement swapping based
QKD protocol using a basis transformation Tx.
(1)). From eq. (2) it is easy to see that Alice obtains one of the
four Bell states when performing a Bell state measurement on
qubits P and R. This measurement leaves Bob’s qubits Q and
S in a Bell state fully correlated to Alice’s result. Accordingly,
Eve’s qubits T and U are in one of the auxiliary states |ϕi⟩
she prepared.
Eve has to choose the auxiliary systems |ϕi⟩ such that
⟨ϕi|ϕj⟩ = 0
i, j ∈ {1, ..., 4} i ̸= j
(3)
which allows her to perfectly distinguish between Alice’s and
Bob’s respective measurement results. Thus, she is able to
eavesdrop Alice’s and Bob’s measurement results and obtains
full information about the classical raw key generated out of
them.
In detail, Eve distributes qubits P, Q, R and S between
Alice and Bob such that Alice is in possession of qubits P
and R and Bob is in possession of qubits Q and S. When
Alice performs a Bell state measurement on qubits P and R
the state of qubits Q and S collapses into the same Bell state,
which Alice obtained from her measurement (cf. eq. (2)). In
particular, if Alice obtains |Φ+⟩P R the state of the remaining
qubits is
|Φ+⟩QS|ϕ1⟩T U
(4)
and similarly for Alice’s other results |Φ−⟩ and |Ψ±⟩. This
is the exact correlation Alice and Bob would expect from
entanglement swapping if no adversary is present (cf. eq. (1)
from above). Hence, Eve stays undetected when Alice and
Bob compare some of their results in public to check for
eavesdroppers. The auxiliary system |ϕi⟩ remains at Eve’s side
and its state is completely determined by Alice’s measurement
result. Therefore, Eve has full information on Alice’s and
Bob’s measurement results and is able to perfectly eavesdrop
the classical raw key.
There are different ways for Eve to distribute the state
|δ⟩P −U between Alice and Bob. One possibility is that Eve
is in possession of Alice’s and Bob’s source and generates
|δ⟩P −U instead of Bell states. This is a rather strong as-
sumption because the sources are usually located at Alice’s or
Bob’s laboratory, which should be a secure environment. Eve’s
second possibility is to intercept the qubits 2 and 3 ﬂying from
Alice to Bob and vice versa and to use entanglement swapping
to distribute the state |δ⟩. This is a straight forward method as
already described in [2].
138
International Journal on Advances in Systems and Measurements, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/systems_and_measurements/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

We want to stress that the state |δ⟩ is generic for all
protocols where 2 qubits are exchanged between Alice and Bob
during one round of key generation as, for example, the QKD
protocols presented by Song [17], Li et al. [18] or Cabello
[14]. As already pointed out in [2], the state |δ⟩ can also be
used for different initial Bell states. Regarding protocols with
a higher number of qubits the state |δ⟩ has to be extended
accordingly (cf. Section VI).
III.
SECURITY AGAINST COLLECTIVE ATTACKS
In the following paragraphs, we discuss Eve’s intervention
on an entanglement swapping QKD protocol performing a
simulation attack, i.e., using the state |δ⟩P −U. To detect Eve’s
presence either Alice or Bob or both parties apply a basis
transformation as depicted in Figure 1.
A. General Basis Transformations
Similar to the prepare and measure schemes mentioned in
the introduction, most of the protocols based on entanglement
swapping apply basis transformations to make it easier to de-
tect the presence of an eavesdropper. The basis transformation
most commonly used in this case is the Hadamard operation,
i.e., a transformation from the Z- into the X-basis. In general,
a basis transformation from the Z-Basis into the X-basis can
be described as a combination of rotation operations, i.e.,
Tx

ΘA
ΘB
XPe\
0
Π
4
Π
2
3 Π
4
Π
0
Π
4
Π
2
3 Π
4
Π
0
0.1
0.2
Fig. 3.
Eve’s expected error probability ⟨Pe⟩ if both parties apply a basis
transformation with the respective angles θA and θB.
where h(x) = −x log2 x − (1 − x) log2(1 − x) is the binary
entropy. Looking at ⟨Pe⟩ and H in Figure 2 we see that the
optimal angle for a single basis transformation is π/2, i.e.,
the Hadamard operation, for protocols using only one basis
transformation, as it is already known from literature [15], [2],
[1]. In this case, the average error probability as well as the
Shannon entropy are maximal at ⟨Pe⟩ = 0.25 and H = 0.5
(cf. Figure 2). If only Bob applies the basis transformation,
the calculations run analogous and therefore provide the same
results. Further, Eve’s information on the bits of the secret key
is given by the mutual information
IAE = 1 − H = 1 − 1
2 = 1
2
(13)
which means that Eve has 0.5 bits of information on every
bit of the secret key. Using error correction and privacy
ampliﬁcation Eve’s information can be brought below 1 bit
of the whole secret key as long as the error rate is below
∼ 11% [13]. This is more or less the standard threshold value
for the prepare and measure QKD protocols.
C. Application of Combined Transformations
When both Alice and Bob apply their respective basis
transformation, the overall state changes to
|δ′⟩ = T (1)
x (θA)T (4)
x (θB)|δ⟩1QR4T U
(14)
and after Alice’s Bell state measurement on qubits 1 and R
and Bob’s application of Tx(θB) on qubit Q the state of the
remaining qubits is
cos2 θA − θB
2
|Φ+⟩Q4|ϕ1⟩T U
+ sin2 θA − θB
2
|Φ+⟩Q4|ϕ4⟩T U
−sin

IV.
APPLICATION ON THE BBM PROTOCOL
In 1992, Bennett, Brassard, and Mermin presented a variant
of the Ekert protocol [4], where they show that a test of the
CHSH-inequalities [22] is not necessary for the security of the
protocol [5]. Instead of the CHSH-inequalities, Alice and Bob
use two complementary measurement bases as in the BB84
protocol [3] and randomly apply them on the received qubits.
Due to the entangled state Alice and Bob obtain perfectly
correlated results from their measurement if no adversary is
present.
A. Protocol Description
In detail, Alice and Bob use a source emitting maximally
entangled qubit pairs, e.g., in the Bell-state |Ψ−⟩12. This
source is located between Alice and Bob and one qubit of the
state is ﬂying to Alice and the other one to Bob. When looking
at physical implementations of the BBM protocol the source is
usually located at the laboratory of one of the communication
parties. Hence, we will assume that the source is located at
Alice’s lab and she sends the second qubit of each pair to Bob
(cf. Figure 5). After receiving the qubit, both communication
parties randomly and independently choose either the Z- or
the X-basis to measure their qubit. Due to the entanglement of
the qubits in the state |Ψ−⟩12 Alice’s measurement completely
determines the state of Bob’s qubit, i.e., if Alice measures a |1⟩,
Bob’s qubit is in the state |0⟩, and vice versa. If he measures
in a different basis than Alice, Bob destroys the information
carried by the qubit and thus will not obtain a correlated
result. To identify where they used different bases both parties
publicly compare all of their measurement bases and discard
the results where they had chosen differently. The remaining
results should be perfectly correlated and the communication
parties compare a randomly selected fraction in public. If there
is too much discrepancy between their results they have to
assume that an adversary is present and they start over the
protocol. It has also been shown by Bennett et al. in this paper
that the security of this version of the protocol is equal to the
security of the BB84 scheme [5].
The random measurement in either the Z- and X-basis can
also be interpreted as a random application of the Hadamard
operation by Alice. As pointed out above, the Hadamard
operation is a complete basis transformation from the Z- into
the X-basis, i.e., by an angle θA = π/2. Therefore, it can be
said that both Alice and Bob randomly apply the Hadamard
operation on the qubits they receive and measure it in the Z-
basis afterwards. In the end, both parties compare in public
where they used the Hadamard operation and similar to the
original protocol they discard the results where only one of
them applied the Hadamard operation.
B. Security Analysis
Looking at this interpretation we want to discuss whether
the Hadamard operation is optimal in this scenario. Therefore,
we will discuss the information an eavesdropper Eve is able
to obtain when performing a simulation attack. Further, we
assume that Alice and Bob are not limited to the Hadamard
operation but they use a general basis transformation Tx(θA).
b
b
Alice
Bob
Alice
Bob
|Ψ−⟩
|0⟩
|1⟩
(1)
(2)
Z
Fig. 5.
Illustration of the BBM protocol [5]. Here, Alice performs a
measurement in the Z-basis.
To ﬁt to the setting of the BBM protocol the adversary Eve
has to prepare a slightly different |δ⟩ for the simulation attack,
i.e.,
|δ⟩RST =
1
√
2

|0⟩|1⟩|ϕ1⟩ + |1⟩|0⟩|ϕ2⟩

RST
(19)
This state perfectly simulates the correlation between Alice’s
and Bob’s result in case they do not apply any operation. As
described above, the auxiliary states |ϕ1⟩ and |ϕ2⟩ have to be
orthogonal (cf. eq. (3)) such that they can be distinguished
by Eve. For reasons of simplicity, we will assume that Eve
intercepts the qubits coming from Alice and uses entanglement
swapping on qubits 2 and R to establish the state |δ⟩1ST
between Alice and Bob, where Bob is now in possession of
qubit S.
Following the protocol Alice and Bob randomly perform the
basis transformation Tx(θA) on their respective qubits 1 and
S. Since they discard all results where just one of them applies
Tx(θA) we are only interested in two scenarios: either none
or both of them perform Tx(θA). In scenario one, it is easy to
see from the structure of the state |δ⟩1ST that Eve’s qubits are
in the state |ϕ1⟩T whenever Alice obtains |0⟩ and in the state
|ϕ2⟩T whenever Alice obtains |1⟩. In this case Eve is able to
perfectly eavesdrop the respective raw key bits.
In the second scenario, the application of the basis trans-
formation Tx(θA) on qubits 1 and S changes the overall state
to
|δ′⟩ = Tx(θA)(1)|δ⟩1ST ,
(20)
where the superscript ”(1)” denotes an application on qubit 1.
This results in the state
1
√
2

sin θA
2

|00⟩|ϕ2⟩ + |11⟩|ϕ1⟩

+ cos θA
2

|01⟩|ϕ1⟩ − |10⟩|ϕ2⟩

(21)
before Alice performs her measurement on qubit 1. Assuming
Alice obtains |0⟩1 from her measurement and Bob applies
Tx(θA) on qubit S this changes the state described in the
previous equation into
sin θA
2
|0⟩S|ϕ1⟩T + sin θA
2
|0⟩S|ϕ2⟩T
− cos2 θA
2 |1⟩S|ϕ1⟩T + sin2 θA
2 |1⟩S|ϕ2⟩T
(22)
From this expression we can directly see that Bob obtains
from his Bell state measurement either the correlated result
141
International Journal on Advances in Systems and Measurements, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/systems_and_measurements/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

|1⟩S with probability

cos2 θA
2
2
+

sin2 θA
2
2
= 3 + cos(2θA)
4
(23)
or an error, i.e., the state |0⟩S, otherwise. Hence, Eve intro-
duces an error with probability (sin2 θA)/2, which yields an
expected error probability
⟨Pe⟩ = sin2 θA
4
(24)
These are the same results as described in Section III-B above
(cf. eq. (10)). Accordingly, performing the same computations
as above, we obtain the mutual information IAE, i.e., the
information Eve is able to obtain about the raw key, as
IAE = 1 − H = 1 − 1
2 h

cos2 θA
2

(25)
which is equal to the general result in eq. (13) from Section
III-B. Hence, we can conclude that for the BBM protocol the
optimal choice is a basis transformation about an angle θA =
π
2 , i.e., the Hadamard operation.
V.
APPLICATION ON SONG’S QKD PROTOCOL
In 2004, Song published a QKD scheme based on en-
tanglement swapping, which is supposed to spare alternative
measurements [17]. In this scheme Song uses a rather unusual
basis transformation (compared to the Hadamard operation
most commonly used in other protocols) with θ = 2π/3.
Hence, based on the discussions in the previous sections it
is indicated that the security of the protocol can be further
increased by using a different angle θ.
A. Protocol Description
In each round of the protocol, Alice and Bob prepare two
qubits in their laboratories, which are either in the Bell basis
or in a transformed basis. The transformation is done by the
operation T = Tx(2π/3), which is denoted in matrix form as
T = 1
2

1
√
3
√
3
−1

(26)
Alice and Bob prepare random Bell states and then randomly
choose between applying 1 or T onto qubit 2 and 4, respec-
tively, in their possession. The application of T changes |Φ±⟩
to |η±⟩ and |Ψ±⟩ to |ν±⟩, where the state in the alternative
basis are denoted as
|η±⟩ = 1
2|Φ∓⟩ +
√
3
2 |Ψ±⟩
|ν±⟩ =
√
3
2 |Φ±⟩ − 1
2|Ψ∓⟩.
(27)
For our further discussion suppose that Alice prepares
|Ψ+⟩12 and Bob prepares |Φ−⟩34. Additionally, Bob applies
T onto qubit 4 such that |Φ−⟩34 is changed into |η−⟩34 (cf.
(1) and (2) in Figure 6). The two parties exchange qubits 2
and 4 and publicly conﬁrm the arrival of the respective qubit.
Alice
Bob
T
|Ψ+⟩
|Φ−⟩
1
2
4
3
(1)
Alice
Bob
T
|Ψ+⟩
|η−⟩
(2)
Alice
Bob
|Ψ+⟩
|Φ−⟩
(3)
Alice
Bob
|Φ−⟩
|Ψ+⟩
(4)
Fig. 6.
Illustration of the protocol presented by Song [17]. Here, only Bob
applies the basis transformation onto his qubit.
Before measuring, Alice and Bob announce publicly whether
they applied the basis transformation T or not. If one party
performed the basis transformation, the other party reverses
the transformation by applying T onto the received qubit. In
our case Alice applies T on qubit 4 (cf. (2) in Figure 6).
Then, both parties perform Bell state measurements on the
qubits in their possession. Based on their own outcome of the
Bell state measurement both parties can compute each other’s
result. Following our example, if Alice obtains |Φ−⟩14, Bob
obtains |Ψ+⟩23.
B. Security Analysis
Song discussed a basic version of an intercept-resend attack
as well as the ZLG attack [23] in his article [17] and showed
in principle that the protocol is secure against this kind of
attack. Nevertheless, he gave no expected error rate or mutual
information for Eve, which would be of great interest since the
operation T is an unusual basis transformation by an angle of
2π/3 and is different from the more common choice of the
Hadamard operation. Hence, we are going to look at these
values in detail in the next paragraphs.
Due to arguments discussed in Section III above, we can
immediately show that Song’s protocol is completely open to
the simulation attack when Alice does not apply the trans-
formation T . In this case, Alice and Bob just perform the
entanglement swapping and Eve can intercept qubits 2 and
4 in transit. As it is described in detail above, Eve distributes
the state |δ⟩ from eq. (2) between Alice, Bob and herself using
entanglement swapping and sends qubits Q to Bob and S to
Alice, respectively (cf. (1) in Figure 7). When Alice and Bob
perform their Bell state measurements, the correlation between
their results is preserved due to the structure of the state |δ⟩.
After Alice and Bob are ﬁnished Eve is able to obtain full
information about Alice’s and Bob’s secret measurement based
on the state of qubits T and U in her possession.
If either Alice or Bob performs the transformation T , we
have the scenario described in Section III. Eve is not able
to compensate the random application of the transformation
while still preserving the correlation when T is not applied.
Hence, Eve’s intervention introduces an error, i.e., the parties
do not obtain correlated results all the time. Taking the example
from Section III above, Bob applies T onto qubit 4 and
therefore Alice also applies T onto qubit S she receives from
142
International Journal on Advances in Systems and Measurements, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/systems_and_measurements/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Eve (cf. (2) in Figure 7). When Alice obtains |Φ−⟩1S from
her measurement Bob obtains the correlated result |Ψ+⟩23
only with probability 5/8. In other words, Eve introduces an
error with probability 3/8, which leads to an expected error
probability for this scenario of
⟨Pe⟩ = 1
4 sin2 2π
3 = 3
16
(28)
which is signiﬁcantly lower than 1/4. Hence, Eve has a better
opportunity to eavesdrop the key in this protocol than, for
example, in the revised version of the Cabello protocol [15]
or the protocol by Li et al [18]. Due to the fact that the
transformation T maps onto an unbiased superposition of states
(cf. eq. (27) above) Eve is able to extract more information
than usual from her attack strategy. The Shannon entropy for
the simulation attack on Song’s protocol is
H = 1
2 h

cos2 π
3

= 1
8

2 + 3 log 4
3

(29)
which further leads to Eve’s mutual information
IAE = 1 − H

TABLE I.
ALICE’S GHZ STATE AFTER BOB’S AND CHARLIE’S
MEASUREMENT.
|Φ+⟩4A
|Φ−⟩4A
|Ψ+⟩4A
|Ψ−⟩4A
|Φ+⟩5B
|P +
00⟩1CD
|P −
00⟩1CD
|P +
10⟩1CD
|P −
10⟩1CD
|Φ−⟩5B
|P −
00⟩1CD
|P +
00⟩1CD
|P −
10⟩1CD
|P +
10⟩1CD
|Ψ+⟩5B
|P +
01⟩1CD
|P −
01⟩1CD
|P +
11⟩1CD
|P −
11⟩1CD
|Ψ−⟩5B
|P −
01⟩1CD
|P +
01⟩1CD
|P −
11⟩1CD
|P +
11⟩1CD
A. Protocol Description
As already pointed out in the previous paragraph the original
protocol by Cabello [16] is not secure and thus we will discuss
the revised version given in [25] here. The revised version
in general uses the Quantum Fourier Transformation (QFT)
deﬁned as
|j⟩
QF T
7−→
1
√
N
N−1
X
k=0
e2Πijk/N |k⟩
(34)
to secure the qubits in transit (cf. for example [26] for details
on the QFT). Since we are using qubits, the dimension N = 2
and the QFT reduces to the Hadamard operation for this special
case. Therefore, we will use the Hadamard operation in the
following considerations.
In this protocol, three parties are involved, which are able to
distribute a key among them or share a secret between two of
them. The aim is to use the 3-qubit entanglement of the GHZ
state to achieve these tasks. Therefore, Alice, Bob, and Charlie
are in possession of an entangled pair, i.e., |Φ+⟩12, |Φ+⟩4C,
and |Φ+⟩5D, respectively. Further, Alice generates the GHZ
state |P +
00⟩3AB at her side. She keeps qubit 3 of the GHZ state
and sends qubits A and B to Bob and Charlie, respectively.
At the same time, Bob and Charlie send their respective qubits
C and D to Alice (cf. (1) in Figure 8). Additionally, Bob and
Charlie randomly apply the Hadamard operation on qubits 4
and 5 still in their possession. After Alice received the qubits
from Bob and Charlie she performs a Bell state measurement
on qubits 2 and 3 and Bob and Charlie act similarly on their
qubits 4 and A as well as 5 and B, respectively (cf. (2) in
Figure 8). If both Bob and Charlie do not apply the Hadamard
operation, the protocol is the same as in the original version by
Cabello [16]. If either of them applies the Hadamard operation
onto his qubit the GHZ state after Bob’s measurement is altered
as
1
2

|Φ+⟩4A
1
√
2

where |δ1⟩ - |δ4⟩ are deﬁned as
|δ1⟩ = 1
2

if Bob’s result is |Ψ+⟩4E2. Hence, at this time Eve obtains
from a measurement on qubits E3 and E4 either |ϕ1⟩E3E4 or
|ϕ4⟩E3E4 but both do not correspond to Bob’s result. Thus,
the best strategy for Eve is to delay her measurement until she
knows whether Bob applied the basis transformation Tx(θB)
or not, as described below. Similarly, if just Charlie applies
Tx(θC) the overall state after Bob’s result |Ψ+⟩4E2 is
|ϕ3⟩ ⊗ Tx(θC)|δ3⟩
(42)
with
Tx(θC)|δ3⟩ =
1
2

|Φ+⟩

cos θC
2 |ϕ6⟩|P −
10⟩ + sin θC
2 |ϕ7⟩|P +
11⟩

+|Φ−⟩

cos θC
2 |ϕ5⟩|P +
10⟩ + sin θC
2 |ϕ8⟩|P −
11⟩

+|Ψ+⟩

cos θC
2 |ϕ8⟩|P −
11⟩ + sin θC
2 |ϕ5⟩|P +
10⟩

+|Ψ−⟩

cos θC
2 |ϕ7⟩|P +
11⟩ + sin θC
2 |ϕ6⟩|P −
10⟩

(43)
In this case, Eve obtains the same result as Bob but further on
her measurement on qubits E7E8 yields a result uncorrelated
to Charlie’s measurement outcome due to his basis transfor-
mation. In the last case where both Bob and Charlie apply
their basis transformations Tx(θB) and Tx(θC), respectively,
the overall state changes to
sin θB
2 |ϕ1⟩ ⊗ Tx(θC)|δ1⟩ + cos θB
2 |ϕ4⟩ ⊗ Tx(θC)|δ4⟩
(44)
in case Bob obtains |Ψ+⟩4E2 from his measurement. From eq.
(43) above we can see that after Charlie’s measurement the
state of the remaining qubits is
sin θB
2 |ϕ1⟩

cos θC
2 |ϕ5⟩|P +
00⟩ + sin θC
2 |ϕ8⟩|P −
01⟩

+ cos θB
2 |ϕ4⟩

cos θC
2 |ϕ5⟩|P −
10⟩ + sin θC
2 |ϕ8⟩|P +
11⟩

(45)
assuming Charlie obtains |Φ−⟩5E6. It is described in eq. (45)
that Eve’s results are completely uncorrelated to the two
secret results of Bob and Charlie. Thus, the optimal strategy
for Eve is to delay her measurements on qubits E3E4 and
E7E8 until Bob and Charlie ﬁnished their measurements and
publicly announce their choice regarding the application of the
Hadamard operation. Eve performs the measurement on her
qubit pairs afterwards, obtaining Bob’s and Charlie’s result
only with a certain probability.
In all three cases discussed in the previous paragraphs, Alice
applies the operation Tx(θB) on qubits E10 and operation
Tx(θC) on E11, respectively, to reverse the effect of Bob’s
and Charlie’s operations. This changes the GHZ state into
a superposition of GHZ states. Hence, Alice obtains a GHZ
state corresponding to Bob’s and Charlie’s secrets only to a
certain amount. Following our example where only Bob used
the Hadamard operation as described in eq. (41) we see after
a little calculation that for Charlie’s result |Φ−⟩5E6 the state
of the remaining qubits is
sin θB
2 |ϕ1⟩E3E4|ϕ6⟩E7E8|P −
00⟩1E10E11
+ cos θB
2 |ϕ4⟩E3E4|ϕ6⟩E7E8|P +
10⟩1E10E11
(46)
Therefore, Alice obtains the GHZ state correlated to Bob’s and
Charlie’s result only with a certain probability. Hence, Eve’s
intervention introduces on average an error rate of

Pe

= 1
4 sin2 θB + 1
4 sin2 θC − 1
16 sin2 θB sin2 θC
(47)
Furthermore, Eve’s results are correlated to Bob’s and Charlie’s
results only with a certain probability such that she is not able
to obtain much information about Alice’s secret. In detail, the
Shannon entropy for Alice, Bob, and Charlie is
H = 7
16

h

ΘB
ΘC
XPe\
0
Π
4
Π
2
3 Π
4
Π
0
Π
4
Π
2
3 Π
4
Π
0
0.1
0.2
0.3
0.4
Fig. 10.
Eve’s expected error probability ⟨Pe⟩ if both parties apply a basis
transformation with the respective angles θB and θC.
Whenever Bob chooses to use the basis transformation
Tx(θB) the exact state of the remaining qubits is of the form
described in eq. (41), if he obtained |Ψ+⟩4E2. Since Charlie is
fully aware of his measurement results the scenario is equal to
the attack of an external adversary if only Bob applies the basis
transformation. Therefore, based on the calculations above, we
see that Eve introduces an average error rate

Pe

= 1
4 sin2 θB
(52)
similar to the probability in eq. (10) above. Hence,

Pe

becomes maximal with θB = π/2 such that

Pe

= 1
4
(53)
Accordingly, the Shannon entropy for Alice and Bob is
H = 1
2 h

cos2 θB
2

(54)
also taking its maximum with θB = π/2 such that
H = 1
2 h
1
2

= 1
2
(55)
leaving Eve’s mutual information at
IAE = 1 − H = 1 − 1
2 = 1
2
(56)
which is equal to the results from the previous sections.
VII.
CONCLUSION AND FURTHER RESEARCH
In this article, we discussed the optimality of basis transfor-
mations to secure entanglement swapping based QKD proto-
cols. Starting from a generic entanglement swapping scenario,
we used a collective attack strategy to analyze the amount
of information an adversary is able to obtain. We showed
that in case only one party applies a basis transformation,
the operation Tx(θA) reduces to the Hadamard operation, i.e.,
the angle θA = π/2 allows a maximal mutual information of
IAE = 0.5. Whereas, the main result of this article is the fact
that if both parties apply a transformation, the optimal choice
for the angles θA and θB describing the basis transformations
ΘB
ΘC
H
0
Π
4
Π
2
3 Π
4
Π
0
Π
4
Π
2
3 Π
4
Π
0
0.2
0.4
0.6
0.8
Fig. 11.
Eve’s Shannon entropy ⟨Pe⟩ if both parties apply a basis
transformation with the respective angles θB and θC.
is θA = π/4 and θB = π/2. As a consequence, this decreases
the mutual information of an adversary further to IAE ∼ 0.45,
which improves the security.
Additionally, we discussed 3 different protocols, the BBM
protocol [5], Song’s QKD protocol [17] and Cabello’s QSS
protocol [16] to show how the simulation attack is applied
on various kinds of protocols. We showed that for the BBM
protocol the optimal angle for the basis transformation is π/2,
i.e., the Hadamard operation, due to the fact that no entangle-
ment swapping is performed and a measurement on only one
entangled state is applied. Nevertheless, the simulation attack
describes the most general collective attack strategy on this
kind of protocol.
Regarding Song’s QKD protocol we were able to show that
the basis transformation by an angle 2π/3 is by no means
optimal. Using the results from the simulation attack, the
optimal choice for a basis rotation is to use two different angles
π/2 and π/4 to reduce Eve’s mutual information about the raw
key by about 25% from 0.594 to ≃ 0.45 and thus increasing
the security.
Looking at a QSS protocol instead of a key distribution
protocol we examined the application of the simulation attack
on Cabello’s QSS protocol. In this case, the optimal angle
for the basis transformation is again π/2, i.e., the Hadamard
operation. This is true for Bob’s and Charlie’s basis transfor-
mation since both operations act separately on the GHZ state in
Alice’s possession. Nevertheless, the average error probability
and Alice’s, Bob’s, and Charlie’s Shannon entropy are rather
high with

Pe

= 7/16 and H = 7/8, respectively, for an
adversary from the outside. Dealing with an adversary form
the inside, i.e., a malicious Charlie, π/2 is still optimal. This
reduces the average error probability and the Shannon entropy
to the more common

Pe

= 1/4 and H = 1/2, respectively,
because Charlie has to cope with Bob’s basis transformation
alone.
The next questions arising directly from these results are
how, if at all, the results change if basis transformations from
the Z- into the Y -basis are applied. A ﬁrst inspection shows
that such basis transformations can not be plugged in directly
into this framework. Hence, besides the transformation from
the Z- into the Y - basis, the effects of the simpler rotation
147
International Journal on Advances in Systems and Measurements, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/systems_and_measurements/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

operations on the results have to be inspected during further
research. Since basis transformations can be described in terms
of rotation operations it could be easier to apply rotation
operations in this framework. Nevertheless, due to the similar
nature of basis transformations and rotation operations it can
be assumed that the results will be comparable to the results
presented here.
To keep the setting as general as possible, a further main
goal is to allow Alice and Bob to use arbitrary unitary
operations instead of just basis transformations to secure the
protocol. This should make it even more difﬁcult for Eve to
gain information about the raw key.
ACKNOWLEDGMENTS
We would like to thank Christian Kollmitzer, Oliver Mau-
rhart as well as Beatrix Hiesmayr and Marcus Huber for
fruitful discussions and interesting comments.
REFERENCES
[1]
S. Schauer and M. Suda, “Security of Entanglement Swapping QKD
Protocols against Collective Attacks,” in ICQNM 2012 , The Sixth
International Conference on Quantum, Nano and Micro Technologies.
IARIA, 2012, pp. 60–64.
[2]
——, “A Novel Attack Strategy on Entanglement Swapping QKD
Protocols,” Int. J. of Quant. Inf., vol. 6, no. 4, pp. 841–858, 2008.
[3]
C. H. Bennett and G. Brassard, “Public Key Distribution and Coin
Tossing,” in Proceedings of the IEEE International Conference on
Computers, Systems, and Signal Processing.
IEEE Press, 1984, pp.
175–179.
[4]
A. Ekert, “Quantum Cryptography Based on Bell’s Theorem,” Phys.
Rev. Lett., vol. 67, no. 6, pp. 661–663, 1991.
[5]
C. H. Bennett, G. Brassard, and N. D. Mermin, “Quantum Cryptography
without Bell’s Theorem,” Phys. Rev. Lett., vol. 68, no. 5, pp. 557–559,
1992.
[6]
D. Bruss, “Optimal Eavesdropping in Quantum Cryptography with Six
States,” Phys. Rev. Lett, vol. 81, no. 14, pp. 3018–3021, 1998.
[7]
A. Muller, H. Zbinden, and N. Gisin, “Quantum Cryptography over 23
km in Installed Under-Lake Telecom Fibre,” Europhys. Lett., vol. 33,
no. 5, pp. 335–339, 1996.
[8]
A. Poppe, A. Fedrizzi, R. Usin, H. R. B¨ohm, T. Lor¨unser, O. Maurhardt,
M. Peev, M. Suda, C. Kurtsiefer, H. Weinfurter, T. Jennewein, and
A. Zeilinger, “Practical Quantum Key Distribution with Polarization
Entangled Photons,” Optics Express, vol. 12, no. 16, pp. 3865–3871,
2004.
[9]
A. Poppe, M. Peev, and O. Maurhart, “Outline of the SECOQC
Quantum-Key-Distribution Network in Vienna,” Int. J. of Quant. Inf.,
vol. 6, no. 2, pp. 209–218, 2008.
[10]
M. Peev, C. Pacher, R. All´eaume, C. Barreiro, J. Bouda, W. Boxleitner,
T. Debuisschert, E. Diamanti, M. Dianati, J. F. Dynes, S. Fasel, S. Fos-
sier, M. F¨urst, J.-D. Gautier, O. Gay, N. Gisin, P. Grangier, A. Happe,
Y. Hasani, M. Hentschel, H. H¨ubel, G. Humer, T. L¨anger, M. Legr´e,
R. Lieger, J. Lodewyck, T. Lor¨unser, N. L¨utkenhaus, A. Marhold,
T. Matyus, O. Maurhart, L. Monat, S. Nauerth, J.-B. Page, A. Poppe,
E. Querasser, G. Ribordy, S. Robyr, L. Salvail, A. W. Sharpe, A. J.
Shields, D. Stucki, M. Suda, C. Tamas, T. Themel, R. T. Thew,
Y. Thoma, A. Treiber, P. Trinkler, R. Tualle-Brouri, F. Vannel, N. Wa-
lenta, H. Weier, H. Weinfurter, I. Wimberger, Z. L. Yuan, H. Zbinden,
and A. Zeilinger, “The SECOQC Quantum Key Distribution Network
in Vienna,” New Journal of Physics, vol. 11, no. 7, p. 075001, 2009.
[11]
N. L¨utkenhaus, “Security Against Eavesdropping Attacks in Quantum
Cryptography,” Phys. Rev. A, vol. 54, no. 1, pp. 97–111, 1996.
[12]
——, “Security Against Individual Attacks for Realistic Quantum Key
Distribution,” Phys. Rev. A, vol. 61, no. 5, p. 052304, 2000.
[13]
P. Shor and J. Preskill, “Simple Proof of Security of the BB84 Quantum
Key Distribution Protocol,” Phys. Rev. Lett., vol. 85, no. 2, pp. 441–444,
2000.
[14]
A. Cabello, “Quantum Key Distribution without Alternative Measure-
ments,” Phys. Rev. A, vol. 61, no. 5, p. 052312, 2000.
[15]
——, “Reply to ”Comment on ”Quantum Key Distribution without
Alternative Measurements””,” Phys. Rev. A, vol. 63, no. 3, p. 036302,
2001.
[16]
——, “Multiparty Key Distribution and Secret Sharing Based on
Entanglement Swapping,” quant-ph/0009025 v1, 2000.
[17]
D. Song, “Secure Key Distribution by Swapping Quantum Entangle-
ment,” Phys. Rev. A, vol. 69, no. 3, p. 034301, 2004.
[18]
C. Li, Z. Wang, C.-F. Wu, H.-S. Song, and L. Zhou, “Certain Quantum
Key Distribution achieved by using Bell States,” International Journal
of Quantum Information, vol. 4, no. 6, pp. 899–906, 2006.
[19]
C. H. Bennett, G. Brassard, C. Crepeau, R. Jozsa, A. Peres, and W. K.
Wootters, “Teleporting an Unknown Quantum State via Dual Classical
and EPR Channels,” Phys. Rev. Lett., vol. 70, no. 13, pp. 1895–1899,
1993.
[20]
M. Zukowski, A. Zeilinger, M. A. Horne, and A. K. Ekert, “”Event-
Ready-Detectors” Bell State Measurement via Entanglement Swap-
ping,” Phys. Rev. Lett., vol. 71, no. 26, pp. 4287–4290, 1993.
[21]
B. Yurke and D. Stolen, “Einstein-Podolsky-Rosen Effects from Inde-
pendent Particle Sources,” Phys. Rev. Lett., vol. 68, no. 9, pp. 1251–
1254, 1992.
[22]
J. F. Clauser, M. A. Horne, A. Shimony, and R. A. Holt, “Proposed
Experiment to Test Local Hidden-Variable Theories,” Phys. Rev. Lett.,
vol. 23, no. 15, pp. 880–884, 1969.
[23]
Y.-S. Zhang, C.-F. Li, and G.-C. Guo, “Comment on ”Quantum Key
Distribution without Alternative Measurements”,” Phys. Rev. A, vol. 63,
no. 3, p. 036301, 2001.
[24]
D. Greenberger, M. A. Horne, and A. Zeilinger, “Going beyond Bell’s
Theorem,” in Bell’s Theorem, Quantum Theory and Conceptions of the
Universe, M. Kafatos, Ed.
Kluwer, 1989, pp. 69–72.
[25]
J. Lee, S. Lee, J. Kim, and S. D. Oh, “Entanglement Swapping Secures
Multiparty Quantum Communication,” Phys. Rev. A, vol. 70, no. 3, p.
032305, 2004.
[26]
M. A. Nielsen and I. L. Chuang, Quantum Computation and Quantum
Information.
Cambridge University Press, 2000.
148
International Journal on Advances in Systems and Measurements, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/systems_and_measurements/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

