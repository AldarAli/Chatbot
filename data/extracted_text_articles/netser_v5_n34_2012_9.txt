269
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Random Matrix Theory applied to the Estimation of
Collision Multiplicities
Benoˆıt Escrig
IRIT Laboratory
Universit´e de Toulouse
Toulouse, France
E-mail: escrig@enseeiht.fr
Abstract—This paper presents two techniques in order to
estimate the collision multiplicity, i.e., the number of users
involved in a collision [1]. This estimation step is a key task
in multi-packet reception approaches and in collision resolution
techniques. The two techniques are proposed for IEEE 802.11
networks but they can be used in any OFDM-based system.
The techniques are based on recent advances in random matrix
theory and rely on eigenvalue statistics. Provided that the
eigenvalues of the covariance matrix of the observations are
above a given threshold, signal eigenvalues can be separated
from noise eigenvalues since their respective probability density
functions are converging toward two different laws: a Gaussian
law for the signal eigenvalues and a Tracy-Widom law for the
noise eigenvalues. The ﬁrst technique has been designed for the
white noise case, and the second technique has been designed
for the colored noise case. The proposed techniques outperform
current estimation techniques in terms of mean square error.
Moreover, this paper reveals that, contrary to what is generally
assumed in current multi-packet reception techniques, a single
observation of the colliding signals is far from being sufﬁcient to
perform a reliable estimation of the collision multiplicities.
Index Terms—multi-packet reception; collision multiplicity;
model order selection; IEEE 802.11-based networks
I. INTRODUCTION
Collisions are known to degrade the throughput of random
access wireless networks, such as ad hoc networks1. A colli-
sion occurs when two or more user nodes access the channel
simultaneously. Over the last decades, Medium Access Control
(MAC) protocols have been designed with the rationale that
all data packets from the colliding user nodes are lost when a
collision occurs because the signals from all users mix.
It is is possible to retrieve part of the data packets that are
involved in a collision, with approaches such as the capture
effect [2]–[5]. Sophisticated techniques based on Multi-User
Detection (MUD) allow the decoding of more than one data
packets. MUD receivers have been successfully implemented
in a wide range of application areas [6]. In this context,
the number of colliding user is often needed to efﬁciently
parameterize the MUD receivers.
Another approach is often invoked when a collision occurs.
It consists in triggering a collision resolution (CR) mechanism
where transmissions from the colliding users are re-scheduled
1In infrastructure-based networks, multiplexing techniques allow a fair
bandwidth allocation among the users without any risk of collision.
in order to avoid another collision [2], [7]–[10]. In this context,
CR mechanisms operate more efﬁciently when the number
of colliding user is known. For instance, one could increase
the contention window of a CR protocol with respect to the
estimate of the number of colliding nodes. Note that our
intention is not to propose a new CR mechanism but rather
to provide a new parameter to improve the tuning of the
mechanisms.
So, the purpose of this study is to estimate the number
of colliding users, i.e., the collision multiplicity (CM) [1].
We focus here on the following scenario. The receiver at the
destination node is processing a collision signal that consists
of a mixture of signals from all users plus some Additive
White Gaussian Noise (AWGN). The destination node is the
node toward which all users involved in the collision are
intending to send data 2. So, from the observations of mixtures,
the destination node has to estimate the number of original
signals. This problem is a typical Model Order Selection
(MOS) problem. MOS problems arise in the signal processing
area and related areas such as signal array processing, radar,
and sonar processing.
The MOS techniques are all based on the following ratio-
nale: the mixture of signals and noise can be decomposed
into a noise subspace and a signal subspace, and the dimen-
sion of the signal subspace equals the number of signals.
In order to perform this separation, the following steps are
implemented. First, T observations of the mixture are gathered
by the processing node. Then, the sample covariance matrix
(SCM) of these observations is computed and an eigenvalue
decomposition of this matrix is performed. These observations
are obtained over T time-slots. The MOS techniques use the
property that signal eigenvalues are much higher than noise
eigenvalues, provided that the Signal to Noise Ratio (SNR) is
high enough. When T eigenvalues are available and when K
eigenvalues are signiﬁcantly higher than the T −K remaining
eigenvalues, the conclusion is that there are K signals in the
mixture.
The proposed approach has also been motivated by the
following two observations: (i) many CM estimation tech-
niques are based on the assumption that signal samples are
2There are scenarios in which a collision occures between several source
nodes transmitting toward several destination nodes. These scenarios are not
addressed in this paper

270
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
uniformly distributed over a ﬁnite alphabet, i.e., signal samples
are modulation symbols such as PSK or QAM symbols [11]–
[13], and (ii) in many existing techniques, the number of
observations is not much greater that the number of signals
[7], [8].
Our point concerning (i) is to design estimation techniques
that could be used in the context of Gaussian distributed
samples. In this paper, we focus on the wireless standards that
implement Orthogonal Frequency Division Multiplex (ODFM)
transmissions; so signal samples can be considered as being
Gaussian distributed and not uniformly distributed.3 The issue
that derives from (ii) is to clarify whether the number of
observations can be made as small as K + 1 or K + 2 as
in [7], [8] or not. Indeed, assuming that T and K are on the
same order is in stark contrast with the typical assumptions
that are used in signal processing [14]–[17].
We shall show that the proposed techniques outperform
current techniques in terms of Mean Square Error (MSE) and
that the number of observations T should be much higher than
the number of signals K in order to obtain satisfactory MSE
performance.
The rest of the paper is organized as follows. The in-
troduction end ups with a Related Work subsection. The
system model is introduced in Section II and some results
on eigenvalue statistics are stated in Section III. The CMETs
are described in Section IV. Simulation results are presented
in Section V and a conclusion is drawn in the last section.
Related work
The ﬁrst contributions, in the ﬁeld of eigenvalue-based MOS
techniques, were developed by Bartlett [18] and Lawley [19].
They propose a subjective setting of the threshold that is
used to separate signal eigenvalues from noise eigenvalues.
This approach is still used in some CR mechanisms [7], [8]
in order to minimize the number of observations T. The
algorithm starts with T = 1 and the number of observations is
incremented by one each time the smallest eigenvalue is higher
than a noise threshold. As soon as the smallest eigenvalue
crosses the noise threshold at step T, that means that the
T th highest eigenvalue is a noise eigenvalue, and hence that
there are T − 1 signals. Information theoretic criteria such
as the Akaike Information Criterion (AIC) and the Minimum
Description Length (MDL), developed by Wax and Kailath
[17], have then been proposed in order to alleviate the limiting
constraint imposed by the subjective setting of the separation
threshold. The criteria are usually composed of a function
that depends on the maximum likelihood estimator of the
parameters of the model and a term that adjusts the ﬁrst
component to the context. This second term depends on the
parameters of the system such as the number of samples per
observation. The MDL have been used over several decades
in several areas. An interesting review of this criterion can be
found in [16].
3Note that signal samples in Code Division Multiple Access (CDMA) sys-
tems are also uniformly distributed since modulation symbols are multiplied
by +1/ − 1 spreading codes.
The MDL is a consistent estimator of the number of signals
when the number of observations, T, is ﬁxed and when the
number of samples per observations, denoted m, is such that
m → +∞, provided that T is much larger than the number
of signals K. Two limitations have recently been pointed out
for this criterion.
First, the MDL have been shown to be inconsistent as the
variance of the noise tends toward zero [15]. Second, the
MDL is based on the distribution of the signal eigenvalues. It
uses the property that sample eigenvalues, i.e., the eigenvalues
that are obtained from the eigenvalue decomposition, are sym-
metrically distributed around the population eigenvalues, i.e.,
the theoretical eigenvalue. Basically, all the above-mentioned
techniques are based on this property about signal eigenval-
ues. This centrality assumption makes sense in the T ﬁxed,
m → +∞ case. However, when T and m are on the same
order, even when T, m → +∞, the previous property is no
longer valid.
Recent advances in the Random Matrix Theory (RMT) ﬁeld
have brought into light several properties on the distribution of
both signal and noise eigenvalues [20], [21]. These properties
have been used in order to design new MOS techniques in the
context where T, m → +∞ [16], [22]. These new techniques
have been shown to outperform the classical MDL estimator.
Our purpose in this paper is to use these new properties in
order to design new CM estimation techniques. Note that we
are not in the context where T, m → +∞ but rather in the
T ﬁxed, m → +∞ case. The point is that current estimation
techniques, whether they are based on the RMT or not, are
based on the assumption that the number of observations T
is much larger than the number of signals K. In our context,
we want to minimize T with respect to K, so we are dealing
with a context where T is in the order of K. Since the new
RMT-based MOS techniques are performing in a wider range
of parameter values, we believe that they can be considered
as relevant candidates for our objective.
II. SYSTEM MODEL
In this paper, we take in interest collision resolution al-
gorithms and, more precisely, the estimation of the number
of stations that are involved in a collision. We consider the
scenario where K stations are simultaneously transmitting data
packets to the same destination node (see Fig. 1).
We assume that the destination code and the colliding
stations are all equipped with a single antenna. This is a
worst case scenario. When the destination node is equipped
with several antennas, observations are gathered more rapidly.
The K colliding stations are transmitting OFDM frames of
m samples each. The OFDM signal samples are Gaussian
distributed with zero mean and variance unity. Moreover,
the OFDM signals from the colliding users are assumed to
be uncorrelated. This assumption makes sense since each
transmission is affected by both a different Doppler shift and
a different Doppler spread. The destination node receives T
observations. So it is assumed that the destination can trigger
transmissions from the colliding nodes. Note that T must be

271
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Fig. 1.
Collision Scenario with K = 3 colliding nodes.
larger than K to allow an efﬁcient estimation of K. This will
be discussed in the simulation section. The destination triggers
transmissions from the colliding users by sending a feedback
frame. This frame serves also as a synchronization frame for
user transmissions. Hence, the K users can be assumed to be
coarsely synchronized in time. So this system model is similar
to a source separation problem when K signals are impinging
on a T sensor array. The T × 1 observation vectors yi can be
written as
yi = Axi + bi,
i = 0, 1, . . . , m
(1)
where xi ∼ CNK(0, Rx) are K×1 complex Gaussian vectors
with zero mean and covariance matrix Rx, bi ∼ CNT (0, Rb)
are T × 1 complex noise vectors that are Gaussian distributed
with zero mean and noise covariance matrix Rb. In the case of
a white noise, we have that Rb = σ2IT where σ2 denotes the
noise variance and IT is the T ×T identity matrix. The channel
matrix A is considered as an unknown T × K non-random
matrix. For our study, we assume that the coefﬁcients of
A are modeled as circularly symmetric Gaussian coefﬁcients
with power unity (Rayleigh fading). The channels gains are
assumed to have constant values over the duration of the
frame and change randomly from one frame to another. This
corresponds to the typical block-fading channel assumption.
The observations yi can be whitened by the following
transformation
y†
i = R−1/2
b
yi
provided that the noise covariance matrix Rb is known a priori
and is nonsingular, where R+1/2
b
is the Hermitian nonnegative
deﬁnite square root of Rb. The transformation simply reduces
to a normalization step in the case of a white Gaussian noise.
The covariance matrix R of the snapshots yi is given by
R = ARxAH + Rb = Ψ + Rb
with H denoting the complex conjugate, the signal and noise
vectors being independent. We assume that the channel matrix
A is full rank and that the signal covariance matrix Rx is
nonsingular so that the rank of Ψ is min(K, T). Hence, when
T ≤ K, there are T non-zero eigenvalues in the matrix Ψ
and when T > K, there are K non-zero eigenvalues. This
property is used in [7], [8] where the number of observations,
T, is incremented until R has zero eigenvalues. When the
whitening transformation is applied, the covariance matrix R†
of the whitened observations, denoted R†, is deﬁned as
R† = R−1/2
b
RR−1/2
b
= R−1/2
b
ΨR−1/2
b
+ IT
The population eigenvalues R†, denoted λ1 ≥ λ2 ≥ ... ≥ λT ,
are such that
λi > 1
for 1 ≤ i ≤ min(K, T)
(2)
λi = 1
for min(K, T) < i ≤ T
(3)
In most approaches, T is much larger that K so the conditions
in (2) and (3) should be written as 1 ≤ i ≤ K and K < i ≤ T
respectively. However, in some CR algorithms such as the ones
in [7] and in [8], (2) and (3) are used in this way, since they are
initialized with T = 1 and T is incremented by one each time
the T th smallest eigenvalue is not detected has being a noise
eigenvalue. In any case, the estimation of K can be performed
from the multiplicity of the λi equalling one. When R and
Rb are known, and when the rank of R−1
b Ψ is K, the CM
estimation can be easily performed from the multiplicity of the
λi equalling one. Otherwise, when R and Rb are unknown
and have to be estimated, the sample covariance matrix (SCM)
of the observations yi, denoted bR, must be computed
bR = 1
m
m
X
i=1
yiyH
i
The SCM of the noise, denoted bRb, must be also computed
using
bRb = 1
N
N
X
j=1
bjbH
j
Note that the bj, 1 ≤ j ≤ N are independent noise-only
samples. We assume that we can get noise-only samples by
using idle time slots. In that case, the estimation of K is based
on the eigenvalue decomposition of the SCM bR†
bR† = 1
m
m
X
i=1
y†
i(y†
i)H = bR−1/2
b
bR bR−1/2
b
(4)
The sample eigenvalues of the SCM matrix bR† are denoted
ˆλ1 ≥ ˆλ2 ≥ ... ≥ ˆλT .
III. SOME RESULTS ON EIGENVALUE STATISTICS
In the following, we investigate new results in RMT. In
particular, we provide new characterizations of the eigenvalues
of SCMs. We ﬁrst begin with the signal-free case and then
address the signal bearing case.

272
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
A. Signal-free Case
We start with the signal-free case where no user is trans-
mitting, so K = 0. As a consequence, we have that
R
=
Rb
R†
=
IT
(5)
and all population eigenvalues λi are all equal to one.
From the system model and (5), the vectors yi are T-
dimensional complex Gaussian independent vectors such that
yi ∼ CNT (0, Rb).
From Property 6.1, we get that m bR is a T-variate complex
Wishart matrix with m degrees of freedom and covariance
matrix Rb, i.e.,
m bR ∼ CWT (m, Rb)
Similarly, since we have that y†
i ∼ CNT (0, IT ), we have that
m bR† ∼ CWT (m, IT )
From Property 6.2, we now characterize the eigenvalues
of bR in the signal-free case and in the presence of a white
Gaussian noise [16], [20], [23], [24].
Corollary 3.1: In
the
signal-free
case,
when
yi ∼ CNT (0, λIT ),
the
Empirical
Spectral
Distribution
(ESD) of the T × T random matrix bR† converges almost
surely to the Mar˘cenko-Pastur law in (14) (see Fig. 2).
Fig. 2.
Distribution of the eigenvalues of a matrix bR in the signal-free case
with T = 500 and m = 2000 (λ = 1).
When the snapshots yi are whitened and become y†
i, a new
distribution for the ESD must be considered [22].
From Property 6.3, we now characterize the eigenvalues of
bR† in the signal-free case in the presence of an arbitrarily
colored Gaussian noise [20], [22]–[24].
Corollary 3.2: In
the
signal-free
case,
when
y†
i ∼ CNT (0, IT ), the ESD of the T × T random matrix bR†
converges almost surely to the modiﬁed Mar˘cenko-Pastur law
in (16) (see Fig. 3).
Fig. 3.
Distribution of the eigenvalues of a matrix bR† in the signal-free case
with T = 500 and m = 2000.
In the signal-free case, we are interested in the eigenvalues
of bR† or, equivalently, in the eigenvalues θ that satisfy
bRv = θ bRbv
(6)
We can rewrite (6) as follows
m bRv = (m
N θ)N bRbv
(7)
Since m bR ∼ CWT (m, Rb) and N bRb ∼ CWT (N, Rb), (7)
is similar to (20). So, using Property 6.5, the largest eigenvalue
ˆλ1 that satisﬁes (7) is Tracay-Widom (TW) distributed and we
can derive the following property.
Property 3.1: The largest eigenvalue ˆλ1 that satisﬁes (6) is
TW distributed, i.e.,
P
(
log( m
N ˆλ1) − µ(T, m, N)
σ(T, m, N)
≤ x
)
→ TWC(x)
The pdf of the largest eigenvalue ˆλ1 is represented in Fig. 4.
Note that this characterization uses explicitly the double
Wishart setting that has been motivated by the need to whiten
the observations when the additive Gaussian noise of the
channel is not white. Another and simpler characterization of
ˆλ1 has also be proposed in [20], [21].
Property 3.2: In the signal-free case, the whitened snap-
shots y†
i are NT (0, IT ) and the largest eigenvalue ˆλ1 of the
SCM bR† is Tracy-Widom distributed. When T, m → ∞ such
that T/m → c ∈ (0, ∞),
P
"
mˆλ1 − µT,m
σT,m
≤ x
#
→ TWC(x)
where
µT,m
=
(
√
T + √m)2
σT,m
=
(
√
T + √m)( 1
√
T
+
1
√m)1/3

273
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Fig. 4.
Probability density function of the largest eigenvalue of a matrix bR†
in the signal-free case with m = 61440 and different values for T and the
noise variance σ2.
When the snapshots y†
i are NT (0, σ2IT ), the convergence
limit of mˆλ1 is σ2(
√
T + √m)2. This corresponds to the
non-normalized case. Note that the convergence rate to the
TWC(x) distribution function is O(T −1/3). When the pa-
rameters m and T are not so large, which is practically the
case when we want to reduce the number of observations, the
convergence rate to the TW distribution is rather O(T −2/3)
provided that the mean and standard deviation have been
modiﬁed appropriately .
B. Signal Bearing Case
When there are K signals and when T → ∞, the limiting
ESD of bR† still converges to a Mar˘cenko-Pastur distribution.
This is because all eigenvalues are equally weighted by the
ESD so the impact of K signals vanishes when T → +∞.
Now there are K signal eigenvalues and T −K noise eigenval-
ues, and their respective characterization are different.4 Noise
eigenvalues are still distributed according to a TW distribution.
The situation is a little bit more complicated for the signal
eigenvalues since the characterization depends on a threshold
τ. In the case of a white Gaussian noise, when no whitening
transfomation in applied, the threshold is deﬁned as τ = 1+√c
[16]. The threshold takes into account the c1 ratio in Property
6.3, when dealing with a colored noise [22]. When the ith
largest signal eigenvalue ˆλi is strictly higher than τ, the signal
eigenvalue converges to a limit different from that in the
signal-free case [16]. In that case, the signal eigenvalue is
Gaussian distributed, i.e.,
P
" ˆλi − µi
σi
≤ x
#
→ G(x)
4This case is often referred to as a ”spiked” model in RMT.
where
µi
=
λi(1 +
c
λi − 1)
σi
=
λi
√
T
r
1 −
c
(λi − 1)2
and
G(x) =
Z x
−∞
1
√
2π exp (−y2
2 )dy
In Fig. 5, the pdf of the smallest signal eigenvalue is repre-
sented. Otherwise, when the ith largest signal eigenvalue ˆλi
Fig. 5.
Probability density function of the smallest signal eigenvalue of a
matrix bR† in the signal-bearing case with K = 4, i.e. ˆλ5, with m = 61440,
a noise variance of σ2 = 0.1, and different values for T. The solid curves
with markers are the simulation results and the dotted curves are the Gaussian
distribution.
is strictly lower that τ, the signal eigenvalue is distributed
according to a TW distribution, i.e.,
P
(
log( m
N ˆλi) − µ(T − i, m, N)
σ(T − i, m, N)
≤ x
)
→ TWC(x)
Note that there is a speciﬁc phenomenon when the ith largest
signal eigenvalue exactly equals to the threshold [24]. Hence,
when K ≪ T, the signal eigenvalues exhibit, on rescaling,
ﬂuctuations described by the TW distributions when there are
strictly below the threshold τ. So the distributions obtained
for the signal-free case (K = 0) closely approximate the
distribution of the signal eigenvalues. These results have an
impact on the design of CM estimation techniques since signal
eigenvalues strictly below τ are considered as being noise
eigenvalues. Note that adding observations, i.e., increasing T,
cannot be an option to tackle this problem since τ grows
with T. However, when the signal eigenvalues are above the
threshold, a reliable estimation of the CM is possible.
IV. COLLISION MULTIPLICITY ESTIMATION TECHNIQUES
We ﬁrst present the CM estimation method based on the dis-
tribution of noise eigenvalues. Then we review two approaches
based on the distribution of signal eigenvalues.

274
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
A. A method based on the distribution of noise eigenvalues
We assume that T observations are available at the des-
tination node. The SCM bR† is computed from (4). Then, an
eigenvalue decomposition of bR† is performed and the resulting
eigenvalues are sorted in descending order ˆλ1 ≥ ˆλ2 ≥ ... ≥
ˆλT . The method relies on the property that the ith largest
noise eigenvalue is TW distributed, provided that all signal
eigenvalues are located above the detectability threshold. So
for every l = 0, 1, . . . , T − 1, we test the null hypothesis that
”there are exactly l colliding signals” against the alternative
hypothesis that there are ”at least l +1 colliding signals”. The
test is performed by computing the test statistic Sλ(l)
Sλ(l) = log( m
N ˆλl+1) − µ(T − l, m, N)
σ(T − l, m, N)
(8)
and comparing it to a threshold τα . The threshold τα is deﬁned
as
τα = TW −1
C (1 − α)
(9)
where α is some signiﬁcance level. More precisely, a sig-
niﬁcance level α is set so that the probability that the null
hypothesis is detected by chance is α. So the null hypothesis
is accepted when we have
Sλ(l) < τα
(10)
The sequence of tests begins with l = 0. If the test Sλ(0)
is passed, i.e., when Sλ(0) < τα, there are no colliding
users. Otherwise, there is at least one signal. The procedure
proceeds to the next step with l = 1. The tests are performed
subsequently until the test is passed. When the test is passed
at step l = q, the eigenvalue ˆλq+1 is detected as being TW
distributed. So ˆλq+1 is a noise eigenvalue, and hence there
are exactly q colliding signals. Once the number of colliding
users has been determined, the destination node stops the
CM estimation process and proceeds to the next processing
block. The procedure is summarized in Algorithm 1. The
Algorithm 1 TWIT algorithm
Compute bR†
Perform the eigenvalue decomposition of bR†
Sort the eigenvalues ˆλi, i = 1, . . . , T of bR†
ˆKTWIT ← 0 and Test ← False
while Test = False and ˆKTWIT < T do
µ ← µ(T − ˆKTWIT, m, N)
σ ← σ(T − ˆKTWIT, m, N)
Test ← {σ−1[log(mˆλ ˆ
KTWIT+1/N) − µ] < τα}
if Test = False then
ˆKTWIT ← ˆKTWIT + 1
else
break
end if
end while
mean µ(x, y, z) and the standard deviation σ(x, y, z) in the
algorithm are deﬁned in Property 6.4. Note that this criterion
has been originally designed for arbitrary (or colored) noise
[22]. That is the reason why the algorithm uses the eigenvalues
of bR†.
B. Methods based on the distribution of signal eigenvalues
We present two CMETs that are all based on the Gaussian
distribution of signal eigenvalues. We ﬁrst present the well-
known MDL criterion, and then address another criterion
based on recent advances in RMT.
1) The MDL criterion: The MDL criterion has been deﬁned
in [17]. This criterion has been used for decades in the area of
signal array processing, and other related domains. The MDL
estimator ˆKMDL for the CM K is deﬁned as
ˆKMDL = argmin
k=1,...,T
{MDL(k)}
where
MDL(k) = −m(T − k) log
g(k)
a(k)

+ 1
2k(2T − k) log(m)
where
g(k) =
T
Y
i=k+1
ˆλ
1
T −k
i
a(k) =
1
T − k
T
X
i=k+1
ˆλi
where the ˆλi denote the eigenvalues of bR† with 1 ≤ i ≤ T,
ordered in descending order. This estimator is consistent in
the m → ∞ sense. One of the reason why the MDL criterion
has been widely used over the past two decades comes from
its robustness to model mismatch, in particular when the
underlying assumptions of snapshots and noise Gaussianity
can be relaxed [25]–[27].
2) The criterion based on recent results on signal eigen-
values: This new criterion has been designed using the last
results in RMT [16]. We denote this estimator SEMOS (Sig-
nal Eigenvalue-based Model Order Selection). The estimator
ˆKSEMOS for the CM K is deﬁned as, for complex data
ˆKSEMOS =
argmin
k=0,...,T −1
1
2(1
c )2q2
k

+ 2(k + 1)

The test statistic qk is deﬁned as
qk =

(T − k)gs(k)
as(k) − (1 + c)

× T
(11)
where
gs(k) =
T
X
i=k+1
ˆλ2
i
as(k) = (
T
X
i=k+1
ˆλi)2
V. SIMULATION RESULTS
We study the performance of three estimation techniques:
the MDL criterion, the TWIT, and the SEMOS estimator.
The methods are evaluated in the context of Rayleigh block-
fading channels. The channel coefﬁcients Aij in (1) are
circularly symmetric Gaussian coefﬁcients with zero mean and
power unity and the coefﬁcients are randomly changing from
one observations to another. User stations are transmitting
OFDM signals. The signals are constructed according to the

275
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
TABLE I
OFDM SIGNAL PARAMETERS
Modulation
BPSK
Number of sub-carriers Nsub
1024
Guard Interval GI
1/4
Number of OFDM symbols per OFDM block NOFDM
48
IEEE 802.11 standard [28] and use the signal parameters listed
in Table I.
From the signal parameters, we get that the number of
samples per OFDM frame is m = (1 + GI) × Nsub ×
NOFDM = 61440. For the sake of simplicity, we set that
N = m, i.e., N = 61440. The performance of estimation
techniques have been evaluated over 10,000 Monte Carlo trials
(NSimu = 10000) using the MATLAB software.
The three estimation techniques are compared in Fig. 6 to
10 in the case of a white Gaussian noise. The results have
been obtained for both a variable T and a variable SNR. The
signiﬁcance level α for the TWIT is set to 0.01 [22]. Figures
6 and 7 represent the simulation results for K = 3 and K = 4
respectively. The simulation results are similar with K = 3
and K = 4 so we focus on the latter case in the following.
When the number of observations and the SNR are increasing,
the curves are converging toward the same position so it is
difﬁcult to compare them. So we choose instead to compare
the estimation techniques with respect to the MSE ϵ2 between
the estimates ˆK and K
ϵ2 =
1
NSimu
NSimu
X
i=1
| ˆKi − K|2
(12)
where ˆKi is the estimate of K for the ith trial. This is shown in
Fig. 8 to 10. Since the curves are plotted on a log scale, only
non-zero values are plotted. So when the experimental MSE is
zero, the corresponding point of the curve is not represented.
Fig. 6.
Estimates of K = 3 with the TWIT and the MDL criterion for a
variable number of snapshots T, 5 ≤ T ≤ 15, and different SNR values.
The simulation results show that the estimation techniques
perform better at high SNR and when T increases. The number
Fig. 7.
Estimates of K = 4 with the TWIT and the MDL criterion for a
variable number of snapshots T, 5 ≤ T ≤ 15, and different SNR values.
of observations should be higher than almost three times the
CM K in order to get a relative MSE lower than 10%.
Similarly, the SNR should be higher than 0 dB in order
to get a similar performance level, for any values of T.
The two RMT-based techniques, i.e., the SEMOS estimator
and the TWIT, outperforms the MDL criterion. However, the
differences between the simulation curves decrease when the
SNR or T is increasing. Moreover, the SEMOS estimator
outperforms the TWIT. This can be due to the fact that the
former technique used all the eigenvalues in the computation
of the estimator while the latter only uses one eigenvalue to
detect the number of signals. Note, however, that the TWIT
has not been designed with the purpose of outperforming the
SEMOS technique. Rather, the TWIT has been designed to
cope with colored Gaussian noises. This is illustrated in the
next ﬁgure.
Fig. 8.
MSE of two estimation techniques (TWIT and the MDL criterion)
for K = 4, a variable number of snapshots T, 5 ≤ T ≤ 15, and different
SNR values.
Fig. 11 represents the performance of both the SEMOS

276
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Fig. 9.
MSE of two estimation techniques (the SEMOS estimator and the
MDL criterion) for K = 4, a variable number of snapshots T, 5 ≤ T ≤ 15,
and different SNR values.
Fig. 10.
MSE of two estimation techniques (the SEMOS estimator and the
TWIT) for K = 4, a variable number of snapshots T, 5 ≤ T ≤ 15, and
different SNR values.
estimator and the TWIT. The simulation parameters are the
same as the ones that have been used in previous simulations.
The noise is now a colored noise. For this purpose, a white
Gaussian noise with variance unity is passed through a ﬁlter
with Nf coefﬁcients fi, 1 ≤ i ≤ Nf given in Table II.
We have that
Nf
X
i
|fi|2 = 1
so the colored Gaussian noise at the output of the ﬁlter is
also unit variance. The simulation results in Fig. 11 show that
the SEMOS estimator is unable to estimate correctly the CM
while the TWIT is still performing well.
TABLE II
FILTER COEFFICIENTS
0.227
0.460
0.688
0.460
0.227
Fig. 11.
MSE of two estimation techniques (the SEMOS estimator and the
TWIT criterion) for K = 4, a variable number of snapshots T, 5 ≤ T ≤ 15,
and different SNR values, in the presence of a colored noise.
A. Discussion
The simulation results show that the estimation techniques
perform better when the number of observations T is much
larger than the number of signals K. This is in stark contrast
with previous studies, such as the ones implemented in [7]
and [8] where T is set to a value not greater than K + 2. In
other approaches [11], [12], a single observation is required
to perform the MUD of the colliding users. These references
do not explicitly claim that the number of signals is estimated
using only one observation. In this context, the blind separation
technique designed in [13], is implemented and the number of
sources (users) is assumed to have been estimated using an
MDL-like criterion.
VI. CONCLUSION
In this paper, two new CM estimation techniques, the TWIT
and the SEMOS estimator, have been proposed. The methods
are based on eigenvalue statistics. In the TWIT, eigenvalues are
tested in descending order, from the largest to the lowest. The
ﬁrst eigenvalue ˆλq that is considered as being Tracy-Widom
distributed allows the CM estimation by ˆK = q − 1. In the
SEMOS estimator, a criterion is computed just as in the MDL
criterion approach. These CM estimation techniques have been
shown to outperform the typical MDL criterion. The SEMOS
estimator outperforms the TWIT in the presence of a white
Gaussian noise but it is inefﬁcient in the presence of a colored
noise. Moreover, simulation results have shown that a large
number of snapshots T is needed in order to allow a good
estimation of K in terms of MSE. Furthermore, the number
of snapshots must be signiﬁcantly higher than the number of
colliding users K (T ≫ K). These settings are similar to
the settings that are used in MOS techniques for signal array
processing.
The impact of these results is twofold. First, some CR
techniques such as the network-assisted diversity multiple ac-
cess (NDMA) [7], [8] cannot be implemented in IEEE 802.11

277
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
networks notably because these CR techniques are based on
the assumption that T can be made as small as K+1 or K+2.
Second, some multiple packet reception (MPR) protocols for
IEEE 802.11 networks that use the blind user separation in
[13] appear to be rather questionable since they assume that
the CM estimation can rely on a single observation of collided
request-to-send (RTS) frames. Even if the destination node is
equipped with four antennas (T = 4), our simulation results
have shown that the receiver at the destination node needs
many more snapshots in order to provide a good estimation of
K. This paper has pointed out a strong constraint in the design
of MPR techniques. It revealed that a single observation of the
colliding signals is far from providing enough information to
estimated the number of colliding nodes.
Further investigations are now needed in order to fully
characterized the performance of the proposed CM estimation
techniques in typical operating conditions. The obtained results
will allow the implementation of these techniques in current
or future standards.
APPENDIX
A. Complex Wishart Matrices
Property 6.1: Consider a T ×m matrix X with m samples
drawn from a T-dimensional complex Gaussian law with zero
mean and covariance matrix RX, denoted CNT (0, RX). The
random matrix XXH is a T-variate complex Wishart matrix
with m degrees of freedom [20]. This is denoted
XXH ∼ CWT (m, RX)
where CWT (m, RX) denotes complex Wishart law, parame-
terized accordingly.
B. Empirical Spectral Distribution (ESD) of a Matrix
The ESD of an T ×T Hermitian matrix X, denoted F X(x),
is the distribution function of the eigenvalues of X, i.e., for
x ∈ R
F X(x) = 1
T
T
X
i=1
1{x,λi≤x}(x)
(13)
where λ1, . . . , λT are the population eigenvalues of X and
1A(x) is the indicator function of the set A, i.e., 1A(x) = 1
if x ∈ A, and 1A(x) = 0 otherwise. The Hermitian property
is required to ensure that all eigenvalues of X belong to the
real line.
Property 6.2: Let X ∈ CT ×m be a random matrix with
independent and identically distributed (iid) entries Xij such
that Xij has zero mean and variance λ. As T, m → ∞ with
T/m → c ∈ (0, ∞), the ESD of
B = 1
mXXH
converges almost surely to a non-random distribution function
with density fc(x) given by
fc(x)
=
(1 − 1
c )+ × δ(x)
+
1
2πλxc
p
(x − a)+(b − x)+
(14)
with a = (1 − √c)2, b = (1 + √c)2, δ(x) = 1{0}(x) and, for
x ∈ R, x+ = max(0, x).
The probability density function (pdf) fc(x) is the Mar˘cenko-
Pastur density.
Property 6.3: Let B ∈ CT ×m be a random matrix deﬁned
as
B = 1
mT1/2XXHT1/2
(15)
where X ∈ CT ×m is a random matrix with iid entries that
have zero mean and power unity, and where T is an T × T
Hermitian non negative deﬁnite matrix. As T, m → ∞ with
T/m → c ∈ (0, ∞), the ESD of B converges almost surely to
a non-random distribution function with density efc(x) given
by
efc(x)
=
(1 − 1
c )+ × δ(x)
+
1 − c1
2πx(xc1 + c)
p
(x − b1)+(b2 − x)+
(16)
with
b1
=
"
1 −
p
1 − (1 − c)(1 − c1)
1 − c1
#2
b2
=
"
1 +
p
1 − (1 − c)(1 − c1)
1 − c1
#2
where T/N → c1 ∈ (0, 1) as T → +∞.
The probability density function (pdf) efc(x) is a modiﬁed
Mar˘cenko-Pastur density.
C. Distribution of the Largest Eigenvalue of Wishart Matrices
We now investigate the distribution of the largest eigen-
value of Wishart matrices. Consider A ∼ CWT (m, Rb)
and B ∼ CWT (N, Rb), two independent random matrices
where m, N > T. We consider the generalized eigenproblem
constructed from A and B
Av = θ(A + B)v
(17)
where v denotes the eigenvector corresponding to the eigen-
value θ. This is referred to as a double Wishart setting [20].
Property 6.4: The largest eigenvalue satisfying (17), de-
noted λ(D)
1
, is distributed according to a Tracy-Widom (TW)
distribution when m, N → ∞ as T → ∞ with m, N > T,
i.e.,
P
"
W(λ(D)
1
) − µ(T, N, m)
σ(T, N, m)
≤ x
#
→ TWC(x)
(18)
where W(θ) denotes the logit transformation of θ, i.e.,
W(θ) = log[θ/(1 − θ)] and TWC(x) is the TW distribution
function for complex data.

278
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
The centering µ(T, N, m) and rescaling σ(T, N, m) in (18)
are parameterized as follows
β
=
min(N, T)
γ
=
m − T
δ
=
|N − T|
µ(T, m, N)
=
(uβ
τβ
+ uβ−1
τβ−1
)( 1
τβ
+
1
τβ−1
)−1
σ(T, m, N)
=
2( 1
τβ
+
1
τβ−1
)−1
sin2(γβ/2)
=
(β + 1/2)
×
(2β + γ + δ + 1)−1
sin2(φβ/2)
=
(β + δ + 1/2)
×
(2β + γ + δ + 1)−1
τ 3
β
=
16(2β + γ + δ + 1)−2
×
sin−2(φβ + γβ)
×
sin−1(φβ) sin−1(γβ)
uβ
=
2 log[tan(φβ + γβ
2
)]
Note that the covariance matrix Rb has no effect on the
distribution of the eigenvalue λ(D)
1
. A proof of Property 6.4
can be found in [21] for Rb = IT . We now rewrite (17) as
AB−1v =
θ
1 − θv
(19)
and derive a new property for the following generalized
eigenproblem
Av = θBv
(20)
This is referred to as a single Wishart setting. From (19) and
(18), we get the following property.
Property 6.5: The largest eigenvalue satisfying (20), de-
noted λ(S)
1
, is distributed according to a TW distribution when
m, N → ∞ as T → ∞ with m, N > T, i.e.,
P
(
log[λ(S)
1
] − µ(T, N, m)
σ(T, N, m)
≤ x
)
→ TWC(x)
REFERENCES
[1] B. Escrig, “Estimation of Collision Multiplicities in IEEE 802.11-
based WLANs,” in Proc. IARIA Eleventh International Conference on
Networks (ICN), 2012.
[2] P. V. Lang Tong, V. Naware, “Signal processing in random access,” IEEE
Signal Processing Magazine, vol. 21, no. 5, pp. 29–39, 2004.
[3] M. Z. A. A. F. Borgonovo, L. Fratta, “Capture division packet access:
a new cellular access architecture for future PCNs,” IEEE Communica-
tions Magazine, vol. 34, no. 9, pp. 154–162, 1996.
[4] D. L. S. Y. Park, D. Park, “On Scheduling for Multiple-Antenna Wireless
Networks Using Contention-Based Feedback,” IEEE Transactions on
Communications, vol. 55, no. 6, pp. 1174–1190, 2007.
[5] P. T. M. Durvy, O. Dousse, “Self-Organization Properties of CSMA/CA
Systems and Their Consequences on Fairness,” IEEE Transactions on
Information Theory, vol. 55, no. 3, pp. 931–943, 2009.
[6] S. Verd´u, “Multiuser Detection.”
Cambridge Press, 1998.
[7] R. Zhang, N. D. Sidiropoulos, and M. K. Tsatsanis, “Collision Resolu-
tion in Packet Radio Networks Using Rotational Invariance Techniques,”
IEEE Transactions on Communications, vol. 50, no. 1, pp. 146–155,
2002.
[8] B.
¨Ozg¨ul and H. Delic¸, “Wireless Access with Blind Collision-
Multiplicity Detection and Retransmission Diversity for Quasi-Static
Channels,” IEEE Transactions on Communications, vol. 54, no. 5, pp.
858–867, 2006.
[9] A. P. R. Lin, “A new wireless network medium access protocol based on
cooperation,” IEEE Transactions on Signal Processing, vol. 53, no. 12,
2005.
[10] R. Z. G. Dimic, N.D. Sidiropoulos, “Medium access control - physical
cross-layer design,” IEEE Signal Processing Magazine, vol. 21, no. 5,
pp. 40–50, 2004.
[11] P. X. Zheng, Y. J. Zhang, and S. C. Liew, “Multipacket Reception in
Wireless Local Area Networks,” in Proc. IEEE International Conference
on Communications (ICC), 2006.
[12] W. L. Huang, K. B. Letaief, and Y. J. Zhang, “Cross-Layer Multi-Packet
Reception Based Medium Access Control and Resource Allocation
for Space-Time Coded MIMO/OFDM,” IEEE Transactions on Wireless
Communications, vol. 7, no. 9, pp. 3372–3384, 2008.
[13] S. Talwar, M. Viberg, and A. Paulraj, “Blind Separation of Synchronous
Co-Channel Digital Signals Using an Antenna Array. Part I. Algo-
rithms,” IEEE Transactions on Signal Processing, vol. 44, no. 5, pp.
1184–1197, 1996.
[14] P. Stoica and Y. Sel`en, “Model-Order Selection : A review of information
criterion rules,” IEEE Signal Processing Magazine, vol. 21, no. 4, pp.
36–47, 2004.
[15] Q. Ding and S. Kay, “Inconsistency of the MDL: On the Performance of
Model Order Selection Criteria with Increasing Signal-to-Noise Ratio,”
IEEE Transactions on Signal Processing, vol. 59, no. 5, pp. 1959–1969,
2011.
[16] R. R. Nadakuditi and A. Edelman, “Sample Eigenvalue Based Detection
of High-Dimensional Signals in White Noise Using Relatively Few
Samples,” IEEE Transactions on Signal Processing, vol. 56, no. 7, pp.
2625–2638, 2008.
[17] M. Wax and T. Kailath, “Detection of Signals by Information Theoretic
Criteria,” IEEE Transactions on Acoustics, Speech, and Signal Process-
ing, vol. 33, no. 2, pp. 387–392, 1985.
[18] M. S. Bartlett, “A note on the multiplying factors for various χ2
approximations,” J. R. Stat. Soc., vol. 16, p. 296298, 1954.
[19] D. N. Lawley, “Tests of signiﬁcance of the latent roots of the covariance
and correlation matrices,” Biometrica, vol. 43, p. 128136, 1956.
[20] I. M. Johnstone, “High Dimensional Statistical Inference and Random
Matrices,” in Proceeding of the International Congress of Mathemati-
cians, 2006.
[21] ——, “Multivariate analysis and Jacobi ensembles: Largest eigenvalue,
TracyWidom limits and rates of convergence,” vol. 36, no. 6, pp. 2638–
2716, 2008.
[22] R. R. Nadakuditi and J. W. Silverstein, “Fundamental Limit of Sample
Generalized Eigenvalue Based Detection of Signals in Noise Using Rela-
tively Few Signal-Bearing and Noise-Only Samples,” IEEE Transactions
on Signal Processing, vol. 4, no. 3, pp. 468–480, 2010.
[23] P. O. Perry and P. J. Wolfe, “Minimax Rank Estimation for Subspace
Tracking,” IEEE Journal of Selected Topics in Signal Processing, vol. 4,
no. 3, pp. 504–513, 2010.
[24] J. Baik, G. B. Arous, and S. P´ech´e, “Phase transition of the largest
eigenvalue for nonnull complex sample covariance matrices,” The Annals
of Probability, vol. 33, no. 5, pp. 1643–1697, 2005.
[25] G. Xu, R. H. Roy, and T. Kailath, “Detection of number of sources via
exploitation of centro-symmetry property,” IEEE Transactions on Signal
Processing, vol. 42, no. 1, pp. 102–112, january 1994.
[26] P. Stoica and M. Cedervall, “Detection tests for array procesing in un-
known correlated noise ﬁelds,” IEEE Transactions on Signal Processing,
vol. 45, no. 9, september 1997.
[27] E. Fishler and H. V. Poor, “Estimation of the number of sources in
unbalanced arrays via information theoretic criteria,” IEEE Transactions
on Signal Processing, vol. 53, no. 9, pp. 3543–3553, september 2005.
[28] “IEEE 802.11n standard, Wireless LAN Medium Access Control (MAC)
and Physical Layer (PHY) speciﬁcations: Amendment 5: Enhancements
for Higher Throughput,” IEEE Computer Society, Tech. Rep., 2009.

