Performance Limitation of HSDPA MIMO by Pre-Coding Induced Phase Distortion
Wolfgang Aichmann
Nokia Siemens Networks
D-89081 Ulm, Germany
Email: wolfgang.aichmann@nsn.com
Abstract—In multiple-input multiple-output (MIMO) an-
tenna systems both strength of the data layers as well as
separation of them is achieved by pre-coding the transmitted
signal with different factors for different layers and different
antennas. In W-CDMA systems, the selection of these factors
is decided anew every transmission time interval, which causes
a phase distortion with every change. Due to raised cosine
ﬁltering this phase distortion is broadened even if the physical
channel is ﬂat in frequency, which distorts the affected symbols
and thus limits the maximum bit rate to be transmitted in
such cases if no counter measures are taken. If the pre-coding
weights of adjacent time intervals are known by the receiver,
the distortion can be removed by the equalizer; otherwise high
code rates should be avoided by the scheduler.
Keywords-W-CDMA; HSDPA; MIMO; pre-coding; raised
cosine ﬁlter;
I. INTRODUCTION
Multiple-input multiple-output is a well known method to
increase the capacity of radio systems on the air interface
[1]–[5] and was introduced in 3G high speed downlink
packet access (HSDPA) with Release 7 of 3GPP TS 25.214
[6] in 2007 and in high speed uplink packet access (HSUPA)
with Release 11 [7] in 2012. Two modes of operation are
deﬁned, namely single and dual layer transmission. The
distribution of data to the transmitting antennas is controlled
by so called pre-coding vectors. The effect of this pre-coding
is twofold: In case of single data layer transmission, the
pre-coding vector is adjusted such as to optimize the power
at the receiving antennas. This is possible as shifting the
phase difference between the signals fed to the transmitting
antennas changes the interference behaviour at the receiving
antennas, and constructive interference results in higher
power.
If two layers are transmitted, orthogonal pre-coding vec-
tors are applied, which allow to separate the layers at the
receiving side, typically by a linear minimum squared equal-
izer in space and time as it is, e.g., described in [8]. Non-
linear receiver algorithms such as interference cancellation
improve the de-coding performance on receiver side but are
quite sensitive to very good channel knowledge [9], [10].
As the interference conditions are changing with time (fast
fading), especially for moving user equipments (UE), one
tries to always ﬁnd and use the best pre-coding vector out of
the set of allowed ones, and to change it if necessary. Switch-
ing between single and dual stream as well as between
MIMO and non-MIMO can be regarded as a generalization
of switching the pre-coding vector: In non-MIMO mode, the
weights for the second transmitting antenna are 0 and single
layer transmission can formally be regarded as dual layer
transmission with the same data and the same pre-coding
for both layers.
Any change in the pre-coding vector however causes a
superposition of signals coded with the old and ones coded
with the new pre-coding vector in the range of channel
delay due to multi-path propagation including raised cosine
ﬁltering. This has some impact on the detection of the
affected bits and might even prohibit at all the correct block
detection for high coding rates. In real networks switching
of MIMO mode as well as switching the pre-coding vector
within a MIMO mode is a quite frequent operation, which
leads to a signiﬁcant restriction of the achievable maximum
data rate even in very good radio conditions. This could
be one of the reasons why HSDPA MIMO isn’t present in
commercial networks so far besides other reasons such as
the chicken or egg (here better base station or UE) dilemma
and the need for a second pilot signal reducing thus the
power available for data transmission.
The remainder of the paper is organized as follows: In
Section II, we investigate the impact of pre-coding induced
phase distortions on the received symbols. We show then
in Section III that a smooth transition of equalizer weights
at the boundaries of transmission time intervals (TTI) pre-
coded with different vectors is able to remove this distortion.
Unfortunately, the pre-coding vector of adjacent TTIs is
known on receiving side only if they bear data for the
same UE. Therefore, it is useful to take counter measures
on transmitter side if TTIs are dedicated to different UEs.
Some of them are introduced in Section IV followed by
some concluding remarks in Section V.
II. BASIC CONSIDERATIONS
In order to understand the principles of MIMO pre-coding,
the basic concept of MIMO transmission in HSDPA is
displayed in Fig. 1.
The signal sλ of each data layer λ ∈ {1, 2} is fed
to the m ∈ {1, 2} transmitting antennas with weights
w1 = 1/
p
(2) and w2 ∈ W2 ≡ {(1 + i)/2, (1 − i)/2, (−1 +
i)/2, (−1−i)/2} [6]; w1 and w2 build the pre-coding vector
123
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

and the pre-coding index (PCI) deﬁnes which component w2
out of the code book W2 is taken.
If only one data layer is transmitted, w2 typically is chosen
such as to achieve the maximum channel power at receiving
side as this is related to the highest possible throughput if we
ignore here that also the post-equalizer interference power
may depend on the applied pre-coding vector. In case of two
layers being transmitted the two pre-coding vectors have to
be orthogonal in order to enable the receiver to separate the
layers and hence w2|λ=2 = − w2|λ=1. As exchanging the
PCI values within two layers transmitted in parallel has no
impact on the aggregated throughput this means that only
two choices remain for w2, namely either PCI 1 and 4 or
PCI 2 and 3, and the aggregated possible throughput is used
to decide which of these two possibilities is taken.
The signal rj received at antenna j and time k counted
in chip length (0 ≤ k < n) consists of contributions of all
transmitted data layers and can be expressed as
rj(k)
=
n−1
X
δ=0
[w1h1j(δ) + w2h2j(δ)] s1(k − δ)
|
{z
}
layer λ=1
+
n−1
X
δ=0
[w1h1j(δ) − w2h2j(δ)] s2(k − δ)
|
{z
}
layer λ=2
(1)
To achieve high data rates it is necessary the coherence
time of the channel impulse response to be large compared to
the delay spread in the presence of multi-path propagation,
and large compared to the averaging length required for
appropriate channel estimation. Practical experience shows
that code rates of 80% or higher require a coherence time
of at least one slot, which is achieved for UEs moving not
faster than about 3km/h.
However, this constraint is violated if the pre-coding
vector is changed: The effective channel impulse response
becomes unsteady at the TTI boundary and hence the coher-
ence time approaches zero, at least in the time range of the
delay spread. It has to be emphasized that the raised cosine
(RC) ﬁlter has to be included explicitly in this considerations
as on transmitting side, the pre-coding usually is executed
before the root raised cosine (RRC) ﬁltering and on receiving
side the equalizer algorithm containing the inverse pre-
coding is fed with data, which have already passed the ﬁlter.
To demonstrate the impact of RC ﬁltering we have inves-
tigated the positions of symbols in the phase space diagram,
modulated with 64QAM and passing a one-tap channel with
additional RC ﬁlter, i.e. a RRC ﬁlter was applied on both
transmitting and receiving side, but without equalizing. Four
different scenarios have been taken into account, namely
keeping the pre-coding vector constant at PCI=1, as well as
switching it in the middle of a data block with 2560 chips
to another pre-coding vector out of W2. The distance of the
Figure 1.
MIMO dual layer transmission, schematic overview.
positions of the symbols in the phase space diagram from
the position they would have if the complete data block had
been sent with the new pre-coding vector is then measured.
The result is shown in Fig. 2 displaying the symbol shifts
for an RRC ﬁlter with oversampling factor 4 and tail length1
of 20 chips.
Fig. 2a shows the constellation of the symbols in the
phase space. The circles mark the symbol positions for
constant pre-coding whereas crosses are placed at the effec-
tive symbol positions. Symbols beyond the RRC coherence
length are drawn in blue and those within the coherence
length around the switching time are red colored. Fig. 2b
displays the distance of shift of the symbols with respect
to the position without shift, normalized to the average
symbol distance from the origin. Please note the reduced
scale on ordinate for the case of no switching. It is obvious
that symbols within the tail length are affected heavily by
switching the pre-coding vector, whereas symbols beyond
that range relax quickly to the equilibrium position.
Additional equalizing turns and stretches the symbols such
as to have them at the same positions as on the transmitting
side, but it does not remove the distortion induced by
switching the pre-coding vector, i.e., the relative positions
of the red crosses to the blue circles.
Two major effects are worth to be noted, namely that the
symbol shift increases with increasing length of the RRC
ﬁlter and that especially for larger tail lengths a phase shift
of π is worse than a shift of π/2. Whether the latter effect
also results in higher bit error rates is not clear so far as a
longer distance from the ideal position has no more inﬂuence
on the bit error rate when the bit is detected wrongly anyway.
Furthermore it has to be noted that on transmitting side
the pre-coding ﬁlter usually is applied before the RRC ﬁlter,
which causes the disturbance by switching the ﬁlter to be
twice as long as the length of the RRC ﬁlter. If the order of
ﬁltering and pre-coding is changed, the length of disturbance
is halved.
Link level simulations with a Pedestrian A channel at
3km/h for MIMO single stream (see Fig. 3a) show how
1Tail length denotes the length of RRC ﬁlter, i.e., the length from middle
position of the ﬁlter to the edge.
124
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

(a)
(b)
Figure 2.
Shifting of 64QAM symbol position due to switching pre-coding vector for a one tap channel and RRC ﬁlter with tail length 20. In (a), the
expected (o) and measured (+) symbol positions in the complex phase space are shown. In a range around the pre-coding change (red), determined by the
maximum channel delay including RC ﬁlter, the symbols are distorted. The absolute value of the dislocations as a function of chip index is shown in (b).
(a)
(b)
Figure 3.
Link level simulations for a Pedestrian A channel at 3km/h, UE category20 and CQI values according table G in [7] (a) Raw bit error rate for
CQI 30. Slots with changed pre-coding vector show a signiﬁcantly higher error ﬂoor compared to all slots. Correct handling of these pre-coding changes
(see III-B) removes the error ﬂoor completely. (b) High code rates show an error ﬂoor in the block error rate (BLER) which can even be above the working
point of 10% BLER.
switching the pre-coding vector causes an error ﬂoor of the
raw bit error rate of about 0.6% in affected slots. These bit
errors directly cause erroneous decoding of the blocks they
belong to in case of coding rates higher than about 0.75 as
is demonstrated in Fig. 3b.
III. EQUALIZER WITH SMOOTH WEIGHT TRANSITION
A. Calculation of Symbol Distortion
To see how the distortion induced by switching the pre-
coding vector in the presence of channel impulse response h
including the RC ﬁltering can be properly taken into account
on receiver side, let us start with (1) but restricted to one
data layer only, namely:
rj(k) =
n−1
X
δ=0
[w1(k − δ)h1j(δ) + w2(k − δ)h2j(δ)] s1(k−δ)
(2)
We have thus generalized the pre-coding vector to depend
on time via k−δ. Let us now introduce a single switching of
the pre-coding vector at time 0, i.e., s1(k < 0) is pre-coded
with ˜w and s1(k ≥ 0) with w:
125
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

Figure 4.
Corrected positions of 64QAM symbols, which are distorted by
switching the pre-coding vector in presence of a one tap channel and RRC
ﬁlter with ﬁlter length 20 and OSF 4.
rj (k ≥ 0)
=
k
X
δ=0
[w1h1j (δ) + w2h2j (δ)] s1 (k − δ)
+
n−1
X
δ=k+1
[ ˜w1h1j (δ) + ˜w2h2j (δ)] s1 (k − δ)
=
¯rj + ∆rj
(3)
¯rj(k)
≡
n−1
X
δ=0
[w1h1j (δ) + w2h2j (δ)] s1 (k − δ) (4)
∆rj(k)
≡
n−1
X
δ=k+1
[ ˜w2 − w2] h2j (δ) s1 (k − δ)
(5)
The last step in (3) holds because the same phase factor
is applied to the ﬁrst transmitting antenna for all pre-coding
vectors, i.e., w1 ≡ ˜w1. One can see that received symbols up
to index k = n − 2 are affected from the switch in the pre-
coding vector. Hence we can limit the further investigations
to 0 ≥ k ≥ n − 2. It remains ∆rj(k) as error correction to
the ’static’ calculation ¯rj(k) of rj(k).
One can hence use (4) to calculate ¯rj assuming ideal
knowledge of the transmitted symbols s1(k < 0) also on
receiver side, i.e., symbols of the data block preceding the
switch of the pre-coding vector, as is shown in Fig. 4.
The assumption of ideal symbol knowledge demonstrates
the impact of switching the pre-coding index, but it doesn’t
help to remove the distortion in real scenarios as of course
the symbols aren’t known a priori except of pilot measure-
ments, which is beyond the current scope. We must therefore
ﬁnd another solution of removing the symbol distortion.
B. Smooth Weight Transition
In a linear minimum mean square equalizer (LMMSE)
the weights are typically re-calculated every slot or every
TTI but always with the pre-coding weights as they are
relevant for the current data block. If the pre-coding vector
is changed on transmitting side also the equalizer weight
vector obtained with the old pre-coding weights is replaced
as a whole by the new one now calculated also with the new
pre-coding weights. This implies that there is a transition
interval, in which either data originating from the ’old’
data block are equalized with weights obtained for ’new’
pre-coding or data already originating from the ’new’ data
block are still equalized with weights obtained for ’old’ pre-
coding or a mixture of both depending on when exactly the
replacement of the weight vector takes place.
Heuristically, this error can be avoided if the weight vector
isn’t replaced as a whole but element by element. This means
that as soon as the new data block enters the equalization
procedure the corresponding element of the ’old’ equalizer
vector (either the ﬁrst or the last one, depending on the
ordering convention) is replaced by the element of the ’new’
weight vector. Then, the elements are exchanged one by one
with every chip until the weight vector consists completely
of elements calculated with the ’new’ pre-coding.
In order to motivate the validity of this approach we
remember the calculation of space time LMMSE equalizer
weights as, e.g., elaborated in [8]. The weights are propor-
tional to a generalized matrix of channel impulse response,
ΓE, but with ΓE appearing in a quadratic form in the
denominator2. If all data layers are transmitted with the same
power as is the case in HSDPA MIMO, this quadratic form
becomes independent of the applied pre-coding. The latter
persists only in the numerator and makes the elements of
the weight vector proportional to the respective pre-coding
weights, leading directly to the heuristic approach described
above.
Applying this procedure to full link level simulations a
signiﬁcant gain can be obtained at the high data rate edge
as can be seen in Fig. 5. Although the working point is
only slightly shifted to lower SNR, the error ﬂoor present
without any correction is avoided completely. Compared to
the simulation with ﬁltering the pre-coding switching with
the goal to reduce the number of transitions, see Fig. 6, the
averaged working point is nearly 1dB better in the scenario
investigated here.
The formalism above can easily be extended to switching
between MIMO single and dual stream: Single stream trans-
mission is formally the same as dual stream transmission
with identical pre-coding vectors (and of course identical
data). To obtain single layer transition weights from dual
layer ones the latter have have to be summed up whereas
2We use here the term denominator for an inverted matrix in order to
simplify the verbal description.
126
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

Figure 5.
Performance improvement of MIMO Single Stream by smooth
transition of equalizer weights. The simulation was executed for a Pedes-
trian A channel at 3km/h, UE category 20 and CQI 30 according table G
in [7]
dual layer transition weights can be obtained from single
layer ones be dividing them into two equal parts, of course
always with proper scaling such as to conserve the overall
transmit power.
As also non-MIMO data transfer is affected if switching
between this mode and any of the MIMO modes occurs it
has also to be included by deﬁning it to be a single stream
transmission with constant pre-coding vectors and vanishing
pre-coding weight for the second transmitting antenna.
IV. OTHER MEANS OF AVOIDING SYSTEMATIC BLOCK
ERRORS
There are many methods, which can help to avoid the
occurrence of systematic block errors induced by changing
the pre-coding weights in case the receiver is not able to
handle the corresponding symbol distortion properly. Some
of them, e.g., the introduction of a cyclic preﬁx as in
long term evolution (LTE), would require to change the
speciﬁcation which would make it impossible for legacy UEs
to be operated. They are beyond the scope of the current
paper. Others can be implemented either on base station
or UE side within the valid speciﬁcation framework. Such
proposals are discussed now.
A. Attenuation of Switching Pre-Coding Vector
One quite simple strategy to decrease the negative impact
of switching the pre-coding vector is to attenuate the switch-
ing itself. We have investigated a simple ﬁlter algorithm on
receiver side for single layer transmission, which is working
in two steps. This approach is easily extensible to the dual
layer case. It is based on an ordinary calculation of channel
power for all possible pre-coding vectors, i.e.,
P (k)
s
=
NRx
X
n=1
h
Hkn ∗ H†
kn
i
Hkn
=
NT x
X
m=1
"
w(k)
m
L
X
δ=1
hmn (δ)
#
where w(k) denotes the kth element out of the code book
W.
Without ﬁltering, the pre-coding vector is chosen as
k0,s = max
{k}

too many changes anyway. A corresponding signaling might
therefore to be useful.
This CQI limitation should be applied only in case of
the receiver is not able to correct the switching errors itself
(see section III-B). A powerful application of this proposal
therefore requires the deﬁnition of a new UE class or a
parameter indicating the ability of the UE for this correction.
V. CONCLUSION
We have shown that switching the pre-coding vector
applied to data transferred from multiple TX antennas leads
to a broad distortion of the channel impulse response includ-
ing the raised cosine ﬁlter. In this context, also switching
between non-MIMO, MIMO single layer and MIMO dual
layer transmission can formally be regarded as switching the
pre-coding vector. For high data rates this effect leads to a
high probability that data blocks adjacent to the switching
border will be lost.
There are several possibilities to avoid or at least to
reduce the negative impact, but most of them cause other
constraints, e.g. avoiding changes of the pre-coding vector
and / or reducing the coding rate. Other measures, e.g.,
dynamically shortening the disturbance length by reducing
the length of root raised cosine ﬁlter if the pre-coding vector
is changed might be inapplicable at all.
Therefore, the best strategy seems to remove the distur-
bance induced by the discontinuity in phase by the equalizer.
However, if the receiver isn’t able to do this, e.g. because
of missing pre-coding information, which is signaled en-
crypted, a reduction of the coding rate to a reasonable value
of affected data blocks is an acceptable strategy to avoid
systematic block errors.
The calculations were done for HSDPA MIMO, but they
are applicable to a wider range and affect many scenarios
with MIMO and / or transmit diversity. Although the smooth
transition of equalizer weights assumes phase-only pre-
coding an extension of this approach might be used if pre-
coding with modiﬁcations in the amplitude are applied.
Finally we want to mention that the impact of the distor-
tion to LTE systems is low or absent at all because of the
cyclic preﬁx, which is introduced there for other reasons.
ACKNOWLEDGMENT
The Author would like to thank Elke Hallmann and Klaus
Knoche for many inspiring discussions during this study.
REFERENCES
[1] J. G. Proakis and M. Saleh, Digital Communications, 5th ed.,
New York: McGraw-Hill, 2008.
[2] H. Holma and A. Toskala, HSDPA/HSUPA for UMTS, The
Atrium: John Wiley & Sons, 2006.
[3] E. Dahlman, S. Parkvall, J. Sk¨old, and P. Beming, 3G Evolu-
tion, HSPA and LTE for Mobile Broadband, 1st ed., London:
Elsevier, 2007.
Figure 6.
Performance improvement of MIMO Single Stream in AWGN
channels by attenuating the changing of the pre-coding vector. The error
ﬂoor as shown in Fig. 3 can be avoided.
[4] C. Mehlf¨uhrer, S. Caban. M. Wrulich, and M. Rupp, ”‘Joint
Throughput Optimized CQI and Precoding Weight Calculation
for MIMO HSDPA”’, in Proc. Fourtysecond Asilomar Confer-
ence on Signals, Systems and Computers, Paciﬁc Grove, CA,
USA October 2008, [Online] Available: http://publik.tuwien.
ac.at/ﬁles/PubDat 167015.pdf. (Accessed: 2013-05-14)
[5] White paper, ”‘The Evolution of HSPA”’, 4G Americas, 2011,
[Online]
Available:
http://www.4gamericas.org/documents/
4G%20Americas%20White%20Paper The%20Evolution%
20of%20HSPA October%202011x.pdf. (Accessed: 2013-05-
14)
[6] 3GPP, ”‘Technical speciﬁcation group radio access net-
work; Physical layer procedures (FDD) (Tech. Spec. 25.214
V7.4.0)”’, 2007. [Online]. Available: http://www.3gpp.org/ftp/
Specs/archive/25 series/25.214/. (Accessed: 2013-05-14)
[7] 3GPP, ”‘Technical speciﬁcation group radio access net-
work; Physical layer procedures (FDD) (Tech. Spec. 25.214
V11.4.0)”’, 2012. [Online]. Available: http://www.3gpp.org/
ftp/Specs/archive/25 series/25.214/. (Accessed: 2013-05-14)
[8] M. Wrulich, S. Eder, I. Viering and M. Rupp, ”‘Efﬁcient Link-
to System Level Model for MIMO HSDPA”’, Proc. of the 4th
IEEE Broadband Wireless Access Workshop, New Orleans,
December, 2008.
[9] W.
Aichmann,
”‘Scrambling-Exact
Channel
Estimation
in
W-CDMA
Systems”’,
in
Proc.
ICWMC,
IARIA
Luxembourg
June
2011,
pp.
12-17.
[Online]
Available:
http://www.thinkmind.org/index.php?view=article&articleid=
icwmc 2011 1 30 20028 (Accessed: 2013-05-14)
[10] W. Aichmann, ”‘Impact of Scrambling-Exact Channel Es-
timation on HSDPA MIMO”’, International Journal On Ad-
vances in Telecommunications, vol. 5, no. 1&2, 2012, pp. 79-
89. [Online] Available: http://www.thinkmind.org/index.php?
view=article&articleid=tele v5 n12 2012 8 (Accessed: 2013-
05-14)
128
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

