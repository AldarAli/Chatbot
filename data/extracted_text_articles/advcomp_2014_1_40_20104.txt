Kinematically Exact Beam Finite Elements
Based on Quaternion Algebra
Eva Zupan
Slovenian National Building
and Civil Engineering Institute
Ljubljana, Slovenia
Email: eva.zupan@zag.si
Miran Saje and Dejan Zupan
University of Ljubljana
Faculty of Civil and Geodetic Engineering
Ljubljana, Slovenia
Email: dejan.zupan@fgg.uni-lj.si
Abstract—Rotations in three-dimensional Euclidean space can be
represented by the use of quaternions numerically efﬁcient and
robust. In the present approach, rotational quaternions are used
as the primary quantities to describe the rotational degrees of
freedom for static and dynamic analysis of geometrically non-
linear beam-like structures. The classical concept of parametriza-
tion of the rotation matrix by the rotational vector is thus
completely abandoned. The consistent governing equations of the
beam in terms of the quaternion algebra are presented and several
quaternion-based numerical implementations are discussed.
Keywords–beam theory; non-linear geometry; quaternion alge-
bra; ﬁnite-element formulation, statics; dynamics
I.
INTRODUCTION
Beams are important load-carrying members of various
engineering structures. A common characteristic of these struc-
tural elements is that one dimension is considerably longer than
the other two, which allows us to employ relatively simple
mathematical models to describe their geometry. Nevertheless,
modern demands for such structures impose the need to predict
accurately and efﬁciently large displacements and rotations and
ﬁnite strains that can occur during the deformation. Therefore,
the governing equations of the problem in general become non-
linear and too demanding to be solved analytically.
Efﬁcient numerical implementation of three-dimensional
non-linear beam elements is still a challenge for researches.
Most of the problems in non-linear beam formulations reported
in literature stem from the properties of three-dimensional
rotations that are directly or indirectly incorporated into the
methods. The non-linearity of three-dimensional rotations re-
quires a special treatment in parametrization, discretization,
interpolation and iterative update. It is crucial for the overall
efﬁciency of the ﬁnite element formulation that in all these
procedures a sufﬁcient attention is paid to the properties of
rotations.
Among various existing non-linear beam theories we here
study the ‘geometrically exact beam theory’ also denoted
as ‘Cosserat theory of rods’ as introduced by Antman [1],
Reissner [2], and Simo [3]. We will especially focus on the
treatment of rotations in numerical implementation. There is a
number of possible ways of choosing the suitable representa-
tion or parametrization of rotations. Widely used are the three-
component parametrizations as we directly avoid any algebraic
constraints. Among such parametrizations a ‘rotational vector’
[4] seems to be very popular. Simo [3], Bottasso and Borri
[5], Jeleni´c and Crisﬁeld [6] and many others employed the
rotational vector as the members of the primary unknowns. In
contrast to these models, Betsch and Steinmann [7] used the
director triad with constraints. By the use of directors several
disadvantages of the rotational vector, such as singularity and
strain non-objectivity, are avoided with the additional cost of
six constraint equations that need to be considered at each
node. An interesting alternative is the algebra of quaternions
that was only recently recognized as a suitable tool in three-
dimensional beam formulations [8]–[12].
Quaternions are elements of the four-dimensional Eu-
clidean space. By introducing an additional operation called
‘quaternion multiplication’ we are able to represent rotations
with quaternions. Only one additional degree of freedom in
such parametrization is sufﬁcient to avoid singularities while
it introduces only one algebraic constraint that needs to be
satisﬁed. The equations of the beam need to be properly
transformed and all the steps in the numerical procedure need
to be taken in accord with the new conﬁguration space. In
this work, we therefore present the derivation of the dynamic
governing equations of the three-dimensional beam in terms of
quaternions using an energy-consistent approach and discuss
the numerical implementation in terms of quaternion algebra
for statics and dynamics.
This paper is structured in the following manner. Section 2
introduces quaternion algebra and its properties. In Section 3,
we describe the mathematical model of the three-dimensional
beam. Kinematic equations are reviewed in Section 4. Section
5 introduces the continuous governing equations in terms of
quaternion algebra, while, in Sections 6 and 7, the ﬁnite-
element implementations for static and dynamic problems
are described, respectively, and some numerical examples are
given. The paper ends with concluding remarks.
II.
QUATERNIONS
The set of quaternions IH is a four-dimensional Euclidean
linear space. Its elements are often presented as the sum of a
scalar and a vector, i.e., bx = s+
⇀v =

s,
⇀v

, s ∈ IR,
⇀v ∈ IR3.
Addition and scalar multiplication are inherited from IR4. We
additionally introduce the quaternion multiplication
bx ◦ by =

s c −
⇀v ·
⇀w

+

c
⇀v + s
⇀w +
⇀v ×
⇀w

,
(1)
where by = c +
⇀w ∈ IH. Here (·) denotes the scalar product
and (×) denotes the cross-vector product in IR3.
18
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-354-4
ADVCOMP 2014 : The Eighth International Conference on Advanced Engineering Computing and Applications in Sciences

Any quaternion q, with unit norm (|bq| = 1) can be
expressed in polar form as
bq = cos ϑ
2 + sin ϑ
2
⇀n,

⇀n
 = 1,
(2)
where ϑ is the angle of rotation and
⇀n is the unit vector on
the axis of rotation. That is why we also call them rotational
quaternions. Let
⇀
b ∈ IR3 denote a three-dimensional vector
obtained by rotating vector
⇀a ∈ IR3 by an angle ϑ about an
axis, deﬁned by unit vector
⇀n. Then a relationship between
the two vectors can be expressed as
⇀
b = bq ◦
⇀a ◦ bq ∗,
(3)
where bq ∗ = cos ϑ
2 − sin ϑ
2
⇀n is the conjugated quaternion.
III.
MODEL OF A THREE-DIMENSIONAL BEAM
A
three-dimensional
beam,
Fig.
1,
is
described
by
the
family
of
position
vectors
⇀r (x, t),
x
∈
[0, L],
of
the
line
of
centroids
and
local
orthonormal
bases
⇀
G1 (x, t) ,
⇀
G2 (x, t) ,
⇀
G3 (x, t)

describing the inclination of
cross-sections, which are assumed to preserve their shape and
area during the deformation.
O
1
2
3


2
3

( , )
 
( , )
 
( , )
 
1( , )
 




g
g
g



Figure 1. A three-dimensional beam.
After
introducing
a
global
orthonormal
basis
n⇀g 1,
⇀g 2,
⇀g 3
o
each local basis can be deﬁned by the
rotation of the global one. In terms of the quaternion algebra,
the relation between the moving and the ﬁxed basis can be
written as
⇀
Gi (x, t) = bq (x, t) ◦
⇀g i ◦ bq ∗ (x, t) ,
i = 1, 2, 3.
(4)
For computational purposes, vectors will be expressed with
respect to either of the two bases and the component descrip-
tion will be denoted by bold face symbols. For quaternions
a trivial extension of these two bases into quaternion space
together with the fourth base vector - the identity element
b1 = 1 +
⇀
0 will be used. An arbitrary quaternion, bx = s +
⇀v ,
can thus be expressed as
bx = sb1+v1
⇀g 1 +v2
⇀g 2 +v3
⇀g 3 = S b1+V1
⇀
G1 +V2
⇀
G2 +V3
⇀
G3
and the components are represented by one-column matrices
bx and bX, respectively. The relationship between the two
representations of any quaternion is given by
bX = bq ∗ ◦ bx ◦ bq,
bx = bq ◦ bX ◦ bq ∗.
(5)
We will identify vectors and quaternions with zero scalar
part since any vector in IR3 can be treated as an element of
the four-dimensional Euclidean space:
v ≡ bv = [ 0
v1
v2
v3 ]T .
The hat over the symbol will be omitted when the ﬁrst
component equals zero since the appropriate size of one-
column representation will always be evident from the context.
IV.
KINEMATIC EQUATIONS
In Reissner-Simo beam theory [2] – [3], the resultant strain
measures at the centroid of each cross-section are directly
introduced and expressed with kinematic variables by the ﬁrst
order differential equations. For describing the rate of change
of the position vector we introduce the translational strain
γ = r′ − γ0,
Γ = bq ∗ ◦ br ′ ◦ bq + Γ0,
(6)
where γ0 and Γ0 are variational constants, determined from
the initial conﬁguration of the beam. The differentiation of
equation (4) with respect to parameter x results in rotational
strain vector. In terms of quaternions, the rotational strain, also
called the curvature, is determined by
κ = 2bq′ ◦ bq ∗,
K = 2bq ∗ ◦ bq′.
(7)
Analogously we have
v =
·r,
V = bq∗ ◦
·r ◦ bq.
(8)
describing the velocity in both descriptions. The time-
dependent analogy to curvature is the angular velocity vector:
ω = 2
·
bq ◦ bq ∗,
Ω = 2bq ∗ ◦
·
bq.
(9)
Again, ω denotes the angular velocity with respect to the ﬁxed
basis while Ω is its local basis representation.
The weak or linearized form of kinematic equations (6) and
(7) relating the variations of strains, displacements and rota-
tional quaternions will also be needed. They can be derived by
direct linearization of the strong form of kinematic equations,
which leads to
δrelΓ = (bq ∗ ◦ δbr′ ◦ bq) + 2bq ∗ ◦ (br′ × (δbq ◦ bq ∗)) ◦ bq
(10)
δrelK = 2bq ∗ ◦ (δbq ◦ bq ∗)′ ◦ bq.
(11)
Note that by (10)–(11) the relative or objective variations of
strains are deﬁned. The objective variations are variations of
components with respect to the local basis where the changes
of are not taken into account. It is also interesting to observe
that the same equations can be obtained from the virtual work
principle as presented in [13].
A result similar to (7) is obtained after we express the
variation of the rotational vector ϑ = ϑn with the variation of
rotational quaternion. After a short derivation we obtain
δϑ = 2δbq ◦ bq ∗.
(12)
The above result is crucial for the replacement of rotational
vectors with quaternions in any variational principle.
19
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-354-4
ADVCOMP 2014 : The Eighth International Conference on Advanced Engineering Computing and Applications in Sciences

V.
THE CONTINUOUS GOVERNING EQUATIONS
Our goal is to express the governing equations in terms
of quaternions as the only rotational degrees of freedom.
Quaternions will serve as a suitable replacement for both
rotational vector and matrix. We will start from the weak form
of the dynamic equilibrium of a three-dimensional beam:
L
Z
0

N (x, t) · δrelΓ (x, t) + M (x, t) · δrelK (x, t)

dx
=
L
Z
0

˜n (x, t) − ρA
··r (x, t)

· δr (x, t) dx
+
L
Z
0

˜m (x, t) − R (x, t) Jρ
·
Ω (x, t)
−ω (x, t) × R (x, t) JρΩ (x, t)

· δϑ (x, t) dx
+ f L(t) · δr (L, t) + hL(t) · δϑ (L, t)
− f 0(t) · δr (0, t) + h0(t) · δϑ (0, t) ,
(13)
where the term on the left hand side denotes the virtual work
of internal forces and the terms of the right hand side denote
the virtual work of external (applied) and inertial forces and
moments. N and M are the stress-resultant force and moment
vectors of the cross-section; ˜n and ˜m are external distributed
force and moment vectors per unit of the initial length; ρ
denotes mass per unit of the initial volume; R is the rotation
matrix; A is the area of the cross-section; Jρ is the centroidal
mass-inertia matrix of the cross-section; f 0, h0, f L and hL are
the external point forces and moments at the two boundaries,
x = 0 and x = L. For simplicity and clearness of the notation,
the dependency on x and t will be omitted.
We will replace any rotation matrix acting on a vector by
the quaternion-based rotation, see (3). Further, we will replace
the variation of the three-parameter rotational vector by the
variation of the four-parameter rotational quaternion using (12)
and rearrange the scalar product in the following manner:
w · δϑ = 2w · δbq ◦ bq ∗ = 2 (w ◦ bq) · δbq
(14)
for any vector w.
The four components of the rotational quaternion are
mutually dependent due to the unit norm condition. The unit
norm constraint is enforced in the model by the method of
Lagrangian multipliers. The constraint (bq · bq = 1) is ﬁrst
multiplied by an arbitrary unknown scalar function λ (x, t),
independent on the primary unknowns, varied and integrated
along the length of the beam:
L
Z
0
2λbq · δbq dx +
L
Z
0
(bq · bq − 1) δλ dx.
(15)
Equation (13) is rewritten in terms of quaternion algebra and
(15) is added to ﬁnally get
L
Z
0

N · δrelΓ + M · δrelK

dx
=
L
Z
0

˜n − ρAr
··r

· δr dx
+ 2
L
Z
0

{ ˜m − bq ◦

Equation (26) represents the extension of the angular momen-
tum balance equation to quaternion algebra as it follows from
generalized d’Alembert principle. After (26) is multiplied on
the right by bq∗ and the unity of quaternion bq is considered,
we get
c
M − λb1 = b0
or, equivalently,
λ = 0
(27)
M = 0,
(28)
since M is a pure quaternion and λ is a scalar. Thus,
Lagrangian multiplier λ vanishes for this problem and it could
be eliminated from the set of unknown quantities iff the unity
of quaternions is satisﬁed. Note that the unit-norm constraint is
not neccessarily preserved after the discretization. When (19)
is exactly preserved by the solution procedure the standard
moment equilibrium equation can be used. Both approaches
will be presented in numerical formulations.
VI.
NUMERICAL IMPLEMENTATIONS FOR STATICS
In static analysis, inertial terms in governing equations
vanish, which leads to a system of ordinary algebraic equa-
tions. In ﬁnite element approach, these differential equations
are replaced by a set of non-linear algebraic equations and
therefore the algebraic constraint for quaternions ﬁts well into
the numerical solution method. The consistent quaternion-
based approach introduced eight equations (17)–(19) for eight
primary unknowns r, bq and λ. The increments of the primary
unknowns can be interpolated in a standard manner:
∆r (x) =
X
i
Pi (x) ∆ri,
∆ri = ∆r (xi)
(29)
∆bq (x) =
X
i
Pi (x) ∆bqi,
∆bqi = ∆bq (xi)
(30)
∆λ (x) =
X
i
Pi (x) ∆λi,
∆λi = ∆λ (xi) ,
(31)
where xi ∈ [0, L], i = 0, 1, 2, ..., N + 1, with x0 = 0 and
xN+1 = L, are the discretization points and Pi(x) are the
interpolation functions. It is evident that such approach intro-
duces additional degrees of freedom, but we should stress that
the elements of the tangent-stiff matrix are computationally
relatively inexpensive to evaluate. We could expect that the
constraint (19) would enforce the unity of quaternions and
that a standard additive update can be used. Unfortunately,
the incremental quaternions are not unit, which leads to
severe numerical problems observed at iteration procedure
when solving discrete non-linear equations. The normalization
of incremental quaternions does not result in considerably
better convergence properties, but they are extremely improved
after employing the kinematically consistent update. To obtain
the updated rotational quaternion in a consistent manner, the
following formula directly derived from (12) is used
Dbqi = cos

In Table I, we compare the results for the position vector
of the free end of the cantilever. Eight straight elements of
various order were used to obtain the results of the present
formulation. The present results agree well with the results of
other authors. Slightly better behaviour of consistent formula-
tion with additional degree of freedom can be observed.
VII.
NUMERICAL IMPLEMENTATIONS FOR DYNAMICS
In dynamics analysis, we base our model on the reduced set
of equations (17) and (28). To avoid obtaining the system of
the algebraic-differential equations we enforce the constraint
(19) as a part of numerical algorithm. Primary unknowns
are therefore only r (x, t) and bq (x, t) . They are replaced
by a set of one-parameter functions r i (t) = r (xi, t) and
bqi (t) = bq (xi, t) at N + 2 discretization points from the
interval [0, L]. Similarly as for static case it is suitable to
introduce an interpolation of these functions with respect to
parameter x:
r (x, t) =
X
i
Pi (x) ri (t)
bq (x, t) =
X
i
Pi (x) bqi (t) .
(34)
Discretization with respect to x results in a system of
7 (N + 2) ordinary second-order scalar differential equations
for dynamic analysis for 7 (N + 2) unknown scalar functions
r i (t) and bqi (t).
Several procedures are possible for the time discretization.
We have successfully employed the methods of the Runge-
Kutta family. Note that the standard methods for solving
systems of ordinary differential equations do not automatically
conserve the unit norm of the rotational quaternion. In order
to obtain the kinematically admissible results, the rotational
quaternions are normalized after each time step has been
completed.
An interesting alternative is to derive time integrators spe-
cially designed for rotational quaternions. Based on the stan-
dard Newmark scheme on the additive conﬁguration spaces:
r[n+1] = r[n] + ∆t v[n] + ∆t2
1
2 − β

·v
[n]
+ β
·v
[n+1]
v[n+1] = v[n] + ∆t

(1 − γ)
·v
[n]
+ γ
·v
[n+1]
and the kinematically consistent update of quaternions (32)–
(33) the following scheme is obtained:
∆bq[n] = bq[n] ◦ 1
2

∆t Ω[n]
+∆t2
"1
2 − β
 ·
Ω
[n]
+ β
·
Ω
[n+1]#
bq[n+1] =

cos
∆bq[n] ◦ bq[n]∗
+sin
∆bq[n] ◦ bq[n]∗
∆bq[n] ◦ bq[n]∗
∆bq[n] ◦ bq[n]∗

◦ bq[n]
Ω[n+1] = Ω[n] + ∆t
"
(1 − γ)
·
Ω
[n]
+ γ
·
Ω
[n+1]#
.
For both schemes β ∈

0, 1
2

and γ ∈ [0, 1]. The upper indices
[n] and [n + 1] denote the quantities at the previous and at the
current time, tn and tn+1, respectively, while ∆t = tn+1 − tn
is the time increment.
A. Right angle cantilever
This example is taken from [15]. The geometry and loading
data are presented in Fig. 3. The remaining data reads:
A1 = A2 = A3 = A
EA = GA = 106
J1 = J2 = J3 = J
EJ = GJ = 103
Aρ = 1
Jρ = diag [ 20
10
10 ] .
50
2
1
t
L =10
A
B
L =10
F
F
Y
Z
X
1
2
Figure 3. The right-angle cantilever beam subjected to out-of-plane loading.
The present results of the Newmark scheme-based method
were obtained using the mesh consisting of 2 × 10 elements
with three internal collocation points per element and the 6-
point Gaussian integration rule.
displacement at point A
-10
0
10
20
adapted Newmark
Runge-Kutta
ref. [15]
30
-5
0
5
10

Figure 4. The right-angle cantilever: The right-angle comparison of
displacements at point A.
displacement at point B
-10
0
10
20
adapted Newmark
Runge-Kutta
ref. [15]
30
-5
0
5
10

Figure 5. The right-angle cantilever: The right-angle comparison of
displacements at point B.
22
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-354-4
ADVCOMP 2014 : The Eighth International Conference on Advanced Engineering Computing and Applications in Sciences

On the whole time interval, [0, 30], we used the same time
step as Simo and Vu-Quoc [15]: ∆t = 0.25. The results based
on Runge-Kutta method were obtained for the mesh of 2 × 12
elements with two internal collocation points per element and
the 4-point Gaussian integration rule. In contrast to Newmark
scheme, the time step is not ﬁxed and varies with respect to
the prescribed local error tolerance, taken to be ε = 10−5.
After the loading is removed at t = 2, the cantilever
continues to vibrate freely, undergoing bending, torsion, axial
deformations and large rotations. As observed from Fig. 4 and
Fig. 5, the displacements are in a good agreement with [15],
particularly in the time interval [0, 15]. With time differences
between different time integrators become more evident.
VIII.
CONCLUSION
Novel rotational-quaternion based approaches in ﬁnite-
element methods for analysis of spatial frame structures under
static and dynamic loads has been presented. The quater-
nion algebra was employed for the derivation of continuous
equations of dynamic equilibrium with a special consideration
of the unit norm constraint of rotational quaternion. Several
approaches in discretization of the system of governing equa-
tion in terms of quaternions and several solution approaches
are possible. The most suitable are the ones that are fully
in accord with the nature of three-dimensional rotations and
their quaternion representation. When properly treated the
quaternions were found to be a computationally efﬁcient, and
robust tool for describing incremental and iterative rotations
in non-linear beams.
REFERENCES
[1]
S. S. Antman, “Kirchhoffs problem for nonlinearly elastic rods,” Q.
Appl. Math., vol. 32, no. 3, 1974, pp. 221–240.
[2]
E. Reissner, “On ﬁnite deformations of space-curved beams,” Z. Angew.
Math. Phys., vol. 32, no. 6, 1981, pp. 734–744.
[3]
J. C. Simo, “A ﬁnite strain beam formulation - the three-dimensional
dynamic problem. Part I.” Comput. Meth. Appl. Mech. Eng., vol. 49,
no. 1, 1985, pp. 55–70.
[4]
J. Argyris, “An excursion into large rotations,” Comput. Meth. Appl.
Mech. Eng., vol. 32, no. 1-3, 1982, pp. 85–155.
[5]
M. Borri and C. L. Bottasso, “An intrinsic beam model-based on a
helicoidal approximation .1. formulation,” Int. J. Numer. Methods Eng.,
vol. 37, no. 13, 1994, pp. 2267–2289.
[6]
G. Jelenic and M. A. Crisﬁeld, “Geometrically exact 3D beam theory:
implementation of a strain-invariant ﬁnite element for statics and
dynamics,” Comput. Meth. Appl. Mech. Eng., vol. 171, no. 1-2, 1999,
pp. 141–171.
[7]
P. Betsch and P. Steinmann, “Frame-indifferent beam ﬁnite elements
based upon the geometrically exact beam theory,” Int. J. Numer.
Methods Eng., vol. 54, no. 12, 2002, pp. 1775–1788.
[8]
H. Lang, J. Linn, and M. Arnold, “Multi-body dynamics simulation
of geometrically exact Cosserat rods,” Multibody Syst. Dyn., vol. 25,
no. 3, 2011, pp. 285–312.
[9]
H. Lang and M. Arnold, “Numerical aspects in the dynamic simulation
of geometrically exact rods,” Appl. Numer. Math., vol. 62, no. 10, SI,
2012, pp. 1411–1427.
[10]
E. Zupan, M. Saje, and D. Zupan, “The quaternion-based three-
dimensional beam theory,” Comput. Meth. Appl. Mech. Eng., vol. 198,
no. 49-52, 2009, pp. 3944–3956.
[11]
——, “Quaternion-based dynamics of geometrically nonlinear spatial
beams using the Runge-Kutta method,” Finite Elem. Anal. Des., vol. 54,
2012, pp. 48–60.
[12]
——, “Dynamics of spatial beams in quaternion description based on
the Newmark integration scheme,” Comput. Mech., vol. 51, no. 1, 2013,
pp. 47–64.
[13]
——, “On a virtual work consistent three-dimensional ReissnerSimo
beam formulation using the quaternion algebra,” Acta Mechanica, vol.
in press, 2013.
[14]
K. J. Bathe and S. Bolourchi, “Large displacement analysis of 3-
dimensional beam structures,” Int. J. Numer. Methods Eng., vol. 14,
no. 7, 1979, pp. 961–986.
[15]
J. C. Simo and L. Vu-Quoc, “On the dynamics in space of rods
undergoing large motions - a geometrically exact approach,” Comput.
Meth. Appl. Mech. Eng., vol. 66, no. 2, 1988, pp. 125–161.
23
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-354-4
ADVCOMP 2014 : The Eighth International Conference on Advanced Engineering Computing and Applications in Sciences

