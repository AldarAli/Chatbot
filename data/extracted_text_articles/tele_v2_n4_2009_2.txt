Dynamic Power and Bit Allocation Scheme for
Spectral Efﬁciency Maximization in Cognitive
Multiband OFDM UWB Systems
Liaoyuan Zeng
Wireless Access Research Center
University of Limerick
Limerick, Ireland
Email: liaoyuan.zeng@ul.ie
Sean McGrath
Wireless Access Research Center
University of Limerick
Limerick, Ireland
Email: sean.mcgrath@ul.ie
Eduardo Cano
Institute for the Protection and
Security of the Citizen
Joint Research Center
European Commission
Ispra, Italy
Email: eduardo.cano@jrc.ec.europa.eu
Abstract—A novel dynamic power and bit allocation scheme
for spectral efﬁciency maximization in the Cognitive Ultra
Wideband radio system is presented in this paper. A new bit
error rate expression is derived based on approximating a sum of
independent log-normal random variables as a single log-normal
random variable using the Fenton-Wilkinson method in order to
analyze the spectral efﬁciency in the UWB multipath channel.
A series of M-ary quadrature amplitude modulation zones
can be generated over each UWB subcarrier by manipulating
the BER expression. The total transmitted power is optimally
distributed among the UWB subcarriers for the use of those
zones with a maximum M on each subcarrier. The power and
bit allocation is divided into primary allocation and advanced
allocation for efﬁcient implementation. The performance of the
dynamic allocation algorithm is analyzed over different UWB
fading channels. The results show that the spectral efﬁciency of
the system is signiﬁcantly improved by an optimal power and bit
allocation techniques.
Keywords-Ultra Wideband; Multiband Orthogonal Frequency
Division Multiplexing; Bit Error Rate; Cognitive Radio.
I. INTRODUCTION
Radio spectrum is a scarce resource, both dynamic power
allocation and adaptive spectrum sharing through cognitive
radios can signiﬁcantly enhance the spectrum utilization in
a wireless network [1][2]. The principle behind cognitive
radio consists of deﬁning and developing technologies that
can enable a radio device to sense the states of the frequency
bands and adapt its internal states to statistical variations in
the incoming RF stimuli by making corresponding changes
in certain operation parameters in real-time. Thus, a cogni-
tive (unlicensed/secondary) system can detect and access the
temporarily-unused spectrum very rapidly without interfering
with the primary (licensed) systems (e.g., WiMAX).
Several physical-layer radio platforms have been suggested
for cognitive radio networks, one of the leading candidates is
Multiband Orthogonal Frequency Division Multiplexing (MB-
OFDM) Ultra Wideband (UWB) system [3][4]. UWB systems
use signals with a fractional bandwidth greater than 0.20
or occupy a minimum of 500 MHz (-10 dB) bandwidth in
the 3.1–10.6 GHz frequency band with a maximum mean
Power Spectral Density (PSD) of -41.3dBm/MHz [5]. The
UWB bandwidth is subdivided into a number of orthogonal
subcarriers (subchannels) with bandwidth of each less than
the channel coherence bandwidth. Hence, the Intersymbol
Interference (ISI) caused by multipath fading is minimized
when the information is transmitted over different subcarriers.
Furthermore, the MB-OFDM scheme can signiﬁcantly en-
hance the ﬂexibility and ease of dynamically allocating unused
spectrum in cognitive UWB radio systems [4].
A novel dynamic power and bit allocation scheme for
spectral efﬁciency maximization in the cognitive MB-OFDM
UWB radio systems in a multipath fading channel is presented
in this paper. This work in based on our previous work [1]
which did not integrate the cognitive radio technology into the
UWB systems. Furthermore, for an in-depth spectral efﬁciency
analysis of UWB multipath channel, a new Bit Error Rate
(BER) expression is derived based on approximating a sum
of independent log-normal random variables as another log-
normal random variable using the Fenton-Wilkinson method
[6]. The optimization of the spectral efﬁciency is under the
constraints in probability of detection and false alarm, trans-
mission PSD and BER. The objective is to maximize the
number of the information bits loaded in the UWB subcarriers
(each with different levels of fading [7]) by optimally allocat-
ing the available total transmitted power while guaranteeing a
sufﬁcient protection to the primary users.
By exploiting the channel conditions, a cognitive UWB
system can opportunistically access the temporarily-unused
spectrums and implement the optimal power and bit allocation
schemes. The fraction of time for UWB data transmission is
constrained by the spectrum sensing period and the probability
that the primary user is transmitting or receiving within
the spectrum of the UWB subcarriers. It is assumed that
this probability follows a Poisson process. The information
bits assigned in each subcarrier are modulated using M-
ary Quadrature Amplitude Modulation (M-QAM) modulation.
Thus, it is required to use the modulation scheme with the
121
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

maximum M in the subcarrier to maximize the spectral
efﬁciency.
The paper is organized as follows. In Section II, a literature
review of the spectral efﬁciency optimization in cognitive
multicarrier systems is presented. Next, the system model is
discussed in Section III, including the discussion of the UWB
multipath propagation, the multiband OFDM scheme and the
cognitive UWB radio systems. In Section IV, a new in-depth
BER performance analysis is carried out. On the basis of the
BER analysis, the system spectral efﬁciency is analyzed in
Section V. Then, the design of the dynamic power and bit
allocation algorithm is provided in Section VI. The analysis
of the simulation results is carried out in Section VII. Finally,
conclusions are presented in Section VIII.
II. LITERATURE REVIEW
The discussion of the UWB cognitive radio systems op-
timization with respect to spectrum sensing and dynamic
spectrum sharing has been treated extensively in the literature
dedicated to wireless systems and theory [3][8][9][10]. As an
optimization problem in multicarrier transmission systems, the
spectral efﬁciency maximization problem (in terms of how
to optimally allocate bits and power to UWB subcarriers)
is originally a non-convex integer-programming optimization
problem which is generally NP-hard [9]. The common solution
is either to relax this non-convex optimization problem into
a convex optimization problem or to use some metaheuristic
algorithm such as greedy algorithm to approximate the optimal
solution [9][11].
The theoretical capacities achieved by the cognitive Impulse
Radio (IR) UWB systems with constraints in outage proba-
bility of the primary users were studied in [3]. The authors
in [4] proposed a power allocation scheme using Lagrange
formulation to maximize the total transmission capacity of
the OFDM-based cognitive users. In [12], the effects of the
multipath fading channel on the choice of the transmitted
power level were taken into account for the design of the
cognitive power control strategies for system ergodic capacity
maximization. These addressed the fundamental channel rate
limits of the cognitive radio systems from a information theory
perspective.
Furthermore, in the derivation of the MB-OFDM UWB
BER expression in [13][14], the authors assumed that the
multipath gain coefﬁcients of the UWB channel model have
a statistically independent Gaussian distribution with zero
mean and variances. Authors in [15] made similar assumptions
and approximated the UWB channel frequency response to a
Rayleigh fading channel. In this paper, a more accurate BER
expression is derived based on the log-normal distribution
of the UWB multipath gain coefﬁcient. The UWB channel
measurement studies [5][16][17][18][19] have suggested that
the log-normal distribution can more accurately reﬂect the
measurement data.
III. SYSTEM MODEL
This section provides a review of the MB-OFDM UWB
systems and cognitive UWB radio systems, and speciﬁcally
focuses on the introduction of the MB-OFDM schemes.
A. UWB Signal
The MB-OFDM UWB transmitted signal of the node u is
represented by
x(u)(t) =
+∞
X
i=−∞
1
TS
NF F T −1
X
n=0
cn,ig(t − iT
′
S)e
j2πn(t−iT
′
S )
TS
,
(1)
where TS is the duration of the useful OFDM symbol and
NF F T is the number of subcarriers and also the number
of points of the Inverse Discrete Fourier Transform (IDFT).
The total duration of the OFDM symbol is computed as
T
′
S = TS + Tcp + TG where Tcp is the duration of the
cyclic preﬁx for ISI mitigation and TG is the duration of
the guard interval that ensures a smooth transition between
two consecutive OFDM symbols. The data sequence in (1) is
expressed as c = c0,i, c1,i, .., cn,i, .., cN−1,i being i the OFDM
symbol index and n the subcarrier index. Finally, the function
g(t) represents the unitary rectangular pulse of duration TS. In
this work, it is assumed that each data symbol is normalized
to have unit energy.
B. UWB Channel
In this work, the UWB multipath channel is modeled by
using the Saleh-Valenzuela (S-V) model which captured the
clustering phenomenon through practical channel measure-
ments [5]. This UWB channel model is assumed to be linear
time-invariant during the transmission of a data packet. The
impulse response of the UWB multipath channel with J
multipath components is expressed as
h(t) =
J
X
j=0
αjδ(t − Tj),
(2)
where αj are the multipath gain coefﬁcients which denotes the
amplitude of multipath components subjected to log-normal
distribution [16].
The multipath gain coefﬁcients αj are given by:
αj = pjξj,
(3)
where pj is equiprobable ±1 to account for signal inversion
due to reﬂections, ξj reﬂects the log-normal fading associated
with the jth multipath component. This log-normal variable
can be expressed in terms of Gaussian random variable as:
ξj = 10
xj
20 ,
(4)
where xj is a normal random variable with mean µj and
variance σ2. The µj is given by:
µj = 10ln(Ω0) − 10 Tj
Γ
ln(10)
− (σ2)ln(10)
20
,
(5)
122
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

Fig. 1.
Impulse Response over CM3
where Ω0 is the mean energy of the ﬁrst arrived multipath
component, and Γ is the signal decay factor.
The order of L = J is determined by L = Td/Ts, where Td
is the maximum delay spread of the UWB channel, and Ts is
the M-QAM symbol period. Hence, it is assumed that the delay
between the multipath components is T = τ = Ts for the rea-
sons of both analytical convenience and sampling processing
at the receiver [20]. This assumption is well suited to dense
scattering environments. The discrete time version of h(t) can
be expressed as h = h(t)|t=lTs = {h(0), h(1), ..., h(L − 1)},
where h(l) (l ∈ [0, L − 1]) is the impulse response of the lth
path.
There are four types of UWB Channel Models (CMs)
deﬁned based on the practical measurements of the key
channel parameters such as mean excess delay and Root Mean
Square (RMS) delay spread [5]. A channel impulse response
realization for CM3 is represented in Figure 1.
C. Multiband-OFDM Scheme
In MB-OFDM scheme [5], the 3.1–10.6 GHz UWB band-
width is divided into fourteen sub-bands, each with 528 MHz.
An OFDM symbol is transmitted within one sub-band. In each
sub-band, a total number of 128 orthogonal subcarriers are
used for data transmission.
In a UWB transmitter, the outgoing data packet is ﬁrst
encoded using punctured convolutional code. Then, the coded
data is interleaved and modulated into a series of complex
M-QAM symbols Sn = [Sn(0), Sn(1), ..., Sn(N − 1)]T of
length N = 128, where column vector Sn represents the
nth transmitted OFDM symbol, and Sn(i) (i ∈ [0, N − 1])
stands for a single M-QAM symbol. Note that the system
performance is not addressed with the Forward Error Cor-
rection (FEC) coding in this paper. It is assumed that the
data packet transmitted is not encoded. The discrete N-
point Inverse Fast Fourier Transform (IFFT) is employed
to perform the subcarrier modulation. Thus, the frequency
domain signal Sn is transformed into a real-valued time
domain signal sn = FSn = [sn(0), sn(1), ..., sn(N − 1)]T ,
where F is a square IFFT matrix with (i, k)th entry as
F(i, k) =
1
√
N ej2πik/N (i, k ∈ [0, N − 1]). Since the subcarri-
ers are orthogonal to each other, there will be no Inter-Carrier-
Interference (ICI) between the si modulated subcarriers. Note
that the transmission channel modeled as a linear time invari-
ant channel during the transmission of a data packet.
The
ith
received
time
domain
sequence
ri
=
[ri(0), ri(1), ..., ri(N − 1)]T is the result of the linear convo-
lution between h(l) and si = [si(0), si(1), ..., si(N − 1)]T
ri(n) =
L−1
X
l=0
si(l)h(n − l) + η(n).
(6)
Thus, the ith received frame ri can be expressed as
ri = hsi + ηi,
(7)
where h is a N × N Toeplitz matrix which can transfer the
above convolution operation into a matrix multiplication [7],
i.e.
h =












h(0)
0
0
. . .
0
h(1)
h(0)
0
. . .
0
...
...
...
...
...
h(L − 1)
h(L − 2)
. . .
. . .
0
...
...
...
...
...
0
0
h(L − 1)
. . .
h(0)












. (8)
However, if the ith frame si is transmitted immediately after
the i − 1th frame si−1, the ﬁrst L − 1 symbols of si will be
corrupted by the delayed version of the last L symbols of si−1.
When the (N − L + 1)th symbol si−1(N − L + 1) of si−1
is transmitted at time (N − L + 1)Ts, the delayed component
of si−1(N − L + 1) will last (L − 1)Ts and corrupt with the
ﬁrst symbol of si at time LTs. Thus, the delayed component
of the last symbol si−1(N −1) transmitted at time (N −1)Ts
will corrupt with the ﬁrst (L−1)th symbol of si. This type of
corruption is so-called Inter-Frame-Interference (IFI) or Inter-
Block-Interference (IBI).
Hence, the received frame is expressed as
ri = hsi + hdsi−1 + ηi,
(9)
where hd is also a N × N Toeplitz matrix
hd =












0
. . .
h(L − 1)
. . .
h(1)
0
. . .
0
. . .
0
...
...
...
...
...
0
. . .
0
. . .
h(L − 1)
...
...
...
...
...
0
. . .
0
. . .
0












.
(10)
To eliminate the corruption between received frames, the
time domain sequence sn is tail attached by a zero-padded
sufﬁx (ZPS) of length L [5]. More importantly, appending
the ZPS can manipulate the linear convolution between sn
and the UWB channel impulse response h(t) into a circu-
lar convolution by implementing the time-domain aliasing
123
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

[21]. Thus, the ith received frequency domain signal, Rn =
[Rn(0), Rn(1), ..., Rn(N − 1)]T , can be expressed as
Rn = F−1 ˜HFSn + ηn,
(11)
where ηn is the noise ﬁgure, and ˜H = RhZ is a N ×N circu-
lant matrix with its (i, l)th entry given by h((i − l) mod N),
where R and Z are the ZPS attaching and removing matrix [7].
The expression F−1 ˜HF = H = diag[H(0), H(1), ..., H(N −
1)] is a N×N diagonal matrix. By taking the fourier transform
of h(t), the transfer function of the ith MB-OFDM UWB
subcarrier H(i) (i ∈ [0, N − 1]) can be obtained. H(i) is
speciﬁed as
H(i) = H(2πi/N) =
L−1
X
l=0
h(l)e−j2πil/N,
(12)
It is assumed that H(i) is known at the receiver. Figure 2
shows an example of channel frequency response for CM3.
D. Cognitive MB-OFDM UWB Systems
In this paper, it is considered that the cognitive UWB
systems can only access the spectrum of the subcarrier when
the spectrum is not occupied by any primary user. Thus, the
spectrum sensing process determines the probability that a
subcarrier is utilized by the cognitive UWB system. The key
parameters for evaluating the performance of sensing are the
probability of a false alarm Pf and the probability of detection
Pd [22]. An energy detection method is adopted in this work,
since energy detection does not need any information of the
signal to be detected and is robust to unknown dispersed
channel and fading [23].
The amount of time needed for a successful spectrum
sensing is denoted as a sensing period τs. The fraction of
time for data transmission is limited by the value of τs as
α =
Ttxop−τs
Ttxop
, where Ttxop is a pre-deﬁned transmission
period in the UWB MAC layer for different Access Categories
(ACs) [24], called Transmission Opportunity (TXOP). An
application with Ttxop = 512 µs (ACs) is chosen in this work
to be activated in the cognitive UWB system.
For an energy detector, the required sensing period τsi
according to the target probability of false alarm
˜
Pf and
probability of detection ˜
Pd can be determined as
τsi =
2
γ2pfs
(Q−1( ˜
Pf) − Q−1( ˜
Pd))2,
(13)
where Q(z) =
R ∞
z
1
√
2πe−y2/2dy is the complementary distri-
bution function of the standard Gaussian, γp is the received
Signal-To-Noise Ratio (SNR) of the primary user signals
(SNRp) at the cognitive UWB user, and fs is the UWB
receiver sampling frequency [23].
IV. BER PERFORMANCE ANALYSIS
The averaged probability of error of MB-OFDM UWB
system is computed by integrating the error probability in
Additive White Gaussian Noise (AWGN) channel over the
UWB fading distribution. In (11), it is demonstrated that the
50
100
150
200
250
300
350
400
450
500
−40
−35
−30
−25
−20
−15
Channel Gain for CM3
Subcarrier Frequency (MHz)
Channel Gain (dB)
Fig. 2.
Frequency response over CM3
amplitude variations in the received signal are due to the
characteristics of the UWB multipath channel. Since αj in
(2) is modeled as a series of independent (uncorrelated) log-
normal random process, the distribution of the |H(i)| at the
ith subcarrier can be derived from the manipulating the sum
of independent log-normal variables αj. Although an exact
closed-form expression for the probability density function
(PDF) of a sum of independent log-normal random variables
does not exist, the superposition of log-normal variables can
be well approximated by a new log-normal distribution using
Fenton-Wilkinson method [6].
It is illustrated in (4) that the jth random variable x has the
Gaussian distribution
pX(x) =
1
√
2πσx
e
− (x−µx)2
2σ2x
,
(14)
where [µx, σx] are the mean and standard deviation of x. Then,
the probability distribution of ξj = 10xj/20 can be expressed
as a log-normal distribution:
pξ(ε) = 20/ln10
εσx
√
2π e
− (20log10ε−µx)2
2σ2x
.
(15)
The received signal amplitude |H(i)| = r on the ith sub-
carrier has the distribution of the sum of log-normal random
variables αj. There is a general consensus that the sum of
independent log-normal random variables can be approximated
by another log-normal random variable with appropriately
chosen parameters [25][26]. Therefore,
p(r) =
J
X
j=1
10ξj/20 = 10Z/20 =
ˆ
p(r),
(16)
where Z is a Gaussian random variable with mean µz and
variance σ2
z.
In Fenton-Wilkinson method, the value of µz and σ2
z can
be calculated by
µz = ξ−1(
σ2
ˆξ − σ2
ˆz
2
+ ln(
J
X
j=1
e ˆ
µj)),
(17)
σ2
z = ξ−2(ln((eσ2
ˆ
ξ − 1)
PJ
j=1 e2 ˆ
µj
(PJ
j=1 e ˆ
µj)2 + 1)),
(18)
124
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

where ξ = ln10/20, σ2
ˆξ = ξ2σ2, and ˆµj = ξµj.
Therefore, the distribution of the received signal amplitude
r can be expressed as
p(r) = 20/ln10
rσz
√
2π e
− (20log(r)−µz)2
2σ2z
.
(19)
From (19), the distribution of the received SNR per symbol
pγs(γ) can be expressed as
pγs(γ) = 10/ln10
γσz
√
2π e
− (10log(γN0/Es)−µz)2
2σ2z
.
(20)
For more convenient calculation of pγs(γ), the parameter
N0/Es can be replaced with E(r2)γ/ ¯γs in the equation above
since the average SNR per symbol ¯γs = E(r2) Es
N0 , where
E(r2) is the mean value of the signal power distribution. The
expression of E(r2) can be easily derived by manipulating
(19) and expressed as
E(r2) = E(R) = e
µz
10/ln10 +
σ2
z
2∗(10/ln10)2 .
(21)
The averaged probability of symbol error and bit error in
UWB multipath fading channel can be computed by averaging
the error probability in AWGN Ps(γ) over the UWB fading
distribution pγs(γ) [27]:
¯Ps =
Z ∞
0
Ps(γ)pγs(γ)dγ.
(22)
In arriving at the error rate results in equations, it is assumed
that timing and frequency synchronization is perfect. In such
a case, the expressions in equations should be viewed as
representing the best achievable performance in the presence
of log-normal fading.
For rectangular M-ary QAM modulation with coherence
detection, the BER calculation in AWGN channel is expressed
as
Pb(γ) = 4(
√
M − 1)
√
Mlog2M
Q(
r
3 ¯γblog2M
M − 1
),
(23)
where Q(x) =
1
√
2π
R ∞
x e−t2/2dt, x ≤ 0.
By replacing the (23) into (22), the BER performance for
different M-QAM modulations in CM1 and for QPSK in
different UWB channel models is shown in Figure 3 and
Figure 4, respectively. For comparison purposes, the BER
curves in AWGN channel and Rayleigh fading channel are
also provided. It is observed from the ﬁgures that the BER
performance for QPSK in UWB fading channel is better
than that in Rayleigh fading channels. Furthermore, the BER
performance is better in the UWB channel models with less
severe multipath fading [5][28].
V. SPECTRAL EFFICIENCY ANALYSIS
On the basis of the analysis of the BER performance in MB-
OFDM UWB systems, the spectral efﬁciency with equal power
allocation and equal bit allocation is analyzed in this section.
The objective of this section is to demonstrate the motivation
of proposing a dynamic power and bit allocation algorithm.
The performance analyzed in this section will be compared
0
1
2
3
4
5
6
7
8
9
10
10
−4
10
−3
10
−2
10
−1
10
0
Probability of a bit error for Different M−ary QAM
SNR per bit (dB)
Probability of a bit error for Different M−ary QAM
 
 
BPSK
QPSK
8QAM
16QAM
Fig. 3.
BER for Different MQAM in CM1
0
1
2
3
4
5
6
7
8
9
10
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
Probability of a bit error for 4QAM
SNR per bit (dB)
Probability of a bit error for 4QAM
 
 
AWGN Channel
Rayleigh Fading
Lognormal Fading CM4
Lognormal Fading CM3
Lognormal Fading CM2
Lognormal Fading CM1
Fig. 4.
BER for Different Channel Models
with the performance of the proposed allocation algorithm in
the next section.
In the MB-OFDM UWB system, the total available trans-
mitted power can be denoted as Pav. Since the maximum
mean PSD for UWB system is limited to -41.3dBm/MHz, the
average maximum allowable transmitted power of the system
Pmax can be approximated as
Pmax (dB) = −41.3 dBm/MHz + 10log10(fH − fL), (24)
where fH and fL denote the higher and lower frequency of
the operating bandwidth in MHz [5]. When the total available
transmitted power is Pav = Pmax, it is intuitively clear that to
maximize the total number of bits which can be allocated into
a subband under the power and BER constraints, the optimal
strategy should be to equally allocate the transmitted power
Pt(i) = ˜Pmax = Pav/N to each subcarrier [27]. The spectral
efﬁciency performance with equal power allocation is analyzed
when the available power Pav < Pmax.
125
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

54
56
58
60
62
64
66
68
70
72
74
−8
−6
−4
Equal Power Allocation
Power (dBm)
54
56
58
60
62
64
66
68
70
72
74
0
2
4
UWB Fading Channel Gain
Channel Gain (dB)
54
56
58
60
62
64
66
68
70
72
74
1
2
3
Bit Allocation per Subcarrier
OFDM Subcarrier No.
Bit Allocation (bit)
Fig. 5.
Bit Allocation in CM1
−30
−28
−26
−24
−22
−20
−18
−16
−14
0
0.5
1
1.5
2
2.5
Total Transmit Power per OFDM Symbol (dBm)
Spectral Efficiency (bps/Hz)
Spectral Efficiency with Equal Power Allocation
 
 
Spectral Efficiency in CM2
Spectral Efficiency in CM1
Spectral Efficiency in CM3
Fig. 6.
Spectral Efﬁciency in CM1
The data bits are dynamically allocated in the OFDM
UWB transmitter when the total transmitted power is equally
allocated, as illustrated in Figure 5. In this ﬁgure, it is observed
that there are more bits being allocated to the subcarriers
with higher channel gain (less channel multipath fading).
Furthermore, the performance of the spectral efﬁciency in
CM1 to CM3 as a function of the total transmitted power per
OFDM symbol is illustrated in Figure 6. It can be seen that the
spectral efﬁciency is increased exponentially as the transmitted
power increases. The allocation algorithm discussed in the next
section can signiﬁcantly increase the spectral efﬁciency under
the constraints from the primary users while keep the number
of iterations to convergence small.
VI. DYNAMIC POWER AND BIT ALLOCATION SCHEME
In this section, the proposed dynamic power and bit allo-
cation algorithm is presented. The spectral efﬁciency maxi-
mization algorithm is divided into four sections. These are:
spectrum sensing, M-QAM zones generation, primary power
and bit allocation and advanced power and bit allocation.
TABLE I
SPECTRAL EFFICIENCY MAXIMIZATION ALGORITHM
Step
Operations
Step 1
Sense the operating channel, and access the available sub-
carriers of which the target
˜
Pf and
˜
Pd are achieved for
M-QAM zones generation in step 2.
Step 2
Generate a series of M-QAM zones in each available
subcarrier by determining the minimum required transmitted
power Pk(i) of the ith subcarrier for reliable reception of
the kth order M-QAM symbol.
Step 3
Equally allocate the total available power Pav among all
the N subcarriers in a sub-band, and specify the order of
the M-QAM to use in each subcarrier by identifying the
M-QAM zones Zk(i) where Pt(i) falls in.
Step 4
Collect the excessively allocated power in step 3, and iter-
atively allocate the collected power using greedy algorithm
to the subcarrier that requires the least additional power for
using a higher order M-QAM while Pt(i) < ˜Pmax.
In the proposed algorithm, the steps of spectral efﬁciency
maximization are summarized in Table I and described in
detail as follows.
A. Optimization Problem Formulation
The optimization problem is formulated as follows:
arg maxPt(i)
N
X
i=1
B(i), B(i) ⊆ Z,
(25)
subject to
pe ≤ ˜pe
(26)
0 ≤ Pav ≤ Pmax
(27)
0 ≤ Pt(i) ≤ ˜Pmax
(28)
˜
Pd ≤ Pd ≤ 1, 0 ≤ Pf ≤ ˜
Pf,
(29)
where in (25), the parameter Pt(i) is the power allocated to
the ith subcarrier for data transmission, N is the total number
of the UWB subcarriers, and B(i) is an integer number of the
loaded information bits in the ith subcarrier under conditions.
In (26), pe is the BER of the system, and ˜pe is the required
BER of the MB-OFDM UWB system.
It is observed from (25) to (29) that the spectral efﬁciency
maximization problem in MB-OFDM UWB systems is a non-
convex optimization problem which is NP-hard [29], since the
variable B(i) in the objective function (25) is limited to some
integer value. To effectively solve this optimization problem,
the heuristic greedy algorithm [11] is adopted in this paper.
B. Spectrum Sensing
The spectrum sensing procedure determines the probability
that a subcarrier is utilized by the cognitive UWB system. The
procedure also determines the fraction of time for UWB data
transmission αi in the ith subcarrier. Thus, the number of the
loaded information bits in the ith subcarrier under conditions
B(i) in (25) can be expressed as
B(i) = B(i)αi(1 − Pf)(1 − P(H1i)),
(30)
where B(i) is the bits loaded in the ith subcarrier, and
P(H1i) is the probability that the primary user is transmitting
126
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

or receiving within the spectrum of the ith subcarrier. It is
assumed that the value of P(H1i) follow a Poisson process
with intensity set to λ = 1, which represents the average
number of transmissions per 1ms from the primary users.
Hence, P(H1i) = p(1; λTtxopi), where p(x; λt) = e−λt(λt)x
x!
.
For simplicity, the parameter Pf in (30) is approximated by
Pf = ˜
Pf.
C. M-ary QAM Zones Generation
The M-QAM modulation constellation size Mk(i) is re-
stricted to Mk(i) = 2k, (k = 1, 2, 3, ..., K). The rectangular
QAM is assumed when k > 1 due to energy efﬁciency
and ease of implementation [21]. It is considered that the
cognitive UWB users can gather the instantaneous channel
state information (CSI) of all links [27]. Thus, the minimum
required transmitted power Pk(i) in the ith subcarrier for
reliable reception of the kth order M-QAM symbol can be
determined as discussed in Section IV.
Then,
a
series
of
M-QAM
zones
Zk(i),
(k
=
0, 1, 2, 3, ..., K) are generated by assigning
Zk(i) = [Pk(i), Pk+1(i))
k > 0
(31)
Z0(i) = [P0(i), P1(i))
k = 0,
(32)
where [·) represents a half-open interval, and P0(i) = 0 means
that no transmission power is required. The kth order M-QAM
will be used in the ith subcarrier when the allocated power
Pt(i) ∈ Zk(i). Figure 7 shows the M-QAM zone generation.
Five M-QAM zones are generated for each subcarrier. For ex-
ample, the required transmitted power Pk(3)(k = {1, 2, 3, 4})
in the subcarrier-3 is lower than Pk(2) in the subcarrier-2 for
each kth order M-QAM due to the higher channel gain of the
subcarrier-3.
D. Primary Power and Bit Allocation
In the step 3 of the algorithm, the transmitter initially splits
Pav equally among all the N subcarriers in a sub-band as
Pt(i) = ¯Pt(i) = Pav/N. Therefore, the constellation size
B(i) allocated to the ith subcarrier can be determined as
B(i) = log2(Mk)α(i),
(33)
where α(i) = {0, 1} is the allocation coefﬁcient, and is
expressed as
α(i) =
(
1
Pt(i) ∈ Zk(i)
0
Pt(i) ∈ Z0(i).
(34)
An example is shown in Figure 7, where zero bit is assigned
to subcarrier-1 since ¯Pt(i) falls into the zone-0 of subcarrier-
1, while 2 bits are assigned to subcarrier-2 for 4-QAM since
¯Pt(i) falls into the zone-2 of subcarrier-2.
E. Advanced Power and Bit Allocation
It is noticeable in Figure 7 that ¯Pt(i) of each subcarrier
exceeds the required transmitted power Pk(i). Hence, at the
beginning of step 4, the transmitter decreases the allocated
power Pt(i) = ¯Pt(i) to Pt(i) = Pk(i)α(i). The excessive
1
2
3
4
5
−40
−35
−30
−25
−20
−15
−10
Channel Gain for CM3
Subcarrier Sequence Number
Channel Gain (dB)
1
2
3
4
5
−70
−60
−50
−40
−30
−20
−10
Subcarrier Sequence Number
Power Requirement (dBm)
Modulation Zones
 
 
Power Level for 16QAM
Power Level for 8QAM
Power Level for 4QAM
Power Level for 2QAM
Pt = Pav/N
Pt(2)
Pt(3)
Pt(4)
Pt(1) = 0
Excessive Power
ZONE 3
ZONE 2
ZONE 1
ZONE 0
ZONE 0
ZONE 1
ZONE 2
ZONE 3
ZONE 4
ZONE 4
ZONE 3
ZONE 2
ZONE 1
ZONE 0
ZONE 4
Fig. 7.
M-ary QAM zone generation over CM3
allocated power Pm is collected for the advanced allocation,
and is given by
Pm = Pav −
N−1
X
i=0
Pt(i).
(35)
Then, Pm is optimally distributed to the subcarriers by
using the greedy algorithm to maximize the number of bits to
be carried by each subcarrier [11]. Therefore, the additional
power ∆Pt = {∆Pt(i), (i ∈ [0, N − 1])} needed to promote
the order of the M-QAM in each subcarrier is determined by
∆Pt(i) = Pk+1(i) − Pk(i).
(36)
Next, the ith subcarrier with the minimum ∆Pt(i) =
min(∆Pt) is chosen to be promoted to use a higher order
M-QAM by assigning more power and bits to this subcarrier
when ∆Pt(i) ≤ Pm. Thus, Pt(i) and B(i) allocated to the ith
subcarrier are increased to
Pt(i) = Pt(i) + ∆Pt(i)
(37)
B(i) = B(i) + ∆B(i),
(38)
where ∆B(i) = log2(Mk+1) − log2(Mk)α(i).
After each iteration, Pm is decreased to
Pm = Pm −
J
X
j
min(∆Pt(j)), 0 ≤ j ≤ J ≤ N − 1, (39)
where j denotes the jth iteration, and J stands for the
advanced power and bit allocation. The process will be ter-
minated when Pm < ∆Pt(i) = min(∆Pt).
Finally, the expression PN
i=1 B(i) is maximized by imple-
menting the advanced allocation. The order-of-growth of the
proposed algorithm is (PN
i=1 B(i) − K)NlogN, where K is
the total number of bit allocated in the primary power and
bit allocation process. In the low-SNR regime such as UWB
systems, the primary power and bit allocation can signiﬁcantly
lower the total number of algorithm iterations [30].
127
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

VII. SIMULATION RESULTS
In the simulation, a scenario of a point-to-point communi-
cation between two cognitive UWB systems is investigated in
Matlab. It is assumed that the average number of transmissions
per 1ms from the primary users within the communication
ranges of the UWB systems follow a Poisson process. In
the analysis, the spectral efﬁciency is used as a performance
indicator of the spectral efﬁciency optimization algorithm. It is
derived from normalizing the data rate PN
i=1 B(i)/Ts respect
to the operating bandwidth W.
First, an implementation of the primary and advanced
allocation schemes is examined over CM3. Subsequently,
the spectral efﬁciency comparison between the primary and
advanced allocation is made under different SNR conditions.
Then, the optimized spectral efﬁciency versus target BER
˜pe over different channel models is analyzed. Finally, the
optimized spectral efﬁciency versus the number of the M-
QAM zones is discussed. The parameters of the UWB channel
model are listed in [5], and the other parameters used to obtain
the simulation results are summarized in Table II.
Furthermore, an application with Ttxop = 512 µs (ACs)
is chosen to be activated in the cognitive UWB system.
All the results assume a system with a subcarrier spacing
of 4.125MHz, N=128 subcarriers, and a Nyquist ﬁlter with
0% roll-off and bandwidth 528MHz. The receiver structure
employed in this work is based on a coherent detection that
assumes perfect channel estimation and no synchronization
errors. It is composed of a Discrete Fourier Transform (DFT)
demodulator block and parallel to serial converter.
Figure 8 and Figure 9 illustrate the primary and advanced
allocation over CM3 with ˜pe =1e-5, respectively. It is ob-
served in Figure 8 that subcarrier-69 is allocated with zero
power and bit in primary allocation due to a low corresponding
channel gain of -38 dB. During the advanced allocation, as
shown in Figure 9, Pm is iteratively assigned to a subcarrier
with the minimum ∆Pt(i) to allow the subcarrier to use the
higher level of M-QAM modulation. For example, subcarrier-
74 is promoted from 8-QAM to 16-QAM by increasing the
transmitted power from -48 dB to -42 dB. Each subcarrier is
allocated with the maximum possible order M-QAM until the
available power Pav is efﬁciently employed.
Furthermore, the spectral efﬁciency comparison between the
primary and advanced allocation over CM3 with the number
of M-QAM levels set to M = 4 is depicted in Figure 10. It
is also set ˜pe ∈[1e-7, 1e-5] and SNRp = γp to -20 dB and
-10 dB. The spectral efﬁciency is signiﬁcantly improved by
at least 25% when the advanced allocation is applied under
both SNRp conditions. Also, it is observed that the optimized
spectral efﬁciency is improved when the value of SNRp is
higher. This result is analyzed in Figure 11 in more detail.
It is illustrated in Figure 11 that the values of the optimized
spectral efﬁciency increase exponentially as the estimated
SNRp value is higher. It is observed that the improvement
in spectral efﬁciency is signiﬁcant when the SNRp increases
from -20 to -10 dB over CM3, and is minor when the value
TABLE II
SIMULATION PARAMETERS
Parameter
Value
Pav
<-14.1 dBm
˜
Pf
0.1
Pmax
-35.1 dBm
˜
Pd
0.9
fs
528 MHz
γp
[-20, -18, ..., 0] dB
Subcarrier No.
128
˜pe
1e-5∼1e-7
W
4.125 MHz
M-QAM
[2,3,4,8,16]
Ttxopi
512 µs
λ
1/ms
62
64
66
68
70
72
74
76
78
0
1
2
3
4
Primary Bit Allocation
Bit Allocation (bits)
62
64
66
68
70
72
74
76
78
−52
−50
−48
−46
−44
−42
Primary Power Allocation
Power Allocation (dBm)
62
64
66
68
70
72
74
76
78
−35
−30
−25
−20
−15
Channel Gain for CM3
Subcarrier Sequence Number
Channel Gain (dB)
Fig. 8.
Primary power and bit allocation
62
64
66
68
70
72
74
76
78
1
2
3
4
Advanced Bit Allocation
Bit Allocation (bits)
62
64
66
68
70
72
74
76
78
−46
−44
−42
−40
Advanced Power Allocation
Power Allocation (dBm)
62
64
66
68
70
72
74
76
78
−35
−30
−25
−20
−15
Channel Gain for CM3
Subcarrier Sequence Number
Channel Gain (dB)
Fig. 9.
Advanced power and bit allocation
of SNRp increases further. This is due to the fact that the
required sensing period τs decreases exponentially when SNRp
increase, as expressed in (13).
The choice of the number of M-QAM levels depends on
how fast the channel is changing as well as on the hardware
128
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

1
2
3
4
5
6
7
8
9
x 10
−6
0.8
1
1.2
1.4
1.6
BER Requirement
Spectral Efficiency (bps/Hz)
Spectral Efficiency Comparison
 
 
−10dB, Primary
−10dB, Advance
−20dB, Primary
−20dB, Advance
Fig. 10.
Primary allocation compared with Advanced allocation, four-point
QAM in CM3
constraints [31]. It is shown in Figure 12 that the improvement
in spectral efﬁciency is signiﬁcant when the number of M-
QAM zones increases from 1 to 4 over CM3, and is minor
when the number of M-QAM zones increases further. This
is due to the fact that the required transmitted power Pk(i)
for a high order M-QAM generally exceeds the maximum
allowable transmitted power ˜Pmax in a subcarrier under the
BER requirement ˜pe. Thus, to use a large number of M-QAM
levels is necessary only when max(Pk(i)) < ˜Pmax.
VIII. CONCLUSION AND FUTURE WORK
This paper presents a novel dynamic power and bit alloca-
tion scheme for spectral efﬁciency maximization in the cogni-
tive MB-OFDM UWB radio system. A new BER expression
is derived for an in-depth spectral efﬁciency analysis of UWB
multipath channel. The derivation is based on approximating
a sum of independent log-normal random variables as an-
other log-normal random variable using the Fenton-Wilkinson
method. Then, the performance of the spectral efﬁciency of
the UWB system with equal power allocation is analyzed.
This analysis demonstrates the motivation of the design of the
dynamic allocation algorithm. To optimize the spectral efﬁ-
ciency and facilitate the convergence of the dynamic allocation
algorithm within a small number of iterations, the optimization
algorithm is divided into four sections. The results show that
the spectral efﬁciency of the UWB systems is signiﬁcantly
improved when the advanced allocation is applied. The value
of the optimized spectral efﬁciency is signiﬁcantly improved
with the increase of the received SNRp value and the number
of the M-QAM zones. However, this improvement becomes
minor when the SNRp value and the number of the M-QAM
zones are large.
The uncoded BER expression derived in this work provides
a foundation for further study of the coded BER expression
with primary user and multiuser interference. More compre-
hensive analysis of the MB-OFDM UWB time and frequency
diversity can be conducted in time variant channel model.
Then, a new cognitive power and bit allocation algorithm can
be further explored and implemented.
−20
−18
−16
−14
−12
−10
−8
−6
−4
−2
0
1
1.2
1.4
1.6
1.8
2
SNRp (dB)
Spectral Efficiency (bps/Hz)
Spectral Efficiency of Different SNRp Values over CM3
 
 
BER = 1e−5
BER = 1e−6
BER = 1e−7
Fig. 11.
Optimal Spectral efﬁciency over CM3 with four-point QAM
1
2
3
4
5
6
7
0.4
0.6
0.8
1
1.2
1.4
Number of MQAM Modulation Levels
Spectral Efficiency (bps/Hz)
Spectral Efficiency of Different Number of Modulation Levels over CM3
 
 
BER = 1e−5
BER = 1e−6
BER = 1e−7
Fig. 12.
Optimal Spectral efﬁciency of different number of modulation levels
over CM3, SNRp = −20 dB
ACKNOWLEDGMENT
The authors wish to thank Michael Barry for his insight and
inspiration for the work.
Liaoyuan Zeng’s work on this paper is funded through
Irish Research Council for Science, Engineering & Technology
(IRCSET) Scholarship.
REFERENCES
[1] L. Zeng, S. McGrath, and E. Cano, “Rate maximization for Multiband
OFDM Ultra Wideband systems using adaptive power and bit loading al-
gorithm,” Proceedings of the 5th International Conference on Advanced
Telecommunications and Systems, pp. 369–374, May 2009.
[2] I. J. Mitola and G. Q. Maguire, “Cognitive radio: making software radios
more personal,” IEEE Magzine on Personal Communications, vol. 6,
no. 4, pp. 13–18, Aug. 1999.
[3] D. Zhang, Z. Tian, and G. Wei, “Spatial capacity of narrowband
vs. Ultra-Wideband cognitive radio systems,” IEEE Transactions on
Wireless Communications, vol. 7, no. 11, pp. 4670–4680, Nov. 2008.
[4] G. Bansal, M. J. Hossain, and V. K. Bhargava, “Optimal and suboptimal
power allocation schemes for OFDM-based cognitive radio systems,”
IEEE Transactions on Wireless Communications, vol. 7, no. 11, pp.
4710–4718, Nov. 2008.
[5] A. Batra, J. Balakrishnan, G. Aiello, J. Foerster, and A. Dabak, “Design
of a Multiband OFDM system for realistic UWB channel environments,”
IEEE Transactions on Microwave Theory Techconology, vol. 52, no. 9,
pp. 2123–2138, September 2004.
[6] N. Beaulieu, A. Abu-Dayya, and P. Mclane, “Estimating the distribution
of a sum of independent lognormal random variable,” IEEE Transactions
on Communications, vol. 43, pp. 2869–2873, December 1995.
129
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

[7] Z. Wang and G. Giannakis, “Wireless multicarrier communications
where Fourier meets Shannon,” IEEE Signal Processing Magzine,
vol. 17, no. 3, pp. 29–48, May 2000.
[8] A. Skelton and S. Fu, “An improved conditional maximum-likelihood
detector for noncoherent UWB communication,” IEEE Communications
Letters, vol. 13, no. 1, pp. 7–9, Jan. 2009.
[9] E. Hossain and V. Bhargava, Cognitive Wireless Communication Net-
works. New York, USA: Springer Science+Business Media, LLC, 2007.
[10] B. T. Ahmed and M. C. Ramon, “On the impact of Ultra-Wideband
(UWB) on macrocell downlink of umts and CDMA-450 systems,” IEEE
Transactions on Electromagnetic Compatibility, vol. 50, no. 2, pp. 406–
412, May 2008.
[11] T. Cormen, C. Leiserson, R. Rivest, and C. Stein, Introduction to
Algorithms, 2nd ed.
Boston, USA: The MIT Press, 2001.
[12] Y. Chen, G. Yu, Z. Zhang, H. H. Chen, and P. Qiu, “On cognitive radio
networks with opportunistic power control strategies in fading channels,”
IEEE Transactions on Wireless Communications, vol. 7, no. 7, pp. 2752–
2760, 2008.
[13] W. Siriwongpairat, W. Su, and K. Liu, “Performance characterization of
Multiband UWB communication systems using poisson cluster arriving
fading paths,” IEEE Journal on Selected Areas in Communications,
vol. 24, no. 4, pp. 745–751, April 2006.
[14] H. Lai, W. Siriwongpairat, and K. Liu, “Performance analysis of
Multiband OFDM UWB systems with imperfect synchronization and
intersymbol interference,” IEEE Journal of Selected Topics in Signal
Processing, vol. 1, no. 3, pp. 521–534, October 2007.
[15] C. Snow, L. Lampe, and R. Schober, “Performance analysis of Multiband
OFDM for UWB communication,” Proceedings of IEEE International
Conference on Communications, pp. 127–130, October 2008.
[16] “UWB channel modeling contribution from intel,” IEEE P802.15-
02/279-SG3a., Tech. Rep., 2002.
[17] S. Ghassemzadeh, R. Jana, C. Rice, W. Turin, and V. Tarokh, “Mea-
surement and modeling of an Ultra-Wide Bandwidth indoor channel,”
IEEE Transactions on Communications, vol. 52, no. 10, pp. 1786–1796,
October 2004.
[18] D. Cassioli, M. Win, and A. Molisch, “The Ultra-Wide Bandwidth
indoor channel: From statistical model to simulations,” IEEE Journal
on Selected Areas in Communications, vol. 20, no. 6, pp. 1247–1257,
August 2002.
[19] A. Molisch, “Ultrawideband propagation channels-theory, measurement,
and modeling,” IEEE Transactions on Vehicular Technology, vol. 54,
no. 5, pp. 1528–1545, September 2005.
[20] F. Zheng and T. Kaiser, “On the evaluation of channel capacity of UWB
indoor wireless systems,” IEEE Transactions on Signal Processing,
vol. 56, no. 12, pp. 6106–6113, Nov. 2008.
[21] J. G. Proakis, Digital Communications, 4th ed.
New York, USA:
McGraw-Hill, 2001.
[22] H. L. V. Trees, Detection, Estimation, and Modulation Theory.
New
York, USA: John Wiley and Sons, 1968.
[23] Y. Zeng and Y. C. Liang, “Spectrum sensing algorithms for cognitive
radio based on statistical covariances,” IEEE Transactions on Vehicular
Technology, vol. 58, no. 4, pp. 1804–1815, May 2009.
[24] “High rate Ultra Wideband phy and mac standard,” ECMA International,
Geneva, Tech. Rep., 2005.
[25] G. L. Stuber, Principles of Mobile Communication, 2nd ed.
New York,
USA: Kluwer Academic Publishers, 2002.
[26] W. H. Tranter, S. K. Sam, T. S. Rappaport, and K. L. Kosbar, Princi-
ples of Communication Systems Simulation with Wireless Applications.
United States of America: Prentice Hall, 2004.
[27] A. Goldsmith, Wireless Communications.
New York, USA: Cambridge
University Press, 2005.
[28] J. Montojo and L. Milstein, “Effects of imperfections on the performance
of OFDM systems,” IEEE Transactions on Communications, vol. 57,
no. 7, pp. 2060–2070, July 2009.
[29] S. Boyd and L. Vandenberghe, Convex Optimization.
Cambridge,
United Kingdom: Cambridge University Press, 2004.
[30] G. D. J. Forney and G. Ungerboeck, “Modulation and coding for linear
Gaussian channels,” IEEE Transactions on Information Theory, vol. 44,
no. 6, pp. 2384–2415, October 1998.
[31] A. J. Goldsmith and S. G. Chua, “Variable-rate variable-power MQAM
for fading channels,” IEEE Transactions on Communications, vol. 45,
no. 10, pp. 1218–1230, Oct. 1997.
130
International Journal on Advances in Telecommunications, vol 2 no 4, year 2009, http://www.iariajournals.org/telecommunications/

