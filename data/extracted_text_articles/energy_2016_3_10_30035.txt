Study of a Smart Energy Community PV and Storage Requirements
A Modeling Approach Towards Net-Zero Energy
Emilio J. Palacios-Garcia, Antonio Moreno-Munoz,
Isabel Santiago, Isabel M. Moreno-Garcia, and Rafael J. Real-Calvo
Department of Computer Architecture, Electronics and Electronic Technology
University of Cordoba
Cordoba, Spain
Email: {p92pagae, amoreno, el1sachi, p92mogai, rafael.real}@uco.es
Abstract—The paradigm of smart energy community refers to
a set of households that share a Microgrid and have local
renewable production and distributed energy storage. In this
context, the main issue is the low dispatchability of the renewable
generation, which requires large storage capacities to maximize
the degree of self-consumption. A more favorable scenario
is found when considering a grid connected system, which
reduces the dependence on the stochastic nature of renewable
resources, allowing the consumers to import energy from the
grid when neither local production nor storage is available.
Moreover, the surplus generation could also be injected into the
electrical network, having in some cases feed-in tariffs. Thus,
this paper aims to present a simulation scenario where the
interaction between a Smart Community with high penetration
of Photovoltaic generation and the main grid is studied, and how
this integration can drive to a net-zero energy system. Results
for self-consumption and self-generation indexes are presented for
different Photovoltaic power rates and storage capacities, showing
that net-zero smart energy communities are a plausible scenario
when bidirectional energy ﬂows with the grid are considered.
Keywords–smart energy community; solar power generation;
energy storage; load modeling; net-zero energy buildings.
I. INTRODUCTION
Among all the energy demand, the residential sector
represents an average 30% of the total energy consumption in
most of the developed countries, showing an upward trend in
the last 10-years period with an average growth of about 5% in
the European Countries. In parallel with the consumption, the
electricity production also presented an average 30% increment
from 1990 to 2010, but with a clear decrement of the energy
produced from solid fuels (18.8%) and a higher penetration of
new renewable sources whose annual average growth rate is
currently 7% [1].
However, the strong mutual dependence between the
renewable sources production and the weather conditions
reduces the operational ﬂexibility and the dispatchability of
these generations at utility-scale, and usually requires complex
forecasting models and high temporal resolution data in order
to assure and planning an uninterruptible power supply within
the quality standard requirements [2].
Due to the limitations of renewable resources, the classical
concept of a centralized grid is moving forward to a distributed
scheme, where the solar, wind or hydro production is not
tied to the grid, but to the load or the consumers, creating
small subsystems usually referred as Microgrids or Smart
Communities. These systems have more control capabilities
than a large network, can integrate different types of distributed
energy resources (DER), as well as energy storage systems
(ESS), and can be either connected or disconnected from the
main grid [3].
Nevertheless, the evaluation of the production and storage
requirements is the main issue in these networks and it
needs a previous knowledge of the electricity demanded
by the Microgrid or Smart Community and the available
production along the year. Moreover, in the case of DER,
both production and demand must be known with a sufﬁcient
resolution, especially in solar power system, where the
maximum production peak and the maximum power demand
are hardly ever coincident [4]. These models, together with the
usage of historical data of DER, constitute the main tools for
the estimation of the system requirements.
In this ﬁeld, high-resolution demand modeling techniques
have shown the ability to generate detailed consumption
proﬁles. These techniques do not only take into account the
seasonality of the consumption, but also predict the daily
variations which cause the non-time coincidence between
production and demand. In addition, some of these models
allow testing future scenarios or energy policies due to their
high ﬂexibility [5][6][7].
In addition, the impact of different DER penetration
rates has to be quantiﬁed in the context of load matching,
meaning the evaluation of the interplay between the DER, the
consumers’ demand and the availability of ESS. In this ﬁeld,
previous work has proposed a set of indexes that study this
relationship with different temporal resolutions [8][9].
In this paper, the beneﬁts of high-resolution modeling
techniques and the usage of real production data will be
addressed in the context of a smart energy community to
achieve a net-zero energy interaction during 1 year, but using
1-minute resolution data, so the variations in production and
consumption are taken into account.
The paper is structured as following. In Section II, the
methodology of the simulation model is discussed, exposing
the different parts that made up the simulation system. Section
III will provide and discuss the result obtained for the
simulation scenario. Finally, Section IV is dedicated to the
conclusions obtained from the study and the future works.
37
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-484-8
ENERGY 2016 : The Sixth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

II. METHODOLOGY
In order to study the interaction between the DER, the
ESS, the consumers’ consumption and the grid, a simulation
framework was developed. For this aim, a community
composed of 200 households is simulated which share a
common low voltage network and a unique feeder and whose
different blocks are represented in Figure 1.
Each household is considered to have different AC loads, as
well as on–site Photovoltaic (PV) generation and a local home
energy storage system (HESS). The PV panels are connected
through an unidirectional DC/AC converter to the household
network, whereas the home ESS converter is bi-directional.
In addition, each home has a bi-directional Smart Electricity
Meter to quantify the energy interchanged with the grid.
On the top of this conceptual deﬁnition, the DER and
HESS of each household are controlled by a centralized
Smart Community Energy Management System (SCEMS).
The different blocks are explained in the following sections.
A. Demand Model
The consumption proﬁles of each home were obtained
using a stochastic model based on Markov-Chains probability
theory and Monte-Carlo techniques. The model is composed
of four algorithmic blocks that estimate the daily occupancy
proﬁles, the lighting system demand, the consumption of
home appliances and the energy needs of cooling and heating
equipment respectively. The model was developed using the
JAVA high-level programming language, and the simulations
are requested and accessed through a RESTFul API.
The residents’ behavior is the common inﬂuence factor in
determining the energy consumption, as it has been shown by
previous work [10]. Therefore, the lower level block was the
one responsible for calculating the daily occupancy proﬁle for
a given household. The algorithm has a 10-minutes resolution,
and its input parameters comprise the number of residents, the
location and the type of day (weekday or weekend).
The occupancy model is based on non-homogeneous
Markov-Chains. Therefore, for each 10-minutes instant (144
in a day), the probability transition matrices were calculated.
For this aim, the Time Use Survey (TUS) was employed [11].
In this survey, carried out in most European countries, the
interviewees wrote down in a diary information about the
activities performed during the day, where they took place and
whether they were accompanied.
Above this block, and using the generated occupancy
proﬁles as an input dataset, the power demand was calculated
applying the three other blocks, each one with speciﬁc
inﬂuence factors and with a 1-minute resolution.
The lighting demand block is inﬂuenced by the solar
irradiance proﬁle, which determines the hours of the day
where it is more likely to have electricity consumption due
to the home lighting system. In addition, the lighting spots of
the household are randomly selected, based on a probability
distribution of lighting technologies and powers. As in the case
of the occupancy model, the lighting consumption block has
been already validated and published by the authors [5].
In the case of the appliances consumption block, besides
the occupancy proﬁle, the daily probability for different
activities was taken into account. These activities are: doing
PV Panels
Batteries
AC Loads
Bi-directional
Smart Meter
Transformer
Households
Wh
LV 400 V
MV 20 kV
Smart Community
Load Model
Production
Storage
Load Matching
PV Excess
Curtailment
Grid
Interaction
SCEMS
Figure 1. Conceptual Schema of the Smart Community being modeled.
the laundry, ironing, cleaning the house, watching the TV,
washing and dressing, cooking, and using the PC, and their
probability distributions were extracted from TUS. The usage
of each home appliance is linked to one of those activities.
Finally, the block that estimates the cooling and heating
consumption uses the daily ambient temperature proﬁles and
the annual seasonality as inﬂuence factors. In this way, the
usage of either cooling or heating systems could be determined
during the year, as well as the hours of the day with the higher
probability of consuming energy.
B. Production Data
The photovoltaic production was emulated using monitored
data, obtained from historical registers of a rooftop PV
installation located in Cordova (Cordoba), Spain, during 3
years. The system studied is composed of 3 similar sectors.
Each sector has 36 solar modules with a peak power of 165 W,
which results in a total peak power of 5,940 W per sector.
At the same time, the sectors are associated with an inverter
of 5,000 W. The inverters are capable of monitoring parameters
such as the input DC voltage and DC current, global irradiance,
output AC voltage and AC current, frequency and power, all
of them with a 5-minutes resolution.
The output AC power of each inverter was used for the
simulation since it already takes into account both the losses
and the efﬁciency of the system. This variable was linearly
scaled using the quotient between the selected PV peak per
household and the original one of the installation.
In addition, due to the different temporal resolutions of
the historical production data (5-minutes) and the consumption
model (1-minute), the output power of the inverter was linearly
interpolated. This approximation is fully justiﬁed, since the
power ﬂuctuations that might be produced by the clouds are
much slower.
C. Battery Storage
As it was indicated in Figure 1, each household is also
considered to have an attached HESS. For our study, a
simpliﬁed battery model was selected, whose basic operation
38
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-484-8
ENERGY 2016 : The Sixth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

is ruled by (1), which represents the charge and discharge
process, and whose operative range is denoted in (2).
EB(t) = EB(t −1)+T ·PB(t)
(1)
EBmin < EB(t) < EBmax
(2)
In this equation, t represents the simulation time in minutes,
EB(t) is the stored energy for each simulation step in Wh, PB is
the instant power applied to or supplied by the storage system
in W, and T is the simulation step, selected to be 1 minute, but
since EB is in Wh its value is 1/60. Regarding (2), EBmin is the
maximum discharge level sometimes referred as a percentage
of the maximum capacity and EBmax is the maximum charge
threshold.
Both EBmax and EBmin are the main inﬂuence parameters
in the simulation, since they will determine the effective
capacity of the system. Different technologies will differ in
the maximum deep of discharge that can be applied (EBmin).
Moreover, the maximum capacity of the system (EBmax) could
be varied along the years to simulate the aging effect, although
in this study, it has not been considered.
It should also be pointed out, that although the battery
system seems to be extremely simple, it allow us to represents
the basic operation of the ESS as an energy reservoir.
Nevertheless, current efforts are focused on the improvement
of this model, so performance ratios of different technologies,
as well as operation procedures, are included in the model.
D. Evaluation Indexes
The performance of DER for different values of PV power
and storage capacities for de HESS were analyzed with a set
dimensionless indicators. Two indicators were selected in order
to study the variations in the supply utilization, the percentage
of self-consumption and the amount of energy that can be
injected into the grid.
The ﬁrst index was the demand cover factor (DCF), which
evaluates the percentage of demand that can be supplied by
the PV power installed. The second was the supply cover
factor (SCF) that indicates the percentage of utilization of the
local generation. These two indicators are well deﬁned in the
literature, although different names are given for them [9][8].
Their expressions are indicated in (3) and (4) respectively,
where PPV(t) is the instantaneous PV production, PB(t) is
the instantaneous power supplied by (PB > 0) or applied
to (PB < 0) the battery, and PD(t) is the power demand.
Therefore, these indexes can be calculated for different periods
of time, but using the instantaneous power, so the non-temporal
coincidence between production and demand is considered.
DCF = ∑min[PPV(t)+PB(t),PD(t)]
∑PD(t)
(3)
SCF = ∑min[PPV(t)+PB(t),PD(t)]
∑(PPV(t)+PB(t))
(4)
E. SCEMS Strategy
The last block of the simulation is the SCEMS, which
controls the power interchange between the different units
in the system that are the consumer loads, the DER, the
HESS and the grid. The interaction deﬁned between the system
elements is indicated in Figure 2. It was implemented using
MATLAB-SIMULINK environment, so the production data
are loaded from a developed database, and the consumption
proﬁle obtained using the above-mentioned RESTFul service
of the demand consumption model.
Pnet(t) = PPV(t)−PD(t)
EB(t) = EB(t −1)+T ·Pnet(t)
if EB(t) > EBmax then
PG(t) = EBmax −EB(t)
EB(t) = EBmax
else if EB(t) < EBmin then
PG(t) = EBmin −EB(t)
EB(t) = EBmin
else
PG(t) = 0
end if
PB(t) = −[Pnet(t)+PG(t)] = PD(t)−PPV(t)−PG(t)
Figure 2. Pseudocode of the interaction between the PV generation, the
demand, the storage system and the main grid.
The control algorithm aims to maximize the autonomy of
the Smart Community, controlling the energy stored in the
HESS denoted as EB(t). Therefore, the distributed storage is
charged as soon as the different between PV production and
consumption Pnet is positive, (Pnet > 0) in order to accumulate
energy for the non-production period.
This process can continue until the batteries reach their full
charge (EBmax), in this moment, the smart community start to
interact with the grid and the production surplus that can not
be stored is injected into the grid (PG < 0).
On the other hand, when the available PV production
is too low or zero (Pnet < 0), the consumers’ demand is
supplied by the batteries until they reach the lower operative
threshold (EBmin), in this moment, the energy demanded by the
community is imported from the main grid (PG > 0).
After considering the above-exposed cases, the SCEMS
strategy determines the instantaneous power supplied by
(PB > 0) or applied to (PB < 0) the storage system, that will
be such that the net power sum equals zero without taking into
account additional losses in the system.
III. RESULTS
Following
the
previously
exposed
methodology,
a
simulation scenario is presented, where the inﬂuence of the
PV power and the storage capacity on the above-mentioned
indexes, according to the SCEMS strategy, in the context of
a 200 households community is studied.
The obtained results are shown in Figure 3, where the
X-Axis represents the installed PV power peak per household,
whereas the Y-Axis indicates either the annual DCF (solid
lines) or the annual SCF (dashed lines), calculated with
1-minute resolution during a whole year, using the real
production data, and the demand proﬁles simulated with the
exposed model. In addition, the different results for a set of
HESS capacities per house are illustrated in different colors.
39
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-484-8
ENERGY 2016 : The Sixth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

Figure 3 depicts that DCF (solid lines) increases when the
PV power peak increases, whereas the SCF (dashed lines) the
opposite trend is observed. In contrast, for a given PV power
peak, if the capacity of the HESS is increased both the DCF
and the SCF are improved, but not by the same percentage.
Further conclusions can be extracted if the interaction
between the DCF and the SCF is analyzed. Both indexes
intersect for a given battery capacity when the PV power peak
is variated. In these points, the SCF and DCF have the same
value, which means that the percentage of demand that cannot
be covered with the DER and the HESS equals the generation
that can be neither consumed nor stored.
0
1000 2000 3000 4000 5000 6000 7000 8000 900010000
PV Power Peak [W]
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
DCF (solid line) & SCF (dashed line)
0 Wh
1000 Wh
2000 Wh
3000 Wh
4000 Wh
5000 Wh
6000 Wh
Figure 3. SCF (dashed lines) and DCF (solid lines) variation with the
installed PV power and the storage capacity.
0
1000 2000 3000 4000 5000 6000 7000 8000 900010000
PV Power Peak [W]
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
DCF - SCF
0 Wh
1000 Wh
2000 Wh
3000 Wh
4000 Wh
5000 Wh
6000 Wh
Figure 4. Difference between DCF and SCF.
However, when the system is considered grid-connected,
the excess of generation (1−SCF) could be injected into the
grid, whereas the demand that cannot be covered (1 − DCF)
must be supplied from the main grid. Hence, in this point,
the exported and imported energy are similar, and the Smart
Community would achieve an annual net-zero energy.
Further conclusions can be extracted if the difference of
these both indexes is considered. As illustrated in Figure 4,
DCF, and SCF intersect always for a similar PV power peaks
independently of the battery capacity. This can be proved if
(3) is divided by (4) and the both terms are multiplied by the
time period T, so the power expressions can be transformed
into energy units.
DCF
SCF =
∑PD(t)·T
∑(PPV(t)+PB(t))·T =
ED
EPV +EB
(5)
In (5), the DCF equals the SCF if the consumed energy
during the day ED is similar to the energy produced EPV
plus the energy exchanged with the storage system EB.
Nevertheless, if the battery is considered to have a cycle per
day, the net energy exchanged with the storage system is null
and consequently, the intersection of both indexes only depend
on the match between generation and consumption.
From (5), it could also be seen that in an ideal context, no
battery storage will be necessary to achieve a net-zero energy
consumption throughout the year. Nevertheless, in this case,
all the produced energy that can be used should be injected to
the grid, which in some cases might produce an overload in
the existing networks toward the idea of hosting capacity.
If this is achieved, the net energy interchange with the
electrical grid will be zero along the year, providing the grid
has an inﬁnite capacity, whereas the storage capacity will
determine the additional level of the on-site generation that
could be later consumed.
IV. CONCLUSION AND FUTURE WORK
This paper has presented a comprehensible simulation
scenario where the beneﬁts of high temporal resolution models
and historical data in the estimation of DER power and
HESS requirements of a Smart Community have been shown
by means of a set of selected cover indexes, The results
have illustrated the possibility of achieving net-zero energy
communities if a grid interaction is considered.
More detailed simulation scenarios will be addressed in
following works, including parameters, such as the battery
performance or the inﬂuence of economic factors like feed-in
tariffs or variable energy prices. In addition, the system is
currently being analyzed in the context of Hosting Capacity,
which determines the maximum amount of PV power that can
be installed without affecting the quality and reliability of the
supply. Regarding this topic, future papers will be published.
ACKNOWLEDGMENT
This work is supported by the Spanish Ministry of
Economy
and
Competitiveness
under
Research
Project
SCEMS, TEC2013–47316–C3–1–P.
REFERENCES
[1]
Eurostat, “Energy, transport and environment indicators,” Publications
Ofﬁce of the European Union, Luxembourg, Tech. Rep., 2015.
[2]
J. Wid´en, E. W¨ackelg˚ard, J. Paatero, and P. Lund, “Impacts of different
data averaging times on statistical analysis of distributed domestic
photovoltaic systems,” Solar Energy, vol. 84, no. 3, March 2010, pp.
492–500.
[3]
P. Palensky and D. Dietrich, “Demand Side Management: Demand
Response, Intelligent Energy Systems, and Smart Loads,” IEEE
Transactions on Industrial Informatics, vol. 7, no. 3, August 2011, pp.
381–388.
[4]
S. Cao and K. Sir´en, “Impact of simulation time-resolution on the
matching of PV production and household electric demand,” Applied
Energy, vol. 128, September 2014, pp. 192–208.
[5]
E. J. Palacios-Garcia et al., “Stochastic model for lighting’s electricity
consumption in the residential sector. Impact of energy saving actions,”
Energy and Buildings, vol. 89, February 2015, pp. 245–259.
[6]
J. Wid´en and E. W¨ackelg˚ard, “A high-resolution stochastic model of
domestic activity patterns and electricity demand,” Applied Energy,
vol. 87, no. 6, June 2010, pp. 1880–1892.
[7]
I. Richardson, M. Thomson, D. Inﬁeld, and C. Clifford, “Domestic
electricity use: A high-resolution energy demand model,” Energy and
Buildings, vol. 42, no. 10, October 2010, pp. 1878–1887.
40
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-484-8
ENERGY 2016 : The Sixth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

[8]
I. Sartori, A. Napolitano, and K. Voss, “Net zero energy buildings: A
consistent deﬁnition framework,” Energy and Buildings, vol. 48, May
2012, pp. 220–232.
[9]
J. Salom, A. J. Marszal, J. Wid´en, J. Candanedo, and K. B. Lindberg,
“Analysis of load match and grid interaction indicators in net zero
energy buildings with simulated and monitored data,” Applied Energy,
vol. 136, December 2014, pp. 119–131.
[10]
M.
Lopez,
I.
Santiago,
D.
Trillo-Montero,
J.
Torriti,
and
A. Moreno-Munoz, “Analysis and modeling of active occupancy
of the residential sector in Spain: An indicator of residential electricity
consumption,” Energy Policy, vol. 62, November 2013, pp. 742–751.
[11]
National Statistics Institute of Spain. Ministry of Economy and
Competitiveness, “Time Use Survey,” Spain, Tech. Rep., 2010.
41
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-484-8
ENERGY 2016 : The Sixth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

