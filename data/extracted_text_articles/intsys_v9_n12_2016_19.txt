Stabilization of a Two-Wheeled Mobile Pendulum System using LQG and Fuzzy 
Control Techniques 
 
Ákos Odry, Péter Odry 
Dept. of Control Engineering and Information Technology 
University of Dunaújváros 
Dunaújváros, Hungary 
E-mail: odrya@mail.duf.hu, podry@mail.duf.hu 
János Fodor 
Institute of Intelligent Engineering Systems 
Óbuda University 
Budapest, Hungary 
E-mail: fodor@uni-obuda.hu
 
 
Abstract—This paper studies the control performances of 
modern and soft-computing based control solutions. Namely, 
the stabilization of a naturally unstable mechatronic system will 
be elaborated using linear-quadratic-Gaussian and cascade-
connected fuzzy control schemes. The mechatronic system is a 
special mobile robot (so called two-wheeled mobile pendulum 
system) that has only two contact points with the supporting 
surface and its center of mass is located under the wheel axis. 
Due to this mechanical structure, the inner body (which acts as 
a pendulum between the wheels) tends to oscillate during the 
translational motion of the robot, thus the application of 
feedback control is essential in order to stabilize the dynamical 
system. In the first part of the paper, the mechatronic system 
and the corresponding mathematical model are introduced, 
while in the second part the aforementioned control solutions 
are designed for the plant. The achieved control performances 
are analyzed both in simulation environment and on the real 
mechatronic system. At the end of the paper, a performance 
assessment of the elaborated control solutions is given based on 
transient response and error integral measurements. 
Keywords-Fuzzy control; LQG control; Kalman filter; mobile 
robot; self-balancing robot; future transportation system 
I. 
 INTRODUCTION 
Nowadays, technological developments face dynamical 
systems that are getting more and more complex and 
complicated by the day. These complex systems are 
characterized by high order dynamics, uncertain parameters, 
and most often, their nonlinear mathematical model is only 
approximately known (such as the analyzed system in the 
INTELLI 2015 paper [1]). Over the last few decades, we have 
seen that conventional and modern linear control techniques 
have been extensively applied in control development and 
industrial automation, however, their performance is always 
questioned, when systems with uncertainty and unmodeled 
dynamics are controlled. In general, these linear controllers do 
not work well for nonlinear vague systems [2]. On the other 
hand, Zadeh’s fuzzy logic and reasoning introduced a new 
control perspective, where imprecision and uncertainty form 
the basis of the inference mechanism [3]. Fuzzy logic control 
plays an important role in systems with unknown structure, 
and it has been widely used in automotive control 
applications. Thanks to its rapid progress, fuzzy reasoning is 
a fruitful research area for the Robotics and Control 
Community, where the achievable control performance and 
competitive control solutions are continuously investigated 
[4]. This paper studies the control performance of linear-
quadratic-Gaussian and fuzzy control techniques.  
The linear-quadratic-Gaussian (LQG) technique is a 
beloved method in the control of dynamical systems since it 
provides the optimal state feedback gain based on the well-
developed mathematical algorithm [5]. Numerous researches 
have been dealt with its application and control performance 
in real embedded environments. Divelbiss and Wen [6] 
presented their experimental results of the tracking control of 
a car-trailer system, where linear quadratic regulator was used 
to track the trajectory. Ji and Sul [7] proposed an LQG-based 
speed control method for torsional vibration suppression in a 
2-mass motor drive system, which gave satisfying 
performance and robust behavior against parameter 
variations. Recent efforts broaden further the set of 
experimental research results regarding the LQG control, 
including the control of inverted pendulum type assistant 
robot [8], self-balancing unicycle robot [9], unmanned 
helicopter in an uncertain environment [10], and quadrotor 
UAVs [11] as well.   
On the parallel thread, fuzzy logic control has also proved 
its competitive performance. Due to the provided flexibility 
and smoothness in the control action, and the linguistic 
information based design technique as well, it is applied more 
and more in dynamical systems. McLean and Matsuda [12] 
designed a fuzzy logic controller, which provided acceptable 
station-keeping performance for a single main rotor helicopter 
even in severe turbulences. Das and Kar [13] proposed 
adaptive fuzzy controllers for the robust control of 
nonholonomic mobile robots that were characterized with 
uncertain parameters. Lee and Gonzalez [14] examined the 
achieved control performance of the conventional PID and 
fuzzy techniques for position control of a muscle-like actuated 
arm. Moreover, fuzzy control was successfully applied in the 
development area of walking robots as well. Kecskés and 
Odry [15] elaborated the optimized fuzzy control of a hexapod 
walking robot called Szabad(ka)-II. Finally, fuzzy logic based 
stabilization of two-wheeled inverted pendulum systems has 
also been investigated both in simulation environment and on 
the real plant [17]. Many applications have been proposed 
where fuzzy control showed superior performance (such as 
[12], [15]), however, the opposite outcome was often claimed 
as well (such as in [14]). Therefore, the effective and 
223
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

beneficial applicability of fuzzy control still remains an 
important issue to be further addressed.   
The objective of this paper is to make an analysis, and give 
a comparative assessment regarding the achieved control 
performances of both control techniques. The robustness of 
the elaborated controllers will also be investigated using the 
simulation and measurement results. The controlled plant is a 
two wheeled mobile pendulum system [18] (hereinafter 
robot), whose dynamics is highly nonlinear, moreover, its 
mathematical model is characterized by uncertain parameters 
(the model has not been validated). It will be discussed what 
is the influence of the uncertain dynamics, and how it affects 
the achieved closed loop behavior of the real robot. The 
stabilization of the plant with the LQG technique has been 
investigated in [1], while in [19] a fuzzy control scheme has 
been designed. This paper summarizes the results of [1] and 
[19], and based on the evaluation of different step responses 
(where both the simulation and measurement results will be 
taken into account), the better control strategy will be 
identified. For the comparative assessment different error 
integrals (as quality measurement numbers) will be evaluated. 
The remainder of this paper is organized as follows. In 
Section II, the mechatronic structure of the robot is 
introduced, while in Section III, the corresponding nonlinear 
mathematical model is derived. In Section IV, the control task 
and the LQG and fuzzy control techniques are reviewed. 
Section V deals with the elaboration of the LQG control 
strategy, while Section VI describes the applied fuzzy control 
scheme. The simulation and implementation results of the 
elaborated control strategies are given in Sections VII and 
VIII, respectively. Section IX describes the comparative 
assessment based on the simulation and measurement results, 
while Section X contains the conclusions and the future work 
recommendations. 
II. 
THE FABRICATED MECHATRONIC SYSTEM 
The mechatronic system is a special mobile robot (so 
called two-wheeled mobile pendulum system) that consists of 
two wheels and a steel inner body (chassis). The wheels are 
actuated through DC motors attached to the body. As it can be 
seen in Figure 1, the diameter of the wheels is bigger than the 
diameter of the intermediate body, thus the robot has only two 
contact points with the supporting surface. Due to this 
mechanical structure, the inner body behaves as a pendulum 
between the stator and rotor of the applied DC motors, and 
tends to oscillate when the robot performs translational 
motion. 
Since the location of the center of mass of the robot can be 
under and above the wheel axis, two equilibrium points can be 
distinguished. Namely, the robot stays around its stable 
equilibrium point when the center of mass is located under the 
wheel axis. Therefore, around this state the translational 
motion of the robot is affected by the damped oscillation of its 
inner body. On the other hand, the robot is operated around its 
unstable equilibrium point when the center of mass is 
stabilized above the wheel axis. Around the unstable 
equilibrium point, the robot simultaneously performs 
translational motion and balances its inner body, which acts as 
an inverted pendulum. For video demonstration see the 
website [20]. 
The electronic construction is built around two 16-bit 
ultra-low-power 
Texas 
Instruments 
MSP430F2618 
microcontrollers (hereinafter MCU1 and MCU2). The applied 
sensors are summarized in Table I. The actuators are 3V 
geared DC micromotors (type: 1024N003S) manufactured by 
Faulhaber. The motors are driven with pulse width modulation 
(PWM) signals through Texas Instruments DRV592 drivers. 
The electronic system is supplied from stabilized 3.3V, the 
source is a 1 cell lithium-polymer (Li-Po) battery. A 16 MHz 
quartz oscillator is used as the system clock. 
Similar construction was built at the McGill University’s 
Centre for Intelligent Machines [21]. It was proven that the 
two contact point construction is characterized by the so called 
quasiholonomic property that eases the control of 
nonholonomic systems. Another corresponding two contact 
point construction is the electric Diwheel built by the School 
of Mechanical Engineering at the University of Adelaide [22]. 
III. 
MATHEMATICAL MODEL 
To be able to efficiently design the control algorithms of 
the system, its mathematical model has to be obtained first. 
Most of the electrical and mechanical parameters that 
characterize the robot dynamics (such as wheel radius or 
resistance of the motor) are quite accurately known from 
direct measurements, datasheets or from calculations 
performed by Solidworks, the rest of the parameters were 
experimentally tuned based on the measurements. 
We indicate with and  the angular displacements of 
the wheels, while with   the inclination angle of the 
 
Figure 1.   Photograph of the fabricated robot. 
TABLE I.              THE APPLIED SENSORS IN THE EMBEDDED ELECTRONICS 
Sensor 
Manufacturer 
Type 
Accelerometer 
STMicroelectronics 
LIS331DL 
Gyroscope 
STMicroelectronics 
L3G4200D 
Current sensors 
Texas Instruments 
INA198 
Incremental 
encoders 
Faulhaber 
PA2-100 
 
224
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

pendulum (inner body). The parameters that characterize the 
robot are summarized in Table VI in the appendix. The 
following notations will also be used:  =  as the yaw rate 
of the robot, and 	 = 
 as the linear speed of the robot, i.e., 
 =  − /, and 
 =  + /2. 
The motion of the system was determined by the help of 
the Lagrange equations [23], which lead us to the following 
equations of motion of the mechanical system [18]: 
 
 + ,  =  − , 
(1) 
where   denotes the 3-by 3 symmetric and positive 
definite inertia matrix, ,   denotes the 3-dimensional 
vector term including the Coriolis and centrifugal force terms 
and also the potential (gravity) force term. The Lagrange 
function and the exact elements of the matrices in (1) are 
described in the appendix. For the vector of generalized 
coordinates  = , ,   was chosen, since it contains 
the minimum number of independent coordinates that define 
the configuration of the system. The generalized external 
forces in (1) consist of the torques  that are produced by the 
motors and the effect of friction  that is modeled in the 
system [18]. The torques  are described by the differential 
equation (2), where the input voltages and currents of the 
motors are denoted with  = ,  and  = , . 
 
 = 1
! " − #$# %1
0
−1
0
1
−1'  − () 
 = #*# +
1
0
0
1
−1
−1
,  
(2) 
Regarding the effect of friction  , only viscous frictions 
were assumed. Namely, viscous friction was modelled at the 
bearings and between the wheels and the supporting surface: 
 
 = +
- + ./
0
−-
0
- + ./
−-
−-
−-
2-
, . 
(3) 
Based on (1) the state-space representation of the two-
wheel inverted pendulum system is obtained. With the state 
vector 1 = , ,  the state-space equation is [18]: 
 
12 = ℎ1, , 
ℎ1,  =
4
5
5
5
6

7 " −  − , )
1
! " − #$# %1
0
−1
0
1
−1'  − ()8
9
9
9
:
, 
;2 = 12. 
(4) 
Remark: In the simulation environment the state-space 
equation (4) was implemented, however, during the design of 
the LQG controllers the 6-dimensional version defined by the 
state vector 1 = ,  was used. This outcome was chosen 
because the current measurements were that noisy that the 
states  = ,  could not be used in the feedback. The 6-
dimensional model is derived by neglecting the inductance ! 
of the motors. 
IV. 
THE CONTROL TASK 
The anti-sway speed control of the robot was investigated 
in the analysis, e.g., such control strategies have been 
elaborated, which simultaneously minimize the oscillations 
(around the stable equilibrium point) of the inner body and 
ensures the translational motion of the robot: 
- 
lim
?→A 
2 = 	B for the linear speed of the robot, 
- 
lim
?→A 2 = B for the yaw rate of the robot, 
- 
lim
?→A 2 = 0 for the oscillation of the inner body, 
where 	B and B denote the desired values of the linear speed 
and yaw rate of the robot, respectively. In the following 
subsections, the applied control techniques and the 
elaboration procedures are reviewed. 
A. LQ control 
The linear-quadratic control addresses the issue of 
achieving a balance between good system response and 
control effort [5]. It is based on a developed mathematical 
algorithm, which results the optimal state-feedback gain K. 
The feedback gain K minimizes the quadratic cost function 
 
C1,  = 1
2 D1E
F1E + E
(E
G7
EHI
+ 1
2 1G
F1G, 
(5) 
where 1 ∈ ℝL  and  ∈ ℝM  are the state and input of the 
system described by its state-space equation, while F = F ∈
ℝL×L, F ≥ 0 and ( ∈ ℝM×M, ( > 0 are weighting matrixes. 
According to the LQ method, the state feedback matrix is 
given by Q = ( + RSR7RST , where S = S ≥ 0 is 
the unique solution of the Control Algebraic Riccati Equation 
(CARE). The optimal state-feedback E = −Q1E ensures the 
asymptotic stability of the closed loop system. The feedback 
matrix Q  is calculated by the built-in Matlab function 
lqrd(A,B,Q,R,Ts). Since the LQ control defined by the 
objective function (5) drives the system from the initial state 
1I to the state 1B = 0, the control structure shall be extended 
with the reference tracking matrices: 
 
UVW
VXY = %T − 
R
Z
0'
7
U0L×M
M Y, 
(6) 
where 0 and  are the zero and identity matrices, respectively 
(the sizes are given in the subscript). 
B. Kalman filtering 
In the development of the optimal LQ control strategy it 
is assumed that the state variables are measurable, and the 
system is not disturbed by either internal or external noises. 
225
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

However, in practice, the opposite situation is quite common, 
namely, that a part of the state vector is too noisy to be used 
directly in the feedback. The LQG strategy provides optimal 
control gain to stochastic, noisy systems by minimizing the 
expected value of the quadratic objective function (5). 
Based on the separation principle the LQG control 
strategy is given by the state-feedback E = −Q1[E, where Q 
is the optimal control gain determined by the LQ algorithm, 
while 1[E  state vector consists of the original states (those 
states of 1E that were not noisy) and the Kalman filter based 
estimation of the noisy states. Let us denote the unmeasurable 
or noisy states with \, than the corresponding noisy linear 
system can be given as: 
 
\E] = Φ\E + Γ`E + aE, 
bE = Ρ\E + dE, 
(7) 
where the process and measurement noises are indicated with 
a  and d,  respectively, and according to the stochastic 
hypothesis these noises are uncorrelated and their mean value 
is zero. In this case the Kalman filter algorithm provides the 
optimal estimation \e of the state \, i.e., fg\E − \eEh = 0 and 
f %\E − \eE\E − \eE
' → inf . The estimation algorithm 
can be found in [24]. 
Therefore, the design steps of the LQG control strategy are 
the following: i.) Linearization of the mathematical model 
around an equilibrium point, ii.) Controllability analysis, iii.) 
Specification of the weighting matrices, iv.) Calculation of 
the optimal control gain Q, v.) Identification of the noisy 
states, vi.) Specification of the noise covariance parameters 
of the filter, vii.) State estimation by Kalman filter and viii.) 
Application of the state feedback strategy E = −Q1[E. 
C. Fuzzy control 
Lofti A. Zadeh introduced the fuzzy sets [3] by extending 
the classical two-valued logic k0,1l  with the whole 
continuous interval m0,1n. Fuzzy reasoning is based on the 
application of these fuzzy sets, which result that the inference 
mechanism of a fuzzy logic controller is defined by simple IF-
THEN linguistic rules. Hence, there is no need to define 
certain models, instead the empirical rules and the 
approximate reasoning lead to a heuristically defined control 
strategy. The algorithm is composed of the following parts 
[25]. 
- 
Fuzzification: Mapping the available crisp measurements 
to the fuzzy interval m0,1n. The fuzzy interval describes 
the membership of the fuzzy input variable. The 
membership function of a fuzzy set T is denoted with 
op1 ∈ m0,1n, where 1 is the crisp measurement. 
- 
Inference machine: The fuzzy IF-THEN rules define the 
implication relation between the antecedents and 
consequents. The inference mechanism consists of 
assigning the so-called firing level to the output fuzzy set 
defined in each rule. The firing level represents the result 
of the antecedent evaluation. The aggregation procedure 
is the last part of the inference machine, where the output 
fuzzy sets are combined into a single fuzzy set (overall 
fuzzy output is calculated). 
- 
Defuzzification: Mapping back the output fuzzy set to 
crisp domain. The most popular defuzzification methods 
are the center of gravity and the weighted average method 
[25]. 
The concrete elaboration procedure (e.g., selecting the fuzzy 
sets and fuzzy rules, defining the inference mechanism, and 
applying the defuzzification method as well) will be described 
in Section VI. 
V. 
ELABORATION OF THE LQG CONTROL STRATEGY  
The goal of the elaboration is to calculate the optimal state 
feedback and reference tracking matrices that drive the motors 
such a way that both the speed control of the robot and the 
suppression of the inner body oscillations are ensured. 
A. Optimal state feedback 
The linear state space equation is given by the 
linearization of (4) around the equilibrium 1q, q = 0,0: 
 
1 = Urℎ
r1Y
Ws,Xs
tuuvuuw
px
12 + Urℎ
rY
Ws,Xs
tuuvuuw
yx
2, 
(8) 
where the subscript 
 refers to the stable equilibrium point. In 
order to reduce the complexity of implementation the  1z =
{1 = 
, , 
, , , 
 coordinate 
transformation 
is 
applied. The resulting state-space representation is given as: 
 
1z = |
0×

0×
T}~,
T}~,
0×
0×
0×
T}~,
• 1z + |
0×
R€~,
R€~,
• , 
; = g0×
Z}~,
Z}~,h1z, 
(9) 
where the block matrices are described in the appendix.  
The controllability matrix [5] is given by • =
mR
TR
…
TƒRnp€x,y€x  and the evaluation of its rank 
results rank • = 4. Therefore, according to the Kalman 
rank condition for controllability (KRCC) the system (9) is 
not controllable, since the dimension of the state vector is 
dim 1z = 6. The non-controllable states of 1z are the position 

 and the orientation .  
Thus, a new coordinate transformation d = {ŠŠ̅1z  is 
defined, such that  {ŠŠ̅ = {Š, {Š̅  is a basis for ℝŒ , 
furthermore the columns of {Š  form the basis for the 
controllable subspace, dim {Š = 6 × 4 and dim {Š̅ =  6 × 2. 
The state-space representation becomes 
 
d = ŽTŠ
TŠŠ̅
0
TŠ̅ • d2 + %RŠ
0 ' 2, 
; = mZŠ
ZŠ̅nd2, 
(10) 
where, as a consequence of the definition, the state vector d =
dŠ, dŠ̅  is clearly devided into two parts, namely dŠ =
226
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

, 
, , 
  denotes the controllable states, while dŠ̅ =

,  contains the uncontrollable ones. 
The LQ strategy is elaborated by using the controllable 
subsystem TŠ, RŠ. The weighting matrices F = diagF‘‘ 
and ( = diagR““ were defined based on the Bryson’s rule, 
where F = 15 ∙ –/1807, F = 0.087, F = 50 ∙
–/1807 , F˜˜ = 50 ∙ –/1807  and ( = ( = 37 
were chosen. Solving the CARE the optimal control gain is 
 
Q~ = %−1.75
−1.26
−0.2
−0.61
−1.75
−1.26
−0.2
+0.61', 
(11) 
while the reference tracking matrices are 
 
VW
~ = |
 −0.41
0
1
0
0
0
0
1
• ,
VX
~ = %4.28
−0.37
4.28
+0.37'. 
(12) 
B. Kalman filtering 
The Kalman filter is used to estimate the tilt angle  of 
the inner body (second element of 1z). Since the accelerometer 
measures the projection of gravity vector onto its axes, the 
angle is given by ,•• = atan "
œ
•)  [26]. Unfortunately, 
,•• is very noisy, in the most control methods it cannot be 
considered as an accurate derived quantity at high frequency 
rates of rotation because the accelerometer measures both the 
static acceleration of the gravity and the dynamic acceleration 
of the robot as well. Thus, it is common to consider the 
gyroscope and accelerometer sensors as a noisy linear system 
and use the Kalman filter to estimate the state vector. The 
corresponding state-space equation is given as: 
 
\E] = %1
−1/.~
0
1
' \E + %1/.~
0 ' `E + aE 
bE = m1
0n\E + dE, 
(13) 
where the state vector \ = , z consists of the inclination 
angle mradn , and the bias of the gyroscope zmrad/sn . 
Furthermore, the input of the linear system is the angular 
velocity ` = mrad/sn (measured by the gyroscope), while 
the output of the system is the derived angle b = ,••mradn 
from the pure accelerometer measurements. The covariance 
matrices that characterize the measurement and state noises 
were defined based on offline measurements. 
C. The LQG control strategy 
According to the separation principle, the LQG control 
strategy is elaborated as follows. Around the stable 
equilibrium point the state feedback E = −QŸ, 
, ,  
ensures asymptotic stability of the closed loop system, where 
Ÿ denotes the Kalman filter based estimation of the tilt angle 
of the inner body and the optimal control gain Q is defined 
by (11). The detailed control structure is depicted in Figure 
2. 
VI. 
ELABORATION OF THE FUZZY CONTROL STRATEGY 
The elaboration of the fuzzy control strategy consisted of 
defining the fuzzy logic controllers and a control scheme that 
satisfies the requirements of the anti-sway speed controller of 
the robot. This procedure was started by aggregating the 
deductions related to the behavior of the dynamical system 
using human common sense. The investigation resulted a 
control scheme that consists of three cascade-connected FLCs 
(hereinafter FLC1, FLC2, and FLC3). The control structure is 
depicted in Figure 3 [19]. 
FLC1 ensures the speed control of the robot. The input of 
the controller is the speed error  ¡¢ = 	B¢ − £¢, while 
the output is the variation Δ¡¢ of the control voltage ¡¢. 
An integrator is attached to the output of the controller, 
therefore, a PI-type FLC has been defined with the fuzzy rules 
defined in Table II, where the antecedent is  ¡ . Both the 
ranges of the input and output variables, and the membership 
functions are depicted in Figure 4. For the defuzzification of 
the output fuzzy set, the weighted average method has been 
chosen, therefore, the crisp control voltage ¡ for the speed 
control of the robot is defined as: 
 
¡¢ = ¡¢ − 1 +
∑
o“ ¡¢ ∙ b“

“H
∑
o“ ¡¢

“H
, 
(14) 
 
Figure 2.   Detailed structure of the LQG control strategy. 
227
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

where o“∙ returns the membership degree of the antecedent 
 ¡¢  related to the ¦ th-rule, and b“  is the singleton 
consequent. 
FLC2 is responsible for the suppression of the resulting 
inner body oscillations. The inputs of the controller are the 
error of the oscillation angle  §¨¢ and its derivative  ©¨¢, 
while the output is the control voltage §¨ that shall be applied 
in order to decrease the acceleration of the robot. By 
decreasing the acceleration, the inner body oscillation is 
suppressed. FLC2 works as a PD-type fuzzy controller, whose 
fuzzy rules are indicated in Table II (the antecedents are the 
errors  §¨ and  ©¨). The universes of discourse of the input 
variables are depicted in Figure 4. The crisp output of the 
controller is calculated using the weighted average method: 
 
§¨¢ =
∑
min Uo“ " §¨¢,  ©¨¢)Y ∙ b“
ª
“H
∑
min Uo“ " §¨¢,  ©¨¢)Y
ª
“H
. 
(15) 
Finally, FLC3 ensures the yaw rate control of the robot. The 
input of the controller is the yaw rate error  «¢ = B¢ −
¢ , while the output is the variation Δ«¢  of the 
compensation voltage «¢. Similarly to FLC1, a PI-type 
fuzzy logic controller has been defined, whose fuzzy rules and 
membership functions are given in Table II and Figure 4, 
respectively. The crisp output of FLC3 is given as: 
 
«¢ = «¢ − 1 +
∑
o“ «¢ ∙ b“

“H
∑
o“ «¢

“H
. 
(16) 
The control voltages of the motors can be identified based on 
Figure 3. 
 
 = ¡ + §¨ − « 
 = ¡ + §¨ + « 
(17) 
The membership functions related to all control variables 
were chosen with triangular shapes. For the inputs and outputs 
of every FLC three membership functions were selected 
uniformly distributed across their universes of discourse (see 
Figure 4). Table III summarizes the inference mechanism of 
all the employed FLCs, while the fuzzy rules for the PD-type 
and PI-type FLCs are shown in Table II. 
VII. SIMULATION RESULTS 
The simulation of the proposed control strategies was 
done in MATLAB Simulink environment. The fuzzy logic 
controllers were designed by the help of the Fuzzy Logic 
Toolbox of MATLAB. The simulation results of the closed 
loop behavior is depicted in Figure 5. 
 From the top, the first is the linear speed 
 of the robot, 
the second is the yaw rate  , the third is the resulting 
oscillation  of the inner body, while the last one is the 
applied voltage to the motors. The following reference 
signals were applied: 
- 
	B = k0.4, 0, −0.2, 0l mm/sn,   
- 
B = k0.5,0, −1.2,0l mrad/sn.  
TABLE II.              RULE BASE OF PD AND PI-TYPE FLCS 
PD-type 
 
 
 
 
PI-type (+integrator) 
Consequent 
Antecedent2 
 
 
 
 
 
N 
Z 
P 
 
 
Antecedent 
Antecedent1 
N 
P 
P 
Z 
 
N 
Z 
P 
Z 
P 
Z 
N 
 
Consequent 
P 
Z 
N 
P 
Z 
N 
N 
 
 
 
 
 
TABLE III.              PROPERTIES OF THE FLCS 
AND 
method 
OR 
method 
Implication 
Aggregation 
Defuzification 
MIN 
MAX 
MIN 
MAX 
Weighted 
average 
 
 
Figure 4.   Membership functions of the employed FLCs. 
 
Figure 3.   Block diagram of the fuzzy control scheme. 
228
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

The simulation results show that both the LQG control 
strategy and the cascade-connected fuzzy control scheme 
stabilized the dynamical system. It can be seen that the 
elaborated controllers simultaneously ensure the speed 
control (reference tracking performance is given in the first 
two subplots from the top of the figure) and the suppression 
of the inner body oscillations (third subplot). The dynamics 
of the plant was sampled at fixed .~ = 100 ¬d, which equals 
to the sampling frequency of the applied sensors. 
VIII. IMPLEMENTATION RESULTS 
The control algorithm was coded in C language. MCU2 
was programmed to work as an inertial measurement unit 
(IMU). Its main task is to read the sensor data (from 
accelerometer and gyroscope through SPI peripheral), and 
send a package consisting of ,•• , , and Ÿ to MCU1 
continuously in every {~ = 10 -
, where ,•• indicates the 
inclination angle (determined based on the pure accelerations 
measured by the accelerometer),   denotes the angular 
velocity of the pendulum (measured by the gyroscope), while 
Ÿ indicates the Kalman estimation of the inclination angle. 
MCU1 executes the chosen control algorithm based on the 
collected 
measurements. 
It 
receives 
the 
package 
,••, , Ÿ  from MCU2 and extends it with the 
instantaneous position and velocity of the robot 
, 
 based 
on the measurements collected from the incremental encoders. 
Once the measurements are updated, the chosen control 
algorithm updates the duty cycle of the PWM generator. 
Furthermore, the measurements are sent through a Bluetooth 
module with the frequency .~ = 100¬d. A GUI written in 
MATLAB records the measurements. 
Regarding the LQG control, the calculated optimal 
feedback gains (11) and reference tracking matrices (12) have 
been directly used for the calculation of the control voltages 
by weighting the measurement results. The implementation of 
the FLCs was based on the fuzzy surfaces, which define the 
crisp output as a function of the input variables. Therefore, 
three look-up table has been stored in the flash memory of the 
MCU, and the control voltage has been defined by searching 
in these tables based on the instantaneous measurements. 
The control performances are depicted in Figure 6. From 
the top, the first is the linear speed of the robot 
, the second 
is the yaw rate , the third is the angle  of the inner body, 
while the last one shows the applied voltages. It can be seen 
that both implemented control strategies successfully 
suppressed the oscillation of the inner body and ensured the 
speed control of the robot as well. In the experiment, the 
desired speed and yaw rate has been set to 0.4 m/s  and 
3 rad/s, respectively (dotted lines in Figure 6). In the next 
section, the control performances will be qualified by defining 
different error integral formulas and a comparative assessment 
will be given based on the simulation and measurement 
results. 
IX. 
COMPARISON OF THE CONTROL STRATEGIES 
For the comparison of the elaborated control strategies both 
the transient responses and the overall control performance 
has been analyzed as well. The comparison was based on the 
closed loop behavior in time domain. For the quality 
measurement of reference tracking and suppression of inner 
body oscillations four different error integrals have been 
evaluated, namely these measures are the Sum of absolute 
errors (SAE), Sum of square errors (SSE), Sum of discrete 
time-weighted absolute errors (STAE), and the Sum of 
discrete time-weighted square errors defined by (18) and (19), 
respectively: 
SAE  = D| i|
G
‘
,
SSE  = D  ¢
G
‘
, 
(18) 
STAE  = D 2¢| i|
G
‘
,
STSE  = D 2¢ ¢
G
‘
. 
(19) 
In (18) and (19), V denotes the length of the measurement, 
and   defines the error, which is the difference of the desired 
speeds and the actual speeds ( =  ¡ or  =  «) in case of 
 
Figure 5.   Closed loop behavior of the plant using the elaborated 
controllers (Simulation results). 
linear speed (m/s)
yaw rate (1/s)
pendulum angle (deg)
applied voltage (V)
229
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

reference tracking, while in case of the suppression of the 
inner body oscillation  =  ©¨ = −³ (since the desired rate 
of oscillation is zero, see Section IV). It was important to 
evaluate these quality-measuring expressions, because the 
results of the evaluation will form the initial fitness function 
values of the optimization of the fuzzy controllers in the next 
step of the investigation.  
Based on the simulation and implementation results the 
qualitative characteristics of the elaborated controllers were 
summarized. The summary is given in Table IV, where {´µ¶· 
indicates the rise time, {ƒ% denotes the settling time and ovs. 
is used for the abbreviation of overshoot. According to the 
simulation results, the LQG control strategy provided faster 
closed loop behavior with smaller reference tracking 
overshoot. From Table IV, it can also be read that the 
elaborated fuzzy scheme satisfies the control requirements 
with much bigger overshoot (0.036 m/s at 0.4 m/s reference 
speed), and due to the PI-type controllers it provides less 
aggressive closed loop behavior then the linear controller. 
Regarding the suppression of the inner body oscillations, both 
controllers performed the task similarly; the overshoot (e.g., 
maximum oscillation angle) was between 25-30 degrees.  
These simulation results well predicted the outcome of the 
comparison related to the implemented controllers. The 
measurement results also proved that the LQG control 
strategy ensured faster system response and smaller 
overshoots. Regarding the fuzzy speed controller, the big 
overshoot is quite conspicuous (measurement results in Figure 
6), and also, slower settling time characterizes the weaker 
performance of the fuzzy control scheme. Both realized 
controllers successfully suppressed the inner body oscillations 
with similar quality (e.g., the maximum overshoot was around 
55 degrees). 
According to the figures, it can be concluded that more 
satisfying control performance was achieved by the LQG 
control technique. The reason of the modest performance of 
the elaborated fuzzy control scheme could have different 
sources. It is important to mention that the realized controllers 
are the results of intuitive control design steps, meaning that 
the linear controller has been defined by selecting the F and 
(  weighting matrices (and taking into account the plant 
dynamics), while the inference mechanism of fuzzy control 
has been defined by the selected membership functions and 
rules. Moreover, it shall be kept in mind that the derived 
mathematical model (4) has not been validated, since the 
nominal (or calculated) values of inertia related (inertia 
matrix, center of mass) and electrical parameters (such as the 
resistance of inductance of the motor) that characterize the 
robot were used in the development procedure. The result of 
the not validated mathematical model can also be seen in 
Table IV, since we got significant differences between the 
simulation and implementation results. In fact, it was expected 
that the performance of the realized controllers will differ 
from the simulation results since the design procedure of the 
LQG control takes into account the mathematical model as a 
constraint equation (which is only approximately known), 
ultimately this difference led the system to a better closed loop 
behavior. 
The evaluation of the quality measurement formulas (18) 
and (19) are summarized in Table V. The outcome of the 
evaluation results concludes controversy, since according to 
the calculated error integrals, the better overall control 
 
Figure 6.   Control performances of the implemented LQG and fuzzy 
control strategies (Measurement results). 
0
1
2
3
4
5
0
0.5
1
1.5
2
2.5
3
3.5
desired yaw rate, d
yaw rate, fuzzy
yaw rate, LQG
0
1
2
3
4
5
-60
-40
-20
0
20
oscillation suppression, fuzzy
oscillation suppression, LQG
time (sec)
0
1
2
3
4
5
-2
-1
0
1
2
3
4
motor2 input, fuzzy
motor2 input, LQG
motor1 input, fuzzy
motor1 input, LQG
0
1
2
3
4
5
0
0.1
0.2
0.3
0.4
0.5
0.6
desired speed, d
speed control, fuzzy
speed control, LQG
TABLE IV.              CHARACTERISTICS OF THE CONTROLLERS 
 
Speed control of the robot 
 
Simulation 
Implementation 
 
LQG 
FUZZY 
LQG 
FUZZY 
{´µ¶· s 
0.73 
0.9 
0.38 
0.27 
{ƒ% s 
0.82 
1.78 
0.38 
0.83 
ovs."m
s ) 
0.0083 
0.036 
0.018 
0.14 
 
 
 
 
 
 
Suppression of the inner body oscillations 
 
Simulation 
Implementation 
 
LQG 
FUZZY 
LQG 
FUZZY 
ovs. ° 
29.9 
25.6 
52.7 
56.3 
{ƒ° s 
0.85 
1.19 
0.71 
0.91 
 
230
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

performance is provided by the fuzzy control scheme. The last 
column of Table V indicates that according to the SAE, 
STAE, and STSE quality measurement formulas the realized 
fuzzy control scheme results smaller aggregated error values. 
The rows of Table V define the chosen error integral formula, 
while the first three columns define the aggregated error value 
related to the errors  /,  « and  ©¨. The overall aggregated 
error value has been defined by multiplying the sub-
aggregated error values, for example, in case of SAE: 
 
SAE¼½·´¾¿¿ = logI
À
SAE 
q∈ÁqÂ,qÃ,qÄ¨Å
. 
(20) 
Therefore, the ultimate outcome of the comparison is that 
the LQG control strategy provided better transient system 
responses, however, the better overall control performance 
was achieved by the cascade-connected fuzzy control scheme. 
Through this analysis, we could see that approximate 
reasoning and the heuristic knowledge oriented development 
gave satisfying control performances. This suboptimal control 
solution can be further investigated and improved by using the 
quality measurement formulas (18) and (19) in an 
optimization procedure. In this optimization procedure, both 
the shape of the membership functions and their ranges could 
be optimized for a better overall control performance.  
X. 
CONCLUSION AND FUTURE WORK 
In this paper, LQG and fuzzy control strategies were 
elaborated for a two-wheeled mobile pendulum system. The 
elaborated control strategies successfully ensured the speed 
control of the robot and the stabilization of the inner body 
oscillations as well. The control performances were tested 
both in simulation environment and on the real robot. The 
comparative assessment has been given based on real-time 
behavior of the system, where the LQG control strategy 
provided faster system responses, however, the elaborated 
fuzzy control scheme ensured better overall control 
performance. These experiments form our initial results in the 
investigation of the control performances of different 
optimized modern control methods. Future work will involve 
the identification of the unknown parameters of the robot, 
since it was seen that the approximately known mathematical 
model significantly influenced the final outcome of the 
investigation. Furthermore, the future research work will 
focus on the validation of optimized control strategies, where 
the defined quality measurement functions could lead the 
system to a better optimum.   
 
ACKNOWLEDGMENT 
We acknowledge the financial support of this work by the 
Hungarian State and the European Union under the TÁMOP-
4.2.2.D-15/1/KONV-2015-0002 
project 
entitled 
”Development of Smart technologies for High-tech industry”. 
 
APPENDIX 
The Lagrange function of the system: 
ℒ = D Ç3
4 -È + 1
8 -É + Ê
2 -É sin  + 1
2 Cℬ

 + 1
2 #CÌÍ ‘


‘H
 
+ D U1
2 -ÉÊ cos  − #CÌY ‘

‘H
 
+ Ç1
4 -É − Ê
 -É sin  − Cℬ

Í  
+ U1
2 -ÉÊ + 1
2 CÏ + #CÌY 
 − 2-ÈÐ − -ÉÐ − Ê cos . 
(A) 
 
Elements of the inertia matrix  = -‘“×: 
- = 3
2 -È + 1
4 -É + #CÌ + Ê
 -É 
¢Ñ  + Cℬ

, 
- = -, - = -ÉÊ + CÏ + 2#CÌ, 
- = - = 1
4 -É − Ê
 -É 
¢Ñ  − Cℬ

, 
- = - = - = - = 1
2 -ÉÊ ÒÓ
  − #CÌ. 
(B) 
 
 
 
TABLE VI.              NOTATION OF THE ROBOT PARAMETERS 
Symbol 
Name 
Value [SI Unit] 
 
Wheel radius 
3.15 ∙ 107 
-È 
Mass of the wheels 
31.6 ∙ 107 
Ê 
Distance between the COG 
and the wheel axle  
8.36 ∙ 107 
-É 
Mass of the inner body 
360.4 ∙ 107 
 
Distance between the wheels 
177 ∙ 107 
CÏ 
Moment of inertia of the inner 
body about the wheel axle Ï 
81367 ∙ 107ª 
Cℬ 
Moment of inertia of the inner 
body about the axis ℬ 
574620 ∙ 107ª 
# 
Gear ratio 
64 
CÌ 
Rotor inertia 
0.12 ∙ 107Ô 
( 
Terminal resistance 
2.3 
! 
Rotor inductance 
26 ∙ 107Œ 
#* 
Torque constant 
2.05 ∙ 107 
#$ 
Back-EMF constant 
2.05 ∙ 107 
- 
Viscous friction coefficient 
between body - motor 
2.1 ∙ 107ƒ 
./ 
Viscous friction coefficient 
between wheels - ground 
1.8 ∙ 107˜ 
 
TABLE V.              QUALITY MEASUREMENT NUMBERS 
 
Fuzzy control 
 
ÕÖ 
Õ× 
ÕØÙ 
ÚÛÜÝÞ ß 
SAE 
30.4780 
128.7299 
4.2689 ∙ 10 
7.2240 
SSE 
6.5300 
218.3223 
1.1638 ∙ 10ƒ 
8.2199 
STAE 
85.6093 
512.2402 
9.4892 ∙ 10 
8.6192 
STSE 
20.3829 
955.1933 
1.6724 ∙ 10ƒ 
9.5127 
 
 
 
LQG control 
 
ÕÖ 
Õ× 
ÕØÙ 
ÚÛÜÝÞ ß 
SAE 
30.8451 
150.3294 
3.7218 ∙ 10 
7.2370 
SSE 
6.9708 
265.7726 
8.0833 ∙ 10˜ 
8.1754 
STAE 
101.2168 
581.9903 
9.1477 ∙ 10 
8.7315 
STSE 
23.8399 
1.169 ∙ 10 
1.2966 ∙ 10ƒ 
9.5579 
 
231
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

 
The elements of ,  = £, £, £: 
£ = 2 Ê
 -É sin cos   −  − 1
2 -ÉÊ sin  
, 
£ = 2 Ê
 -É sin  cos   −  − 1
2 -ÉÊ sin 
, 
£ = − Ê
 -É sin  cos   − 
 + -ÉÐÊ sin . 
(C) 
 
The block matrices of equation (9): 
T}~, = %0
−0.08
0
−136.5', T}~, = %−25.9
0.8
2338
−73.6',   
T}~, = %0
1
0
−56', R€~, = %
3
3
−279.6
−279.6',  
R€~, = %
0
0
−73.9
73.9', Z}~, = %1
0
0
0', and Z}~, = %0
0
0
1'. 
(D) 
 
REFERENCES 
[1] Á. Odry, E. Burkus, and P. Odry, “LQG Control of a Two-
Wheeled Mobile Pendulum System,” The Fourth International 
Conference on Intelligent Systems and Applications (INTELLI 
2015), 2015, pp. 105-112, ISBN: 978-1-61208-437-4. 
[2] K. S. Tang, Kim Fung Man, Guanrong Chen, and Sam Kwong, 
“An optimal fuzzy PID controller,” IEEE Transactions on 
Industrial Electronics, vol. 48, 2001, pp. 757 – 765, doi: 
10.1109/41.937407. 
[3] L. A. Zadeh, “Fuzzy sets,” Information and Control, vol. 8, 
1965, pp. 338 – 353, doi: 10.1016/S0019-9958(65)90241-X. 
[4] H. B. Verbruggen and P. M. Bruijn, “Fuzzy control and 
conventional control: What is (and can be) the real contribution 
of Fuzzy Systems,” Fuzzy sets and Systems, vol. 90, 1997, pp. 
151 – 160, doi:  10.1016/S0165-0114(97)00081-X. 
[5] G. F. Franklin, J. D. Powell, and A. Emami-Naeini, Feedback 
Control of Dynamic Systems. Pearson Prentice Hall, 2014, 
ISBN: 978-0-13349-659-8.  
[6] A. Divelbiss and J. Wen, "Trajectory tracking control of a car-
trailer system," IEEE Transactions on Control Systems 
Technology, 
vol. 
5, 
1997, 
pp. 
269 
- 
278, 
doi: 
10.1109/87.572125. 
[7] J.-K. Ji and S.-K. Sul, "Kalman filter and LQ based speed 
controller for torsional vibration suppression in a 2-mass motor 
drive system," IEEE Transactions on Industrial Electronics, 
vol. 42, 2002, pp. 564 - 571, doi: 10.1109/41.475496. 
[8] S. Jeong and T. Takahashi, "Wheeled inverted pendulum type 
assistant robot: inverted mobile, standing, and sitting motions," 
IEEE/RSJ International Conference on Intelligent Robots and 
Systems (IROS 2007), 2007, pp. 1932 - 1937, doi: 
10.1109/IROS.2007.4398961. 
[9] S. Zhiyu and L. Daliang, "Balancing control of a unicycle 
riding," 29th Chinese Control Conference (CCC), 2010, pp. 
3250 - 3254, ISBN: 978-1-4244-6263-6. 
[10] L. Yi-bo, L. Wan-zhu, and S. Qi, "Improved LQG control for 
small unmanned helicopter based on active model in uncertain 
environment," International Conference on Electronics, 
Communications and Control (ICECC), 2011, pp. 289 - 292, 
doi: 10.1109/ICECC.2011.6067810. 
[11] O. Araar and N. Aouf, "Full linear control of a quadrotor UAV, 
LQ vs H∞," UKACC International Conference on Control 
(CONTROL), 
2014, 
pp. 
133 
- 
138, 
doi: 
10.1109/CONTROL.2014.6915128. 
[12] D. McLean and H. Matsuda, “Helicopter station-keeping: 
comparing LQR, fuzzy-logic and neural-net controllers,” 
Engineering Applications of Artificial Intelligence, vol. 11, 
1998, pp. 411–418, doi: 10.1016/S0952-1976(98)00005-0. 
[13] T. Das and I. N. Kar, “Design and implementation of an 
adaptive fuzzy logic-based controller for wheeled mobile 
robots,” IEEE Transactions on Control Systems Technology, 
vol. 14, 2006, pp. 501-510, doi: 10.1109/TCST.2006.872536. 
[14] C. S. Lee and R. V. Gonzalez, “Fuzzy logic versus a PID 
controller for position control of a muscle-like actuated arm,” 
Journal of Mechanical Science and Technology, vol. 22, 2008, 
pp. 1475-1482, doi: 10.1007/s12206-008-0424-7. 
[15] I. Kecskés and P. Odry, “Optimization of PI and Fuzzy-PI 
Controllers on Simulation Model of Szabad(ka)-II Walking 
Robot,” International Journal of Advanced Robotic Systems, 
2014, doi: 10.5772/59102. 
[16] M. Santos, V. López, and F. Morata, “Intelligent fuzzy 
controller of a quadrotor,” International Conference on 
Intelligent Systems and Knowledge Engineering (ISKE 2010), 
2010, pp. 141-146, doi: 10.1109/ISKE.2010.5680812. 
[17] Cheng-Hao Huang, Wen-June Wang, and Chih-Hui Chiu, 
“Design and Implementation of Fuzzy Control on a Two-
Wheel Inverted Pendulum,” IEEE Transactions on Industrial 
Electronics, 
vol. 
58, 
2010, 
pp. 
2988-3001, 
doi: 
10.1109/TIE.2010.2069076. 
[18] Á. Odry, I. Harmati, Z. Király, and P. Odry, "Design, 
realization and modeling of a two-wheeled mobile pendulum 
system," 14th International Conference on Instrumentation, 
Measurement, Circuits and Systems (IMCAS '15), 2015, pp. 
75-79, ISBN: 978-1-61804-315-3. 
[19] Á. Odry, E. Burkus, I. Kecskés, J. Fodor, and P. Odry, “Fuzzy 
Control of a Two-Wheeled Mobile Pendulum System,” 11th 
IEEE International Symposium on Applied Computational 
Intelligence and Informatics (SACI 2016), 2016, pp. 99-104, 
ISBN: 978-1-5090-2380-6. 
[20] AppL-DSP. Video demonstration of the robot. [Online]. 
Available from: http://appl-dsp.com/lqg-and-fuzzy-control-of-
a-mobile-wheeled-pendulum [Accessed: 28 May 2016]. 
[21] A. Salerno and J. Angeles, "A New Family of Two-Wheeled 
Mobile Robots: Modeling and Controllability," IEEE 
Transactions on Robotics, vol. 23, 2007, pp. 169 - 173, doi: 
10.1109/TRO.2006.886277. 
[22] B. Cazzolato et al., "Modeling, simulation and control of an 
electric diwheel," Australasian Conference on Robotics and 
Automation (ACRA 2011), 2011, pp. 1-10, ISBN: 978-0-9807-
4042-4. 
[23] L. Sciavicco and B. Siciliano, Modelling and Control of Robot 
Manipulators. Springer-Verlag London, 2000, ISBN: 978-1-
85233-221-1. 
[24] G. Welch and G. Bishop, "An Introduction to the Kalman 
Filter," Tech. Rep. TR 95-041, Department of Computer 
Science, University of North Carolina, USA, 2001. 
[25] Li-Xin Wang, A course in fuzzy systems and control. Prentice-
Hall, 1997, ISBN: 0-13-540882-2. 
[26] STMicroelectronics, "Tilt measurement using a low-g 3-axis 
accelerometer," Application note AN3182, 2010. 
[27] T. E. Marlin, Process control: designing processes and control 
systems for dynamic performance. McGraw-Hill Companies, 
1995, ISBN: 0-07-040491-7.  
 
 
 
232
International Journal on Advances in Intelligent Systems, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/intelligent_systems/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

