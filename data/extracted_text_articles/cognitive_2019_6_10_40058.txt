Neural Network-Based Reasoning for Solving the Tower of Hanoi
Sanghun Bang
Laboratoire Cognitions Humaine
et Artiﬁcielle (CHArt)
University Paris 8
Saint-Denis, France
Email: sang-hun.bang@univ-paris8.fr
Charles Tijus
Laboratoire Cognitions Humaine
et Artiﬁcielle (CHArt)
University Paris 8
Saint-Denis, France
Email: charles.tijus@univ-paris8.fr
Abstract—In this paper, we propose a reasoning solution, which
can infer the rules of game, such as Tower of Hanoi. Neural
networks require large amounts of data to improve performance.
However, human intelligence requires only a simple exposition.
The goal of this paper is to learn to solve a Tower of Hanoi without
much learning. We collect sequential data from participants’
experiments that are supposed to solve the Tower of Hanoi. And
then, we observe relations between different objects and their
actions to establish our reasoning model. We train our reasoning
model to solve the Tower of Hanoi. Finally, we show that our
reasoning model can infer the rule of game through observations
from objects, their relationships and actions.
Keywords–Reasoning;Inference;Neural
Networks;
Machine
Learning;Tower of Hanoi.
I.
INTRODUCTION
From a psychological point of view, the reasoning of
human being can be considered as the process of drawing
conclusions. Human beings’ endeavors to solve problems or
to make decisions are goal-oriented [1]. Reasoning has long
been regarded as exclusive domain of the human being. It was
one of the most difﬁcult areas to implement mechanically.
Because we need to understand contextual meanings, such
as texts and images, and we have to consider contextual
relationships that change depending on the situation, even with
the same information. Therefore, reasoning has received a lot
of attentions in the last few decades [2][3]. In recent years,
advances in deep learning, especially the evolution of learning
algorithms, are leading to rapid research and development of
artiﬁcial intelligence in the ﬁeld of reasoning [4]. In this paper,
we pay our attention to a matter of reasoning about objects,
relations and interactions. This task is a matter of reasoning
about things and relationships in order to solve problems. The
French mathematician Edouard Lucas introduced the Tower
of Hanoi (TOH) puzzle in 1883. Figure 1 shows a standard
example of Tower of Hanoi. There is a pile of different size
disks on the right peg. The largest disk is at the bottom of
the peg and the smallest at the top of the pile. The goal of
TOH is to move the whole stack of disks from the right peg
to the left peg. There are three rules as constraints: One disk
at a time should be moved, in a location, the smallest disk
is the one to take and a large disk cannot be placed on top
of a smaller one. In this paper, our hypothesis is that we can
infer the rule of game through observing the movements of
the participants action. In order to test this hypothesis, we
carry out an experiment for which participants were given
two successive tasks: to solve the three-disk Tower of Hanoi
task, then to solve this problem with four disks. Based on the
acquired data, we observed relations between different objects
and their actions to establish our reasoning model. As we
know, neural networks require amounts of data to improve
performance. But, in this paper we tried to infer the solution
of Tower of Hanoi without much learning. We trained with 3
disks and predicted out model with 4 disks.
II.
REASONING MODEL
As mentioned at the introduction, only one disk at a time
can be moved, a disk can only be moved if it is the top disk
on a pile, and a larger disk can never be placed on a smaller
one (See Figure 1). From the rule of game, we can infer this
participant’s action. How can we make such inference possible
without any information about the rule of game ? We have
received great inspiration from Interaction Networks(Ins) [5]
and Relation networks(RNs) [6]. These models, which have
a neural network architecture, are very helpful for inference
learning by observing from objects, their relationships and
actions.
Figure 1. The smallest disk in the four is at the top, and participant grabs it
and moves it.
As with the Relation Networks [6], we assume reasoning
of rule that depends on the relations R between objects.
According to our sequential data, relation (R, with elements
r) is consist of location, and inclusion relation. For example,
the smallest disk is the relation with other disks (Ex:The
smallest disk is in contact with the second smallest disk.).
In the case of the Tower of Hanoi with 3 disks, we have
six objects (3 disks, 3 pegs) with a vector of 3 features
encoding properties, such as the object’s position (beneath and
on) and inclusion relation. We can express the smallest disk
like this, o1 = (obeneath
1
, oon
1 , oinclusion
1
). We are interested
in models generally deﬁned by the composite form f · g,
where f is a function that returns a prediction y. The function
gψ is deﬁned to operate on a particular factorization of D
83
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-705-4
COGNITIVE 2019 : The Eleventh International Conference on Advanced Cognitive Technologies and Applications

(ex: gψ(D) ≡ gψ(o1
1, o2
1, ...., o1
i , ..., on
m)). As shown in Figure
2, there is the smallest disk on the second small disk. In
this case, there is a relation with the disk below. It means
gψ(o1, o2) = beneath(o1, o2). But, there is not the disk on
the smallest disk. For inclusion, There are four disks in peg1.
But the peg2 and peg3 do not have a disk.
Figure 2. Model type
The model we want to predict is given by y
=
fφ(P
i,j gψ(oi, oj)) where fφ and gψ are Multi-Layer Percep-
tron. We optimize this model by means of training. Finally,
our model gives us probabilities about whether we can move
the disk in each different situation or not.
III.
EXPERIMENTS
A. Experiment: Tower of Hanoi
We recruited 14 participants (Average age 41, Standard
Deviation=8.51). The blind group consisted of 6 women and 1
man (Average age 39, Standard Deviation=6.65). The sighted
group consisted of 6 women and 1 man (Average age 43,
Standard Deviation=10.30). Sitting down at the table, the
participants were then given four disks of the Tower of Hanoi
that they had to solve. The instructions were given to the
participants. The participants were requested to solve the four
disks TOH as we collected their solution. Through these
research experiments, we have obtained the sequential data
concerning about the solution of Tower of Hanoi.
B. Experiment: Reasoning model
The model has 5 input units, one or two hidden layers and
one output unit. There are different neurons (5,10) in each
layers. Rectiﬁed linear activation functions are used in each
hidden layer and a sigmoid activation function is used in the
output layer, for binary classiﬁcation. Reasoning model with
different architectural variations was trained to ﬁnd the rule of
Tower of Hanoi. The model with different number of neurons
reaches a cross entropy loss below 0.6. However, the fourth
model (MLP:5 inputs, two hidden layers with 10 neurons, 1
output) performed well as compared to other models.
As we can see in Figure 3 and Table I, the test accuracy
with 3 disks for the ﬁrst and fourth model are 95.24% and
100%, respectively. When we try to infer the rule of game
for The tower of Hanoi with 4 disks, we ﬁnd our reasoning
model achieves 75% prediction accuracy for the ﬁrst model
and 96.67% for the fourth model.
IV.
CONCLUSION
Human being’s reasoning and thinking do not require
much learning data. Human intelligence requires only a simple
exposition [7]. Based on this idea, without much learning data,
we propose a reasoning model that can infer the rule of the
game through observing the characteristics, relationships, and
actions of objects. In particular, the objective of Tower of
Figure 3. Reasoning model with different number of neurons was trained to
ﬁnd the rule of TOH.
TABLE I. MODEL PERFORMANCE FOR TOWER OF HANOI WITH 3
DISKS (TRAINING) AND 4 DISKS (PREDICTION)
Accuracy
Model
training(%)
prediction(%)
Five inputs (5 neurons), one hidden layer ( 5 neurons)
95.24
75
Five inputs (5 neurons), two hidden layers (5 neurons)
90.48
76.67
Five inputs (10 neurons), one hidden layer (10 neurons)
90.48
71.67
Five inputs (10 neurons), two hidden layers (10 neurons)
100
96.67
Hanoi is to ﬁnd the solution in a way that is the shortest
possible movement. For future work, we will apply our model
to ﬁnd the shortest path of Tower of Hanoi. Furthermore, after
proving the effectiveness of this model, we will apply it to
explore the more complicated tasks.
ACKNOWLEDGMENT
We would like to thank Mathilde Malgrange and the
participants for participating in the experiment.
REFERENCES
[1]
J. P. Leighton and R. J. Sternberg, The nature of reasoning.
Cambridge
University Press, 2004.
[2]
M. Minsky, The society of mind.
New York : Simon and Schuster,
1986.
[3]
E. T. Mueller, Commonsense reasoning: an event calculus based ap-
proach; 2nd ed.
Waltham, MA: Morgan Kaufmann, 2015.
[4]
A.
Kumar
et
al.,
“Ask
Me
Anything:
Dynamic
Memory
Net-
works for Natural Language Processing,” arXiv.org, Jun. 2015, p.
arXiv:1506.07285.
[5]
P. Battaglia, R. Pascanu, M. Lai, D. J. Rezende, and K. Kavukcuoglu, “In-
teraction Networks for Learning about Objects, Relations and Physics,”
2016, pp. 4502–4510.
[6]
D. Raposo et al., “Discovering objects and their relations from entangled
scene representations,” CoRR, vol. abs/1702.05068, 2017. [Online].
Available: http://arxiv.org/abs/1702.05068
[7]
R. B. Zajonc, “Mere Exposure: A Gateway to the Subliminal:,” Current
directions in psychological science, vol. 10, no. 6, Jun. 2016, pp. 224–
228.
84
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-705-4
COGNITIVE 2019 : The Eleventh International Conference on Advanced Cognitive Technologies and Applications

