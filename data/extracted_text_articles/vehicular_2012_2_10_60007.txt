Efficient Adaptive  Equalizer Combined with LDPC 
Code for Vehicular Communications 
 
Do-Hoon Kim, Junyeong Bok and Heung-Gyoon Ryu 
Department of Electronic Engineering 
Chungbuk National University 
Cheongju, Korea 
neon86@nate.com, bjy84@nate.com, ecomm@cbu.ac.kr 
 
 
Abstract—Low density parity check (LDPC) code is very 
powerful for the error correction in the communication systems. 
So, LDPC code has been adopted for the standard of IEEE 
802.11p 
(vehicular 
ad-hoc 
networks) 
and 
digital 
video 
broadcasting-satellite2 (DVB-S2). Features of LDPC code are 
iterative decoding and sparse parity check matrix. However, 
when multipath fading channel is considered, LDPC code needs 
long parity check matrix and pretty big iteration number of 
decoding. We propose a fast and efficient adaptive equalizer with 
LDPC code for compensating the carrier frequency offset (CFO) 
and phase noise in the vehicular environments. In addition, this 
proposed system has less iterations than the conventional system 
without combining structure. So, the proposed system has lower 
complexity. In this paper, we investigate the system model and 
evaluate BER performance for the vehicular environments by the 
simulation results, considering the CFO and phase noise in the 
OFDM system. 
Keywords-LDPC; adapitve equalizer; CFO; phase noise; 
OFDM; Sparse Parity Check Matrix; iteration number. 
I. 
 INTRODUCTION 
There are some impairments degrading the OFDM 
communication system. One is phase noise caused by the 
oscillator in transceiver; another is CFO (carrier frequency 
offset). These components produce the ICI (inter-subcarrier 
interference). Until now, in fact, there are many methods to 
compensate CFO [1]-[2] or phase noise [3]-[5] in OFDM 
system. Therefore, we can overcome ICI effect by using 
forward error correction code and equalization in OFDM 
system [6]-[12]. 
Especially, LDPC code is well known as the good 
performance channel coding method. LDPC code was firstly 
proposed by Robert G. Gallager in 1962 [13] and re-considered 
by Mackay and Neal in 1997 [14] [15]. LDPC is the error 
correction code which shows the closest performance to 
Shannon’s limit [14]. Recently, LDPC code has been 
commonly used in such as Mobile WiMax and DVB-S2. LDPC 
code has highly error correction performance at low Signal to 
Noise Ratio (SNR) environment and is able to encode fast by 
using sparse parity check matrix. However, when multipath 
fading channel is considered, LDPC code needs long sparse 
parity check matrix and iteration number of decoding. 
In this paper, we propose an adaptive equalizer combined 
with LDPC code. The proposed system requires a smaller 
iteration number of LDPC decoding than the system without 
combining. In addition, this combined adaptive equalizer can 
compensate ICI effect which degrades the BER performance, 
such as CFO and expand ICI in OFDM system[1]-[5]. So, we 
consider about CFO and phase noise effects in OFDM system. 
At first, we analyze the basic principle of LDPC code and 
frequency domain equalizer [6]-[12]. After that, we evaluate 
BER performance of the combined adaptive equalizer for 
vehicular environments. 
II. 
SYSTEM MODEL 
Fig. 1 shows the system model of the combined adaptive 
equalizer with LDPC code in OFDM system [6]. We use 
LDPC code and channel estimator to estimate channel 
characteristic in OFDM communication system. It can 
eliminate ISI (inter-symbol interference) effects by using CP 
(cyclic prefix). Then, it can estimate the channel characteristic 
through the long preamble and equalize the channel fading. 
Especially, we design and propose a feedback loop composed 
up of LDPC decoder to adaptive equalizer. That is, adaptive 
equalizer is combined with LDPC decoder iteratively. The 
combined equalizer calculates the control factor in feedback 
loop iteratively. So, we can call adaptive equalizer combined 
with LDPC code. 
 
Figure 1.  System model of the adaptive equalizer.  
III. 
LOW DENSITY PARITY CHECK CODE 
LDPC code is one of the block coding methods. It can be 
expressed as (
,
)
N K . It has a sparse parity check matrix (H 
18
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-241-7
VEHICULAR 2012 : The First International Conference on Advances in Vehicular Systems, Technologies and Applications

matrix) of (
)
N
K
N


 size. H matrix is non-systematic 
sparse parity check matrix. 
A. LDPC Encoding 
The received vector is corrupted by an error vector e  as 
follows [16]. 



 


r
c
e
p
m
e 

where p  is parity vector and m  is message vector. The parity 
vector and message vector are assumed to be located at the 
former or latter part of the code vector, respectively. The 
decoder of the receiver is supposed to apply for the received 
signal vector to find the syndrome vector as [16]: 





1
2
1
2
T
T
T
T
T
T
H
H
H
H
H
H












s
r
p
m
e
p
m
e


Noting that this syndrome vector should be zero for the 
non-error case, that is, 
e  0
. 

1
2
T
T
H
H



s
p
m
0 

We can write the parity vector p  in terms of the message 
vector m  as [16] 

2
1
T
H H T
p 
m


This amounts to the generator matrix 

2
1
T
T
G
H H
I



 
 

so the code vector can be generated by post-multiplying the 
message vector m  with the generator matrix G as [16] 



2
1
T
T
G
H H 







c
m
m
m
p
m 

B. LDPC Decoding 
The LDPC decoder calculates the probability in variable 
nodes and check nodes, respectively [17] [18]. Decoding 
algorithms can be divided into sum-product (SP) algorithm and 
min-sum (MS) algorithm. SP algorithm has better decoding 
performance, but higher complexity. So, we choose SP 
algorithm to decode because of decoding performance. The 
LDPC decoder operates through 4 steps. First step is the 
initializing step. Second step is the updating check nodes step. 
Third step is the updating variable nodes step. Final  step is 
decision step. 
IV. 
CHANNEL ESTIMATION AND EQUALIZATION 
A frequency-domain training sequence is 

( )
( )
( )
R
I
X k
X
k
jX
k




with the corresponding channel output. 

( )
( )
( )
R
I
Y k
Y k
jY k




Channel estimation with 
( )
X k and ( )
Y k  is  

( )
( )
p
Y k
H
X k



The long preamble used for channel estimation is  

( )
1
or
1(with
( )
0)
I
X k
X
k





The channel estimation signal can be simplified as 

( )
( )
( )
( )
( )
R
I
p
R
Y k
jY k
Y k
H
X k
X
k





Since the long preamble contains two repeated training 
sequences, the average of the FFT (
1( )
Y k and 
2( )
Y k ) of the 
channel outputs can be taken for the better channel estimation. 

1
2
( )
( )
1
2
( )
p
Y k
Y k
H
X k




So, the estimated channel can equalize the output to 
compensate the channel effect.  

ˆ ( )
ˆ
p
Y
X k
H




V. 
PROPOSED ADAPTIVE EQUALIZER COMBINED WITH 
LDPC CODE 
Fig. 2 shows the feedback system of the combined adaptive 
equalizer in the receiver side. Fig. 2 shows subsystem after FFT 
operation in OFDM receiver side. Original equalization type is 
the zero forcing, but the combined equalizer with LDPC 
decoder is almost same to the decision feedback equalizer 
because it performs feedback loop between equalizer and 
LDPC decoder iteratively. So, we call as adaptive equalizer 
combined with LDPC code. 
19
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-241-7
VEHICULAR 2012 : The First International Conference on Advances in Vehicular Systems, Technologies and Applications

F
C
sL
dL
Hp
ˆ
Hp
kY 
 
Figure 2.  Block diagram of combined adaptive equalizer in receiver. 
As shown in Fig. 2, after through LDPC decoder, the 
proposed system feeds 
CF
 back to adaptive equalizer from 
LDPC decoder to compensate channel estimation with 
sL and
d
L . 
sL and
d
L  are decoder output and decision bit, 
respectively. 

(
)
s
s
L
  norm L



*
ˆ
d
k
s
d
k s
L
L L

  



2
ˆ
d
k
F
s
k s
L
C
L


 


ˆ
p
H  is the channel characteristic after estimation by the 
long preamble adding 
F
C . 

ˆ
p
p
F
H
H
C




We can improve performance by the following equation 
with compensated channel ˆ
p
H . 

ˆ
k
k
p
Y
Y
H
 


Therefore, the combined adaptive equalizer can achieve  
better performance like the decision feedback equalizer. 
Basically, equalization type is based on the zero forcing, but 
the combined adaptive equalizer with LDPC decoder is almost 
same to the decision feedback equalizer because of feedback 
loop between equalizer and LDPC decoder. 
VI. 
SIMULATION RESULTS 
Table 1 shows simulation parameters for the combined 
adaptive equalizer with LDPC code. In this paper, we consider 
IEEE 802.11p format. Code rate is 3/4 and parity check matrix 
size is 720. At first, we generate 78 bits per data block. We 
change block size to 540 bits through the buffer and encode as 
720 bits. Then, we change again to 104 bits in order to 
modulate through the buffer. Finally, we can output as 52 data 
symbols. We consider the AWGN and multipath channel. The 
multipath channel considers  the ITU vehicular channel model. 
Furthermore, we adapt the normalized CFO and phase noise 
power as 0.03 and -12dBc, respectively. 
TABLE I.  
SIMULATION PARAMETERS. 
Parameters 
Values 
# of data subcarriers 
52 
# of pilot subcarriers 
4 
# of padded zeros 
7 
FFT size 
64 
# of samples in a GI 
16 
Modulation level 
4QAM 
Multipath channel 
ITU vehicular channel A
 
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Samples
Amplitude
Impulse Response
 
Figure 3.  Impulse response of considered multipath channel. 
Fig. 3 shows the impulse response of the considered 
multipath channel. This multipath channel is called as ITU-
Vehicular channel A. The multipath channel can be simplified 
in the digital FIR filter model. Overall 5 delay paths may exist. 
Fig. 4 shows BER curve according to iteration number of 
the LDPC decoding in AWGN channel. The iterations is higher, 
BER performance can be improved. 
Fig. 5 shows BER performance of the combined adaptive 
equalizer and without channel estimation and equalization. The 
combined adaptive equalizer has much better performance than 
without channel estimation and equalization over considered 
CFO and phase noise effects. When iteration number is 5, the 
SNR is less than 5dB at 10-5 error probability. So, the 
combined adaptive equalizer is able to compensate the CFO 
and phase noise. 
20
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-241-7
VEHICULAR 2012 : The First International Conference on Advances in Vehicular Systems, Technologies and Applications

0
0.5
1
1.5
2
2.5
3
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
Eb/N0 (dB)
BER
 
 
Iter. 3
Iter. 5
Iter. 8
 
Figure 4.  BER performance according to iteration number in AWGN. 
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
Eb/N0 (dB)
BER
 
 
Adaptive EQ. w/ LDPC
w/o estimation & EQ.
 
Figure 5.  Comparison BER performance of the combined adaptive equalizer 
and BER without channel estimation and equalization. 
Fig. 6 shows BER performance of the combined adaptive 
equalizer and without combining system under same iteration 
number situation. Performance of the combined adaptive 
equalizer is better than without combining system. The 
combined adaptive equalizer is better performance about 
0.5dB at 10-4 when iteration number is 5. 
Fig. 7 shows closely similar BER performance between the 
combined adaptive equalizer and without combining system at 
same iterations. When SNR is 3.5dB, BER of the combined 
adaptive equalizer and without combining system is exactly 
same. Where, iteration number of the combined adaptive 
equalizer is 3, but without combining system is 5. Because 
complexity of system is closely related to iteration number, the 
combined adaptive equalizer has lower complexity than 
without combining system. 
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
Eb/N0 (dB)
BER
 
 
w/o combined LDPC
Adaptive EQ. w/ LDPC
 
Figure 6.  BER performance of the combined adaptive equalizer  and BER 
without combining. 
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
Eb/N0 (dB)
BER
 
 
Adaptive eq. w/ LDPC(Iter.=3)
w/o combined LDPC(Iter.=5)
 
Figure 7.  Comparison BER performance of adaptive equalizer combined  
with LDPC and BER without combining. 
VII. CONCLUSION 
We propose an efficient adaptive equalizer combined with 
LDPC code to compensate the CFO and phase noise in 
vehicular environments. To estimate the channel, combined 
adaptive equalizer uses the long preamble. After passing 
through the LDPC decoder, the proposed system calculates 
CF
 with 
sL and 
Ld
. Then, it feeds 
CF
 back into the 
equalizer from the LDPC decoder. So, BER performance of the 
combined adaptive equalizer can be improved. On the other 
hands, the combined adaptive equalizer can achieve lower 
complexity when it has same performance. The combined 
adaptive equalizer has good BER performance with CFO and 
phase noise. As a result of Fig. 5, the combined adaptive 
equalizer shows better BER performance than without 
combining. Also, as a result of Fig. 6, iteration number of 
combined adaptive equalizer is lower than the system without 
combining when both of performances are closely similar. That 
is, complexity is lower than the system without combining 
21
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-241-7
VEHICULAR 2012 : The First International Conference on Advances in Vehicular Systems, Technologies and Applications

because complexity is related to iterations of the LDPC 
decoder. So, the combined adaptive equalizer can compensate 
CFO and phase noise through combining in OFDM system. 
Therefore, it can improve BER performance and reduce 
complexity of the LDPC decoder. Additionally, we can expect 
implementation of the combined adaptive equalizer for 
vehicular communications. 
ACKNOWLEDGEMENT 
This research was supported by Basic Science Research 
Program through the National Research Foundation of 
Korea(NRF) funded by the Ministry of Education, Science and 
Technology(No. 2010-0007567). 
 
REFERENCES 
[1] 
P. H. Moose, "A technique for OFDM Frequency Offset Correction," 
IEEE Trans, on Comm., vol. 42, no. 10, pp. 2908-2914, 1994. 
[2] 
T. Pollet, M van Bladel, M. Moeneclaey, "BER sensitivity of OFDM 
systems to carrier freuency offset and Wiener phase noise," IEEE Trans, 
On Comm., vol. 43, no. 2, pp. 887-895, 1995. 
[3] 
Glolami, M. R., Nader-Esfahani, S., Eftekhar, A. A., "A new method of 
phase noise compensation in OFDM." ICC '03. IEEE International 
Conference on Communications, vol. 5, pp. 3443-3446, 2003. 
[4] 
Songping Wu, Bar-Ness. Y., "A phase noise suppression algorithm for 
OFDM-based WLANs," IEEE Communications Letters, vol. 6, pp. 535-
537, 2002. 
[5] 
H. G. Ryu, Y. S. Li., "Phase noise analysis of the OFDM communication 
system by the standard frequency deviation." IEEE Transactions on 
Consumer Electronics, vol. 49, no. 1, pp. 41-47, 2003. 
[6] 
SHAHID U. H. QURESHI, “Adaptive Equalization,” PROCEEDINGS 
OF THE IEEE, VOL. 73. NO. 9, Sep. 1985. 
[7] 
Z.-S. Lin, T.-L. Hong and D.-C. Chang, "Design of an OFDM system 
with long frame by the decision-aided channel tracking technique". Proc. 
IEEE Sixth Electro/Information Technology Conf., Lansing, MI, USA, 
May 2006. 
[8] 
S. Kalyani, and K. Giridhar, "Quantised decision based gradient descent 
algorithm for fast fading OFDM channels". Proc. IEEE 60th Vehicular 
Technology Conf., September 2004, pp. 534–537. 
[9] 
R. Funada, H. Harada, and S. Shinoda, "Performance improvement of 
decision-directed channel estimation for DPC-OF/TDMA in a fast 
fading environment". Proc. IEEE 60th Vehicular Technology Conf., 
September 2004, pp. 5125–5129. 
[10] H.-W. Kim, C.-H. Lim, and D.-S. Han, "Viterbi-decoder aided 
equalization and sampling clock track of OFDM WLAN". Proc. IEEE 
60th Vehicular Technology Conf., September 2004, pp. 3738–3742. 
[11] Q. Yuan, C. He, K. Ding, W. Bai, and Z. Bu, "Channel estimation and 
equalization for OFDM system with fast fading channels". Proc. IEEE 
60th Vehicular Technology Conf., September 2004, pp. 452–455 
[12] T. Kella, "Decision-directed channel estimation for supporting higher 
terminal velocities in OFDM based WLANs". Proc. IEEE Global 
Telecommunication Conf., December 2003, pp. 1306–1310. 
[13] R. G. Gallager, “Low Density Parity Check codes,” IRT Trans. Inform. 
Theory, vol. IT-8, pp. 21-28, Jan. 1962. 
[14] D. J. Mackay and R. M. Neal, “Neal Shannon limit performance of low 
density parity check codes,” Electronic letters, vol. 45, pp. 457–458, 
March 1997. 
[15] D. J. Mackay, “Good error correcting codes based on very sparse 
matrix,” IEEE Trans. Inform. Theory, vol. 33, no. 6, pp. 399–431, 
March 1999. 
[16] W. Y. Yang, “MATLAB/Simulink for Digital Communication,” A-Jin, 
1st ed, pp. 309-313. 
[17] S. Papaharalabos, P. Sweeney, B. G. Evans, P. T. Mathiopoulos, G. 
Albertazzi, A. Vanelli-Coralli and G. E. Corazza, "Modified sum-
product algorithms for decoding low-density parity-check codes," IET 
Commun., vol. 1. pp 294-300, June 2007. 
[18] S. L. Howard, Christian Schlegel and V. C. Gaudet, “A degree-matched 
check nod approxiamtion for LDPC decoding,” Proc. IEEE Int. symp. 
Inf. Theory(ISIT), Adelaide, Australia,  pp. 1131-1135, Sep. 2005. 
22
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-241-7
VEHICULAR 2012 : The First International Conference on Advances in Vehicular Systems, Technologies and Applications

