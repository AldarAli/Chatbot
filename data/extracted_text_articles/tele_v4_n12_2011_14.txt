Pilot Pattern Design for PUSC MIMO WiMAX-like Filter Banks Multicarrier
System
Faouzi Bader and Musbah Shaat
Centre Tecnol`ogic de Telecomunicacions de Catalunya-CTTC
PMT, av. Canal Olimpic s/n. 08860 Castelldefels-Barcelona, Spain
Email: {faouzi.bader, mshaat}@cttc.es
Abstract—In this paper, we analyze different designed pilot
patterns adapted to the DL-PUSC pilot grid for ﬁlter banks
multi-carrier (FBMC) system. Different scheme have been
proposed (pair of pilots, auxiliary pilot scheme, interference
approximation method, and Scattered pilot method) and their
performance evaluated and compared when using conventional
cyclic preﬁx orthognal frequency division multiplaxing (CP-
OFDM) system. We shown that by applying certain designed
patterns especially for ﬁlter banks multi-carrier, the bite error
rate can outperforms in certain cases that achieved by the
CP-OFDM system. The performance evaluations are done in
hypothetical WiMAX scenario on which the FBMC system will
substitute the CP-OFDM by maintaining as much as possible
the physical layer (PHY) compatibilities.
Keywords-WiMAX, Pilot pattern, Filter banks multicarrier
system, OQAM, MIMO, pilot pattern.
I. INTRODUCTION
Wireless multicarrier (MC) communication scheme has
proven its effectiveness in many of new communication
standards (WiMAX, LTE, DVB-S, WiFi, etc.) [1]. This is
not a fortuity, as multicarrier schemes offer many advantages
as their robustness in frequency selective channels, their
simplicity during the equalization and synchronization pro-
cesses, besides, their high degree of ﬂexibility and scalability
in offering best solutions in scarcity radio resource scenar-
ios. One of the most extended multicarrier schemes is the
orthogonal frequency division multiplexing (OFDM), which
encompass the advantages cited above, besides is one of
the schemes always considered and tested in emerging wide
band communication standards. A cyclic preﬁx (CP) is often
used in OFDM which acts as a buffer region where delayed
information from the previous symbols can be stored. The
OFDM receiver has to exclude samples from the cyclic
preﬁx which got corrupted by the previous symbol. The
OFDM scheme is actually used in several communication
systems as in e.g., WiFi, WiMAX, DVB-S2, and LTE [1].
Filters bank multiple carrier (FBMC) scheme is actually
appearing as an alternative scheme to the conventional
OFDM scheme, mainly in cognitive based environments
[2] [3] [5] [6]. There are several advantages in using the
FBMC than the OFDM, and one of them is the proper
use of the CP to cope with the channel impulse response
which results in a loss of capacity, which is not the case in
FBMC, added requirements for block processing to maintain
orthogonality among all the subcarriers. In OFDM systems,
the leakage among frequency sub-bands has a serious impact
on the performance of the FFT-based spectrum sensing in
cognitive radio (CR) environment. Moreover, to combat
the leakage problem in OFDM netwok a very tight and
hard implementation for synchronization has to be imposed
among the nodes. Another advantage of using the FBMC
scheme, is that the subchannels can be optimally designed
in the frequency domain to have a desired or speciﬁc spectral
containment.
Filter bank MC system (FBMC) with offset quadra-
ture amplitude modulation (OQAM) (named also OQAM-
OFDM) can achieve smaller intersymbol interference (ISI)
and intercarrier interference (ICI) without using the CP, by
using well designed pulse shapes that satisfy the perfect
reconstruction conditions. Moreover, the problem of the
spectral leakage can be solved by minimizing the side-lobes
of each subcarrier which leads to high efﬁciency (in terms
of spectrum and interference) [4]-[7].
So far, some attempts have been made to introduce the
FBMC in the radio communications arena, through propri-
etary schemes, in particular the IOTA technique (see: TIA-
902.BBAB, Wideband air interface Isotropic Orthogonal
Transform Algorithm (IOTA) physical layer speciﬁcation ,
document of the Telecommunications Industry Association
[8] [9], and in 3GPP TSG-RAN WG1. TR25.892, Feasibility
study of OFDM for UTRAN enhancement. V1.1.0, June
2004). However, the full exploitation of FBMC techniques
and their optimization in the context of radio evolution,
such as dynamic access, as well as their combination with
MIMO techniques, have not been considered. Physical Layer
for Dynamic Spectrum Access (PHYDYAS) FP7 European
project with code ICT-211887 [2], is one of the pioneer
research projects at the European level that tried to resolve
pending technical challenges for a real exploitation of the
FBMC scheme.
In this paper, the authors present a FBMC system that
aims to maintain a certain degree of compatibility with
156
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

the OFDM based WiMAX speciﬁcations described in IEEE
802.16e standard [11]. Several pilot patterns for channel es-
timation are here proposed and analyzed for FBMC follow-
ing the MIMO downlink (DL) partial usage of subcarriers
(PUSC) frame structure of WiMAX, but due to the nature of
the FBMC system, the pilots cannot be as straightforwardly
applied as in OFDM. The main reason is that, every FBMC
pilot symbol besides suffering the traditional effect of the
additive white Gaussian noise (AWGN) a new interference
component from frequency-time surrounding subchannels is
added, what will affect the well acquisition of the pilot
information at the receiver, therefore, results a degradation
on the system capacity.
This paper is an extension of the analysis presented
by the authors in [10], where the pilot pattern adaptation
for FBMC included only the interference ”approximation
method” (IAM) and the ”auxiliary pilot” scheme for channel
estimation. In this paper, besides results presented in [10],
the authors proposed new pilot patterns as the ”pair of pilots”
and the ”scattered pilots” methods. Note that, the added pilot
schemes are always designed considering the speciﬁcity of
the FBMC scheme and the mitigation of the surrounding
interference effect.
The paper is structured as follow: a brief overview on pilot
allocation structures in WiMAX system is presented in Sec-
tion II. The structure of the FBMC communication system
and its adaption to the downlink partial usage of subcarriers
(PUSC) speciﬁcations using MIMO with different proposed
pilot patterns structures are presented in Section III. Section
IV, introduces the simulation setup, and presents achieved
performances. Finally, in Section V, the main conclusions
on obtained results are drawn.
II. BRIEF OVERVIEW OF PILOT ALLOCATION
STRUCTURES IN WIMAX SYSTEMS
The general statement and frame structure of WiMAX
system for the time division duplex (TDD) mode can be
found in [11]. To ensure the compatibility of FBMC system
with WiMAX (at least within the context of pilot allocation)
these statements have to be considered as basis within the
ICT-PHYDYAS project [2] [3]. WiMAX offers three dif-
ferent subcarrier permutation schemes [11]. The ﬁrst, is the
Full Usage of the Subchannels (FUSC) scheme allocates ﬁrst
the pilots on ﬁxed positions, and the remaining subcarriers
are used to transmit the data. The second and the third
scheems are the Partial Usage of the Subcarriers (PUSC),
and the Band Adaptive Modulation and Coding schemes
(later referred as AMC) respectively, which divide the whole
frame (excluding the Preamble, the PCH and DL/UL-MAPs)
into minimal data units (named slots), where dedicated pilots
and data are jointly allocated. Each slot is deﬁned as a two
dimensional units which spans in both frequency and time
directions.
A. Pilot and data allocation for the PUSC, AMC and FUSC
modes
1) PUSC mode: The shape of one slot in the PUSC
scheme is two clusters in frequency direction and two
OFDM symbols in the time direction. Hence, the number of
data subcarriers is 48. Due to subchannel permutation the
clusters are transmitted at distant positions in the spectrum,
although each cluster is transmitted as a whole in adjacent
subcarriers. Consequently, the PUSC permutation scheme
increases the frequency diversity.
Data subcarriers
Pilot Carrier for antenna 0
Pilot Carrier for antenna 1
OFDM Symbols
Subcarriers
Figure 1.
Cluster structure for STC downlink PUSC using 2 antennas.
2) AMC mode: The AMC permutation scheme is char-
acterized by mapping adjacent subcarriers to each slot.
By doing so, although frequency diversity is minimized.
The use of adaptive modulation and coding may lead to
great beneﬁts by transmitting for each user on those bands
where the channel experiences favorable conditions. For this
permutation scheme, a smaller resource unit deﬁned by nine
contiguous subcarriers is used. This basic allocation unit is
referred to as a ’bin’. Each bin contains one pilot subcarrier
(whose position is changed every OFDM symbol) and eight
data subcarriers. There are four types of AMC slots. The ﬁrst
is given by the collection of six consecutive bins (hence a
6×1 structure), the second has a 2×3 structure, and the third
and the fourth are given by the 3×2 and the 1×6 structures
respectively.
3) FUSC mode: For the FUSC permutation scheme, the
symbol structure is constructed using pilot, data and empty
subcarriers. Pilots and empty subcarriers are ﬁrst allocated.
The remaining subcarriers are then used as data subcarriers.
48 data subcarriers are later mapped to each subchannel.
The subcarriers from each subchannel is mapped to physical
subcarriers and placed equidistantly in the spectrum. For
the FUSC scheme, one slot is deﬁned as one subchannel
per one OFDM symbol, thus giving a total of 48 data
subcarriers. Figure 2, shows an example of the location of
the pilots within one cluster for two transmit antennas. It
157
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

can be observed that the position of the pilot symbols from
the variable set change each two OFDM symbols. Designed
pilot patters for FBMC will focus mainly on the downlink
PUSC scheme.
Subcarriers
OFDM Symbols
. . . .
Pilot Carrier for antenna 0
Pilot Carrier for antenna 1
Data subcarriers
Figure 2.
Cluster structure for STC FUSC using 2 antennas.
III. FBMC SCHEME AND PILOT ALLOCATION
The hereafter subsections describe the transmission and
reception structures of the FBMC scheme, the speciﬁcity op-
eration of allocating pilots within a FBMC frame compared
with conventional OFDM, and the different designed pilot
pattern schemes considering the speciﬁcity of the FBMC.
A. Filter Bank based multicarrier structure
In FBMC, the ﬁlters bank are used in the transmultiplexer
conﬁguration using the synthesis ﬁlter bank (SFB) at the
transmitter side, and the analysis ﬁlter banks (AFB) at the
receiver side [11][12] (see Figure (3)). In FBMC systems,
the use of critically sampled ﬁlter banks would be prob-
lematic, since the aliasing effects would make it difﬁcult to
compensate imperfections of the channel by processing the
subchannel signals after the AFB only. Therefore, a factor
of two oversampling is commonly applied in the subchannel
at the AFB (see Figure (3b)).
In this paper the authors focused on uniform modulated
ﬁlters bank with a prototype ﬁlter g[m] of length L which
is shifted to cover the whole of the system bandwidth. The
output signal from the synthesis ﬁlter bank is given by
S[m] =
M−1
∑
k=0
∑
n∈Z
dk,ng[m−nM
2 ]ej2/Mm(m− D
2 )ejφk,n (1)
where D is the delay term which depends on the length
of the prototype ﬁlter g[m], and φk,n is an additional phase
term. The transmitted symbols dk,n are real-valued symbols.
Equation (1) can be written in a more compact form such
that
S[m] =
M−1
∑
k=0
∑
n∈Z
dkp,npgk,n[m]
(2)
where M is the number of subcarriers (M=IFFT/FFT size)
and also the number of active subcarriers, dk,n denotes
the real-valued symbol at the k-th subcarrier during the n-
th symbol interval, modulated at rate 2/T. The signalling
interval T is deﬁned as the inverse of the subcarrier spacing,
i.e., T = 1/∆f. The symbols dk,n and dk,n+1 can be
q 0,n
b 0,n
X
X
C2R
X
X
C2R
M/2
M/2
A0(z2)
AM-1(z2)
+
Z-1
X
X
C2R
M/2
A1(z2)
+
Z-1
IFFT
d 0,n
d 1,n
d M-
1,n
q 1,n
q M-1,n
b 1,n
b M-1,n
OQAM
modulation
Transform
block
Polyphase
filtering
(a)
b*
0,n
q*
0,n
X
X
M/2
Z-1
M/2
Z-1
M/2
B1(z2)
B0(z2)
BM-1(z2)
FFT
X
X
Subch.
Proc.
Subch.
Proc.
Subch.
Proc.
X
X
Re
Re
Re
b*
1,n
b*
M-1,n
q*
1,n
q*
M-1,n
R2C
R2C
R2C
~d 0,n
~d 1,n
~
d M-1,n
S/P
conversion
Polyphase
filtering
Transform
block
OQAM
demodulation
(b)
Figure 3.
Multicarrier polyphase ﬁlter bank for SISO case, (a) Synthesis
ﬁlter bank, (b) Analysis ﬁlter banks.
interpreted as the in phase and quadrature (I/Q) components
respectively of the complex-valued symbol ck,l (of rate 1/T
) from a QAM-alphabet. The phase term φk,n in equation
(1) guaranty and holds the real orthogonality condition [18]
by having,
ℜ
+∞
∑
m=−∞
g´k,´n[m]g∗
n,k[m] = δk,´kδn,´n
(3)
The synthesized signal burst is therefore a composite
of multiple subchannel signals each of which consists of
a linear combination of time-shifted (by multiples of T/2)
and overlapping impulse responses of the prototype ﬁlter,
weighted by the respective symbol values dk,n. L is the
length of the ﬁlter prototype p[m] and depends on the
size of the ﬁlter bank and the overlapping factor K by
having L = KM [12][13]. The ”C2R” and the ”R2C”
blocks in Figure 3, indicate the conversion of the data
from complex into real form, and the inverse operation
respectively. Note that each sub-carrier is modulated with an
Offset Quadrature Amplitude Modulation (OQAM) which
consists in transmitting the real and the imaginary parts of a
158
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

complex data symbol with a shift of half the symbol period
between them [13] [14].
B. Pilot allocation in FBMC
In FBMC system, either real or imaginary parts of the
complex symbols are used for data transmission in a stag-
gered manner. When a real (imaginary) part of a subcarrier
symbol is used, the unused imaginary (real) part is at the
receiver a fairly complicated function of surrounding data
symbols. Usually in OFDM systems recovering the channel
state information (CSI) is ﬁrst proceed from known time
and frequency pilot locations within certain intervals. The
whole signal is recovered by means of different interpolation
techniques [15]. Therefore, the channel state information
(CSI) recovery process in OFDM is simple. However, this
is not the case in ﬁlters bank systems, here every FBMC
time-frequency pilot position is contaminated or suffered
interference from the neighboring subchannels (see descrip-
tive scheme in Figure 4) [16]. With ideal channel this
interference is only located on the imaginary part of the
subchannel signal. Thus, the real part yields the originally
transmitted symbol dk,n. Note that this interference depends
on the real (imaginary) data around the pilot frequency-
time position (k, n), and has a random variable behavior
sometime close to zero. Therefore, sending a known symbol
at a known time-frequency location is not enough, since at
the receiver side the interference part will depends on the
surrounding data [2] [16] values.
k
k-1
k+1
n
n+1
n-1
time
frequency
d(k,n)
Surrounded Interference
Pilot symbol
Figure 4.
Time-frequancy pilot location in a FBMC system with sur-
rounded interferes.
The contribution weights on the interference of the data
surrounding a certain symbol closely coincide with the
response of the ﬁlter banks and depend on the design of the
prototype ﬁlter. Table I, shows the ﬁlter banks weights used
in this paper [2] [14] [18]. As a resume, the nature of FBMC
systems makes it impossible to construct pilot symbols for
channel estimation in the same way as in OFDM.
Table I
REPRESENTATION OF THE TIME-FREQUENCY RESPONSE OF THE FBMC
SYSTEM CONSIDERED IN THIS WORK. DUE TO THE EMPLOYED OFFSET
QAM MODULATION, THE EFFECTIVE TIME-FREQUENCY RESPONSE
WILL BE REDUCED TO ONLY BOLD VALUES IN [2].
0.0006
0.0001
0
0
0
0.0001
0.0006
-j0.00429
0.1250
j 0.2058
0.2393
j 0.2058
0.1250
j 0.049
-j0668
0.0002
0.5644
1.000
0.5644
0.0002.
0.0668
j0.00429
0.1250
j 0.2058
0.2393
j 0.2058
0.1250
j 0.049
0.0006
0.0001
0
0
0
0.0001
0.0006
C. Pilot pattern adaptation for FBMC downlink PUSC
scheme: the MIMO context
Using the PUSC permutation, the set of active subcarriers
is divided into clusters. The Pilots and the data subcarriers
are allocated within each cluster [11], each one formed by
14 adjacent carriers, where two of them are dedicated to
pilot symbols. In case of single antenna transmission, the
pilots’ positions are changing between each odd and even
symbols. In case of two transmitting antennas, the pilots
are placed following the scheme in Figure 5a. Speciﬁc pilot
locations are reserved and exclusively used by each antenna.
A proposed pilot pattern for a 2 × 2 FBMC system is
shown in Figure 5b. This structure is built considering a time
oversampling equal to T/2. That means that the relative pilot
overhead using this structure is the same as that considering
an OFDM system, i.e., for each pilot one offset quadrature
amplitude modulation is used in FBMC. Therefore, one
QAM symbol will be used in OFDM. At the AFB side, the
received output signal samples of the interest pilot symbol
at the frequency-time position (kp, np) can be expressed as:
rkp,np ≃ hkp,np(dkp,np + j tkp,np) + zkp,np
(4)
where hkp,np and zkp,np are the channel coefﬁcient and
the noise term respectively at pilot subcarrier kp and time
index np. According to the values depicted in Table I, we
note that most part of the energy is localized in a restricted
set (shown in bold) around the considered symbol. Conse-
quently, we assumed in (4) that the intrinsic interference
term depends only on this restricted set (denoted by (k, n)
in (5)). Moreover, we assume that the channel is quasi-static
at least over all this zone. The value tk,n is deﬁned as an
intrinsic interference and is equal to,
tkp,np =
∑
(k,n)̸=(kp,np)
hkp,npdk,n
+∞
∑
m=−∞
gk,n[m] g∗
np,kp[m]
(5)
In case having a MIMO system with Nt transmit antennas
and Nr receive antennas, the real (imaginary) pilot symbol
d(i)
k,n is transmitted at the frequency-time position (kp; np)
over the transmit antenna i(i
∈ {1, ..., Nt}). So, after
transmitting through the radio channel, we demodulated at
159
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Data subcarriers
Pilot Carrier for antenna 0
Pilot Carrier for antenna 1
OFDM Symbols
Subcarriers
FBMC Symbols (time)
Subcarriers
Equivalent to
one OFDM
symbol time
. . . .
(a)
(b)
Figure 5.
Pilot pattern for 2 × 2 antennas, (a) cluster structure for STC
downlink PUSC in WiMAX, (b) STC PUSC adapted to FBMC.
the j − th received antenna [17], and the received signal is,
r(j)
kp,np =
Nt
∑
i=1
h(j i)
kp,np(d(i)
kp,np +j t(i)
kp,np) + z (j)
kp,np
(6)
where h(j,i)
kp,np is the channel coefﬁcient between transmit
antenna ”i” and receive antenna ”j”. If the prototype ﬁlter is
designed with good frequency selectivity and a roll-off factor
α ≤ 1, the range includes kp with both adjacent subcarriers
(kp − 1) and (kp + 1) in the frequency direction.
D. FBMC adaptation using auxiliary pilot scheme
C. L´el´e et al. used in [18] the ”auxiliary pilot” concept
in OQAM-OFDM preamble for channel estimation. This
concept, was in this paper used and adapted to deal with
the channel estimation process in a FBMC MIMO system. In
Figure 6, a modiﬁed scheme from that depicted in Figure 5b
is presented to use auxiliary pilot scheme in a MIMO-FBMC
system. As it can be shown in Figure 6, two types of pilots
per antenna are used, each one allocated in a predeﬁned
position within the FBMC frame. As described in [2] [3]
and [19], the main goal of the auxiliary pilot (named also as
’help pilot’) position located adjacently to the pilot position
(ka, na) is to cancel the extra interference effect appeared
in (5).
In other words, the interference part that affects the pilot
must become equal zero, or small enough to be neglected.
The main reason by introducing a spacing between both
pair of pilots (one per each antenna) in Figure 6, is to
avoid to have an auxiliary pilot in the window of another
auxiliary pilot as recursive calculation of auxiliary pilots
would be required (see the ﬁlter weights values in Table I),
which may be somewhat inconvenient. However, using this
slightly modiﬁed pilot pattern scheme this difﬁculty can be
avoided, and each of the auxiliary pilots can be calculated
independently. For MIMO case, this can be achieved by
choosing the value of the auxiliary pilot equal to
d i
ka,na =
∑
(k,n)∈Ωkpnp
(k,n)̸=(kp,np)(k,n)̸=(ka,na)
di
k,n ˆuk−kp,n−np
ˆukp−ka,np−na
(7)
Note that it is preferable to choose the auxiliary pilot in such
a way that the magnitude of the denominator is maximized.
E. FBMC using Interference Approximation Method (IAM)
The interference approximation method (IAM) was pre-
sented by C. Lele et al. in [18] for preamble-based channel
estimation using the Isotropic Orthogonal Transform Algo-
rithm (IOTA) scheme [9].
Subcarriers
FBMC Symbols (time)
Equivalent to one 
OFDM symbol 
time
. . . . 
Data subcarriers
Pilot Carrier for antenna 0
Pilot Carrier for antenna 1
Auxiliary Pilot  Carrier 
for antenna
Figure 6. Pilot and auxiliary pilot pattern structure for 2×2 MIMO FBMC
system.
160
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

The method is based on the assumption that the con-
tributions come only from the ﬁrst frequency-time order
neighboring positions. The authors, extended this concept
to the MIMO mode using two antennas at the transmitter.
The pilot pattern structures proposed is depicted in Figure
7. In Figure 7a, a set of three pilot positions are reserved for
each antenna i. The pilot symbol di
kp,np is ﬁrst located in the
center position of this set, the remained pilots di
kp,np−1 and
di
kp,np+1 are here named as ”Aided Pilot Carrier” (APC),
as their main function is to aid the pilot di
kp,np to obtain
an approximation of the interference generated by the ﬁlter
banks. Note that, in both depicted structures in Figure
7 (7a, and 7b), we dealt with partial interference as the
amount of interference of Ωkp,np that affects the pilot di
kp,np
could not be here estimated. In Figure 7b, we conﬁned
with the information from the (kp, np − 1), (kp, np + 1),
(kp − 1, np), and (kp + 1, np) APCs frequency-time posi-
tions. We focused on the case where the pilots’ positions
(kp, np −1), (kp, np +1) of each antenna are forced to zero.
Therefore, forcing the largest interference weights caused
by the ﬁlter bank contributions (see values in Table I) (i. e.,
|uk,n+1| = |uk,n−1| = 0.5644) to zero. The interference
weight at the frequency-time positions (kp − 1, np), and
(kp + 1, np) is |uk−1,n| = |uk+1,n|=0.2393, which have
relatively lowest interference weights. This approach allows
to maximize the modulus of the resulting pilot, and hence
to minimize the noise effect.
F. FBMC using pair of pilots (POP) scheme
As previously mentioned, in FBMC the channel estima-
tion issues is different of that in conventional cyclic preﬁx
OFDM. The reason is that,as already point out, the sought
channel frequency response values are complex whereas the
training input is real. Moreover, the AFB output samples
also contain imaginary contributions from neighboring times
and frequencies directions. Under the assumption of having
a good time-frequency localization with the employed ﬁlter
prototype, and a relatively low channel frequency selectivity,
J. P. Javaudin et al. proposed in [19] the POP method
for coming up with the channel acquisition in a QAM-
OFDM system using two preamble symbols. The authors
modiﬁed proposed POP scheme in [19] to deal with channel
estimation in a MIMO FBMC system using modiﬁed PUSC
pilot pattern scheme depicted in Figure 5b. Here the pais of
pilots relies on simple algebraic relations for the input/output
samples in two time slots, and aims at computing a channel
estimate operation by using (4) in two different (in practice
consecutive) time slots {n, n + 1} to construct a system of
equations using the real and imaginary parts of a channel
gain H(c)
k,n (c, means complex value). Note that H(c)
k,n =
HR
k,n + jHI
k,n R and I refer to the ”Real” and ”Imaginary”
parts. The pilot pattern proposed in Figure 5b, preserves
the orthogonality between each antenna’s pilots. To describe
the POP’s channel information acquisition, we denote by
Subcarriers
FBMC Symbols (time)
Equivalent to
one OFDM
symbol time
. . . .
Subcarriers
FBMC Symbols (time)
Data subcarriers
Pilot Carrier for antenna 0
Pilot Carrier for antenna 1
Equivalent to
one OFDM
symbol time
. . . .
Aided Pilot Carrier for
antenna
(a)
(b)
Figure 7.
Pilot and pilot support using IAM concept for FBMC in DL-
PUSC mode for 2 antennas: (a) reserved allocation for pilots, (b) pilot and
aided pilot carrier (APC) positions.
(kp, np) and (kp, np+1) the frequency-time positions of the
two pilots di
kp,np and di
kp,np+1 respectively (i refers to the
antenna index). The value W (c)
kp,np =
1
H(c)
kp,np
correspond to
the zero forcing (ZF) equalization coefﬁcient. By neglecting
the noise part in (4), once can have for each even k a received
signal at the j − th antenna as,
{
r(j)
kp,npW (j,i)
kp,np =
d(i)
kp,np + j t(i)
kp,np
r(j)
kp,np+1W (j,i)
kp,np+1 =
d(i)
kp,np+1 + j t(i)
kp,np+1
(8)
Then
{
rR,(j)
kp,npW R,(j,i)
kp,np − rI,(i)
kp,npW I,(j,i)
kp,np =
d(i)
kp,np
rI,(j)
kp,npW R,(j,i)
kp,np + rR,(i)
kp,npW I,(j,i)
kp,np =
d(i)
kp,np+1
(9)
having W (j,i)
kp,np ≃ W (j,i)
kp,np+1 hence
161
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org



rR,(i)
kp,np
−rI,(i,j)
kp,np
rI,(j)
kp,np+1
rR,(j,i)
kp,np+1



 W R,(j,i)
kp,np
W I,(j,i)
kp,np

 =


d(i)
kp,np
d(i)
kp,np+1


(10)
(
W R,(i,j)
kp,np
W I,(j,i)
kp,np
)
=
1
rR,(j)
kp,nprR,(j)
kp,np+1+rI,(j)
kp,nprR,(j)
kp,np+1
×
(
W R,(j,i)
kp,np
W I,(j,i)
kp,np
)
More compactly
W (j,i)
kp,np =
d(i)
kp,npr∗(j)
kp,np+1 + j d(i)
kp,np+1r∗(j)
kp,np
ℜ(r(j)
kp,npr∗(j)
kp,np+1)
(11)
We set for each antenna the value of each pair of pilots such
that; d (i)
kp,np+1 = 0 and d (i)
kp,np = 1 with i ∈ {1, . . . , Nt}.
Thus,
W (j,i)
kp,np =
r∗ (i)
kp,np+1
ℜ(r (i)
kp,npr∗ (j)
kp,np+1)
(12)
One of the advantages of the POP scheme, besides
its simplicity is that, it doesn’t explicitly depends on the
employed prototype ﬁlter. However, it must be emphasized
that the above derivation only holds when noise is negligible.
One can see that in the presence of noise, the method can
have unpredictable performance since the degree of the noise
enhancement in general also depends on unknown (hence
uncontrollable) data.
G. FBMC using scattered pilots
Scattered or orthogonal pilot sequences are usually used
to transmit over Nt antennas in CP-OFDM systems [20].
Using such pilot sequences it is possible to recover the
channel coefﬁcients for each pair of receive and transmit
antennas. As for MIMO CP-OFDM system it is possible
to choose the value of the pilot in the form; for instance,
[P1, P2] for antenna ”1”, and [ ´P1, ´P2] for antenna ”2” (see
references in [20]). The assumption of constant channel
over 2 consecutive symbols is fulﬁlled in OQAM-OFDM
(FBMC) system. Adapting the orthogonal pilot sequences
to PHYDYAS’s FBMC speciﬁcations, we start from the
equivalent D-PUSC pilot structure for two antennas at the
transmitter as depicted in Figure 1, and we propose an
adapted pilot structure version for MIMO FBMC as in
Figure 8a. Using proposed scattered pilots in Figure 8,
with PHYDYAS ﬁlter parameters [3] depicted in Table I,
we assume that the channel is quasi-static at least over
four consecutive FBMC time symbols. As in previous pilot
allocation schemes, the main objective is always to cancel
the interference caused by the neighboring symbols (see
Figure 4). First, orthogonality between the pilot sequences
over the antennas could be preserved by setting one of the
pilots to zero. Secondly, the interference is compensated by
setting the value of one of the neighbors to the total of the
intrinsic interference.
The cancelation of the intrinsic interference is performed
in two steps too. First, the di
k,n−1 (i ∈ {1, 2} refers to
transmit antenna index) symbol is determined to cancel the
interference over (k, n) position. Then d2
k,n+2 and d1
k,n−1
symbols are determined to cancel the interference over
the (k, n + 1) and (k, n) respectively. It can be seen in
Figure 8, that di
k,n+2 is placed at position (k, n + 2), so by
modifying the di
k,n+2 value it doesn’t generate interference
on the symbol located at position (k, n). As a consequence,
this allows to cancel intrinsic FBMC interference in both
(k, n) and (k, n + 1) time-frequency positions. The values
of d2
k,n and d1
k,n+1 are here ﬁxed to zero. Note that proposed
scattered pilot scheme in Figure 8, could be considered as a
special case of the auxiliary pilot scheme depicted in Figure
6.
Subcarriers
FBMC Symbols (time)
Data subcarriers
Pilot Carrier
Equivalent to
one OFDM
symbol time
. . . . 
Antenna 1
FBMC Symbols (time)
n n+1 n+2
n-1
k+1
k
k-1
d1
k,n+1
d1
k,n
d1
k,n+2
d1
k,n-1
Antenna 2
FBMC Symbols (time)
n n+1 n+2
n-1
k+1
k
k-1
d2
k,n+1
d2
k,n
d2
k,n+2
d2
k,n-1
Figure 8.
Simpliﬁed orthogonal pilot sequences in FBMC MIMO system
with 2 transmit antennas: (a) general structure, (b) pilot allocation for each
transmitted antenna.
IV. SIMULATIONS RESULTS
The pilot pattern structures were tested using the reference
ﬁlter bank parameters in PHYDYAS project [2][3], with an
overlapping factor K =4 and WiMAX-physical layer like
basic parameters with: FFT-size and M equal to 1024, a
bandwidth of 10 MHz, and subcarrier spacing of 10.94 kHz.
This allows a transmission of 53 OQAM symbols. Note that
due to the effect of the cyclic preﬁx in an OFDM based
WiMAX system only 47 symbols can be used. During all
the simulations the evaluated link is the downlink PUSC
(DL-PUSC) structure [11].
In all the simulations received signals are assumed per-
fectly synchronized in time and frequency domain. The
interpolation process is carried out using two dimensional
linear surface interpolations within the areas limited by the
162
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

carriers and the symbols with pilot supports. Simulations
have been run over 600 channel realizations. Note that a
weak spatial correlation is assumed for both transmit and
receive antennas. The CP-OFDM transmitted signal was
again scaled in each experiment so it has to be of the
same power with the channel input in the corresponding
FBMC/OQAM system. Note that there is no channel coding
scheme used during the simulation process.
It can be seen in Figure 9, that the POP scheme adapted
for MIMO FBMC exhibited a performance worse than the
CP-OFDM schemes for both channels; Veh-A, and Veh-B.
A similar strategy for the pair values of (0, ±1) for pilots
have been adopted as in [19] for each antenna pilot pattern.
Although a performance degradation is experienced by the
CP-OFDM scheme in the Veh-B channel, the POP scheme
still yields worse results in the Veh-A channel. Therefore,
it can be concluded that the POP scheme is unsuitable for
ﬁlter bank multicarrier system due to its poor performance
compared with the CP-OFDM scheme.
0
2
4
6
8
10
12
14
16
18
10
−3
10
−2
10
−1
10
0
BER
SNR [dB]
2X2, 16 QAM, K=4, M=1024
 
 
CP−OFDM VehA
POP VehA
CP−OFDM VehB
POP VehB
Figure 9.
A 2 × 2 MIMO scheme performances using FBMC and CP-
OFDM for Veh-A and Veh-B at 60 Km/h, using adapted POP method to
downlink PUSC. Filter bank references: M=1024, K=4, and 16 QAM
modulation with ZF equalization.
In Figure 10 and Figure 11, the use of the two variants
of the adapted IAM-R (depicted in Figure 7a, and Figure 7b
respectively) are analyzed. In Figure 10, two APC carriers
are used to estimate the interference effects of the used ﬁlter.
Here we dealt with a partial interference approximation as
not all the interference (Ωkp,np = Ω1,1) that affects the
pilot di
kp,np could be estimated. The real values used in
[d i
kp,np−1d i
kp,npd i
kp,np+1] are [ 0 di
kp,np 0 ] respectively, with
the centered value di
kp,np = ±1. It can be also observed that
the ”IAM-Ra” scheme in Figure (10) performs similarly as
the CP-OFDM for SNRs lower than 8 dB for Veh-A channel
environment, and for SNRs lower than 5 dB in case of Veh-
B channel environment. An error ﬂoor is observed when the
IAM is used at high SNRs due to the unavoidable intrinsic
interference which is shows up at weak noise regimes.
0
2
4
6
8
10
12
14
16
18
10
−3
10
−2
10
−1
10
0
BER
SNR [dB]
2X2, 16 QAM, K=4, M=1024
CP−OFDM VehA
IAM−Rb VehA
CP−OFDM VehB
IAM−Rb VehB
Figure 10.
A 2 × 2 MIMO scheme performances using FBMC and CP-
OFDM for Veh-A and Veh-B channels at 60 km/h, using adapted IAM
method in DL-PUSC: (a) IAM-Ra refer to scheme in 7a for 2 antennas.
However, a better result is achieved in Figure 11 ”IAM-
Rb” due to the use of several APC carriers, more ex-
actly four ”aided” pilots. In Veh-A channel environment
very similar performance in terms of BER is achieved
using the FBMC and/or the CP-OFDM scheme. The CP-
OFDM performs around 1/2 dB better than the FBMC.
In channels with higher frequency selectivity as in Veh-B
channel environment, the FBMC system performs similarly
as the CP-OFDM up to SNR= 12 dB. For higher values
of SNRs the CP-OFDM clearly outperforms the FBMC
system. Here the value of di
kp,np−1 ,and di
kp,np+1 is zero,
and [di
kp−1,npdi
kp,npdi
kp+1,np] use ±1 values in alternation.
The main reason for such alternation is to alleviate the
risk of hight peaks power [18]. Note that, still not all the
interference that affects the pilot di
kp,np could be estimated
but only almost the largest ones.
Figure 12, shows that the use of auxiliary pilots in FBMC
system outperforms the conventional CP-OFDM system. In
Veh-A channel with 60Km/h of velocity moving the FBMC
with Minimum Mean Square Error (MMSE) equalization
achieves better performs than the CP-OFDM. Even using the
zero forcing (ZF) equalization the performances are lightly
better than the CP-OFDM with ZF.
Figure 13, depicts obtained performance with scattered
pilots for CP-OFDM and FBMC using non iterative MMSE
receiver. It can be observed that for pedestrian channel (type
A at 3 km/h of mobility) FBMC performance is very similar
to that obtained with a CP-OFDM system. Due to the very
163
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

0
5
10
15
20
10
−3
10
−2
10
−1
10
0
BER
SNR [dB]
2X2, 16 QAM, K=4, M=1024
CP−OFDM VehA
IAM−Rb VehA
CP−OFDM VehB
IAM−Rb VehB
Figure 11.
A 2 × 2 MIMO scheme performances using FBMC and CP-
OFDM for Veh-A and Veh-B channels at 60 km/h, using adapted IAM
method in DL-PUSC. IAM-Rb (describes scheme in Figure 7b ) for 2
antennas. M=1024, K=4, and 16 QAM with ZF equalization.
2
4
6
8
10
12
14
16
18
10
−3
10
−2
10
−1
10
0
BER
SNR [dB]
2X2, 16 QAM, K=4, M=1024
 
 
CP−OFDM VehA 60Km/h
FBMC MMSE VehA−60 Km/h
FBMC ZF VehA−60 Km/h
CP−OFDM VehA 120Km/h
FBMC MMSE VehA−120 Km/h
FBMC ZF VehA−120 Km/h
Figure 12.
A 2 × 2 MIMO scheme performances using FBMC and CP-
OFDM for Veh-A at different MS velocities (60 Km/h and 120 Km/h), using
adapted auxiliary pilot method (see ﬁg. 6) vs. conventional CP-OFDM.
M=1024, K=4, DL-PUSC mode, and 16 QAM using MMSE [17] and ZF
equalizations.
low variability of this channel, the assumption of having
four FBMC time symbols (equivalent to two OFDM time
slots) makes sense as the channel is quasi invariant. In the
case of higher frequency selectivity channels, as the Veh-
A/B, additional degradation in MIMO can occur in FBMC
due the assumption of a constant channel over the symbols
besides the interference effect of the ﬁrst order neighbors.
2
4
6
8
10
12
14
16
18
10
−3
10
−2
10
−1
10
0
2X2, 16 QAM, K=4, M=1024
BER
SNR [dB]
 
 
CP−OFDM  Ped−A
FBMC MMSE Ped−A
Figure 13.
CP-OFDM and FBMC comparison with 2 × 2 SDM, over
Ped-A channel with non iterative MMSE receiver.
V. CONCLUSION
In this paper the authors studied the possibility to adapt
the pilot pattern of the DL-PUSC MIMO WiMAX scheme to
MIMO FBMC system. Different scheme have been proposed
and their performance evaluated and compared with CP-
OFDM system (POP, auxiliary pilot scheme, IAM-Ra,IAM-
Rb, and Scattered pilots). Proposed auxiliary pilot scheme
seems able to eliminate the secondary interference from
the neighboring symbols into the pilots antenna using both
the ZF and the MMSE receivers, and to achieve better
BER performances than CP-OFDM. Besides, the proposed
scheme has the same pilot overhead as in OFDM. The use
of scattered pilot for MIMO based on combined auxiliary
pilots will be further investigated such that the antennas
pilot positions doesn’t suffer the effect of the surrounding
interference due to the largest weights of the ﬁlter banks.
ACKNOWLEDGMENT
The authors would like to thank all the partners of the
European ICT 2008-211887 project PHYDYAS.
REFERENCES
[1] K. Baum, B. Classon, and P. Sartori, ”Principles of Broadband
OFDM Cellular System Design”. Wiley-Blackwell. March
2009.
[2] ICT-211887
PHYDYAS
European
project,
www.ict-
phydyas.org. (visited 31st January 2011).
[3] ICT-PHYDYAS Deliverable 3.1 ”Equalization and demod-
ulation in the receiver (single antenna)”, Section: Channel
estimation. 2008.
[4] B. Farhang-Boroujeny, ”Filter bank spectrum sensing for cog-
nitive radios,” IEEE Trans. on Signal Processing,” vol. 56, no.
5, pp. 1801-1811. May 2008.
164
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

[5] M. Shaat and F. Bader, ”Low Complexity Power Loading
Scheme in Cognitive Radio Networks: FBMC Capability”,
in Proceeding of 20th IEEE International Symposium on
Personal, Indoor and Mobile Radio Communications (IEEE
PIMRC’2009), pp. 2597-2602. Tokyo, Japan. September 2009.
[6] B. Farhang-Boroujeny and R. Kempter, ”Multicarrier commu-
nication techniques for spectrum sensing and communication
in cognitive radios,” IEEE Communications Magazine (Special
Issue: on Cognitive Radios for Dynamic Spectrum Access),
vol. 48, no. 4, pp. 80-85, Apr. 2008.
[7] H. Zhang, D. L. Ruyet, and M. Terre,”Spectral efﬁciency
analysis in OFDM and OFDM/OQAM based cognitive radio
networks,” in Proc. of the IEEE Vehicular Technology Confer-
ence (IEEE VTC-Spring’09), pp.1-5, Barcelona, Spain. April
2009.
[8] J. P. Javaudin and D. Lacroix,”Technical description of
OFDM/IOTA modulation, 3GPP TSG-RAN-1 meeting no. 31,”
Tokyo, Japan. Feb 18-21, 2003.
[9] ”Wideband air interface isotropic orthogonal transform algo-
rithm (IOTA) - public safety wideband data standards project
- digital radio technical standards TR-8.5 subcommittee,”
TIA902.BBAB (Physical Layer Speciﬁcation, March 2003).
[10] F. Bader and M. Shaat, ”Pilot Pattern Adaptation and Chan-
nel Estimation in MIMO WIMAX-Like FBMC System,” in
Proc. of Sixth International Conference on Wireless and Mo-
bile Communications (ICWMC’2010). pp. 111-116. September
2010. Valencia, Spain.
[11] Part 16: Air Interface for Fixed and Mobile Broadband
Wireless Access Systems Amendment 2: Physical and Medium
Access Control Layers for Combined Fixed and Mobile Opera-
tion in Licensed Bands and Corrigendum 1, IEEE Std. 802.16e,
2006.
[12] M. Bellanger,”Filter Banks Digital Processing and Signals:
Theory and Practice,” John Wiley and Sons, New York, NY-
USA, 3rd edition 2000.
[13] M. Bellanger, ”Transmit diversity in multicarrier transmis-
sion using OQAM modulation,” in Proc. of the International
Symposium on Wireless Pervasive Computing (ISWPC’2008),
Santorini (Greece), May 2008
[14] M. Bellanger, ”Speciﬁcation and design of a prototype ﬁlter
for ﬁlter bank based multicarrier transmission,” Proc. of the
IEEE International Conference on Acoustics, Speech, and
Signal Processing, (IEEE ICASSP’2001). Vol 4. pp. 2417-
2420. Salt Lake City, USA. May 2001.
[15] R. V. Nee,”OFDM Wireless Multimedia Communications.”
Artech House. January 2000.
[16] P. Siohan, C. Siclet, and N. Lacaille,”Analysis and design
of OFDM/OQAM systems based on ﬁlterbank theory,” IEEE
Transactions on Signal Processing, vol. 50, no. 5, pp. 1170-
1183, 2002.
[17] J. P. Javaudin and Y. Jiang, ”Channel estimation in MIMO
OFDM/OQAM,” in Proc. of the IEEE International Workshop
on Signal Processing Advances for Wireless Communica-
tions (IEEE SPAWC’2008). pp. 266-270. Recife, Pernambuco,
Brazil, July, 2008.
[18] C. L´el´e, J.-P. Javaudin, R. Legouable, A. Skrzypczak,
and P. Siohan, ”Channel estimation methods for preamble-
based OFDM/OQAM modulations,” European Transactions on
Telecommunications (ETT), Vol 19, Issue 7, pp. 741-750.
November 2008.
[19] J. P. Javaudin, D. Lacroix, and A. Rouxel, ”Pilot-aided
channel estimation for OFDM/OQAM,” in Proc. of the IEEE
Vehicular Technology Conference (VTC-spring 2003), pp.
1581-1585, April 2003.
[20] N. Chen, M. Tanaka, and R. Heaton,”Channel Equalisation
for OFDM using scattered pilots,” in Proc. of the IEEE
Vehicular Technology Conference (IEEE VTC-Spring’2002).
pp. 1040-1044. Birmingham, Alabama-USA. May 2002.
165
International Journal on Advances in Telecommunications, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

