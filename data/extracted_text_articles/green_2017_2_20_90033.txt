Advanced Metering Infrastructure Data Driven Phase Identiﬁcation in Smart Grid
Wenyu Wang, Nanpeng Yu, Zhouyu Lu
Department of Electrical and Computer Engineering
University of California, Riverside
Riverside, California 92521
Email: wwang032@ucr.edu, nyu@ece.ucr.edu, zlu044@ucr.edu
Abstract—Many important distribution network applications,
such as load balancing, state-estimation, and network recon-
ﬁguration, depend on accurate phase connectivity information.
The existing data-driven phase identiﬁcation algorithms have
a few drawbacks. First, the existing algorithms require the
number of phase connections as an input. Second, they can
not provide accurate results when there is a mix of phase-to-
neutral and phase-to-phase connected smart meters, or when
the distribution circuit is less unbalanced. This paper develops
an advanced metering infrastructure (AMI) data driven phase
identiﬁcation algorithm that addresses the drawbacks of the
existing solutions in two ways. First, it leverages a nonlinear
dimensionality reduction technique to extract key features from
the voltage time series. Second, a constraint-driven hybrid clus-
tering (CHC) algorithm is developed to dynamically create smart
meter clusters with arbitrary shapes. The ﬁeld validation results
show that the proposed algorithm outperforms the existing ones.
The improvement in the phase identiﬁcation accuracy is more
pronounced for distribution feeders that are less unbalanced. In
addition, this paper discovers that more granular voltage time
series leads to higher phase identiﬁcation accuracy.
Keywords—AMI; density-based clustering; phase identiﬁcation;
smart grid; t-SNE.
I. INTRODUCTION
It is estimated that electric utilities around the world will
spend $10.1 billion on advanced metering infrastructure (AMI)
data analytics solutions through 2021 [1]. The boom in the
development and implementation of AMI data analytics is
driven by two trends. First, electric utilities which have already
deployed or plan to deploy the AMI are looking for new
value streams to justify the business case of the AMI projects.
Second, the advent of distributed energy resources (DERs)
on the edge of the distribution grid is creating signiﬁcant
challenges and opportunities for the electric utilities and third-
party aggregators.
The phase identiﬁcation problem is deﬁned as identifying
the phase connectivity of each smart meter and structure in
the power distribution network [2]. It is a critical AMI data
analytics application due to two reasons. First, the rise of
DERs requires the distribution system operators to actively
manage the distribution grid to coordinate the operations of
the DERs. However, most electric utilities in the world do
not have accurate records of the phase connectivity of their
distribution networks to enable advanced control strategies.
Second, it is labor and capital intensive to perform phase
identiﬁcation using ﬁeld validation tools. Therefore, conduct-
ing phase identiﬁcation with AMI data driven analytics can
provide another useful justiﬁcation for the deployment of AMI
projects.
In this paper, an AMI data driven machine learning algorith-
m is developed to solve the phase identiﬁcation problem. The
proposed algorithm leverages voltage magnitude data recorded
by the AMI to identify the phase connection of each smart
meter and structure. A nonlinear dimensionality reduction
technique is ﬁrst used to extract key features from the voltage
time series. A constraint-driven hybrid clustering (CHC) al-
gorithm is then developed to separate smart meters/structures
into various clusters. Finally, the phase connection of each
cluster can be identiﬁed by performing ﬁeld validations on the
phase connections of very few smart meters. Comprehensive
case studies are conducted on 5 distribution circuits, which
went through detailed ﬁeld validations. The AMI data driven
machine learning algorithm has yielded high accuracies on all
circuits. In addition, this paper discovers that more granular
voltage readings will lead to even more accurate phase iden-
tiﬁcation results.
Compared to the existing data-driven phase identiﬁcation
algorithms, the proposed method has the following advantages:
1) The proposed algorithm does not require prior knowl-
edge about the number of phase connections in the
distribution system. Most of the existing AMI data
driven methods need the number of phase connections
as an input parameter.
2) The proposed algorithm works well with distribution
feeders that have both phase-to-neutral and phase-to-
phase connections. Most of the existing techniques are
only capable of identifying the phase connections in dis-
tribution feeders with only phase-to-neutral connections
or phase-to-phase connections.
3) The accuracy of the proposed phase identiﬁcation algo-
rithm is not very sensitive to the level of unbalance in
a distribution feeder.
Currently, most electric utilities conduct phase identiﬁcation
using special phase meters [3][4]. Typically, two phase meter-
s/units are used. One unit is located at the substation to serve as
the reference. The other is called the ﬁeld unit and is located at
the smart meter/structure of interest in the distribution feeder.
The working mechanism of these special phase meters is
16
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-588-3
GREEN 2017 : The Second International Conference on Green Communications, Computing and Technologies

very similar to that of the phasor measurement units except
that the phase meters are mobile. With GPS time, the phase
angle difference between the reference point and the ﬁeld
structure can be accurately measured, which then determines
the phase connectivity of the ﬁeld structure. Although phase
meters provide highly accurate phase identiﬁcation results, this
solution is very time consuming and labor intensive, which
make it unsuitable for large-scale deployment.
The existing data-driven algorithms leverage electric load
and voltage magnitude measurements from the AMI to identify
the phase connections of the smart meters and structures in
the distribution network. These data-driven algorithms include
supply and consumption balancing [5][6], linear regressions
and correlation analysis [7][8], and constrained k-means clus-
tering algorithm (CK-Means) [2]. However, the existing data-
driven algorithms have three drawbacks. First, all of these
methods assume that the number of phase connections are
known. Second, the existing methods can not provide accurate
phase identiﬁcation results when there is a mix of phase-
to-neutral and phase-to-phase connected smart meters and
structures. Third, the existing methods are quite sensitive to
the level of unbalance in a distribution feeder. The proposed
AMI data driven phase identiﬁcation algorithm addresses these
drawbacks by leveraging a nonlinear dimensionality reduction
technique to extract hidden features from voltage time series
and using the CHC algorithm to dynamically create smart me-
ter clusters with arbitrary shapes. The ﬁeld validation results
show that the proposed algorithm outperforms the existing
methods in all of the 5 distribution feeders.
The rest of this paper is organized as follows. Section
II studies the drawbacks of the existing data-driven phase
identiﬁcation algorithms. Section III describes the proposed
phase identiﬁcation algorithm in detail. Section IV presents
the case studies on multiple distribution feeders to validate the
proposed phase identiﬁcation algorithm. Section V provides
the conclusions.
II. DRAWBACKS OF THE EXISTING DATA-DRIVEN PHASE
IDENTIFICATION METHODS
Three main drawbacks of the existing phase identiﬁcation
methods are studied in detail below. As the CK-Means method
is the most promising algorithm among the existing data-
driven phase identiﬁcation methods, it will be used as an
example in the performance evaluation. A comprehensive
study is conducted on 5 distribution feeders and 18 data sets
to analyze the impact of unbalance level and the mix of phase
connection types on the phase identiﬁcation accuracy for the
CK-Means method.
The general descriptions of the 5 distribution feeders and
18 data sets are shown in Table I. The feeder and smart
meter data is provided by the Paciﬁc Gas & Electric Company
and Southern California Edison. The number of customers,
feeder voltage level, proportion of the major phase connection
types, and feeder peak load are listed in the second column
TABLE I. DESCRIPTIONS OF THE DISTRIBUTION FEEDERS
Feeder
Number of Customers,
Month
Data
Feeder Voltage, and Peak Load
Set
1
3200 customers (99.8% phase-to-neutral),
Nov 2016
s1
12.47 kV, 4.4 MW.
Dec 2016
s2
2
4800 customers (98.8% phase-to-neutral),
Nov 2016
s3
12.47 kV, 8.3 MW.
Dec 2016
s4
3
4000 customers (97% phase-to-neutral),
Nov 2016
s5
12.47 kV, 6.4 MW.
Dec 2016
s6
4
Aug 2015
s7
Sep 2015
s8
1500 customers (100% phase-to-phase),
Oct 2015
s9
12.47 kV, 5.2 MW.
Nov 2015
s10
Dec 2015
s11
Jan 2016
s12
5
Aug 2015
s13
Sep 2015
s14
2400 customers (84% phase-to-phase),
Oct 2015
s15
12.47 kV, 8.5 MW.
Nov 2015
s16
Dec 2015
s17
Jan 2016
s18
of the table. A distribution feeder can have 3 possible phase-
to-neutral connections, AN, BN, and CN, and/or 3 possible
phase-to-phase connections, AB, BC, and CA, where A, B,
C, and N denote the three phases’ wires and the neutral
wire. 2 months of smart meters’ voltage data with 5-minute
granularity is gathered from feeder 1, 2, and 3. 6 months of
smart meters’ voltage data with hourly granularity is gathered
from feeder 4 and 5.
In feeder 1, 2, and 3, some meters have missing voltage
readings at different time intervals, making up 9%, 21%,
and 18% of the total customer population respectively. The
missing readings are ﬁlled in using the k-nearest neighbor
(k-NN) imputation method. A meter’s missing readings are
imputed using the average values of the ﬁve nearest neighbor
meters’ corresponding readings. The distance between meters
are measured by the Euclidean distance of the voltage time
series of the corresponding meters.
To make the results comparable, the hourly average voltage
magnitudes are calculated for feeder 1, 2, and 3. The hourly
average voltage magnitudes are used as inputs in this section.
Each of the 18 data sets includes one month of voltage
magnitude data from a feeder. The drawbacks of the existing
data-driven phase identiﬁcation algorithms are explored in the
next three subsections.
A. Number of Phase Connections
In order to solve the phase identiﬁcation problem, the
supply and consumption balancing approach [5][6] requires
the number of phase connections in the distribution feeder as
an input. In fact, the problem formulation in [5][6] only allows
the identiﬁcation of phase-to-neutral connections where the
number of phase connections is 3. In the linear regression and
correlation analysis [7][8], the number of phase connections
in the feeder is also a mandatory input. In fact, both linear
regression and correlation analysis work well when there are
only three phase-to-neutral connections. The k-means cluster-
ing algorithm is used in the CK-Means method [2], where
17
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-588-3
GREEN 2017 : The Second International Conference on Green Communications, Computing and Technologies

the number of phase connections/clusters needs to be known
as prior knowledge. When applying the CK-Means method to
identify the phase connections of the 5 distribution feeders,
the number of clusters is set to be 3 for feeders 1 to 4, given
that over 97% of the smart meters in these feeders only have
3 connection types. The number of clusters is set to be 6 for
feeder 5.
B. Impact of Unbalance Level on the Phase Identiﬁcation
Accuracy
This subsection evaluates the impact of the distribution
feeder’s unbalance level on the phase identiﬁcation accuracy
of the CK-Means algorithm. The CK-Means algorithm works
as follows: The voltage magnitude measurements are ﬁrst
standardized. Linear features are then extracted by using
principal component analysis (PCA) and the top d components
are selected. To provide a fair comparison with the proposed
phase identiﬁcation algorithm in Section IV, the number of
principal components is set to 30. Next, the data points in the
low-dimensional space are clustered by using a constrained
k-means clustering algorithm. Must-link constraints are de-
rived from the distribution feeders’ connectivity information,
which is typically available from the Geographical Information
System (GIS). The must-link constraints state that if some
smart meters are connected to the same lateral or transformer,
then they must be linked together and grouped into the same
cluster. To identify the phase of each cluster, ﬁeld validations
are performed on a must-link group of at least 20 smart meters
that has the least mean squared distance to the cluster center.
The CK-Means algorithm is applied on the 18 voltage time
series from the 5 distribution feeders. The phase identiﬁcation
accuracy is calculated based on independent ﬁeld validations
conducted by the electric utility companies. To measure the
level of unbalance of a distribution feeder, deﬁne u(t) as the
level of unbalance of a feeder at time interval t:
u(t) = |IA(t) − Im(t)| + |IB(t) − Im(t)| + |IC(t) − Im(t)|
3Im(t)
(1)
where Im(t) =
1
3(IA(t) + IB(t) + IC(t)) is the mean of
the distribution substation line currents of the three phases.
u(t) can be interpreted as the ratio of the average three-phase
current deviation to the mean. The average level of unbalance
Figure 1. The phase identiﬁcation accuracy of the CK-Means method under
different levels of unbalance.
for a distribution feeder u(t) over a month is calculated for
each data set.
Figure 1 plots the phase identiﬁcation accuracy against the
level of unbalance. It shows that the CK-Means algorithm
is very accurate for the highly unbalanced data sets. As the
level of unbalance decreases, the phase identiﬁcation accuracy
drops quickly. This result is very intuitive. Imagine there is a
perfectly balanced distribution feeder whose three phase wires
have the same load distribution all the time. In this case, the
level of unbalance should be zero. Therefore, it is impossible
to distinguish the phase connections of the smart meters
on the three phases with unsynchronized voltage magnitude
measurements.
C. A Mix of Phase-to-Neutral and Phase-to-Phase Connec-
tions
In general, the existing data-driven phase identiﬁcation
algorithms do not perform well for the distribution feeders
with a mix of phase-to-neutral and phase-to-phase connections.
For example, Figure 1 shows that the phase identiﬁcation
accuracy is the lowest for feeder 5. This is because feeder
5 not only has a lower degree of unbalance, but also has all 6
possible phase connections types, AN, BN, CN, AB, BC,
and CA. In this case, the default phase identiﬁcation accuracy
is only 16.7% instead of 33.3% for the distribution feeders
with only three possible phase connections.
III. TECHNICAL METHODS
The overall framework of the proposed phase identiﬁcation
algorithm is illustrated in Figure 2. The phase identiﬁcation
methodology involves three stages. In stage 1, voltage magni-
tude measurements are collected from the smart meters. Each
smart meter’s readings are centered and normalized by their
standard deviation. Key features are then extracted from the
preprocessed voltage time series with a nonlinear dimension-
ality reduction method. In stage 2, the CHC algorithm is
leveraged to cluster the low-dimensional data points generated
in stage 1. In stage 3, the phase connection of each cluster
Figure 2. The overall framework of the proposed phase identiﬁcation
algorithm.
18
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-588-3
GREEN 2017 : The Second International Conference on Green Communications, Computing and Technologies

is identiﬁed by performing ﬁeld validations on a very small
number of smart meters. The three stages are explained in
detail below.
A. Stage 1: Feature Extraction from Voltage Time Series
It is undesirable to directly work with raw voltage readings,
which are high-dimensional and noisy. Therefore, in the ﬁrst
stage, dimensionality reduction techniques will be applied to
extract key features from the raw voltage time series. The
extracted features will then be fed into the CHC algorithm in
stage 2.
Dimensionality reduction techniques can be divided into
two categories, linear dimensionality reduction methods and
nonlinear ones. Linear dimensionality reduction techniques,
such as PCA, are restricted to learning only linear manifolds.
However, high-dimensional data typically lies on or near a
low-dimensional, nonlinear manifold [9]. Furthermore, it is
very difﬁcult for linear mappings to keep the low-dimensional
representations of very similar points close together. This
explains the lower accuracy of the phase identiﬁcation algo-
rithm using linear features for less unbalanced feeders. To
address this problem, we turn to nonlinear dimensionality
reduction methods. Many nonlinear dimensionality reduction
techniques have been proposed, e.g., Sammon mapping [10],
curvilinear components analysis (CCA) [11], Isomap [12], and
t-distributed stochastic neighbor embedding (t-SNE) [9]. This
paper adopts t-SNE, because it has been shown to work well
with a wide range of data sets and captures both local and
global data structures. t-SNE improves upon SNE [13] by
1) simplifying the gradient calculation with a symmetrized
version of the SNE cost function and 2) adopting a Student’s
t-distribution rather than a Gaussian distribution to compute
the similarity between two points in the low-dimensional space
[9].
The basic idea of t-SNE is to convert the high-dimensional
Euclidean distances between data points into joint probabilities
and represent the data points in a low-dimensional space, so
that similar joint probabilities are preserved. Suppose we need
to map a high-dimensional data set X = {x1, x2, ..., xn} to a
low-dimensional data set Y = {y1, y2, ..., yn}. Deﬁne pji as a
joint probability of X. pji is a symmetric approximation of the
conditional probability that xi would pick xj as its neighbor.
The neighbors are picked in proportion to their probability
density under a Gaussian distribution centered at xi with a
variance σi. pji is calculated as pji = pij = (pj|i + pi|j)/2n,
where pj|i is calculated as:
pj|i =
exp(−∥xi − xj∥2/2σ2
i )
P
l̸=i exp(−∥xi − xl∥2/2σ2
i )
(2)
In the same way, deﬁne qji as a joint probability in Y , but
under a Student’s t-distribution with one degree of freedom.
Then qji can be calculated as:
qji = qij =
(1 + ∥yi − yj∥2)−1
P
l̸=m(1 + ∥yl − ym∥2)−1
(3)
Then given X, the mapping Y is found by minimizing the
Kullback-Leibler divergence between joint probability dis-
tribution P, in the high-dimensional space, and the joint
probability distribution Q, in the low-dimensional space:
C = DKL(P∥Q) =
X
i
X
j
pij log pij
qij
(4)
The t-SNE algorithm requires three input parameters: 1) the
output dimension dout (typically selected to be either 2 or 3);
2) the initial dimension din, which is the dimension that the
original data set is reduced to by PCA before performing t-
SNE; 3) perplexity p, which is a measure of effective number
of neighbors and controls σi. Since the objective function
(4) is minimized using a gradient descent optimization that
is initiated randomly, each run of t-SNE produces a slightly
different mapping result. In practice, it is recommended to run
t-SNE multiple times and select the result with the lowest cost
function value in (4). More details of the t-SNE algorithm can
be found in [9].
B. Stage 2: Group Data Points with the CHC Algorithm
After the preprocessed voltage time series are mapped to
a 2-dimensional or 3-dimensional feature space through t-
SNE, they need to be grouped into clusters. Three features of
the phase identiﬁcation problem need to be considered when
designing the clustering algorithm. First, many electric utility
companies do not know the number of phase connections
for each of their distribution feeders. Second, the customers
with the same phase connection in the low-dimensional fea-
ture space do not necessarily form a convex-shape cluster,
which is very common in t-SNE applications [9][14][15].
Third, valuable distribution network connectivity information
which deﬁnes the mapping between smart meters and lat-
erals/transformers should be incorporated into the clustering
algorithm.
In order to leverage the features of the phase identiﬁcation
problem, the CHC algorithm is developed and applied to
solve the smart meter clustering problem. The proposed CHC
framework synergistically combines the merits of an unsu-
pervised density-based clustering algorithm and a supervised
classiﬁcation algorithm. This paper selects the density-based
spatial clustering of applications with noise (DBSCAN) [16] as
the unsupervised clustering algorithm in the CHC framework,
because it naturally incorporates the ﬁrst two features of
the phase identiﬁcation problem. Unlike centroid-based or
medoid-based methods, DBSCAN does not need the number
of clusters as an input parameter. In addition, DBSCAN is
capable of discovering clusters with arbitrary shapes.
DBSCAN separates data points into different clusters and
noise/outliers. The noise/outliers do not belong to any cluster.
However, in the phase identiﬁcation application, all smart
meters must have a particular phase connection. To mitigate
this drawback, k-nearest neighbor (k-NN) classiﬁcation is
adopted as the supervised machine learning algorithm in the
19
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-588-3
GREEN 2017 : The Second International Conference on Green Communications, Computing and Technologies

CHC framework to assign these outliers and points in the low-
density region into one of the existing output clusters from
DBSCAN. At last, the must-link constraints deﬁned by the
feeder connectivity model will be considered in reassigning
smart meters connected to the same lateral/transformer to the
same cluster.
1) Review of DBSCAN: A brief review of DBSCAN is
provided here. DBSCAN is one prominent example of density-
based clustering approach with high computational efﬁciency.
The good efﬁciency of DBSCAN is crucial for deploying
phase identiﬁcation algorithms in electric utilities with t-
housands of distribution feeders. The DBSCAN algorithm
deﬁnes clusters and outliers based on four key concepts: ϵ
neighborhood of a point, directly density-reachable, density-
reachable, and density-connected. The algorithm requires two
parameters: ϵ, the radius of neighborhood, and MinPts, the
minimum number of data points in an ϵ neighborhood. The
ϵ neighborhood of a point p is deﬁned as the set of points
in the data set with a distance to p less than ϵ. A point p
is a core point if it has at least MinPts neighbors within the
radius ϵ. These neighbors are directly density-reachable from
p. A point q is density-reachable from p if there is a path
p, p1, p2, ..., pm, q such that each point is directly reachable
from the previous point. Two points are considered density-
connected if they have a distance of less than ϵ. These four
deﬁnitions allow us to deﬁne the transitive hull of density-
connected points, forming density-based clusters. The points
on the border of the clusters are called border points. Any
point(s) not reachable from a core point is counted as an outlier
or noise.
2) The CHC Algorithm: The framework of the CHC al-
gorithm is shown in Algorithm 1.
It requires four input
parameters, α, k, ϵ, and MinPts. α is a threshold parameter
used to ﬁlter out very small clusters. k is the parameter in the
1: Run the DBSCAN algorithm on a preprocessed data set
D with n data points with parameters ϵ and MinPts.
2: Deﬁne a threshold coefﬁcient α ∈ (0, 1). Given the output
of step 1, keep the data points from the clusters of size
greater than or equal to αn as the training data set.
Suppose there are c clusters kept. All the data points
outside these clusters are “un-clustered” data points.
3: Assign all un-clustered data points to one of the c clusters
with the k-NN algorithm.
4: With must-link constraints, the data set D can be divided
into N groups D1, ..., DN. If a data point has no links
to others, it forms a group itself. In each group Di, the
data points may have been assigned to different clusters.
To enforce the constraints, assign all data points in group
Di to the cluster that contains the largest number of data
points in Di.
5: Return the ﬁnal clustering result.
Figure 3. Algorithm 1: the CHC algorithm
k-NN algorithm representing the number of nearest neighbors.
The CHC algorithm has 5 steps. Step 1 runs the DB-
SCAN algorithm on features extracted by the t-SNE algorithm.
Depending on the distribution of data points in the low-
dimensional feature space, the DBSCAN output may include
large clusters, small clusters, and noise/outliers. Step 2 ﬁlters
out the points in the small clusters and noise/outliers and
only keeps the large clusters as the training data set for the
next step. Step 3 classiﬁes the points from small clusters and
noise/outliers with k-NN algorithm using the training data
points from the large clusters. Step 4 enforces the must-link
constraints by assigning all smart meters connected to the same
lateral/transformer to the same cluster. The ﬁnal clustering
results will be returned in step 5.
Note that researchers have proposed alternative approaches,
such as C-DBSCAN [17] to integrate constraints into density-
based clustering algorithms. In the C-DBSCAN algorithm, the
data points from different clusters involved in a must-link
constraint are simply forced to merge together. However, when
the preprocessed voltage time series are mapped to the low-
dimensional space, we often encounter cases where a very
small number of meters connected to one phase are spread over
two clusters representing two phases. To address this issue, in
step 4 of the proposed CHC algorithm, we only reassign all
the data points connected by a must-link constraint to the same
cluster without affecting the grouping of other data points.
C. Stage 3: Phase Identiﬁcation for Clustered Customers
The ﬁnal stage identiﬁes the phase connection of the clusters
determined in stage 2. This can be accomplished by per-
forming ﬁeld validations on a small number of samples of
smart meters with phase measurement tools [3][4]. The cost
associated with the ﬁeld validation is minimal as the number
of customers that require phase measurement is quite small. To
achieve the highest accuracy, the small sample of customers
should be chosen as close to the clusters’ centers as possible.
Depending on the availability of must-link constraints, two
sampling strategies can be implemented:
1) If there are no must-link constraints, then in each cluster
choose m smart meters that are closest to the cluster
center. Field validations can then be performed on these
m smart meters. The most frequent phase connection of
these m meters is selected as the phase connection of
all the customers in the cluster.
2) If must-link constraints are available, then in each cluster
choose the group Dg that contains at least w customers
and has the least mean squared distance to the cluster
center. Field validations will be performed on any of
the smart meters in group Dg. The phase connection of
the group is selected as the phase connection of all the
customers in the cluster.
20
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-588-3
GREEN 2017 : The Second International Conference on Green Communications, Computing and Technologies

IV. CASE STUDIES
A. Experimental Design
Two types of experiments are designed below to 1) examine
the performance of the proposed phase identiﬁcation algorithm
and 2) explore the impact of smart meter data granularity on
the phase identiﬁcation accuracy.
The ﬁrst set of experiments compare the performance
of the constrained k-means clustering algorithm with linear
dimensionality reduction [2] and the CHC algorithm with
nonlinear dimensionality reduction proposed in this paper.
The constrained k-means clustering algorithm with linear di-
mensionality reduction is referred to as “CK-Means” method.
Both methods are evaluated over 18 hourly voltage time series
gathered from 5 distribution feeders as described in Table I.
The second set of experiments evaluate the impact of smart
meter sampling frequency on the accuracy of the proposed
phase identiﬁcation algorithm. The experiments are conducted
over 6 voltage time series gathered from 3 distribution feeders.
The smart meters on distribution feeder 1-3 were conﬁgured
to record voltage magnitudes every 5 minutes. The average
voltage magnitudes with hourly, 15-minute, and 5-minute
granularity are used as inputs.
B. Parameter Selection
A few parameters need to be set up in order to run
the proposed phase identiﬁcation algorithm. In the feature
extraction stage, three parameters from the t-SNE algorithm
need to be selected. The dimensionality of the PCA output and
t-SNE input din is set to be 30. The perplexity p is set to be
100. Note that these two parameters can be tuned by running
the optimization several times on a data set and picking the
parameters that yield the best map [9]. The dimensionality of
the t-SNE output dout is typically set to be 2 or 3. For better
visualization, we set dout to 2. In fact, the case study results
with dout = 2 and dout = 3 are very similar.
In the proposed CHC algorithm, three key parameters
MinPts, ϵ, and α need to be tuned ﬁrst. The typical ranges
for the three parameters are 8 to 20 for MinPts, 1 to 3 for
ϵ, and 0.005 to 0.01 for α. When tuning these parameters,
the aim is to see the data points in the t-SNE space being
clustered appropriately. For example, assume we select some
initial settings for MinPts, ϵ, and α, and get the clustering
results as shown in Figure 5. Intuitively, cluster 11 and 15
should be two separate clusters. If the initial parameter setting
merges these two clusters, then the parameters need to be
tuned so that they are separated in the clustering results. In this
particular case, we should decrease ϵ and/or increase MinPts
to separate cluster 11 and 15. Note that ϵ is the radius of
neighborhood and MinPts is the threshold for determining if
a point p is a core point or a border point in a cluster. The
parameter α controls the number of output clusters. If the value
of α is too large, then the phase identiﬁcation accuracy will
be lower. However, if the value of α is too small, then a large
number of meters need to be ﬁeld validated, which increases
implementation costs. k, the parameter of the k-NN, can be
selected to be equal to MinPts. At last, in the ﬁeld validation,
choose the must-link group with at least w = 20 customers.
C. Performance of the Proposed Phase Identiﬁcation Algo-
rithm
The phase identiﬁcation accuracies of the CK-Means
method and the proposed phase identiﬁcation algorithm are
calculated based on ﬁeld validation results. For the proposed
algorithm, 30 runs of t-SNE are conducted. 10 runs with the
lowest cost function values are kept. The average accuracy
over the 10 runs are reported in Table II and Figure 4. As
shown in the table, the proposed phase identiﬁcation algorithm
signiﬁcantly outperforms the CK-Means method with all the
data sets in terms of accuracy. On average, the proposed phase
identiﬁcation algorithm improves the identiﬁcation accuracy
by 19.81% over the CK-Means algorithm. Figure 4 shows that
the improvement in phase identiﬁcation accuracy varies by the
unbalance level of the distribution circuit. The improvement
is more signiﬁcant for periods when the distribution feeder is
less unbalanced.
The combinations of phase connections in the 5 testing
feeders include 3 phase-to-neutral connections, 3 phase-to-
phase connections, and a mix of all 6 possible connections.
The accuracy of the proposed phase identiﬁcation algorithm is
very high under most cases. s13, s14, and s15 have relatively
lower accuracy, because they have lower levels of unbalance
and they have all 6 possible connections, which is more
difﬁcult to identify than other feeders. When the level of
unbalance is higher, the accuracy is greatly improved in s16,
s17, and s18, whose accuracies are very decent for a feeder
with all the 6 possible phase connections. Figure 5 illustrates
the clustering result of data set s18 in the 2-dimensional t-SNE
map, using the proposed phase identiﬁcation algorithm. In the
ﬁgure, each dot represents a smart meter. Figure 6 depicts the
actual phase connection of each smart meter. By comparing
TABLE II. PHASE IDENTIFICATION ACCURACIES
Feeder
Data
Level of
CK-Means
Proposed Algorithm
Set
Unbalance
Accuracy (%)
Accuracy (%)
1
s1
0.0785
81.21
93.06
s2
0.0776
81.18
93.62
2
s3
0.0514
69.67
87.55
s4
0.0617
57.51
87.79
3
s5
0.0956
54.91
83.94
s6
0.1019
72.78
82.83
4
s7
0.1109
89.29
98.60
s8
0.1141
97.82
98.94
s9
0.1131
97.79
99.63
s10
0.1190
88.42
99.66
s11
0.1043
87.49
99.88
s12
0.1250
88.34
99.65
5
s13
0.0673
29.80
73.18
s14
0.0668
38.80
73.32
s15
0.0705
59.07
67.01
s16
0.0742
40.56
88.19
s17
0.0846
60.49
87.11
s18
0.0842
52.02
89.84
21
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-588-3
GREEN 2017 : The Second International Conference on Green Communications, Computing and Technologies

Figure 4. The phase identiﬁcation accuracy with CK-Means and proposed
algorithm.
Figure 5 and Figure 6, it is shown that the proposed phase
identiﬁcation algorithm not only groups phase-to-phase meters
accurately, but also groups phase-to-neutral meters with a high
accuracy. Cluster 2, 11, 12, 13, and 15 each represents one
of the phase-to-neutral connections AN, BN, and CN, as
indicated by the arrows in Figure 5 and Figure 6.
As a comparison, Figure 7 shows the distribution of smart
meters from data set s18 in the 2-dimensional PCA map.
The data points are not well separated according to phase
connection. From Figure 7 and Figure 6, it is clear that the
nonlinear dimensionality reduction technique, t-SNE, does a
much better job in extracting hidden features from the voltage
time series during a less unbalanced period for the feeders.
As shown in Figure 5, the clusters are in different sizes and
shapes. Some of the clusters are non-convex. The proposed
CHC algorithm has a great advantage in identifying clusters
with such data point distributions. Figure 5 also shows how the
must-link constraints could improve the phase identiﬁcation
Figure 5. The clustering result in the 2-dimensional t-SNE map on data set
s18.
Figure 6. Field validated phase connections of data set s18 in the
2-dimensional t-SNE map.
accuracy. In the top right cluster 8, a few data points are
linked together. Although a small number of the data points
are located in cluster 14, they will eventually be assigned to
cluster 8 due to the must-link constraint. From Figure 6, these
data points should belong to cluster 8, which is connected to
phase CA instead of phase AB.
D. Impact of the Smart Meter Sampling Frequency on the
Phase Identiﬁcation Accuracy
The phase identiﬁcation accuracies of the proposed algo-
rithm under 3 different meter reading granularity levels are
calculated and summarized in Table III. It shows that as the
granularity of meter readings increases from hourly to every 15
minutes and then 5 minutes, the phase identiﬁcation accuracy
increases. The average increase in the phase identiﬁcation ac-
curacy over the 3 distribution circuits is 3.36% when the meter
reading granularity increases from hourly to 5 minutes. More
granular voltage readings allow extractions of features/patterns
Figure 7. Field validated phase connections of data set s18 in the
2-dimensional PCA map.
22
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-588-3
GREEN 2017 : The Second International Conference on Green Communications, Computing and Technologies

TABLE III. IMPACT OF SAMPLING FREQUENCY ON THE PHASE
IDENTIFICATION ACCURACY
Feeder
Data
Granularity of Meter Readings
Set
1 hour
15-minute
5-minute
1
s1
93.06%
93.93%
93.88%
s2
93.62%
94.32%
94.40%
2
s3
87.55%
88.86%
92.03%
s4
87.79%
90.47%
89.93%
3
s5
83.94%
90.02%
91.56%
s6
82.83%
84.51%
87.16%
that may not be present in coarse data sets. However, it
should be noted that there are additional costs associated with
gathering more granular smart meter data. Note that the phase
identiﬁcation accuracy decreases slightly for data set s1 and
s4 when the sampling frequency increases from 15-minute to
5-minute. This is partly due to the randomness of the t-SNE
mapping.
V. CONCLUSION
This paper develops an AMI data driven phase identiﬁcation
algorithm that addresses the drawbacks of the existing solu-
tions. Compared to the existing solutions, the proposed algo-
rithm has three main advantages. First, the proposed algorithm
does not require prior knowledge about the number of phase
connections in the distribution system. Second, the proposed
algorithm works well with distribution feeders that have both
phase-to-neutral and phase-to-phase connections. Third, the
accuracy of the proposed phase identiﬁcation algorithm is not
very sensitive to the level of unbalance in a distribution feeder.
Comprehensive ﬁeld testing results on 5 distribution feeders
show that the proposed algorithm signiﬁcantly outperforms
the existing methods. In addition, we discover that more
granular voltage time series leads to higher phase identiﬁcation
accuracy.
In the proposed CHC algorithm, a few parameters need to be
tuned manually. To implement the proposed AMI data driven
phase identiﬁcation algorithm on thousands of distribution
feeders, we plan to develop an automatic parameter tuning
algorithm.
ACKNOWLEDGMENT
The authors would like to thank Austen D’Lima, Joshua
Davis, and Tom Martin from Southern California Edison and
the Paciﬁc Gas and Electric Company for fruitful discussions
and supplying AMI, network connectivity, and ﬁeld validation
data.
REFERENCES
[1] A. Gupta and B. Kellison, “Utility AMI analytics at the grid edge:
Strategies, markets and forecasts,” GTM Research, Tech. Rep., 2016.
[2] W. Wang, N. Yu, B. Foggo, J. Davis, and J. Li, “Phase identiﬁcation
in electric power distribution systems by clustering of smart meter
data,” in Machine Learning and Applications (ICMLA), 2016 15th IEEE
International Conference on.
IEEE, Dec. 2016, pp. 259–265.
[3] L. A. Pomatto, “Apparatus and method for identifying the phase of a
three phase power line at a remote location,” Apr. 23 1996, US Patent
5,510,700.
[4] W. S. Bierer, “Long range phasing voltmeter,” Oct. 5 2010, US Patent
7,808,228.
[5] M. Dilek, “Integrated design of electrical distribution systems: Phase
balancing and phase prediction case studies,” Ph.D. dissertation, Virginia
Polytechnic Institute and State University, 2001.
[6] V. Arya et al., “Phase identiﬁcation in smart grids,” in Smart Grid Com-
munications (SmartGridComm), 2011 IEEE International Conference
on.
IEEE, Oct. 2011, pp. 25–30.
[7] T. A. Short, “Advanced metering for phase identiﬁcation, transformer
identiﬁcation, and secondary modeling,” IEEE Transactions on Smart
Grid, vol. 4, no. 2, pp. 651–658, Jun. 2013.
[8] W. Luan, J. Peng, M. Maras, J. Lo, and B. Harapnuk, “Smart meter
data analytics for distribution network connectivity veriﬁcation,” IEEE
Transactions on Smart Grid, vol. 6, no. 4, pp. 1964–1971, Jul. 2015.
[9] L. V. D. Maaten and G. Hinton, “Visualizing data using t-SNE,” Journal
of Machine Learning Research, vol. 9, pp. 2579–2605, Nov. 2008.
[10] J. W. Sammon, “A nonlinear mapping for data structure analysis,” IEEE
Transactions on Computers, vol. 100, no. 5, pp. 401–409, May 1969.
[11] P. Demartines and J. H´erault, “Curvilinear component analysis: A self-
organizing neural network for nonlinear mapping of data sets,” IEEE
Transactions on Neural Networks, vol. 8, no. 1, pp. 148–154, Jan. 1997.
[12] J. B. Tenenbaum, V. De Silva, and J. C. Langford, “A global geometric
framework for nonlinear dimensionality reduction,” Science, vol. 290,
no. 5500, pp. 2319–2323, Dec. 2000.
[13] G. E. Hinton and S. T. Roweis, “Stochastic neighbor embedding,” in
Advances in Neural Information Processing Systems, 2003, pp. 857–
864.
[14] E. Z. Macosko et al., “Highly parallel genome-wide expression proﬁling
of individual cells using nanoliter droplets,” Cell, vol. 161, no. 5, pp.
1202–1214, May 2015.
[15] A. Frome et al., “Devise: A deep visual-semantic embedding model,” in
Advances in Neural Information Processing Systems, 2013, pp. 2121–
2129.
[16] M. Ester, H.-P. Kriegel, J. Sander, and X. Xu, “A density-based algorithm
for discovering clusters in large spatial databases with noise.” in KDD,
vol. 96, no. 34, Aug. 1996, pp. 226–231.
[17] C. Ruiz, M. Spiliopoulou, and E. Menasalvas, “C-DBSCAN: Density-
based clustering with constraints,” in International Workshop on Rough
Sets, Fuzzy Sets, Data Mining, and Granular-Soft Computing. Springer,
May 2007, pp. 216–223.
23
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-588-3
GREEN 2017 : The Second International Conference on Green Communications, Computing and Technologies

