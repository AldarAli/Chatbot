Inter-Operator Trafﬁc Differentiation based on Multiscale Analysis
Nelson Coelho, Paulo Salvador, Ant´onio Nogueira
DETI, University of Aveiro/Instituto de Telecommunicac¸˜oes
Aveiro, Portugal
email: {nelsonmiguel, salvador, nogueira}@ua.pt
Abstract—Web 2.0 changed the interaction paradigm of
Internet users, placing them in a more active role as both
producers and consumers of digital contents. This concept has
also triggered the appearance of social networks and cloud
computing services, which have an increasing contribution to the
total trafﬁc amount. The increasing Internet complexity brings
new challenges to network operators and managers, which need
to understand new applications and know the exact properties
of the generated trafﬁc. The ability to accurately map trafﬁc
patterns to their corresponding application can be used to build
efﬁcient trafﬁc and user proﬁles, which can be extremely helpful
in several critical tasks like network resources optimization,
service differentiation and personalization, network management
and security. This paper proposes a classiﬁcation approach
that is able to accurately differentiate trafﬁc ﬂows in a core
network and associate them with their underlying applications,
allowing the construction of accurate trafﬁc and user proﬁles. By
performing a wavelet decomposition and analyzing the obtained
scalograms, the captured trafﬁc can be fully characterized in
terms of its time and frequency components. As the different
frequency components of the trafﬁc are inferred, an appropriate
communication proﬁle characteristic of each application type
can be deﬁned. This way, it is possible to identify the distinct
applications that are being used by the different connected
clients and build useful user proﬁles.
Keywords - trafﬁc identiﬁcation; proﬁling; multi-scale analysis;
wavelet transform.
I. INTRODUCTION
The ability to accurately build efﬁcient trafﬁc and user proﬁles
has a crucial importance in many network operation and
management tasks; it can be used to infer the most appropriate
bandwidth and delay requirements for each user or group
of users, allowing and optimized distribution of the network
resources and improving the values of the Quality of Service
(QoS) parameters; it will allow network managers to easily
create groups of users requesting similar contents, easing
the delivery of appropriate and related contents and services;
security standards can be improved because it will allow the
detection of users presenting illicit proﬁles or proﬁles includ-
ing unknown applications, triggering alarms and providing
counter-actions while allowing the remaining connected clients
to experience better QoS levels.
This paper proposes a methodology for the creation of
trafﬁc proﬁles based on the classiﬁcation of collected trafﬁc
ﬂows, that is, based on their mapping to the corresponding
generating applications. The proposed classiﬁcation approach
performs a wavelet decomposition at several scales of analysis;
it is known that lower scales comprise low frequency events,
which are typically created by user clicks and applications
synchronization events; mid-range frequency components are
related to the creation of Internet sessions; higher scales
of analysis capture higher-frequency events, such as packet
arrivals and packet bursts. So, by decomposing the trafﬁc
generated by different clients running diverse applications and
analyzing it at various time scales, the methodology will be
able to build a multi-scale application proﬁle depicting the
different frequency components that are characteristic of the
mostly used applications.
Figure 1 represents the generic architecture of a trafﬁc
classiﬁcation system with QoS support. Aggregated trafﬁc
is monitored by several network probes, which collect the
necessary trafﬁc ﬂows at representative time periods. Using
wavelet transforms, the most relevant components of the trafﬁc
ﬂows are extracted, resulting in scalograms that are used to
build accurate proﬁles for each one of the Internet applications
whose trafﬁc belongs to the aggregate. The proﬁles of the
different applications are stored in a Proﬁles Database, which
at bootstrap, only contains known proﬁles created in controlled
environments or classiﬁed using deep-packet inspection (these
are known as training traces). While capturing and classifying
trafﬁc, the different trafﬁc proﬁles can be updated with the
newly inferred proﬁles, after a validation process that may
include payload inspection or human validation. The classiﬁer
associates the captured trafﬁc to different service classes, char-
acterized by several QoS parameters. All inferred/calculated
data will also feed the User Proﬁling module, which is
responsible for updating the different user proﬁles.
The efﬁciency of the proposed trafﬁc classiﬁcation method-
ology will be evaluated by applying it to aggregated inter-
operator trafﬁc, captured in the backbone network of a tier 1
Internet Service Provider (ISP). The results obtained show that
the approach is efﬁcient, being able to accurately differentiate
Internet applications and, thus, having the potential to be the
key component of a trafﬁc and user proﬁling architecture.
The rest of the paper is organized as follows: Section II
presents some of the most relevant related work on traf-
ﬁc classiﬁcation and proﬁling; Section III provides some
background on multi-scale analysis; Section IV describes the
proposed classiﬁcation methodology; Section V presents the
trafﬁc traces that are used to test the proposed methodology;
Section VI presents and discusses the main results obtained
and, ﬁnally, Section VII presents the main conclusions.
II. BACKGROUND ON TRAFFIC CLASSIFICATION AND
PROFILING
Trafﬁc classiﬁcation efforts started by simple port-based iden-
tiﬁcation approaches, where ports used by the different trafﬁc
1
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

Fig. 1.
Architecture of a trafﬁc classiﬁcation and user proﬁling system with
QoS support.
ﬂows were exclusively used to identify the applications that
generated them. Since many protocols started to use random
port numbers or ports generally associated to other protocols
for bypassing ﬁrewalls and proxies, port-based approaches
could no longer provide an accurate identiﬁcation of Internet
trafﬁc [1].
Payload-inspection appeared as an evolutionary solution,
inspecting the payload of captured packets in order to search
for application level signatures of known applications. This
approach relies on the use of extensive databases, containing
known signatures and patterns of many Internet protocols,
which are used as a comparison term whenever any new
captured trafﬁc has to be classiﬁed. This methodology was able
to achieve good classiﬁcation results, being used by several of
the currently available commercial products [2] [3]. However,
the databases associated to the classiﬁcation approach need
to be constantly updated in order to comply with new and
emerging protocols. Besides, legal restrictions prevent Internet
Service Providers from analyzing the contents of the users
packets [4], while technical issues such as scalability on
high-speed links also prevent researchers and Internet Service
Providers from using payload inspection approaches.
Statistical analysis of the trafﬁc ﬂows appeared as the so-
lution that could overcome these restrictions [5]. Moore et al.
[6] proposed several ﬂow discriminators and machine learning
techniques to select the best discriminators for classifying
ﬂows. Hu et al. [7] built behavioral proﬁles describing domi-
nant patterns of the studied applications and the classiﬁcation
results obtained showed that the approach was quite promising.
In Huang et al. [8], authors attempted to describe negotiation
behaviors by capturing trafﬁc discriminators available at early
negotiation stages of network ﬂows and several machine learn-
ing algorithms were deployed to assess the classiﬁcation accu-
racy. This way, they were able to conclude that the approach
was suitable for real-time application identiﬁcation. In a recent
work [9], multi-dimensional probabilistic approaches were
used to model the multi-scale trafﬁc patterns generated by
several Internet applications and to match the analyzed trafﬁc
to its generating application(s). However, these techniques can
not efﬁciently differentiate between similar web-applications
in scenarios where there is no access to layer 3 (and above)
information and payloads. Hybrid classiﬁcation approaches
have also been used: in Tavallaee et al. [10], for example, a
two-level hybrid approach in which payload analysis is com-
bined with machine-learning algorithms was used to classify
unknown trafﬁc based on its statistical features.
There are several deﬁnitions of user proﬁle [11], but a
common deﬁnition can state that an user proﬁle consists of
a description of the user interests, behaviors and preferences.
Therefore, the process of creating an user proﬁle can be seen
as the process of gathering the appropriate information until
all these characteristics are obtained. In Claffy et al. [12], a pa-
rameterizable methodology for proﬁling Internet trafﬁc ﬂows
at different granularities was proposed. Flows were deﬁned
based on trafﬁc satisfying various temporal and spatial locality
conditions, as observed at internal points of the network
instead of only end-point deﬁnitions. In Xu et al. [13], a real-
time behavior proﬁling system for high-speed Internet links
was proposed, using ﬂow-level information from continuous
packet or ﬂow monitoring systems and relying on data mining
and information-theoretic techniques to automatically discover
signiﬁcant events based on the communication patterns of end-
hosts. Reverse Domain Name System lookups, which are used
to determine the domain name associated with an Internet
Protocol (IP) address, have also been used to provide a simple
association between a domain and the services it is known to
run. A similar work was carried out in Trestian et al. [14],
where authors stated that all information needed to proﬁle any
Internet endpoint is available in the Internet itself: therefore,
accurate proﬁles were built by simply querying the most
used search engine (Google) and dividing the querying results
into several tags describing the requested services. However,
inspection techniques can not be applied in scenarios where
layer 3 and layer 4 information is not available, such as
networks where authentication and encryption mechanisms are
deployed.
III. MULTI-SCALE ANALYSIS
The use of a wavelet decomposition through the Continuous
Wavelet Transform (CWT) allows the analysis of any process
in both time and frequency domains, being widely used in
many different ﬁelds such as image analysis, data compression
and trafﬁc analysis. The CWT of a process x(t) can be deﬁned
as [15]:
Ψψ
x (τ, s) =
1
p
|s|
Z −∞
+∞
x(t)ψ∗(t − τ
s
)dt
(1)
where ∗ denotes the complex conjugation,
1
√
|s| is used as an
energy preservation factor, ψ(t) is the mother wavelet, while τ
and s are the translation and scale parameters, respectively. By
varying these parameters, a multi-scale analysis of the entire
captured process can be performed, providing a description of
the different frequency components present in the decomposed
process together with the time-intervals where each one of
those components is located.
2
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

The wavelet scalogram can be deﬁned as the normalized
energy ˆEx(τ, s) over all possible translations (set T) in all
analyzed scales (set S), and is computed as:
ˆEx(τ, s) = 100
Ψψ
x (τ, s)
2
P
τ ′∈T
P
s′∈S
Ψψ
x (τ ′, s′)

2
(2)
The volume bounded by the surface of the scalogram is
the mean square value of the process. The analysis of these
scalograms enables the discovery of the different frequency
components, for each scale (frequency) of analysis. Assuming
that the process x(t) is stationary over time, several statistical
metrics can be obtained, such as the standard deviation:
σx,s =
s
1
|T|
X
τ∈T
( ˆEx(τ, s) − µx,s), ∀s ∈ S
(3)
where µx,s =
1
|T|
P
τ∈T ˆEx(τ, s), and |T| denotes the cardi-
nality of set T.
IV. CLASSIFICATION METHODOLOGY
By deﬁning characteristic regions of the scalogram statistics,
for the different applications, in different frequency sub-
sets, it is possible to identify proﬁles presenting components
characteristic to each one of the applications. Such regions are
inferred from the scalograms obtained from the decomposition
of the training traces of each web-application.
Let us consider the (positive) region R+
a as the region
deﬁned as a function of a frequencies (positive) sub-set s+
a
and energy variation (positive) sub-set Σ+
a
for which we
always have the characteristic statistical values of application
a. Moreover, let us deﬁne the (negative) region R−
a as a
function of a frequencies (negative) sub-set s−
a and energy
variation (negative) sub-set Σ−
a
for which we never have
characteristic statistical values of application a.
R+
a = f(s+
a , Σ+
a )
(4)
R−
a = f(s−
a , Σ+
a )
(5)
A trafﬁc trace process x(t) is classiﬁed as belonging to
application a if for all scales belonging to sub-set s+
a the
energy standard deviation σx,s belongs to region R+
a and,
simultaneously, for all scales belonging to sub-set s−
a the
energy standard deviation σx,s does not belong to region R−
a :
C(x) = a ⇐ ∀s ∈ s+
a , σx,s ∈ R+
a ∧ ∀s ∈ s−
a , σx,s /∈ R−
a (6)
The classiﬁcation decision can be made as soon as all condi-
tions are met. Note that, even if time T grows and allows more
classiﬁcation precision, decisions can nevertheless be made
with small T sub-sets (short-time analysis and decision).
The
inference
of
regions
R+
a
and
R−
a
(deﬁned
by
s+
a , Σ+
a , s−
a , Σ−
a ) can be performed by solving the following
optimization problem:
max
s+
a ,Σ+
a ,s−
a ,Σ−
a



X
∀i∈Ia
C(i) == a


 ∧
min
s+
a ,Σ+
a ,s−
a ,Σ−
a



X
∀i/
∈Ia
C(i) == a


 , ∀a (7)
where == represents a comparison function witch outputs
1 if both terms are equal and 0 if terms are different. Ia
represents the subset of processes (known as) belonging to
web-application a. This optimization problem was solved (not
for the optimal solution) using exhaustive search. However,
more advanced algorithms can be applied to ﬁnd (sub)optimal
solutions.
Several regions can be created, in the various frequency sub-
sets, for each studied application a. The higher the number of
regions of an application, the higher the ability to analyze the
different frequency components and consequently, a more ac-
curate trafﬁc mapping can be achieved. An algorithm was used
to automatically deﬁne such regions (obviously satisfying the
above conditions) using known simple geometrical equations,
such as ellipses.
V. TRAFFIC TRACES
The trafﬁc traces used in the evaluation tests were obtained
from the Cooperative Association for Internet Data Analysis
(CAIDA) [16]. Traces of this repository have one hour dura-
tion and were collected every month in each one of the passive
monitors managed by the organization [17]. Speciﬁcally, the
datasets used in this paper were collected on July 21, 2011,
after 12:59 PM, at the Equinix data center, located in Chicago,
Illinois, which is connected to the backbone line of a level 1
ISP between Chicago and Seattle, Washington. The connection
is bidirectional, so traces contain packets circulating in both
directions. After data collection, CAIDA proceeded to data
anonymization due to legal and privacy requirements [16].
Captures are divided into several ”.cap” ﬁles whose duration
varies between ﬁfty and ﬁfty nine seconds. In our evaluation
studies, we have considered the trafﬁc traces corresponding
to the ﬁrst ﬁve minutes, in both directions. Trafﬁc ﬂows
are identiﬁed by the traditional 5-tuple deﬁnition (source IP
address, destination IP address, source port, destination port
and protocol). Note that both cities are located on different
time zones, which helps explaining the differences observed
on the trafﬁc ﬂows in both directions. All tests were made
on a desktop computer equipped with an Intel Core i5 CPU
650 @ 3.20GHz x 4 processor and running the Ubuntu 12.04
LTS operating system. Tshark and wireshark [18] were used
to calculate the relevant statistics of the trafﬁc traces.
The following applications, all contributing to relevant
percentages of current Internet trafﬁc, were considered in
this study: Hypertext Transfer Protocol (HTTP), Simple Mail
Transfer Protocol (SMTP), Real Time Streaming Protocol
(RTSP), Mobile Status Notiﬁcation Protocol (MSNP) and
XBOX Live. For each service, four contexts were analyzed:
downstream and upstream trafﬁc on the client side, down-
stream and upstream trafﬁc on the server side. However,
due to space restrictions, we will only present here results
corresponding to the client side, although a similar analysis
also applies to the other scenarios.
VI. EVALUATION RESULTS
As an illustrative example (similar plots were also made for all
the other applications), Figure 2 shows the trafﬁc volume over
3
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

Fig. 2.
HTTP downstream (from the client side) trafﬁc: (up) trafﬁc volume
over time; (bottom) scalogram.
time and the scalogram corresponding to HTTP downstream
trafﬁc. In this case, trafﬁc peaks have low frequency, low
amplitude and are not periodic, which indicates that this user
is performing typical browsing. The corresponding scalogram
exhibits visible frequency components at the beginning of the
temporal scales range. Note, however, that HTTP trafﬁc ﬂows
corresponding mainly to video downloads or ﬁle sharing have
signiﬁcantly different behaviors, so HTTP trafﬁc presents a
high diversity of patterns due to the wide spectrum of services
that run on top of this protocol. This diversity is visible when
analyzing ﬂows from all the different HTTP usage proﬁles.
Figure 3 represents the energy standard deviation of differ-
ent HTTP downstream trafﬁc ﬂows. Several regions can be
identiﬁed, corresponding to different types of human and/or
network events. Region A includes events having low fre-
quency and moderate energy variation, usually generated by
user clicks when accessing to online news, browsing photos
and using social networks. Region B includes low frequency
events with small energy variation, typical of the visualization
of online video sites. Region C contains two ﬂows (8 and
11) including medium frequency events with high energy
variation, related to the creation of a high number of Transport
Control Protocol (TCP) and HTTP sessions. Region D involves
medium frequency events with a slower energy variation.
Events included in region E have a very small energy variation,
that is, a low number of TCP and HTTP sessions, typical
of social networks applications (ﬂows 10 and 14). Region F
includes events with small and moderate energy variations, so
ﬂows located in this region have a moderate number of high
frequency events, corresponding to the arrival of a reasonable
number of packets. Finally, region G exhibits high frequency
components with a very reduced energy variation, so ﬂows
10 and 14 (which are located in this region) are generated
by applications that are responsible for a reduced number of
packets, like for example photo sharing or email clients.
In Figure 4, a single region is able to include all low
frequency ﬂows. The energy variation of these ﬂows is small,
Fig. 3.
Energy standard deviation of different HTTP downstream trafﬁc
ﬂows.
indicating that they were generated by infrequent user clicks.
In the medium frequencies range, we can ﬁnd two ﬂows (10
and 12), responsible for events with some energy variation (re-
gion B); region C includes the remaining ﬂows, characterized
by a small number of created sessions, which is responsible
for their reduced energy variation. These characteristics are
usually related to social networks applications and visualiza-
tion of photos and videos. In the high frequency segment,
two distinct regions can be identiﬁed: region D contains a
ﬂow (ﬂow 12) characterized by a considerable percentage of
high frequency events, which is a clear sign that this ﬂow
is responsible for signiﬁcant upstream trafﬁc originated at
this client; region E incorporates the remaining ﬂows and is
characterized by events with high frequency components but
with a reduced energy variation (much smaller when compared
to region D), which corresponds to a reduced upstream packet
rate characteristic of scenarios where users are not browsing in
a very active way (which can correspond to video visualization
scenarios, reading speciﬁc emails or reading news feeds on
social networks’ sites).
Figure 5 represents the energy standard deviation of dif-
ferent SMTP downstream trafﬁc ﬂows. In this case, most of
the trafﬁc ﬂows have a similar behavior, being included in
three different frequency regions: B, D and F. These ﬂows
have a small percentage of frequency components for all
scales, which is associated to a low number of user clicks,
few TCP sessions that were opened and a reduced number of
packets that were exchanged. These results are according to the
expected behavior of the client download trafﬁc associated to
SMTP. However, there are some ﬂows diverging from this pat-
tern. In region A (ﬂows 2, 7, 11, 15 and 18) it is possible to ﬁnd
low frequency events with moderate energy variation, which
implies more user clicks when comparing to ﬂows located
in region B. Region C (ﬂows 7, 11, 15 and 18) incorporates
medium frequency events with moderate energy variation; so,
these ﬂows have more HTTP and TCP interactions when
compared to ﬂows from region D. Finally, region E contains
4
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

Fig. 4.
Energy standard deviation of different HTTP upstream trafﬁc ﬂows.
Fig. 5.
Energy standard deviation of different SMTP downstream trafﬁc
ﬂows.
a single ﬂow (ﬂow 10) with a very high energy variation,
indicating that this ﬂow corresponds to sending one or two
large volume emails due to the high number of packets that
were detected.
Figure 6, which represents the energy standard deviation
of different SMTP upstream trafﬁc ﬂows, shows two regions
in the low frequencies segment: region A includes very low
frequency events, generated by the initial download of the
email application interface and by the subsequent automatic
synchronizations of the client email box. Region B corre-
sponds to situations where, besides these events, the client
performs other operations in his email interface, like sending
emails to other contacts. Region C includes all trafﬁc ﬂows
in the medium frequencies segment, having small to moderate
energy variation, which correspond to the establishment of
some TCP sessions during the analyzed time period. Finally,
in the high frequencies segment two regions can be identiﬁed:
region D, with a signiﬁcant percentage of high frequency
Fig. 6.
Energy standard deviation of different SMTP upstream trafﬁc ﬂows.
components, and region E with a reduced percentage of high
frequency components. Thus, region D is associated to events
generated by sending large quantities of packets from the
client to the server (specially, large emails), while region E
is associated to situations where the client activity is more
reduced and the packet exchange is only limited to control
and synchronization data between the interface of the email
application and the SMTP server.
Figure 7 represents the energy standard deviation of differ-
ent RTSP downstream trafﬁc ﬂows. It is possible to verify the
existence of several trafﬁc ﬂows corresponding to very low fre-
quency events with high energy variation, which are generated
by events such as automatic and periodic data synchronizations
from the server and responses to clicks that were made by
the client itself. Region B involves low frequency events with
considerable energy variation, usually associated to requests
for new contents; in the speciﬁc case of this protocol, this can
correspond to the choice of new streams to visualize. In the
medium frequencies segment, trafﬁc ﬂows are divided in two
regions: region C includes ﬂows with a considerable energy
variation, which are obviously related to TCP and RTSP
interactions; in fact, energy variations having this kind of
amplitude should be related to client requests for establishing
TCP and RTSP sessions dedicated to visualize streams. Region
F includes high frequency events with a reduced percentage
of high frequency components: the existence of few events
in this region can be attributed to the reduced downstream
packet transmission rate, which is quite unusual if streaming
transmissions work as expected. So, we can assume that in
this case the stream content was transmitted for a small period
of time or some problems have occurred in the transmission
while trying to visualize speciﬁc contents. Regarding region
E, detected events have a considerable energy variation, which
proves that the downstream packet transmission for these ﬂows
is higher than the one corresponding to ﬂows of region F.
Note that ﬂows 8 and 9 have irregular peaks on the standard
deviation of the normalized energy, specially in some speciﬁc
intervals: region A, medium frequencies segment an very high
5
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

Fig. 7. Energy standard deviation of different RTSP downstream trafﬁc ﬂows.
frequencies segment. This irregularity in the energy pattern can
be explained by the ﬂuctuations on the packet transmission rate
of video streaming applications: there are periods with high
packet transmission rates (video is immediately processed and
displayed), followed by periods where transmission rates are
lower, resulting in some video freezing occurrences.
Figure 8 represents the energy standard deviation of dif-
ferent RTSP upstream trafﬁc ﬂows. Region A corresponds to
very low frequency events, generated by rare occurrences: this
should correspond to a very low number of client solicitations
that are sent to the server or to the exchange of very small
size packets. The medium frequencies segment contains two
regions (B and C), although region B only contains one
ﬂow. This ﬂow consists of events presenting energy variations
higher than those corresponding to events from region C, so
for this speciﬁc trafﬁc ﬂow there are more TCP and RTSP
interactions and more TCP sessions established upon client
request. We can assume that the client is trying to access
various streams (in order to select the one that presents the
highest quality) or is forced to update his browser because
the quality of the connection/visualization is not as good as
it should be. Regarding the high frequencies segment, we can
observe that most of the analyzed trafﬁc ﬂows are located
in region E and have small energy variation. The three ﬂows
located in region D correspond to events having higher energy
variation than the one corresponding to events associated to
region E, which means that there is a higher upstream packet
transmission rate. Note that ﬂows 3 and 9 have an irregular
shape in the medium and very high frequencies segments,
probably due to the instability of the connection between client
and server.
Figure 9 represents the energy standard deviation of differ-
ent MSNP downstream trafﬁc ﬂows. In the low frequencies
segment, there is only one region, region A, including all
trafﬁc ﬂows. Events corresponding to this region have a very
low frequency, typically presenting a periodic pattern that
makes sense if the time intervals between writing and reading
messages is similar. In the medium frequencies segment,
Fig. 8.
Energy standard deviation of different RTSP upstream trafﬁc ﬂows.
all ﬂows (except ﬂow 4) belong to region C and present
a small energy variation because sending text messages to
other online users creates a small number of sessions and
few User Datagram Protocol (UDP) and MSNP interactions.
Flow 4 stands out from the others because its events show a
considerable energy variation. This can be explained by the
fact that this MSNP user is talking at the same time as other
online users, resulting in a higher number of MSNP and UDP
interactions. In the high frequencies segment, we can see that
most of the analyzed ﬂows belong to region E and present
a reduced packet arrival rate, which is expected if we take
into account that text messages that are usually sent by this
application require small packet sizes. Flows 4 and 7 do not
follow this rule, being located at region D, where the energy
variation of the generated events is slightly higher than the
one corresponding to ﬂows from region E because the packet
arrival rate itself is higher. This again can be explained by the
fact that this MSN client has established new conversations
with other users.
Figure 10 represents the energy standard deviation of dif-
ferent MSNP upstream trafﬁc ﬂows. Flows located in region
A present the same behavior of the corresponding ﬂows repre-
sented in region A of Figure 9, although in that case packets
were originated at the server while now they are originated
at the client. The medium frequencies segment is divided in
two regions: region C includes trafﬁc ﬂows with small energy
variation, while region B includes ﬂows with moderate energy
variation, corresponding to more MSNP and UDP interactions,
that is, in these ﬂows the client interacts with more users of
the same application. In the high frequencies segment, we can
see that all ﬂows (except ﬂow 10) are located in region E.
Here, packet transmission rates are usually small, suggesting
that the client interacts with few users of the same application.
Regarding region D, it only contains ﬂow 10: events associated
to this ﬂow generate a quite reasonable packet transmission
rate from the client, meaning that this particular client interacts
with others in a very active way.
Figure 11 represents the energy standard deviation of dif-
6
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

Fig. 9.
Energy standard deviation of different MSNP downstream trafﬁc
ﬂows.
Fig. 10.
Energy standard deviation of different MSNP upstream trafﬁc ﬂows.
ferent XBOX downstream trafﬁc ﬂows. There are two regions
in the low frequencies segment: regions A and B. The ﬁrst
one includes very low frequency events, which rarely happen,
such as the user activity in the XBOX Live service interface or
automatic synchronizations between the remote server and the
client terminal in order to assure an appropriate quality level
for the connection. Region B includes low frequency events
with small energy variation amplitude. Region C is located
in the medium frequencies segment and includes all trafﬁc
ﬂows because for this application energy variation does not
differ signiﬁcantly from one ﬂow to another. The low value of
energy variation indicates that few UDP sessions are created
while the client is playing. In the high frequencies segment,
three regions can be identiﬁed: region F, where the packet
rate is very low; region E, where the packet rate is higher and
region D where the packet reception rate is quite high (ﬂows 4,
8, 9 and 18). It is possible to assume that ﬂows of region D are
associated to games where the user has a more active role, like
Fig. 11.
Energy standard deviation of different XBOX downstream trafﬁc
ﬂows.
Fig. 12.
Energy standard deviation of different XBOX upstream trafﬁc ﬂows.
personalized action games, sports or adventure games. Flows
of region E can be associated to question/answer or to strategy
games.
Finally, Figure 12 represents the energy standard deviation
of different XBOX upstream trafﬁc ﬂows. Region E includes
two ﬂows (1 and 6) with high energy variation and high
packet transmission rate between client and server, possibly
corresponding to scenarios where the XBOX user is making
a lot of clicks or playing a game that requires a high activity
level. Region F, corresponding to a lower transmission rate,
can be associated to games where the user is not so active
and there are some inactivity periods between the different
user actions (like, for example, games of the question/answer
type).
From this discussion, we can conclude that a multi-
scale analysis based on the wavelet transform is able to
efﬁciently highlight the most important distinguishing fea-
tures/characteristics of each Internet application. By perform-
ing a wavelet decomposition of the trafﬁc ﬂows, the different
7
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

TABLE I
PERCENTAGE OF CORRECTLY CLASSIFIED FLOWS.
Application
Download
Upload
HTTP
90.2%
93.1%
SMTP
77.8%
74.9%
RTSP
84.5%
82.3%
MSNP
91.1%
89.7%
XBOX
84.2%
88.6%
time and frequency components can be identiﬁed from the
scalogram of the trafﬁc metrics, allowing an efﬁcient mapping
of the captured trafﬁc to the corresponding application.
Table I shows the classiﬁcation results obtained by applying
the previously discussed methodology. First of all, a set of
training ﬂows is used to deﬁne the elliptic areas that are
used to differentiate the most relevant characteristics of each
application; then, a set of testing ﬂows is classiﬁed based
on those areas in order to evaluate the efﬁciency of the
classiﬁcation approach. As can be seen, the classiﬁcation
results are quite good, with an identiﬁcation accuracy higher
than 70% for all cases. These classiﬁcation results correspond
to 50 runs and 95% conﬁdence intervals were also built: since
their widths are very small, they were omitted in the table.
VII. CONCLUSIONS
The complexity of current Internet forces network operators
and managers to understand the underlying mechanisms of
applications/services and the exact properties of the generated
trafﬁc. The ability to accurately map trafﬁc patterns to their
corresponding application can be used to build efﬁcient trafﬁc
and user proﬁles that can be very useful in several operational
and management tasks. This paper proposed a classiﬁcation
approach that is able to accurately differentiate trafﬁc ﬂows
in the core network of a tier 1 ISP and associate them
with their underlying applications. By performing a wavelet
decomposition and analyzing the obtained scalograms, the
captured trafﬁc can be fully characterized in terms of its time
and frequency components. This way, appropriate application
proﬁles can be built, allowing the identiﬁcation of all distinct
applications that are being used by the different connected
clients and the deﬁnition of useful user proﬁles.
REFERENCES
[1] A. Moore and K. Papagiannaki, “Toward the accurate identiﬁcation of
network applications,” Lecture Notes in Computer Science, vol. 3431,
2005, pp. 41–54.
[2] [retrieved:
June,
2013]
Snort
home
page.
[Online].
Available:
http://www.snort.org/
[3] [retrieved:
June,
2013]
Cisco
IOS
Intrusion
Prevention
System
(IPS)
-
Products
and
Services.
[Online].
Available:
http://www.cisco.com/en/US/products/ps6634/index.html
[4] F. McSherry and R. Mahajan, “Differentially-private network trace
analysis,” in Proceedings of ACM SIGCOMM, 2010, pp. 123–134.
[5] T. Nguyen and G. Armitage, “A survey of techniques for internet trafﬁc
classiﬁcation using machine learning,” IEEE Communications Surveys
Tutorials, vol. 10, 2008, no. 4, pp. 56–76.
[6] A. W. Moore and D. Zuev, “Internet trafﬁc classiﬁcation using bayesian
analysis techniques,” in Proceedings of ACM SIGMETRICS, 2005, pp.
50–60.
[7] Y. Hu, D.-M. Chiu, and J. Lui, “Application identiﬁcation based on
network behavioral proﬁles,” 16th International Workshop on Quality
of Service, 2008, pp. 219–228.
[8] N.-F. Huang, G.-Y. Jai, and H.-C. Chao, “Early identifying application
trafﬁc with application characteristics,” in IEEE International Conference
on Communications, May 2008, pp. 5788 –5792.
[9] E. Rocha, P. Salvador, and A. Nogueira, “Detection of illicit network
activities based on multivariate gaussian ﬁtting of multi-scale trafﬁc
characteristics,” in IEEE International Conference on Communications,
Jun. 2011.
[10] M. Tavallaee, W. Lu, and A. Ghorbani, “Online classiﬁcation of network
ﬂows,” in Seventh Annual Communication Networks and Services
Research Conference, May 2009, pp. 78 –85.
[11] D. Godoy and A. Amandi, “User proﬁling in personal information
agents: a survey,” Knowledge Engineering Review, vol. 20, Dec. 2005,
no. 4, pp. 329–361.
[12] K. Claffy, H. Braun, and G. Polyzos, “A parameterizable methodology
for internet trafﬁc ﬂow proﬁling,” IEEE Journal of Selected Areas in
Communications, vol. 13, Oct. 1995, no. 8, pp. 1481–1494.
[13] K. Xu, F. Wang, S. Bhattacharyya, and Z.-L. Zhang, “A real-time
network trafﬁc proﬁling system,” in 37th Annual IEEE/IFIP International
Conference on Dependable Systems and Networks, Jun. 2007, pp. 595
–605.
[14] I. Trestian, S. Ranjan, A. Kuzmanovic, and A. Nucci, “Googling the in-
ternet: proﬁling internet endpoints via the world wide web,” IEEE/ACM
Transactions on Networking, vol. 18, Apr. 2010, no. 2, pp. 666 –679.
[15] J. Slavic, I. Simonovski, and M. Boltezar, “Damping identiﬁcation using
a continuous wavelet transform: application to real data,” Journal of
Sound and Vibration, vol. 262, 2003, no. 2, pp. 291 – 307.
[16] [retrieved: June, 2013] Caida - The Cooperative Association for Internet
Data Analysis”. [Online]. Available: http://www.caida.org/home/
[17] M. Fomenkov and K. Claffy, “Internet measurement data management
challenges,” in Workshop on Research Data Lifecycle Management,
Princeton, NJ, Jul, 2011.
[18] [retrieved: June, 2013] Wireshark: go deep. [Online]. Available:
http://www.wireshark.org/
8
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

