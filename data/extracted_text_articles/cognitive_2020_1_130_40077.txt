 
 A Hybrid Model Applied to the Vehicles Routing Problem  
With Simultaneous Pickups and Deliveries – VRPSPD 
Pedro Pablo Ballesteros Silva 
 Facultad de Tecnología 
Universidad Tecnológica de Pereira - UTP 
Pereira, Colombia 
 e-mail: ppbs@utp.edu.co 
Diana Paola Ballesteros Riveros 
Centro de Comercio y Servicio 
Servicio Nacional de Aprendizaje - SENA 
Pereira, Colombia 
e-mail: dipballesteros@sena.edu.co 
Yanci Viviana Castro Bermudez 
Facultad de Ingeniería Industrial 
Universidad Tecnológica de Pereira - UTP 
Pereira, Colombia 
e-mail: yvcastro@utp.edu.co  
 
Abstract— Since many decades ago, one of the topics of 
greatest interest in research is that one related with the vehicle 
routing problem, present in many organizations. This, which is 
a transport problem, has multiple implications of economic, 
social, technological, and environmental order, when there is a 
provision of services to customers in the development and 
implementation of production processes, in the provisioning 
and distribution of goods and services, including carrying 
people within a determined time frame, with an adequate 
quality level.  This paper presents a methodology to solve the 
homogeneous vehicles routing problem with simultaneous 
pickups and deliveries (VRPSPD) using matheuristics formed 
by the specialized genetic algorithm's Chu-Beasley and exact 
techniques of mixed integer linear programming, based on the 
Branch-and-Bound 
procedure. 
The 
VRPSPD 
problem 
considers a set of customers, whose demands of pick-up and 
delivery of products or people are known, and whose objective 
is to get the set of routes of minimal cost, which permit to 
satisfy the demand of the customers, considering the respective 
constraints of the system and the vehicles necessary for the 
completion of the same. Two new algorithms designed by the 
authors are implemented, which have been coded in C ++, 
obtaining good results in relatively short computing times, 
depending on the characteristics of the computers used. 
Keywords-constructive heuristic; exact techniques; genetic 
algorithm's Chu-Beasley; matheuristics. 
I. 
INTRODUCTION  
The issue related with the vehicles routing problem 
(VRP) constitutes a set of possibilities, which range from 
simple situations to high complexity problems that are 
currently subject of important research. The solution of VRP 
in practical terms consists of the identification of a series of 
routes of a set of vehicles to provide service to customers in 
the 
best 
way 
possible, 
in 
the 
development 
and 
implementation of the distribution and provisioning 
processes. 
In its structure, the problem is oriented to the search of a 
set of optimal solutions, or solutions obtained through 
heuristics, metaheuristics or matheuristics, which are 
affected by diverse constraints related to the quantity of 
vehicles, their capacity, destination and demand sites, pick-
up and delivery times, duration of routes, use of multiple 
depots, fleets of vehicles, among others.  
The tours established in all the solutions start and finish 
in a depot, and the loading of the vehicles used is made up of 
the merchandise to be delivered and the merchandise which 
is simultaneously picked up from each customer, and in the 
combinatorial optimization, where many variables are 
considered with a good amount of parameters and the 
majority of their versions are of the NP-Hard class, as in 
their solving process the polynomial time is not worked.  
One of the first researches concerning the vehicles 
routing problem with simultaneous pick-up and delivery 
(VRPSPD) arises by the year 1989, with the work carried out 
by Min [15], who developed a heuristic of three stages for a 
case study of a distribution system for the Franklin county 
public library, Ohio, where an important saving in time and 
distance was achieved through the application of a 
mathematical model. 
The following is a list of the most important variants that 
this problem has presented from 1989 to 2019:      
 Routing problems of multiple vehicles with simultaneous 
pick-up and delivery [15].  
 Pick-up and delivery applying time windows [6].  
 Pick-up and delivery systems [18]. 
 Routing problems with simple and multiple vehicles with 
simultaneous pick-up and delivery [12]. 
 Routing problems of multiple vehicles with pick-ups 
fractioning [13]. 
 Pick-up and delivery applying time windows and waiting 
times [7]. 
 Routing problems of a single vehicle with selective pick-
up and delivery [11]. 
74
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

 Routing problems of multiple vehicles with load 
fractioning for pick up and deliveries [17]. 
 Routing problems of a single vehicle with pick-up and 
delivery based on customer satisfaction [8]. 
 Vehicle routing problem with load fractioning for pick up 
and deliveries, applying time windows [1]. 
 Flexible pick-up and delivery, applying time windows [23]  
 Vehicles routing problems with pick-up and delivery 
VRPPD applying transport routes VRPPDSR [14]. 
 Multiproduct inventory routing problem with transfer option 
and green approach IRP [25]. 
 VRP with pick-up and delivery and transfer problem PDPT 
[26]. 
 VRP with pick-up and delivery, time windows and 
contamination TWPDPRP [27]. 
 Oil routing and programming problems with fractioned 
pick-up and delivery GPDP [28]. 
 VRP with synchronized pick-up and delivery SPD [29]. 
 VRP with pick-up and delivery with full loads FTPDP 
[30]. 
 VRP with simultaneous pick-up and delivery with 
constrained time [31]. 
 VRP with pick-up and delivery, time windows and multiple 
products stacks PDPTWMS [32]. 
 VRP with simultaneous pick-up and delivery and bi-
dimensional loading constrains VRP2LSPD [33]. 
 Traveling Salesman problem with multi-product pick-up 
and delivery m-PDTSP [34].  
 VRP with pick-up and delivery, time Windows, benefits 
and reserve requests PDPTWPR [35].  
Other authors like [20] make a proposal of a general scheme 
of classification of the problems of delivery and pick up with 
their corresponding 
characteristics. The 
classification 
presents three groups: 
 
The first group is formed by the graph “many to 
many problems”, where any vertex can be used as a source 
or as a destination. Its structure is similar to that of the 
Vehicle Routing Problem with simultaneous pick-up and 
delivery VRPDPD.  
 The second group includes the problems of “one to many 
to one”. Its equivalent is the Mixed Vehicle Routing Problem 
(MVRP). It is inferred here that the customer requests 
exclusively one of the services.  
 The third group is formed by the one-to-one routing 
problems where each product is considered as a request 
coming from an origin and having a defined destination. An 
example of this case is the messenger operations and the 
door-to-door transport service.  
On the other hand, it should be kept in mind that the 
application of exact methods for the solution of VRPSPD has 
had difficulties concerning the use and consideration of 
many variables and restrictions [5] [24]. This situation is 
easily overcome with the use of matheuristics, getting good 
solutions, very close to optimal in relatively short computing 
times, depending on the characteristics of the computers 
used. 
Many of the applications of VRPSPD are found in the 
different processes of inverse logistics, where the enterprises 
should carry out activities of inverse flux management both 
for finished products and raw materials. Examples of these 
operations are found in the beer or soft drink’s bottling 
plants, when customers are visited to whom bottles full of 
the product are delivered and from whom empty bottles are 
picked up, guaranteeing the synchronization of deliveries and 
pick-ups, accomplishing the customer’s satisfaction, and 
getting the optimal route with the minimal impact in costs in 
the supply chain.  
Another application of the VRPSPD is observed in the 
transport of passengers when they are moved and picked up 
in different locations; in the home delivery service, where 
goods or documents are delivered and picked up, or where 
money is picked up; in data transmission and reception; in 
electric energy transmission and reception; in production 
systems when raw materials are delivered and finished or 
semi-finished products are picked up. It is important to 
consider that VRPSPD is also applied when new products 
are delivered and outdated or obsolete products are picked 
up, in order to give them an appropriate final deposition. 
In practice, these processes are carried out mostly in 
empirical form, incurring in high transportation costs, in 
strong environmental impact, and in a questionable level of 
service to the final customer. Therefore, the efforts leading to 
the improvement and scientific solution of this situation are 
another of the contributions and objectives of this work. 
In addition to the introduction, this article includes the 
following parts: 2. Description of the problem. 3. 
Formulation of the mathematical model. 4. Description of 
the implementation of the genetic algorithm of Chu-Beasley 
to solve the VRPSPD problem. 5. Experimental results of the 
matheuristics, where the genetic algorithm of Chu-Beasley 
and exact techniques for a depot, 50 clients and 4 vehicles 
are applied. 6. Analysis of sensibility of the genetic 
algorithm of Chu-Beasley, with variation of the size of the 
population. 7. Conclusions, with a final relationship of the 
consulted references. 
II. 
 DESCRIPTION OF THE PROBLEM 
The Vehicle Routing Problem Pickup and Delivery 
(VRPPD) has been considered as an extension of the Vehicle 
Routing Problem -VRP), where each vehicle that visits each 
customer only once.  
Once on the road, one must not only deliver, but also 
pickup certain products with a 100% service level (Full 
service). Vehicles of the project considers several scenarios: 
a depot, a vehicle and several clients; a depot, several 
vehicles and many clients; several depots, several vehicles 
and must exit and arrive at a depot or distribution center.  
The scope many clients incorporating environmental 
effects in this last variant. In practical terms, it consists of 
identifying a series of routes for a set of vehicles to provide 
75
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

delivery and pickup services to customers in the most 
appropriate way possible, in the development and execution 
of the supply and distribution processes. 
 
The VRPSPD problem claims towards the search for a 
set of optimal solutions, or solutions obtained through 
heuristics (a procedure based on rules developed to 
determine a good quality solution to a specific problem), 
which are affected by different restrictions related to the 
number of vehicles, their capacity, places of destination and 
demand, delivery and pickup times, duration of the route, use 
of multiple depots, mixed vehicle fleet, among others. 
 
The situations dealing with the pick-up and delivery of 
goods or people who must be transported between one origin 
and a destination, constitute a sort of vehicle routing 
problem, which must fulfill certain constrain of capability. 
Starting from the bibliographical revision made for this type 
of problem, it was found that there are three important 
groups, the description of which is presented below: 
 
 Vehicle Routing Problem with Backhauls VRPBH. The 
situation outlined points out first to attend customers to 
whom merchandise is delivered and then from whom it is 
picked up [7].  
 Mixed Vehicle Routing Problem MVRP. In this case, the 
customers require exclusively one of the services [15].  
 Vehicle Routing Problem with Simultaneous Pickup and 
Delivery – VRPSPD. Here, the customers need the two 
services: deliver and pick up the merchandise or personnel, 
with a 100% service level, using one vehicle in one visit [2] 
[3] [24] [4]. 
 
In this work, we focus on this last group, where a deposit 
is considered: two sets, one of homogeneous capacity 
vehicles and another of customers whose delivery and 
pickup 
demands of merchandise or people must be attended 
simultaneously, with a 100% service level. The objective of 
the solution is to find the set of routes that guarantee the 
fulfillment of the restrictions shown below: 
 The defined routes must start and end in the deposit.  
 The requirements of all the customers must be satisfied at 
the 100% of the service level.  
 Each customer can be visited just on time in the selected 
route.  
 In each of the customers or nodes of the route, the total of 
the load transported by the vehicles should not exceed its 
capacity. That is, situations of no feasibility are not accepted. 
Figure 1 shows the graphic configuration of the VRPSPD for 
three vehicles with their respective routes. 
III. 
 FORMULATION OF THE MATHEMATICAL 
MODEL  
The feasibility of the problem VRPSPD depends on the 
sequence of the found route to visit the customers, and it is 
determined when upon verification of the customer’s 
demand, this does not exceed the capacity of the vehicles.  
  
Below is the description of the formulation of the 
mathematical model, proposed by Dell’Amico et al [4], 
applied by [21], with the following notation: 
A = set of arcs which consist of the pairs (i, j) e (j, i) for 
each edge {i, j} ε Ek. 
G = (Vk, Ek) = complete graph with vertexes V= {0, 1, 2… 
n}, where the vertex 0 represents the depot and the rest 
corresponds to the customers. Each edge {i, j} ε Ek has a 
non-negative cost and each customer i ε V’=V-{0} = {1, 2, 
3…... n}. 
di = amount of merchandise or product that has to be 
delivered to the customer i. 
pi = amount of merchandise or product that has to be picked 
up from customer i. 
cij = matrix of travelling costs or distances, i, j ε V.   
C = {1, 2… m} = set of m homogeneous vehicles with 
capacity Q. 
Ek = subset of Vk*Vk that comprises all the possible arcs.   
Decision variables:  
xij 
1, if the k vehicle travels the arc (i, j) ε V of the 
selected route 
0, in any other case. 
Dij = amount of products or merchandise pending to be 
delivered, which is transported in the arc (i, j). 
Q = capacity of the homogeneous vehicles. 
Pij = amount of products or merchandise pending to be 
picked up, which is transported in the arc (i, j) 
 
Depot
1
2
3
4
Vehicle 3
19
19
23
74
5
6
7
114
15
15
64
Vehicle 2
8
9
10
11
12
35
16
38
11
37
d1
p1
d2
p2
d3
p3
d4
p4
d5
p5
d6
p6
d7
p7
d8
p8
d9
p9
d10
p10
d11
p11
d12
p12
Vehicle 1
18
45
Total distance = 543 kms.
 
         Figure 1. Graphic structure of the VRPSD for three vehicles. 
76
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

The objective function and the constraints are presented 
below: 
Zmin=   
ij
V
i
V
j
cijx


min
 
(1) 
Zmin=   
ij
V
i
V
j
cijx


min
 
(2) 
1

V
j
xji
    
i V´
 
(3) 
m
x
V
j
j 

 ´
0
   
(4) 
i
V
j
ij
V
j
ji
d
D
D

 



  
i V´
 
(5) 
i
V
j
ji
V
j
ij
p
P
P





    
i V´
 
(6) 
ij
ij
ij
Qx
P
D


A
i j


( , )
            
(7) 
Dij  0
            
A
i j


( , )
             
(8) 
ijP  0
 
A
i j


( , )
           
(9) 

1,0 
ijx 
  
A
i j


( , )
             
(10) 
ij
i
ij
j ij
d x
Q
D
d x
)
(



A
i j


( , )
       
(11) 
ij
j
ij
i ij
p x
Q
P
p x
)
(



A
i j


( , )
 
(12) 


ij
i
i
j
j
ij
ij
x
p
d d
p
Q
P
D
)
,
,0
max
(





   
A
i j


( , )
     
(13) 
1

ji
ij
x
x
       
´
,
, ,
V
j
i j i



         
(14) 
 
 
 
The objective function (1) minimizes the addition of the 
travelling costs or travelled distances in the selected route. 
With the constraint (2), there is a guarantee for each 
customer to be visited just once in the selected route. The 
constraint (3) makes each vehicle to leave each node or 
customer once in the route. With constraint (4) it is assured 
that, each vehicle is used once at the most. The expressions 
(5), (6) and (7) are constraints that guarantee the 
conservation of the flow of the delivered and picked up 
products in the established routes.  
The nature of the variables of decision and the 
conditions of non-negativity are presented in the restrictions 
(8), (9), and (10). 
If there is an attempt to get a stronger inequality for the 
non-negativity of the constraint (8), this can be substituted 
for inequality (11), as Gouveia holds in his work published 
[10], whose characteristic is the use of narrower limits.  
Following the same strategy presented before of using 
stronger inequalities for Pij, constraint (9) can be substituted 
for (12) and (7) for (13). With inequality (14), we get that 
each edge non-adjacent to the depot travels once as a 
maximum. 
IV. 
DESCRIPTION OF THE IMPLEMENTATION OF THE CHU-
BEASLEY GENETIC ALGORITHM FOR THE SOLUTION OF 
VRPSPD. 
One of the reasons to apply the diverse techniques to the 
exact methods in the solution of NP-Hard problems, to 
which the VRPSPD belong, is that they require a lot of 
computation time as the size of the population or customers 
increases, since it is necessary to keep in mind a great 
number of variables and constraints. The application of 
metaheuristics like the Chu-Beasley genetic algorithm has 
generated good answers in relatively short computation 
times in comparison with the exact methods. 
As shown in [36], the Chu-Beasley genetic algorithm 
has some features that make it more efficient as the 
following: It uses the objective function to identify the value 
of the best quality solution and considers the no feasibility 
in the process of substitution of one solution generated in 
the implementation of the algorithm; it just substitutes one 
individual at a time in each generational cycle; to avoid the 
premature convergence to optimal local solutions, each 
individual that joins the population has to be different to all 
those who make up the current population; it includes an 
aspiration criteria, though the new individual does not meet 
the requisite of controlled diversity; it incorporates an stage 
of improvement, after the recombination, that from certain 
intra-route and inter-route strategies there is an evaluation of 
a feasible solution before deciding if it makes part of the 
current population. 
The implementation of the Chu-Beasley genetic 
algorithm includes the following stages: 
A. Construction of the Initial Population 
It can be constituted by two components: a first 
component is the configurations of the routes obtained from 
some constructive heuristics, and a second component is the 
configurations of the routes obtained I a controlled randomly 
way. For each configuration, there is an evaluation of the 
objective function (fitness) and the no feasibility associated 
to the load of each vehicle in the routes.  The presentation of 
a configuration or solution of the VRPSPD for 20 nodes or 
customers and their codification is shown in Figure 2. 
The length of the configuration or solution remains 
defined by the quantity of customers or nodes attended by 
the vehicles. It is important to note that the routes are 
determined by the capacities of the vehicles and by the 
 
 
Figure 2 Genetic representation of a configuration of 20 nodes or customers. 
77
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

quantities of the products that have to be delivered and 
picked up from each customer. 
The input data are the matrix of costs or distances cij; the 
quantity of products to deliver di; the amount of products to 
pick up pi; the amount of vehicles k with homogeneous 
capacity Q.  
The parameters of the Chu-Beasley genetic algorithm: 
recombination rate = 0.80; mutation rate= 0.05. 
In each configuration generated from the Chu-Beasley 
genetic algorithm, we get the value of the objective function 
(fitness), showing the feasibility or no feasibility of the 
route and the load of each vehicle assigned in the different 
subroutes or vehicles of the configuration. From the values 
of the objective function and the feasibility of the 
configurations or individuals, the genetic operators 
described in item B are used. 
 
B. Genetic Operators 
Three genetic operators are used in this work: Selection, 
recombination and mutation, whose procedures are detailed 
below. 
1) Selection 
In this stage, we use the method of selection by tournament.  
Two tournaments are carried out with the participation of all 
individuals of the current population k individuals are 
selected randomly, among whom the values of their 
objective functions and their no feasibilities are compared, 
selecting that who has the best value of the objective 
function if the k individuals are feasibility, or selecting that 
who has the least no feasibility if the k individuals are no 
feasibility. In the case of the presence of feasibility and no 
feasibility individuals, the feasibility individual with better 
objective function is selected. Two parents are left from 
these two tournaments, which pass on to the stage of 
recombination. 
2) Recombination 
This operator facilitates the exchange of information present 
in the two parents, and generates two descendants who own 
genetic material from parent 1 and parent 2. In this 
algorithm, which is elitist, just one of the children passes on 
to the current population. There are several techniques for 
the recombination, as: single-point crossover, two-point 
crossover, uniform crossover, partially mapped crossover 
(PMX), order-based crossover (OBX), Cycle crossover 
(CX), multi-parents crossover (MPX), longest common 
subsequence crossover (LCSX), among others. In this work, 
several forms of recombination are applied which explain 
the so-called PMX method, whose procedure is:  
 Starting from the two parents P1 and P2 a common 
random segment is selected and copied in the child from P1. 
From the first crossover point, elements i of this segment 
that have not been copied are sought in P2. Para each 
element of these elements i, it is sought what elements j 
have been copied in its position from P1.  
 To place i in the taken position j from P2, results in 
finding that said element is not there, since it has been  
 
Figure 3 Application of the recombination PMX in a 
configuration of twelve customers. Pi, Pj are parents and Hk is the 
child resulting from the recombination. 
copied before. If the place taken by j in P2 has already been 
filled in the child k, i is placed in the position taken by k in 
P2. The remaining elements are obtained from P2, ending the 
process (See Figure 3).  
Several recombination rates were used, 0.8 being the one 
with the best results.  
3) Mutation 
With this operator, some changes are made or parts of 
the resulting solution in the recombination are altered. This 
mechanism has the capacity to modify the current solution, 
applying small alterations. The mutation rate applied in this 
work is 0.05. There are several strategies that can help in 
this stage, like:  
 Inter-routes local search through the shift (1, 0), shift (2, 
0), shift (3, 0) strategy, with which 1, 2, 3 customers are 
transferred from one route to another.  
 Inter-routes local search through the swaft (1, 1), swaft 
(2, 1), swap (2, 2), which facilitates the exchange of 1, 2 or 
3 customers from one route to another.  
Intra-routes local search. In this case, neighboring criteria 
from the customers are considered in order to make 
movements in the same route.  
The strategies that can be applied are Rotation and 2-Opt. 
This is a local search algorithm proposed by Croes in 1958 
to solve the problem of the travel agent. The idea is to 
consider a route that crosses over itself and reorder it to 
avoid such crossover. 
In this work, several exchange strategies were used, and a 
swap (1, 1) application is described, for example, in order to 
exchange customer 3 of the route 3 for customer 4 of the 
route 1 of the next configuration, as it is shown in Figure 4. 
As it can be observed, with the applied swap (1, 1) 
strategy in the mutation we find a configuration with an 
incumbent, which passes on to the process of improvement.  
 
C. Process of improvement of an individual 
After the selection, of the recombination and mutation, each 
configuration is subject to a stage of local improvement, 
 
Figure 4 Swap application (1,1) for local inter-route search. 
78
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

which consists of separating the routes individually and 
constructing sub-problems of a single route each one, and a 
deposit, with fewer customers that the complete problem, 
which are solved using the branch-and-cut exact technique, 
and the partial routes are constructed through optimal 
solutions. The resulting configuration passes on to the 
replacement stage. 
 
D. Replacement stage 
Here, there is a comparison of the resulting configurations 
of the previous stages with the individuals of the current 
population. A replacement is made for one of the 
individuals of the population, privileging the feasibility over 
the no feasibility and objective function when feasible 
solutions are compared. 
V. EXPERIMENTAL RESULTS OF THE 
MATHEURISTICS WHERE THE CHU- BEASLEY 
GENETIC ALGORITHM AND EXACT TECHNIQUES 
ARE APPLIED FOR A DEPOT, 50 CUSTOMERS AND 4 
VEHICLES. 
In the literature associated to the VRPSPD three types of 
testing problems are known: Dethloff proposed 40 reference 
instances with 50 customers and the quantity of vehicles 
was 4,9 and 10 [5], Salhi and Nagy worked 14 instances, the 
quantity of customer was in the range of 50-199 and the 
vehicles used were 3,4,5,6,7 and 10 [19], and Montané and 
Galvão used 12 instances with 100-200 customers and the 
quantity of vehicles were 3,5,9, 10,12,16,23, and 28 [16]. 
The experimental tests were carried out with some of the 
instances proposed by Dethloff and the solutions with the 
best optimal limits have been published in the specialized 
literature [22] [9]. 
The applied methodology is, consequently, a hybrid of 
the Chu-Beasley genetic algorithm and mixed integer linear 
programming. The respective computing results are 
presented in Table I, using the Dethloff CON 3-8 instance. 
As can be observed in the Table I, out of 24 experiments, 
two configurations with values of the objective function of 
537.63 and 537.36 were obtained, which compared with 
523.05 that is the reported value by [20] as the optimal 
value of the instance, show good results in relatively short 
computing times (13.77 min and 14.45 min respectively) 
against the 32.05 minutes requires in [20]. Then, starting 
from the configuration obtained applying the Chu-Beasley 
genetic algorithm with the value of the objective function of 
537, 36, the four routes travelled by the four vehicles are 
considered. 
Each route is treated as a small linear programming 
problem, 
which 
may 
be 
solved 
easily 
with 
the 
corresponding mathematical model. In other words, we are 
applying the matheuristics, which supported by a good 
configuration produced by the Chu-Beasley genetic 
algorithm, with two constructive algorithms designed by the 
authors. 
  
TABLE I. COMPUTATIONAL RESULTS IN THE IMPLEMENTATION 
OF THE CHU-BEASLEY GENETIC ALGORITHM USING THE CON3-8 
INSTANCE OF DETHLOFF 
A: Best value of the objective function in the respective generation, 
B: Worst value of the objective function in the respective generation. 
C: Computation time for the related number of generations (seconds). 
 
The first algorithm generates the traveling matrices and the 
amount of the products to be delivered and picked up from 
each customer (node) of each of the routes. The second 
algorithm permits the control of the load for each route, data 
necessary for the mixed integer linear mathematical 
programming model to be applied. The resulting solutions 
in this case for the four routes are observed in Table II. 
Next, the description of the matrix generator called array 
generation algorithm and clustering algorithm are presented. 
 
A. Array generator algorithm  
This algorithm is applied to the best configuration or the 
incumbent configuration obtained from the AGCB. Its 
description is: 
 
•  Start: the best configuration of the AGCB is taken. 
•  Considering the capacity of each vehicle, customers are 
assigned sequentially until their capacity is exhausted. 
•  The previous action is repeated for the rest of the 
vehicles until the last customer of the AGCB configuration. 
•  The configurations established for each vehicle are the 
basis for generating the distance matrices and the quantities 
to be delivered and collected in each sequence. 
•  Once the matrices for each vehicle have been generated, 
they become small problems to which the mathematical 
model encoded in GAMS is applied separately, obtaining 
the optimal solution for each vehicle. 
79
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

•   With the integration of the solutions for each vehicle, a 
new configuration. 
 
B. Clustering algorithm  
 
  This algorithm is applied before using the Chu - Beasley 
AGCB genetic algorithm). It consists of the following 
phases: 
 
Phase 1: 
 
• Be based on known instances for multiple depots. If the 
instances are given in coordinates, the distance between 
customers and between them and the depot is calculated. 
• The closest neighbor heuristic is applied, assigning the 
closest customers to each depot, regardless of their capacity. 
 
Phase 2: 
 
• With the previous result, the capacity of each depot is 
evaluated taking into account the assigned customers. That 
is, if depots are overloaded, the difference between the 
current depot and the other depots is calculated. 
 
• Determine if there are reassignable depots. If the answer is 
affirmative, the depot with the shortest distance is chosen 
and it is analyzed whether said depot has the capacity to 
receive one or more clients. 
 
•  If the answer is affirmative, the client (s) are reassigned to 
said depot, considering the capacity of the depot. 
 
• The previous action is repeated until all clients are 
assigned to depots without exceeding their capacity. 
 
•   Each depot remains with its respective clients, obtaining 
feasible assignments. Once the allocation for each depot is 
known with its respective clients, the AGCB is applied for 
each depot. 
 
TABLE II. SOLUTIONS OBTAINED WITH MIXED INTEGER 
LINEAR PROGRAMMING. 
 
 
VI. ANALYSIS OF SENSIBILITY OF THE CHU-BEASLEY GENETIC 
ALGORITHM VARYING THE SIZE OF POPULATION 
 
The analysis of sensibility may be made for different 
scenarios. For example, it can be made for evaluating the 
performance of the algorithm varying the recombination 
rate, the mutation rate, modifying the techniques for 
selection of parents for the recombination, or varying the 
size of the population.  
In this research for reasons of space in this paper, the 
analysis is done to evaluate the performance of the 
algorithm by varying the size of the population. In Table IV 
shows the results of several generations with their 
corresponding objective function (fitness) for three 
population sizes: 100, 200 and 300 configurations. 
It can be observed both in Table III and in Figure 5 
concerning the results of the evolutionary process in these 
tests or experiments that for the size of the population of 
300 the value of the objective function differs significantly 
from the values for the other two sizes.  
Between the size of 200 and 100 the incumbent (best 
solution accomplished in the process) is obtained for the 
size of 200, result which gets stable starting from 6.000.000 
generations, placing itself with likelihood in a local optimal 
solution (537,36) which at any rate is very close to the 
optimal solution found by [20]. 
The implementation of the Chu-Beasley genetic 
algorithm was made in C++ from the configurations 
obtained with the best objective functions, each of the routes 
defined in the solution was considered as a sub-problem 
which was solved by the exact method, using the CPLEX 
Optimization Studio software, version 12.4, and was run in  
TABLE III. ANALYSIS OF SENSIBILITY FOR DIFFERENT 
POPULATION SIZES IN MULTIPLE GENERATIONS IN THE 
IMPLEMENTATION OF THE CHU – BEASLEY ALGORITHM USING 
THE DETHLOFF CON 3-8 INSTANCE. 
 
 
80
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

TABLE IV: CHARACTERISTICS OF THE COMPUTERS USE 
 
three computers with the following characteristics. (See 
Table IV). 
 
Figure 5 Performance of the objective function for different population size 
 
VII. CONCLUSIONS 
 
The proposed matheuristic and applied in this research, 
which combined the Chu - Beasley genetic algorithm and 
the exact technique based on the Branch and Cut algorithm, 
incorporated in the GAMS software, was a very good 
alternative to solve the VRPSPD for large sizes of clients or 
nodes with a single depot or multiple depots, where due to 
the nature of NP-Hard problems, mixed linear integer 
programming (MILP) does not solve them within an 
acceptable time frame. One of the critical stages in the 
implementation of the genetic algorithm of Chu & Beasley 
[20] was the synchronization of the parameters used. 
With the two-phase methodology (genetic algorithm of 
Chu & Beasley [20] with the exact technique based on 
linear programming) and the incorporation of constructive 
heuristic algorithms, provided by the author for the 
generation of routes from the configuration with the 
incumbent of Chu & Beasley [20], the route matrices were 
obtained with the determination of the number of customers 
per route from the load control per vehicle. This 
methodology considerably facilitated the application of the 
matheuristic proposed in this research and allowed through 
certain 
sensitivity 
analyzes 
the 
evaluation 
of 
the 
performance of the algorithm used, being able to verify that 
its implementation was efficient and worked well. 
It should be taken into account that the mathematical 
statistics do not guarantee the obtaining of an optimal global 
solution of the problems, but they did generate good 
solutions in very reasonable computation times, depending 
on the characteristics of the computer equipment used. 
This research showed a classification of the VRPSPD, 
according to some of its variants and applied solution 
methods. As the complexity of the problem increases, the 
interest of researchers to apply metaheuristics or hybrid 
methods in its solution grows, including, as in this case, the 
proposed matheuristic. 
The vast majority of the articles reviewed referred to real 
situations, which makes the application of solution 
techniques more interesting. 
The trend of heuristics for the VRPSPD allowed the 
development of new algorithms with a good level of 
performance 
that, 
in 
general, 
required 
significant 
computation times in their processes. 
The proposed matheuristic considered the costs of the routes 
(measured in distances) and their environmental impact 
(CO2 generation), from which it was deduced that the 
amount of fuel used depends on the number of depots and 
vehicles used in the execution of deliveries and pickups. 
The results achieved with the applied matheuristic can 
become a starting point for new research, since at present 
there are no known research that include the proposed 
matheuristic.  
In its objectives, this research contributed to knowledge 
through the discovery of new contributions, also in the 
application of existing knowledge to new situations, or the 
connection of previously unrelated events in the specialized 
literature, and with it important contributions were made, 
which were described in this document. 
REFERENCES 
[1]   P. Belﬁorea and H. Yoshizaki. “Heuristic methods for the 
ﬂeet size and mix vehicle routing problem with time windows 
and split deliveries”. European Journal of Operational 
Research-ELSEVIER. Part B 40. pp. 589-601, 2013. 
[2]  N. Bianchessi and G. Righini. “Heuristic algorithms for the 
vehicle routing problem with simultaneous pickup and 
delivery” [Journal] // Computer and Operation Research 
Elsevier, vol.36 (12), pp.3215-3223, 2007.  
[3]  E. Cao and M. Lai.2009. “An improved differential evolution 
algorithm for the vehicle routing problem with simultaneous 
pickups and deliveries and time windows”. European Journal 
of Operational Research-ELSEVIER. Engineering Applications 
of Artificial Intelligence, pp.  188-195, 2009. 
[4]  M. Dell’Amico, G. Righini, and M. Salani. “A branch-and-
price approach to the vehicle routing problem with 
simultaneous distribution and collection”. Transportation 
Science, 40(2), pp. 235–247, 2006. 
[5]  J. Dethloff. “Vehicle routing problem and reverse logistics: the 
vehicle routing problem with simultaneous delivery and pick-
up” [Journal]. - Springer Berlin: Operation Research 
Spectrum, vol. 23, pp.79 -96, 2001.  
[6]  Y. Dumas, J. Desrosiers and F. Soumis. “The pickup 
and delivery problem with time windows”.  European Journal 
of Operational Research-ELSEVIER. Vol. 54,  pp. 7-22, 1991. 
81
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

[7] A. Fabri and P. Recht. “On dynamic pickup and delivery 
vehicle routing with several time windows and waiting times”. 
European Journal of Operational Research-ELSEVIER. Part B 
40. pp. 335–350, 2006. 
[8]  J. Fan. “The vehicle routing problem with simultaneous pickup 
and delivery based on customer satisfaction”. European 
Journal of Operational Research-ELSEVIER, pp. 5284- 5289, 
2011. 
[9] Y. Gajpal and P. Abad. “An ant colony system (acs) for vehicle 
routing problem with simultaneous delivery and pickup”. 
Computers & Operations Research, vol. 36 (12), pp. 3215–
3223, 2009. 
[10]  L. Gouveia. “A result on projection for the vehicle routing 
problem”. European Journal of Operational Research, pp. 
610–624, 1995. 
[11]  I. Gribkovskaiaa, G. Laporte and A. Shyshou, “The single 
vehicle routing problem with deliveries and selective 
pickups”. European Journal of Operational Research-
ELSEVIER. Part B 40. pp. 2908-2924, 2008. 
[12]  I. Karaoglan, F. Altiparmak, I. Kara, I., & Dengiz, B. “A 
branch and cut algorithm for the location routing problem 
with simultaneous pickup and delivery. European Journal of 
Operational Research-ELSEVIER. pp. 318-332, 2011. 
[13]  C. G. Lee, M. A. Epelman, C. C. White III and Y. A.  Bozer. 
“A shortest path approach to the multiple-vehicle routing 
problem with split pickups”. European Journal of 
Operational Research-ELSEVIER. Part B 40. pp. 265-284, 
2006. 
[14]  R. Masson, S.  Ropke, F. Lehuédé and O. Péton. “A branch, 
cut, and price approach for the pickup and delivery problem 
with shuttle routes”. European Journal of Operational 
Research-ELSEVIER, vol. 236, Issue 3, pp. 849-862, 2014. 
[15] H.  Min. “The multiple vehicle routing problem with 
simultaneous delivery and pick up points”. Transportation 
Research. Vol. 23. No. 5, pp. 377-386, 1989. 
[16] F.A.T Montané and R.D Galvao. “A tabu search algorithm 
for vehicle routing problem with simultaneous pickup and 
delivery services”. European Journal of Operational 
Research, 33, 3 // Computers and Operation Research 
Elsevier, pp. 595 -619, 2006.  
[17]   M. Nowak, O. Ergun and C. White III Chelsea.  “An 
empirical study on the benefit of split loads with the pickup 
and delivery problem”. European Journal of Operational 
Research-ELSEVIER. Part B 40, pp. 734-740, 2009. 
[18]   S. N. Parragh, K. F. Doerner, R. F. Hartl. “A survey on 
pickup and delivery problems” Part II: Transportation 
between pickup and delivery locations. Institut fur 
Betriebswirtschaftslehre, Universitat Wien Brunnerstr. 72, 
1210 Wien, Austria, 2008. 
[19]   S. Salhi and G. A. Nagy. “A cluster insertion heuristic for 
single and multiple depot vehicle routing problems with 
backhauling” [Journal]. - [s.l.]: Journal of the Operational 
Research Society, Vol. 50, no. 10, pp. 1034 – 1042, 1999.  
[20]   A. Subramanian. (2012) “Heuristics exact and hybrid 
approaches for vehicle routing problems”. Universidade 
Federal Fluminense. Tesis Doctoral. Niteroi. pp. 13, 17, 19. 
[21]   A. Subramanian, L. Satoru, E. Uchoa. “New Lower Bounds 
for the Vehicle Routing Problem with Simultaneous Pickup 
and Delivery”. 9th International Symposium, SEA Ischia 
Island, Napoles, Italy, may 20/22, pp. 276-287, 2010. 
[22]  A. Subramanian, L. M. A. Drummond, C. Bentes, L. S. Ochi, 
and R. Farias. “A parallel heuristic for the vehicle routing 
problem with simultaneous pickup and delivery”. Computers 
& Operations Research, Vol. 37, Issue 11, pp. 1899-1911, 
2010. 
[23]   H. Wang and Y. Chen. “A coevolutionary algorithm for the 
ﬂexible delivery and pickup problem with time windows”. 
European Journal of Operational Research-ELSEVIER. 
International Journal of Production Economics. pp. 4-13, 
2013. 
[24]   E. Zachariadis, C. Tarantilis and C. Kiranoudis.  “A hybrid 
methaheuristic algorithm for the vehicle routing problem 
with simultaneous delivery and pick - up service” [Journal]. - 
[s.l.]: Expert System with Aplications, Vol. 36, Issue 2, part 
1, pp. 1070 -1081, 2009.  
[25]   E. Zachariadis, C. D. Tarantilis, and C.T. Kiranoudisb, “The 
vehicle routing problem with simultaneous pickups and 
deliveries and two dimensional loading constraints”, 
European Journal of Operational Research – ELSEVIER, 
vol. 251, pp. 369-386, 2016. 
[26]   A. Subramanian, E. Uchoa, A. Alves Pessoa, and L. Satoru 
Ochi, “Branch and cut with lazy separation for the vehicle 
routing problem with simultaneous pickup and delivery”. 
European Journal of Operational Research-ELSEVIER, vol. 
39, Issue 5, pp. 338-341, 2011. 
[27]   Y. Li, H. Chen, and C. Prins, “Adaptive large neighborhood 
search for the pickup and delivery problem with time 
windows, profits, and reserved requests”, European Journal 
of Operational Research – ELSEVIER, vol. 252, pp. 27-38, 
2016. 
[28] F. Hennig, B. Nygreena, K. C. Furmanb, and J. Song, 
“Alternative approaches to the crude oil tanker routing and 
scheduling problem with split pickup and split delivery”, 
European Journal of Operational Research – ELSEVIER, 
vol. 243, pp.41-51, 2015. 
[29]   T. Gschwind, “A comparison of column generation 
approaches to the synchronized pickup and delivery 
problem”, European Journal of Operational Research – 
ELSEVIER, vol. 247, pp. 60-71, 2015. 
[30] M. Gendreaua, J. Nossackb, and E. Pesch, “Mathematical 
formulations for a 1- full truckload pickup and delivery 
problem”. European Journal of Operational Research – 
ELSEVIER, vol. 242, pp. 1008-1016, 2015. 
[31] O. Polata, C. B. Kalaycia, O. Kulaka, and H. Otto, “A 
perturbation based variable neighborhood search heuristic for 
solving the vehicle routing problem with simultaneous 
pickup and delivery with time limit”, European Journal of 
Operational Research - ELSEVIER, vol. 242, pp. 369-382, 
2015. 
[32]  M. Cherkesly, G. Desaulniers, S. Irnich, and G. Laporte, 
“Branch price and cut algorithms for the pickup and delivery 
problem with time windows and multiple stacks”, European 
Journal of Operational Research – ELSEVIER, vol. 250, pp. 
782-793, 2016. 
[33]  E. Zachariadis, C. D. Tarantilis, and C.T. Kiranoudisb, “The 
vehicle routing problem with simultaneous pickups and 
deliveries and two dimensional loading constraints”, 
European Journal of Operational Research – ELSEVIER, 
vol. 251, pp. 369-386, 2016. 
[34] H. Hernández, I. Rodríguez, and J. J. Salazar, “A hybrid 
heuristic approach for the multi-commodity pickup and 
delivery traveling salesman problem”, European Journal of 
82
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

Operational Research – ELSEVIER, vol. 251, pp. 44-52, 
2016. 
[35] Y. Li, H. Chen, and C. Prins, “Adaptive large neighborhood 
search for the pickup and delivery problem with time 
windows, profits, and reserved requests”, European Journal 
of Operational Research – ELSEVIER, vol. 252, pp. 27-38, 
2016. 
[36]  R. Gallego, E. Toro y A. Escobar, “Técnicas Heurísticas y 
Metaheurísticas”, Colección de trabajos de Investigación 
Editorial UTP, pp.158-162, 2015. 
83
Copyright (c) The Government of Si corresponde, 2020. Used by permission to IARIA.     ISBN:  978-1-61208-780-1
COGNITIVE 2020 : The Twelfth International Conference on Advanced Cognitive Technologies and Applications

