POMDP Based Throughput Maximization Scheme
For Wireless Powered Cognitive Radio Network
Hiep Vu-Van and Insoo Koo
School of Electrical Engineering
University of Ulsan, Ulsan, South Korea
Email: vvhiep@gmail.com and iskoo@ulsan.ac.kr
Abstract—In
wireless
powered
Cognitive
Radio
Network
(CRN), a Cognitive radio User (CU) can receive the wireless
power transferred from an energy source for its operation. In
this paper, we consider the operations of a CU in the CRN with
wireless powered transfer. The operations of the CU include three
modes in terms of Data Transmission (DT), Receive Wireless Power
(WP) and Sleep (SL). In order to consider the effect of the future
operation on the current reward of the CU, we formulate the
problem to choose an optimal operation mode of the CU as
a Partially Observable Markov Decision Process (POMDP), in
which the two states in terms of belief about the channel state
and remaining energy are utilized as main factors to determine
an optimal operation of the CU. Simulation results show the
efﬁciency of the proposed scheme.
Index Terms—cognitive radio; wireless powered transfer; oper-
ation mode switching; maximizing throughput; POMDP.
I. INTRODUCTION
Cognitive Radio (CR) technology can improve spectrum
utilization by allowing Cognitive radio Users (CU) to share
the frequency assigned to a licensed user, called the Primary
User (PU). In order to avoid interference with the operation
of the licensed user, the CU is allowed to be active only when
the frequency is free. Otherwise, when the presence of the PU
is detected, the CU has to vacate their occupied frequency.
In the CRN, the CU often has a small battery that can
maintain operations of the CU in a short time. The wireless
power source [1][2] can charge the battery to extend its
lifetime. However, the wireless power is still limited, there-
fore, the performance of the CRN strongly depends on how
effectively the CU uses its power. The problem of optimal
energy management has been considered previously in [3][4]
where an optimal energy management scheme for a sensor
node with an energy harvester to maximize throughput is
proposed. In [5][6], a scheme to ﬁnd an optimal action policy
including sleeping to save energy or being active to take an
opportunity of transmitting data is proposed. In [5], the CU
has an independent energy harvester that harvests non-radio
frequency (RF) energy from surround environment (e.g., wind,
solar etc.), hence, the CU can perform data transmission and
energy harvesting concurrently. On the other hand, [5] adopts
an RF energy harvester that harvests energy from a PU’s
signal in the closed environment. Subsequently, the energy
harvesting performance in [5][6] signiﬁcantly ﬂuctuates due
to the uncontrollable wireless energy source.
In this paper, we consider the operation of wireless powered
cognitive radio network that includes a control center, a
wireless power source and cognitive radio user. The control
center has a strong power supply (i.e., it always has enough
energy to take any operation) and controls the operation of
the whole network. Because the wireless power source can be
controlled by the control center, the energy harvester of the
CU is more efﬁcient than conventional where the harvester
receives energy from an unknown source. In the CRN, the
operations of the CU includes three modes in terms of Data
Transmission (DT), Receive Wireless Power (WP) and Sleep
(SL). Due to the limitation of the hardware, the CU has a
limited capacity battery that can be recharged by a wireless
power source. On the other hands, the CU cannot perform
multiples actions at the same time (i.e., it cannot perform data
transmission and receiving energy at the same time).
This paper will propose a scheme to determine an optimal
operation for the CU that can maximize the average achieved
throughput of the CRN. In order to take a long-term optimiza-
tion for the operation selection, we formulate the problem to
choose an optimal operation as a partially observable Markov
decision process (POMDP) in which the CU’s two states in
terms of the belief about the absence probability of the primary
user (PU) and the remaining energy are utilized as main factors
to decide an optimal operation of the CU in current time
slot. By applying POMDP, the effects of future operations
on the current achieved throughput are also considered. It is
expected that the proposed scheme based on POMDP theory
will provide the CR system an improved performance.
The remaining part of this paper is organized as follows.
Section 2 shows the system model of the considered wireless
powered cognitive radio network. Section 3 formulates an
optimization problem based on POMDP in order to ﬁnd the
optimal operation mode for maximizing throughput of the
CRN. Section 4 introduces simulation model and simulation
results of the proposed and reference schemes. Finally, Section
5 concludes this paper.
II. SYSTEM MODEL
A wireless powered Cognitive Radio Network (CRN) shown
in ﬁgure 1, that includes a control center, a wireless energy
source and a CU, works in a cognitive manner, where the CRN
is allowed to opportunely utilize the channel that is assigned to
a primary user (PU). The operation of the PU changes between
two states of the Markov chain model, that is, Presence (P) and
Absence (A) as shown in ﬁgure 2. The transition probability
of the PU from state P to state A, state A to state P and from
27
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-633-0
ICNS 2018 : The Fourteenth International Conference on Networking and Services

state A or state P to itself are deﬁned as PP A, PAP , PAA and
PP P , respectively.
The control center of the CRN controls the operations of
CU that include Sleep (SL), Receive Wireless Power (WP) and
Data Transmission (DT) modes. In Sleep mode, the control
center does not request the CU to do any action, so the CU is
in the sleep state. Receive Wireless Power mode ﬁrstly requests
the wireless energy source to transfer energy to the CU, after
that the energy source will wirelessly transfer energy to the
CU where the energy will be received and stored in a limited
capacity battery of the CU to use for future operation. In the
Data Transmission mode, the control center ﬁrstly performs
spectrum sensing to determine the state of the PU. If the
sensing result is Presence, the control center does not ask
the CU to do any action. Otherwise, if the sensing result is
Absence, the control center asks the CU to transmit data. If
the transmission successes, the CRN can achieve a throughput
as:
R = T − ts
T
C0
(1)
where T is the duration of a time slot, ts is the sensing time
and C0 is the throughput of the communication link, which is
deﬁned as C0 = log2 (1 + SNRCR), where SNRCR is the
signal to noise ratio (SNR) received in the control center.
In the Receive Wireless Power mode, the CU receives the
energy from the energy source. Let deﬁne Eh(t) as the number
of units of energy that the CU receives at the time slot t.
Due to the ﬂuctuation of wireless power transfer, the amount
of energy that the CU received each time slot is not stable.
Hence, we assume that Eh(t) takes value from a ﬁnite number
ξh of energy units.
Eh (t) ∈ Υh =

eh
1, eh
2, ..., eh
ξh
	
,
(2)
where 0 ≤ eh
1 < eh
2 < ... < eh
ξh ≤ Eca, and Eca (units of
energy) is the capacity of the battery of the CU.
The probability mass function (PMF) of the harvested
energy is given as follows:
PEh (k) = Pr

Eh (t) = eh
k

, k = 1, 2, ..., ξh.
(3)
We assume that the harvested energy follows the stochastic
process that are marked by Poisson process. Subsequently,
Wireless 
energy 
source
Data transmission
Control 
center
CU
Wireless 
energy 
request
Wireless 
energy
Data request
Figure 1. System model of the network.
Presence
(P)
Absence
(A)
Figure 2. Markov chain states of the PU.
Eh(t) is a Possion random variable with mean eh
m and the
PMF in (3) can be rewritten as follows:
PEh (k) ≈ e−eh
m
with transition probability
Pr (er(t) → er(t + 1) |φ1 ) = 1.
(8)
B. Receive Wireless Power mode (φ2)
In this operation mode, the CU does not transmit data.
Therefore, no throughput is achieved, R (S(t), WP |φ2 ) = 0
This operation mode has no more information to update the
belief, p0, so that the belief p0 is updated as the Sleep mode
in (6).
In this operation mode, the CU will receive energy from the
wireless power source. So that, the remaining energy of the
CU will be increased as,
er(t + 1) = min{er(t) + eh
k (t) , Eca}, k = 1, 2, ..., ξh, (9)
with transition probability,
Pr (er(t) → er(t + 1) |φ1 ) = Pr

Eh (t) = eh
k

.
(10)
C. Data Transmission mode
This mode gives the CRN an opportunistic to achieve
throughput by performing data transmission. So that, in order
to transmit data the remaining energy of the CU must be higher
than the energy spending for transmission, that is, er(t) > et.
The achieved throughput of the system depends on their
observations. In this paper, we deﬁne three observations for
the Data Transmission mode as follows:
Observation 1 (φ3): The control center detects that the PU
is present (the channel is used by the PU - state P). Then,
the CU is not asked to transmit data and there is no achieved
throughput R (S(t), DT |φ3 ) = 0. The probability that this
observation (φ3) happens is:
Pr (φ2) = p0(t)Pf + (1 − p0(t))Pd,
(11)
where Pf and Pd are spectrum sensing performance of the
control center. Pf is the probability of false alarm that event
happens when the PU signal is actually absence, however the
sensing result is given as presence. Pd is the probability of
detection that event happens when the sensing result is correct
as the PU signal is presence.
The sensing result can be used to correct the belief p0 in
the current time slot as,
pu
0(t) =
p0(t)Pf
p0(t)Pf + (1 − p0(t))Pd
.
(12)
As a results, the updated belief for the next time slot is
given by:
p0(t + 1) = pu
0(t)PAA + (1 − pu
0(t))PP A.
(13)
Since, this observation of the Data Transmission mode does
not require the CU to do any action, the energy of the CU
is not changed. So that, the remaining energy and transition
probability are updated as the Sleep mode in (7) and (8).
TABLE I. SIMULATION PARAMETERS
Symbol
Description
Value
SNRCR
SNR of the sensing channel
−10 dB
Pr(H0)
The absence
probability of the PU
0.5
PAA
Transition probability
from state A to itself
0.8
PP A
Transition probability
from state P to state A
0.2
Eca
Total capacity of battery
15 units of energy
eh
m
mean of harvested energy
2 units of energy
et
Transmission energy
2 units of energy
Observation 2 (φ4): The control center does not detect any
signal from the PU (i.e., the state A of the PU). The CU is
requested to transmit its data to the control center through the
channel assigned to the PU and the transmission is success
(i.e., the CU can receive an ACK message). This means that
the sensing results is correct (the PU signal is really absent).
The throughput is achieved as:
R (S(t), DT |φ4 ) = T − ts
T
C0.
(14)
The probability that the observation φ4 happens is:
Pr (φ3) = p0 (t) (1 − Pf) .
(15)
The belief and remaining energy for the next time slot can
be updated, respectively, as:
p0(t + 1) = PAA
(16)
and
er(t + 1) = er(t) − et,
(17)
where et is the energy spent for data transmission.
The transition probability of the updated energy is given as,
Pr (er(t) → er(t + 1) |φ4 ) = 1.
(18)
Observation 3 (φ5): This observation is similar to the
observation φ4, state A of the PU is detected and the CU
transmits its data. However, the CU can not receive ACK
message. This means that the sensing results is incorrect (the
PU signal is present), and the transmission data fails, no
throughput is achieved, R (S(t), DT |φ5 ) = 0. The probability
that φ5 is obtained is:
Pr (φ5) = (1 − p0 (t)) (1 − Pd) .
(19)
The belief that the PU is in state A at the next time slot is:
p0(t + 1) = PP A
(20)
The remaining energy and transition probability of the CU
for the next time slot can be updated similar to the case of
observation φ4 in (17) and (18), respectively.
According to those observations, the expected value func-
tion in (5) can be expressed as (21). In order to ﬁnd an optimal
mode policy for maximizing throughput, the optimization
problem in (21) will be solved by using the value iterations
method [7].
29
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-633-0
ICNS 2018 : The Fourteenth International Conference on Networking and Services

V (S (k)) = max
ak



∞
X
t=k
αt−k
X
φi∈a(t)
Pr (φi)
X
er(t+1)
Pr (e (t) → e (t + 1) |φi )R (S (t) , a (t) |φi ) |S (k)



(21)
6
8
10
12
14
16
18
20
0.7
0.75
0.8
0.85
The capacity of the battery (Eca)
The average achieved throughput
 
 
The proposed scheme
Myopic scheme
Figure 3. The average achieved throughput of the system versus battery
capacity Eca when et = 2 and eh
m = 1.
IV. SIMULATION RESULTS
In this section, we present simulation results to show the
efﬁciency of the proposed scheme. Myopic scheme only con-
siders the current time slot for the value function (i.e. α = 0) to
determine the operation mode. This means that Myopic scheme
always chooses the third operation (i.e., Data Transmission)
when the CU has enough energy to perform transmission (i.e.,
er > et). Otherwise, they will choose the second operation
(i.e., Receive Wireless Power. Simulation results of Myopic
will be provided in this section for a reference. The parameters
for simulations are shown in Table I.
In order to evaluate the performance of the proposed
2
4
6
8
10
0.7
0.8
0.9
1
1.1
1.2
The mean value of received energy (eh
m)
The average achieved throughput
 
 
The proposed scheme
Myopic scheme
Figure 4. The average achieved throughput of the system versus the mean
value of received energy eh
m when Eca = 15 and et = 2.
2
3
4
5
6
7
0.4
0.5
0.6
0.7
0.8
0.9
1
The transmission energy  (et)
The average achieved throughput
 
 
The proposed scheme
Myopic scheme
Figure 5. The average achieved throughput of the system versus
transmission energy et when eh
m = 2 and Eca = 15.
scheme, the average achieved throughput in each time slot
of the system will be utilized.
Figure 3 shows the average achieved throughput (bits/s/Hz)
of the considered schemes according to the capacity of the
CU battery Eca (units of energy). The proposed scheme
always achieves better performance in comparison with My-
opic scheme as shown in the ﬁgure. It can be seen that the
increase of battery capacity may help the CU to achieve higher
throughput. However, when the battery is big enough (i.e., it
has enough space to store all received energy), the increase of
battery will not affect the throughput. However, since Myopic
scheme always choose Data Transmission mode when it has
enough energy so that the received energy is often spent before
the battery is fully charged. Subsequently, the battery capacity
seems not to affect on Myopic scheme.
Figure 4 presents the relation between the average achieved
throughput and the mean value of the received energy eh
m
(units of energy) of the CU. The higher amount of eh
m provides
more energy for Data Transmission mode of the CU so that
the CU can get more throughput. However, when eh
m is high
enough for Data Transmission mode of the CU in all time, the
increase of eh
m has no more effect on the CU’s throughput. In
this case, energy constrained will be disappeared, so that the
chosen operation of the proposed scheme and Myopic scheme
will be the same and that is the reason why they have the
same performance when the received energy is high enough.
The effect of the transmission energy et (units of energy)
on the average achieved throughput of the proposed scheme
is shown in Figure 5. The higher energy spent for trans-
mission may reduce the throughput of the system. However,
the proposed scheme always obtains better performance in
comparison with Myopic scheme.
30
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-633-0
ICNS 2018 : The Fourteenth International Conference on Networking and Services

Simulations results shown in all ﬁgures show that the
proposed scheme can offer the CRN a better performance than
the conventional Myopic scheme. That beneﬁt of the proposed
scheme is achieved by considering the future operations on
the current achieved throughput.
V. CONCLUSION
In this paper, we consider the operations of wireless pow-
ered cognitive radio network in which the CU is powered
by a wireless power source. The proposed scheme based
on POMDP will determine an optimal operation of the CU
to maximize the average achieved throughput with limited
power supply. In the other hand, the proposed scheme can
take consideration the effect of the future operation on the
current throughput of the system by applying POMDP theory.
Simulation results show that the proposed scheme can obtain
better performance than conventional Myopic scheme.
ACKNOWLEDGEMENT
This work was supported by the National Research
Foundation
(NRF)
of
Korea
funded
by
the
MEST
(2017R1D1A1B03029448).
REFERENCES
[1] Y. Wang, Y. Wang, F. Zhou, Y. Wu, and H. Zhou, “Resource allocation
in wireless powered cognitive radio networks based on a practical non-
linear energy harvesting model,” IEEE Access, vol. 5, pp. 17 618–17 626,
2017.
[2] S. A. Mousavifar, Y. Liu, C. Leung, M. Elkashlan, and T. Q. Duong,
“Wireless energy harvesting and spectrum sharing in cognitive radio,” in
2014 IEEE 80th Vehicular Technology Conference (VTC2014-Fall), 2014,
pp. 1–5.
[3] V. Sharma, U. Mukherji, V. Joseph, and S. Gupta, “Optimal energy man-
agement policies for energy harvesting sensor nodes,” IEEE Transactions
on Wireless Communications,, vol. 9, no. 4, pp. 1326–1336, 2010.
[4] S. Mao, M. H. Cheung, and V. Wong, “An optimal energy allocation algo-
rithm for energy harvesting wireless sensor networks,” in Communications
(ICC), 2012 IEEE International Conference on, 2012, pp. 265–270.
[5] A. Sultan, “Sensing and transmit energy optimization for an energy
harvesting cognitive radio,” Wireless Communications Letters, IEEE,
vol. 1, no. 5, pp. 500–503, 2012.
[6] S. Park et al., “Optimal mode selection for cognitive radio sensor
networks with rf energy harvesting,” in Personal Indoor and Mobile Radio
Communications (PIMRC), 2012 IEEE 23rd International Symposium on,
2012, pp. 2155–2159.
[7] D. P. Bertsekas, Dynamic Programming and Optimal Control.
Athena
Scientic, 2nd edition, 2001, vol. 1 and 2.
31
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-633-0
ICNS 2018 : The Fourteenth International Conference on Networking and Services

