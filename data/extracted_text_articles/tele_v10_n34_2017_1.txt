Nobuaki Shimakawa 
Dept. of Electrical and Mechanical Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: 28413082@stn.nitech.ac.jp 
Abstract—Recently, 
Multi-User 
MIMO 
(MU-MIMO) 
downlink system which uses multiple antennas at Base Station 
(BS) and accommodates multiple users with multiple reception 
antennas attracts much attention. In MU-MIMO downlink 
system, by knowing the Channel State Information (CSI) at 
BS, Inter User Interferences (IUI’s) among users are 
pre-excluded at BS. By increasing the number of transmission 
antennas assigned to each user, the transmission quality of 
each user is effectively improved. In MU-MIMO, there exists 
linear precoding or nonlinear precoding method, but linear 
precoding is considered more easily implemented and adjusted 
than nonlinear precoding. In this paper, we aim the coverage 
extension and the transmission quality improvement by using 
a regenerative Detect & Forward (DF) relay in MU-MIMO 
downlink system. We use Block Diagonalization (BD) + Eigen 
mode transmission (E-SDM) for linear MU-MIMO downlink 
scheme. By sharing the BD matrix at both BS and DF relay, 
the DF relay can demodulate the receive signal with the 
receive CSI only and can forward the detected signal to each 
user. At each user, the received signals from BS and DF relay 
are combined through bit LLR (Log Likelihood Ratio) 
addition to minimize the BER. With this system configuration 
and by employing large number of transmission antennas, we 
have shown the effectiveness of regenerative DF relay through 
simulations. 
Keywords-MU-MIMO; Block Diagonalization; Eigen mode 
transmission; Regenerative relay; Detect & Forward. 
I. INTRODUCTION 
Recently, Multi-User MIMO down link communication 
systems in which Base Station (BS) can transmit spatially 
multiplexed signals to multiple users without Inter-User 
Interference (IUI) are well investigated [1]-[9]. In 
MU-MIMO downlink system, in order to remove the IUI at 
BS, the Channel State Information (CSI) of downlink has to 
be known at BS. By increasing the number of transmission 
antennas at BS, the channel quality to each user can 
arbitrary be improved. As representative methods, there 
exist BD (Block Diagonalization) [4] and Channel 
Inversion (CI) [5] categorized as linear methods, and DPC 
(Dirty Paper Coding) [6], THP (Tomlinson-Harashima 
Precoding) [7] and Vector Perturbation (VP) [8],[9] as 
nonlinear methods. Although nonlinear methods can 
achieve greater channel capacity than linear methods, its 
complexity is higher and the design method is more 
difficult than linear methods. As for the linear methods, the 
CI method has the problems of increasing transmission 
Yasunori Iwanami 
Dept. of Electrical and Mechanical Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: iwanami@nitech.ac.jp 
 
power and limited sum-rate. The BD method consumes a 
lot of degree of freedom to make the nulls, but it can 
remove the IUI completely. Also, the BD method matches 
the Eigen mode transmission (E-SDM; Eigen beam-Space 
Division Multiplexing) [10] well and is considered as a 
practical design method. On the other hand, concerning the 
use of relay in MU-MIMO downlink, increasing the 
channel capacity by using the relay has been discussed 
[11],[12]. On the relay transmission in MU-MIMO 
downlink system, the BD methods are used at BS [13]-[18]. 
In [13], during the 1st time slot transmission from BS to 
relay, MU-MIMO is not employed, but during the 2nd time 
slot from relay to each user, it is used. In [14]-[18], the 
transmission from BS to relay is done during the 1st time 
slot, but the direct link from BS to each user during the 1st 
time slot is not considered. 
In this paper, we employed the BD+E-SDM method for 
the transmission from BS to each user during the 1st time 
slot. We assume that the DF relay which locates between 
BS and each user already knows the precoding matrix of BS. 
By knowing the precoding matrix, the DF relay can 
demodulate the receive signal with only receive CSI. 
Accordingly, the BS does not need to assign the 
transmission antennas to the DF relay and the transmission 
from BS to DF relay becomes SU (Single-User)-MIMO. 
During the 2nd time slot, the DF relay transmits the 
detected signals to each user also with the BD+E-SDM 
method. At each user, the received signals during the 1st 
and the 2nd time slots are combined using the bit LLR 
addition and the combined signal is demodulated. We show 
the effectiveness of the proposed DF relaying system in 
MU-MIMO downlink through computer simulations. 
The paper is organized as follows. In Section II, the DF 
relay model in MU-MIMO downlink is introduced. In 
Section III, we design the downlink transmission during the 
 
TABLE I  LIST of PARAMETERS 
S
N :Number of transmission antennas of BS 
u
N : Number of users
i
m : Number of reception antennas of user 
u
(
1,
,
)
i i
N


D
N : Total number of reception antennas of all users 
R
M : Number of reception antennas of relay 
R
N : Number of transmission antennas of relay 
CSD
: Optimum power assignment matrix to each user on SD link
VSD
: Precoding matrix of E-SDM to each user on SD link
NSD
: Precoding matrix of BD on SD link 
BSDi
: Block channel matrix of user i on SD link 
i
nl : Nullity of user i on SD link
LSDi
: Number of transmit streams of user i on SD link
A Regenerative Detect & Forward Relay Transmission in Linearly Precoded MU-MIMO Downlink 
85
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

1st and the 2nd time slots. In Section IV, we clarify the 
BER characteristics through computer simulations. The 
paper is concluded with Section V with the most important 
results. 
II. DF RELAY MODEL IN MU-MIMO DOWNLINK 
The proposed DF relaying model in MU-MIMO 
downlink system is shown in Figure 1. The Base Station is 
equipped with 
S
N  transmission antennas. There exist total 
u
N  users and the user 
u
( 1,
,
)
i
  N
 has 
i
m  reception 
antennas. Thus, there are total 
D
1
u
N
i
i
N
  m
 reception 
antennas at all users. The DF relay, which locates between 
BS and user terminals, has 
MR
 reception and 
R
N  
transmission antennas. At Base Station, the transmit signal 
u
[ 1
]
T
T
T
T
i
N
s 
s
s
s


 to 
each 
user 
is 
firstly 
multiplied by the precoding matrix 
CSD
, where 
CSD
 is the 
optimum power assignment matrix for multiple different 
modulation streams in E-SDM of each user. The power 
assignment in E-SDM of each user is done to minimize the 
BER by using Lagrange multiplier method [10]. 
Secondary, the precoding matrix 
VSD
 for making the 
multiple stream transmission using E-SDM is multiplied by
CSD
s . The transmit signal to user i is expressed as 
D
(
)
[ (1)
]
LS i
T
i
i
i
s
s
s 

 where 
LSDi
 is 
the 
number 
of 
modulation streams of user i  in E-SDM. The matrix 
SD
V  
is expressed as 
u
SD1
SD
SDN




 





V
V
V

0
0
0
0
0
0
                (1) 
where the diagonal element 
SD
u
,
1~
i i
N

V
 is the precoding 
matrix of E-SDM for each user. Third, the precoding matrix 
N SD
 for BD is multiplied by 
SD
SD
V C s . The transmit signal 
from BS is then given by
SD
SD
SD
x 
N V C
s  
S
1
2
[
N ]T
x
x
x


. 
During the 1st time slot, the transmit signal 
x  is 
broadcasted both to user terminals and the DF relay. The 
precoding matrix 
NSD
 makes the channel matrix 
HSD
 
from BS to each user block diagonal. The receive signal 
vector 
ySD
 at destination users is expressed as 
 
 
Figure 1. DF relay model in MU-MIMO downlink system 
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
,









y
H
x
n
B V C
s
n
B
H
N
x
N V C
s
        (2) 
SD
B  in (2) is the block diagonalized channel matrix and is 
expressed as 
u
SD1
SD2
SD
SD
SD
SDN







 







B
B
H
N
B
B







0
0
0
0
0
0
         (3) 
where 
SD
u
,
1,
,
i i
N

B

 is the block channel matrix for user 
i
 and 
u
SD
SD1
SD
SD
[
]
T
T
T
T
i
N

n
n
n
n


 in (2) is the 
receive noise vector for each user. 
The precoding matrix 
NSD
 for BD is derived as 
follows. Denoting the channel matrix for user 
i
as 
SD
S
(
)
i
mi
 N
H
, the entire channel matrix from BS to users is 
expressed as 
u
SD
SD1
SD
SD
T
T
T
T
i
N


 

H
H
H
H


        (4) 
We denote the matrix 
HSDi
 in which the channel matrix 
HSDi
 of user i  is excluded from the entire channel 
matrix 
H SD
 as 
u
SD
SD1
SD
1
SD
1
SD
T
T
T
T
T
i
i
i
N




 

H
H
H
H
H



  (5) 
with the size of 
D
S
((
)
)
i
N
m
N


 [2],[19]. By making the 
Singular Value Decomposition (SVD) on 
H SDi
 , we get 
 
1
SD
SD
SD
SD
SD
H
i
i
i
i
i





H
U
Λ
V
N




        (6) 
where 
N SDi
 is the null space of 
HSDi
 and it 
orthogonalizes 


SD i
i
i

 
H
, i.e., 


SD
SD
i
i
i
i




H
N
0
. 
By obtaining all the null spaces of every user, the precoding 
matrix 
N SD
 for BD is evaluated as 
u
SD
SD1
SD
SD
i
N


 

N
N
N
N


        (7) 
The size of block channel matrix for user i  becomes 
SD (
)
i
i
i
m
 n
B

, where the nullity 
i
n  of the matrix 
H SD i
 
is defined by 
SD
S
SD
(
)
(
)
i
i
i
n
nullity
N
rank



H
H



        (8) 
As the rank of 
H SD i
 is given by 
SD
D
S
(
)
min(
,
)
i
i
rank
N
m
N


H
           (9) 
the nullity 
i
n  is expressed as 
S
SD
S
D
(
)
0
i
i
i
n
N
rank
N
N
m






H

     (10) 
In E-SDM, the receive weight 
SD
H
U i
 which satisfies 
SD
SD
SD
SD
H
i
i
i
i

B
U
Λ
V
             (11) 
is multiplied by 
ySDi
 and 
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
H
H
H
i
i
i
i
i
i
i
i
i
i
i
i
i
i




 
z
U
y
U
B
V
C
s
U
n
Λ
C
s
n
    (12) 
is obtained. As it follows
 

SD 
1
SD
SD
SD
(
,
,
)
i
L
i
i
i
diag
d
d

Λ

 and 
 

SD 
1
SD
SD
SD
(
,
,
)
i
L
i
i
i
diag



C

, (12) is expanded as 
 


 
 
 
 








SD
SD
SD
SD
SD
1
1
1
1
1
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
i
i
i
i
i
i
i
i
i
i
L
L
L
L
L
i
i
i
i
i
z
d
s
n
z
d
s
n































      (13) 
where 
parallel 


SD
min
,
i
i
i
L
m n


 AWGN 
channels 
u
1
2
N






 







s
s
s
s

1x
2x
SD
N
NS
x


yR2
1
u
N
2





Source
Relay (DF)
Destination
1
m
Nu
m
2
m
SD
H
HSR
RD
H
VSD
SD
C
R1
y
RMR
y
RNR
x
R2
x
R1
x
User
User
User
MU-MIMO transmission
86
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

independent of each other are obtained. 
We assume that the DF relay knows the precoding 
matrix 
SD
SD
N V CSD
 of BS. Therefore, the BS has to inform 
SD
SD
N V CSD
 to the DF relay before the data transmission 
starts. The transmission from BS to DF relay during the 1st 
time slot is done by Single User-MIMO (SU-MIMO) 
environment. 
The 
receive 
signal 
SR 
y
R
R1
R 2
R
[
M ]T
y
y
y

 at DF relay is expressed as 
SR
SR
SR
SD
SD
SD
SR
(
)
SR




y
H
x
n
H N V C
s
n        (14) 
where 
SR
R
(
M 1)
n
 is the receive noise vector at DF relay. 
The effective channel matrix 
SR
SD
SD
SD
H
N V C
 in (14) is 
assumed to be known at the DF relay and the demodulation 
of transmit signal s  is done by MMSE (Minimum Mean 
Squared Error) nulling, MLD (Maximum Likelihood 
Detection) or Sphere Decoding. This means that the DF 
relay does not need to inform the channel matrix 
HSR
 
between BS and DF relay to the BS. The demodulated 
signal ˆs  at DF relay is transmitted to each user during the 
2nd time slot using MU-MIMO with BD+E-SDM which is 
the same as in the Source-Destination (SD) link, i.e., the 
E-SDM is employed for the multiple stream transmission 
from the DF relay to each user. At each user terminal, the 
received signals during the 1st and the 2nd time slots are 
combined using bit LLR addition and demodulated. When 
the errors are detected at the DF relay through the CRC 
(Cyclic Redundancy Check), erroneous user does not 
employ the Relay-Destination (RD) transmission to prevent 
error propagation, instead the SD link transmission is 
repeated in the second time slot. 
III. DESIGN OF DOWNLINK TRANSMISSION 
A. Transmission during the 1st time slot 
1) Design of SD Link 
The Source-Destination (SD) link transmission during the 
1st time slot is done by using BD+E-SDM. The size of 
block channel matrix 
SDi
B
 is given by 
i
i
m
n
   and the 
number of streams of E-SDM (eigen mode transmission) 
becomes 
SD =min(
,
)
i
i
i
L
m n . When the number of streams is 
one, BD+E-SDM is referred to as BD+MRT (Maximum 
Ratio Transmission) [20]. From (10), the nullity 
i
n  of 
user i can be arbitrary chosen by increasing or decreasing 
the number of transmission antennas 
S
N  at BS. If the 
elements of channel matrix 
HSD
 follow the i.i.d 
(independent and identically distributed) complex Gaussian 
random variables, i.e., if 
HSD
 is the MIMO channel 
matrix of quasi-static flat Rayleigh fading, the diversity 
order of the first eigen mode stream in E-SDM for the block 
channel matrix 
BSD i
 is given by
i
m n i
   [21]. When the 
minimum number of reception antennas among users is 
mmin
, from (10) the nullity 
nmin
 of minimum antenna 
user is given by 
min
S
D
min
0
n
N
N
m





            (15) 
Hence, the number of transmission antennas 
S
N  at BS 
which enables the BD must satisfy 
S
D
min
N
N
m


                 (16) 
The nullity 
i
n  of user i  other than the minimum 
antenna user becomes 
S
D
min
i =
i
n
N
N
m
n





            (17) 
The size of block channel matrix 
BSD i
 of user i  is 
determined as 
i
i
m
n
  . In this design method, firstly the 
nullity 
nmin
 of the user which has the minimum number 
of reception antennas 
mmin
 is determined and secondary 
the nullity 
i
n  of the other user i  is derived. The 
diversity orders of the first eigen mode stream of minimum 
antenna user and other user i  are given by 
min
min
m
n
 
 
and 
min
min
i
i
m
n
m
n





, respectively. 
For example, we consider the case where the number of 
total users is 
u
N  3
, the numbers of reception antennas of 
three users are 
1
m  3
,
2
m  2
,
3 1
m   respectively, and the 
total number of reception antennas is 
D
1
2
3
6
N
m
m
m




. 
In this case, 
3 1
m   is minimum and it holds 
3
1
mmin
 m
 . 
If the expected diversity order of the first eigen mode 
stream of user 3 is set to 3, for example, then we obtain 
3
3 1
3
min
min
n
m




. With these parameters, the total 
number of transmission antennas at BS 
S
N  is determined 
as 
S
D
min
min
N
n
N
m




3
6
1
8


   and the size of block 
matrix 
BSD3
 of user 3 becomes 
min
min
m
n
 
1 3
  . Thus, 
the nullity of user 2 is determined as 
n 2


S
D
2
N
N
m


8
6
2
4




, the size of 
BSD 2
 becomes 
2
2
m
n
  = 2 4
 , 
and the diversity order of the first eigen mode stream of 
user 2 is given as 
2
2
2 4
8
m n

   
. Likewise, the nullity 
1
n  of user 1 is given by 
n 1


S
D
1
N
N
m


8
6
3
5




, 
BSD1
 becomes 
1
1
m
n
 
3 5
  , and the diversity order of the 
first eigen mode stream of user 1 is determined as 
1
1
3 5
15
m
 n




. 
2) Design of SR Link 
For the Source-Relay (SR) link from BS to DF relay, the 
precoding for DF relay at BS is not employed. This means 
no degree of freedom of transmission antennas (number of 
transmission antennas) at BS is consumed for the SR link. 
This is because if the transmission antennas at BS are 
assigned to the DF relay using BD, in the absence of DF 
relay the assigned transmission antennas to DF relay are of 
no use. Therefore, the extra transmission antennas are then 
used for the users to enhance the SD link quality. In this 
case, the effect of using DF relay does not become obvious 
compared with the enhanced SD link quality. That is, the 
DF relay should be employed when the SD link quality is 
poor and the additional DF relay usage brings the great 
effect to the overall performance. As the demodulation at 
DF relay is done by only using receive CSI, the precoding 
matrix 
SD
SD
N V CSD
 at BS needs to be informed to the DF 
relay in advance before the data transmission from BS to 
DF relay starts. The DF relay demodulates the receive 
signal with MMSE nulling, MLD or Sphere Decoding by 
using effective channel matrix of 
SR
SD
SD
SD
H
N V C
. So, the 
SR link transmission is done under SU-MIMO environment 
87
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

and not MU-MIMO. The SR link quality directly affects the 
subsequent Relay-Destination (RD) link quality very much, 
because the poor SR link quality causes the error 
propagation on the RD link. Thus, we must raise the SR 
link quality as much as possible. To solve this problem, 
increasing the number of reception antennas at DF relay or 
increasing the number of transmission antennas at BS is 
considered. Also at DF relay, MLD or Sphere Decoding 
with better BER characteristic than MMSE nulling is 
considered. But when the number of total transmit streams 
of L  from BS to DF relay is large, the exponential 
increase of complexity in MLD becomes a problem. In such 
case, we can resort the problem to employ the Sphere 
Decoding with less complexity or to use the MMSE nulling 
with far less complexity but degraded performance for 
demodulating SU-MIMO signals. When the number of 
reception antennas at DF relay is given by 
R
M , the 
effective channel matrix for demodulating the transmit 
signal 
s  at DF relay link becomes 
SR
SD
SD
SD
H
N V C
R
(
)
M
 L
. Accordingly, to apply MMSE nulling at DF relay 
it needs 
MR
 L
. Even though the elements of 
HSR
 are 
i.i.d. complex Gaussian random variables, the row elements 
of effective channel matrix 
SR
SD
SD
SD
H
N V C
 of SR link do 
not always become i.i.d. complex Gaussian random 
variables. This channel element correlation deteriorates the 
BER characteristic of MMSE nulling, MLD (or Sphere 
Decoding) compared with i.i.d. random variable case. Also, 
if errors are detected at the DF relay with CRC code, the 
subsequent RD transmission is not employed for the 
erroneous users, instead the SD link transmission is 
repeated using the 2nd time slot. For error free users on SR 
link, the RD link transmission is done. The received signals 
at each user during the 1st and 2nd time slots are then 
combined through the bit LLR addition and the multiple 
streams to each user are demodulated. 
 
B. Transmission during the 2nd time slot 
For the Relay-Destination (RD) link transmission 
during the 2nd time slot, we use BD+MRT or BD+E-SDM, 
which is the same as in the 1st time slot. In this case, the 
number of streams to each user on Source-Destination (SD) 
link does not need to coincide with the one on RD link, 
because the signal combining between SD link and RD link 
is done using bit LLR addition. However, the transmission 
rate (bps/Hz) must be the same between SD link and RD 
link for the bit LLR combining. We can design the RD link 
quality as in the SD link. Thus, we can improve the RD link 
quality by increasing the number of transmission antennas 
R
N  at DF relay. As already stated in Section III A)-2), in 
order to prevent the error propagation in the RD link, we 
adopt the protocol in which the data from DF relay are only 
forwarded to each user in case of no error detected at the 
DF relay. When the error is detected at the DF relay and the 
RD link is not employed during the 2nd time slot, in order 
to prevent the degradation of receive signal quality, we 
repeat the SD link transmission using the vacant 2nd time 
slot. The signals received in the 1st and 2nd time slots are 
bit LLR combined and demodulated at each user as 
mentioned in Section III A)-2). 
At each user terminal, each stream of MRT or E-SDM is 
equivalently represented as the AWGN channel with the 
positive real gain h . When the received signal in each 
stream is denoted as r  and the corresponding transmitted 
signal 
,
0,
,
1
ls
l
Q



 has Q  modulation levels, the 
equivalent AWGN channel of each stream in each user is 
expressed as 
,
0,1,
,
1
l
r
hs
n l
Q





               (18) 
The symbol LLR is the extension of bit LLR and is defined 
as 












0
0
0
0
( |
) ( )
( )
|
log
log
|
( |
) (
)
( )
|
log
|
l
l
l
l
e
e
l
e
p r s p s
p r
p s
r
p s
r
p r s
p s
p r
p r s
p r s


































   (19) 
where we have assumed the priori probabilities are all equal, 
i.e.,
( )
1/
,
0,1,
,
1
p sl
Q l
Q




. The transition probability 
density function 


|
p r sl
 is expressed as 


2
2
1
|
exp
2
2
l
l
r
hs
p r s












          (20) 
where 
2
2
(1/ 2) {|
| }
E
n
 
. From (19) and (20), it holds 
2
2
0
2
2
l
l
r
hs
r
hs







            (21) 
When the modulation level is 
Q  2
, the symbol LLR 
coincides with the bit LLR. 
The bit LLR is obtained easily from the symbol LLR. 
When the data bits assigned to a signal point is 


1,
,
,
,
k
N
c
c
c


, the k-th bit LLR 

kc 

 is given by 








 


 








  



  



|
0
|
0
'|
0
'|
0
0 |
0,
log
log
1|
1,
,
|
log
log
',
'
| '
k
k
k
k
k
k
k
e
e
k
k
s c
s c
e
e
s c
s c
p c
r
p c
r
p r
c
p c
r
p c
r
p r
p s r
p s p r s
p s r
p s
p r s

























































  (22) 
where 

|
0
k
s c 
 and 

'|
1
k
s
c 
 denote the transmit 
symbols s  and 
's  with the k-th bit being 
kc  0
 and 
1
kc   respectively. As each bit is generated equally, it 
holds 
 
 '
p s
 p s
. From (19), we can say 



 
0 
|
exp
|
l
l
p r s
p r s


              (23) 
and (22) is expressed as 






0
|
0
0
'|
1
|
0
'|
1
exp( )
|
log
exp( ')
|
exp( )
log
exp( ')
k
k
k
k
s c
k
e
s c
c
e
c
p r s
c
p r s





































      (24) 
where 
|
0
kc


 and 
'|
1
kc

  denote the symbol LLR’s 
of s  and 
's  in which the k-th bits are 
kc  0
 and 
1
kc   
respectively. 
Next, 
we 
define 
the 
symbol 
LLR’s 
88
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

0
(
)
s
s




 and 
0
(
)
s
s
j




 as 

 and 

  
respectively, where s  and s  denotes the transmit signal 
points displaced by   and j  from 
0s  respectively. It 
then holds 








                (25) 
where 
j





. By using (25), we do not need to obtain 
every symbol LLR’s when calculating the bit LLR’s 
resulting in simplifying the bit LLR calculation. The bit 
LLR addition between the 1st time slot and 2nd time slot is 
done at each user stream and finally the bit decision is made 
based on the added bit LLR value. 
IV. INVESTIGATION OF BER CHARACTERISTICS 
THROUGH COMPUTER SIMULATIONS 
We have checked the BER characteristics of the proposed 
MU-MIMO downlink transmission using DF relay. The 
abscissa of BER characteristic is taken as the transmit SNR 
[22], which is defined as the ratio of transmission power P  
from BS for a user to the receive noise power 
2
  at each 
user reception antenna and is given as 
2
S
P
N







transmit
                 (26) 
where the transmission power P  is equal among every 
user. The channel from BS to each user, the channel from 
BS to DF relay and the channel from DF relay to each user 
are all assumed to be quasi-static Rayleigh fading channel. 
That 
is, 
the 
element 
ijh
 of 
channel 
matrix 
SD
SR
RD
(
,
,
)
H H
H
H
 is an i.i.d. complex Gaussian random 
variable with the variance of 
2
{|
| }
1
ij
E
h
 . We consider the 
distance from BS to each user is equal among users and the 
DF relay locates at the middle point between BS and users. 
We also set the power decaying exponent of propagation 
loss as 
  3.5
 regarding the different distances from BS 
to DF relay and from BS to users. The BER characteristics 
in Figure 2~Figure 13 are averaged over 
u
N  users. Thus, 
the BER shows the average BER among all users. 
First, we investigate the case where the number of 
transmission antennas of BS is 
S
N  2
, the number of user 
terminals 
u
N  2
, the number of reception antennas of each 
user 
1
2
1
m
 m
 , the number of reception antennas of DF 
relay 
R
4
M  , and the number of transmission antennas of 
DF relay 
R
N  2
. We call this as 2 (4,2) (1,1)


 model. In 
this model, for the SD link during the 1st time slot, 
BD+MRT scheme is used as the MU-MIMO down link 
transmission. QPSK modulation is used for each user 
stream. The BER characteristic is shown in Figure 2. “SD 
link 2 times w/o relay” means the scheme in which the 
MU-MIMO transmission on SD link is repeated twice 
without using the relay. “ 2 (4,2) (1,1)


 MMSE” and 
“ 2 (4,2) (1,1)


 MLD” mean the schemes in which the 
receive signal at DF relay is demodulated using MMSE  
 
Figure 2. BER characteristics of 2 (4,2) (1,1)


 model (Transmission rate 
to each user is 2 (bps/Hz).) 
 
nulling and using MLD respectively. 
From Figure 2, we see that by using the DF relay and by 
combining the bit LLR’s of SD link and RD link signals, 
the BER characteristic with using DF relay is very much 
improved compared with the 2 times transmission on SD 
link without using DF relay. From Figure 2, “SD link 2 
times w/o DF relay” shows the BER slope of about 
1
10 /10 (dB)

 for the transmit SNR=10~20 (dB) and we see 
that the diversity order of 1
1
(BER
10
 /10 dB)

is almost 
obtained. As stated in Section III. A)-2), as the row elements 
of channel matrix 
SR
SD
SD
SD
H
N
V
C
 on the SR link do not 
always become independent, the SR link quality is degraded. 
Accordingly, the diversity order of 2 at each user is not 
achieved especially when the MMSE nulling is used at the 
DF relay. However, by using the MLD at DF relay, the SR 
link quality is improved. So “MLD w/ DF relay” in Figure 
2 shows the BER slope of about 
10 2
 /10 (dB)
 for the 
transmit SNR=10~20 (dB) and we see that the diversity 
order of 2 is almost obtained. 
Next, we consider the case where the number of 
transmission antennas at BS is 
S
N  4
, the number of users 
u
N  2
 and the numbers of reception antennas of each user 
are 
1
2
1
m
 m

. Compared with the previous case of 
S
N  2
, more transmission antennas are assigned to each 
user. The numbers of reception and transmission antennas at 
DF relay are 
R
4
M   and 
R
N  4
, respectively. We call this 
as 4 (4,4) (1,1)


 model. The transmission protocols of SD, 
SR and RD links are the same as the previous 
2 (4,2) (1,1)


 model. The modulation format is QPSK. We 
show the simulation results in Figure 3. The channel matrix 
HSD
 on SD link is 2
 4
 and the channel matrix 
H SDi
 
in which the channel matrix for user i  is excluded from 
HSD
 becomes 1
 4
 in Figure 3. From (17), the nullity 
of 
H SDi
 is calculated as 
4
2
1
3, (
1,2)
n i
i


 


. The  
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
5
10
15
20
25
30
BER
Transmit SNR [dB]
SD link 2 times w/o DF relay
2×(4,2)×(1,1) MMSE w/ DF relay
2×(4,2)×(1,1) MLD w/ DF relay
89
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

 
Figure 3. BER characteristics of 4 (4,4) (1,1)


 model (Transmission rate 
to each user is 2 (bps/Hz).) 
 
size 
of 
block 
matrix 
Bi
 of 
user 
i
 becomes 
1 3, (
1,2)
i
i
m
n
i

 


 and the diversity order of each user 
stream is given by 
3, (
1,2)
i
i
m
n
i




. From Figure 3, 
“SD link 2 times w/o DF relay” shows the BER slope of 
about 
10 3
 /10 (dB)
 for the transmit SNR=5~15 (dB) and 
we see that the diversity order of 3 is almost obtained. 
When using the DF relay, we can also expect the diversity 
order of 3 on the RD link as in the SD link. Thus, if there is 
no error on the SR link, then we can say the diversity order 
of 6 is obtained on the BER after the bit LLR addition at 
each user. As the transmit SNR becomes higher, the errors 
on SR link decrease and the diversity order of 6 is more 
easily achievable at high SNR region. But in Figure 3, 
“MMSE w/ DF relay” shows the BER slope of about 
10 1
 / 2 (dB)
 for the transmit SNR=4~6 (dB) and “MLD w/ 
DF relay” shows the BER slope of about 
10 1
 / 2 (dB)
 for 
the transmit SNR=3~5 (dB). So by using DF relay, we 
know the diversity order of 5 is achieved in this SNR 
region. 
Next, we consider the case where the number of 
transmission antennas at BS is 
S
N  4
, the number of users 
u
N  2
 and the numbers of reception antennas of each user 
are 
1
2
2
m
 m

. The numbers of reception and transmission 
antennas at DF relay are 
R
4
M   and 
R
N  4
, respectively. 
We call this as 4 (4,4) (2,2)


 model. In this case, the 
optimum modulation formats which minimize the BER 
characteristics are selected under the constant transmission 
rate of 4 (bps/Hz) on the SD link. This means one stream 
transmission with BD+MRT using 16QAM or two stream 
transmission with BD+E-SDM using two QPSK’s is 
adaptively selected for given 
HSD
 [10]. Also, in case of 
two stream transmission using two QPSK’s, the optimum 
power assignment to the 1st and 2nd eigen mode channels 
which minimizes the BER is employed [10]. In this two 
stream transmission, the DF relay needs to know in advance 
the precoding matrix 
NSD
 for BD, the matrix 
SD
V  for the 
eigen mode transmission in E-SDM and the matrix 
CSD
 
for the power allocation factor to the 1st and 2nd eigen 
mode channels. Also, in order to make the bit LLR addition  
 
Figure 4. BER characteristics of 4 (4,4) (2,2)


 model (Transmission rate 
to each user is 4 (bps/Hz) and 16QAM or QPSK is optimally 
selected to minimize the BER.) 
at each user, the transmission rate on the RD link must 
coincide with the one on the SD link. Hence, BD+E-SDM 
transmission on RD link adopts the same transmission rate 
as in the SD link. The simulation results are shown in 
Figure 4. BD+E-SDM scheme is employed on the SD link 
and the size of block channel matrix for user i  becomes 
2
2 (
1,2)
i
i



B
 in Figure 4. The transmission to each 
user is done by one stream transmission with the maximum 
eigen value using 16QAM or two stream transmission with 
two different eigen values using two QPSK’s. Figure 4 
shows 
the 
average 
BER 
characteristics. 
In 
this 
4 (4,4) (2,2)


 model, like in Figure 2 and Figure 3, the 
use of DF relay and the bit LLR addition at each user 
during the 1st and 2nd time slots improve the diversity 
order and the BER characteristic when compared with the 2 
times transmission on the SD link without using relay. 
Next, we consider the case where the number of 
transmission antennas at BS is 
S
N  6
, the number of users 
u
N  2
 and the numbers of reception antennas of each user 
are 
1
2
3
m
 m
 . The numbers of reception and transmission 
antennas at DF relay are 
R
6
M   and 
R
N  6
, respectively. 
We call this as 6 (6,6) (3,3)


 model. This model is the 
extension 
of 
previous 
4 (4,4) (2,2)


 model. 
The 
transmission protocols are the same as the previous 
4 (4,4) (2,2)


 model. On the SD link, the size of block 
channel matrix for user i  becomes 
3 3 (
1,2)
i
i
 

Β
. For 
each user, one stream transmission with BD+MRT using 
64QAM, two stream transmission with BD+E-SDM using 
16QAM and QPSK, or three stream transmission with 
BD+E-SDM using three QPSK’s is adaptively selected for 
HSD
 under the constant transmission rate of 6 (bps/Hz). 
The RD link transmission uses the same bit transmission 
rate as in the SD link. We show the simulation results in 
Figure 5. When comparing the BER characteristics at 
6
BER
10
, “MMSE w/ DF relay” and “MLD w/ DF relay” 
improve the BER by 5 (dB) and 8 (dB), respectively 
compared with “SD link 2 times w/o DF relay.” We also  
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
5
10
15
20
BER
Transmit SNR [dB]
SD link 2 times w/o DF relay
4×(4,4)×(1,1) MMSE w/ DF relay
4×(4,4)×(1,1) MLD w/ DF relay
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
5
10
15
20
BER
Transmit SNR [dB]
SD link 2 times w/o DF relay
4×(4,4)×(2,2) MMSE w/ DF relay
4×(4,4)×(2,2) MLD w/ DF relay
90
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

 
Figure 5. BER characteristics of 6 (6,6) (3,3)


 model (Transmission rate 
to each user is 6 (bps/Hz) and 64QAM, 16QAM or QPSK is 
optimally selected to minimize the BER.) 
 
find the slope of BER curve of “MLD w/ DF relay” is 
steeper than “SD link 2 times w/o DF relay” and know the 
effectiveness of using DF relay as in the previous cases. 
Next, we consider the case where the number of 
transmission antennas at BS is 
S
8
N  , the number of users 
u
N  4
 and the numbers of reception antennas of each user 
are 
1
2
3
4
2
m
m
m
m




. The numbers of reception and 
transmission antennas at relay are 
R
8
M   and 
R
N  8
, 
respectively. We call this as 8 (8,8) (2,2,2,2)


 model. This 
model is the extension of previous 6 (6,6) (3,3)


 model 
to 
u
N  4
 users. The transmission protocols are the same 
as 
the 
previous 
4 (4,4) (2,2)


 and 
6 (6,6) (3,3)


 
models. On the SD link, the size of block channel matrix for 
user i  becomes 
2
2 (
1,2,3,4)
i
i



B
. For each user, one 
stream transmission with BD+MRT using 16QAM or two 
stream transmission with BD+E-SDM using two QPSK’s is 
adaptively 
selected 
for 
HSD
 under 
the 
constant 
transmission rate of 4 (bps/Hz). The RD link transmission 
uses the same transmission rate as in the SD link. We show 
the simulation results in Figure 6. In this 8 (8,8) (2,2,2,2)


 
model, the demodulation using MLD at relay becomes 
difficult because the number of searches in MLD becomes 
4
8
16
4
65536


 for the total 4~8 streams from the BS. So 
instead of using MLD, we employed the Sphere Decoding 
SE algorithm [23],[24] that can obtain the same Maximum 
Likelihood (ML) solution as the MLD with far less 
computational complexity. Like in Figures 2–5, the use of 
DF relay and the bit LLR addition at each user during the 
1st and 2nd time slots improve the diversity order and the 
BER characteristic compared with the 2 times transmission 
on SD link without using DF relay. When comparing the 
BER characteristics at 
6
BER
10
, “MMSE w/ DF relay” 
and “MLD w/ DF relay” improve the BER by 6 (dB) and 11 
(dB) respectively compared with “SD link 2 times w/o DF 
relay.” We also find the slope of BER curve of “MLD w/ 
DF relay” is steeper than “SD link 2 times w/o DF relay” 
and know the effectiveness of using DF relay as 
 
Figure 6. BER characteristics of 8 (8,8) (2,2,2,2)


 model  (Transmission 
rate to each user is 4 (bps/Hz) and 16QAM or QPSK is 
optimally selected to minimize the BER.) 
 
 
Figure 7. Comparison of number of path metric calculation at DF relay 
between MLD and Sphere Decoding in 8 (8,8) (2,2,2,2)


 
model  (Transmission rate to each user is 4 (bps/Hz) and 
16QAM or QPSK is optimally selected to minimize the BER.) 
 
in the previous cases. 
The effect of complexity reduction by using Sphere 
Decoding (SE algorithm in [23],[24]) in place of MLD at 
DF relay is shown in Figure 7. When MLD is employed at 
DF relay, the required number of path metric calculation for 
4 users is 
164
 65536
, however, by using Sphere Decoding 
it can be reduced to almost 100 and the large complexity 
reduction has been achieved. Also, the complexity reduction 
by Sphere Decoding becomes more prominent at higher 
transmit SNR. 
Next, we consider the case where the number of 
transmission antennas at BS is 
S
N  6
, the number of users 
u
N  2
 and the numbers of reception antennas of each user 
are 
1
2
3,
2
m
m


. The numbers of reception and 
transmission antennas at relay are 
R
M 5
 and 
R
N  4
, 
respectively. We call this as 6 (5,4) (3,2)


 model. On the 
SD link, the sizes of block channel matrices for user 1 and 
user 2 become 
SD1
3 4
 
B
 and 
SD2
 2 3

B
, respectively. 
For user 1, one stream transmission with BD+MRT using 
64QAM, two stream transmission with BD+E-SDM using  
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
5
10
15
20
BER
Transmit SNR [dB]
SD link 2 times w/o DF relay
6×(6,6)×(3,3) MMSE w/ DF relay
6×(3,3)×(3,3) MLD w/ DF relay
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
5
10
15
20
BER
Transmit SNR [dB]
SD link 2 times w/o DF relay
8×(8,8)×(2,2,2,2) MMSE w/ DF relay
8×(8,8)×(2,2,2,2) MLD w/ DF relay
1.E+01
1.E+02
1.E+03
1.E+04
1.E+05
1.E+06
0
5
10
15
20
Number of path metric calculation
Transmit SNR [dB]
MLD
Sphere Decoding (SE algorithm)
91
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

 
Figure 8. BER characteristics of 6 (5,4) (3,2) or18 (5,4) (3,2)




 model 
(Transmission rate to user 1 is 6 (bps/Hz) and 64QAM, 16QAM 
or QPSK is optimally selected to minimize the BER. 
Transmission rate to user 2 is 4(bps/Hz) and 16QAM or QPSK 
is optimally selected to minimize the BER.) 
 
16QAM and QPSK, or three stream transmission with 
BD+E-SDM using three QPSK’s is adaptively selected for 
HSD
 under the constant transmission rate of 6 (bps/Hz). 
For user 2, one stream transmission with BD+MRT using 
16QAM or two stream transmission with BD+E-SDM 
using two QPSK’s is adaptively selected for 
HSD
 under 
the constant transmission rate of 4 (bps/Hz). The numbers 
of reception and transmission antennas at relay is selected 
as 
R
M 5
 and 
R
N  4
, respectively and these antenna 
numbers are minimum required ones. This is because as the 
numbers of eigen streams for user 1 and user 2 on the SD 
link are 


SD1
min 3,4
3
L


 and 


SD2
min 2,3
2
L


, 
respectively, the minimum required number of reception 
antennas at relay should be 
R
3 2
5
M  

 for making 
MMSE nulling at relay. From (16) the number of 
transmission antennas at relay has to satisfy the condition 
R
D
min
N
N
m




1
2
m
m





1
2
min
,
m m
5
2
3



 and the 
minimum number of 
R
N  4
 is employed. On the RD link, 
the sizes of block channel matrices for user 1 and user 2 
become 
RD1
3 2
 
B
 and 
RD2
 2 1

B
, respectively. For 
user 1, one stream transmission with BD+MRT using 
64QAM or two stream transmission with BD+E-SDM 
using 16QAM and QPSK is adaptively selected for 
H RD
 
under the constant transmission rate of 6 (bps/Hz). For user 
2, one stream transmission with BD+MRT using 16QAM is 
only selected for 
HRD
 under the constant transmission 
rate of 4(bps/Hz). When the number of transmission 
antennas at BS is increased, the receive gain of each user on 
the SD link raises. Accordingly, we increased the number of 
transmission antennas at BS from 
S
N  6
 to 
S
N 18
 on 
this 
6
(5,4)
(3,2)


 model and compared the BER 
performance between 6
(5,4)
(3,2)


 and 18 (5,4) (3,2)


 
models. On the SD link of 18 (5,4) (3,2)


 model, the sizes 
of block channel matrices for user 1 and user 2 become 
SD1
3 16
 
B
 and 
SD2
 2 15

B
, respectively. The numbers 
of eigen streams on the SD link of user 1 and user 2 become  
 
Figure 9. BER characteristics of 18 (5,5) or(5,8)or (5,18) (3,2)


 model 
(Transmission rate to user 1 is 6 (bps/Hz) and 64QAM, 
16QAM or QPSK is optimally selected to minimize the BER. 
Transmission rate to user 2 is 4(bps/Hz) and 16QAM or QPSK 
is optimally selected to minimize the BER.) 
 


SD1
min 3,16
3
L


 and 


SD2
min 2,15
2
L


, respectively 
and these numbers of eigen streams are the same between 
6
(5,4)
(3,2)


 and 18 (5,4) (3,2)


 models. We show the 
simulation results in Figure 8. From Figure 8, we know that 
“ 6 (5,4) (3,2)


 MLD w/ DF relay” improves the BER by 2 
(dB) at 
6
BER
10
 compared with “ 6 (3,2)

SD link 2 
times w/o DF relay” and the effect of using DF relay is 
verified. On the other hand, regarding 18 (5,4) (3,2)


 
model, we observe that there is almost no BER difference 
between “18 (5,4) (3,2)


MLD w/ DF relay” and “18 (3,2)

SD link 2 times w/o DF relay,” thus we could not identify 
the effectiveness of using DF relay. This is considered that 
when the number of transmission antennas 
NS
 is 
increased from 6 to 18, the transmission quality of SD link 
surpasses the RD link and two times transmission on the SD 
link is enough even though the DF relay is not used. 
Next, we increased the number of transmission antennas 
of DF relay from
R
N  4
 to a larger number on 
18 (5,4) (3,2)


 model and examined the effectiveness of 
using DF relay. When 
R
N  5
, the number of eigen streams 
of user 1 and user 2 on the RD link become 
RD1
3
L
  and 
RD2
2
L

, respectively and the same pattern of adaptive 
modulation as the SD link can be employed. We show the 
simulation results in Figure 9. From Figure 9, we observe 
that the BER performance of “18 (5,5) (3,2)


 MLD w/ DF 
relay” is better than “18 (3,2)

 SD link 2 times w/o DF 
relay” and can verify the effectiveness of using DF relay 
even when the number of BS antennas is 
S
N 18
. When 
the number of transmission antennas at DF relay 
R
N  is 
further increased, we compared the BER performance 
between “ 18 (5,8) (3,2)


 MLD w/ DF relay” and 
“18 (5,18) (3,2)


 MLD w/ DF relay.” However, the BER 
characteristics are almost equal between them and 
R
N  8
 
seems enough and saturated number for the DF relay. 
Next, under the condition of 
S
N 18
 and with the same 
transmission rate, we investigated the required number of  
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
2
4
6
8
10
12
14
16
BER
Transmit SNR [dB]
6×(3,2) SD link 2 times w/o DF relay
6×(5,4)×(3,2) MLD w/ DF relay
18×(5,4)×(3,2) MLD w/ DF relay
18×(3,2) SD link 2 times w/o DF relay
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
1
2
3
4
5
BER
Transmit SNR [dB]
18×(3,2) SD link 2 times w/o DF relay
18×(5,5)×(3,2) MLD w/ DF relay
18×(5,8)×(3,2) MLD w/ DF relay
18×(5,18)×(3,2) MLD w/ DF relay
92
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

 
Figure 10. BER characteristics of 18 (4,4) or (4,5)
(2,2)


 and 
18 (6,5) or (6,6)
(3,3)


 model (Transmission rate to user 
1 is 6 (bps/Hz) and 64QAM, 16QAM or QPSK is optimally 
selected to minimize the BER. Transmission rate to user 2 is 4 
(bps/Hz) and 16QAM or QPSK is optimally selected to 
minimize the BER.) 
 
transmission antennas 
R
N  at DF relay to improve the BER 
performance. We considered 18 (2,2)

 and 
18 (3,3)

 
models on the SD link where two users have equally 2 and 3 
reception antennas, respectively. For 18 (2,2)

 SD link 
model, the block diagonalized matrix size of user i  becomes 
SD
2 16 (
1,2)
i
i



B
 and the number of eigen streams is given 
by 


SD
min 2,16
2
L i


(
i 1,2)
. This means the required 
number of reception antennas at DF relay is greater than 
R
2
2
4
M



 for the MMSE nulling. On the other hand, for 
18 (3,3)

 SD link model, the block diagonalized matrix size 
of user i  becomes 
SD
3 15 (
1,2)
i
i
 

B
 and the number of 
eigen streams is given by 


SD
min 3,15
3
L i


(
i 1,2)
. This 
means the required number of reception antennas at DF relay 
is greater than 
R
3
3
6
M


 . On the SD link of 18 (2,2)

, 
for user 1, one stream transmission with BD+MRT using 
64QAM or two stream transmission with BD+E-SDM using 
16QAM and QPSK is adaptively selected for 
HSD
 under the 
constant transmission rate of 6 (bps/Hz). For user 2, one stream 
transmission with BD+MRT using 16QAM or two stream 
transmission with BD+E-SDM using two QPSK’s is 
adaptively selected for 
HSD
 under the constant transmission 
rate of 4 (bps/Hz). On the SD link of 18 (3,3)

, for user 1, one 
stream transmission with BD+MRT using 64QAM, two stream 
transmission with BD+E-SDM using 16QAM and QPSK, or 
three stream transmission with BD+E-SDM using three 
QPSK’s is adaptively selected for 
HSD
 under the constant 
transmission rate of 6 (bps/Hz). For user 2, one stream 
transmission with BD+MRT using 16QAM, two stream 
transmission with BD+E-SDM using two QPSK’s or three 
stream transmission with BD+E-SDM using QPSK and two 
BPSK’s is adaptively selected for 
HSD
 under the constant 
transmission rate of 4 (bps/Hz). We show the simulation results 
in Figure 10. From Figure 10, regarding the 18 (2,2)

 SD 
link model, we observe the BER is improved in the order of 
 
Figure 11. BER characteristics of 8 (8,8) (2,2,2,2)


 or 24 (8,8)

 
(2,2,2,2)
model (Transmission rate to each user is 
6(bps/Hz) and  64QAM, 16QAM or QPSK is optimally 
selected to minimize the BER.) 
 
“18 (4,5) (2,2)


 MLD w/ DF relay”, “18 (2,2)

 SD link 2 
times w/o DF relay” and “18 (4,4) (2,2)


 MLD w/ DF 
relay.” This observation means that 
R
N  5
 is required to 
show the effectiveness of using DF relay rather than 
R
N  4
. 
Regarding the 18 (3,3)

SD link model, “ 18 (6,5) (3,3)


 
MLD w/ DF relay” shows almost the same BER 
characteristics as “18 (3,3)

 SD link 2 times w/o DF relay” 
and “18 (6,6) (3,3)


 MLD w/ DF relay” shows the best 
BER characteristics. Accordingly we can say that minimum 
R
6
N   is needed to show the effectiveness of using DF 
relay in this case. 
Next, we consider the case where the number of 
transmission antennas at BS is 
S
8
N  , the number of users 
u
N  4
 and the numbers of reception antennas of each user 
are 
1
2
3
4
2
m
m
m
m




. The numbers of receive and 
transmission antennas at relay is 
R
M 8
 and 
R
N  8
, 
respectively. We call this as 8 (8,8) (2,2,2,2)


 model. This 
model is the same as the previous Figure 6, but this time we 
extended the transmission rate from 4 (bps/Hz) to 6 (bps/Hz). 
On the SD link, the size of block channel matrix for user i  
becomes 
2
2 (
1,2,3,4)
i
i



B
. For each user, one stream 
transmission with BD+MRT using 64QAM or two stream 
transmission with BD+E-SDM using 16QAM and QPSK is 
adaptively selected for 
HSD
 under the constant transmission 
rate of 6 (bps/Hz). The RD link transmission uses the same 
transmission rate 6 (bps/Hz) as in the SD link. Moreover, 
regarding on 8 (8,8) (2,2,2,2)


 model, we increased the 
number of transmission antennas at BS from 
S
N  8
 to 
S
N  24
. We call this as 24 (8,8) (2,2,2,2)


 model. The size 
of block diagonalized matrix of user i  on the SD link 
becomes 
SD
2 18 (
1,2,3,4)
i
i



B
 and the number of eigen 
streams of user 
i  is given by 


SD
min 2,18
2
L i


(
i 1,2,3,4)
. Accordingly, the adaptive modulation is the same 
between 8 (8,8) (2,2,2,2)


 and 24 (8,8) (2,2,2,2)


. We 
show the simulation results in Figure 11. 
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
1
2
3
4
5
6
7
BER
Transmit SNR [dB]
18×(4,4)×(2,2) MLD w/ DF relay
18×(2,2) SD link 2 times w/o DF relay
18×(4,5)×(2,2) MLD w/ DF relay
18×(6,5)×(3,3) MLD w/ DF relay
18×(3,3) SD link 2 times w/o DF relay
18×(6,6)×(3,3) MLD w/ DF relay
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
5
10
15
20
25
BER
Transmit SNR [dB]
8×(2,2,2,2) SD link 2 times w/o DF relay
8×(8,8)×(2,2,2,2) MMSE w/ DF relay
24×(8,8)×(2,2,2,2) MMSE w/ DF relay
24×(2,2,2,2) SD link 2 times w/o DF relay
93
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

 
Figure 12. BER characteristics of 24 (8,9) or (8,11) or (8,21) (2,2,2,2)


 model 
(Transmission rate to each user is 6 (bps/Hz) and 64QAM, 
16QAM or QPSK is optimally selected to minimize the BER.) 
 
From Figure 11, the BER of 8 (8,8) (2,2,2,2)


 is superior 
to “8 (2,2,2,2)

SD link 2 times w/o DF relay” by 4 (dB) at 
6
BER
10
 and we see the effectiveness of using the DF 
relay. On the other hand, there is almost no BER difference 
between “ 24 (8,8) (2,2,2,2)


MMSE w/ DF relay” and 
“ 24 (2,2,2,2)

 SD link 2 times w/o DF relay,” and we could 
not see any effect of using the DF relay in this case. As 
stated before, this phenomenon comes from the fact that the 
SD link quality is better than the RD link due to the 
increased number of transmission antennas 
S
N  24
 at BS. 
Next, regarding 24 (8,8) (2,2,2,2)


 model, we increased 
the number of transmission antennas 
R
N  at DF relay. We 
show the simulation results in Figure 12. From Figure 12, 
compared with “ 24 (2,2,2,2)

 SD link 2 times w/o DF 
relay,” the BER is improved by using DF relay. But unlike 
the cases of “8 (2,2,2,2)

SD link 2 times w/o DF relay” and 
“8 (8,8) (2,2,2,2)


MMSE w/ DF relay” in Figure 11, the 
effect of using relay is not so large and there is no BER 
difference between “ 24 (8,11) (2,2,2,2)


 MMSE w/ DF 
relay” and “ 24 (8,21) (2,2,2,2)


 MMSE w/ DF relay.” 
From these observations, we know that 
R
11
N

 is the 
saturated number of transmission antennas at DF relay and 
when the number of transmission antennas at BS is large 
such as 
S
N  24
, the effect of using DF relay is limited. 
Next, we try to vary the number of reception antennas of 
each user under the condition that the number of 
transmission antennas at BS and the transmission rate of 
each user are unchanged from the previous figure, i.e., 
S
N  24
 and 6 (bps/Hz), respectively. On the SD link, we 
consider 
24 (3,3,2,2)

 model. The sizes of block 
diagonalized 
matrices 
of 
SD 
link 
are 
given 
by 
SD
3 17 (
1,2)
i
i
 

B
 and 
SD
2 16 (
3,4)
i
i



B
, respectively. 
The number of eigen streams of each user becomes


SD
min 3,17
3 (
1,2)
L i
i



 and 


SD
min 2,16
2 (
3,4)
L i
i



, 
respectively. For 
SD
3
L i

(
i 1,2)
, one stream transmission 
with BD+MRT using 64QAM, two stream transmission  
 
Figure 13. BER characteristics of 24 (10,11)or (10,14) or (10,24) (3,3,2,2)


 
model (Transmission rate to each user is 6 (bps/Hz) and 
64QAM, 16QAM or QPSK is optimally selected to minimize 
the BER.) 
 
with BD+E-SDM using 16QAM and QPSK, or three stream 
transmission with BD+E-SDM using three QPSK’s is 
adaptively 
selected 
for 
HSD
 under 
the 
constant 
transmission rate of 6 (bps/Hz). For 
SD
2
L i

(
i  3,4)
, one 
stream transmission with BD+MRT using 64QAM or two 
stream transmission with BD+E-SDM using 16QAM and 
QPSK is adaptively selected for 
HSD
 under the constant 
transmission 
rate 
of 
6 
(bps/Hz). 
The 
size 
of 
SD
3 17 (
1,2)
i
i
 

B
 in 24 (3,3,2,2)

 model is greater than 
SD
2 18 (
1,2,3,4)
i
i



B
 in 24 (2,2,2,2)

 model. On the 
other hand, 
SD
2 16 (
3,4)
i
i



B
 in 24 (3,3,2,2)

 model is 
a 
little 
bit 
less 
than 
SD
2 18 (
1,2,3,4)
i
i



B
 in 
24 (2,2,2,2)

 model. The minimum number of reception 
antennas at DF relay for MMSE nulling becomes 
R
3 3 2
M     2 10

. We show the simulation results in 
Figure 13. From Figure 13, we see almost the same 
observations as in Figure 12 and when the number of 
transmission antennas at BS is large such as 
S
N  24
, the 
effect of using DF relay is limited. 
V. CONCLUSIONS 
In this paper, we discussed the improvement of 
transmission quality when the DF relay is applied to the 
MU-MIMO down link system with the linear Block 
Diagonalization plus MRT or E-SDM scheme. By knowing 
the precoding matrix of BS at DF relay, the DF relay can 
demodulate the transmit signals from BS with the receive 
CSI only. As the existence of DF relay does not affect the 
design of precoding matrix at BS, we can add the DF relay 
only when the transmission quality between BS and user 
terminals is insufficient. By adding the DF relay and 
utilizing the 2nd time slot, we can improve the receive 
quality or diversity order of each user terminal. We made 
the designs of SD, SR and RD links during the 1st and the 
2nd time slots and verified the effectiveness of using DF 
relay. Although the SR link quality affects the total BER 
performance very much, we can utilize the simple MMSE 
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
1
2
3
4
5
6
BER
Transmit SNR [dB]
24×(2,2,2,2) SD link 2 times w/o DF relay
24×(8,9)×(2,2,2,2) MMSE w/ DF relay
24×(8,11)×(2,2,2,2) MMSE w/ DF relay
24×(8,21)×(2,2,2,2) MMSE w/ DF relay
1.E-06
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
1
2
3
4
5
6
7
BER
Transmit SNR [dB]
24×(3,3,2,2) SD link 2 times w/o DF relay
24×(10,11)×(3,3,2,2) MMSE w/ DF relay
24×(10,14)×(3,3,2,2) MMSE w/ DF relay
24×(10,24)×(3,3,2,2) MMSE w/ DF relay
94
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

nulling by increasing the number of reception antennas at 
DF relay to improve the SR link quality. We observed that 
even though the DF relay is equipped with the minimum 
number of reception and transmission antennas required, 
there exists the effect of using DF relay. But by increasing 
the number of transmission antennas at BS, the SD link 
quality is improved gradually resulting in the better SD link 
quality than the relaying SRD link. This large number of 
transmission antennas at BS finally limits the effect of using 
DF relay. 
ACKNOWLEDGEMENT 
This study is supported by the Grants-in-Aid for 
Scientific Research JP15K06059 of the Japan Society for 
the Promotion of Science and the Sharp cooperation. The 
authors also thank Mr. Kentaro Iida for his contributions. 
REFERENCES 
[1] K. Iida and Y. Iwanami, “A Regenerative Relay 
Transmission in Linearly Precoded MU-MIMO Downlink,” 
AICT2016, pp. 51-56, May, 2016. 
[2] N. Shimakawa and Y. Iwanami, “A Diversity Order Design 
of Linearly Precoded MU-MIMO Downlink System,” IEEE 
Region 10 Conference (TENCON), pp.1937-1949, Nov. 
2016. 
[3] H. S Quentin, B. P. Christian, and A. Lee Swindlehurst, M. 
Hardt, “An introduction to the multi-user MIMO downlink,” 
IEEE Communications Magazine, vol. 42, Issue 10, pp. 
60-67, Oct. 2004. 
[4] Q. H. Spencer, A. L. Swindlehurst, and M. Haardt, “Zero 
forcing methods for downlink spatial multiplexing in 
multiuser MIMO channels,” IEEE Trans. Sig. Processing, vol. 
52, no. 2, pp. 461-471, Feb.2004. 
[5] T. Haustein, C. von Helmolt, E. Jorswieck, V. Jungnickel, 
and V. Pohl, “Performance of MIMO systems with channel 
inversion,” IEEE 55th VTC Spring, vol. 1, pp. 35 – 39, 2002. 
[6] S. Vishwanath, N. Jindal, and A. Goldsmith, “Duality, 
achievable rates, and sum-rate capacity of MIMO broadcast 
channels,” IEEE Trans. Inform. Theory, vol. 49, no. 10, pp. 
2658–2668, Oct. 2003. 
[7] V. Stankovic and M. Haardt, “Successive optimization 
Tomlinson-Harashima precoding (SO THP) for multi-user 
MIMO systems,” IEEE International Conference on 
Acoustics, Speech, and Signal Processing, Proceedings 
(ICASSP '05), vol. 3, pp. iii/1117-iii/1120, March 2005. 
[8] C. B. Peel, B. M. Hochwald, and A. L. Swindlehurst, “A 
vector-perturbation technique for near-capacity multi antenna 
multiuser communication-part I: Channel inversion and 
regularization,” IEEE Trans. Commun., vol. 53, pp. 195-202, 
Jan. 2005. 
 
 
 
 
 
 
 
 
[9] C. B. Peel, B. M. Hochwald, and A. L. Swindlehurst, “A 
vector-perturbation technique for near-capacity multi antenna 
multiuser communication-part II: perturbation,” IEEE Trans. 
Commun., vol. 53, pp. 195–202, Jan. 2005. 
[10] K. Miyashita, T. Nishimura, T. Ohgane, Y. Ogawa, Y. 
Takatori, 
and 
K. 
Cho, 
“Eigenbeam-Space 
Division 
Multiplexing (E-SDM) in a MIMO Channel,” IEICE 
Technical Report，RCS2002−53，pp. 13−18，May 2002. 
[11] H. Sun, S. Meng, Y. Wan, and X. You, “Sum-rate evaluation 
of multi-user MIMO-relay channel,” IEICE Trans. Commun., 
vol. E-92-B, no. 2, pp. 683-686, Feb. 2009. 
[12] K. Nishimori, N. Honma, M. Mizoguchi, “Effectiveness of 
relay MIMO transmission in an actual outdoor environment,” 
IEICE Technical Report，RCS2008-228, pp. 95-100, March 
2009. 
[13] K. Fujii and T. Fujii, “Adjacent Cell Interference Reduction 
Using Multiuser MIMO Relay Station,” IEICE Technical 
Report, RCS2010-164, pp. 31-36, Dec. 2010. 
[14] W. 
Liu, 
C. 
Li, 
J.-D. 
Li, 
L. 
Hanzo, 
“Block 
diagonalization-based multiple input multiple output-aided 
downlink relaying,” IET Commun, vol. 6, Iss. 15, pp. 
2371-2377, 2012. 
[15] L. Liang, W. Xu, X. Dong, “Limited feedback-based 
multi-antenna 
relay 
broadcast 
channels 
with 
block 
diagonalization,” IEEE Trans. Wireless Commun., vol. 12, no. 
8, pp. 4092-4101, Aug. 2013. 
[16] Y. Tanahashi, Y. Iwanami, R. Yamada, and N. Okamoto, 
“Study on VP Transmission Schemes for Multiuser MIMO 
Downlink using Non-Regenerative Relay,” IEICE Technical 
Report, RCS2013-371, pp. 395-400, March 2014. 
[17] T. Taniguchi and Y. Karasawa, “An Elementary Study on 
Node Pair Selection in Relay-Aided Communication System 
Based on Stable Marriage Problem,” IEICE Technical Report, 
RCS2014-50, pp. 105-108, June 2014. 
[18] F. Benkhelifa, A. S. Salem, and M.-S. Alouini, “Sum-Rate 
Enhancement in Multiuser MIMO Decode-and-Forward 
Relay Broadcasting Channel With Energy Harvesting Relays,” 
IEEE Journal on Selected Areas in Commun., vol. 34, no. 12, 
pp. 3675-3683, Dec.2016. 
[19] G. Zhang and Y. Iwanami, “A design of communication 
quality in linearly precoded MU-MIMO downlink system,” 
IEICE Technical Report, RCS2015, March 2016. 
[20] T. K. Y. Lo, “Maximum Ratio Transmission,” IEEE Trans. 
Commun.,vol. 47, no. 10, pp. 1458-1461, Oct. 1999. 
[21] A. Paulraj, R. Nabar and D. Gore, Introduction to Space Time 
Wireless Communication, Cambridge University Press, 2008. 
[22] J. K. Cavers, “Single-User and Multiuser Adaptive Maximum 
Ratio Transmission for Rayleigh Channel,” IEEE Trans. on 
Vehicular Technology, vol. 49, No. 6, pp. 2043-2050, Nov. 
2000. 
[23] Z. 
Guo 
and 
P. 
Nilsson, 
“Reduced 
Complexity 
Schnorr-Euchner Decoding Algorithms for MIMO systems,” 
IEEE Communication Letters, vol. 8, no. 5, pp. 286-288, May 
2004. 
[24] B. Shim and I. Kang, “Sphere Decoding with a probabilistic 
tree pruning,” IEEE Transactions on Signal Processing, vol. 
56, no. 10, pp. 4867-4878, Oct. 2008. 
95
International Journal on Advances in Telecommunications, vol 10 no 3 & 4, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

