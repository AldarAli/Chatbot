A Quasi Real-Time Parallel FE Analysis of Masonry Walls
Franco Milicchio
Dept. of Informatics and Automation
Roma Tre University
Rome, Italy
milicchio@dia.uniroma3.it
Giovanni Formica
Dept. of Studies on Structures
Roma Tre University
Rome, Italy
formica@uniroma3.it
Abstract—We present a parallel implementation of a non-
linear ﬁnite element analysis of masonry walls. The imple-
mentation is based on a shared-memory architecture, while
the mechanical simulation is inspired by a model recently
developed for this type of structures. Such a model showed to
be both reliable and efﬁcient in predicting collapse mechanisms
for safety assessment purposes. Its formulation, as we will
explain, favors naturally a parallel implementation because the
collapse mechanisms are assumed independently for each Finite
Element (FE). Additionally, the non-linear response of the same
Element is offered at fast computations, because it is based on
average elasto-plastic stress distributions which well simulates
the more signiﬁcant mechanical criticisms, i.e., the frictional
toughness along squeezing lines.
Keywords-Finite element methods; Nonlinear systems; Par-
allel programming.
I. INTRODUCTION
In the ﬁeld of masonry mechanics, there was an extensive
production of research works across the last thirty years.
However, comparing the existing literature with other struc-
tural typologies such as concrete and steel structures, we
face an almost embarrassing bias, ﬁnding huge deﬁciencies
in both theory, practice, and numerical simulations. In fact,
except for reinforced masonry structures, these inadequacies
are still reﬂected in technical codes and predictive software
analysis tools, with dramatic results if we observe recent
collapses, such as the Umbrian-Marchigian earthquake in
1997, or in Mexican states of Puebla and Oaxaca in 1999, the
infamous Tehuacan earthquake, of magnitude 7, damaging
about 1800 historic buildings, among them several temples
and convents from early colonial era.
The complexity of simulating the behavior of masonry
structures is evident when investigating all available pre-
dictive tools. Masonry structures manifest different inhomo-
geneities that require computational approaches to account
for different scales, both in length and in time. Numerical
simulations struggle to grasp such features, as they cannot
be underestimated when extrapolating crucial information
on the overall local and global structural behavior: these
procedures are still far from being robust and accurate,
yielding acceptable results when dealing with full three-
dimensional analysis. Multiscale and algebraic multigrid
approaches (see [1], [2] and [3] for a reference) recently
emerged for masonry mechanics as a possible research direc-
tion, on the basis of simpliﬁed, yet complicated, similarities
with composite structures. A ﬁrst step on this track has been
recently published in [4]; however, the unstructured nature of
general mechanical problems dampen the efﬁciency of such
these methods, unless some ad-hoc solutions is adopted, as
proposed in [5], [1], and [6].
The present work presents a parallel implementation,
based on a shared-memory architecture, of a non-linear ﬁnite
element analysis of masonry walls. Fine-grained model-
ing accurately represent several mechanical features, while
coarse scale ones achieve better performances in terms of
computational time, while sacriﬁcing precision. An alterna-
tive approach has been previously proposed in [4], where
a ﬁne-scale model is employed in order to generate a
coarse-grained ﬁnite element formulation. Our objective is
to extend the previous work in order to achieve a quasi
real-time simulation, i.e., within a time-frame perceived as
“immediate”. To the best of our knowledge, no attempt has
been previously made in simulating the non-linear behavior
of masonry walls; however, several works lie in the ﬁeld of
real-time simulation, for example [7] in the ﬁeld of visco-
elastic materials, and [8] in the computer graphics area.
II. FINITE ELEMENT FORMULATION
Let us consider an equivalent continuum model, and let
us represent its linear elastic behavior by means of a ﬁne-
grained modeling of the overall masonry assembly. Such
identiﬁcation technique is known in literature as “reﬁned
Cauchy”, although several other alternative approaches have
been proposed (cf. [9]).
Then, let the constitutive Cauchy law be σ = Eε, where
σ and ε represent the 2nd order tensors of stress and linear
strain, respectively, and E being the 4th order elastic tensor.
Our reference ﬁner scale model, initially proposed in [10],
is comprised on an assembly of bricks, considered as rigid
bodies of dimensions h × b × s (i.e., height, width, and
thickness), connected to each other by means of a thick
mortar joint, modeled as elastic springs, with normal and
tangential stiffness, equal to E and G. Therefore, according
to the chosen identiﬁcation technique, both discrete and
continuum models possess the same homogeneous strain
71
ADVCOMP 2010 : The Fourth International Conference on Advanced Engineering Computing and Applications in Sciences
Copyright (c) IARIA, 2010               ISBN: 978-1-61208-101-4

patterns; the reference elementary volume will be comprised
of one brick, and six mortar joints connecting the reference
brick to all its neighboring ones. Additionally, as detailed
in [9], the rotational ﬁeld is obtained imposing the mo-
mentum balance on the reference elementary volume, thus
obtaining the components of the elastic tensor E as:
E1111
=
1
2
b + a
h + a
Gs(b + a)
2a
+ 2Es(h + a)
a

E2222
=
Es(h + a)
a
E1212
=
Gs(b+a)
2a

Es(b+a)
2a
+ 2 Gs(h+a)
a

1
2
b+a
h+a

Es(b+a)
2a
+ 2 Gs(h+a)
a

+ Gs(h+a)
a
E2121
=
E1212 ,
with all the remaining coefﬁcients being zero.
The FE formulation is based on the classical 5β element
(see, e.g., [11] and [9]), a quadrilateral assumed stress
mixed-form ﬁnite element. Let us indicate with (ξ, η) the
intrinsic coordinates, and with (x, y) the global ones; the
discretized displacement may be therefore expressed as the
following:
u := (ux, uy)⊤ = N(ξ, η)d ,
(1)
with
N(ξ, η) :=
 N1
0
. . .
N4
0
0
N1
. . .
0
N4

.
(2)
Functions Ni interpolate the displacement through 2×4 node
parameters, assembled in the vector d, with standard bilinear
interpolating functions. The masonry wall is then discretized
on a regular quadrangular mesh. The FE formulation is
locking free [12], its ﬁve stress parameters, collected in the
vector β, interpolating the stress as follows
σ := (σx, σy, σxy)⊤ = P(ξ, η)β ,
(3)
with
P(ξ, η) :=


1
0
0
η
0
0
1
0
0
ξ
0
0
1
0
0

 .
(4)
Finally, the compatibility and equilibrium conditions are
expressed as
Hβ − Qd
=
0
(5)
Q⊤β − p
=
0 ,
(6)
where
H :=
Z
Ωe
P ⊤E−1P ,
Q :=
Z
Ωe
P ⊤DN .
A. Non-linear Plasticity
The more signiﬁcant non-linearity is essentially on the
frictional behavior; we neglect the coupling with the damage
process. More sophisticated numerical simulations, based on
ﬁne-scale models and experimental evidences, show that the
frictional resistance plays an important role in the structural
response under cyclic loading conditions [10], [4], [13].
Within an elastoplastic model, a Mohr-Coulomb criterion
is employed in order to characterize the inelastic part of the
structural response. The key idea, based on the microplane
modeling, is reported in several works such as [14], [15].
The proposed model holds small-strain elastoplasticity and
thermodynamical frameworks, being plastic deformation the
only dissipative mechanism.
The frictional criterion is then described by the following
condition:
|τn| − c − µσn ≤ 0
(7)
where τn and σn are the shear and normal stress, respec-
tively, acting on a plane with normal vector n, while c and µ
are the cohesion and static friction coefﬁcient, respectively.
Since we are in a context of non-associated plasticity, we
can assume the increments ˙εp of plastic deformation to be
only in the shear direction, i.e.:
˙εp = ˙γ τn
|τn|
(8)
where ˙γ ≥ 0 is the increment of the plastic multiplier.
The yield surface f[σ] is completed by two conditions
bounding normal tension and compression, thus providing
the following elastic domain De:
De := {σ : f[σ] ≤ 0} ,
with
f[σ] :=





−c − µσn + |τn|
−σyt + σn
σyc + σn
(9)
where σyt and σyc are the tension and compression yield
normal stresses, respectively, and we deﬁne compressive
stress as negative.
Within the representation of the element stress ﬁeld, and
by means of the Haar-K´arm´an principle, we usually get the
admissible stress ﬁeld by controlling the stress level by (9)
at some Gauss points of each element, and then numerically
integrating on the same element. This is a standard way for
FE formulations in elastoplasticity, we anyway tested in our
numerical implementation.
We follow an alternative approach, which is less compu-
tationally expensive, yet accurate enough, as we will show.
Following [16], we reformulate the elastoplastic response of
the assumed stress FE by adopting a kinematic approach.
Such approach deﬁnes a discrete number of possible mech-
anisms, corresponding to the plastic deformations that the
72
ADVCOMP 2010 : The Fourth International Conference on Advanced Engineering Computing and Applications in Sciences
Copyright (c) IARIA, 2010               ISBN: 978-1-61208-101-4

Element exhibits. More speciﬁcally, within each element
we consider a set Se of possible “bands” (i.e., lines in the
2D element), along which the plastic deformation can take
place. This corresponds to ﬁx a discrete number of possible
directions ˙εpn, depending on the assumed band with normal
n ∈ Se. To deﬁne Se, we consider the possible collapse
mechanisms of a generic assembly of bricks contained in an
element. We choose ﬁve bands with their three associated
plastic mechanisms, as depicted in Figure 1.
Figure 1.
Possible mechanisms that a single FE represents.
Therefore, by imposing the yield conditions in (9) for
each band we deﬁne for each FE an envelop of planes in
the space of the discretized stress components (3).
III. NUMERICAL SOLVER
A. Overview
Our solver relies on the numerical properties exhibited
by non-linear elasto-plastic media. As suggested by the
currently available literature, our solver employs a path-
following algorithm in order to retrieve the non-linear equi-
librium path. The path-following technique [17], recovers
the equilibrium path, arising from a non-linear structural
response s, subject to a load p varying with a scalar term
λ, by means of the following alternative system:
(
r(u(ξ), λ(ξ)) = s(u(ξ)) − λ(ξ)p
g(u(ξ), λ(ξ)) = ξ ,
(10)
where g is a known constraining surface, and r represents
the equilibrium error.
The system expressed in (10) is then solved by means
of a predictor-corrector iterative scheme, starting with an
initial solution (u0 = 0, λ0 = 0). The solution is attained at
convergence on the k-th step in the j-th iteration, providing
the ensuing equilibrium point (uk+1 = uj∗, λk+1 = λj∗);
the predictor is a trial solution obtained by extrapolation of
previous solutions, while the employed corrector is based on
an iterative Newton-Raphson scheme:
rj
=
r(uj, λj) = s(uj) − λjp
˙λ
=
(u⊤p)−1u⊤rj
˙u
=
K−1rj + ˙λu
uj+1
=
uj + ˙u
λj+1
=
λj + ˙λ
The structural response s(uj) is evaluated by means of a
predictor-corrector scheme, as detailed in [4]. This solution
employs the Haar-K´arm´an principle, i.e.:
Φ(σ) := 1/2
Z
Ω
(¯σ − σ)⊤E−1(¯σ − σ) = min ,
(11)
for all equilibrated stress ¯σ.
B. Parallel Implementation
The solver described in the previous section was im-
plemented on a shared-memory architecture1, and in the
following we will outline the main components along with
a speed-up measurement.
First, we highlight the fact that initial and terminal op-
erations in FE analysis, i.e., the stiffness matrix assembly
and the output variable update processes, are inherently
parallelizable. The non-linear plastic analysis, however, is
comprised of parts that are not parallel in the strict sense.
A comprehensive diagram of the overall solver architecture
is pictured in Figure 2.
Matrix assembly and stress update, being the latter mod-
eled with an incremental algorithm, are carried out in
parallel by means of the reduction operation. The non-linear
structural response of the masonry wall can be easily carried
out in a parallel fashion.
The structural response s(u) needed to solve the sys-
tem (10), is evaluated by means of the Haar-K´arm´an prin-
ciple (11), i.e., formulating it as a quadratic programming
problem, as expressed in equation (11). The Haar-K´arm´an
principle is local to each element, and may be locally solved
1The software was implemented in C++ following the OpenMP 3.0
speciﬁcation; benchmarks were conducted on an Intel Core 2 Duo processor
at 2.9 GHz, with 4 GB of RAM.
73
ADVCOMP 2010 : The Fourth International Conference on Advanced Engineering Computing and Applications in Sciences
Copyright (c) IARIA, 2010               ISBN: 978-1-61208-101-4

Structural Response
Non-Linear Analysis
Solver (Banded Matrix)
Strain Update
Assembly
Plastic Analysis
Stress Update
Figure 2.
The numerical solver architecture (left), and a detailed plastic
analysis diagram (right). Multiple arrows indicate a parallel execution.
Table I
BENCHMARKS FOR THE PROPOSED PARALLEL FE SOLVER.
Threads
1
2
4
8
16
32
Time
2.75
1.68
1.04
0.97
0.65
0.43
Speed-up
1
1.64
2.64
2.83
4.22
6.37
iteratively, adopting the Goldfarb-Idnani method [18]: this
allows us to parallelize this process, up to the actual solution
of the system of linear equations arising from (10). As
pictured in Figure 2, the aforementioned system is solved
serially, while the ensuing strain update, and the subsequent
output variables, are na¨ıvely parallelized.
IV. RESULTS
The chosen test bed for our parallel implementation is the
Pavia’s test, an experimental test performed in the University
of Pavia [19]. The horizontal displacement employed in the
test is pictured in Figure 4, with the overall time of analysis
equal to 20 seconds. We mention in passing that a quasi
real-time process involves updates of the outcomes with a
minimal frequency of 20 Hz circa (cf., [7], [20], and [8]).
Results are reported in Table I, where we reported the
number of threads employed in the test bed, the overall time
for the nonlinear analysis, and the speed-up [21]; the latter
quantity has been calculated as S := Ti T −1
1
, i = 1, 2, . . .,
where i indicates the number of threads involved in the
analysis.
As expected by known theoretical results (cf. [22]
and [23]), we are obtaining a sub-linear speed-up, detailed in
Table I, and pictured in Figure 5. In order to better analyze
the results, we recall that quasi real-time requires updates
at 20 Hz, i.e., 0.05 seconds. Comparing the total analysis
time of 20 seconds, with the actual analysis process, we
obtain that our FE formulation allows us to obtain a quasi-
RT update with a number of threads equal or above four.
1 2
4
8
16
32
1
2
4
6
8
Figure 3.
Graph of the speed-up value plotted against the number of
processes (in solid black); graph of the linear ﬁt (dotted).
(iii) update t
Fig. 5. Pavia’s test
-25
-20
-15
-10
-5
0
5
10
15
20
25
displacement (mm)
time
Fig. 6. Horizontal displacement time history.
Fig. 7. Equilibrium
(a) the experimen
numerical simulat
Figure 4.
Graph of the horizontal displacement, measured in mm, with
respect to time. The arrow marks the last input cycle.
V. CLOSING REMARKS
We proposed in this manuscript a parallel implementation
of a FE formulation for the analysis of masonry walls
involving non-linear plasticity. Such implementation, based
on a shared-memory architecture, allows us to obtain results
in a quasi real-time fashion.
The proposed FE formulation relies on a ﬁne-grained
approach, where a detailed model is employed in the formu-
lation of coarser elements, grasping the non-linear mechanic
behavior and obtaining considerably better performances
compared to a na¨ıve ﬁner modeling approaches.
Coupling this novel multiscale approach to non-linear
plasticity, with a parallel implementation of the analysis
process, we are able to hold quasi real-time performances. A
future direction of research will investigate all the possible
issues affecting performances, clarifying the optimal number
of threads on speciﬁc architectures, and comparing standard
solvers with our custom solution.
74
ADVCOMP 2010 : The Fourth International Conference on Advanced Engineering Computing and Applications in Sciences
Copyright (c) IARIA, 2010               ISBN: 978-1-61208-101-4

Figure 5.
Rendering of the stress σxy for the last input cycle in the analysis, indicated with an arrow in Figure 4.
REFERENCES
[1] J. Fish and Q. Yu, “Multiscale damage modelling for com-
posite materials: theory and computational framework,” Int.
J. Numer. Meth. Eng., vol. 52, pp. 161–191, 2001.
[2] K. St¨uben, “A review of algebraic multigrid,” J. Comput.
Appl. Math., vol. 128, pp. 281–309, 2001.
[3] T. J. R. Hughes, L. Mazzei, A. A. Oberai, and A. A. Wray,
“The multiscale formulation of large eddy simulation: decay
of homogeneous turbulence,” Phys. Fluids, vol. 13, pp. 505–
512, 2001.
[4] S. Brasile, R. Casciaro, and G. Formica, “Multilevel approach
for brick masonry walls - Part I: A numerical strategy for the
nonlinear analysis,” Comput. Method. Appl. M., vol. 196, pp.
4934–4951, 2007.
[5] C. Miehe and C. G. Bayreuther, “On multiscale FE analyses
of heterogeneous structures: From homogenization to multi-
grid solvers,” Int. J. Numer. Meth. Eng., vol. 71, pp. 1135–
1180, 2007.
[6] F. Feyel, “A multilevel ﬁnite element method (FE2) to
describe the response of highly nonlinear structures using
generalized continua,” Comput. Method. Appl. M., vol. 192,
pp. 3233–3244, 2003.
[7] O. R. Astley and V. Hayward, “Real-time ﬁnite-elements
simulation of general visco-elastic materials for haptic presen-
tation,” in ROS ’97, IEEE/RJS Int. Conference on Intelligent
Robots and Systems, 1997, pp. 52–57.
[8] M. M¨uller, J. Dorsey, L. McMillan, R. Jagnow, and B. Cutler,
“Stable real-time deformations,” in SCA ’02: Proceedings
of the 2002 ACM SIGGRAPH/Eurographics symposium on
Computer animation.
New York, NY, USA: ACM, 2002,
pp. 49–54.
[9] G. Salerno and G. deFelice, “Continuum modeling of periodic
brickwork,” International Journal of Solids and Structures,
vol. 46, no. 5, pp. 1251–1267, 2009. [Online]. Avail-
able:
http://www.sciencedirect.com/science/article/B6VJS-
4TX33SP-3/2/3ee7f6bbe651cf544e768b4d8c6ba2bc
[10] G. Formica, V. Sansalone, and R. Casciaro, “A mixed solution
strategy for the nonlinear analysis of brick masonry walls,”
Computer Methods in Applied Mechanics and Engineering,
vol. 191, no. 51–52, pp. 5847–5876, 2002. [Online]. Avail-
able:
http://www.sciencedirect.com/science/article/B6V29-
478HYRR-1/2/ee021cbf69514b64abc145f7629b969c
[11] T. H. H. Pian and K. Sumihara, “Rational approach for
assumed stress ﬁnite elements,” International Journal for
Numerical Methods in Engineering, vol. 20, no. 9, pp. 1685–
1695, 1983.
[12] O. C. Zienkiewicz and R. L. Taylor, The Finite Ele-
ment Method for Solid and Structural Mechanics, 6th ed.
Butterworth-Heinemann, 2005.
75
ADVCOMP 2010 : The Fourth International Conference on Advanced Engineering Computing and Applications in Sciences
Copyright (c) IARIA, 2010               ISBN: 978-1-61208-101-4

[13] S. Brasile, R. Casciaro, and G. Formica, “Multilevel approach
for brick masonry walls - Part II: On the use of equivalent
continua,” Comput. Method. Appl. M., vol. 196, pp. 4801–
4810, 2007.
[14] I. Carol, M. Jir´asek, and Z. Baˇzant, “A thermodynamically
consistent approach to microplane theory. part i: free energy
and consistent microplane stresses,” Int. J. Solids Struct.,
vol. 38, pp. 2921–2931, 2001.
[15] E. Kuhl, P. Steinmann, and I. Carol, “A thermodynamically
consistent approach to microplane theory. Part II: Dissipation
and inelastic constitutive modelling,” Int. J. Solids Struct.,
vol. 38, pp. 2933–2952, 2001.
[16] S. Brasile, R. Casciaro, and G. Formica, “Finite element for-
mulation for nonlinear analysis of masonry walls,” Comput.
Struct., vol. 88, no. 3-4, pp. 135–143, 2010.
[17] E. Riks, “An incremental approach to the solution of snapping
and buckling problems,” Internat. J. Solids and Structures,
vol. 15, no. 7, pp. 529–551, 1979.
[18] D. Goldfarb and A. Idnani, “A numerically stable dual method
for solving strictly convex quadratic programs,” Mathematical
Programming, vol. 27, 1983.
[19] G. Magenes and G. Calvi, “In-plane seismic response of
brick masonry walls,” Earthquake Engineering & Structural
Dynamics, vol. 26, no. 11, pp. 1091–1112, 1997.
[20] P. A. Coe, A. Mitra, S. M. Gibson, D. F. Howell, and R. B.
Nickerson, “A study of geodetic grids for the continuous,
quasi real time alignment of the atlas semiconductor tracker,”
in Proceedings of the 7th International Workshop on Accel-
erator Alignment, November 2002.
[21] D. P. Bertsekas and J. N. Tsitsiklis, Parallel and Distributed
Computation: Numerical Methods.
Belmont, MA: Athena
Scientiﬁc, 1997.
[22] X.-H. Sun and L. M. Ni, “Another view on parallel speedup,”
in Supercomputing ’90: Proceedings of the 1990 ACM/IEEE
conference on Supercomputing.
Los Alamitos, CA, USA:
IEEE Computer Society Press, 1990, pp. 324–333.
[23] M. F. Adams, H. H. Bayraktar, T. M. Keaveny, and P. Pa-
padopoulos, “Ultrascalable implicit ﬁnite element analyses in
solid mechanics with over a half a billion degrees of freedom,”
in SC ’04: Proceedings of the 2004 ACM/IEEE conference on
Supercomputing.
Washington, DC, USA: IEEE Computer
Society, 2004, p. 34.
[24] J. Azevedo and G. Sincraian, “Modelling the seismic be-
haviour of monumental masonry structures,” in UNESCO
International Millennium Congress (Archi 2000), 2000.
[25] A. Cecchi, G. Milani, and A. Tralli, “A Reissner-Mindlin limit
analysis model for out-of-plane loaded running bond masonry
walls,” Int. J. Solids Struct., vol. 44, pp. 1438–1460, 2007.
[26] A. DiCarlo and S. Quiligotti, “Growth and balance,” Mech.
Res. Commun., vol. 29, pp. 449–456, 2002.
[27] L. Gambarotta and S. Lagomarsino, “A microcrack damage
model for brittle materials,” Int. J. Solids Struct., vol. 30, pp.
177–198, 1993.
[28] P. B. Lourenc¸o, G. Milani, A. Tralli, and A. Zucchini,
“Analysis of masonry structures: review of and recent trends
in homogenization techniques,” Can. J. Civil Eng., vol. 34,
pp. 1443–1457, 2007.
[29] H. R. Lofti and P. B. Shing, “An appraisal of smeared crack
models for masonry shear wall analysis,” Comput. Struct.,
vol. 41, pp. 413–425, 1991.
[30] T. J. Massart, R. H. J. Peerlings, and M. G. D. Geers, “An
enhanced multi-scale approach for masonry wall computa-
tions with localization of damage,” Int. J. Numer. Meth. Eng.,
vol. 69, pp. 1022–1059, 2007.
[31] G. Magenes and G. M. Calvi, “In-plane seismic response of
brick masonry walls,” Earthquake Eng. Struc., vol. 26, pp.
1091–1112, 1997.
[32] G. Magenes, G. M. Calvi, and R. Kingsley, “Seismic Testing
of a full-scale, two-story masonry building: test procedure
and measured experimental response,” in Experimental and
Numerical Investigation on a Brick Masonry Building Proto-
type - Numerical Prediction of the Experiment, Report 3.0,
G.N.D.T., 1995.
[33] U. Trottenberg, C. W. Oosterlee, and A. Sch¨uller, Multigrid.
Academic Press, 2001.
[34] E. O˜nate, “Multiscale computational analysis in mechanics
using ﬁnite calculus: an introduction,” Comput. Method. Appl.
M., vol. 192, pp. 3043–3059, 2003.
[35] M. E. Gurtin and B. D. Reddy, “Alternative formulations of
isotropic hardening for Mises materials, and associated
variational
inequalities,”
Continuum
Mechanics
and
Thermodynamics, vol. 21, no. 3, pp. 237–250, 2009. [Online].
Available: http://dx.doi.org/10.1007/s00161-009-0107-3
76
ADVCOMP 2010 : The Fourth International Conference on Advanced Engineering Computing and Applications in Sciences
Copyright (c) IARIA, 2010               ISBN: 978-1-61208-101-4

