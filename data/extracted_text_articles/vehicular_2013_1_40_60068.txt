Automatic Estimation of Moving Targets By MUSIC 
Algorithm Considering Doppler Effect  
Xin Wang 
Department of Electronic Engineering 
Chungbuk National University 
Cheongju, Korea 361-763 
wxzf007@naver.com 
 
 
Heung-Gyoon Ryu 
Department of Electronic Engineering 
Chungbuk National University 
Cheongju, Korea 361-763 
ecomm@cbu.ac.kr
Abstract — For the multiple users communication or multiple 
target detection, it is important to separate multiple targets or 
users that are included in the same communication or radar 
antenna beam. In this paper, a combined OFDM (orthogonal 
frequency division multiplexing) system and bandpass sampling 
method using MUSIC (multiple signal classification) algorithm 
for automatic AOA (angle of arrival) tracking is discussed. Also, 
we propose a new method of the time division multiplexing with 
bandpass sampling at the same time to avoid the interference due 
to the imperfect RF (radio frequency) filter characteristics. The 
main purpose of our proposed structure is to avoid the 
interference generated from the multi-band signals processing. 
Next, we consider the Doppler effect caused by the target 
movement in mobile environment. After compensating the 
Doppler effect with valid range, the system performance is 
improved. Computer simulation results show the performances 
of MUSIC spectrum for AOA in various conditions and 
demonstrate the accuracy of AOA estimations. 
Keywords-MUSIC; AOA; Bandpass sampling; OFDM; Doppler 
effect 
I. 
 INTRODUCTION  
Smart antenna is one of the possible solutions to increase 
the channel capacity due to an increase in the number of 
mobile 
units 
and 
the 
need 
for 
high-speed 
digital 
communication in mobile communication. Smart antenna 
utilizes the  beamforming technique to spatially direct the 
electromagnetic power to an intended mobile unit while 
spatially null the signal power along other mobile units.  The 
system needs the process of angle of arrival estimation to 
locate the mobile units before beamforming can be performed. 
Angle of arrival estimation technology play an important role 
in enhancing the performance of adaptive arrays for mobile 
wireless communications [1].  A number of angle of arrival 
estimation algorithms have been developed. The most recent 
ones are MUSIC [2] and ESPRIT (estimation of signal 
parameters 
via 
rotational 
invariance 
techniques) 
[3] 
algorithms; both utilize subspace-based exploitation of the 
Eigen structure of the input covariance matrix and thus require 
higher computation efforts. Although the ESPRIT needs less 
computation, the MUSIC algorithm is found to be more stable 
and accurate [4]. In this paper, we use the MUSIC algorithm 
combined with the OFDM bandpass sampling signal model to 
perform the antennas sensing for allowing the accurate 
azimuth. The accuracy of the estimation in azimuth increases 
proportionally to the number of antenna elements. 
Bandpass sampling can be used for direct down conversion 
without analog mixers. In practice, the required sampling rate 
for ADC (analog to digital converter) can be too high to be 
achieved if the Nyquist sampling theorem is considered [5]. 
So, we want to use bandpass sampling which samples the 
signals with smaller sampling rate than Nyquist sampling rate 
to relax the demand for ADC. After down-sampling about 
over two band signals using the bandpass sampling, the 
signals are digitized. Then, two band signals can be received   
[6].  
In the case of the conventional bandpass sampling receiver 
architecture, which we also refer to it as RF bandpass front-
end receiver architecture, the SDR (software defined radio) 
receiver design has been widely treated in the literature. In 
particular, in [7] and [8], RF bandpass sampling frontend for 
SDR is designed to place analog-to-digital converter as near 
the antenna as possible. From the point of view of receiver 
design, due to previous system [9], although over two signals 
can be down-sampling without interference between signals, it 
is possible to generate interference due to RF filter 
characteristics. RF filter cannot cut adjacent band signals so 
the remaining adjacent band signals (undesired signals) can 
affect desired signals. So, when the existing receiver 
architecture try to receiver the multi-band signals, it inevitably 
generates interference among the multi band signals, which 
can seriously damage the performance of the communication 
system. 
 In this paper, we propose a novel TDM (time division 
multiplexing) [10] based on the bandpass sampling RF(radio 
frequency) front-end receiver structure [5], and we compare it 
with the state-of-the-art systems. Our proposed structure can 
avoid the interference generated when doing the multi-band 
signals processing. The main motivation of our proposed 
structure is that we can reduce the complexity of 
the operation by using the TDM structure comparing with the 
existing structure.  
This paper is organized as follows. In Section II, the 
system model is introduced. In Section III, we consider the 
Doppler effect of the system and compensation. Section IV 
describes the existing structure as well as our proposed 
12
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-288-2
VEHICULAR 2013 : The Second International Conference on Advances in Vehicular Systems, Technologies and Applications

structure. Section V gives the simulation results, which show 
the performances of MUSIC spectrum for AOA in various 
conditions and demonstrate the accuracy of AOA estimations. 
In the end, Section VI gives the conclusions. 
II. 
SYSTEM MODEL 
A. OFDM Signal and Multi-Antenna Receiver 
In this paper, we consider two signals that have different 
center frequencies. Transmitted signals are based on OFDM. 
Eq. (1) is the signal in time domain. Let us assume that there 
are two received bands and there are both transmitted signals. 
Each band has different signals from each transmitter and 
,
A
Xk m
 and 
,
B
Xk m
are the transmitted signals, respectively. After 
an IFFT (inverse fast Fourier transform) processing, each band 
is represented in time domain as 
xA ( )
t  and 
xB ( )
t  and has 
center frequencies of 
Af  and 
Bf .  
2
1
(
)
,
0
2
1
(
)
,
0
1
,
( )
( )
1
,
( )
A
B
k
N
j
f
t
A
N
k m
A
k
k
N
j
f
t
B
N
k m
B
k
X
e
x
t
N
x t
X
e
x
t
N










 




                (1) 
The receiver is equipped with ULA (uniform linear array) 
of M elements located along a straight line. The system can be 
viewed as the multiplication of each received ray by a steering 
vector considering the direction of arrival of each multipath. 
Assume that there are P (P <M) uncorrelated narrowband 
signals 
px ( )
t received by ULA from different direction 
p
 , 
corrupted by AWGN (additive white Gaussian noise), where 
p=1,2… P. The observation is given as 
1
( )
(
)
( )
( )
P
p
p
p
X t
a
x
t
n t






                   (2) 
where  ( )
a   is the array steering vector given by  
2
sin /
2
sin (
1)/
( )
[1 e
e
]
j
d
j
d
M
T
a

 









    (3) 
where d  is the inter-element spacing,  is the signal 
wavelength. When we take a snapshot at time k=1,2…K, we 
can get  
1
( )
(
)
( )
( )
P
p
p
p
X k
a
x
k
n k






              (4) 
where noise 
( )
n k
is assumed to be both temporally and 
spatially white, and uncorrelated with  signal 
ps ( )
k . 
In Figure 1, two signals are received through multi-antenna 
receiver. After amplification of received signals in low-noise 
amplifier (LNA), each signal passes through RF filter. After 
band pass filter (BPF), each signal is sampled in time. The 
sampling frequency is smaller than Nyquist rate but larger than 
signal bandwidth of twice shown in Figure 1. TDM and 
bandpass sampling are processed at the same time. The digital 
oscillator is processed in the digital part; so, there are no 
problems that are generated by analog oscillator. After ADC 
and removing the cyclic prefix (CP), signals are processed 
through the MUSIC algorithm and the frequency domain 
equalization. 
 
 Figure 1. System Model. 
B. Angle of Arrival Estimation using MUSIC Algorithm 
MUSIC stands for MUltiple SIgnal Classification. The 
covariance matrix, R , is the collected data for each of the 
array receivers in the time domain.  The correlation matrix is 
given as [6] 
2
H
s H
R
E XX
AR A
 I







              (5) 
where 
s
R is the P
 P
 signal correlation matrix. 
 2
is the 
white noise power. The noise subspace 
N
E  used in MUSIC 
can be obtained from eigenvalue decomposition of  R , and 
the  spatial spectrum of  MUSIC is given by 
1
( )
( )
( )
H
H
N
N
P
a
E E a




                    (6) 
 
III. 
DOPPLER EFFECT AND COMPENSATION 
The orthogonality among the subcarriers is often destroyed 
by the carrier frequency offset due to the mismatching of 
oscillators between transmitters and receivers. Therefore, the 
Doppler effect is generated and degrades the communication 
performance. Doppler effect results in the frequency shift in 
frequency domain and is represented phase rotation in time 
domain. The signal x(t) is similar to Eq.(7) due to Doppler 
effect. 
                     
1
2
0
k
N
i
N
n
k
k
n
k
y
H
X
e
z










                   (7) 
13
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-288-2
VEHICULAR 2013 : The Second International Conference on Advances in Vehicular Systems, Technologies and Applications

The signal x(t) is like (8) due to Doppler effect in time 
domain. 
Channel H is represented as product of X. Doppler effect is 
represented as phase rotation in frequency domain. In Eq. (7), 
k, n, ε are sub-carrier, symbol, and the normalized Doppler 
frequency, respectively. 
       
(
)
1
1
2
2
,
,
0
0
(
)
1
1
2
2
2
,
,
0
0
k
m
N
N
i
i
N
N
p
k m
k m
p
m
k
k m
N
N
i
i
i
p
N
N
p
p
k m
k m
p
m
k
m k
Y
H
X
e
e
Z
H
X e
H
X
e
e
Z































 
 
    (8)    
    In (8), the first stage is phase rotation and the second stage 
is inter carrier interference (ICI), where p is symbol in 
frequency domain and k, m are sub-carrier before IFFT in 
transmitter and sample before FFT in receiver. Phase rotation 
of Doppler is different per symbol and ICI is generated when 
one sub-carrier affects other sub-carriers.  
The normalized offset value is found by division with the 
carrier spacing. We consider the direction of the receiver to be 
heading towards the transmitter.  
               
,
d
c
d
f
v f
f
carrier spacing
c




              (9) 
In this system, we compensate those problems with 
synchronization signal and block type pilot and it is assumed 
that the receiver speed is constant. fd, c, v are Doppler 
frequency, the velocity of light, and the speed of receiver, 
respectively.   
The problem of Doppler effect is compensated with block 
type pilot. The phase rotation is estimated by doing 
interpolation between pilots, because the receiver speed is not 
dramatically changed. 
                            
i2
p
p
p
p
p
Y
H
X
e
Z




                   (10) 
The phase rotation is estimated by using the received pilot 
signals. 
64
1
1
( )
_
(
1)
N
i
n
P i
mean
Block
Pilot i
n













 (11) 
  









1
1:
_
1
_
1,2,






angle P i
angle P i
pilot
interval
pilot
interval
i
  (12) 
P is average of block type pilot. Eq. (12) represents linear 
interpolation using P. So, the symbols that have no pilots are 
estimated. But, if there is too long pilot interval or Doppler 
frequency, it is difficult to compensate the effect.  
 
IV. 
PROPOSED BANDPASS SAMPLING METHOD 
A. Existing Structure 
The existing multi-band system with bandpass sampling 
finds sampling frequency that does not overlap signals 
between multi-band signals according to (7). But, to select 
multi-band signals, RF filter is used. Although RF filter has 
good Q value, the RF filter cannot remove all adjacent signals. 
So, the remaining adjacent signal is able to be overlap when 
multi-band signals are converted at low frequency band. 
Bandpass sampling about multi-band of over 2 bands meet 
condition like (13) [9]. To convert the two signals in low 
frequency band without interference between signals, FIF,A and 
FIF,B have to meet (13). 
 
 
Figure 2. The problem when signals are sub-sampled from RF band. 
,
,
,
,
,
,
,
,
,
,
,
,
0
/ 2,
/ 2
0
/ 2,
/ 2
/ 2
/ 2
/ 2
/ 2
IF A
A
S
IF A
A
IF B
B
S
IF B
B
IF B
IF A
IF B
B
IF A
A
IF A
IF B
IF A
A
IF B
B
F
BW
F
F
BW
F
BW
F
F
BW
if F
F
F
BW
F
BW
if F
F
F
BW
F
BW
















       (13) 
   At first, the signals that are converted into low frequency 
band are larger than 0 and smaller than Fs/2, respectively. 
Secondly, the low frequency part of FIF,A is larger than the 
high frequency part of FIF,B (FIF,B <FIF,A) or, the low frequency 
part of FIF,B (FIF,A >FIF,A) is larger than the high frequency part 
of FIF,A (FIF,B >FIF,A). 
B. Proposed  Structure 
We propose a method that adds TDM method into the 
bandpass sampling system. 
 
 
Figure 3. A multi-band receiver structure with bandpass sampling  and TDM 
method. 
 
The proposed structure is shown in Fig.3.  
     
,
,
,
,
0
/ 2,
/ 2
0
/ 2,
/ 2
IF A
A
S
IF A
A
IF B
B
S
IF B
B
F
BW
F
F
BW
F
BW
F
F
BW








        (14) 
Multi-band signals are received with antennas and the 
signals pass through LNA. Afterward, the multi-band signals 
are divided into two signals by filter. Each signal is sampled  
two times faster than the existing bandpass sampling 
frequency. After sampling processing in front of the ADC, 
TDM and bandpass sampling are performed at the same time. 
The signals that are received by TDM have no interference 
between the receiving signals because the signals are divided 
14
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-288-2
VEHICULAR 2013 : The Second International Conference on Advances in Vehicular Systems, Technologies and Applications

in time. Therefore, the converted signals just satisfy Eq. (14) 
instead of Eq. (13). So, it is possible to give an low sampling 
frequency. 
 Owing to our proposed algorithm, which adds TDM 
method using bandpass sampling in Eq.(14), we can reduce 
the complexity of operation by using the TDM structure 
comparing with the existing structure. Secondly, while by 
reducing the complexity of operation comparing Eq. (13) and 
Eq. (14), the system will relax its burden of hardware 
requirement and provide a faster processing speed than the 
existing structure. 
 
V. 
SIMULATION AND DISCUSSION 
Table 1 shows  the simulation parameters. OFDM signals 
using 4-QAM modulation are used in the simulation.  The 
number of  OFDM subcarrier is 64 and  the number of antenna 
is 8. 
TABLE I.  
SIMULATION PARAMETERS 
0
2
4
6
8
10
12
14
10
-4
10
-3
10
-2
10
-1
10
0
SNR (dB)
BER
 
 
Theory-AWGN
A band w comp(Doppler  =0.01)
B band w comp(Doppler  =0.01)
A band w/o comp(Doppler  =0.01)
B band w/o comp(Doppler  =0.01)
A band w comp(Doppler  =0.05)
B band w comp(Doppler  =0.05)
A band w/o comp(Doppler  =0.05)
B band w/o comp(Doppler  =0.05)
 
Figure 4. BER performance with Doppler effect. 
 
Fig. 4 shows the BER performance under the Doppler 
effect with two different normalized offset values 0.01 and  
0.05. Due to our proposed system, TDM can divide the multi-
band signals into time one and time two then we can see 
performance according to only one band at a time. For the 
situation of normalized offset value given as 0.01 according to 
both band A and B without compensation, we cannot 
communicate because of the heavily damaged phase rotation. 
Then, after compensating the phase rotation, our proposed 
system shows that comparing with the theory curve, the 
degradation is very small, which is caused by remaining ICI. 
So, we can recover the communication performance. When 
the normalized offset value is 0.05, the pilot signal is of block 
type and the linear interpolation is performed. It is difficult to 
estimate fast phase rotation. We cannot communicate well 
when both band A and B are too much seriously damaged in 
the phase rotation.  
-100
-50
0
50
100
-60
-50
-40
-30
-20
-10
0
DOA estimation
Direction angle（degree）
Spectral peak（dB）
 
 
4 antennas
8 antennas
16 antennas
Direction 1=10°
Direction 2=50°
SNR= 10dB
 
Figure 5. AOA estimation with array antenna numbers at SNR=10dB. 
 
Fig. 5 and Fig. 6 show the MUSIC AOA performance 
with the different array antenna numbers under the same SNR 
environment. We can see that, the larger the array antenna 
number is, the more accurately the system can separate the 
signals. The better performance shows the sharper shape. 
-100
-50
0
50
100
-70
-60
-50
-40
-30
-20
-10
0
DOA estimation
Direction angle（degree）
Spectral peak（dB）
 
 
4 antennas
8 antennas
16 antennas
Direction 1=10°
Direction 2=50°
SNR= 20dB
 
Figure 6.  AOA estimation with array antenna numbers at SNR=20dB. 
 
We evaluate the AOA estimations for two scenarios. One 
is to estimate the two mobile targets in a low speed 
environment, while the other considers the fast speed 
OFDM system 
The number of Subcarriers 
64 
Bandwidth 
20MHz 
Symbol Period 
4us 
Subcarrier Spacing 
312.5KHz 
CP Length 
0.8us 
Modulation 
4-QAM 
Channel 
AWGN 
Antenna Number 
8 
Antenna Type 
ULA 
Target A azimuth 
10° 
Target B azimuth 
50° 
15
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-288-2
VEHICULAR 2013 : The Second International Conference on Advances in Vehicular Systems, Technologies and Applications

environment. The parameters of both cases are shown in Table 
2 and Table 3.   
TABLE II.  
PARAMETERS OF TARGETS IN LOW SPEED ENVIRONMENT  
 
Target No 
Power(dB) 
AOA(degree)  
Velocity(m/s)
Target 1 
20 
25° 
20
（72km/H）
Target 2 
15 
24° 
18 
（64.8km/H）
 
23.5
24
24.5
25
25.5
17
18
19
20
21
0
1
2
3
4
5
6
x 10
8
Direction [degrees]
X: 25
Y: 20
Z: 5.369e+08
MUSIC  estimation
Radial speed [m/s]
 
Figure 7. Estimation of Target 1 by MUSIC algorithm in low speed. 
 
23.5
24
24.5
25
25.5
17
18
19
20
21
0
1
2
3
4
5
6
x 10
8
Direction [degrees]
MUSIC  estimation
X: 24
Y: 18
Z: 5.369e+08
Radial speed [m/s]
 
Figure 8. Estimation of Target 2 by MUSIC algorithm in low speed. 
 
Fig. 7 and Fig. 8 show the estimation performances of two 
targets in low speed environment. And we can see that both 
the two targets are estimated by MUSIC algorithm which 
indicates their DOAs and velocities in the labels. 
Fig. 9 and Fig. 10 show the estimation performances of 
two targets in the fast speed environment. We can see that 
both the two targets are estimated by MUSIC algorithm, 
which indicates their DOAs and velocities in the labels. 
TABLE III.  
PARAMETERS OF TARGETS IN FAST SPEED ENVIRONMENT 
 
Target No
Power(dB)
AOA(degree)  
Velocity(m/s)
Target 1 
20 
35° 
41.6
（150km/H）
Target 2 
15 
30° 
44.4 
（160km/H）
 
28
30
32
34
36
38
40
10
20
30
40
50
0
1
2
3
4
5
6
x 10
8
 
Direction [degrees]
MUSIC estimation
X: 35
Y: 41.6
Z: 5.369e+08
Radial speed [m/s]
 
 
Figure 9. Estimation of Target 1 by MUSIC algorithm in high speed. 
 
28
30
32
34
36
38
40
10
20
30
40
50
0
1
2
3
4
5
6
x 10
8
 
Direction [degrees]
MUSIC estimation
Radial speed [m/s]
X: 30
Y: 44.4
Z: 5.369e+08
 
 
Figure 10. Estimation of Target 2 by MUSIC algorithm in high speed. 
 
VI. 
CONCLUSIONS AND FUTURE WORK 
In this paper, we proposed a new TDM based bandpass 
sampling method for the mobile targets tracking using MUSIC 
algorithm. The proposal consists of time division multiplexing 
with bandpass sampling at the same time to avoid the 
16
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-288-2
VEHICULAR 2013 : The Second International Conference on Advances in Vehicular Systems, Technologies and Applications

interference due to the imperfect RF filter characteristics in the 
receiver side. The main motivation of our proposed structure 
is that it can reduce the complexity of operation by using the 
TDM structure comparing with the existing structure. By 
using MUSIC algorithm, we can estimate the AOA of the 
targets in both low speed environment and fast speed 
environment. When we consider the Doppler effect, the 
system 
using 
the 
proposed 
method 
improves 
the 
communication performances by compensating the Doppler 
effect. Finally, computer simulations show that MUSIC 
algorithm can accurately estimate the AOA of the two targets 
under different conditions. 
There are several directions that need to be investigated in 
the future. One of the directions is to improve the 
computational efficiency for covariance matrix of the 
conventional MUSIC algorithm. Other possible direction we 
want to explore is to improve the accuracy of the AOA 
estimation in the more complicated situation by considering 
other domain-related beamforming technology. 
 
 
                                ACKNOWLEDGEMENT 
 This research was supported by Basic Science Research 
Program through the National Research Foundation of Korea 
(NRF) funded by the Ministry of Education, Science and 
Technology (No. 2012017339) 
 
REFERENCES 
 
[1] R. Schmidt, “Multiple emitter location and signal 
parameter estimation,” IEEE Transactions on Antennas 
and Propagation, vol. 34, no. 3, pp. 276– 280, Mar. 1986. 
[2] A. Paulraj, R. Roy, and T. Kailath, “A subspace rotation 
approach to signal parameter estimation,” Proceedings of 
the IEEE, vol. 74, no. 7, pp. 1044 – 1046, July 1986. 
 
[3] T. Lavate, V. Kokate, and A. Sapkal, “Performance 
analysis of MUSIC and ESPRIT DoA estimation 
algorithms for adaptive array smart antenna in mobile 
communication,” International Journal of Computer 
Networks (IJCN), vol. 2, no. 3, pp. 152 – 172, July 2010. 
[4] R. H. Walden, “Performance trends for analog-to-digital 
converters,” IEEE Commun. Mag., vol. 37, no. 2, pp. 96-
101, Feb. 1999. 
[5] D. M. Akos, M. Stockmaster, J. B. Y. Tsui, and J. 
Caschera, “Direct bandpass sampling of multiple distinct 
RF signals,” IEEE Trans. on Commun., vol. 47, no. 7, pp. 
983-988, July 1999. 
[6] J. Wang,Y.J. Zhao, and Z.G. Wang.  “A MUSIC like 
DOA estimation method for signals with low SNR,” 
GSSM 2008, pp.321-324, April 2008. 
[7] R. Barrak, A. Ghazel, F. Ghannouchi, “Optimized 
Multistandard RF Subsampling Receiver Architecture,” 
IEEE Trans. on Wireless Commun, vol. 8, no. 6, pp.2901-
2909, June 2009. 
[8] H. J. Kim, J. U. Kim, J. H. Kim, H. M. Wang, I. S. Lee, 
“The Design Method and Performance Analysis of RF 
Subsampling Frontend for SDR/CR Receivers,” IEEE on 
Industrial Eletronics, vol. 57, no. 5, pp.1518-1525, Oct. 
2009. 
[9] Ching-Hsiang Tseng and Sun-Chung Chou, “Direct 
Downconversion of Multiband RF Signals Using 
Bandpass Sampling,” IEEE Trans. on Commun, vol. 5, 
no.1, pp.72-76, Jan. 2006. 
[10] Xin Wang and Heung-Gyoon Ryu,” Design of multi-band 
receiver 
with 
pre-FFT 
beamformer 
for 
wireless 
communications,” 2013 15th International Conference on 
Advanced 
Communication 
Technology 
(ICACT),  
pp.227-232, Jan. 2013. 
 
 
17
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-288-2
VEHICULAR 2013 : The Second International Conference on Advances in Vehicular Systems, Technologies and Applications

