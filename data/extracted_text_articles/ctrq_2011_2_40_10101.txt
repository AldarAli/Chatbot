A Robust Periodogram-based IFO Estimation Scheme
for OFDM-based Wireless Systems
Seung Goo Kang, Dahae Chong, Youngyoon Lee, and Seokho Yoon†
School of Information and Communication Engineering, Sungkyunkwan University, Suwon, Korea
Email: {general85, lvjs1019, news8876, and †syoon}@skku.edu
†Corresponding author
Abstract—In this paper, we propose a new periodogram-
based integer frequency offset (IFO) estimation scheme robust
to the fractional frequency offset (FFO) variation. We ﬁrst
observe the reason why the conventional IFO estimation scheme
in [10] is sensitive to the variation of the FFO, and then, propose
a new IFO estimation scheme using the modiﬁed maximum-
likelihood (ML) metric. The numerical results demonstrate
that the proposed scheme is more robust to the variation of
the FFO and has better IFO estimation performance than the
conventional scheme in [10].
Keywords-estimation; frequency offset; OFDM; training
symbol
I. INTRODUCTION
Due to its immunity to multipath fading and high spec-
tral efﬁciency, orthogonal frequency division multiplexing
(OFDM) has been adopted as a modulation format in a
wide variety of wireless systems such as digital video
broadcasting-terrestrial (DVB-T), wireless local area net-
work (WLAN), and worldwide interoperability for mi-
crowave access (WiMAX) [1]-[4]. However, the OFDM is
very sensitive to the frequency offset caused by Doppler
shift or oscillator instabilities, and thus, the frequency offset
estimation is one of the most important technical issues in
OFDM-based wireless systems [5], [6].
Various schemes [7]-[9] on the frequency offset estimation
have been proposed so far. Schmidl and Cox (SC) proposed a
frequency offset estimation scheme using a training symbol
with two identical halves [7], whose estimation range is
equal to the sub-carrier spacing. In [8], a new frequency
offset estimation scheme that utilizes a training symbol with
more than two identical parts was proposed, increasing the
estimation range twice that of the SC scheme. However, the
optimality for the estimation accuracy was not considered
in the scheme in [8]. With the maximum-likelihood (ML)
criterion, in [9], the optimal scheme for frequency offset
estimation was derived using the same training symbol as
in [8]. The scheme in [9] offers high estimation accuracy
with the same estimation range as in the scheme in [8].
However, these schemes require a special training symbol
structure, thus decreasing the transmission efﬁciency.
Recently, in [10], a periodogram-based frequency offset
estimation scheme was proposed, which has the estimation
range as large as the bandwidth of the OFDM symbol
while maintaining the same performance as those of the
schemes based on training symbols. However, its estimation
performance for the integer part of the frequency offset
(normalized to the sub-carrier spacing) rapidly changes
according to the value of the fractional part of the frequency
offset, eventually resulting in a signiﬁcant variation in the
overall frequency offset estimation performance.
Thus, in this paper, we propose a new integer frequency
offset (IFO) estimation scheme robust to the fractional
frequency offset (FFO) variation. We ﬁrst investigate the
inﬂuence of the FFO on the IFO estimation scheme in [10],
and then, propose a modiﬁed ML IFO estimation scheme.
The numerical results show that the proposed IFO estimation
scheme is more robust to the variation of the FFO and has
better performance than the IFO estimation scheme in [10].
II. SIGNAL MODEL
The nth transmitted complex-valued OFDM sample x(n)
is generated by using the inverse fast Fourier transform
(IFFT), and thus, can be expressed as
x(n) =
1
√
N
N−1
X
k=0
Xkej2πkn/N,
n = 0, 1, · · · , N −1, (1)
where N is the size of the IFFT and Xk is a phase shift
keying (PSK) or a quadrature amplitude modulation (QAM)
symbol in the kth sub-carrier. The data part of the OFDM
symbol has a duration of T seconds, and the cyclic preﬁx
(CP), whose length is generally designed to be longer than
the channel impulse response, is inserted in order to avoid
the intersymbol interference (ISI).
The nth received OFDM sample r(n) is obtained by
sampling the received OFDM signal every Ts = T/N
seconds and is expressed as
r(n) = s(n)ej2π(εI+εF )n/N + w(n),
(2)
where s(n) = PL−1
k=0 hkx(n − k) is the signal component
with the kth channel ﬁlter tap coefﬁcient hk and the channel
memory size L, εI and εF represent the IFO and FFO
normalized to the sub-carrier spacing 1/T, respectively,
and w(n) is the complex-valued additive white Gaussian
43
CTRQ 2011 : The Fourth International Conference on Communication Theory, Reliability, and Quality of Service
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-126-7

noise (AWGN) sample with mean zero and variance σ2
w =
E{|w(n)|2}, where E{·} and | · | denote the expectation
and absolute value operators, respectively. In this paper, we
assume that the channel is static during one OFDM signal
period and timing synchronization is perfect.
III. PROPOSED SCHEME
A. Inﬂuence of the FFO on the IFO estimation
In [10], the estimates ˆεI and ˆεF of the IFO and FFO are
obtained as
ˆεI = arg max
fk
©
I(fk) + I(fk + 1)
ª
(3)
and
ˆεF =
p
I(ˆεI + 1)
p
I(ˆεI) +
p
I(ˆεI + 1)
,
(4)
respectively, where ‘arg’ is the argument operation and
I(fk) is the signal periodogram deﬁned as
I(fk) =
¯¯¯¯¯
N−1
X
n=0
r(n)e(n)e−j2πfkn/N
¯¯¯¯¯
2
,
(5)
where fk ∈ {− N
2 , − N
2 + 1, · · · , N
2 − 1} is the kth IFO
candidate and e(n) =
x(n)∗
∥x(n)∥2 with the complex conjugate
‘∗’ and Euclidean norm ∥ · ∥ is the envelope equalized
processing factor employed to remove the data modulation
effect.
In the absence of the noise, ˆεF is given by
Z(ˆεI)
Z(ˆεI)+Z(ˆεI+1),
where Z(α) = | sin(π(ε−α)/N)|, and is drawn as a function
of ε − ˆεI as shown in Fig. 1, where ε = εI + εF is the real
frequency offset. It is seen from the Fig. 1 that the FFO can
be correctly estimated only when 0 ≤ ε − ˆεI < 1, that is,
when ˆεI ∈ (ε − 1, ε].
Fig. 2 shows the IFO metric {I(f) + I(f + 1)} nor-
malized to N 2∥h0∥2 as a function of the frequency f ∈
[−N/2, N/2) for εF
=
0.4 and 0.8 when εI
=
1,
N = 8, and the noise is absent, where ‘◦’ represents the
IFO metric value corresponding to each fk and the shaded
region represents the range of ˆεI ∈ (ε − 1, ε] for a correct
estimation of the FFO. In this paper, the correct estimation
probability of the IFO is deﬁned as the probability that the
maximum IFO metric corresponds to fk within the shaded
region. From the Fig. 2, we can clearly see that the correct
estimation probability of the IFO would be very sensitive to
the variation of the FFO, since the ratio of the IFO metric
value corresponding to fk within the shaded region to the
largest one among the IFO metric values corresponding to
fks’ outside the shaded region rapidly changes according to
the value of the FFO: speciﬁcally, the ratio when εF = 0.4
is larger than that when εF = 0.8, and thus, the correct
estimation probability of the IFO would be higher when
εF = 0.4 than when εF = 0.8.
-0.5
0
0.5
1
1.5
-0.5
0
0.5
1
1.5
-0.5
0
0.5
1
1.5
-0.5
0
0.5
1
1.5
ˆI
H
H

ˆF
H
Figure 1.
ˆεF as a function of ε − ˆεI in [10].
-4
-3
-2
-1
0
1
2
3
0.5
1
f
 !
 
!
"
#
2
2
0
1
1
I f
I f
N
h
$
$
 
!
 
!
"
#
2
2
0
1
1
k
k
I f
I f
N
h
$
$
-4
-3
-2
-1
0
1
2
3
0
0.5
1
f
 !
 
!
"
#
2
2
0
1
1
I f
I f
N
h
$
$
 
!
 
!
"
#
2
2
0
1
1
k
k
I f
I f
N
h
$
$
(a) When
0.4
%
&
F
(b) When
0.8
%
&
F
0
Normalized IFO metric
Normalized IFO metric
Figure 2.
IFO metric {I(f) + I(f + 1)} normalized to N2∥h0∥2 as a
function of the frequency f ∈ [−N/2, N/2) for εF = 0.4 and 0.8 when
εI = 1, N = 8, and the noise is absent.
B. Proposed IFO Estimation Scheme
From the discussions in the previous section, we can see
that the periodogram-based IFO estimation problem can be
modeled as a detection problem of a single tone with the
maximum energy. Then, the IFO estimate can be obtained
as
ˆεI = arg max
fk I(fk),
(6)
which is in fact the ML solution for detecting a single tone
with the maximum energy [11] and its normalized metric
value is shown as a function of f in Fig. 3, where it is
clearly observed that the correct estimation probability of
the IFO would be still very sensitive to the FFO variation as
that corresponding to (3), since (6) is an ML solution that
does not take the FFO into account. Also, we can observe
that the shaded region is always equal to the left slope of
the normalized IFO metric graph in Fig. 3, and thus, through
the some shift operation, the normalized IFO metric value in
the shaded region can be increased regardless of the value
44
CTRQ 2011 : The Fourth International Conference on Communication Theory, Reliability, and Quality of Service
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-126-7

0.5
1
-4
-3
-2
-1
0
1
2
3
f
 !
2
2
0
1
I f
N
h
 
!
2
2
0
1
I fk
N
h
0
0.5
1
-4
-3
-2
-1
0
1
2
3
f
 !
2
2
0
1
I f
N
h
 
!
2
2
0
1
I fk
N
h
0
(a) When
0.4
"
#
F
(b) When
0.8
"
#
F
Normalized IFO metric
Normalized IFO metric
Figure 3.
IFO metric I(f) normalized to N2∥h0∥2 as a function of the
frequency f ∈ [−N/2, N/2) for εF = 0.4 and 0.8 when εI = 1, N = 8,
and the noise is absent.
0.5
1
f
-4
-3
-2
-1
0
1
2
3
 
!
2
2
0
1
0.5
I f
N
h
"
 
!
2
2
0
1
0.5
I fk
N
h
"
0
0.5
1
-4
-3
-2
-1
0
1
2
3
 
!
2
2
0
1
0.5
I f
N
h
"
 
!
2
2
0
1
0.5
I fk
N
h
"
f
0
(a) When
0.4
#
$
F
(b) When
0.8
#
$
F
Normalized IFO metric
Normalized IFO metric
Figure 4.
IFO metric I(f + 0.5) normalized to N2∥h0∥2 as a function
of the frequency f ∈ [−N/2, N/2) for εF = 0.4 and 0.8 when εI = 1,
N = 8, and the noise is absent.
of the FFO. Based on these observations, we propose the
following modiﬁed ML IFO estimation scheme
ˆεI = arg max
fk I(fk + 0.5),
(7)
which is the shifted version of (6) to the left by 0.5 and its
metric I(f +0.5) always has the maximum value within the
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
0
0.2
0.4
0.6
0.8
1
Detection Probability
F
H
Conventional
Proposed
Figure 5.
Correct estimation probabilities of the IFO as a function of the
FFO for the proposed and conventional schemes in the AWGN channel
model when SNR is 0 dB.
shaded region regardless of the value of the FFO as shown
in Fig. 4 since the length of the shaded region is 1 and the
FFO is distributed uniformly over [0, 1). Thus, the correct
estimation probability of the IFO in the proposed scheme is
expected to be robust to the FFO variation.
IV. NUMERICAL RESULTS
In this section, we compare the performance of the pro-
posed IFO estimation scheme with the conventional scheme
in [10]. In the simulation, we assume the following pa-
rameters: quadrature PSK (QPSK) modulated data sequence
{Xk}N−1
k=0 , the FFT size of N = 64, a CP with a length
of 8 samples, and the maximum Doppler shift of 125 Hz
(corresponding to a mobile speed of 54 km/h and a carrier
frequency of 2.5 GHz used for WiMAX). The signal to noise
ratio (SNR) is deﬁned as σ2
s/σ2
w with σ2
s ≜ E{|s(n)|2}.
We consider AWGN and four-path Rayleigh fading channel
models with path delays of 0, 2, 4, and 6 samples and
exponential power delay proﬁle of E{A2
l } = exp(−0.768l)
(i.e., the power ratio of the ﬁrst and last paths is set to be
10 dB).
Figs. 5 and 6 show the correct estimation probabilities
of the IFO as a function of the FFO for the proposed and
conventional schemes. As expected, the proposed scheme
is more robust to the FFO variation than the conventional
scheme. In addition, we can see that the proposed scheme
signiﬁcantly outperform the conventional scheme. This can
be explained as follows. Since the proposed IFO metric is
based on a single periodogram, it has only a single peak
and can exploit it for detection. On the other hand, the
conventional scheme uses the sum of two periodograms,
and thus, has two peaks in the metric. The two peaks
increase the metric value corresponding to the correct IFO
candidate; however, they also increase the metric values
45
CTRQ 2011 : The Fourth International Conference on Communication Theory, Reliability, and Quality of Service
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-126-7

0
0.2
0.4
0.6
0.8
1
Detection Probability
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
F
H
Conventional
Proposed
Figure 6.
Correct estimation probabilities of the IFO as a function of the
FFO for the proposed and conventional schemes in the Rayleigh fading
channel model when SNR is 5 dB.
corresponding to the incorrect IFO candidates located on
both sides of the correct IFO candidate, thus resulting in a
higher incorrect estimation probability (i.e., a lower correct
estimation probability) of the IFO.
V. CONCLUSION AND FUTURE WORKS
In this paper, we have proposed a new IFO estimation
scheme robust to the FFO variation. We have ﬁrst studied
the inﬂuence of the FFO on the conventional IFO estimation
scheme in [10], and then, proposed a modiﬁed ML IFO
estimation scheme. By using efﬁciently shifted version of
ML metric, the proposed scheme always has the maximum
metric within the correct estimation range regardless of the
value of the FFO. From the numerical results, it is conﬁrmed
that the proposed scheme is more robust to the variation of
the FFO and has better IFO estimation performance than the
conventional scheme in [10].
ACKNOWLEDGMENT
This research was supported by the National Research
Foundation (NRF) of Korea under Grant 2010-0014610
with funding from the Ministry of Education, Science
and Technology (MEST), Korea, and by the Information
Technology Research Center program of the National IT
Industry Promotion Agency under Grant NIPA-2010-C1090-
1011-0005 with funding from the Ministry of Knowledge
Economy, Korea.
REFERENCES
[1] K.-T. Lee and J.-S. Seo, “Pilot-aided iterative frequency offset
estimation for digital video broadcasting (DVB) systems,”
IEEE Trans. Consumer Electron., vol. 53, no. 1, pp. 11-16,
Feb. 2007.
[2] M. Morelli, C.-C. J. Kuo, and M. O. Pun, “Synchronization
techniques for orthogonal frequency division multiple access
(OFDMA): a tutorial review,” Proc. IEEE, vol. 95, no. 7, pp.
1394-1427, July 2007.
[3] A. Filippi and S. Serbetli, “OFDM symbol synchronization
using frequency domain pilots in time domain,” IEEE Trans.
Wireless Commun., vol. 8, no. 6, pp. 3240-3248, June 2009.
[4] K. Cai, X. Li, J. Du, Y.-C. Wu, and F. Gao, “CFO estimation in
OFDM systems under timing and channel length uncertainties
with model averaging,” IEEE Trans. Wireless Commun., vol.
9, no. 3, pp. 970-974, Mar. 2010.
[5] T. Pollet, M. V. Bladel, and M. Moeneclaey, “BER sensitivity
of OFDM to carrier frequency offset and Wiener phase noise,”
IEEE Trans. Commun., vol. 43, no. 2, pp. 191-193, Feb. 1995.
[6] M. Morelli and M. Moretti, “Fine carrier and sampling fre-
quency synchronization in OFDM systems,” IEEE Trans. Wire-
less Commun., vol. 9, no. 4, pp. 1514-1524, Apr. 2010.
[7] T. M. Schmidl and D. C. Cox, “Robust frequency and timing
synchronization for OFDM,” IEEE Trans. Commun., vol. 45,
no. 12, pp. 1613-1621, Dec. 1997.
[8] S. Chang and E. J. Powers, “Efﬁcient frequency-offset estima-
tion in OFDM-based WLAN systems,” Electron. Lett., vol. 39,
no. 21, pp. 1554-1555, Oct. 2003.
[9] M.-H. Cheng and C.-C. Chou, “Maximum-likelihood estima-
tion of frequency and time offsets in OFDM systems with
multiple sets of identical data,” IEEE Trans. Sig. Process., vol.
54, no. 7, pp. 2848-2852, July 2006.
[10] G. Ren, Y. Chang, H. Zhang, and H. Zhang, “An efﬁcient
frequency offset estimation method with a large range for
wireless OFDM systems,” IEEE Trans. Vehic. Technol., vol.
56, no. 4, pp. 1892-1895, July 2007.
[11] A. Milewski, “Periodic sequences with optimal properties for
channel estimation and fast start-up equalization,” IBM J. Res.
Develop., vol. 27, no. 5, pp. 426-431, Sep. 1983.
46
CTRQ 2011 : The Fourth International Conference on Communication Theory, Reliability, and Quality of Service
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-126-7

