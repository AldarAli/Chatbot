A New Preamble Aided Fractional Frequency Offset Estimation in OFDM Systems
Soumitra Bhowmick, K.Vasudevan
Department of Electrical Engineering
Indian Institute of Technology
Kanpur, India 208016
Abstract—Carrier frequency offset (CFO) in OFDM systems
can be divided in two parts, the fractional part (FFO) and
the integer part (IFO). In this paper, a data aided fractional
frequency offset (FFO) synchronization scheme for OFDM system
is proposed. Four different algorithms to estimate the FFO are
proposed. The proposed algorithms work in the time domain. An
independent Rayleigh fading multipath channel in the presence of
AWGN is considered. The performance is compared in terms of
mean square error (MSE) of the frequency offset estimation and
the computational complexity with the existing FFO estimation
methods.
Keywords—Carrier frequency offset (CFO); Frequency synchro-
nization; OFDM; Preamble.
I.
INTRODUCTION
It is well known that orthogonal frequency division multi-
plexing (OFDM) [1] converts a frequency selective (multipath)
channel into a frequency ﬂat channel, thereby eliminating in-
tersymbol interference (ISI). However, the presence of a carrier
frequency offset (CFO) introduces inter carrier interference
(ICI), which severely degrades the performance of OFDM.
There have been several methods proposed in the litera-
ture for solving the problem of CFO estimation in OFDM
systems. In [2]–[5] the frequency offset is assumed to be a
uniformly distributed random variable over a certain range, and
is detected using maximum likelihood techniques. In the other
papers CFO is usually divided into two parts: the fractional
part (FFO) and the integer part (IFO). In this paper, we focus
on the preamble based FFO estimation schemes. To estimate
the FFO, methods proposed in the literature can be broadly
classiﬁed into two categories.
1)
Methods that utilize the phase shift between the
repetitive parts of a preamble in the time domain [6]–
[13].
2)
Methods that utilize the symmetrical correlation of
the preamble [14]–[18]
Schmidl and Cox [6] and Lim [8] use a preamble with two
identical halves to estimate the FFO. FFO is estimated by
measuring the phase shift between two identical halves of the
preamble. Minn [9], Wang [11], Shi [10] use a preamble with
four identical halves to estimate the FFO. FFO is estimated
by measuring the phase shift between the adjacent blocks of
the preamble. Tufvesson [13] proposed a different method to
estimate the FFO. In [13], the received signal is multiplied by
the known preamble and the FFO is estimated by measuring
phase shift of the resulting signal. Morelli and Mengali [7]
estimate the FFO by using a best linear unbiased estimator
(BLUE), which gives better performance than [6] [8]–[11]
[13]. The main drawback of the BLUE estimator [7] is its
computational complexity. Zhang [14], Zhang [15], Park [16],
Kim [17], Shao [18] estimate the FFO by utilizing symmetrical
correlation of the preamble. Here, we propose a new method
to estimate FFO using a time domain repeated preamble. The
proposed method is compared with the existing methods in
terms of performance in the multipath Rayleigh fading channel
and the computational complexity.
This paper is organized as follows. The system model is
presented in Section II. Existing FFO estimation methods are
presented in Section III. The proposed method is presented in
Section IV. The simulation results are given in Section V and
ﬁnally, the conclusions in Section VI.
II.
SYSTEM MODEL
Fig. 1 shows the typical structure of a OFDM frame in
the time domain. An OFDM frame contains preamble, cyclic
preﬁx (CP) and data. Preamble is used for synchronization
purpose. Let xp denotes the time domain preamble of the
Figure 1: OFDM frame structure in the time domain
OFDM frame given by
xp =

AN/4 AN/4 AN/4 AN/4

(1)
where AN/4 is the sample of length N/4 in the time domain,
which is obtained by N/4 point IFFT of the N/4 length
frequency domain data. A cyclic preﬁx (CP) of length Ng
which is denoted by CPPRE is introduced in front of the
preamble in the time domain. CPPRE of the preamble xp is
given by
CPPRE = [xp (N − Ng) ... xp (N − 1)]
(2)
Let
x = [CPPRE xp] .
(3)
Now, x is transmitted through the frequency selective channel.
The channel is assumed to be quasi static and it is ﬁxed for
one frame and varies independently from frame to frame. Its
impulse response for a given frame can be expressed as:
h = [h(0) h(1) h(2) ..... h(L − 1)]
(4)
86
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

where L is the number of channel taps. The received signal r
in the time domain is given by:
r (n) = y (n) ej2πnϵ/N + w (n)
(5)
where
y (n)
=
h (n) ⋆ x (n)
=
L−1
X
l=0
h (l) x (n − l) .
(6)
where w (n) is zero mean Gaussian noise sample and ϵ is
the normalized frequency offset. ϵ can be divided into two
parts the integer part denoted by ϵI (IFO) and the fractional
part denoted by ϵF (FFO), where −1/2 ⩽ ϵF < 1/2 [19]
and −N/2 ⩽ ϵI < N/2 or 0 ≤ ϵI < N [20]. Here, we
consider the presence of FFO only. Let z(n) denote the signal
after discarding the CP of the received preamble r(n). After
discarding CP z(n) is re indexed from 0 to N − 1. We deﬁne
the sub vectors Zi given by
Zi = [z ((i − 1) N/4) ..... z (iN/4 − 1)]T
(7)
where 1 ≤ i ≤ 4. We deﬁne the correlation functions given by
ZH
1 Z2 =
N/4−1
X
n=0
z⋆(n).z(n + N/4)
(8)
ZH
2 Z3 =
N/2−1
X
n=N/4
z⋆(n).z(n + N/4)
(9)
ZH
3 Z4 =
3N/4−1
X
n=N/2
z⋆(n).z(n + N/4)
(10)
ZH
1 Z3 =
N/4−1
X
n=0
z⋆(n).z(n + N/2)
(11)
ZH
2 Z4 =
N/2−1
X
n=N/4
z⋆(n).z(n + N/2)
(12)
ZH
1 Z4 =
N/4−1
X
n=0
z⋆(n).z(n + 3N/4).
(13)
III.
EXISTING FFO ESTIMATION METHODS
In this section, we give a brief overview of fractional
frequency offset estimation methods.
1) Schmidl and Cox method: Schmidl and Cox [6] use a
preamble with two identical halves to estimate the FFO, which
is given by
xp(sch) =

AN/2 AN/2

(14)
where AN/2 is the sample of length N/2. In this case the Zi
becomes
Zi = [z ((i − 1) N/2) ..... z (iN/2 − 1)]T
(15)
where 1 ≤ i ≤ 2. FFO estimation proposed by Schmidl and
Cox [6] is given by
ˆϵF = 2
π arg

6) Park and Cheon method: Park and Cheon [16] use
symmetrical correlation to estimate the FFO. Preamble used
in [16] is given by
xp(park) =
h
AN/4 BN/4 A⋆
N/4 B⋆
N/4
i
(29)
where AN/4 is the sample of length N/4. A⋆
N/4 is the
conjugate of AN/4. BN/4 is designed to be the time reversed
version (symmetric) of AN/4. B⋆
N/4 is the conjugate of BN/4.
The proposed FFO estimation in [16] is given by
ˆϵF = 1
π arg


N/4−1
X
n=0
z⋆ (n) .z (n + N/2)

 .
(30)
7) Shao method: Shao [18] uses symmetrical correlation
to estimate the FFO. Preamble used in [18] is given by
xp(shao) =
h
AN/4 B⋆
N/4 A⋆
N/4 BN/4
i
(31)
where AN/4 is the sample of length N/4. A⋆
N/4 is the
conjugate of AN/4. BN/4 is designed to be the time reversed
version (symmetric) of AN/4. B⋆
N/4 is the conjugate of BN/4.
The proposed FFO estimation in [18] is given by
ˆϵF = 1
π arg


N/2−1
X
n=0
z⋆ (n) z (N − n)

 .
(32)
IV.
PROPOSED MODEL
The proposed method uses a preamble with four identical
halves as mentioned in the system model. Correlation functions
between the adjacent blocks are given by ZH
1 Z2, ZH
2 Z3,
ZH
3 Z4 and the correlation functions between the nonadjacent
blocks are given by ZH
1 Z3, ZH
2 Z4, ZH
1 Z4. In [9]–[11], the
FFO is estimated by utilizing the correlation between the
adjacent blocks of the preamble. In proposed method, we
utilize only the non adjacent blocks of the preamble.
A. Proposed algorithm 1
The FFO estimate is
ˆϵF = 1
π arg (ψ4)
(33)
where ψ4 is either given by
ψ4 = ZH
1 Z3
(34)
or
ψ4 = ZH
2 Z4
(35)
B. Proposed algorithm 2
The FFO estimate is
ˆϵF = 1
π arg (ψ5)
(36)
where ψ5 is given by
ψ5 = ZH
1 Z3 + ZH
2 Z4
(37)
C. Proposed algorithm 3
The FFO estimate is
ˆϵF = 2
3π arg (ψ6)
(38)
where ψ6 is given by
ψ6 = ZH
1 Z4
(39)
D. Proposed algorithm 4
The FFO estimate is
ˆϵF = 1
2π arg (ψ5) + 1
3π arg (ψ6)
(40)
V.
SIMULATION RESULTS AND DISCUSSION
0
2
4
6
8
10
12
14
16
10
−5
10
−4
10
−3
10
−2
SNR per bit (dB)
MSE
 
 
Minn [9]
Faulkner [11]
Proposed 1
Tufvesson [13]
Shi [10]
Proposed 2
Schmidl [6]
Proposed 3
Morelli [7]
Proposed 4
Figure 2: Mse performance of the proposed method in comparison
with the previous methods that use time domain repeated
preamble to estimate FFO in AWGN channel
In this section, the performance of the proposed method
is compared with the major existing fractional frequency
offset synchronization methods We have assumed N=128 and
performed the simulations over 104 frames. Length Ng of
the cyclic preﬁx (CP) is 16. QPSK signaling is assumed.
Frequency selective Rayleigh fading channel is assumed with
path taps L = 5 and path delays µl = l for l = 0, 1, ..., 4 . The
channel has an exponential power delay proﬁle (PDP) with an
average power of exp (−µl/L). The CFO takes random value
within the range [−0.5, 0.5] and it varies from frame to frame.
In order to compare with the methods in [9]–[11] along with
the proposed method the value of j and T for the method
proposed in [7] are set to 2 and 4 respectively.
Fig. 2 and Fig. 3 show the comparison of the proposed
method with the existing methods that use time domain
repeated preamble to estimate FFO in AWGN channel and
multipath channel respectively. As indicated in Fig. 2 and
Fig. 3 the proposed algorithm 1 performs better than the
methods in [9] and [11] with less computational complexity.
The proposed algorithm 2 performs better than the methods in
88
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

0
2
4
6
8
10
12
14
16
10
−5
10
−4
10
−3
10
−2
10
−1
SNR per bit (dB)
MSE
 
 
Minn [9]
Faulkner [11]
Proposed 1
Tufvesson [13]
Shi [10]
Proposed 2
Schmidl [6]
Proposed 3
Morelli [7]
Proposed 4
Figure 3: Mse performance of the proposed method in comparison
with the previous methods that use time domain repeated
preamble to estimate FFO in multipath channel
0
2
4
6
8
10
12
14
16
10
−5
10
−4
10
−3
10
−2
SNR per bit (dB)
MSE
 
 
Park [16]
Proposed 1
Shao [18]
Zhang [14]
Proposed 2
Proposed 3
Proposed 4
Figure 4: Mse performance of the proposed method in comparison
with the previous methods that use symmetrical correlation
of the preamble to estimate FFO in AWGN channel
[9]–[11] and [13]. Computational complexity of the proposed
algorithm 2 is the same as for the methods in [9] and [11]
but less as compared to methods proposed in [13] and [10].
Proposed algorithm 3 performs better than the methods given
in [6] [9]–[11] and [13] with less computational complexity.
Proposed algorithm 4 gives the best performance because it
gives the better result as compared to method in [7] with less
computational complexity as indicated in Fig. 2 and Fig. 3.
Fig. 4 and Fig. 5 shows the comparison of the proposed
method with the existing methods that use symmetrical corre-
lation of the preamble to estimate FFO in AWGN channel
and multipath channel respectively. It is observed that the
0
2
4
6
8
10
12
14
16
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR per bit (dB)
MSE
 
 
Park [16]
Shao [18]
Zhang [14]
Proposed 1
Proposed 2
Proposed 3
Proposed 4
Figure 5: Mse performance of the proposed method in comparison
with the previous methods that use symmetrical correlation
of the preamble to estimate FFO in multipath channel
0
2
4
6
8
10
12
14
16
10
−7
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR per bit (dB)
BER
 
 
Without CFO compensation
Proposed 1
Proposed 2
Proposed 3
Proposed 4
Ideal
Figure 6: Ber performance of the proposed methods in AWGN chan-
nel
performance of the symmetrical correlation methods [16]
[14] and [18] are degraded in the presence of multipath as
compared to AWGN channel. It is also observed that the
proposed methods perform better than the existing symmetrical
correlation methods in the presence of multipath. In table 1,
the computational complexity of different estimators along
with the proposed methods is given. Fig. 6 shows the ber
performance of the proposed methods in AWGN channel. It is
observed that proposed algorithm 4 performs better than the
other methods.
VI.
CONCLUSION
In this paper, the performance of different existing data
aided fractional frequency offset estimator schemes are com-
89
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

TABLE I: COMPUTATIONAL COMPLEXITY
Method
Multiplications
Addition
Division
Schmidl
(N/2) + 1
(N/2 − 1)
0
Minn
(N/2) + 1
(N/2) − 1
0
Faulkner
(N/2) + 1
(N/2) − 1
0
Shi
(3N/4) + 1
(3N/4) − 1
0
Morelli
9N/4 + 23, T = 4, H = 2
9N/4 − 2, T = 4, H = 2
2, T = 4, H = 2
Park
N/4 + 1
N/4 − 1
0
Shao
N/2 + 1
N/2 − 1
0
Proposed 1
(N/4) + 1
(N/4) − 1
0
Proposed 2
(N/2) + 1
(N/2 − 1)
0
Proposed 3
(N/4) + 1
(N/4 − 1)
0
Proposed 4
(3N/4) + 2
(3N/4 − 1)
0
pared with the proposed methods. The proposed methods give
better result as compared to existing techniques.
REFERENCES
[1]
K. Vasudevan, Digital communications and signal processing.
Uni-
versities Press, 2007.
[2]
K. Vasudevan, “Coherent detection of turbo-coded ofdm signals trans-
mitted through frequency selective rayleigh fading channels with re-
ceiver diversity and increased throughput,” Wireless Personal Commu-
nications, vol. 82, no. 3, pp. 1623–1642, 2015.
[3]
K. Vasudevan, “Synchronization of bursty offset qpsk signals in the
presence of frequency offset and noise,” in TENCON 2008-2008 IEEE
Region 10 Conference, pp. 1–6, 2008.
[4]
K. Vasudevan, “Coherent detection of turbo coded ofdm signals trans-
mitted through frequency selective rayleigh fading channels,” in Signal
Processing, Computing and Control (ISPCC), 2013 IEEE International
Conference, pp. 1–6, 2013,
[5]
K. Vasudevan, “Iterative detection of turbo-coded offset qpsk in the
presence of frequency and clock offsets and awgn,” Signal, Image and
Video Processing, vol. 6, no. 4, pp. 557–567, 2012.
[6]
T. M. Schmidl and D. C. Cox, “Robust frequency and timing synchro-
nization for OFDM,” IEEE Transactions on Communications, vol. 45,
no. 12, pp. 1613–1621, 1997.
[7]
M. Morelli and U. Mengali, “An improved frequency offset estimator
for OFDM applications,” in Communication Theory Mini-Conference,
1999.
IEEE, pp. 106–109, 1999.
[8]
Y. S. Lim and J. H. Lee, “An efﬁcient carrier frequency offset estimation
scheme for an OFDM system,” in Vehicular Technology Conference,
2000. IEEE-VTS Fall VTC 2000. 52nd, vol. 5, pp. 2453–2458, 2000.
[9]
H. Minn, V. K. Bhargava, and K. B. Letaief, “A robust timing and
frequency synchronization for ofdm systems,” IEEE Transactions on
Wireless Communications, vol. 2, no. 4, pp. 822–839, 2003.
[10]
K. Shi and E. Serpedin, “Coarse frame and carrier synchronization of
OFDM systems: a new metric and comparison,” IEEE Transactions on
Wireless Communications, vol. 3, no. 4, pp. 1271–1284, 2004.
[11]
K. Wang, M. Faulkner, J. Singh and I.Tolochko, “Timing synchroniza-
tion for 802.11a WLANs under multipath channels,” ATNAC’03, pp.
1-5, 2003.
[12]
H.-T. Hsieh and W.-R. Wu, “Maximum likelihood timing and carrier
frequency offset estimation for OFDM systems with periodic pream-
bles,” IEEE Transactions on Vehicular Technology, vol. 58, no. 8, pp.
4224–4237, 2009.
[13]
F. Tufvesson, O. Edfors, and M. Faulkner, “Time and frequency
synchronization for ofdm using pn-sequence preambles,” in Vehicular
Technology Conference, 1999. VTC 1999-Fall. IEEE VTS 50th, vol. 4,
pp. 2203–2207, 1999.
[14]
Z. Zhang, M. Zhao, H. Zhou, Y. Liu, and J. Gao, “Frequency offset
estimation with fast acquisition in ofdm system,” IEEE Communications
Letters, vol. 8, no. 3, pp. 171–173, 2004.
[15]
Z. Zhang, J. Liu, C. Wang, K. Sohraby, and Y. Liu, “Joint frame syn-
chronization and carrier frequency offset estimation in ofdm systems,”
in Electro Information Technology, 2005 IEEE International Conference
, pp. 1–5, 2005.
[16]
B. Park, H. Cheon, C. Kang, and D. Hong, “A novel timing estimation
method for ofdm systems,” IEEE Communications Letters, vol. 7, no. 5,
pp. 239–241, 2003.
[17]
J. Kim, J. Noh, and K. Chang, “Robust timing & frequency synchroniza-
tion techniques for ofdm-fdma systems,” in Signal Processing Systems
Design and Implementation, 2005 IEEE Workshop, pp. 716–719, 2005.
[18]
H. Shao, Y. Li, J. Tan, Y. Xu, and G. Liu, “Robust timing and frequency
synchronization based on constant amplitude zero autocorrelation se-
quence for ofdm systems,” in Communication Problem-Solving (ICCP),
2014 IEEE International Conference, pp. 14–17, 2014.
[19]
M. Morelli, A. D’andrea, and U. Mengali, “Frequency ambiguity
resolution in OFDM systems,” IEEE Communications Letters, vol. 4,
no. 4, pp. 134–136, 2000.
[20]
H. Abdzadeh-Ziabari and M. G. Shayesteh, “Sufﬁcient statistics, clas-
siﬁcation, and a novel approach for frame detection in ofdm systems,”
IEEE Transactions on Vehicular Technology, vol. 62, no. 6, pp. 2481–
2495, 2013.
90
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

