A Design of Full-Rate Distributed Space-Time-Frequency Codes with Randomized 
Cyclic Delay Diversity 
 
Hong-yu Fang, Meng-lin Bao, Lei Xu, Xiao-hui Li 
Key Lab of Intelligent Computing and Signal Processing of Ministry of Education 
Anhui University 
 Hefei, China 
e-mail: xhli@ahu.edu.cn 
 
Abstract—Cyclic 
Delay 
Diversity 
(CDD) 
method 
was 
introduced to cooperative communications for improving the 
system diversity performance. Since the CDD with fixed cycle 
delay cannot obtain the optimal system performance in all 
situations, this paper presents a full-rate distributed space-
time-frequency codes scheme in the full-rate cooperative 
communication model by taking advantages of Randomized 
Cyclic 
Delay 
Diversity 
(RCDD) 
method 
and 
Linear 
Constellation Precoding (LCP) technology. The proposed 
scheme is more practical and has the advantage of low 
detection complexity. Compared with the full-rate cooperative 
communication scheme with Fixed Cyclic Delay Diversity 
(FCDD), the proposed scheme can achieve Better Bit Error 
Rate (BER) performance in the case of large number of 
subcarriers. 
Keywords-randomized cyclic delay diversity; cooperative 
communication; OFDM; space-time-frequency code 
I. 
 INTRODUCTION 
The traditional two-hop cooperative mode requires two 
time slots to complete data transmission. It increases the 
system diversity gain at the cost of half of the system 
transmission rate [1][2]. In order to solve the problem, the 
Non-orthogonal Amplify and Forward (NAF) transmission 
mode with single relay was proposed by Nabar et al. [3]. 
With the help of the relay node, the source node transmits 
two symbols to the destination node within two adjacent 
time slots. Thus it can achieve full-rate data transmission. 
However, only the data sent from the source node in the odd 
time slot is forwarded at the relay node results in the 
imbalance of error rate between odd and even time slots, 
which is also known as “short-board effect”. In order to 
overcome this phenomenon, linear constellation precoding is 
used for data transmitted within two adjacent time slots by 
Zhang et al. [4][5]. This method can achieve full diversity 
gain and improve the system spectral efficiency, but 
increases the decoding complexity. The cyclic delay 
diversity method is introduced in the full-rate cooperative 
transmission model by Kwon et al. [6]. It reduces the system 
detection complexity and increases the channel frequency 
selectivity and the system frequency diversity as well. In 
system with CDD, the BER performance is affected by the 
cyclic delay value [7][8]. To realize the time diversity in the 
system with CDD further, the concept of randomized cyclic 
delay diversity was proposed by Plass et al. [9][10]. In the 
system with randomized cyclic delay diversity, the OFDM 
signals transmitted through each antenna are cyclically 
delayed in time domain respectively, where the cyclic delay 
value is selected randomly. This scheme not only obtains 
both the system frequency diversity and the system time 
diversity, but also improves the system BER performance 
without increasing the detection complexity at the receiving 
end. However, there exists a widespread problem that the 
system spectral efficiency is low. To improve the system 
diversity gain, the RCDD method is introduced to the multi-
relay cooperative communication by Choi et al. [11][12], 
but the system cannot achieve full-rate data transmission 
and thus reduces the system spectrum efficiency.  
In order to maximize the utilization of wireless network 
spectrum resources and improve the system diversity gain, 
this paper presents a distributed space-time-frequency coding 
scheme with randomized cyclic delay method and linear 
constellation precoding technology in the NAF full-rate 
multi-relay cooperative communication model.  
The rest of the paper is organized as follows. Section II 
describes 
the 
NAF 
full-rate 
distributed 
cooperative 
communication model. The decoding scheme of the full-rate 
distributed space-time-frequency codes is given in Section 
III. Section IV analyses the performance of the proposed 
scheme. Finally, Section V presents the conclusion and 
future work. 
 
II. 
SYSTEM MODEL 
As shown in Fig. 1, the non-orthogonal amplify and 
forward (NAF) full-rate cooperative transmission model 
was used in this paper. It consists of a source node S , M  
relay nodes
iR ,
1,2,...,
i
M

, and a destination node D . 
Each node is equipped with a single antenna, and operates in 
half-duplex mode. In the first time slot, the source node 
broadcasts the first signal to all the relay nodes and the 
destination node. In the second time slot, the source node 
continues to transmit the next signal to the destination node. 
Meanwhile the relay node forwards the signal received in 
the first time slot to the destination node after some 
processing. Source node completes the transmission of two 
symbols in two time slots, so that it can achieve full-rate 
transmission.  
In order to overcome the "short-board effect", the 
symbol transmitted from the source node S is coded by 
linear constellation precoding. Assume  that 
1
S , 
2
S   are  the  
1
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-305-6
ICSNC 2013 : The Eighth International Conference on Systems and Networks Communications

The first time slot
...
S
D
R2
R1
RM
X1
X1
X1
X1
       
The second time slot
...
S
D
R2
R1
RM
A2
X2
A1
AM
 
Figure 1.  NAF full-rate cooperative transmission model. 
symbols transmitted in two adjacent time slot from the 
source node in the frequency domain, respectively. 
1
X ,
2
X  
are  the symbols after linear constellation precoding. Where 
1
S , 
2
S , 
1
X  and 
2
X are length-NF  column vectors, 
F
N  
represents the number of OFDM subcarriers. The 
relationship between
1
S , 
2
S  and 
1
X , 
2
X  is given as (1). 
 
 
 
 
1
2
1
2
T
T
X
p
X
p
S
p
S
p









Θ
        (1) 
where, 
1S  
p and 
S2  
p  correspond to the data transmitted 
on p-th subcarrier of 
1
S  and
2
S , 


1,
1
F
p
N


. Θ  is 2 2

 
linear constellation precoding matrix. In the first time slot, 
the source node S  broadcasts 
1
X  to all the relay nodes and 
the destination node D . Thus, the received signals at i-th 
relay node and destination node in p-th subcarrier are shown 
in (2) and (3).  
 
 
 
 
1
1
i
i
i
R
p
P f
p X
p
N
p


                   (2) 
 
 
 
 
1
1
1
1
Z
p
Ph p X
p
W
p


                   (3) 
where, 
1P  is the transmit power of the source node,  
h p  
and
if  
p represent the complex channel fading coefficients 
of S  to D  and S  to the i-th relay node 
iR  in the frequency 
domain, respectively. 
X1  
p  is the data transmitted on the 
p-th subcarrier of 
1
X , 
Ni  
p  and 
W1  
p  are both complex 
additive white Gaussian noise (AWGN) with zero-mean and 
variance 
0
N . 
In the second time slot, the relay node 
iR  forwards the 
signal 
iR  to the destination node D  after randomized 
cyclic delay. Thus, the signal transmitted from the relay 
node 
iR  is 
 
 
CDD
i
i
A p
R
p

                       (4) 
To ensure the transmit power of the relay node, the 
amplifying power factor gain 


2
0
1
P
N
P
 

, where 
2P  
is the transmit power of the relay node, 
 
CDD
iR
p
 is 
iR  
p  
with random cyclic delay.  
 
 
 
2
i
F
j
p
CDD
N
i
i
R
p
R
p e




                  (5)    
where, 
i  is the cyclic delay value. The randomized cyclic 
delay scheme is used in this paper, so 
i  is selected 
randomly between 

0,
1
F
N 
. Because delay in time 
domain is equivalent to the phase shift in the frequency 
domain, so in the frequency domain it is expressed as 


2
i
F
j
p
N
e



.  
The source node broadcast 
2
X  to the destination node 
D  in the second time slot as well. Thus, the received signal 
at the destination node in the p-th subcarrier is: 
 
 
 


 
 
 
2
1
3
2
2
+
M
CDD
i
i
i
Z
p
g
p R
p
P h p X
p
W
p





               (6) 
where, 
3P  is the transmit power of the source node in the 
second time slot, 
X2  
p  is the data transmitted on p-th 
subcarrier of 
X2
, 
ig  
p
 is complex channel fading 
coefficient of the i-th relay node 
iR  to the destination node 
D  in the frequency domain, 
W2  
p  is complex additive 
white Gaussian noise with zero-mean and variance
0
N . 
By combining (5) and (6) we can obtain: 
 
 
 
 
 
 
2
2
1
1
1
3
2
2
( )
+
i
F
M
j
p
N
i
i
i
Z
p
P
g
p f
p e
X
p
P h p X
p
W
p
















    (7) 
where， 
 
 
 
 
2
2
2
1
i
F
M
j
p
N
i
i
i
W
p
g
p N
p e
W
p








      (8) 
For a large value of M , 
 
2
1
M
i
i
g
p
M



with a high 
probability. So, there has the result  


2
2
2
0 1
H
N
N
M

 



E W W
I                 (9) 
where 
 


2
2
2
0 ,
,
1
F
W
W
N






W
,  
 H
denotes the 
complex transpose conjugate and 
 
E 
 represents the 
expection operation. Let us set 


2
0 1
K
N
M


. In order 
2
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-305-6
ICSNC 2013 : The Eighth International Conference on Systems and Networks Communications

to normalize the noises of the signals received in two time 
slots to be zero-mean and unit variance complex Gaussian, 
we divide (7) and (8) by
0
N  and 
K respectively. The 
normalized signals are given by (10) and (11). 
 
1
1
1
1
( )
( )
( )
Z
p
c
h p X
p
W p



              (10) 
 
 
 
2
2
2
1
1
3
2
( )
( )
( )
( )
i
F
M
j
p
N
i
i
i
Z
p
c
g
p f
p e
X
p
c
h p X
p
V p


















    (11) 
where 
1( )
W p  and 
( )
V p  are both complex additive white 
Gaussian noise with zero-mean and variance
N0
. 
Let
0
/
  P N
 be the total transmit signal-to-noise ratio of 
the system, where
1
2
3
P
P
MP
P



. Finally, the power 
allocation coefficients
1c , 
2c , 
3c  are 
 
1
1
P
c
 P
                                    (12) 
1
2
2
2
2
1
0
1
(
|
( ) |
)
M
i
i
PP
c
P
g
p
P
P
N






            (13) 
              
3
1
0
3
2
2
1
0
1
(
)
(
|
( ) |
)
M
i
i
P P
N
c
P
g p
P
P
N







            (14) 
III. 
DECODING 
From (10) and (11), we can obtain that the received 
signals at the destination node on the p-th subcarrier are 
 
   
   
 
 
 
1
1
3
2
2
1
c X
p h p
Y p
c X
p h p
c X
p
p
N p















  (15) 
where， 
 
 
 
2
1
i
F
M
j
p
N
i
i
i
p
g
p f
p e





 
          (16) 
 
 
 
1
2
T
Y p
Z
p
Z
p


 
                   (17) 
 
 
 
1
T
N p
W
p
V p


 
                   (18) 
Using (1), we can rewrite (15) as (19). 
 
 
 
 
 
 
 
 
 
 
 
 
 
1
1
2
2
3
1
2
3
c h p
X
p
Y p
N p
X
p
c
p
c h p
c h p
S p
N p
c
p
c h p



 


 




 



 
















Θ
(19) 
where  
 
 
1
2
T
S p
S
p
S
p
 


 , from the above equation, 
we can see that the received signals at the destination node 
are the linear transformation of the signals transmitted 
through the source node, that is to say, the proposed scheme 
has a one-dimensional equivalent channel, and with the 
number of the relay node increasing, the detecting 
complexity does not increase. Denote  
 
 
 
 
1
2
3
c h p
p
c
p
c h p














Θ            (20) 
Then, (19) is equivalent to 
 
   
 
Y p
p S p
N p
 

                     (21) 
Assume that the Channel Status Information (CSI) is 
perfectly known at the destination node, the signals S  
transmitted through the source node can be detected by using 
the Maximum Likelihood (ML) detection method.  
IV. 
SIMULATION RESULT AND ANALYSIS 
The BER performance of the proposed scheme is 
simulated by Matlab in this section. Signals transmitted from 
the source node are firstly encoded by convolutional code 
and modulated into QPSK, where the rate of convolutional 
code is 1/2. Then, the signals are encoded with linear 
constellation precoding matrix Θ . The channel model is 
frequency selective fading channel with the carrier frequency 
of 3.5GHZ, and the multipath number is 2. The signal 
received at the relay node will be randomly cyclically 
delayed and then amplified and forward to destination node. 
The power allocation scheme in [4] was used in the paper. At 
the destination node, we use the ML detection method for 
decoding. The BER performance of system with RCDD and 
system with FCDD are shown in Fig. 2, Fig. 3 and Fig. 4, 
where the number of the relay node is 1, 2, 4, and the number 
of OFDM subcarriers is 32, 128 and 1024.  
From Fig. 2, we can see that, in the case of small number 
of subcarriers, the BER performance of system with RCDD 
is substantially the same as the system with FCDD, and it 
improves as the number of the relay node increases. 
From Fig. 3 and Fig. 4,  we  can  see  that,  in the  case of  
3
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-305-6
ICSNC 2013 : The Eighth International Conference on Systems and Networks Communications

 
Figure 2.  BER performance vs. SNR 
32
F
N 
 and
M 1,2,4
. 
 
Figure 3.   BER performance vs. SNR 
128
F
N 
 and
M 1,2,4
. 
large number of subcarriers, the proposed scheme can 
achieve better BER performance. From Fig. 2, Fig. 3 and Fig. 
4, we can see that randomized cyclic delay can excavate the 
system diversity gain further as the number of subcarriers 
increases. 
V. 
CONCLUSION AND FUTURE WORK 
Unlike fixed cyclic delay coding scheme used in NAF 
full-rate transmission system, the cyclic delay value is 
selected randomly in the proposed full-rate distributed 
space-time-frequency codes scheme, which is more practical 
than fixed cyclic delay. The proposed scheme is able to 
achieve better BER performance than the FCDD as the 
number of OFDM subcarriers increase, and it has the 
advantages of low detection complexity, i.e., the decoding 
complexity does not increase as the number of relay nodes 
increases. 
In the future, we are planning to extend the present study 
to bi-directional distributed cooperative communication 
systems. 
 
 
Figure 4.   BER performance vs. SNR 
1024
F
N 
 and
M 1,2,4
. 
ACKNOWLEDGMENT 
Project supported by the National Natural Science 
Foundation of China (No. 60972040), the Anhui Provincial 
Natural Science Foundation (No. 11040606Q06), the 
Provincial Project of Natural Science Research for Colleges 
and Universities of Anhui Province of China (No. 
KJ2012A003), the PhD Start-up Foundation (No. 33190217) 
and the 211 Project of Anhui University. 
 
REFERENCES 
[1]  X. Li, Q. Zhang, G. Zhang, and J. Qi, “Joint Power Allocation 
and Subcarrier Pairing for Cooperative OFDM AF Multi-
Relay Networks,” IEEE Communications Letters, vol.17, no.5, 
May 2013, pp. 872-875. 
[2]  L. J. Rodríguez, and N. H. Tran, A. Helmy, and T. Le-Ngoc, 
“Optimal Power Adaption for Cooperative AF Relaying with 
Channel Side Information,” IEEE Transactions on Vehicular 
Technology, vol. pp, no.99, 2013, pp. 1-11. 
[3]  R. U. Nabar, H. Bolcskei, and F. W. Kneubuhler, “Fading 
Relay Channels: Performance Limits and Space-Time Signal 
Design,” IEEE Journal on Selected Areas in Communications, 
vol. 22, no. 6, Aug. 2004, pp. 1099-1109. 
[4] W. Zhang, and K. B. Letaief, “Full-Rate Distributed Space-
Time Codes for Cooperative Communication,” IEEE 
Transactions on Wireless Communications, vol. 7, no. 7, Jul. 
2008, pp. 2446-2451. 
[5]  H. Phan, T. Q. Duong, and H.-J. Zepernick, “Full-Rate 
Distributed 
Space-Time 
Coding 
for 
Bi-directional 
Cooperative Communication,” IEEE 2010 5th International 
Symposium on Wireless Pervasive Computing (ISWPC), May 
2010, pp.22-26. 
[6] U. Kwon, C. Choi, and G. Im, “ Full-Rate Cooperative 
Communications with Spatial Diversity for Half-Duplex 
Uplink Relay Channels,” IEEE Transactions on Wireless 
Communications, vol. 11, no. 8, Nov. 2009, pp. 5449-5454. 
[7] Y.-J. Kim, H.-Y. Kim, M. Rim, and D.-Wo. Lim, “On the 
Optimal Cyclic Delay Value in Cyclic Delay Diversity,” 
IEEE Trans. Broadcasting, vol. 55, no. 4, Dec. 2009, pp. 790-
795. 
[8] S.-H. Hur, M.-J. Rim, B. D. Rao, and J. R. Zeidler, 
“Determination of Cyclic Delay for CDD Utilizing RMS 
4
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-305-6
ICSNC 2013 : The Eighth International Conference on Systems and Networks Communications

Delay Spread in OFDMA Multiuser Scheduling Systems,” 
IEEE 2010 Conference Record of the Forty Fourth Asilomar 
Conference 
on 
Signals, 
Systems 
and 
Computers 
(ASILOMAR), Nov. 2010, pp. 506-510. 
[9] S. Plass, A. Damman, G. Richter, and M. Bossert, “Resulting 
Channel Characteristics from Time-Varing Cyclic Delay 
Diversity in OFDM,” 2007 IEEE 66th Vehicular Technology 
Conference, Sept. 2007, pp. 1336-1340. 
[10] G. Richter, M. Bossert, E. Costa, and M. Weckerle, “On  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Time-Varing Cyclic Delay Diversity,” European Transactions 
Telecommunications, vol. 17, no. 3, Mar. 2006, pp. 3100-3105. 
[11] S. Choi, J.-H. Park, and D.-J. Park, “Randomized Cyclic 
Delay Code for Cooperative Communication System,” IEEE, 
Communications Letters, vol. 12, no. 4, Apr. 2008, pp. 271-
273. 
[12] S. Choi, and D.-J. Park, “Performance of Randomized Cyclic 
Delay Code Encoded by Convolutional Coding,” IEEE, 
Vehicular Technology Conference, May 2008, pp. 2370-2373.  
 
5
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-305-6
ICSNC 2013 : The Eighth International Conference on Systems and Networks Communications

