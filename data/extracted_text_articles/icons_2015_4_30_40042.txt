Subspace Identiﬁcation Methods and Multivariable Control for a Doubly-fed
Induction Generator
Danna L. Albarracín Ávila
Electrical Engineering
Universidad Tecnológica de Pereira
Pereira, Colombia
Email: dlalbarracin@utp.edu.co
Eduardo Giraldo
Department of Electrical Engineering
Universidad Tecnológica de Pereira
Pereira, Colombia
Email: egiraldos@utp.edu.co
Abstract—Doubly-Fed
Induction
Generators
(DFIG)
are
being
widely
used
on
Wind
Turbine
Generator
System
(WTGS), although synchronous generators are being extensively
utilized too. Thus, there are different types of identiﬁcation
techniques to obtain an estimated model of system. Orthogonal
Decomposition
(ORT)
and
Multivariable
Output
Error
State
Space
(MOESP)
algorithms
are
two
well-known
subspace identiﬁcation techniques, discussed in this paper.
These
identiﬁcation
techniques
are
often
implemented
for
multivariable systems. Subspace identiﬁcation algorithms are
attractive since the state space form is highly suitable to estimate,
predict, ﬁlters, as well as for control design. The Doubly-Fed
Induction
Generator
is
widely
used
in
the
variable-speed
constant-frequency Wind Power Generation System, using the
vector control scheme which provides good performance in
maximum wind energy capturing. In the traditional vector
control scheme, the reduced doubly-fed induction generator
model, which neglects the stator ﬂux transients, is employed
to simplify the rotor current inner-loop controller using the
standard Proportional-Integral (PI) regulation. The approach
proposed in this paper must be approached in order to obtain
an approximate model inﬂuenced by the behaviour of the
system with certain functional characteristics and environmental
changes.
Keywords-subspace identiﬁcation; parameters estimated; wind
turbine; multivariable system; integral controller.
I. INTRODUCTION
Subspace identiﬁcation methods have proven to be such
a valuable tool in identiﬁcation area since past few years.
This interest is due to the ability of the subspace approach
in providing accurate state-space models for multivariable
linear systems directly from input-output data [1][2]. In the
identiﬁcation procedure, the main step is to compute the
Singular Value Decomposition (SVD) of a block Hankel
matrix
H
[3]
constructed
with
input-output
data.
The
computation of SVD can be done ofﬂine or online. The ofﬂine
can be easily converted to an adaptive online version for a slow
time Vaihingen system, such as process control system [3]-[4].
In control systems design with advanced model-based
control methods, lots of time and cost are required for
system identiﬁcation to construct accurate models like a
variable-speed induction machine. To save the cost for
modeling of dynamical systems, it is important to choose
proper
test
signals
so
that
the
leading
dynamics
are
stimulated efﬁciently [5]. A doubly-fed induction generator
is a variable-speed induction machine widely utilized in the
modern wind power industry. The reasons for using variable
speed wind turbines are fourfold: 1) a higher energy yield, 2)
a reduction of mechanical loads and a simpler pitch control, 3)
an extensive controllability of both active and reactive powers,
and 4) less ﬂuctuation in output power [5][6].
There are several vector control strategies for a wind turbine
driven DFIG’s; one common method is to control the rotor
current with Stator Flux Orientation (SFO) [7]. In all the
existing control schemes, the reduced DFIG model, which
neglects the transient terms in the stator ﬂux and most of them
use the traditional PI regulator in their rotor current controllers
[8].
In this paper, two subspace approaches are observed in
order to perform open-loop system identiﬁcation. These two
approaches are the Orthogonal Decomposition (ORT) method
and Multivariable Output Error State Space (MOESP) method.
The objective of this paper is to analyse the performance
of the models in identifying the state space model of a
doubly-fed induction generator (DFIG) and the performance
of the Integral multivariable controller applied to the estimated
system, as shown in Section 3 and Section 4, respectively.
II. MODELING OF DFIG
A. General Descriptions
Figure 1 illustrates the DFIG wind power generation
system consisting of a wound rotor induction generator and
a back-to-back converter between the rotor slip rings and the
grid.
Figure 1. Variable-speed wind turbine system using DFIG.
58
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-399-5
ICONS 2015 : The Tenth International Conference on Systems

B. Mathematical Model of DFIG
Figure 2 shows the equivalent circuit of a DFIG in the
reference frame rotating at the synchronous angular speed ω1
[7].
Figure 2. T-equivalent circuit of DFIG in reference frame rotating at ω1.
According to Figure 2, the stator and rotor space-vector
ﬂuxes Ψs and Ψr are given respectively by

Ψs = LsIs +LmIr
Ψr = LmIs +LrIr
(1)
where Lσs, Lσr and Lm are the stator and rotor leakage and
mutual inductances, and Ls = Lσs +Lm and Lr = Lσr +Lm the
self inductances of the stator and rotor windings, respectively.
The stator and rotor space-vector voltages Vs and Vr in the
same reference frame can be expressed as





Vs = RsIs + dΨs
dt + jω1Ψs
Vr = RrIr + dΨr
dt + j(ω1 −ωr)Ψr
(2)
where Is and Ir are the stator and rotor current vectors, Rs
and Rr the stator and rotor resistances, ωr is the rotor angular
speed, and ωs = ω1 −ωr the slip angular speed.
The model of DFIG uses the SVO scheme described in
[7], in which we can rewrite the rotor voltage equation in the
synchronous d −q reference frame as







Vrd = V
′
rd + Lm
Ls

Vs − Rs
Ls
Ψsd +ωrΨsq

Vrq = V
′
rq − Lm
Ls
Rs
Ls
Ψsq +ωrΨsd

(3)
where





V
′
rd = R
′
rIrd +σLr
dIrd
dt −ωsσLrIrq
V
′
rq = R
′
rIrq +σLr
dIrq
dt +ωsσLrIrd
(4)
The system in state space representation is presented as
follows:
dIrd
dt =
1
σLr

V
′
rd −R
′
rIrd +ωsσLrIrq

dIrq
dt =
1
σLr

V
′
rq −R
′
rIrq −ωsσLrIrd

(5)
y =

1
0
0
1

Ird
Irq

III. SUBSPACE IDENTIFICATION METHOD
The model presented in Section 2 is nonlinear. The linear
model of the DFIG can be obtained by applying an subspace
approach as the ORT (Orthogonal Decomposition) or MOESP
(Multivariable Output Error State Space) methods to the
system around an operating point [3], as follows:
x[k +1] = Ax[k]+Bu[k]
y[k] = Cx[k]+Du[k]
(6)
being x ∈ Rn×1, where n = 6 is the number of state variables,
A ∈ Rn×n, B ∈ Rn×p, where p = 2 is the number of inputs,
u ∈ Rp×1, and C ∈ Rm×n, where m = 2 is the number of
outputs.
Suppose
that
the
input-output
data
{u(t),y(t),t =
0,1,··· ,N + 2k − 2} are given with N sufﬁciently large
and k > n. Based on the input−output data [1], we deﬁne as
usual block Hankel matrices of past input is deﬁned as
Up =


u(0)
u(1)
···
u(N −1)
u(1)
u(2)
···
u(N)
...
...
...
...
u(k −1)
u(k)
···
u(N +k −2)


(7)
and future input as
Uf =


u(k)
u(k +1)
···
u(k +N −1)
u(k +1)
u(k +2)
···
u(k +N)
...
...
...
...
u(2k −1)
u(2k)
···
u(N +2k −2)


(8)
where Up,Uf ∈ Rkm×N. Similarly, we deﬁne past and future
output Yp,Yf ∈ Rkp×N respectively. In [9], the constructed input
and output are given as
U =
"
Up
Uf
#
,Y =
"
Yp
Yf
#
(9)
The extended observability matrix of order i is deﬁned as
Γi =

CT
(CA)T
···
(CAi−1)T T
(10)
and the block lower triangular Toeplitz matrix as
Hi =


D
0
···
0
CB
D
···
0
...
...
...
...
CAi−2B
CAi−3B
···
D


(11)
59
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-399-5
ICONS 2015 : The Tenth International Conference on Systems

we consider a related LQ decomposition


Uf
Up
Yp
Yf

 =


L11
0
0
0
L21
L22
0
0
L31
L32
L33
0
L41
L42
L43
L44




QT
1
QT
2
QT
3
QT
4


(12)
Step 1: Construct data matrices of Up,Uf ,Yp and Yf
Step 2: Perform LQ factorization by (12)
Step 3: Perform SVD to the working matrix
ORT: G = [L42]
MOESP: G = [L42L43]
where
G =
 ˆU
¯U
 ˆS
0
0
¯S
 ˆV
¯V

≃ ˆU ˆS ˆV T
Step 4: Compute the estimates of A and C by (10)
Γi = ˆU ˆS1/2
Step 5: Compute the estimates of B and D by (11)
¯UTL41L−1
11 = ¯UTHi
IV. MULTIVARIABLE CONTROL
A. Integral multivariable controller
In Figure 3, the controller structure is deﬁned by considering
accumulated for the error in the signal control [10] is shown.
Figure 3. Block diagram of the integral action controller.
In [11], the error in the signal control is deﬁned as follows
u[k] = −Kx[k]+Kiv[k]
(13)
with
v[k +1] = v[k]+e[k]
(14)
where the error e[k] is deﬁned as follows
e[k] = r[k]−y[k]
(15)
and v[0] = 0. Therefore, an extended system can be deﬁned as
follows

x[k +1]
v[k +1]

=

A
0
−C
I

x[k]
v[k]

+

B
−D

u[k]+

0
−I

r[k]
(16)
y[k] =

C
0

x[k]
v[k]

(17)
where the control signal is computed as follows
u[k] = −

K
−Ki

x[k]
v[k]

(18)
V. RESULTS
The parameters of the doubly-fed induction generator used
in the simulations are Rs = 0.01(p.u.), Rr = 0.009(p.u.),
Lσr = 0.18(p.u.), Lσs = 0.07(p.u.), Lm = 3.015(p.u.) and
ωs = 1.2(p.u.).
The wind energy conversion system is identiﬁed from
behavior shown in Figure 4 and Figure 5. The estimated model
by the ORT and MOESP method are shown in (19) and (20),
respectively.
Figure 4. Output behavior.
Figure 5. Input behavior.
60
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-399-5
ICONS 2015 : The Tenth International Conference on Systems

A =

0.9992 0.0021
−0.0684 0.9992

B =
 −0.0179 0.0007
−0.0026 −0.1041

C =
 −2.3294 −0.0199
0.1133 −0.4085

D =
 0.0594 −0.0790
0.0054 0.0165

(19)
A =

0.9992 0.0112
−0.0129 0.9992

B =
 −0.0566 0.0620
−0.1034 −0.0494

C =
 −0.2080 −0.2871
0.3077 −0.1940

D =
 0.0467 −0.2088
0.0014 −0.0063

(20)
The graph of superimpose between simulated true system
data and simulated outputs obtained from ORT and MOESP
models are shown in Figure 6 and Figure 7. The input data
system is shown in Figure 8. In Figure 6 and Figure 7, the
Figure 6. Superimpose between simulated true data system of output 1 and
simulated output 1 obtained from estimated system matrices of ORT and
MOESP methods.
Figure 7. Superimpose between simulated true data system of output 2 and
simulated output 2 obtained from estimated system matrices of ORT and
MOESP methods.
MOESP method gives the best performance overall in open
loop compared to the ORT model over the real response of
system.
In Figure 9, Figure 10 and Figure 11, the outputs tracking
performance and the control inputs are shown using the ORT
model.
In Figure 12, Figure 13 and Figure 14, the outputs tracking
performance and the control inputs are shown using the
MOESP model.
As shown in Figure 14, the results for the control inputs
by using the ORT method is better than the obtained results
shown in Figure 11, the MOESP method, in terms of control
signal amplitude.
Figure 9.
Output 1 tracking performance of ORT model by using integral
multivariable controller.
Figure 8. Input data of true system and estimated system matrices of ORT
and MOESP methods.
61
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-399-5
ICONS 2015 : The Tenth International Conference on Systems

Figure 10. Output 2 tracking performance of ORT model by using integral
multivariable controller.
Figure 11. Control signal of ORT model.
Figure 12. Output 1 tracking performance of MOESP model by using integral
multivariable controller.
Figure 13. Output 2 tracking performance of MOESP model by using integral
multivariable controller.
Figure 14. Control signal of MOESP model.
VI. CONCLUSION AND FUTURE WORK
In this paper, two subspace identiﬁcation models of a
doubly-fed induction generator are obtained based on two
subspace algorithms which are ORT and MOESP; they show
an advantages when the parameters of system are unknown
and are known only the input-output values, because they
make it possible to obtain an estimated model of system. The
MOESP method gives the best performance overall in open
loop compared to the ORT method with the same inputs of real
system. However, the output tracking performance by using the
ORT model is better than the obtained results with the MOESP
model in terms of overshoot and control signal amplitude when
it is applied the integral multivariable controller. The settling
time in tracking performance in both models is the same.
62
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-399-5
ICONS 2015 : The Tenth International Conference on Systems

Since practically many real-world systems are time-varying,
the approach proposed in this paper must be considered
in order to obtain an approximate model inﬂuenced by the
behaviour of the system with certain functional characteristics
and environmental changes. These simulations can be obtained
with a programming tool, like MATLAB/Simulink [12] for
testing the results of identiﬁcation and control algorithms
designed before being applied on real-world systems with
time-varying.
The proposed methodologies for identiﬁcation, the MOESP
and ORT methods, shown a state space representation of the
system without rearranging the estimated parameters in each
vector and obtaining the parameters matrices (A, B, C and D)
with a minor dimensions compared to matrices shown in [13],
improving the computational cost with the algorithms.
A future work includes the implementation of algorithms for
identiﬁcation coupled multivariable systems, where couplings
are considered between inputs and outputs as possible
disturbances present in each subsystem, allow it to obtain an
approximate model of system and propose a control strategy
of the system.
ACKNOWLEDGMENT
This paper was developed under the research project
“Identiﬁcación
de
sistemas
multivariables
aplicada
a
generadores eólicos” funded by the Universidad Tecnológica
de Pereira with code 6-14-1, and the MSc. thesis “Control
óptimo de un sistema multi-variable aplicado a un generador
eólico conectado a un sistema de potencia” approved by
the “Convocatoria para ﬁnanciar proyectos de grado de
estudiantes de pregrado y posgrado año 2103” funded by the
Universidad Tecnológica de Pereira with code E6-14-6.
REFERENCES
[1] T.
Katayama,
Subspace
Methods
for
System
Identiﬁcation,
ser.
Communications
and
Control
Engineering,
2006.
[retrieved:
November,
2014].
[Online].
Available:
http://books.google.com.co/books?id=Ge_HTdCBtZAC
[2] G. Tao, “Recursive Subspace Model Identiﬁcation Based on Orthogonal
Projection
and
Principal
Component
Analysis,”
in
International
Conference on Computer Application and System Modeling (ICCASM
2010), Oct 2010, pp. V15–422–V15–429.
[3] I. W. Jamaludin and N. A. Wahab, “N4SID and MOESP subspace
identiﬁcation methods,” in 9th International Colloquium on Signal
Processing and its Applications (CSPA), Mar 2013, pp. 140–145.
[4] D. L. Albarracin-Avila and E. Giraldo, “Adaptive optimal multivariable
control of a Permanent Magnet Synchronous Generator,” in Transmission
& Distribution Conference and Exposition - Latin America (PES T&
D-LA), Sept 2014, pp. 1–5.
[5] L. Shuhui and T. Haskew, “Energy Capture, Conversion, and Control
Study of DFIG Wind Turbine under Weibull Wind Distribution,” in
Power and Energy Society General Meeting PES ’09, Jul 2009, pp.
1–9.
[6] W. Zhi-nong and Y. Xiao-yong, “The Intelligent Control of DFIG-Based
Wind Generation ,” in International Conference on Sustainable Power
Generation and Supply (SUPERGEN ’09), Apr 2009, pp. 1–5.
[7] H. Jia-bing and Z. Jian Guo, “The internal model current control
for wind turbine driven doubly-fed induction generator,” in Industry
Applications Conference, 2006. 41st IAS Annual Meeting. Conference
Record of the 2006 IEEE, Oct 2006, pp. 209–215.
[8] R. Pena, J. Clare, and G. Asher, “Doubly fed induction generator
using back-to-back pwm converters and its application to variable-speed
wind-energy generation,” vol. 143, no. 3, May 1996, pp. 231 – 241.
[9] M. Aziz and R. Mohd-Mokhtar, “Performance Measure of Some
Subspace-Based Methods for Closed-Loop System Identiﬁcation,” in 2nd
International Conference on Computational Intelligence, Modelling and
Simulation (CIMSiM), Sept 2010, pp. 255–260.
[10] K. H. A.-H. K. Salim, R. and B. Khedjar, “LQR with integral action
controller applied to a three-phase three-switch three-level AC/DC
converter,” in IECON 2010 - 36th Annual Conference on IEEE Industrial
Electronics Society, Nov 2010, pp. 550–555.
[11] D.
Giraldo
and
E.
Giraldo,
Eds.,
Teoría
de
Control
Digital.
Productos Editoriales
y Audiovisuales-Produmedios,
2012,
ISBN:
978-958-722-151-0.
[12] S.
Karris,
Introduction
to
Simulink:
With
Engineering
Applications.
Orchard
Publications,
2008.
[Online].
Available:
https://books.google.com.co/books?id=B8ssmvQmpVoC
[13] D. L. Albarracin-Avila and E. Giraldo, “Identiﬁcation and multivariable
control in state space of a permanent magnet synchronous generator,”
TECCIENCIA, vol. 9, no. 16, pp. 97–106, 2014.
63
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-399-5
ICONS 2015 : The Tenth International Conference on Systems

