A Model Based Intelligent Sensor to Control Sprinklers in Spray Actions
Deniver R. Schutz∗,†, Elmer A. G. Pe˜naloza∗,‡, Mercaldi Heitor V. ∗,§, Vilma A. Oliveira†, Paulo E. Cruvinel∗
∗Embrapa Instrumentation
Brazilian Agricultural Research Corporation, S˜ao Carlos, SP, Brazil
† Department of Electrical and Computer Engineering
University of S˜ao Paulo, S˜ao Carlos, SP, Brazil
‡ Department of Control and Automation Engineering
Engineering Center, Federal University of Pelotas, Pelotas, RS, Brazil
§ Department of Electrical Engineering
Federal University of S˜ao Carlos, S˜ao Carlos, SP, Brazil
Email: eagpenaloza@ufpel.edu.br, heitor@ufscar.br, deniver@usp.br, voliveira@usp.br, paulo.cruvinel@embrapa.br
Abstract—Application of pesticides in crops is used to achieve
food production. The use of technologies has become possible to
decrease not only the biological risk but also the ecological and
human ones that may occur during the application of pesticides.
When using large sprayer machines, risks increase considerably
due to the complexity of the trajectories required to cover the
entire crop area. In this context, it is required a better analysis
of the effects of different maneuvers on the quality and efficiency
of the spray. This paper presents an intelligent control system
based on models and smart sensors for automatic spray tip
operation that enables error corrections as a function of the
boom trajectory. As a new technology, such intelligent control and
topology allow to increase quality and efficiency of the application
of pesticides by agricultural sprayers.
Keywords—Intelligent sensor; electronic control; GPC; spray
quality.
I. INTRODUCTION
In the last years, the concepts of precision agriculture and
agriculture 4.0 has been the basis for novel methodologies for
the application of technologies in most agricultural processes.
Advanced automatic control units and the use of adequate
instruments (sensors and actuators) increase production effi-
ciency. In [1] an intelligent sensor is proposed to detect the
concentration of agrochemicals at the exit of the spray nozzles
for a sprayer with a direct agrochemical injection system. The
intelligent sensor is mounted near the spray nozzles to measure
the concentration response time, which uses a highly stable
sinusoidal excitation signal. The results showed that the use of
the intelligent sensor reduces the delay time errors produced by
injecting agrochemicals near the output of the sprayer pump.
With the assistance of the mounted sensor and an adequate
control strategy, the appropriate concentration value for the
application can be achieved.
Monitoring, failure detection, and automatic calibration of
sensors and actuators have also been proposed. Systems with
the ability to detect failures and make calibration settings
are important, since working with agricultural machinery in
the field is subject to great vibrations and critical climatic
conditions. In this sense, the methodology presented in [2]
supports the construction of a sensor virtual calibration module
for agricultural sprayers. Such module for virtual calibration
makes possible to validate the calibration of sensors oper-
ational conditions in real time of commercial sprayers, for
instance, pressure, flow, temperature. Therefore, allowing to
checkup if the sensor’s operational procedures are or not
correct.
On the other hand, advanced automatic control strategies
allow to achieve a high degree of precision in the appropriate
application of agrochemicals. In the work developed in [3]
an intelligent fuzzy-Generalized Predictive Control (GPC) for
Agricultural Sprayers is used. Thus, the authors use a predic-
tive controller to advance control actions based on the delay
dynamics of the hydraulic circuit of the agricultural sprayers.
Among the results obtained in [3] it can be highlighted that
the use of controllers based on predictive approaches increase
the robustness in the presence of variations in the parameters
of the sprayer.
This work proposes an intelligent automatic control strategy
to improve production efficiency and quality. In this context,
in Section II the key concepts of quality and efficiency of
variable rate application are presented. Additionally, applica-
tion examples are presented for each of these basic concepts.
In the sequence, in Section III, the results and analysis about
the use of new methodologies and technologies relevant in the
area, are presented. Finally, in Section IV the conclusions of
the work are reported.
II. APPLICATION OF ADVANCED MODEL CONTROL,
ACTUATORS AND SENSORS
In agricultural sprayers, there are two main concerns, the
first is related to the quality of the application to maintain
uniformity in the size of drops that are sprayed and the
second is efficiency to eliminate errors related to volume and
application rate.
A. Quality of the Application
There are climatic and geographical factors that can drasti-
cally affect the quality of an application. Factors such as wind
speed, terrain slopes, and temperature differences can cause
16
Copyright (c) IARIA, 2023.     ISBN:  978-1-68558-083-4
ALLSENSORS 2023 : The Eighth International Conference on Advances in Sensors, Actuators, Metering and Sensing

errors in the spectrum of drops in the powder applications.
On the other hand, the operating conditions of agricultural
machinery for each application affect quality. Factors such as
the application speed Vp in [km/h], pressure ∆p in [bar] and
flow of the hydraulic circuit of the sprayer Qp in [ℓ/min], the
geometry of the spray nozzle and exit velocity in nozzle Vl in
[m/s] have direct effect on the spectrum of drops delivered.
The quality of the drops spectrum is measured from me-
dian diameters that define each of the characteristics of the
spectrum (statistical moments of a probabilistic distribution).
External factors such as climatic conditions and the topo-
graphic slop of the terrain impact the spectrum of drops [4] [5]
[6]. Data obtained in laboratory allowed the development of
models and definition of a quality description vector [7] [8].
Among the most used quality description are the Volumet-
ric Mean Diameter (VMD), Sauter Mean Diameter (SMD),
Relative Amplitude (RA) and diameter of droplets D01 and
D09 that represents 10% and 90% of the total volume of
liquid is in drops of smaller diameter, respectively. All these
descriptors are organized in a quality vector where each one is
characterized in [µm] [8]. From advanced analytical models,
valuable information on the effect of the operating conditions
on the drops spectrum can be obtained. In this sense, in
Figure 1 is observed the influence of the diameter of the
output hole, for different orifice values d0 of the full cone
nozzles models CH0.5, CH1, CH3 and CH6, produced by
MAGNOJET,® on the spray cone angles for pressure and flow
established conditions [9] [10]. Thus, the strong effect on the
spray cone angle can be observed from the variation of the
hole diameter over a defined pressure.
Figure 1. Relationship between the diameter of the nozzle orifice do and the
cone angle θ for a full cone spray nozzle, simulated for different values of
pressure ∆p, for full cone nozzle.
Based on correlation analysis, each operation condition and
quality parameters were compared as shown in Table I. It
is observed that the pressure in the nozzle has a negative
correlation with most of the proposed quality descriptors.
Thus, the pressure is quite negatively correlated with the VMD
(-0.61), with the D0.1 (-0.54), SMD (-0.50), D0.9 (-0.49) and
Application Rate AR (-0.46). Besides, the pressure has a small
correlation with the Covered Area CA (-0.26) and it is not
correlated with the Relative Amplitude RA (-0.00). It is also
important to highlight the strong negative correlation of the
pressure with the other two operating conditions d0 (-0.71)
and Vp (-0.62) and this is a good indicator that the data
obtained represent in a good way the hydraulic process for
the production of droplets for full cone nozzles.
On the other hand, the velocity of application Vp has a
high positive correlation with the VMD (0.80), the diameter
D0.9 (0.75), the application rate AR (0.71), Covered Area CA
(0.66), the diameter D0.1 (0.60) and SMD (0.53). Accordingly,
just like the pressure of the nozzles, the speed of application
has a fundamental effect on the quality descriptors. Therefore,
the correlation analysis determines the relationship between
the operating conditions and the statistical moments that
determine the quality of the application. This analysis serves as
a decision-making basis for intelligent control strategies, once
it characterizes the positive or negative effect of the operating
conditions on the quality vector.
B. Application Efficiency
The efficiency is determined by biological factors related
to pests, harmful plants and the type of culture that attacks.
Frequently the prescription of agrochemical type and concen-
tration as well the nozzle type is carried out by a specialist,
is given by the Application Rate (AR) in [ℓ/ha] [11]. Thus,
efficiency is related to obtaining the appropriate AR value for
each treatment. In this sense, external and internal factors can
affect efficiency, leading to an AR error. As main internal
factors that can lead to an erroneous AR are capacity of the
sprayer to flow and pressure regulation and as a external factor,
the curvilinear maneuvers that the agricultural machinery
executes can lead to a relevant increase in AR errors. The study
of the effect of curved maneuvers on agricultural production
processes has been widely studied [12]. The kinematics on a
curved path, Figure 2, show that are different speeds for each
position of the nozzles on the sprayer boom, that is, velocity
reduction for nozzles that are in the inner side of the curve
(Left boom) .
Simulation environments, based on sprayer kinematic move-
ment models, allow determinining the effect of curvilinear
maneuvers present in real fields as well serving as a basis
for decision-making in the agricultural spraying process. In
Figure 3 the effect of curved trajectories on the pulverization
error calculated from the Application Rate (AR) was observed.
The results obtained through simulations showed the need for
individual regulation of the flow in the spray nozzles, in order
to compensate for the effects of the curvilinear path.
A feasible solution is the use of solenoid valves commanded
by a voltage in the coil that mechanically opens and closes the
valve. In Figure 4 a diagram inside a solenoid valve and a set
of solenoid valves used for agricultural spray are shown. The
internal operation of the solenoid valve (see Figure 4a) is as
follows: in the closed step, the plunger (4) does not allow fluid
to pass from the inlet (1) to the outlet (2) when solenoid coil
(5) is energized by connectors and in the open step, the return
spring (3) moves the plunger until the equilibrium position,
allowing fluid to pass from the inlet to the outlet.
17
Copyright (c) IARIA, 2023.     ISBN:  978-1-68558-083-4
ALLSENSORS 2023 : The Eighth International Conference on Advances in Sensors, Actuators, Metering and Sensing

TABLE I
CORRELATION COEFFICIENTS BETWEEN THE QUALITY DESCRIPTORS AND OPERATING CONDITIONS OF THE AGRICULTURAL SPRAYING PROCESS.
Correlation analysis for quality descriptors and operating conditions (n = 280)
∆p
Vp
d0
CA
AR
RA
VMD
D0.1
D0.9
SMD
∆p
1.00
Vp
-0.62
1.00
d0
-0.71
0.99
1.00
CA
-0.26
0.66
0.63
1.00
AR
-0.46
0.71
0.72
0.89
1.00
RA
-0.00
0.32
0.28
0.40
0.24
1.00
VMD
-0.61
0.80
0.81
0.70
0.88
0.25
1.00
D0.1
-0.54
0.60
0.63
0.53
0.83
-0.05
0.84
1.00
D0.9
-0.49
0.75
0.75
0.62
0.77
0.45
0.84
0.70
1.00
SMD
-0.50
0.53
0.55
0.48
0.64
-0.16
0.76
0.65
0.29
1.00
Figure 2. Curved path in which each nozzle has a relative speed which varies
according to its position and the curve radius R in relation to the reference
point O (figure extracted from [9])
For turbulent flow, the relationship between pressure and
flow of the main components of the hydraulic circuit such
as valves, pipes, spray nozzles and hoses is given by the
relation ∆P = KqQ2
p, where Kq is the fluidic resistance. This
information is important, since changing the spray tips varies
the hydraulic resistance of the system. Therefore, the change of
spray nozzles can be used to control or regulate the pressure
or flow of the system. The fluidic resistance ratio for three
different types of standard flat fan nozzles, used for herbicides
application,(models 11003, 11002, and 11015 of the brand
Arag®) is shown in Table II [12]. It is important to note that
the results shown in this section are carried out with different
nozzle models in relation to those used in subsection II-A.
Which does not invalidate the control topology purposed in
this work, but requires additional experimentation to adjust
the models and algorithms in order to achieve high levels of
application quality and efficiency. To observe the effect that
the switching (variation of fluidic resistance in Table II) of
the tips in the pressure and flow, two lateral spray booms were
equipped with 14 tips each, nozzle model 422WRC11002, and
the set of solenoid valves with 4 tips (V1 to V4), nozzle model
422WRC11005, was mounted on the central spray boom.
(a) Curved path
(b) Application error
Figure 3.
Kinematics simulation environment for the agricultural sprayer.
(a) Path designed to evaluate the performance of the agricultural sprayer in
curvilinear trajectories. (b) Application error in relation to the radius of the
curvilinea trajectory.
Figure 4.
Individual control system for each spray nozzle. (a) Electrome-
chanical system of the solenoid valve (b) Solenoid valves set (model QJS,
Teejet®) and nozzles (model ASJ WRC, Arag®) (Figures adapted from [12])
From this information, intelligent nozzle selection strategies
can be implemented for opening and closing solenoid valves
18
Copyright (c) IARIA, 2023.     ISBN:  978-1-68558-083-4
ALLSENSORS 2023 : The Eighth International Conference on Advances in Sensors, Actuators, Metering and Sensing

TABLE II
SET OF NOZZLES COMBINATIONS AND THE RESPECTIVE FLUIDIC
RESISTANCES
Nozzle model 422WRC
11003
11002
11015
Qmin[l/min]
0.98
0.65
0.49
Qmax[l/min]
1.39
0.92
0.69
j
Active nozzles
Kq( j)
0
0
0
0
∞
1
0
0
1
836.6
2
0
1
0
473.0
3
0
1
1
154.1
4
1
0
0
207.6
5
1
0
1
92.5
6
1
1
0
75.1
7
1
1
1
44.5
in a set. Thus, consider the following test configuration: a
sampling period of 50 ms, the solenoid valve is kept activated
for 10 seconds and the data for two pressures, 100 and 200
kPa are colect. After the implementation of an intelligent
algorithm, which properly choose the solenoid valves that
must be activated, an appropriate nozzle switching sequence
is obtained as shown in the Table III [12].
TABLE III
SEQUENCE OF TESTS USED FOR ACTIVATING THE SOLENOID VALVES
DENOTED Vk,k = 1,2,3,4
State
Active valves
Time (s)
1
None
10
2
V1
10
3
V1 and V2
10
4
V1,V2 and V3
10
5
V1,V2,V3 and V4
10
6
V2,V3 and V4
10
7
V3 and V4
10
8
V4
10
9
None
10
The results of this smart switching strategy, based on inde-
pendent actuators for each nozzle, can be observed in Figure 5.
For each fixed pressure, it was possible to obtain four different
values of flow rates, totalizing 8 possible states. In addition,
it is observed that in the experiment performed when there is
no switching of any spray nozzle (all closed), the hydraulic
pressure of the system did not increased exponentially. This
fact is because in the experiment, there are two other open
spray booms that perform this hydraulic compensation. It is
important to emphasize that when using actuators distributed
to the sprayer bar, it allows to control the flow values (main-
taining the desired AR) and additionally, it allows to regulate
the pressure in adequate values (maintaining uniformity in the
size of drops). Thus, it is observed that intelligent control
strategies and high precision actuators, allow automatic control
with great accuracy and therefore, increases the AR range
without any human intervention.
III. RESULTS AND DISCUSSIONS
Based on the new concepts, methods and technological
devices, presented in this work, the need to create intelligent
(a)
(b)
Figure 5. Pressure and flow rates obtained with the valve sequence according
to Table III. (a) In the first test the pressure is maintained at 100 kPa. (b) In
the second test the pressure is maintained at 200 kPa.
systems that can execute actions precise and efficiently in
agricultural sprayers is observed. In this context, intelligent
automatic control strategies must be implemented, which are
based on the two approaches studied: the quality and efficiency
of the application, in order to obtain a new hybrid implemen-
tation methodology.
The use of predictive control techniques (intelligent con-
troller) together with information on application quality, ob-
tained through an expert system, allows the design of new
controllers topology for use in agricultural sprayers in the form
presented in Figure6. This topology is divided into two main
layers, one related to the intelligent controller and another
related to a specialist system. The control layer is based on
predictive control techniques (C) and the plant model (G)
which must consider the delay time of the dynamics of the
19
Copyright (c) IARIA, 2023.     ISBN:  978-1-68558-083-4
ALLSENSORS 2023 : The Eighth International Conference on Advances in Sensors, Actuators, Metering and Sensing

process. In this context, the use of a conductivity sensor allows
to evaluate the delay time in direct agrochemical injection
systems for various operating conditions of an agricultural
sprayer. Information on the delay time is generally not used
in real time control due to its intrinsic relationship with past
events, but its modeling based on the variables measured
in the sprayer allows its incorporation into an algorithm
of anticipation of references increasing the accuracy of the
application [13].
Figure 6. New intelligent control topology for increased quality and efficiency
of variable rate application.
On the other hand, in the proposed topology, there is a
layer based on a specialist system. At this stage of execution,
intelligent models, based on the historical data, are developed
to deliver additional information (∆r) to adjust the reference (r)
for the control loop [8]. These reference values are delivered
as output and are calculated from data from the machine
(internal factors) and data from the environment where the
application (external factors) is performed. In the topology, this
data base is related to the requirements (quality vector values)
of application quality. Thus, from this type of architectures, a
balance between the efficiency and the quality of the variable
rate application for agricultural sprayers is obtained.
IV. CONCLUSIONS
The use of new technologies based on advanced models,
intelligent sensors and actuators, as well as adequate automatic
control strategies, allow to achieve quality and efficiency
in the application of agrochemicals. With the use of these
technologies, a reduction in human and ecological risks related
to this type of agribusiness processing can be achieved.
It is important to highlight that the integration of movement
dynamics of agricultural machinery into intelligent control
systems allows the evaluation of complex field situations and
offers knowledge bases to execute actions to mitigate their
effects.
The use of intelligent topologies for control allowed to
perform efficient actions for pesticide variable rate application.
Additionally, the intelligent system can offer adequate concep-
tual bases to perform decision-making processes to aggregate
quality during spraying, which may bring improvements to
pest control into a crop region.
REFERENCES
[1] H. V. Mercaldi, C. H. Fujiwara, E. A. G. Penaloza, V. A. de Oliveira,
and P. E. Cruvinel, “Smart and customized electrical conductivity
sensor for measurements of the response time from sprayers based on
direct injection,” in Sensors
Transducers Journal, ser. Sensor Device
Technologies and Applications, vol. 193, no. 10.
Barcelona, Spain:
IFSA, 2015, pp. 1–10.
[2] P. B. Andrade, P. E. Cruvinel, and E. A. Pe˜naloza, “Module for virtual
calibration of sensors of agricultural spraying systems (temperature,
pressure and flow) using an arduino-based architecture and a controller
area network bus (can),” in 2018 IEEE 12th International Conference
on Semantic Computing (ICSC), 2018, pp. 352–357.
[3] D. R. Schutz, H. V. Mercaldi, E. A. G. Penaloza, V. A. Oliveira, and P. E.
Cruvinel, “An intelligent fuzzy-gpc control for agricultural sprayers:
Comparison between GPC and PID fuzzy controllers,” in CONTROLO
2022, L. Brito Palma, R. Neves-Silva, and L. Gomes, Eds.
Cham:
Springer International Publishing, 2022, pp. 272–284.
[4] W. A. Sirignano, Fluid Dynamics and Transport of Droplets and Sprays.
Cambridge: Cambridge University Press, 1999.
[5] A. Lefebvre, Atomization and Sprays, ser. Combustion, Hemisphere
Publishing Corporation.
Boca Raton, FL, USA: Taylor & Francis,
1988.
[6] H. M. Hanna and B. Steward, “Soil loading effects of planter depth-
gauge wheels on early corn growth,” Applied Engineering in Agriculture,
vol. 26, no. 4, pp. 551–556, 2010.
[7] Y. Suzumura and P. E. Cruvinel, “Analysis of the quality of the efficiency
of agricultural spraying with image processing and neural networks,”
Sinergia, vol. 6, no. 2, pp. 129–137, 2005.
[8] E. A. G. Pe˜naloza, V. A. Oliveira, and P. E. Cruvinel, “Using soft sensors
as a basis of an innovative architecture for operation planning and quality
evaluation in agricultural sprayers,” Sensors, vol. 21, no. 4, 2021.
[9] E. A. G. Pe˜naloza, P. E. Cruvinel, V. A. Oliveira, and A. G. F. Costa, “A
model approach to infer the quality in agricultural sprayers supported
by knowledge bases and experimental measurements,” International
Journal of Semantic Computing, vol. 11, no. 03, pp. 279–292, 2017.
[10] R. F. Q. Magossi, E. A. G. Pe˜naloza, S. P. Battachharya, V. A.
Oliveira, and P. E. Cruvinel, “Using the measurement-based approach
to emulate the behavior of a sensor for internal hydraulic pressure drop
measurements of sprayers in the agricultural industry,” in ALLSENSORS
2017: The Second International Conference on Advances in Sensors,
Actuators, Metering and Sensing.
Nice, France: IARIA, Mar. 2017,
pp. 10–15.
[11] J. Campos, M. Gallart, J. Llop, P. Ortega, R. Salcedo, and E. Gil, “On-
farm evaluation of prescription map-based variable rate application of
pesticides in vineyards,” Agronomy, vol. 10, no. 1, 2020.
[12] H. V. Mercaldi, E. A. Pe˜naloza, R. A. Mariano, V. A. Oliveira, and P. E.
Cruvinel, “Flow and pressure regulation for agricultural sprayers using
solenoid valves,” IFAC-PapersOnLine, vol. 50, no. 1, pp. 6607–6612,
2017, 20th IFAC World Congress.
[13] K. Romero Felizardo, H. Vin´ıcius Mercaldi, P. Estev˜ao Cruvinel,
V. Alves Oliveira, and B. L Steward, “Modeling and model validation
of a chemical injection sprayer system,” Applied Engineering in Agri-
culture, vol. 32, no. 3, pp. 285–297, 2016.
20
Copyright (c) IARIA, 2023.     ISBN:  978-1-68558-083-4
ALLSENSORS 2023 : The Eighth International Conference on Advances in Sensors, Actuators, Metering and Sensing

