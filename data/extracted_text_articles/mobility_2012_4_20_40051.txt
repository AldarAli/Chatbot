Methods and Issues in Detecting Pedestrian Flows on a Mobile Adhoc Network
Ryo Nishide, Hideyuki Takada
Faculty of Information Science and Engineering
Ritsumeikan University
Kusatsu, Japan
nishider@fc.ritsumei.ac.jp, htakada@cs.ritsumei.ac.jp
Abstract—Due to the development of mobile technology
and adhoc communication, researches to extract social con-
texts including the movements and density of pedestrians
have also emerged in recent years. This study attempts to
explore methods to extract pedestrian ﬂows in a distributive
manner, deploying Bluetooth detection logs. Bluetooth devices
are widely installed in mobile equipments which pedestrians
carry with them in daily life. The results of experiments
have revealed that detection logs implicitly record traces of
surrounding pedestrian ﬂows, which might provide possibilities
to analyze and distinguish pedestrian ﬂow patterns based on
situations. Moreover, the paper has discussed the related issues
on network construction including methods for interpolating
missing detections.
Keywords-Distributive Database; Bluetooth; Social Context;
Pedestrian Flows; Mobile Devices; Adhoc Network.
I. INTRODUCTION
According to the increase of urban population and the
expansion of social activities, we cannot avoid sharing the
same public spaces with other people when traveling as
well as in daily life. In any occasion, it will be one of
the major concerns for people whether the area is crowded
or less-crowded, and sometimes, it is necessary to know
what is actually going on in such places, including the
changing ﬂow of pedestrians. On the other hand, many
location-based services have appeared on market owing
to the enhancement of computational ability and wireless
communication technology, such as WiFi [1] and Bluetooth
[2], and GPS technology [3] deployed in mobile devices.
These advancements have paved way to explore methods
for detecting pedestrian ﬂows or social contexts using high
performance mobile devices [4].
This research employs methods to extract the density
and ﬂows of pedestrians using the Bluetooth detection logs,
while considering the data management scheme on a mobile
adhoc network. This adhoc network can be generated from
connection between mobile devices to work as a distributive
database, which can be managed and updated the detection
log data, or modiﬁed the log data by accessing to geo-
metrically adjacent devices to check for missing detections.
The policy of this work is to avoid initial preparations,
such as installing a large number of expensive immovable
sensors and high performance computational equipments in
real space, in order to minimize cost, time and effort. In
this research, we focus on the attempt to extract pedestrian
ﬂows in real world, while the speciﬁc services to utilize the
detection results are left for future works.
We attempt to grasp social contexts such as changes of
pedestrian ﬂows and density by detecting the surrounding
electronic equipments. Recent handheld electronic equip-
ments like cell phone, smart phone, PDA, and laptop are
installed with wireless devices such as WiFi and Bluetooth,
which pedestrians carry with them in their daily lives. If
these devices surrounding the user are detected and logged
continuously, it may be possible to detect not only the den-
sity of crowd, but also the changes of pedestrian movements.
We have conducted a preliminary investigation to examine
the statistics of detectable types of terminal (mobile phone,
PC, etc.) at various places [5]. Comparing two wireless
technologies, WiFi and Bluetooth, WiFi was detected from
many types of electronic equipments either carried by pedes-
trians or ﬁxed in the environment. Therefore, WiFi seems
difﬁcult to discriminate the types of equipments, whether
they are carried by the pedestrians or not. On the other
hand, by the investigation of Bluetooth signals, most of the
detected Bluetooth radios were from mobile devices. In this
paper, we focus on Bluetooth devices installed in equipments
to be carried by users in order to examine the ﬂows and
movements of pedestrians.
To begin with, Section II provides the method of detecting
pedestrian ﬂows. The detection results obtained from actual
experiment have been examined in Section III. Through the
experiment, several devices were not detected within the
scanning interval. Therefore, distributive and autonomous
method to interpolate missing detection is discussed in
Section IV and V in order to enhance further analysis of
log data.
II. DETECTION OF PEDESTRIAN FLOWS
We avoid extracting the personal information of pedes-
trians, such as locations or user’s name, since collection of
such information might violate the privacy issue of pedestri-
ans. Instead, we examine the detection patterns (e.g., num-
bers and changes of simultaneous or continuous detections)
of devices carried by pedestrians surrounding the user. Fig.
1 shows an example of the pedestrians’ Bluetooth devices
which have entered the reachable communication range of
76
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-229-5
MOBILITY 2012 : The Second International Conference on Mobile Services, Resources, and Users

Figure 1.
Detection of Pedestrian Flows
the user who is conducting the experiment. User’s device
continuously sends inquiry to search for the surrounding
pedestrians’ devices, and logs the time and Bluetooth Device
Address (BDA) of devices which have responded to user’s
inquiry. BDA is a unique ID (MAC address) assigned to
each bluetooth device during manufacture process for the
purpose to identify each device. From the examination of
logs, different types of detections can be veriﬁed, such
as continuously detected, newly detected, undetected or
disappeared, and so on, which might be the key to determine
the ﬂows of dynamic pedestrians in real world. Since the
detection patterns differ depending upon the situations of
the surrounding pedestrians (Fig. 2), it might be possible
to assume the social contexts or trends and changes of
surrounding situations by analyzing such detection patterns.
III. VERIFICATION OF DETECTION PATTERNS
We have done several investigations to observe surround-
ing Bluetooth devices in various situations. To collect data,
we used HP iPAQ 112 Classic Handheld PDA, which has
been set to record BDA with a timeout interval of 6 seconds
after sending inquiry signal for every 30 seconds cycle.
Four different cases have been examined in this paper,
namely strolling in town, transporting by train, attending
the conference, and taking lunch at a cafeteria. The results
of examination of detection logs are summarized in Fig. 3.
The upper diagram of Fig. 3 shows the detection pattern
of Bluetooth devices, with the time-line expressed on the
horizontal-axis, and the device ID assigned in chronological
order of the incoming BDA on the vertical-axis. The mobile
phones are colored in red, and PCs and devices other than
mobile phones in green, and unidentiﬁed devices in blue.
The lower diagram of Fig. 3 shows the number of detected
devices, with the time-line expressed on the horizontal-axis,
and the quantity of BDA on the vertical-axis.
(a) Strolling in Town: Fig. 3(a) shows the changes of
multiple detection logs encountered while strolling in town.
Figure 2.
Detections in Different Situations
The number of BDAs is not constant as the number of
passers-by is always changing. Even if the pedestrians are
walking in the same direction, their devices disappeared
occasionally probably because their directions coincided
only for a while or their walking speed was different. On
the other hand, the same BDA was continuously identiﬁed
in some places while the examiner was dropping in stores.
(b) Transporting by Train: Fig. 3(b) shows the detection in
the train during rush hours. From the log, we can verify such
situations as: (i) devices were continuously detected from
passengers in the same car; (ii) many incoming and outgoing
devices were detected when changing the trains; and (iii) a
large number of people got on/off the train at major stations.
The passenger’s devices can be constantly detected while the
train is moving. However, due to the limited size and shape
of the car, the detection has been low even in rush hours.
(c) Attending the Conference: Fig. 3(c) shows that many
BDAs were detected continuously in the same room. As
most of the participants were staying in the room during
the conference, the number of BDAs was almost constant
(14 to 18 devices), except the time for coffee break. As the
room was wide enough to hold many people, the quantity
of detection has been kept high.
(d) Taking lunch at a Cafeteria: Fig. 3(d) shows that many
devices have been detected during lunch time, as customers
enter, take lunch and leave the cafeteria one after another.
Some devices are detected continuously with long duration,
and others are divided into several times with short duration,
because two types of situations are mixed together: people
sitting and eating lunch, and people walking around to look
for seats or friends.
These results show possibilities that the pedestrian ﬂow
can be assumed by analyzing the detection logs as follows:
• The number of BDA detection log: crowdedness of
people (requiring reference to the scale of space)
• Time length of BDA detection: people staying in same
space or duration of the event
• Appearance/Disappearance in BDA detection: peo-
ple staying, entering, leaving, or passing by
77
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-229-5
MOBILITY 2012 : The Second International Conference on Mobile Services, Resources, and Users

(a) In Town
(b) On a Train
(c) In a Conference Room
(d) In a Cafeteria
Figure 3.
Detection Pattern of BDA (upper), Detected Number of BDA (lower)
Figure 4.
Delaunay Network with Mobile Devices
The detection logs show that there are several undetected
devices even among those staying in the same space. There-
fore, a method to interpolate the missing detection is also
explored in following sections.
IV. SCHEME FOR DISTRIBUTIVE DATA MANAGEMENT
Another important issue of concern is the management
scheme of pedestrian ﬂow data obtained from each mobile
device. It is not efﬁcient to collect and manage the entire data
sent from mobile devices on a server. Therefore, a mecha-
nism is necessary to manage data and perform computation
between mobile devices cooperatively.
In this paper, we apply the method proposed in the past
works [6] to generate P2P Delaunay network, which is a
geometry-based P2P network whose topology is deﬁned by
the geometric adjacency of mobile devices as illustrated in
Fig. 4. It has the features as following: (i) each device
connects to a close-by devices based on its geographical
distance; (ii) the degree of connection for each device is
low (approximately six); (iii) the network can correspond
with join/leave of device only affecting the surrounding
devices to reconstruct and update the connection; and (iv)
the data is reachable to distant device through multi-hop
communication.
We assume that each mobile device only has the location
information of other devices, but not the knowledge of how
the other devices are connected. Thus, each mobile device
must choose the appropriate mobile devices to connect,
referring to their location information to generate a P2P
Delaunay Network. The detail algorithm for generating and
maintaining connections are discussed in the past works
[6]. Delaunay Network can be used not only to generate
or maintain connections with adjacent nodes on a plane,
but also to perform collaborative computation with adjacent
nodes described in the following section.
V. INTERPOLATION OF MISSING DETECTION
There are false-negative cases that some devices within
the communication range may not be detected. To deal with
such problems, we consider methods to check the detection
logs of adjacent nodes on Delaunay network, and interpolate
the BDA data which is deﬁnitely within the communication
range of Bluetooth device. Initially, each node sends a copy
of its own detection logs to adjacent nodes, and receives
their copy of detection logs. Then, it extracts the BDA data
which is not detected from its device, but detected from other
adjacent devices. These BDA data will be the target data
to perform interpolation, and the location of these adjacent
nodes will be the criterion to determine whether or not to
perform interpolation.
We validate only the BDA data owned by more than
three adjacent nodes to perform interpolation. That is, a
polygon is drawn using the location of adjacent nodes with
the target BDA data as vertices. If the location of its own
node is within the polygon, then the target BDA data shall
78
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-229-5
MOBILITY 2012 : The Second International Conference on Mobile Services, Resources, and Users

Figure 5.
Interpolation of BDA Data (BDA1)
be the one to be interpolated. We chose polygonal shape to
determine the interpolation, because it is obvious that the
entire polygonal region is covered from the communication
range of Bluetooth device. The purpose of this interpolation
method is to deal with missing detection, and the deforma-
tion of communication range caused by walls, buildings, and
obstacles are beyond our focus.
Fig. 5 shows the interpolation process using the Delaunay
Network. Node v0 has ﬁve adjacent neighbor nodes, namely
v1, v2, v3, v4, v5, and has the copy of their BDA detection
logs. Among the BDA on detection logs, BDA1 is the only
one that v0 does not have, but more than three adjacent
nodes (v1, v2, v4, v5) have. Using these nodes as vertices, a
polygon is drawn starting from the upper node in clockwise
direction. Finally, BDA1 can be determined to be included
in v0’s detection data, as it is allocated within the polygon.
VI. RELATED WORKS
Several researches have emerged in the attempt to extract
social contexts, owing to the development of mobile equip-
ment and adhoc communication.
O’ Neill et al. [7] and Nicolai et al. [8] examined
the correlation between Bluetooth detecting and pedestrian
movement by deploying stationary Bluetooth sensors in
the environment and analyzing the logs. Eagle et al. [9]
has shown methods to analyze social patterns of user’s
activity in a daily routine. These works show that Bluetooth
scanning and analysis of detection logs have possibility to
extract the ﬂow of pedestrians, however, not every Bluetooth
device can be guaranteed to be detected depending upon the
performance of the device and situation of the space.
To cope with such problem, Kim et al. [10] examined the
detection pattern of Bluetooth device logs, and employed
clustering algorithm and Gaussian blur to remove noises
caused by inquiry fault of undetected Bluetooth devices.
They inferred the transition time of events from multiple de-
vice detections. Weppner et al. [11] estimated crowd density
through collaboration with multiple devices to improve the
accuracy of detections. Users were assigned to carry multiple
devices to perform Bluetooth scanning together, which might
be troublesome for users.
VII. CONCLUSION
We have shown possibilities to extract pedestrian ﬂows by
detecting the surrounding Bluetooth devices, and proposed to
apply distributive methods to generate mobile adhoc network
and manage detection data on the network cooperatively.
For future works, we plan to perform detailed analysis on
Bluetooth device logs, examine the applicability with other
sensory data, and provide location-based application using
pedestrian ﬂows as social contexts. On the other hand,
we plan to continue further study on Delaunay networks,
exploring efﬁcient ways to manage social contexts data and
log ﬁles, while evaluating proposed methods to interpolate
missing data caused by inquiry faults.
REFERENCES
[1] Wi-Fi Alliance, http://www.wi-ﬁ.org (Retrieved August 23,
2012)
[2] Bluetooth Technology, http://www.bluetooth.com (Retrieved
August 23, 2012)
[3] B. Parkinson and J. Spilker Jr., Global Positioning System:
Theory and Applications, American Institute of Aeronautics
and Astronautics, 1996. ISBN 978-1-56347-106-3.
[4] P. Lukowicz, A. Pentland, and A. Ferscha, “From Context
Awareness to Socially Aware Computing,” IEEE Pervasive
Computing, 11 (1), pp. 32–41, 2012.
[5] R. Nishide, T. Ushikoshi, S. Nakamura, and Y. Kono, “Detect-
ing Social Contexts from Bluetooth Device Logs”, Supplement
Proc. Ubiquitous Computing (UbiComp), pp. 228–230, 2009.
[6] M. Ohnishi, R. Nishide, and S. Ueshima, “Incremental Con-
struction of Delaunay Overlaid Network for Virtual Collabo-
rative Space”, 3-rd Proc. Conf. on Creating, Connecting and
Collaborating through Computing (C5’05), IEEE CS Press, pp.
77–84, 2005.
[7] E. O’Neill, V. Kostakos, T. Kindberg, A.F. Schiek, A. Penn, D.
Fraser and T. Jones. “Instrumenting the city: Developing meth-
ods for observing and understanding the digital cityscape”,
UbiComp, pp. 315–332, 2006.
[8] T. Nicolai and H. Kenn. “About the relationship between peo-
ple and discoverable bluetooth devices in urban environments”,
4th int’l conf on mobile technology, applications, and systems,
pp. 72–78, 2007.
[9] N. Eagle and A. Pentland. “Reality mining: sensing complex
social systems”, Personal and Ubiquitous Computing, 10, pp.
255–268, 2006.
[10] D. Kim and D.-K. Cho, BlueSense: Detecting individuals,
locations, and regular activities from Bluetooth Signals,
http://www.cs.ucla.edu/∼dhjkim/ﬁles/pdf/cs219 BlueSense.pdf
(Retrieved August 23, 2012)
[11] J. Weppner and P. Lukowicz, “Collaborative Crowd Density
Estimation with Mobile Phones,” In Proc. ACM Workshop
on Sensing Applications on Mobile Phones at ACM SenSys,
pp.26–30, 2011.
79
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-229-5
MOBILITY 2012 : The Second International Conference on Mobile Services, Resources, and Users

