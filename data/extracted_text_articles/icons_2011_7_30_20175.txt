Reconstruction Quality of Congested Freeway Trafﬁc Patterns from Probe Vehicles
Based on Kerner’s Three-Phase Trafﬁc Theory
Jochen Palmer
IT-Designers GmbH
Entennest 2
D-73730 Esslingen, Germany
Email: jochen.palmer@it-designers.de
Hubert Rehborn
Daimler AG
GR/PTF - HPC: 050-G021
D-71059 Sindelﬁngen, Germany
Email: hubert.rehborn@daimler.com
Abstract—This paper discusses the reconstruction quality of
spatio-temporal congested freeway trafﬁc patterns depending
on the information provided by different equipment rates of
probe vehicles. Vehicles in spatio-temporal congested trafﬁc
patterns experience a sequence of accelerations and decelera-
tions. To enable vehicles and vehicular assistance applications
to react on the trafﬁc conditions, high quality trafﬁc informa-
tion is required, i.e. a high quality reconstruction of spatio-
temporal congested trafﬁc patterns. The paper uses Kerner’s
three-phase trafﬁc theory which distinguishes two different
phases in congested trafﬁc: synchronized ﬂow and wide moving
jam. This theory explains empirical trafﬁc breakdown and
resulting spatio-temporal congested trafﬁc patterns. In the
presented approach spatio-temporal congested trafﬁc patterns
are reconstructed from intelligent probe vehicle information
generated by an onboard trafﬁc state detection, identifying
trafﬁc states along a vehicle’s trajectory at any time. With
a data fusion algorithm combining the data of several probe
vehicles a detailed picture of spatio-temporal congested trafﬁc
patterns is revealed. The quality of the reconstructed congested
trafﬁc patterns is assessed by introducing quality indices for
(i) travel time, (ii) regions of synchronized ﬂow and wide
moving jams as well as (iii) fronts of synchronized ﬂow and
wide moving jams. The indices are evaluated by examining a
congested trafﬁc pattern with varying probe vehicle equipment
rates. Comparing ground truth with the reconstructed trafﬁc
pattern shows that a reconstruction quality sufﬁcient for some
ITS applications is achievable with probe vehicle equipment
rates of about 0.50 %.
Keywords-Trafﬁc monitoring; Trafﬁc state detection; Trafﬁc
data fusion; Three-phase trafﬁc theory; Trafﬁc data quality
I. INTRODUCTION
Nowadays congested trafﬁc on highways is still a major
problem with severe implications for personal life and the
economy. In recent years congested trafﬁc data was mostly
gathered with stationary loop detectors. It is expensive to
equip a road network with detectors of high quality and
small detector distance. Recent progress in mobile communi-
cation technology, like WLAN and 3G/UMTS, allows trafﬁc
data to be gathered by probe vehicles. This paper tries to
answer the question how many probe vehicles are needed to
deliver a quality of trafﬁc data comparable to a dense, high
quality detector network.
At ﬁrst Kerner’s Three Phase Trafﬁc Theory and its
impact on vehicles is described. Then the proposed method
for trafﬁc pattern reconstruction and quality indices are
introduced. The paper closes with results and conclusion.
II. KERNER’S THREE PHASE TRAFFIC THEORY
A. Elements of Three Phase Trafﬁc Theory
Based on extensive trafﬁc data analyses of available
stationary detector measurements spanning several years
Kerner discovered that in addition to free ﬂow (F) two
different trafﬁc phases must be differentiated in congested
freeway trafﬁc: synchronized ﬂow (S) and wide moving
jam (J) ([1], [2]). Empirical macroscopic spatio-temporal
objective criteria for trafﬁc phases as elements of Kerner’s
three-phase trafﬁc theory ([1], [2]) are as follows:
1) A wide moving jam is a moving jam that maintains
the mean velocity of the downstream jam front, even
when the jam propagates through any other trafﬁc state
or freeway bottleneck.
2) In contrast, the downstream front of the synchronized
ﬂow phase is often ﬁxed at a freeway bottleneck
and does not show the characteristic features of wide
moving jams.
Figure 1.
Explanation of trafﬁc phase deﬁnitions from empirical data:
Spatio-temporal overview of speed (left) and ﬂow rate of trafﬁc (right) on
a selected freeway section
However, neither the observation of speed synchronization
in congested trafﬁc nor other relationships and features
of congested trafﬁc measured at speciﬁc freeway locations
139
ICONS 2011 : The Sixth International Conference on Systems
Copyright (c) IARIA, 2011              ISBN:978-1-61208-114-4

(e.g., in the ﬂow-density plane) are a criterion for the
phase differentiation. The clear differentiation between the
synchronized ﬂow and wide moving jam phases can be made
on the above objective criteria 1) and 2) only.
Figure 1 illustrates a vehicle speed and ﬂow proﬁle over
time and space based upon real measured trafﬁc data. A
wide moving jam propagates upstream as a low speed valley
through the freeway stretch. In contrast, a second speed
valley is ﬁxed at the bottleneck location: this congested
trafﬁc phase belongs to the synchronized ﬂow phase.
B. Spatio-Temporal Congested Trafﬁc Patterns
The distribution of trafﬁc phases over time and space on
a road represents a spatio-temporal congested trafﬁc pattern.
Kerner’s three-phase trafﬁc theory is able to explain all em-
pirically measured trafﬁc patterns on various roads in many
different countries. For recognition, tracking and prediction
of the spatio-temporal congested trafﬁc patterns, based on
stationary loop detectors, the models ASDA (Automatische
Staudynamikanalyse; automatic congestion analysis) and
FOTO (Forecasting of Trafﬁc Objects) ([1], [2]) have been
proposed by Kerner based on the key elements of the theory.
Nowadays the models ASDA and FOTO are deployed
in the federal state of Hessen and in the free state of
Bavaria where they perform online processing of data. In
addition they have been successfully used in a laboratory
environment on the M42 near Birmingham, UK and the I-
405 in California, USA (Figure 2).
A3 in Northern Bavaria
Expanded pattern - M42 UK
Stable structures on A5 in Hessen
I405 in Orange County (LA) - USA
Figure 2.
Resulting empirical spatio-temporal trafﬁc patterns when
applying the models ASDA and FOTO to trafﬁc data measured in different
countries [6]
III. IMPACTS FOR VEHICLES AND VEHICULAR
ASSISTANCE APPLICATION
Vehicles driving through a spatio-temporal congested traf-
ﬁc pattern experience a number of trafﬁc state changes. A
trafﬁc state change represents a unique and exact position
in time and space where the trafﬁc phase changes, e.g.,
from free ﬂow to wide moving jam. It is experienced at any
position, where a vehicle hits the upstream or downstream
front of a region of a trafﬁc phase. In contrast a trafﬁc
phase transition represents the start point or the end point,
respectively, of a trafﬁc phase and occurs only twice for each
region of a trafﬁc phase (see ﬁgure 3).
Time
Way
State change
Phase transition
Synchronized Flow
Wide Moving Jam
Vehicle trajectory
Figure 3.
Qualitative explanation of trafﬁc phase transitions and trafﬁc
state changes a vehicle experiences on its way through a spatio-temporal
congested trafﬁc pattern
Trafﬁc state changes between the different trafﬁc phases
have impacts of different strength on the vehicle and ve-
hicular assistance applications. Two of the most distinguish-
ing parameters of different trafﬁc phases from a vehicle’s
perspective are the vehicle speed v and the vehicle density
ρ. Both parameters inﬂuence the ability of the vehicles to
choose their driving speed as well as the possibility for them
to overtake other vehicles and to freely choose their driving
lane. Different trafﬁc state changes have a different effect on
the value of these parameters. Table I and table II show the
expected changes for the possible speed v and the vehicle
density ρ, respectively.
State
to F
to S
to J
F
-
Deceleration
Strong deceleration
S
Acceleration
-
Deceleration
J
Strong acceleration
Acceleration
-
Table I
VEHICLE SPEED: CHANGE DEPENDING ON SPECIFIC TRAFFIC STATE
TRANSITIONS
State
to F
to S
to J
F
-
Increase
Strong increase
S
Decrease
-
Increase
J
Strong decrease
Decrease
-
Table II
VEHICLE DENSITY: CHANGE DEPENDING ON SPECIFIC TRAFFIC STATE
TRANSITIONS
Vehicular assistance applications, like adaptive cruise con-
trol or hybrid engine control depend on and beneﬁt from the
knowledge of the current and in some cases future values
140
ICONS 2011 : The Sixth International Conference on Systems
Copyright (c) IARIA, 2011              ISBN:978-1-61208-114-4

of these parameters, as each trafﬁc state change represents a
control and parameter adaption point for these applications.
IV. TEST AND SIMULATION ENVIRONMENT
The Kerner-Klenov microscopic three-phase trafﬁc model
([1], [2]) has been used for the generation of a large number
of single vehicle trajectories. As input data for the model a
description of the simulated track as well as initial starting
conditions of speed and ﬂow at the most upstream border are
required. All other areas in space and time are governed by
the Kerner-Klenov model. The microscopic model’s output
can be regarded as a realization of ground truth which is
qualitatively comparable to spatio-temporal congested trafﬁc
patterns measured on highways ([1], [2]).
Ground truth means that the model output represents
the reference information or the reality which should be
reconstructed by the vehicle trajectories. Quality is there-
fore measured as the difference between ground truth and
the cooperative reconstruction of spatio-temporal congested
trafﬁc patterns based on the generated trajectories.
First a trafﬁc state detection is performed in each virtual
vehicle, in order to detect all trafﬁc state changes this virtual
vehicle experiences. After that all trafﬁc state changes are
combined to a reconstructed congested trafﬁc pattern by ap-
plying a clustering algorithm. It combines the autonomously
detected trafﬁc state changes of several probe vehicles to a
collective and cooperatively reconstructed trafﬁc pattern (see
ﬁgure 4).
1. Kerner-Klenov
Model -
“Ground Truth”.
2. Virtual vehicles 
drive through 
“Ground Truth” -> 
Vehicle trajectories.
3. Traffic state 
detection in each 
virtual vehicle.
4. Cooperative 
traffic pattern 
reconstruction.
Clustering.
5. Reconstructed
congested
traffic pattern.
Comparison
Quality depending on
probe equipment rate
Figure 4.
Steps necessary for probe equipment rate investigations
A. Trafﬁc State Detection in Autonomous Vehicle
Instead of stationary loop detectors, probe vehicle data is
used for the detection and reconstruction of spatio-temporal
congested trafﬁc patterns. Many systems using probes trans-
mit only aggregated travel times for pre-deﬁned road sec-
tions. Here we are not only interested in the travel time
losses caused by spatio-temporal congested trafﬁc patterns,
but also in their detailed structure (ﬁgure 3, [1], [2]).
In Kerner’s three-phase trafﬁc theory there is one phase of
free ﬂow (F) and two phases of congested trafﬁc, synchro-
nized ﬂow (S) and wide moving jam (J). Each trafﬁc pattern
consists of a unique formation and behavior of regions in
time and space belonging to exactly one of these three
S->J
J->S
F->J
F->S
S->F
J->F
Figure 5.
State diagram for three trafﬁc phases [3]
phases. One of these three phases is assigned to each of
the probe positions in time and space in an autonomous
way ([2], [3]). A trafﬁc state change is performed when
the chosen measured values are above or below speciﬁc
thresholds in speed and time, which are chosen according
to microscopic trafﬁc criteria [2].
B. Cooperative Reconstruction of Spatio-Temporal Con-
gested Trafﬁc Patterns
For the reconstruction of spatio-temporal congested trafﬁc
patterns a clustering algorithm is employed. First the trafﬁc
phase is identiﬁed, then depending on the identiﬁed trafﬁc
phase, an algorithm tailored for the speciﬁc characteristic
features of the synchronized ﬂow and wide moving jam
trafﬁc phases is applied as shown in ﬁgure 6.
Time
Way
State change sync flow
Synchronized flow
Wide moving jam
Time
Way
State change wide moving jam
Clustering
Figure 6.
Using clustering to reconstruct trafﬁc patterns from trafﬁc state
changes [6]
V. RECONSTRUCTION QUALITY INDICES
In order to assess the quality of reconstructed spatio-
temporal congested trafﬁc patterns, the reconstructed pattern
is compared with a ground truth version of this pattern,
which represents the best known information about this
particular situation. Ground truth trafﬁc patterns are either
directly measured with high quality detection systems or
generated by a suitable simulation environment as described
above. Common to both approaches is that the ground truth
information with the highest possible quality is a continuous
information in both time and distance.
A continuous trafﬁc reality assigns a trafﬁc state TS to
each spatio-temporal position P(x, t), whereas x represents
141
ICONS 2011 : The Sixth International Conference on Systems
Copyright (c) IARIA, 2011              ISBN:978-1-61208-114-4

a continuous value in distance and t a continuous value in
time. The trafﬁc reality R represents the combination of all
TS(x, t) ∈ {F, S, J}
(1)
within the borders x and t, hence
R := {TS(x, t)|xs ≤ x ≤ xe ∧ ts ≤ t ≤ te}
(2)
Compared to R a reconstruction of trafﬁc patterns using a
model M in most cases shows deviations in time and space.
The quality Q of the reconstruction is given by the deviation
D between M and R. Hence
M := {TS(x, t)|xs ≤ x ≤ xe ∧ ts ≤ t ≤ te}
(3)
Q = DM→R
(4)
td
xd
Rd
1 = Synchronized flow [S]
2 = Wide moving jam [J]
0 = Free flow [F]
1. Continuous traffic reality
2. Discrete traffic reality
t
x
R
td
xd
Rd
Discretization
3. Example of discrete traffic situtation
Figure 7.
Discretization of spatio-temporal congested trafﬁc patterns
Currently, it is difﬁcult to measure, store and process
continuous spatio-temporal information. Therefore, usually
discrete values are used, which average time and distance
in discrete intervals. Consequently x and t degrade to the
discrete values xd and td. Their resolution represents the
quality of knowledge about the spatio-temporal information.
Using xd and td the continuous trafﬁc reality R becomes the
discrete trafﬁc reality Rd as shown in ﬁgure 7.
Rd := {TSd(x, t)|xs ≤ x0, x1...xn ≤ xe
∧ts ≤ t0, t1...tn ≤ te}
(5)
In order to determine the discrete quality Qd a discrete
model output Md with the same spatial and temporal reso-
lutions xd and td is required. For Qd this leads to
Qd = DMd→Rd
(6)
In the following a reconstruction is used synonymously
with a model Md while the known ground truth information
used as a comparison reference is used synonymously with
the reality Rd (see ﬁgure 8).
A. Quality Index for Regions of Synchronized Flow and
Wide Moving Jam
The quality index for regions of a speciﬁc trafﬁc phase
assesses the general reconstruction quality between Md and
Rd. For each congested trafﬁc phase the spatio-temporal
areas they cover are compared against each other with regard
to hits and false alarms. Figure 8 illustrates this concept,
which is an adaption of the ROC (Receiver operating char-
acteristic) analysis of trafﬁc data presented in [7] and [8] to
trafﬁc data containing three distinct trafﬁc phases.
Time
Way
R - Reality (Ground Truth)
M - Model (Reconstruction)
H - Hit
Hit rate = H / R
False alarm rate = (M - H) / M
Figure 8.
Deﬁnition of the Quality Index for Regions of Synchronized
Flow and Wide Moving Jam
The deﬁnitions of Md and Rd given in the previous
section can directly be applied to yield a computationally
efﬁcient calculation of this quality index. For both Md and
Rd three binary matrices are calculated, one for each trafﬁc
phase, which contain a 1 at all spatio-temporal positions
where a speciﬁc trafﬁc phase occurs and a 0 at all other
positions.
For Rd this leads to RF
d , RS
d and RJ
d and for Md to
M F
d , M S
d and M J
d respectively. Using a row vector rv and
a column vector cv with correct dimension for Md and Rd
with all aij = 1 allows to count the number c of elements
aij within matrix A for which aij = 1.
c = rv ∗ A ∗ cv
(7)
Using this operation leads to the quality index for hits in
regions of synchronized ﬂow,
HSync = rv ∗ (M S
d ∧ RS
d ) ∗ cv
rv ∗ RS
d ∗ cv
(8)
the quality index for false alarms in regions of synchro-
nized ﬂow,
FSync = rv ∗ (M S
d ∧ RJ
d + M S
d ∧ RF
d ) ∗ cv
rv ∗ M S
d ∗ cv
(9)
the quality index for hits in regions of wide moving jam,
142
ICONS 2011 : The Sixth International Conference on Systems
Copyright (c) IARIA, 2011              ISBN:978-1-61208-114-4

HJam = rv ∗ (M J
d ∧ RJ
d) ∗ cv
rv ∗ RJ
d ∗ cv
(10)
and the quality index for false alarms in regions of wide
moving jam.
FJam = rv ∗ (M J
d ∧ RS
d + M J
d ∧ RF
d ) ∗ cv
rv ∗ M J
d ∗ cv
(11)
All of these quality indices yield a number between 0
and 1, whereas 0 represents the minimum value and 1 the
maximum value.
B. Quality Index for Travel Time
For each point in time t the total travel time Ttotal,
consisting of free ﬂow travel time and congested travel time,
can be calculated as shown in [4]
Ttotal(t) = LF (t)
vF (t) + LJ(t)
vJ(t) + LS(t)
vS(t)
(12)
where LF (t), LS(t) and LJ(t) represent the lengths of
the trafﬁc phases and vF (t), vS(t) and vJ(t) represent the
average speeds within these phases at time t. The relative
average deviation ∆T between the travel time reported by
the reconstruction TM and the travel time TR reported by
the reference ground truth information is now given by [5].
∆T = 1
N
N
X
t=1
|TM(t) − TR(t)|
TR(t)
(13)
As a result ∆T is a number ≥ 0, whereas a result of
∆T = 0 represents the best possible quality.
C. Quality Index for Fronts of Synchronized Flow and Wide
Moving Jam
The quality index for fronts of synchronized ﬂow and
wide moving jam calculates the average deviation for each
point in time t.
The deviation is calculated between the front position
reported by the model M and the front position reported
by the ground truth information R for both the upstream
and downstream front. This results in ∆up and ∆down
respectively.
∆up = 1
N
N
X
t=1
|posup
M (t) − posup
R (t)|
(14)
∆down = 1
N
N
X
t=1
|posdown
M
(t) − posdown
R
(t)|
(15)
Again both ∆up and ∆down give a result ≥ 0 m whereas
a result of 0 m represents the best possible quality.
Speed
Traffic State
Figure 9.
Kerner-Klenov simulation output of a general pattern - Ground
Truth
0.75% probe density, uniformly distributed                  
0.50 % probe density, randomly distributed
Figure 10.
Example results for uniform and random distributions of probe
vehicles
VI. RESULTS
A. Examined Situation
For evaluation the Kerner-Klenov three-phase microscopic
model was used to simulate a spatio-temporal congested
trafﬁc pattern. The simulation was conﬁgured to simulate
a 20 km highway stretch with 2 lanes and one on-ramp. By
increasing the incoming ﬂow an on-ramp bottleneck was
established, leading to an F → S trafﬁc breakdown and
the formation of a region of synchronized ﬂow. Within the
synchronized ﬂow region several wide moving jams emerged
(ﬁgure 9).
Example results of the trafﬁc state detection and clustering
processing based on probe vehicle data are shown in ﬁgure
10. In the following the quality index results of this process
are compared with results of the ASDA/FOTO models.
ASDA/FOTO was used with a high quality stationary loop
detector network having detector distance of 1-2 km.
B. Quality Index for Regions of Synchronized Flow and
Wide Moving Jam
Method
Det./Veh.
HSync
FSync
HJam
FJam
ASDA/FOTO
1 km Det. dist.
0.83
0.12
0.81
0.24
ASDA/FOTO
2 km Det. dist.
0.77
0.16
0.65
0.25
Probe Veh.
1.50 % uniform
0.89
0.17
0.83
0.24
Probe Veh.
0.38 % uniform
0.82
0.24
0.73
0.21
Probe Veh.
0.50 % random
0.78
0.21
0.72
0.22
Table III
QUALITY INDEX RESULTS FOR DIFFERENT METHODS AND DETECTOR
DISTANCES / PROBE EQUIPMENT RATES
143
ICONS 2011 : The Sixth International Conference on Systems
Copyright (c) IARIA, 2011              ISBN:978-1-61208-114-4

b)
0
0,25
0,5
0,75
1
0
20
40
Random Sample (0.50% Probe Vehicles)
Quality Ratio
H(Sync)
F(Sync)
H(Jam)
F(Jam)
a)
0
0,25
0,5
0,75
1
0,00
0,50
1,00
1,50
Equipped Probe Vehicles [%]
Quality Ratio
H(Sync)
F(Sync)
H(Jam)
F(Jam)
Figure 11.
Quality index results for uniform (a) and random (b) probe
vehicle distributions
Table III and ﬁgure 11 show that the results of the region
quality index for a equipment rate of 0.38 % uniformly
distributed as well as a equipment rate of 0.50 % randomly
distributed are comparable to the established ASDA/FOTO
method using detector distances between 1-2 km.
C. Quality Index for Travel Time
Method
Det./Veh.
∆T
ASDA/FOTO
1 km Det. dist.
0.038
ASDA/FOTO
2 km Det. dist.
0.061
Probe Veh.
1.50 % uniform
0.033
Probe Veh.
0.38 % uniform
0.065
Probe Veh.
0.50 % random
0.053
Table IV
TRAVEL TIME QUALITY INDEX RESULTS FOR DIFFERENT METHODS AND
DETECTOR DISTANCES / PROBE EQUIPMENT RATES
The travel time quality index conﬁrms the results of the
region quality index (see table IV and ﬁgure 12).
VII. CONCLUSION
Probe vehicle equipment rates of 0.38 % uniformly dis-
tributed and 0.50 % randomly distributed processed with the
proposed method are comparable to detectors with distances
of 1-2 km processed with the existing system ASDA/FOTO.
In addition the proposed method promises the provision
of high quality trafﬁc data on all highways while existing
systems rely on stationary loop detectors. Higher probe
vehicle equipment rates promise an even higher quality
trafﬁc data suitable for future ITS and vehicular assistance
applications. Subjects of further ongoing research are the
evaluation of the quality index for fronts of synchronized
b)                      
0
0,05
0,1
0,15
0
20
40
Random Sample (0.50% Probe Vehicles)
Quality Ratio
a)
0
0,05
0,1
0,15
0,00
0,50
1,00
1,50
Equipped Probe Vehicles [%]
Quality Ratio
Figure 12.
Travel time quality index results for uniform (a) and random
(b) probe vehicle distributions
ﬂow and wide moving in combination new vehicular as-
sistance applications as well as system communication and
architecture alternatives.
ACKNOWLEDGMENT
The authors would like to thank Boris S. Kerner and
Sergey L. Klenov for support regarding the microscopic
three-phase trafﬁc model and many fruitful discussions.
REFERENCES
[1] B. S. Kerner, The Physics of Trafﬁc
Berlin, New York:
Springer, 2004.
[2] B. S. Kerner, Introduction to Modern Trafﬁc Flow Theory and
Control
Berlin, New York: Springer, 2009.
[3] B. S. Kerner, S. L. Klenov, J. Palmer, M. Prinn and H. Rehborn,
German Patent Publication DE 10 2008 003 039 A1, 2008.
[4] H. Rehborn and J. Palmer, ASDA/FOTO based on Kerner’s
Three-Phase Trafﬁc Theory in North Rhine-Westphalia and
its Integration into Vehicles
2008 IEEE Intelligent Vehicles
Symposium, Eindhoven, 2008.
[5] J. Palmer and H. Rehborn, Reconstruction of Congested Trafﬁc
Patterns Using Trafﬁc State Detection in Autonomous Vehicles
Based on Kerner’s Three Phase Trafﬁc Theory
16th World
Congress on ITS, Stockholm, 2009.
[6] J. Palmer and H. Rehborn, Vehicular Assistance Applications
in the Scope of Kerner’s Three-Phase Trafﬁc Theory Networks
for Mobility - 5th International Symposium, Stuttgart, 2010.
[7] K.
Bogenberger,
Qualitaet
von
Verkehrsinformationen
Strassenverkehrstechnik, Kirschbaum Verlag GmbH Bonn,
10:518 - 526, 2003.
[8] S. Lorkowski, Fusion von Verkehrsdaten mit Mikromodellen
am Beispiel von Autobahnen PhD Thesis, Technical University
of Berlin, 2009.
144
ICONS 2011 : The Sixth International Conference on Systems
Copyright (c) IARIA, 2011              ISBN:978-1-61208-114-4

