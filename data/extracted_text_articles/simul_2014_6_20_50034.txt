Rare Event Handling in Signalling Cascades
Benoˆıt Barbot, Serge Haddad and Claudine Picaronny
LSV, ENS Cachan & CNRS & Inria,
Cachan, France
{barbot,haddad,picaronny}@lsv.ens-cachan.fr
Monika Heiner
Brandenburg University of Technology,
Cottbus, Germany
monika.heiner@b-tu.de
Abstract—Signalling cascades are a recurrent pattern of biological
regulatory systems whose analysis has deserved a lot of attention.
It has been shown that Stochastic Petri Nets (SPN) are appro-
priate to model such systems and evaluate the probabilities of
speciﬁc properties. Such an evaluation can be done numerically
when the combinatorial state space explosion is manageable
or statistically otherwise. However, when the probabilities to
be evaluated are too small, random simulation requires more
sophisticated techniques for the handling of rare events. In this
paper, we show how such involved methods can be successfully
applied for signalling cascades. More precisely, we study three
relevant properties of a signalling cascade with the help of the
COSMOS tool. Our experiments point out interesting dependencies
between quantitative parameters of the regulatory system and its
transient behaviour. In addition, they demonstrate that we can
go beyond the capabilities of MARCIE, which provides one of the
most efﬁcient numerical solvers.
Keywords–Rare event; Importance sampling; Signalling cas-
cade.
I.
INTRODUCTION
Signalling cascades: Signalling processes play a crucial
role for the regulatory behaviour of living cells. They mediate
input signals, i.e., the extracellular stimuli received at the cell
membrane, to the cell nucleus, where they enter as output
signals the gene regulatory system. Understanding signalling
processes is still a challenge in cell biology. To approach this
research area, biologists design and explore signalling net-
works, which are likely to be building blocks of the signalling
networks of living cells. Among them are the type of signalling
cascades which we investigate here.
A signalling cascade is a set of reactions which can be
grouped into levels. At each level a particular enzyme is
produced (e.g., by phosphorylation); the level generally also
includes the inverse reactions (e.g., dephosphorylation). The
system constitutes a cascade since the enzyme produced at
some level is the catalyser for the reactions at the next level.
The catalyser of the ﬁrst level is usually considered to be
the input signal, while the catalyser produced by the last
level constitutes the output signal. The transient behaviour of
such a system presents a characteristic shape, the quantity of
every enzyme increases to some stationary value. In addition,
the increases are temporally ordered w.r.t. the levels in the
signalling cascade. This behaviour can be viewed as a signal
travelling along the levels, and there are many interesting
properties to be studied like the travelling time of the signal,
the relation between the variation of the enzymes of two
consecutive levels, etc.
In [1], it has been shown how such a system can be
modelled by a Petri net which can either be equipped with
continuous transition ﬁring rates leading to a continuous Petri
net which determines a set of differential equations or by
stochastic transition ﬁring rates leading to a SPN. This ap-
proach emphasises the importance of Petri nets which, depend-
ing on the chosen semantics, permit to investigate particular
properties of the system. In this paper, we wish to explore the
inﬂuence of stochastic features on the signalling behaviour,
and thus we focus on the use of SPN.
Analysis of SPNs can be performed either numerically or
statistically. The former approach is much faster than the latter
and provides exact results up to numerical approximations, but
its application is limited by the memory requirements due to
the combinatory explosion of the state space.
Statistical evaluation of rare events: Statistical analysis
means to estimate the results by evaluating a sufﬁcient number
of simulations. However, standard simulation is unable to
efﬁciently handle rare events, i.e., properties whose probability
of satisfaction is tiny. Indeed, the number of trajectories to
be generated in order to get an accurate interval conﬁdence
for rare events becomes prohibitively huge. Thus, acceleration
techniques [2] have been designed to tackle this problem
whose principles consist in (1) favouring trajectories that
satisfy the property, and (2) numerically adjusting the result
to take into account the bias that has been introduced. This
can be done by splitting the most promising trajectories [3]
or importance sampling [4], i.e., modifying the distribution
during the simulation. In a previous work [5], some of us
have developed an original importance sampling method based
on the design and numerical analysis of a reduced model in
order to get the importance coefﬁcients. This method was
ﬁrst proposed for checking “unbounded until” properties over
models whose semantics is a discrete time Markov chain, it
has been extended to also handle “bounded until” properties
and continuous time Markov chains [6].
Our contribution: In this paper, we consider three families
of properties for signalling cascades that are particularly rele-
vant for the study of their behaviour and that are (depending
on a scaling parameter) potentially rare events. From an
algorithmic point of view, this case study raises interesting
issues since the combinatorial explosion of the model quickly
forbids the use of numerical solvers and its intricate (quanti-
tative) behaviour requires elaborated and different abstractions
depending on the property to be checked.
Due to these technical difﬁculties, the signalling cascade
analysis has led us to substantially improve our method and
in particular the way we obtain the ﬁnal conﬁdence interval.
From a biological point of view, experiments have pointed out
interesting dependencies between the scaling parameter of the
model and the probability of satisfying a property.
Organisation: In Section II, we present the biological back-
126
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

ground, the signalling cascade under study and the properties
to be studied. Then, in Section III after some recalls on SPN,
we model signalling cascades by SPNs. We introduce the rare
event issue and the importance sampling technique to cope
with in Section IV. In Section V, we develop our method
for handling rare events. Then, in Section VI, we report and
discuss the results of our experiments. Finally in Section VII,
we conclude and give some perspectives to our work. Addi-
tional explanations related to model abstractions, algorithmic
considerations, and experimental statistical analysis can be
found in the following research report [7].
II.
SIGNALLING CASCADES
In technical terms, signalling cascades can be understood as
networks of biochemical reactions transforming input signals
into output signals. In this way, signalling processes determine
crucial decisions a cell has to make during its development,
such as cell division, differentiation, or death. Malfunction
of these networks may potentially lead to devastating con-
sequences on the organism, such as outbreak of diseases or
immunological abnormalities. Therefore, cell biology tries to
increase our understanding of how signalling cascades are
structured and how they operate. However, signalling networks
are generally hard to observe and often highly interconnected,
and thus signalling processes are not easy to follow. For this
reason, typical building blocks are designed instead, which are
able to reproduce observed input/output behaviours.
Raf
RafP
MEKP
MEKPP
MEK
ERKP
ERKPP
ERK
Phosphatase3
Phosphatase1
Phosphatase2
RasGTP
Figure 1. The general scheme of the considered three-level signalling
cascade; RasGTP serves as input signal and ERKPP as output signal.
The case study we have chosen for our paper is such a
signalling building block: the mitogen-activated protein kinase
(MAPK) cascade [8]. This is the core of the ubiquitous
ERK/MAPK network that can, among others, convey cell
division and differentiation signals from the cell membrane
to the nucleus. The description starts at the RasGTP complex
which acts as an enzyme (kinase) to phosphorylate Raf, which
phosphorylates MAPK/ERK Kinase (MEK), which in turn
phosphorylates Extracellular signal Regulated Kinase (ERK).
We consider RasGTP as the input signal and ERKPP (activated
ERK) as the output signal. This cascade (RasGTP → Raf →
MEK → ERK) of protein interactions is known to control cell
differentiation, while the strength of the effect depends on the
ERK activity, i.e., concentration of ERKPP.
The scheme in Figure 1 describes the typical modular
structure for such a signalling cascade [9]. Each layer cor-
responds to a distinct protein species. The protein Raf in
the ﬁrst layer is only singly phosphorylated. The proteins in
the two other layers, MEK and ERK, respectively, can be
singly as well as doubly phosphorylated. In each layer, for-
ward reactions are catalysed by kinases and reverse reactions
by phosphatases (Phosphatase1, Phosphatase2, Phosphatase3).
The kinases in the MEK and ERK layers are the phospho-
rylated forms of the proteins in the previous layer. Each
phosphorylation/dephosphorylation step applies mass action
kinetics according to the pattern A + E ⇌ AE → B + E.
This pattern reﬂects the mechanism by which enzymes act:
ﬁrst building a complex with the substrate, which modiﬁes
the substrate to allow for forming the product, and then
disassociating the complex to release the product; for details
see [10].
Having the wiring diagram of the signalling cascade, a
couple of interesting questions arise whose answers would
shed some additional light on the subject under investigation.
Among them are an assessment of the signal strength in each
level, and speciﬁcally of the output signal. We will consider
these properties in Sections VI-A and VI-B. The general
scheme of the signalling cascade also suggests a temporal
order of the signal propagation in accordance with the level
order. What cannot be derived from the structure is the extent
to which the signals are simultaneously produced; we discuss
this property in the technical report [7].
III.
PETRI NET MODELLING
Stochastic Petri nets: Due to their graphical representa-
tion and bipartite nature, Petri nets are highly appropriate to
model biochemical networks. When equipped with a stochastic
semantics, yielding SPN [11], they can be used to perform
quantitative analysis.
Deﬁnition
1
(SPN). A SPN N
is deﬁned by a tuple
(P, T, Pre, Post, {µt}t∈T ) where P is a ﬁnite set of places,
T is a ﬁnite set of transitions, Pre, Post are matrices from
P × T to N, and {µt}t∈T is a set of mappings from NP to
R>0.
A marking m of SPN N is an item of NP . A transition
t ∈ T is ﬁreable in marking m if for all places p ∈ P m(p) ≥
Pre(p, t). Its ﬁring leads to marking m′ deﬁned by: for all
p ∈ P m′(p) = m(p) − Pre(p, t) + Post(p, t). This ﬁring is
denoted either m
σ−→ m′ or as m
t−→ omitting the next marking.
We extend these notations for any σ = σ1 . . . σn ∈ T ∗ of
successive ﬁreable transitions, if σ is ﬁreable from m, that is
if there exists a sequence of markings m = m0, m1, . . . , mn
such that for all 0 ≤ k < n, mk
σk
−→ mk+1. Let m0 be an ini-
tial marking, the reachability set Reach(N, m0) is deﬁned by:
Reach(N, m0) = {m | ∃σ ∈ T ∗ m0
σ−→ m}. The initialised
SPNs (N, m0) that we consider do not have deadlocks: for
all m ∈ Reach(N, m0) there exists t ∈ T such that m
t−→.
each transition t is equipped with a mapping µt. In a marking
m, each enabled transition of the Petri net randomly selects
an execution time according to a Poisson process with rate
µt(m). Then, the transition with earliest ﬁring time is selected
127
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

TABLE I. DEVELOPMENT OF THE STATE SPACE FOR INCREASING N.
N
number of states
N
number of states
1
24,065 (4)
6
769,371,342,640 (11)
2
6,110,643 (6)
7
5,084,605,436,988 (12)
3
315,647,600 (8)
8
27,124,071,792,125 (13)
4
6,920,337,880 (9)
9
122,063,174,018,865 (14)
5
88,125,763,956 (10)
10
478,293,389,221,095 (14)
to ﬁre yielding the new marking. Operational semantics of a
SPN is a Continuous Time Markov Chain (CTMC). This can
be formalized as follows.
Deﬁnition 2 (CTMC of a SPN). Let N be a SPN and m0 be
an initial marking. Then the CTMC associated with (N, m0)
is deﬁned by its set of states which is Reach(N, m0), its
transition matrix P deﬁned by Equation 1
P(m, m′) =
P
m
t−→m′ µt(m)
P
m
t−→ µt(m)
(1)
and, for each state m, the rate λm deﬁned by:
λm = P
m
t−→ µt(m)
Running case study: We now explain how to model our
running case study in the Petri net framework. The signalling
cascade is made of several phosphorylation/dephosphorylation
steps, which are built on mass/action kinetics. Each step
follows the pattern A + E ⇌ AE → B + E and is modelled
by a small Petri net component depicted in Figure 2. The
mass action kinetics is expressed by the rate of the transitions.
The marking-dependent rate of each transition is equal to the
product of the number of tokens in all its incoming places up
to a multiplicative constant given by the biological behaviour
(summing up dependencies on temperature, pressure, volume,
etc.).
The whole reaction network based on the general scheme
of a three-level double phosphorylation cascade, as given in
Figure 1, is modelled by the Petri net in Figure 3. The input
signal is the number of tokens in the place RasGTP, and the
output signal is the number of tokens in the place ERKPP.
This signalling cascade model represents a self-contained
and closed system. It is covered with place invariants (see
the research report for details), speciﬁcally each layer in the
cascade forms a place invariant consisting of all states a
protein can undergo; thus the model is bounded. Assuming
an appropriate initial marking, the model is also live and
reversible; see [1] for more details, where this Petri net has
been developed and analysed in the qualitative, stochastic and
continuous modelling paradigms. In our paper we extend these
analysis techniques for handling properties corresponding to
rare events.
We introduce a scaling factor N to parameterize how many
tokens are spent to specify the initial marking. Increasing the
scaling parameter can be interpreted in two different ways:
either an increase of the biomass circulating in the closed
system (if the biomass value of one token is kept constant), or
an increase of the resolution (if the biomass value of one token
inversely decreases, called level concept in [1]). The kind of
interpretation does not inﬂuence the approach we pursue in
this paper.
Increasing N increases the size of the state space and thus
of the CTMC, as shown in Table I, which has been computed
E
B
AE
A
r3
r2
r1
Figure 2. Petri net pattern for mass action kinetics
A + E ⇌ AE → B + E.
Raf
N*4
RasGTP N
Raf_RasGTP
RafP
RafP_Phase1
MEK_RafP
MEKP_RafP
MEKP_Phase2
MEKPP_Phase2
ERK
N*3
ERK_MEKPP
ERKP_MEKPP
ERKP
MEKPP
ERKPP_Phase3
ERKP_Phase3
MEKP
ERKPP
Phase2
N*2
Phase3
N*3
MEK
N*2
Phase1
N*3
k1
k2
k3
k4
k5
k6
k7
k8
k9
k10
k11
k12
k15
k16
k17
k18
k19
k20
k21
k22
k23
k24
k27
k28
k29
k30
k13
k14
k25
k26
Figure 3. A Petri net modelling the three-level signalling cascade given in
Figure 1; ki are the kinetic constants for mass action kinetics, N the scaling
parameter.
with the symbolic analysis tool MARCIE [12]. As expected, the
explosion of the state space prevents numerical model checking
for higher N and thus calls for statistical model checking.
Furthermore, increasing the number of states actually de-
crease the probabilities to be in a certain state, as the total
probability of 1 is ﬁxed. With the distribution of the probability
mass of 1 over an increasingly huge number of states, we
obtain sooner or later states with very tiny probabilities, and
thus rare events. Neglecting rare events is usually appropriate
when focusing on the averaged behaviour. But they become
crucial when certain jump processes such as mutations under
rarely occurring conditions are of interest.
IV.
STATISTICAL MODEL CHECKING WITH RARE EVENTS
A. Statistical model checking and rare events
Simulation recalls: The statistical approach for evaluating
the expectation E(X) of a random variable X related to a
random path in a Markov chain is generally based on three
parameters: the number of simulations K, the conﬁdence level
γ, and the width of the conﬁdence interval lg (see [13]). Once
the user provides two parameters, the procedure computes the
remaining one. Then it performs K simulations of the Markov
chain and outputs a conﬁdence interval [L, U] with a width of
128
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

at most lg such that E(X) belongs to this interval with a
probability of at least γ.
Statistical evaluation of a reachability probability: Let C be
a Discrete Time Markov Chain (DTMC) with two absorbing
states s+ or s−, such that the probability to reach s+ or s−
from any state is equal to 1. Assume one wants to estimate p,
the probability to reach s+. Then the simulation step consists
in generating K paths of C which end in an absorbing state.
Let K+ be the number of paths ending in state s+. The random
variable K+ follows a binomial distribution with parameters
p and K. Unfortunately, when p ≪ 1, the number of paths
required for a small conﬁdence interval is too large to be
simulated. This issue is known as the rare event problem.
Importance sampling: In order to tackle the rare event
problem, the importance sampling method relies on a choice
of a biased distribution that will artiﬁcially increase the fre-
quency of the observed rare event during the simulation. The
generation of paths is done according to a modiﬁed DTMC C′,
with the same state space, but modiﬁed transition matrix P′.
P′ must satisfy Property 2:
P(s, s′) > 0 ⇒ P′(s, s′) > 0 ∨ s′ = s−
(2)
which means that this modiﬁcation cannot remove transitions
that have not s− as target, but can add new transitions. The
method maintains a correction factor called L initialised to 1;
this factor represents the likelihood of the path. When a path
crosses a transition s → s′ with s′ ̸= s−, L is updated by
L ← L P(s,s′)
P′(s,s′). When a path reaches s−, L is set to zero.
If P′ = P (i.e., no modiﬁcation of the chain), the value of
L when the path reaches s+ (resp. s−) is 1 (resp. 0). Let Vs
(resp. Ws) be the random variable associated with the ﬁnal
value of L for a path starting in x in the original model C
(resp. in C′). By deﬁnition, the expectation E(Vs0) = p and
by construction of the likelihood, E(Ws0) = p. Of course, a
useful importance sampling should reduce the variance of Ws0
w.r.t. to the one of Vs0 equal to p(1 − p) ≈ p for a rare event.
V.
OUR METHODOLOGY FOR IMPORTANCE SAMPLING
A. Previous work
In [5][6], we provided a method to compute a biased
distribution for importance sampling: we manually design an
abstract smaller model, with a behaviour close to that of the
original model, that we call the reduced model. This is done
by lumping together some states with the objective of making
the rare event less rare. We perform numerical computations
on this smaller model to obtain the biased distribution. We
applied this method in order to tackle the estimation of time
bounded property in CTMCs, that is the probability to satisfy
a formula aU [0,τ]b, when it is a rare event. Let us outline the
different steps of the method which is depicted in Figure 4.
Abstraction of the model: As discussed above, given a SPN
N modelling the system to be studied, we manually design an
appropriate reduced one N • and a correspondence function f
from states of N to states of N •. Function f is deﬁned at the
net level (see Section VI).
Structural analysis: Importance sampling was originally
proposed for DTMCs. In order to apply it for CTMC C
associated with net N, we need to uniformize C (and also
C• associated with N •) which means ﬁnding a bound Λ for
exit rate of states, i.e., markings, considering Λ as the uniform
N
Abstraction
N •
Structural
Analysis
Λ
τ
Fox-Glynn
truncation
{cn}n+
n−
n+, n−
Computation of
the embedded
DTMC
C•
Λ
f
Numerical
evaluation
Simulation with
importance sampling
{µ•
n}n+
n−
Conﬁdence interval
generation
Figure 4. Principles of the methodology for estimating probability of
occurrence of rare events.
exit rate of states and rescaling accordingly the transition
probability matrices [14]. Since the rates of transitions depend
on the current marking, determining Λ requires a structural
analysis like invariant computations for bounding the number
of tokens in places.
Fox-Glynn truncation: Given a uniform chain with initial
state s0, exit rate Λ, and transition probability matrix P, the
state distribution πτ at time τ is obtained by the following
formula: πτ(s) = P
n≥0
e−Λτ (Λτ)n
n!
Pn(s0, s). This value can
be estimated, with sufﬁcient precision, by applying [15]. Given
two numerical accuracy requirements α and β, truncation
points n− and n+ and values {cn}n−≤n≤n+ are determined
such that for n− ≤ n ≤ n+: cn(1−α−β) ≤ e−Λτ (Λτ)n
n!
≤ cn,
P
n<n−
e−Λτ (Λτ)n
n!
≤ α and P
n>n+
e−Λτ (Λτ)n
n!
≤ β.
Computation of the embedded DTMC: We build the embed-
ded DTMC C•
Λ of N • after uniformization. Since we want to
evaluate the probability to satisfy formula aU [0,τ]b, the states
satisfying a (resp. ¬a ∧ ¬b) are aggregated into an absorbing
accepting (resp. rejecting) state. Let µn(s•) be the probability
to be in the accepting state at time τ starting from state s•.
Numerical evaluation: Matrix P′ used for importance sam-
pling simulation in the embedded DTMC of N to evaluate
formulas aU [0,n]b for n− ≤ n ≤ n+, is based on the
distributions {µ•
n}0<n≤n+, where µ•
n(s•) is the probability
that a random path of the embedded DTMC of N • starting
from s• fulﬁlls aU [0,n]b. Such a distribution is computed by a
standard numerical evaluation. However since n+ can be large,
depending on the memory requirements, this computation can
be done statically for all n or dynamically for a subset of such
n during the importance sampling simulation (more details are
given in the research report).
Simulation with importance sampling: Here the random
distribution of the successors of a state depend on both the em-
bedded DTMC CΛ and the values computed by the numerical
evaluation. Moreover, all formulas aU [0,n]b for n− ≤ n ≤ n+
have to be evaluated increasing the time complexity of the
method.
129
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

Generation of the conﬁdence interval: After the simulations
we get a family of conﬁdence intervals indexed by n− ≤ n ≤
n+. Using Fox-Glynn truncation, we weight and combine the
conﬁdence intervals and return the ﬁnal interval.
B. Tackling signalling cascades
Tackling signalling cascades leads us to two improvements:
(1) we have performed a much more efﬁcient importance
sampling simulation and (2) we have proposed different ways
of computing conﬁdence intervals. We now detail these issues.
Importance sampling for multiple formulas: A naive im-
plementation would require to apply statistical model checking
of formulas aU [0,n]b for all n between n− and n+, but such
a number can be large. A more tricky alternative consists in
producing all trajectories until time horizon n+ and updating
the simulation results at the end of a trajectory for all the
intervals [0, n] with n− ≤ n ≤ n+ as follows. If the trajectory
has reached the absorbing rejecting state s− then it is an
unsuccessful trajectory for all intervals. Otherwise if it has
reached the absorbing accepting state s+ at time n0 then for
all n ≥ n0 it is a successful trajectory and for all n < n0 it is
unsuccessful. Doing this way, every trajectory contributes to
all evaluations, and we signiﬁcantly increase the sample size
without increasing computational cost. The accuracy of the
results is improved.
Conﬁdence interval estimation: The result of each trajec-
tory of the simulation is a realisation of the random variable
Ws0
= Xs0Ls0 where the binary variable Xs0 indicates
whether a trajectory starting from s0 is succesful and the
positive random variable Ls0 is the (random) likelihood.
Observe that E(Ws0) = E(Ls0|Xs0 = 1)E(Xs0). Since
Xs0 follows a Bernoulli distribution, a conﬁdence interval
can be easily computed for E(Xs0). For E(Ls0|Xs0 = 1)
several approaches are possible among them we have selected
three possible computations ranked by conservation degree.
The ﬁrst method assumes that the distribution is Gaussian
(which is asymptotically valid if the variance is ﬁnite, thanks
to the central limit theorem). Another method uses a pseudo
Chernoff-Hoeffding bound. Whenever the random variable is
bounded, this method is asymptotically valid. In our case we
use the minimal and maximal values observed during the
simulation as the bounds of Ls0. The last method consists
in returning the minimal and maximal observed values as the
conﬁdence interval.
VI.
EXPERIMENTS
We have analysed two properties, the one of them is
inspired by [1]. Recall that the initial marking of the model is
parametrized by a scaling factor N. For the ﬁrst propertie, the
reduced model is the same model but with local smaller scaling
factors on the different layers of phosphorylation. Every state
of the initial model is mapped (by f) to a state of the abstract
model which has the “closest” proportion of chemical species.
For instance let N = 4, which corresponds to 16 species of
the ﬁrst layer, a state with 6 tokens in Raf and 10 tokens in
RafP is mapped, for a reduced model with N = 3, to a state
with 4 = ⌊6 × 3/4⌋ tokens in Raf and 8 = ⌈10 × 3/4⌉ tokens
in RafP (see the research report for a speciﬁcation of f).
All statistical experiments have been carried out with our
tool COSMOS [16]. COSMOS is a statistical model checker
for the HASL logic [16]. It takes as input a Petri net (or a
high-level Petri net) with general distributions for transitions.
It performs an efﬁcient statistical evaluation of the SPN by
generating a code per model and formula. In the case of
importance sampling, it additionally takes as inputs the reduced
model and the mapping function speciﬁed by a C function and
returns the different conﬁdence intervals. All experiments have
been performed on a machine with 16 cores running at 2 GHz
and 32 GB of memory both for the statistical evaluation of
COSMOS and the numerical evaluation of MARCIE.
We perform additional experiments with a third property,
which can be found in the research report.
A. Maximal peak of the output signal
The ﬁrst property is expressed as a time-bounded reacha-
bility formula assessing the strength of the output signal of
the last layer: “What is the probability to reach within 10
time units a state where the total mass of ERK is doubly
phosphorylated?”, associated with probability p1 deﬁned by:
p1 = Pr(True U≤10(ERKPP = 3N))
The inner formula is parametrized by N, the scaling factor
of the net (via its initial marking). The reduced model that
we design for COSMOS uses different scaling factors for the
three layers in the signalling cascade. The ﬁrst two layers of
phosphorylation which are based on Raf and MEK always use
a scaling factor of 1, whereas the last layer involving ERK
uses a scaling factor of N. The second column of Table II
shows the ratio between the number of reachable states of the
original and the reduced models.
We have performed experiments with both COSMOS and
MARCIE. The time and memory consumptions for increasing
values of N are reported in Table II. For each value of N we
generate one million trajectories with COSMOS. We observe
that the time consumption signiﬁcantly increases between
N = 3 and N = 4. This is due to a change of strategy in
the space/time trade-off in order to not exceed the machine
memory capacity. MARCIE suffers an exponential increase
w.r.t. both time and space resources. When N = 3, it is slower
than COSMOS and it is unable to handle the case N = 4.
Table II depicts the values returned by the two tools:
MARCIE returns a single value, whereas COSMOS returns three
conﬁdence intervals (discussed above) with a conﬁdence level
set to 0.99. We observe that conﬁdence intervals computed
by the Gaussian analysis neither contain the result, the ones
computed by Chernoff-Hoeffding do not contain it for N = 3,
and the most conservative ones always contain it (when this
result is available). An analysis of the likelihood Ls0 is detailed
in the research report. It appears that the probability p1 depends
on N in an exponential way: p1 ≈ 800(3 · 10−15)N. The
constants occurring in the formula could be interpreted by
biologists.
B. Conditional maximal signal peak
The network structure of each layer in the signalling cas-
cade presents a cyclic behaviour, i.e., phosphorylated proteins,
serving as signal for the next layer, can also be dephospho-
rylated again, which corresponds to a decrease of the signal
strength. Thus an interesting property of the signalling cascade
is the probability of a further increase of the signal strength
under the condition that a certain strength has already been
reached. We estimate this quantity for the ﬁrst layer in the
signalling cascade, i.e., RafP, and ask speciﬁcally for the
130
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

TABLE II. COMPUTATIONAL COMPLEXITY AND NUMERICAL VALUES RELATED TO THE EVALUATION OF p1
N
COSMOS
MARCIE
Reduction factor
time
memory
Gaussian CI
Chernoff CI
MinMax CI
time
memory
Output
1
-
-
-
-
-
-
4
514MB
2.07E-12
2
38
20,072
3,811MB
[3.75E-27,5.88E-26]
[3.75E-27,4.54E-25]
[3.75E-27,1.57E-23]
326
801MB
8.18E-26
3
558
15,745
15,408MB
[4.34E-42,1.72E-39]
[4.34E-42,1.82E-38]
[4.43E-42,1.87E-37]
43,440
13,776MB
2.56E-39
4
4667
40,241
3,593MB
[1.54E-57,8.54E-56]
[1.54E-57,1.98E-55]
[1.78E-57,7.05E-55]
Out of Memory: >32GB
5
27353
51,120
19,984MB
[3.97E-73,2.33E-70]
[3.97E-73,7.30E-70]
[5.44E-73,2.24E-69]
TABLE III. NUMERICAL VALUES ASSOCIATED WITH p2
N
L
COSMOS
MARCIE
conﬁdence interval
time
result
time
memory
2
2
[2.39E-13 , 1.07E-09]
31
5.55E-10
90
802 MB
2
3
[2.18E-10 , 6.92E-08]
110
6.64E-08
136
816 MB
2
4
[9.33E-08 , 3.54E-05]
256
3.01E-06
276
798 MB
2
5
[1.16E-05 , 6.08E-04]
1000
7.16E-05
759
801 MB
2
6
[5.42E-04 , 1.21E-03]
5612
1.27E-03
3180
804 MB
3
5
[1.82E-12 , 9.78E-09]
459
Time > 48 hours
3
6
[3.41E-10 , 9.66E-08]
1428
3
7
[1.81E-08 , 2.23E-06]
7067
3
8
[8.72E-07 , 2.71E-06]
4460
3
9
[1.42E-06 , 4.59E-05]
4301
3
10
[2.69E-04 , 9.34E-04]
6420
4
10
[5.12E-09 , 2.75E-08]
8423
Memory > 32GB
4
11
[8.23E-08 , 2.97E-07]
7157
4
12
[9.84E-07 , 1.86E-06]
18730
probability to reach its maximal strength, 4N: “What is the
probability of the concentration of RafP to continue its increase
and reach 4N, when starting in a state where the concentration
is for the ﬁrst time at least L?”. This is a special use case of
the general pattern introduced in [1].
p2 = Prπ((RafP ≥ L) U (RafP ≥ 4N))
where π is the distribution over states when satisfying for
the ﬁrst time the state formula RafP ≥ L (previously called a
ﬁlter). This formula is parametrized by threshold L and scaling
factor N. The results for increasing N and L are reported
in Table III (conﬁdence intervals are computed by Chernoff-
Hoeffding method). As before, MARCIE cannot handle the case
N = 3, the bottleneck being here the execution time.
It is clear that p2 is an increasing function of L. More
precisely, experiments point out that p2 increases approxima-
tively exponentially by at least one magnitude order when L
is incremented. However this dependency is less clear than the
one of the ﬁrst property.
VII.
CONCLUSION AND FUTURE WORK
We have studied rare events in signalling cascades with the
help of an improved importance sampling method implemented
in COSMOS. Our method has been able to cope with huge mod-
els (nearly a hundred billion states) that could not be handled
neither by computations nor by standard simulations. Analysis
of the experiments has pointed out interesting dependencies
between the scaling parameter and the quantitative behaviour
of the model.
In future work, we intend to incorporate other types of
quantitative properties, such as the mean time a signal needs
to exceed a certain threshold, the mean travelling time from the
input to the output signal, etc. We also plan to analyse other
biological systems like mutation rates in growing bacterial
colonies [17].
REFERENCES
[1]
M. Heiner, D. Gilbert, and R. Donaldson, “Petri nets for systems and
synthetic biology,” in SFM 2008, ser. LNCS, M. Bernardo, P. Degano,
and G. Zavattaro, Eds., vol. 5016.
Springer, 2008, pp. 215–264.
[2]
G. Rubino and B. Tufﬁn, Rare Event Simulation using Monte Carlo
Methods.
Wiley, 2009.
[3]
P. L’ecuyer, V. Demers, and B. Tufﬁn, “Rare events, splitting, and
quasi-monte carlo,” ACM Transactions on Modeling and Computer
Simulation (TOMACS), vol. 17, no. 2, 2007, pp. 1–44.
[4]
P. W. Glynn and D. L. Iglehart, “Importance sampling for stochastic
simulations,” Management Science, vol. 35, no. 11, 1989, pp. 1367–
1392.
[5]
B. Barbot, S. Haddad, and C. Picaronny, “Coupling and importance
sampling for statistical model checking,” in TACAS, ser. LNCS,
C. Flanagan and B. K¨onig, Eds., vol. 7214.
Springer, 2012, pp. 331–
346.
[6]
——, “Importance sampling for model checking of continuous time
Markov chains,” in Proceedings of the 4th International Conference on
Advances in System Simulation (SIMUL’12), P. Dini and P. Lorenz,
Eds.
Lisbon, Portugal: XPS, Nov. 2012, pp. 30–35.
[7]
B. Barbot, S. Haddad, M. Heiner, and C. Picaronny, “Rare event
handling in signalling cascades,” LSV, ENS Cachan, Tech. Rep. 14-
10, July 2014.
[8]
A. Levchenko, J. Bruck, and P. Sternberg, “Scaffold proteins may bipha-
sically affect the levels of mitogen-activated protein kinase signaling
and reduce its threshold properties,” Proc Natl Acad Sci USA, vol. 97,
no. 11, 2000, pp. 5818–5823.
[9]
V. Chickarmane, B. N. Kholodenko, and H. M. Sauro, “Oscillatory
dynamics arising from competitive inhibition and multisite phosphory-
lation,” Journal of Theoretical Biology, vol. 244, no. 1, January 2007,
pp. 68–76.
[10]
R. Breitling, D. Gilbert, M. Heiner, and R. Orton, “A structured
approach for the engineering of biochemical network models, illustrated
for signalling pathways,” Brieﬁngs in Bioinformatics, vol. 9, no. 5,
September 2008, pp. 404–421.
[11]
M. Ajmone Marsan, G. Balbo, G. Conte, S. Donatelli, and G. Frances-
chinis, Modelling with generalized stochastic Petri nets.
John Wiley
& Sons, Inc., 1994.
[12]
M. Heiner, C. Rohr, and M. Schwarick, “ MARCIE - Model checking
And Reachability analysis done efﬁCIEntly ,” in Proc. PETRI NETS
2013, ser. LNCS, J. Colom and J. Desel, Eds., vol. 7927.
Springer,
2013, pp. 389–399.
[13]
L. J. Bain and M. Engelhardt, Introduction to Probability and Mathe-
matical Statistics, Second Edition.
Duxbury Classic Series, 1991.
[14]
A. Jensen, “Markoff chains as an aid in the study of markoff processes,”
Skand. Aktuarietidskr, 1953.
[15]
B. L. Fox and P. W. Glynn, “Computing Poisson probabilities,” Com-
mun. ACM, vol. 31, no. 4, 1988, pp. 440–445.
[16]
P. Ballarini, H. Djafri, M. Duﬂot, S. Haddad, and N. Pekergin, “HASL:
An expressive language for statistical veriﬁcation of stochastic models,”
in Proc. VALUETOOLS’11, Cachan, France, May 2011, pp. 306–315.
[17]
D. Gilbert, M. Heiner, F. Liu, and N. Saunders, “Colouring Space -
A Coloured Framework for Spatial Modelling in Systems Biology,” in
Proc. PETRI NETS 2013, ser. LNCS, J. Colom and J. Desel, Eds., vol.
7927.
Springer, June 2013, pp. 230–249.
131
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

