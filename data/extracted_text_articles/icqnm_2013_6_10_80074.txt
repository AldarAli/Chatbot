Experimental Evaluation of Optical Feedback for Nanopositioning of Piezo 
Actuator Stage 
 
Piotr Skupin, Mieczyslaw Metzger, Dariusz Choinski 
Faculty of Automatic Control, Electronics and Informatics 
Silesian University of Technology 
Gliwice, Poland 
{piotr.skupin, mieczyslaw.metzger, dariusz.choinski}@polsl.pl 
 
 
Abstract—The 
paper 
presents 
the 
realization 
of 
the 
nanopositioning control of activated sludge samples observed 
under the microscope. To achieve the desired control goals, the 
most typical and cheapest components of the positioning 
system were used. It has been shown both experimentally and 
numerically that one of the simplest control algorithms (in this 
case the PI controller) can provide satisfactory good results in 
positioning control systems. Moreover, based on the simplified 
description of the microactuator, analytical stability conditions 
of the closed-loop system have been given. Then, it was possible 
to find the analytical and experimental stability regions on the 
controller parameter plane and to compare them against each 
other. 
Keywords-microactuator; 
nanopositioning 
control; 
hysteresis; stability analysis 
I. 
 INTRODUCTION 
Nanopositioning control is a very essential issue in 
various fields of science and technology [1], [2]. A basic 
device, which allows for very precise and accurate 
positioning is a piezoelectric actuator (microactuator) using 
piezoceramic element that undergoes the phenomenon of 
reverse piezoelectric effect. In most cases, the typical 
operating range for positioning purposes is 20 to 30 
micrometers, and depending on the accuracy of the position 
measurement, the device allows for positioning with 
accuracy 
within 
a several nanometers. 
Hence, the 
piezoceramic actuators are often used in the positioning 
control of mirrors on the optical table, in microscopes, digital 
cameras, etc. 
Among the many areas, in which microactuators are 
widely used, broadly defined biotechnology offers a strong 
application potential of such devices and the typical example 
is the in-vitro fertilization. The second important field of 
application of microactuators is the precise positioning of 
mechanical parts in the laboratory equipment used for a 
proper conduction of micro-scale processes. In our case, we 
will focus on the design of positioning control system, which 
can be used for precise positioning of samples of activated 
sludge observed under the microscope. However, the key 
issue in the design of the positioning control system is to 
provide a precise and accurate measurement of the 
microactuator stage position. 
An interesting paper addressing this problem is the 
survey paper by Fleming published in Sensors & Actuators 
A: Physical [3]. This paper describes and compares the 
following sensors: piezoelectric and piezoresistive strain 
sensors, resistive and capacitive sensors, electrothermal 
sensors, eddy current sensors, linear variable displacement 
transformers, interferometers and linear encoders. The quick 
reference on the sensors used for nanopositioning control in 
biotechnology can be found in [4]. 
In the literature, laser sensors are the most frequently 
described sensors for nanopositioning purposes (see, e.g., [5-
9]). In turn, the application of optical encoder for delay-
varying repetitive control of walking piezoactuator can be 
found in [10]. In [11], the strain gauge sensor was used for 
hysteresis analysis of the piezostack actuator. These studies 
were performed for displacements in the range of several 
micrometers. In turn, the induction coil sensor can be used 
for positioning in the micro- (but not nano-) scale [12]. 
In principle, for microscopic observations, it is more 
convenient to use the same microscope to measure the 
position of the microactuator stage. Moreover, the 
microscope can also be used for calibration of position 
sensors for microactuators, because it can provide a 
sufficiently high precision in position determination during 
microscopic observations. More precise positioning is hardly 
observable be the experimenter, hence, in many cases is not 
necessary. The application of microscope for positioning 
control is also described in the literature. For instance, in in-
vitro fertilization, two coaxial microactuator stages are used 
for appropriate positioning of the needle observed under the 
microscope [13]. This paper also gives a short survey of 
various positioning sensors used in the in-vitro fertilization 
equipment. In turn, the paper [14] describes the application 
of microscope to provide visual feedback in positioning 
control on the XY plane. It should be emphasized that some 
papers describing advanced control algorithms (see, e.g., 
[15], [16]), provide only limited information on the position 
sensor or measurement technique. Probably, their authors 
were mainly focused on the presentation of their results 
assuming that the position measurements are precise and 
accurate; hence, the measurement errors are negligible. 
But, the main reason for which nanopositioning is an 
interesting control problem is the nonlinear nature of the 
plant (microactuator), which manifests itself as hysteresis in 
the relation between position of the microactuator stage and 
71
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-303-2
ICQNM 2013 : The Seventh International Conference on Quantum, Nano and Micro Technologies

the control voltage. As a result, it is necessary to implement 
closed-loop control system, for which accuracy and precision 
of positioning is only dependent on the applied measurement 
sensor. Although the application of microscope is an 
expensive and complex solution (image processing is 
required), only the image from microscope can provide an 
accurate position of the microactuator stage. On the other 
hand, other types of sensors provide indirect information on 
the actual position of the microactuator stage. 
Among the papers dealing with the influence of 
hysteresis on the quality of positioning control, it is worth 
mentioning earlier studies (e.g., [17], [18]), which describe 
piezoelectric actuators. It should be emphasized that the 
general properties of the closed-loop control systems (e.g., 
stability or quality of transients) for plants with hysteresis 
nonlinearity, have been well-known in the field of control 
theory since the 1950s of the past century. In majority of 
papers concerning nanopositioning control problem, the 
hysteresis phenomenon is often taken into account. For 
instance, the latest attempts to model the hysteresis behavior 
can be found in [4], [11], [19] and [20]. 
Among various control algorithms that can be used for 
positioning purposes, the simplest and historically the first is 
the classical PI (or PID) control algorithm. These algorithms 
are frequently applied in the combination with feedforward 
[13], fuzzy logic [15] or artificial neural networks [21]. The 
last cited paper [21] describes sliding mode control (SMC) 
algorithm showing its advantages over the classical PID 
controller. But, the improvement of the control quality 
achieved for the SMC is insignificant in comparison to the 
results for the PID controller. Hence, it leads us to the 
conclusion that the simple PID algorithm is the better option. 
For instance, the in-vitro fertilization system described in 
[13] uses two piezoactuators controlled by two independent 
PID controllers. Moreover, many authors consider the 
piezostack actuator to be an interesting nonlinear plant, 
which can serve as a benchmark system for testing new 
control algorithms. At this point, it is worth mentioning the 
advanced delay-varying repetitive control (DVRC) [10] or 
repetitive control algorithm with feedforward [16]. 
In this paper, we present an experimental set-up for 
analysis and calibration of piezostack actuators. The optical 
microscope is used to obtain the direct measurement of 
position of the microactuator stage. We will show that the 
classical PI controller is sufficient to obtain the acceptable 
control quality. The remainder of the paper is organized as 
follows. Section II provides details on the laboratory setup 
and describes a way to obtain information on the stage 
position, which is then used to manipulate the activated 
sludge samples during microscopic observations. Section III 
describes the control algorithm, which is based on the optical 
feedback provided by the microscope. Finally, Section IV 
discusses the main results. 
II. 
EXPERIMENTAL SET-UP FOR NANOPOSITIONING 
CONTROL 
The general schema of the measurement set-up is shown 
in Fig. 1. The presented system uses the microactuator, 
which allows for positioning in the range up to 25 
micrometers, with an accuracy of several nanometers. In 
order to measure a position of the movable stage of the 
microactuator, the digital camera coupled with the optical 
microscope is used. 
 
 
Figure 1.  The general scheme of the experimental set-up. 
Fig. 2 explains how to receive information on the stage 
position. A small glass plate, on which the analyzed sample 
is placed, has been mounted to the microactuator stage. But, 
to measure the stage position, a piece of tape has been 
attached to the top surface of the glass plate. This piece of 
tape is a graphical indicator used to determine the stage 
position with reference to the microscope stage. The shape of 
the indicator should be sufficiently large to obtain the stage 
position in the whole range of displacement and sufficiently 
small to maximize the field of view during microscopic 
observations. Then, the microscopic image of 320x240 
pixels is recorded by the digital camera and sent to the 
computer via USB port. In the control application, created in 
LabVIEW environment, the captured image is processed by 
the threshold image segmentation method, which is 
performed on-line. As a result, a 320x240 matrix 
corresponding to the processed image is filled with ones and 
zeros. Because, the range of displacement is 25 micrometers, 
which is equal to 88 pixels, hence, one pixel corresponds to 
about 284 nanometers for total magnification of 400x (40x 
objective and 10x ocular). Since the diameter of a single 
sludge flock varies between 10 and 100 micrometers, the 
accuracy to 284 nanometers is sufficient for our purposes. 
72
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-303-2
ICQNM 2013 : The Seventh International Conference on Quantum, Nano and Micro Technologies

 
 
Figure 2.  The idea of position measurement of the microactuator stage. 
Information on the stage position can be then used by any 
control algorithm responsible for precise positioning of the 
microactuator stage. In turn, a single-channel T-Cube servo 
controller connected to the computer via USB port provides 
a source of control voltage. The control voltage (0-75[V]) 
changes the position of the microactuator stage and it can be 
generated either manually, i.e., in the T-Cube servo 
controller or indirectly in the control application, which is 
based on ActiveX components. The possibility of using 
ActiveX components facilitates the control system design 
process, which is described in the next section. 
III. 
DESIGN OF POSITION CONTROLLER 
Determination and analysis of the static characteristics of 
the controlled plant (microactuator) is a very important stage 
in the controller designing process. In the considered case, 
the static characteristics presents the relation between the 
stage position in micrometers and the input voltage. These 
characteristics were obtained by cyclic changes of the input 
voltage in steps of 2 volts. The obtained characteristics are 
shown in Fig. 3. Irrespective of the range of input voltage, a 
hysteresis effect was observed. The hysteresis is a typical 
phenomenon for piezoceramic materials and it is also 
noticeable in Fig. 4, which shows the step responses of 
microactuator stage. The analysis of these responses will 
help us to determine the dynamical properties of the 
controlled plant. It can be easily noticed that the same levels 
of the input voltage correspond to different stage positions. 
Moreover, the step changes in the input voltage cause 
instantaneous changes in the microactuator stage position 
(Fig. 4). Because, in our case, the microactuator stage will be 
applied for positioning of samples under the microscope, 
hence, at sampling rate of 10Hz (the sample time 
T=100[ms]), the much faster dynamics of the microactuator 
is negligible. In other words, it is assumed that the 
microactuator is a static element and can be described by the 
following equation: 
 
  y = k·u 
(1) 
where: y – is the position of the microactuator stage in [µm], 
u – is the input voltage [V], k=1/3 [µm/V] – is the gain of the 
plant. It also means that the dynamical properties of the 
closed-loop system will be entirely determined by the 
dynamics of the controller. In other situations, it may prove 
necessary to take into account the dynamical properties of 
the controlled plant (microactuator system), especially, when 
the input voltage changes at high frequency. Unfortunately, 
due to the time needed to process the captured image, it was 
not possible to set the sample time less than 100 
milliseconds. Hence, it was not possible to analyze the 
behavior of the microactuator stage immediately after the 
step change in the control voltage. It is worth noting that the 
problem of control of a static system (without dynamics) is 
rare and untypical, but can be quite complex, especially 
when the controlled plant is highly nonlinear. 
 
 
Figure 3.  Static characteristics of the controlled plant. 
 
Figure 4.  Step responses (black) to step changes in input voltage (red). 
73
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-303-2
ICQNM 2013 : The Seventh International Conference on Quantum, Nano and Micro Technologies

The simplified model of the microactuator (1) does not also 
include the hysteresis behavior, but it will simplify the 
controller design process. However, to take into account the 
hysteresis effect, a well-known Preisach model [22], [23] can 
be applied. Other models proposed in the literature are based, 
for instance, on artificial neural networks [24]. 
For positioning purposes, the classical PID controller can 
be used and its transfer function is as follows: 
 






+
+
+
=
1
sT
sT
sT
1
1
k
K(s)
b
d
i
p
 
(2) 
where: kp – the proportional gain, Ti – the integral time, Td – 
the derivative time, Tb – the time constant in the derivative 
part (D) of the controller. 
Based on the equations (1) and (2), a simulator of the 
closed-loop control system was created in LabVIEW 
environment. The simulator allowed for appropriate choice 
of the controller structure and for tuning its parameters. 
Based on the simulation runs, sufficiently good results, i.e., 
short settling time and no control error, were obtained for the 
PI (Td=0) controller with the following parameters: kp=0.5 
and Ti=0.5[s]. A more detailed analysis of the closed-loop 
system described by (1) and (2) will allow to derive 
necessary and sufficient conditions for stability of the 
system. But, in order to determine the stability conditions, at 
first, it is necessary to find a discrete time description of the 
closed-loop system. In our case, the input-output description 
of the closed-loop system is as follows:   
 






− +
⋅
⋅
 =











− +
⋅
+
⋅
1
1
z
z
T
w(z) k k T
1
1
z
z
T
k k T
z
y(z)
i
p
i
p
 (3) 
where: y(z), w(z) – are z-transforms of the actual and set 
point stage position, respectively, kp – the proportional gain 
of the controller, Ti – the integral time, k – the gain of the 
plant and T – the sample time. 
Hence, the characteristic equation of the closed-loop 
system (3) has the following form: 
 
z2·Ti + z·(kpk·T + kpk·Ti – Ti) – kpk·T = 0 
(4) 
The above equation can be easily transformed to Laplace 
domain by using the well-known relation z:=(s+1)/(s–1). 
Then, by using the Routh-Hurwitz criterion, the necessary 
and sufficient condition for stability of (3) is as follows: 
 
k
1
2T
T
2T
k
0
i
i
p
⋅
+
<
<
 
(5) 
The proposed control algorithm was implemented in the 
control application written in G language in LabVIEW and 
its front panel is shown in Fig. 5. Owing to the application of 
ActiveX components provided by the manufacturer of the 
microactuator, the communication process between the 
microactuator and the control application is simplified. The 
information on the microactuator stage position is obtained 
from the segmented image according to the algorithm 
described in Section II. 
 
 
Figure 5.  Front panel of the control application in LabVIEW. 
Moreover, the implemented algorithm includes the bumpless 
switching between the automatic and manual modes of 
operation and the anti-reset windup, i.e., the integral part of 
the controller is disabled when the upper or lower bound is 
reached by the control voltage (the controller output signal). 
IV. 
EXPERIMENTAL RESULTS AND CONCLUDING 
REMARKS 
Fig. 6 presents step responses of the positioning control 
system for the previously determined structure and parameter 
values of the PI controller (kp=0.5, Ti=0.5[s]). The obtained 
results were compared with step responses of the simulated 
closed-loop system described by equations (1) and (2) for the 
same controller parameters. 
 
 
Figure 6.  Comparison of the real (black) and simulated (blue) step 
responses of the closed-loop system. Red line represents changes in the set 
point position. 
Although, there is a good conformity between experimental 
and simulated positions of the microactuator stage, the 
74
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-303-2
ICQNM 2013 : The Seventh International Conference on Quantum, Nano and Micro Technologies

visible differences occur in the transients of control voltages 
(Fig. 7). Most probably, this is due to the hysteresis effect, 
which is not included in the description of the simulated 
plant (1). It is also easy to notice that the hysteresis has an 
influence on the plant gain, which is dependent on the actual 
and previous values of the control voltage (Fig. 3). 
 
 
Figure 7.  Control voltage in real (black) and simulated (blue) closed-loop 
control system. 
On the other hand, it should be emphasized that the proposed 
controller ensures a complete elimination of the hysteresis 
behavior in the relation between the actual and set point 
stage positions (Fig. 8), which is one of the well-known 
properties of the closed-loop system. 
 
 
Figure 8.  Steady state position in the closed-loop system. 
Now, it remains to verify the stability condition (5), 
which was derived in the previous section for the simplified 
system (1)-(2). This can be achieved by analyzing the 
behavior of the positioning control system for large values of 
the proportional gain kp (closed to critical values of kp 
determined from inequality (5)) and for fixed integral times 
Ti in the controller. Fig. 9 presents the obtained results on the 
controller parameter plane (kp,Ti) and compares the stability 
regions obtained experimentally and analytically based on 
the condition (5). In this case, the set point values were 
changed by 5 to 10 micrometers to cover the whole range of 
possible displacements of the microactuator stage. 
 
 
Figure 9.  Stability regions of the closed-loop system. Black thick line is a 
boundary of stability region computed from eqation (5) and black dotted 
line from experimental results. 
The experimental stability region turned out to be larger, 
than the region resulting from inequality (5). Most probably, 
the reason for this behavior is due to the hysteresis effect, 
which is not included in (5). Near the marginal stability 
boundary, the control voltage changes very rapidly and, as a 
result, the stage platform moves back and forth at very high 
frequency. Hence, it is highly probable that the hysteresis 
plays an important role in the behavior of the positioning 
control system. However, this should be verified by more 
detailed analysis. It should also be emphasized that the 
analytical determination of the stability region is not an easy 
task for plants, which exhibit hysteresis behavior. On the 
other hand, if the controller parameters satisfy inequality (5), 
then the positioning control system is stable. 
In conclusion, the presented system allows for 
positioning of the observed samples with an accuracy of one 
pixel (several nanometers). It means that the accuracy is 
dependent on both the resolution of captured image and the 
total magnification of the optical microscope. At larger 
magnifications, the graphical indicator will be displaced by a 
distance of more pixels; hence, one pixel will be 
corresponding to a smaller distance in nanometers. Similarly, 
for a fixed magnification, but for a digital camera providing 
images of higher resolution, there will be more pixels 
corresponding to the entire range of stage displacement. In 
effect, the accuracy of positioning will be mainly limited by 
the current magnification of the optical microscope. The 
greater the total magnification, the better accuracy of 
75
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-303-2
ICQNM 2013 : The Seventh International Conference on Quantum, Nano and Micro Technologies

positioning can be achieved. In the case of using different 
types of position sensor (e.g., capacitive or strain gauge 
sensor), the accuracy of positioning control is limited by the 
accuracy of the applied sensor. Another important issue that 
must be taken into account in the further development of the 
system is the speed of positioning of the microactuator stage. 
In the presented case, acceptable results were obtained by 
using the classical PI controller. However, to increase the 
speed of positioning, it is necessary either to tune the 
controller parameters again without violating the stability 
condition (5) or to change the structure of controller. 
ACKNOWLEDGMENT 
This work was supported by the National Science Centre 
under grant No. 2012/05/B/ST7/00096 and by the Ministry 
of Science and Higher Education under grant BK-UiUA. 
REFERENCES 
[1] A. Sinno, P. Ruaux, L. Chassagne, S. Topcu, Y. Alalyli, G. 
Lerondel, S. Blaize, A. Bruyant, and P. Royer, "Enlarged 
Sample Holder For Optical AFM Imaging: Millimeter 
Scanning 
With 
High 
Resolution," 
First 
International 
Conference on Sensor Device Technologies and Applications 
(SENSORDEVICES 2010), Venice/Mestre, Italy, July 2010, 
pp. 190–194. 
[2] D. Zhang, Z. Gao, M. Malosio, and G. Coppola, "A Novel 
Flexure Parallel Micromanipulator Based on Multi-Level 
Displacement Amplifier", The Third International Conference 
on 
Sensor 
Device 
Technologies 
and 
Applications 
(SENSORDEVICES 2012), Rome, Italy, August 2012, pp. 
31–37. 
[3] A.J. Fleming, "A review of nanometer resolution position 
sensors: Operation and performance," Sensor. Actuat. A-
Phys., vol. 190, February 2013, pp. 106–126. 
[4] S.C. Jordan and P.C. Anthony, "Design Considerations for 
Micro- and Nanopositioning: Leveraging the Latest for 
Biophysical Applications," Curr. Pharm. Biotechnol., vol. 10, 
August 2009, pp. 515–521. 
[5] Y-M. Han, S-M. Choi, S-B. Choi, and H-G. Lee, "Design and 
control of a hybrid mount featuring a magnetorheological 
ﬂuid and a piezostack," Smart Mater. Struct., vol. 20, July 
2011, pp. 1–13. 
[6] P-B. Nguyen and S-B Choi, "Micro-position Control of a 
Piezostack 
Actuator 
Using 
Rate-Dependent 
Hysteretic 
Compensator," Int. J. Prec. Eng. Man., vol. 12, October 2011, 
pp. 885–891. 
[7] H.G. Kim, "Nano positioning control for dual stage using 
minimum order observer," J. Mech. Sci. Technol., vol. 26, 
March 2012, pp. 941–947. 
[8] S.B. Choi, S.R. Hong, and Y.M. Han, "Dynamic 
characteristics of inertial actuator featuring piezoelectric 
materials: Experimental veriﬁcation," J. Sound Vibration, vol. 
302, May 2007, pp. 1048–1056. 
[9] S.B. Choi, S.S. Han, Y.M. Han, and B.S. Thompson, "A 
magniﬁcation device for precision mechanisms featuring 
piezoactuators and ﬂexure hinges: Design and experimental 
validation," Mech. Mach. Theory, vol. 42, September 2007, 
pp. 1184–1198. 
[10] R.J.E. Merry, D.J. Kessels,W.P.M.H. Heemels, M.J.G. van de 
Molengraft, and M. Steinbuch, "Delay-varying repetitive 
control with application to a walking piezo actuator," 
Automatica, vol. 47, August 2011, pp. 1737–1743. 
[11] P-B. Nguyen and S-B Choi, "A novel rate-independent 
hysteresis model of a piezostack actuator using the 
congruency property," Smart Mater. Struct., vol. 20, May 
2011, pp 1–10. 
[12] M. De Volder, J. Coosemans, R. Puers, and D. Reynaerts, 
"Characterization and control of a pneumatic microactuator 
with an integrated inductive position sensor," Sensor. Actuat. 
A-Phys., vol. 141, January 2008, pp. 192–200. 
[13] P.R. Ouyang, W.J. Zhang, Madan M. Gupta, and W. Zhao, 
"Overview of the development of a visual based automated 
bio-micromanipulation system," Mechatronics, vol. 17, 
December 2007, pp. 578–588. 
[14] J. Cas, G. Skorc, and R. Safaric, "Neural network position 
control of XY piezo actuator stage by visual feedback," 
Neural. Comput. Applic., vol. 19, October 2010, pp. 1043–
1055. 
[15] K. Abidi and A. Sabanovic, "Sliding-Mode Control for High-
Precision Motion of a Piezostage," IEEE T. Ind. Electron., 
vol. 54, February 2007, pp. 629–637. 
[16] C-Y. Lin and P-Y. Chen, "Precision tracking control of a 
biaxial piezo stage using repetitive control and double-
feedforward compensation," Mechatronics, vol. 21, February 
2011, pp. 239–249. 
[17] P. Ge and M. Jouaneh, "Modeling hysteresis in piezoceramic 
actuators," Prec. Eng., vol. 17, July 1995, pp. 211–221. 
[18] D. Hughes and J.T.Wen, "Preisach modeling of piezoceramic 
and shape memory alloy hysteresis," Smart Mater. Struct., 
vol. 6, June 1997, pp. 287–300. 
[19] S.R. Viswamurthy 
and R. Ganguli, "Modeling and 
compensation of piezoceramic actuator hysteresis for 
helicopter vibration control," Sensor. Actuat. A-Phys., vol. 
135, April 2007, pp. 801–810. 
[20] L. Deng and Y. Tan, "Modeling hysteresis in piezoelectric 
actuators using NARMAX models," Sensor. Actuat. A-Phys., 
vol. 149, January 2009, pp. 106–112. 
[21] M. Kinouchi, I. Hayashi, N. Iwatsuki, K. Morikawa, J. 
Shibata, and K. Suzuki, "Application of Fuzzy PI control to 
improve the positioning accuracy of a rotary-linear motor 
driven 
by 
two-dimensional 
ultrasonic 
actuators," 
Microprocess. Microsyst., vol. 24, April 2000, pp. 105–112. 
[22] F. Preisach, "Über die magnetische Nachwirkung," Z. Phys., 
vol. 94, May 1935, pp. 277–302. 
[23] I.D. Mayergoyz and G. Friedman, "Generalized Preisach 
model of hysteresis". IEEE T. Magn., vol. 24, January 1988, 
pp. 212–217. 
[24] L. Chuntaoa and T. Yonghong, "A neural networks model for 
hysteresis nonlinearity", Sensor. Actuat. A-Phys., vol. 112, 
April 2004, pp. 49–54. 
 
 
76
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-303-2
ICQNM 2013 : The Seventh International Conference on Quantum, Nano and Micro Technologies

