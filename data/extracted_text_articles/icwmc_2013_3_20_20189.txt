Second Best Codeword for MIMO Broadcast
Channels with Limited Feedback
Mouncef Benmimoune and Daniel Massicotte
Electrical and Computer Engineering Department
Laboratory of Signal and System Integrations
Universit´e du Qu´ebec `a Trois-Rivi`eres
3351, Boul. des Forges, Trois-Rivi`eres, QC, CANADA
Email:{mouncef.benmimoune, daniel.massicotte}@uqtr.ca
S´ebastien Roy
Electrical and Computer Engineering Department
Sherbrooke University
2500, BLD de l’Universit´e, Sherbrooke, QC, CANADA
Email: s.roy@ieee.org
Abstract—In this paper, we propose a simple design for a
multi-user MIMO precoder using a Grassmannian codebook. The
precoder design is applied to both sides of the wireless link under
the assumption of limited feedback and the same codebook. The
proposed scheme aims to correct the precoding vectors choice
in order to avoid more than one user having the same vector, a
situation which degrades system performance. Simulation results
show that our approach provides greater system performance
enhancement in both error probability and sum rate.
Keywords-MIMO broadcast channels; precoding; code-
book; codeword correction; limited feedback.
I. INTRODUCTION
Recently, Multi-Input Multi-Output (MIMO) technology
has been introduced in several applications, such as wireless
LANs and cellular telephony because of its high gain in both
channel capacity and reliability. The MIMO concept consists
in deploying multiple antennas at both the transmitter and the
receiver in order to exploit the spatial dimension. This new
dimension can be used in a single-user scenario (SU-MIMO),
providing a system capacity that increases linearly with the
multiplexing gain, regardless of the availability or otherwise of
the channel state information at the transmitter (CSIT) [1]. Or
it can be leveraged in a multiuser conﬁguration (MU-MIMO),
where several mobile stations (MS) communicate with a base
station (BS) while sharing the same time-frequency resource.
In multi-user case, the situation vis-a-vis the sum capacity
is substantially different, since the interference must be taken
into account and balanced in a trad-off against the data rate
[2]. As a result, the CSIT is required since it critically affects
the multiplexing gain [3].
In information theory, it is well known that the optimal strat-
egy for achieving sum capacity in a MIMO broadcast channel
is dirty paper coding (DPC) [4]. However, deploying DPC in
real-time systems is impractical due to the complexity of the
encoder and the decoder. Moreover, it is sensitive to CSIT
inaccuracy. For low complexity and suboptimal performance,
several non-linear and linear precoders have been proposed [5],
[6], [7], [8]. However, all these schemes need perfect CSIT,
which is not practical.
In the literature, a considerable number of publications
have assumed partial CSIT, where unitary precoding is the
main, denoted also as limited feedback (see, e.g., [9] and the
references therein). Recently, this scheme was introduced in
IEEE 802.16 e/m and LTE Advanced for its performance. In
fact, it was shown in [10] that for SU-MIMO systems, even a
few bits of feedback, of the order of the number of transmit
antennas, is sufﬁcient to achieve near-optimal performance.
For MU-MIMO systems, however, the amount of feedback per
user must grow linearly with the number of transmit antennas
and the SNR in decibel [1].
The use of the same codebook in all MS causes a rank loss
in the channel matrix since two or more users can choose the
same codeword. Few solutions to avoid this situation are found
in the literature. Indeed, most papers suggest using different
codebooks (see, e.g., [1]). But this is not quite feasible. In
Ding et al. [11], the authors propose to modify the codebook
of each user by a rotation of the general codebook by a random
unitary matrix that is known at the BS. However, this solution
is impractical because the BS must know all unitary matrices.
All the more, the latter requires a storage and more feedback
overhead for matrix’s identiﬁcation. To address this problem,
in this paper, we propose to make a correction of the precoding
vectors choices at the BS while keeping the same codebook.
Throughout the paper, lower-case bold letters are used for
vectors and upper-case bold letters for matrices; ∥·∥2 denotes
the Euclidean norm of the vector; | · | denotes the cardinality
of a set or the absolute value of the scalar; Tr(·) denotes the
matric trace; and (·)H and (·)−1 denote Hermitian and matrix
inversion, respectively. The identity matrix is denoted by I.
The rest of this paper is organized as follows. The MU-
MIMO system model and the Grassmannian codebook con-
struction are depicted in the next section. The problem for-
mulation and the proposed precoding design under limited
feedback is discussed in Section III. Simulation results are
given in Section IV, and we conclude with Section V.
II. SYSTEM MODEL
A. Multi-User MIMO System with Limited Feedback
Let us consider a closed loop MU-MIMO broadcast channel
with Nt antennas at the BS and Nr antennas at each of
K MS. The vector data s ∈ CK×1 is preprocessed by the
44
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

User K
1
2
r
N ⋮
User 1
1
2
r
N ⋮
⋮
User 1
User 2
User K
⋮
Precoder
1
2
t
N
⋮
Limited Feedback
Limited Feedback
Fig. 1.
Downlink Multi-User MIMO system
precoding matrix W ∈ CNt×K and then transmitted via ﬂat-
fading channel Hk ∈ CNr×Nt between the BS and the kth
MS. At the kth MS, the equivalent baseband input-output
relationship can be written as
yk = HkWs + nk,
(1)
where nk ∈ CNr×1 is the noise term which follows an
independent complex Gaussian distribution with zero mean
and N0 variance, i.e. CN(0, N0).
At the receiver, a linear MMSE detector is used to estimate
the symbols transmitted, the decoding matrix of the kth user
being given by [12]
˜gk = ˜h
H
k

˜Hk ˜H
H
k + KN0
Pt
INr
−1
,
(2)
where
˜Hk = HkW.
(3)
˜hk = Hkwk.
(4)
In this case, the received signal-to-interference and noise
ratio (SINR) for the kth user is [12]
sinrk (Hk, wk) =
Pt
Nt |˜gkHkwk|2
PK
i=1,i̸=k
Pt
Nt |˜gkHkwi|2 + N0∥˜gk∥2
2
, (5)
where Pt represents the total transmit power which must
satisfy the following constraint
E[∥Ws∥2
2] = Tr(WWH) ≤ Pt,
(6)
where W is given by W = [w1w2 . . . wK].
The downlink sum rate can be expressed as follows
r (Hk, wk) =
K
X
k=1
log2 (1 + sinrk (Hk, wk)) .
(7)
B. Grassmannian Codebook
The problem of Grassmannian line packing is to ﬁnd the
packing of P lines in C such that the distance between any pair
of lines is maximal. This packing of P lines is captured by the
matrix V = [v1v2 . . . vP ], where each column vi represents a
unit vector with vH
i vi = 1 and vH
i vj ̸= 1(i ̸= j). The distance
between two lines produced from unit vectors v1 and v2 can
be deﬁned by the function d(v1, v2), which represents the sine
of the angle formed by these two lines [13], [12]
d(v1, v2) = sin(θ1,2) =
q
1 − |vH
1 v2|2.
(8)
To maximize the precoding gain with codebook vectors is
to maximize the minimum distance between any pair of lines
spanned by the codebook vectors [12].
The minimum distance of a packing is the sine of the
smallest angle between any pair of lines, i. e.
δ(V) =
min
1≤k≤l≤P{
q
1 − |vH
1 v2|2}.
(9)
The Grassmannian codebook is designed so that
{V} = arg max
X∈UP
Nt
{δ(X)},
(10)
where UP
Nt is deﬁned as the set containing all unitary matrices.
III. MULTI-USER MIMO PRECODER DESIGN
In this paper, we address a problem that is common to all
common codebook in limited feedback broadcast systems. As
stated in the introduction, prior work has mainly focused on
rotational schemes. Moreover, the standardization processes
have so far ignored this problem. Thus, this paper comes up
with a very simple and interesting solution.
In our proposal, we share the same codebook between the
BS and all MS. To this end, we consider a Grassmannian
codebook of size P. We consider a practical scenario where
the partial CSI is provided at the BS through limited feedback.
We assume that each user has a knowledge of its own CSI
and no information about the channels of other users. In our
study, we assume also that the feedback channel is error free
and delay free and the Channel Quality Indicator (CQI) is sent
directly (without quantization), since we are interested only in
the effects of limited feedback on the precoding. However, the
number of bits needed for the quantization of CQI is relatively
low [14].
The detailed procedure of the proposed scheme is as follow :
1) First, each MS calculates the CQI, such as :
cqik = ∥Hkvp∥2
2; p = 1, . . . , P.
(11)
2) Each MS must ﬁnd the index of the best precoding
vector in the Grassmannian codebook that can maximize
the CQI :
wk = arg max
vp∈V
{cqik | p = 1, . . . , P}.
(12)
3) After obtaining the best precoding vector, each MS
transmits its own index and the CQI to the BS through
ﬁnite rate feedback.
4) The BS recovers the position of the precoding vector.
5) If two or more precoding vectors are identical, the BS
asks the users with low CQI to transmit their higher CQI
and respective index, excluding the ﬁrst choice.
6) Else, the precoder combines the signal of each user with
the selected wk.
45
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

IV. SIMULATION RESULTS
In this section, we compare the performance in terms
of error probability and sum rate of the proposed scheme
regarding the proposals in [11] and [12]. In the simulations,
the approach of Ding et al. [11] implies strictly the codebook
rotation procedure. Also, for the sake of simplicity we consider
the scheme of Fang et al. [12] without user selection.
In all simulations, a MU-MIMO broadcast channel is con-
sidered where the BS is equipped with two antennas trans-
mitting to two MS with two receiver antennas each. We also
consider that the BS transmits one data stream to each user
with the same power allocation, QPSK modulation is taken
into account and linear MMSE detector is adopted.
Results in Fig. 2 shows the comparison of BER performance
versus the SNR. According to Fig. 2, we can see clearly that
our proposal has the best performance. A gain of 2 dB and
4 dB is measured at 10−1 and 10−2 of BER, respectively.
0
5
10
15
20
10
-3
10
-2
10
-1
10
0
SNR (dB)
BER
 
 
Our proposal with P=8
Ding et al. with P=8
Fang et al. with P=8
Fig. 2.
BER comparison versus the SNR for 2x2 MU-MIMO system with
K = 2 and P = 8.
Fig. 3 presents the sum rate CDF for the three schemes. The
ﬁgure shows that the proposed scheme outperforms methods
[11] and [12]. The ﬁgure shows also almost the same perfor-
mance for methods [11] and [12]. It should be noted that the
curves are plotted for SNR= 5dB.
The comparison of ergodic sum rate versus the SNR is
depicted in Fig. 4. The ﬁgure shows that our proposal is
superior regardless of the SNR level. As expected, a gain
of 1 dB and 2 dB is observed for a low and high SNR,
respectively.
V. CONCLUSION
In this paper, we proposed to use a simple method to correct
the choice of the precoding vectors in MU-MIMO broadcast
channels. The proposed precoder is designed for the assump-
tion of imperfect channel knowledge at the transmitter through
limited feedback. The simulation results show a signiﬁcant
performance gain with respect to existing methods. Compared
to [11], our scheme uses the commun codebook in all users.
2
3
4
5
6
7
8
9
10
11
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Sum Rate (bps/Hz)
CDF
 
 
Our proposal with P=8
Ding et al. with P=8
Fang et al. with P=8
Fig. 3.
Comparison of CDF of sum rate for 2x2 MU-MIMO system with
K = 2 and P = 8.
2
4
6
8
10
12
14
16
18
20
4.5
5
5.5
6
6.5
7
7.5
8
8.5
9
9.5
SNR(dB)
Ergodic Sum Rate (bps/Hz)
 
 
Our proposal with P=8
Ding et al. with P=8
Fang et al. with P=8
Fig. 4. Ergodic sum rate comparison for 2x2 MU-MIMO system with K = 2
and P = 8.
Moreover, the choice of precoding vectors is performed at both
sides of the wireless link.
ACKNOWLEDGMENT
The authors wish to thank the Microsystems Strategic
Alliance of Quebec and the Natural Sciences and Engineering
Research Council of Canada for its ﬁnancial support.
REFERENCES
[1] N. Jindal, “MIMO broadcast channels with ﬁnite rate feedback,” IEEE
Trans. Inform. Theory, vol. 52, no. 11, pp. 5045-5059, Nov. 2006.
[2] A. B. Gershman and N. D. Sidiropoulos, Space-Time Processing for
MIMO Communications, Chichester, U.K.: Wiley, 2005.
[3] G. Caire and S. Shamai (Shitz), “On the achievable throughput of a
multiantenna Gaussian broadcast channel,” IEEE Trans. Inf. Theory, vol.
49, no. 7, pp. 1691-1706, Jul. 2003.
[4] M. Costa, “Writing on dirty paper,” IEEE Trans. on Inf. Theory, vol. 29,
no.3, pp. 439-441, May 1983.
[5] J. Jing, R. Buehrer, and W. Tranter, “Spatial T-H precoding for packet
data systems with scheduling,” in IEEE Fall Veh. Tech. Conf., Vol. 1, pp.
537-541, 2003.
46
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

[6] Q. H. Spencer, A. L. Swindlehurst, and M. Haardt, “Zero forcing methods
for downlink spatial multiplexing in multiuser MIMO channels,” IEEE
Trans. Signal Processing, vol. 52, no. 2, pp.461-471, 2004.
[7] C. Peel, B. Hochwald, A. Swindlehurst, “Vector-perturbation technique
for near-capacity multiantenna multiuser communication-part I: channel
inversion and regularization,” IEEE Trans. on Communications, vol. 53,
no.1, pp. 195-202, 2005.
[8] L. U. Choi and R. D. Murch, “A transmit preprocessing technique for
multiuser MIMO systems using a decomposition approach,” IEEE Trans.
on Wireless Commun., vol. 3, no. 1, pp. 20-24, 2004.
[9] D. J. Love, R. W. Heath, V. K. N. Lau, D. Gesbert, B. D. Rao, and M.
Andrews, “An overview of limited feedback in wireless communication
systems,” IEEE J. Sel. Areas Commun., vol. 26, no. 8, pp. 1341-1365,
Oct. 2008.
[10] D. J. Love, R. Heath, W. Santipach, and M. Honig, “What is the value
of limited feedback for MIMO channels?,” IEEE Commun. Mag., vol. 42,
no. 10, pp. 54-59, Oct. 2004.
[11] P. Ding, D. J. Love, and M. D. Zoltowski, “Multiple antenna broadcast
channels with shape feedback and limited feedback,” IEEE Trans. Signal
Processing, vol. 55, pp. 3417-3428, July 2007.
[12] S. Fang, G. Wu, Y. Xiao, and S. Q. Li, “Multi-User MIMO Linear
Precoding with Grassmannian Codebook,” International Conference on
Communications and Mobile Computing, vol. 1, pp.250-255, 2009.
[13] D. J. Love, R. W. Heath, Jr., and T. Strohmer, “Grassmannian beamform-
ing for multiple-input multiple-output wireless systems,” IEEE Trans. Inf.
Theory, vol. 49, no. 10, pp. 2735-2747, 2003.
[14] T. Yoo, N. Jindal, and A. Goldsmith, “Multi-antenna downlink channels
with limited feedback and user selection,” IEEE J. Select. Areas Commun.,
vol. 25, no. 7, pp. 1478-1491, Sept. 2007.
47
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

