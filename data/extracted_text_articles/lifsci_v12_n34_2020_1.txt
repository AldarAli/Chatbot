Integrating Blockchain Technologies with the Italian
EHR Services
Mario Ciampi, Angelo Esposito, Fabrizio Marangio, Giovanni Schmid, Mario Sicuranza
Institute for High Performance Computing and Networking of the National Research Council of Italy
Naples, Italy
e-mail: {mario.ciampi, angelo.esposito, fabrizio.marangio, giovanni.schmid, mario.sicuranza}@icar.cnr.it
Abstract—The increase of population life expectancy and of
patient mobility makes necessary the development of new reliable
and trust models for health provision within a patient-centric
approach. For this reason, many proposals have been carried
out to make the current healthcare systems able to collect and
analyze the great amount of patient clinical data produced by
the health organizations in an interoperable way and according
to shared processes. However, despite the ability of collecting
such clinical data, approaches aimed at assuring that these data
are produced strictly following quality processes still lack. This
work presents a permissioned blockchain architecture designed to
assure integrity of data and processes related to Electronic Health
Records coherent with the Italian Interoperability Infrastructure.
The proposed architecture is compliant with both the Italian
Regulation on Electronic Health Record and the European Reg-
ulation on privacy. A proof-of-concept prototype implemented on
the top of Hyperledger Fabric framework validates the feasibility
of the proposed architecture against two relevant use cases,
showing that the application of blockchain technology to the
healthcare sector could provide important beneﬁts in terms of
process and data integrity and quality.
Keywords—electronic health record; blockchain; patient-centric
architecture
I. INTRODUCTION
An important issue for the well-being of citizens is to
have health systems suitable to the modern society and able
to exploit the most recent technology, so that they can be
efﬁcient, reliable, scalable, and capable of providing adequate
care to a large number of people, both in the medium and long
term.
Evolving these systems – aimed ﬁrstly at preventing health
diseases through the lifestyle monitoring of people and the use
of innovative and non-invasive therapies based on precision
medicine – is an essential condition for containing public
spending and the sustainability of the same national health
systems.
In the attempt to achieve this goal, huge efforts are under-
way in EU countries to digitize health processes for increasing
usability and reliability for patients and healthcare personnel,
allowing for a reduction in time and costs.
The areas in which improvements can and must be achieved
are still many, and the margins of enhancement allowed by
emerging technologies like permissioned blockchains for the
secure and transparent processing of distributed workﬂows
can be really substantial, such as to revolutionize prevention
and treatment approaches [1]. Indeed, current IT systems are
rooted on data producers (e.g., hospitals and healthcare com-
panies) with the aim of collecting health information, while
infrastructures and protocols designed to guarantee traceability
and a “patient-centric” approach are lacking, if not completely
absent. This complicates and makes healthcare costlier for
citizens, as well as favoring the incidence of accidental errors
and frauds, often with serious consequences in terms of public
health.
The integrity and traceability of health documents and
processes provided through blockchain technologies can also
increase conﬁdence of patients and physicians in emerging
ﬁelds like Telemedicine.
One of the major IT solution to advance healthcare in the
last decade is the Electronic Health Record (EHR), which is a
“longitudinal collection of health data and documents about an
individual’s lifetime with the purpose of supporting continuity
of care, education and research, and ensuring conﬁdentiality
at all times” [2]. EHRs allow improving the management of
health processes by increasing efﬁciency and decreasing costs.
In [1], we proposed a blockchain network to support the
decentralized management of EHRs, speciﬁcally designed ac-
cording to the Italian EHR interoperability architectural model.
In the context of that work, we developed a proof-of-concept
prototype and performed a set of simulations for showing the
effectiveness of our design, and the advantages of deploying
a blockchain network for implementing access control and
auditability at ﬁne grain.
The present work extends the previous contribution by
specifying the integration approach between the blockchain
network and the EHR infrastructure, both in terms of archi-
tecture and implementation. We point out the main interactions
among the different layers composing the system, discuss how
these interactions can be implemented through the blockchain
technologies, and show their workﬂow for some use cases.
We also present and discuss, with a series of experimental
sessions, new and more effective implementations of access
control at the blockchain layer, which are in line with the new
strategies and tools offered by the blockchain development
platform used.
The rest of the paper is organized as follows. Section
II describes relevant background and related works. Section
III presents our contribution, giving the system requirements
57
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

and its core architecture. Section IV details the prototype
developed, whereas Section V concludes the paper.
II. BACKGROUND AND RELATED WORK
In this section, ﬁrstly, a general overview on the Italian EHR
interoperability framework is presented, paying attention on its
main limitations and how they can be overcome. Secondly, the
most signiﬁcant scientiﬁc related work is described.
A. The Italian EHR interoperability framework
The Italian National Health Service (SSN) is a system of
organizations, facilities and services that have the purpose
of guaranteeing all citizens, under conditions of equality,
universal access to the equitable provision of health services.
The Italian Constitution provides for legislative protection of
the State and the Regions for the protection of health. The
State determines the essential levels of assistance that must be
guaranteed throughout the national territory, while the Regions
plan and manage health care in their area in full autonomy [3].
In the last decade, several public health service organiza-
tions have undertaken many initiatives in order to improve the
quality of health services by applying information and commu-
nication technologies. The most signiﬁcant efforts performed
regard the design and implementation of Health Information
Systems (HISs) [4], and in particular EHR systems. These
ones permit to collect the digital health information related to
a patient produced by the healthcare facilities and services on
the national territory [5].
In order to overcome the problem of interoperability among
the different regional EHR systems, since 2012 speciﬁc Italian
norms have been issued, leading national Institutions (Agency
for Digital Italy, Ministry of Health, Ministry of Economy and
Finance, with the technical support of the National Research
Council of Italy) to deﬁne the national EHR interoperability
architectural model. This model is based on a set of regional
IT platforms that interact each other by means of a national
framework, namely National Interoperability Infrastructure
(INI), as shown in Figure 1.
Each regional IT system has the aim of indexing into a
registry the digital clinical documents related to its patients,
whereas such documents are stored into the data repositories
typically located at the health facilities [6].
INI is conform to the registry/repository paradigm based on
the IHE XDS Integration proﬁle speciﬁcations, with the scope
of facilitating the sharing of patient EHRs across health en-
terprises within an afﬁnity domain, which is a set of technical
policies and codes shared by a group of healthcare facilities
that intend to work together [7].
With regards to the data structure, two different approaches
are used for managing digital documents and metadata.
Clinical documents are structured conforming to the HL7
CDA Rel. 2.0 standard [8], which consists of two main
sections: header, containing contextual data (like patient name,
author, etc.); body, devoted to the representation of the clinical
content. Each type of clinical document is structured according
Fig. 1. Italian EHR interoperability framework.
to the Italian Implementation Guides, which are national
localizations of the HL7 CDA Rel. 2 standard.
Metadata are a set of data that describe the clinical doc-
uments produced by the clinical facilities, with the aim of
facilitating their indexing and retrieval. Such metadata contain
information like patient identiﬁer, author, document reference
and so on. They can easily be mapped to the contextual data
memorized in the header of the HL7 CDA Rel. 2.0 documents.
The structure and the types of the metadata comply with the
IHE XDS proﬁle.
Moreover, the processes that formally describe all the ac-
tivities that each involved actor has to perform have been
modeled. Such processes describe the steps to index, search
for, and retrieving patient health metadata and documents,
wherever they are memorized on the national territory. All
the regional IT systems have a regional node, which is the
interface among the internal services and resources and the
other regional nodes. Each interaction among such regional
nodes, based on consolidated international health informatics
standards, are mediated by INI. Along with the architectural
model and the business processes, the functional and privacy
requirements, as well as the technical speciﬁcation for assuring
interoperability are deﬁned and applied [9].
These shared technical speciﬁcations permit the regional
EHR systems to collect patient health documents, make au-
thorized health professionals able to consult such documents
if the patient has provided her/his consent, and interact with
other regional EHR systems to exchange clinical information.
B. Issues and new directions
Despite the efforts made so far to develop a national
federated architecture for the interoperability of EHR systems
in Italy, signiﬁcant actions are still to be taken in order to
ensure an effective and correct implementation of the health
interoperability processes.
Speciﬁcally, every interoperability process is in part exe-
cuted through one only regional EHR system (inside a Region)
58
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

and the other part is executed by other IT systems that interact
with the regional system through INI. INI permits to control
and partially track the requests coming from regional EHR
systems, whereas the interactions occurred within a regional
system are logged by this last one. For these reasons, it is
complex, for the Regional EHR system, to verify that all
the activities of a speciﬁc process are appropriately executed,
unless to analyze all the event logs generated by the distributed
systems involved. Moreover, even considering a regional con-
text, the operations performed are often tracked by different
autonomous subsystems, not allowing this way the possibility
to certify that the tasks executed are compliant to the desired
workﬂows.
A complementary architecture, opportunely designed to
store in a reliable and effective way the operations executed
and interoperable with the national architectural framework,
would allow ensuring patients, health professionals, and gov-
ernment organizations that the health data are produced ac-
cording to the speciﬁed and shared procedures.
C. Related work
In the last years, many academic and industry works con-
cerning blockchain technologies and their applications have
been performed in various sectors besides ﬁntech.
Healthcare, alongside with the supply-chain industry, has
probably one of the highest prospects on opportunities from
these technologies. A search for the term “blockchain” on
PubMed returned 21 results in 2017, 74 results in 2018, 132 in
2019, and 134 results in the ﬁrst half of 2020. According to a
recent study [10] by Frost & Sullivan, blockchain in healthcare
is slowly starting to migrate from pilot proof of concept to
commercial deployments, mainly across select enterprise-level
B2B-focused use cases (e.g., credentialing, claim adjudication,
supply chain, and so on). The expected revenue will be 500.7
million US$ in 2022, and pharma companies will probably
be the early adopters of blockchain systems compared to
other healthcare stakeholders. Various companies have already
implemented or are working on putting a blockchain system
to the test for a healthcare use case, (e.g., [11] [12] [13]
[14] [15]), and as for July 2020 there are at least ten major
healthcare blockchain consortia [10] [16]. Below, for the sake
of brevity, we will limit our discussion to three major projects,
which have resulted in working implementations. Indeed, they
exploit different and signiﬁcant approaches to the management
of EHRs that have inﬂuenced our work.
MedRec [17] is a project initiated in 2016 by MIT Media
Lab and Beth Israel Deaconess Medical Center, with the
aim to overcome four important issues in the healthcare
context: fragmented data, slow access to medical data, systems
interoperability, and patient agency. It provides a decentralized
approach in which the permissions, data storage location,
and audit logs are maintained in the blockchain, while all
healthcare information remains in the already pre-existing
EHR systems. The project has developed two blockchain
platforms both built on Ethereum’s framework, but with ma-
jor differences. Version 1.0 [18] was a small-scale, private
network with speciﬁc APIs, whilst the current version 2.0
is developed using Go-ethereum (Geth) and Solidity, but
with changes to the amount of information stored on the
blockchain for improving the scaling and privacy properties of
transactions. Other major differences concern the consensus
and governance protocols. MedRec 1.0 uses the Ethereum’s
proof-of-work protocol with appropriate parameters, where the
mining process would be performed by medical researchers,
who in turn would gain access to aggregated and anonymized
data useful to further medical research. However, this approach
poses concerns about the security and governance of patient
data. In the current version, therefore, the EHR providers
maintain the blockchain, resulting in a small and closed set
of nodes that can reach consensus without the cost of mining.
Providers use a proof-of-authority to append new blocks, and
also to determine who is in their group.
Patientory [19] is both the name of a digital health company
established in 2015 and a no-proﬁt association for develop-
ing and governing the PTOYNet blockchain. PTOYNet is
a fork of Quorum, which in turn is an enterprise-focused
version of Ethereum, mainly implemented by developers of
JPMorgan Chase. Quorum executes smart contracts within
the Ethereum Virtual Machine, but uses alternatives to the
mining-based consensus protocol of Ethereum; moreover, it
has built-in the feature of transaction conﬁdentiality thanks
to end-to-end encryption. PTOYNet has been adapted from
Quorum in order to store healthcare records and manage their
transactions through the PTOY token, providing an ecosystem
for healthcare organizations to collaborate and innovate in a
completely decentralized fashion. In exchange for PTOY, pa-
tients and healthcare organizations are able to use the network
to rent health information storage space and execute health-
speciﬁc smart contract payments and transactions. Patientory
Inc. gains its revenue from the Software as a Service (SaaS)
annual contract, as well as from population health management
services from the aggregation of data on the platform: machine
learning services for supporting physicians to perform medical
diagnoses, patient-provider UIcare coordination, and patient
engagement. In 2018, the company launched on the market
a mobile distributed application (DApp), which leverages the
services offered by the PTOYNet platform. At the time of
writing, the approximate return on investment (ROI) in PTOY
if purchased at the time of launch is -98.75% [20].
Medicalchain [13] is an infrastructure to securely store and
share EHRs: any interactions with EHRs are recorded as trans-
actions on the network, but the EHRs are encrypted and stored
in data stores within appropriate regulatory jurisdictions. Its
ﬁrst implementation was released in February 2018 and is built
on a double blockchain. The ﬁrst blockchain is a permission-
based Hyperledger Fabric architecture, which allows varying
access levels to the EHRs: users can control who can view
their records, how much they see and for what length of
time. The second blockchain is Ethereum, which is used to
run all the applications and services for the Medicalchain
platform through the ERC20-compliant cryptocurrency token
MedToken (MTN). MTNs have been offered through an initial
59
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

coin offering (ICO) crowd selling process started on February
1st, 2018. At the time of writing, Medicalchain has a current
supply of 500,000,000 MTN with 308,865,295.76 MTN in
circulation, with an approximate ROI of -98.88% [21].
The previous examples should point out the difﬁculties
of realizing a blockchain EHR management system, both
in terms of technical deployment and governance. These
difﬁculties are exacerbated by the EU regulations in different
ways. For example, the storage of EHRs in the ledger is not
only inappropriate since blockchain systems do not have the
requisites of massive databases, but they make very difﬁcult
to enforce the right to data modiﬁcation or erasure under
particular circumstances, as stated by the Articles 16 and 17
of the General Data Protection Regulation (GDPR) [22]. More
generally, blockchains underline the challenges of adhering to
the requirements of data minimization and purpose limitation
in the current form of the data economy.
III. THE PROPOSED ARCHITECTURE
In this work, we discuss an innovative blockchain archi-
tecture that, as its core functionality, enforces the integrity
of the clinical data and processes managed through the Ital-
ian EHR infrastructure by implementing the auditing of the
actions performed on such data and their resulting status
in a decentralized, interoperable, tamper-proof and timeline
ledger. The blockchain system acts as middleware and network
infrastructure, which is interposed between the application
(regional EHR services) and network layers. Depending on
the coupling level with the application layer, and the additional
requirements with respect to the INI technical speciﬁcations
[9], the blockchain system could optionally provide for the
speciﬁcation of access control policies, also complementary
to policies deﬁned through INI, and the enforcement of their
relative authorization rules by means of ACLs (Access Control
Lists). This can allow speciﬁc healthcare ecosystems belong-
ing to INI (hospital chains, health districts, etc.) to enrich and
customize the data management and access to care functions
for their patients.
The proposed architecture is compliant with both the re-
cently introduced GDPR and the national EHR interoperability
architectural model described in Section II.A. Indeed, the
design of the architecture was driven by the functional and
non-functional requirements listed in Tables I and II. These
requirements stem from the framework of fundamental rights
of the GDPR and the organizational constraints for the national
EHR interoperability architectural model. They can be subdi-
vided in mandatory (M) and recommended (R) requirements,
and further grouped into basic (B) requirements and those
deriving from needs related to patients (P) and those arising
from the needs of health organizations (O).
Patients’ needs are related to their privacy and the rights to
data access (Article 15 GDPR) and data portability (Article 20
GDPR), which provide patients with control over what others
do with their personal data and what they can do with that
personal data themselves.
TABLE I
MANDATORY REQUIREMENTS (MBR: MANDATORY BASIC
REQUIREMENT; MPR: MANDATORY PATIENT REQUIREMENT; MOR:
MANDATORY ORGANIZATION REQUIREMENT)
MBR1
Identiﬁcation and authorization for all the actors
MBR2
Document indexing functions: the reference IT system for a
patient has the responsibility of memorizing index metadata
related to all his/her documents, even if they are produced and
archived by health facilities managed by other IT systems
MBR3
Search and retrieval functions for documents related to a
speciﬁc patient
MBR4
Backup and restore functions
MBR5
Audit operations are required: it is necessary to track all the
operations carried out by all the actors
MBR6
Data and process integrity has to be assured
MPR1
Patients must be able to hide their data from healthcare
practitioners
MPR2
Patients need to have the ability to know how and when
their data are accessed and for what purpose. This will be
possible through the disclosure property, as indicated in the
EU directives
MPR3
Patients must be able to search for and retrieve their health
data in the system
MOR1
The holder of the data treatment is the healthcare organization
that produced data
MOR2
Healthcare organizations must provide protection to the data
they hold
The basic requirements (MBR1-MBR4 and RBR1) are
assured by the implementation of the Italian national interop-
erability technical speciﬁcations for EHR systems [23] [24] for
both primary and secondary uses. Instead, MBR5 and MBR6
requirements stem from the blockchain adoption. Indeed,
the blockchain functionalities allow to have corroborate and
auditable evidence that all workﬂows at the application layer
are correctly executed, provided that these workﬂows were
coded as appropriate (sets of) transactions.
The requirements MPR1, MPR2, and MPR3 are satisﬁed
thanks to the introduction of the blockchain infrastructure
and the use of access policies applied to the patient’s health
documents. The MOR1 requirement is satisﬁed by the prin-
ciple deﬁned for the EHR: in fact, the organization of the
author of the document is also the owner of it. The use of
ACLs allows the patient to have total access control to his/her
health documents. Functional requirements MOR2 and ROR1
are assured because data access control is managed through
ACL in the blockchain. The RPR1 requirement is guaranteed
because all information requesting/accessing health documents
is stored in the blockchain. Moreover, in the blockchain, the
ACL provides a quick and easy way to modify the access
policies on health documents by the Healthcare Organizations,
therefore, the requirements ROR2, ROR3 and ROR4 are
satisﬁed.
A. Architecture overview
Each regional EHR system provides both a set of IT services
for i) the management of regional health documents and ii) the
interoperability with other regional EHR systems. These last
services can be used by the actors of other regional systems,
through the INI interoperability infrastructure. They are:
60
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

TABLE II
RECOMMENDED REQUIREMENTS (RBR: RECOMMENDED BASIC
REQUIREMENT; RPR: RECOMMENDED PATIENT REQUIREMENT; ROR:
RECOMMENDED ORGANIZATION REQUIREMENT))
RBR1
Anonymization / pseudo-anonymization data functions
RPR1
Patients should be able to provide access to healthcare practi-
tioners that are not entitled to access their data
RPR2
Functions for allowing a patient to send data produced by
certiﬁed devices to organizations for storage and management
RPR3
Patients must be able to hide their data from speciﬁc healthcare
practitioners
ROR1
Every healthcare organization can manage security policies in
line with regulations, but with a certain level of autonomy
ROR2
Every healthcare organization should be able to design its own
security policy and to enforce it. The deﬁnition of the access
policies must be implemented in total freedom and through a
highly ﬂexible mechanism
ROR3
Healthcare organizations should be able to change quickly and
easily the access policies of a given document
ROR4
The access control procedure should not add a signiﬁcant
administrative overhead
• Search for document: a healthcare professional searches
for health documents (by satisfying search criteria) for a
patient coming from another Region.
• Create or update Document:
a healthcare professional
creates or updates a healthcare document related to a
patient coming from another Region.
• Delete Document:
a healthcare professional deletes a
speciﬁc document previously created for a patient coming
from another Region.
• Transfer Patient: the management of the metadata index
related to a patient is transferred to another regional
system.
• Retrieve Document: a healthcare professional retrieves a
speciﬁc document.
The access to services has to be allowed only to authorized
actors with respect to national, regional and local access
policies (e.g., policies derived from the patient’s will).
The actors get access to the system thanks to one of the
two authentication methods prescribed in Italy, which are
SPID or CNS. SPID [25] is the unique system of access
with digital identity to the online services of the Italian Public
Administration, in accordance to the Electronic Identiﬁcation
and Trust Services Regulation (eIDAS). CNS [26] is a device
(i.e., a Smart Card or USB stick) that contains a “digital
certiﬁcate” of personal authentication.
Both individuals and companies are identiﬁed by an Italian
identiﬁer, named ﬁscal code (CF).
The main actors of the national interoperability system are:
• Patient: any citizen accredited on the EHR system, who
needs health care.
• Region: territorial entity with its statute, powers, and
functions according to the principles established by the
Italian Constitution.
• Health Organization: any public/private health company
authorized by the Ministry of Health.
• Admin Ofﬁcer: an administrative ofﬁcial in charge of
patient registration and accounting for a health company.
• Organization Physician: a physician working in a health
organization registered in the network, who is in charge of
carrying out diagnostic examinations or medical reports
for patients, thus creating their health data.
The national access policies are based on the following
attributes:
• role: the requestor role;
• locality: the location of the requestor when she/he per-
forms the request;
• purpose of use: the reason for the request;
• resource type: the kind of document requested;
• organization identiﬁer: the identiﬁer of the health profes-
sional’s organization;
• subject identiﬁer: the identiﬁer of the requestor (health
professional’s ﬁscal code);
• resource identiﬁer: the patient’s ﬁscal code;
• consent: the consent provided from the patient to the
health organization to the care treatment;
• action identiﬁer: the type of request operation.
The standard used for the exchange of authentication and
authorization data is OASIS SAML 2.0. The assertions are
transported in the header of SOAP messages, which are
exchanged between the regional platforms and INI, in the
context of interoperability services. The attributes present in
the assertion are compared with the ACL to allow access or
not to EHR data and services.
Figure 2 shows the modules relating to the regional EHR
services, those related to the Interoperability Services, and the
mapping module allowing the interaction of the regional EHR
services with a permissioned blockchain, where the function
of the nodes composing the blockchain network are deﬁned
and implemented in relation to the computing facilities of
the organizations providing the services. This module is in
charge of assuring the correct mapping of participants, data
and interactions. In particular, for each regional EHR service
request, this module: i) speciﬁes the participants, assets and
transactions that are involved in the blockchain system to fulﬁll
the request, ii) encodes a transaction proposal, and iii) submits
such proposal to a blockchain peer. It is worthwhile to stress
in this respect that the participants in the blockchain network
are identiﬁed by the mapping module in relation to the entities
managed at the higher layers of the overall architecture. Actual
participants are indeed enrolled, identiﬁed and authenticated
at the application layer, which is also responsible for deﬁning
user access permissions to data and resources according to
attribute-based access control policies. At the blockchain layer,
further access control lists are instantiated and enforced for
such participants.
B. Blockchain network overview
Our system is a kind of permissioned blockchain where,
according to recent design principles [27], network nodes
have different functions and can be subdivided in validating,
endorsing and ordering peers. This approach decouples agree-
ments about interoperability processes from the consensus
61
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Fig. 2. The proposed blockchain architecture integrated with the EHR services.
concerning the transactions and their ordering, which have to
be recorded in the blockchain.
Validating nodes have their own copy of the ledger: they are
healthcare-related companies, institutions and control agencies
that check for transaction I/O versus the current status of the
ledger.
Endorsing peers are validating nodes that, on the basis of
a consensus policy provided at the application layer, have
got the additional task of checking transaction correctness
both syntactically and by running them. Endorsers can be
deﬁned on a per-transaction basis, and this role is typically
assumed by the entities involved in a given transaction, or
the organizations they belong to. For example, in case of
a pharmaceutical prescription, the endorsers could be the
healthcare company to which the physician who made the
prescription belongs or a regional institution representing the
SSN. In the Italian scenario, the endorser role could be acted
by SistemaTS (the Italian IT framework where all the digital
prescriptions are memorized and retrieved by the pharmacies
for the dispensations of the medications).
Ordering peers are nodes that – through a suitable consen-
sus protocol, implemented in a dedicated module – have to
assemble transactions in blocks and select the next block of
the chain for the relevant blockchain. Ordering nodes do not
need to store any blockchain, nor they are aware of transaction
contents: they just assemble the endorsed transactions received
in blocks and communicate the next block to the validating
nodes for the relevant blockchain via a gossiping protocol.
Ordering nodes can be supplied by the same organizations
that provide validating peers, or by different organizations,
depending on the governance and trust models deﬁned for
the consortium of organizations involved in the blockchain
network.
Finally, the users of the blockchain network in our context
are patients, physicians and other personnel of the healthcare
sector. They require services at the application layer that
are encoded as suitable transactions to be submitted to the
blockchain by the mapping module (Figure 2).
Transactions deﬁne the logic for the management of partic-
ipants and health documents through the blockchain. Accord-
ing to the national EHR interoperability architectural model
described in Section II.A, the actual participants proﬁles and
patients’ health documents are stored and accessed through
the regional EHR systems. The blockchain network introduced
62
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

with the proposed architecture keeps track how such proﬁles
and health data are produced or consumed. Speciﬁcally, patient
proﬁles have got corresponding blockchain assets just in case
the blockchain is used to complement or substitute the EHR
systems for the speciﬁcation and enforcement of access control
policies. In these cases, the patient-related asset encodes the
patient identiﬁer, plus a list of identities or roles having some
privileges on patient’s documents. These ACLs are deﬁned
according to the patient-centric requirements for access data
management, as optionally provided at the application layer,
and in function of the roles and data types supported in
the technical speciﬁcation for EHR interoperability [28]. It
is worth noting that if the access control policies are the
high level ones deﬁned in [29], they can be implemented in
the blockchain through smart contracts, as they are deﬁned
system-wide rather than at the level of individuals.
Unlike participants, each health document is represented
as a blockchain asset. This asset contains a set of metadata
derived by [23] and the link to the actual document. In the ap-
plication scenarios envisioned in this work, the aforementioned
link is only used for tracking purposes, since the indexing
functions are offered at the application layer; however, this
element could be used as a real hyperlink to the document
if the indexing functions were provided via blockchain. Some
of the ﬁelds speciﬁed in assets encoding health documents are
(see Figure 3):
• authorPerson: deﬁnes the CF identiﬁer of the author, in
our case the physician that created the asset;
• authorRole: deﬁnes the role of the author (like general
practitioner);
• authorInstitution: deﬁnes the CF identiﬁer of the com-
pany in which the physician who created the asset works;
• patientID: the CF identiﬁer of the participant for whom
the document is created;
• classCode: deﬁnes the class of the document (prescription
– PRS, medical report – REF, and so on);
• conﬁdentialityCode: deﬁnes the level of conﬁdentiality of
the asset (unrestricted, low, moderate, normal, restricted,
very restricted);
• mimeType; identiﬁes the MIME type of the indexed
document.
Transactions are articulated in the following four sets,
depending on their scope:
• Creation and modiﬁcation of participants: various trans-
actions permit to create and modify the blockchain assets
related to individual participants. Participants are univo-
cally identiﬁed in the system by their CF, which can be
set and modiﬁed only by the creator of the participant,
following the rules given in Section III.A. The whole
process is managed by the mapping module in accordance
with the access control rules for the participants deﬁned
at the application layer. Typically, as detailed previously,
assets are created only in case participants represent
patients, and only when the blockchain is used to manage
ﬁne-grained, patient-centric access control policies.
Fig. 3. Example of a blockchain asset encoding a health document.
• Creation and modiﬁcation of health documents: consis-
tently with the fact that only agents previously authorized
by the high-level policies in [23] and/or by a patient can
create or update their health documents, these rules apply
also for the related assets managed in the blockchain.
Only the creator of a health document (and its corre-
sponding asset) can subsequently modify it, but in any
case this will be tracked in the blockchain through a
suitable transaction. If provided as functionality by the
access control policy, the patient can give read access for
the document to other participants in the network, and
this will be tracked in the blockchain through a speciﬁc
transaction affecting the asset encoding the patient’s
proﬁle (see next item).
• Access to health documents: this kind of transactions
allows the access to the health documents of a patient.
By default, other than by their creators, health documents
can be read by the patients to which they refer to and
by the practitioners indicated in [23], in function of the
purpose of use of the document. If the blockchain is
used to implement patient-centric access control policies,
these last are implemented as a speciﬁc set of read
ACLs provided in the patient’s proﬁle. By tracking access
requests, this kind of transactions implements the MBR4
requirement of disclosure (see Section III.A)
• Access to personal info: patients must give their explicit
consent to other participants (e.g., healthcare companies)
for reading the information encoded in their asset. This
kind of transactions implements the requirement MPR1
and is regulated by another set of speciﬁc read ACLs in
63
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Fig. 4. Class Diagram of participants, data and transactions managed in the blockchain network.
the patient’s proﬁle.
A class diagram representing the various participants, data
and transactions that are managed in the blockchain network
is given in Figure 4.
C. Use cases
This section aims to give a more comprehensive overview
of the overall architecture resulting from our proposal of
integration of a blockchain network with the Italian EHR
Interoperability Framework. It describes the interactions
among its different layers in the two use cases of document
search and document retrieval.
Document search
Figure 5 shows the sequence diagram related to the search
for one or more health documents by a physician. The
physician, authenticated on the EHR regional system, uses
the Search Documents service depicted in Figure 2, which
forwards the request to INI through the Searching Documents
interoperability service. These interactions are concisely
indicated as an “Access” phase performed by the physician
in Figure 5, who at this point will have the search request
submitted to INI. INI carries out the validation of the request
by verifying if the user has the access right to the service and,
if these checks are passed, then forwards the request to the
Regional Services. In turn, a node implementing a regional
service: i) forwards the request to a blockchain peer, which
reads the ACLs provided by the asset of the patient to whom
the documents belong; ii) compares those ACLs with the
metadata encoded in the assets of the required documents; and
iii) returns a list of metadata that the physician is authorized
to access (the list may be empty).
Document retrieval
Once the physician has received a list of references to the
documents satisfying the search query, she/he can carry out
the document retrieval request, according to the same logic
described above. In this case, as shown in Figure 5, the
64
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Fig. 5. Sequence Diagrams that illustrates the interactions among the actors of the architecture for document search (top) and retrieval (bottom).
65
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

blockchain peer, after the comparison of the ACLs coded in the
patient’s asset with the metadata contained in the document’s
asset, returns to the physician the required health document,
or an “access denied” error.
IV. IMPLEMENTATION AND RESULTS
In [1], we implemented a prototype of a permissioned
blockchain network, in order to assess the proposed archi-
tecture. At the time, we deployed a blockchain network and
enrolled some templates of participants using Hyperledger
Composer [28]. Then, we used the Hyperledger Fabric v1.2
runtime [29] to perform a set of simulations, in order to show
the effectiveness of the enforcement of patient-centric access
control policies through the blockchain for some relevant use
cases. The ultimate scope of those simulations was to show
that through blockchain technologies it is possible to easily
and effectively implement all the functional requirements
illustrated in Section III.
In this extended contribution, we pursue the same goal but
with the following major differences:
• participants are not actually enrolled in the blockchain
network. This complies with the overall architectural
framework described in Section III.A and with the role
and functions of the blockchain network as detailed in
Section III.B;
• ACLs are no more deﬁned through Hyperledger Com-
poser. This stems primarily from the fact that Hyperledger
Composer was considered an obsolete project by Septem-
ber 2019. However, implementing the ACLs by working
directly at the chaincode and/or asset levels allows for
the speciﬁcation of more ﬂexible and powerful ACLs, as
we will show shortly.
The complete set of functional requirements listed in Tables
I and II gives rise to a patient-centric data management frame-
work, where individuals have the capability to set permissions
for their documents in a punctual way (e.g., set for a speciﬁc
physician the read access to a speciﬁc document). However,
according to the technical speciﬁcations [23], patients can
manage their documents in a much less punctual way. Per-
missions to read and edit documents are indeed enforced on
the basis of system-wide rules stemmed from roles such as
general practitioner, hospital physician or pharmacist, which
the patient cannot change. What patients can do are some
actions like obscuring a given document to all other actors,
obscuring all their information and documents, or delegate
some other people to manage their health documents (as in the
case of patients with severe health conditions). In such respect,
the recommended requirements listed in Table II can be seen
as complementary to the mandatory requirements already
provided by standard implementations of the regional EHR
services, and that can be effectively and reliably implemented
through the blockchain technologies.
In the rest of this section, we will show how it is possible
to use Hyperledger Fabric chaincode and assets to implement
ACLs with different levels of granularity, so to enforce at the
blokchain layer access control policies that integrate more or
less extensively those provided by the regional EHR services.
Figures 6 and 7 show two possible implementations of a
patient asset, in relation to more or less stringent ACLs.
The patient asset in Figure 6 has a complex structure in
order to indicate: i) who can read or update the asset (through
the readAccess and updateAccess strings); ii) who can create
a patient’s document (through the docCreateAccess string);
and, iii) who can read or update speciﬁc patient’s documents
(through the docReadAccess and docUpdateAccess strings).
The patient asset in Figure 7 has a less complex structure,
corresponding to the fact that patients can still decide who
can read or update their assets, but they can not set access
permissions related to speciﬁc health documents. In both cases,
Fig. 6. Asset with document-oriented ACL management.
Fig. 7. Asset without document-oriented ACL management.
66
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

every patient’s health document is listed in the docList, which
represents the timeline of all patient’s documents and is used
to set the ACLs related to speciﬁc documents.
A. Fine-grained ACLs
Let us ﬁrst consider an access control scenario like that in
our previous work [1], where patients can manage punctual
permission to authorize speciﬁc participants to read or update
their documents.
Figure 8, Figure 9, Figure 10 and Figure 11 show a com-
parison of the ACLs implemented with Hyperledger Composer
and the new implementation via chaincode. Speciﬁcally, these
ﬁgures show the possible implementation of two ACLs, for
the management of the read permission to the patient asset
and a health document, respectively.
While Hyperledger Composer allows to set permissions at a
higher level, working with chaincode requires the knowledge
of a chaincode-oriented programming language (in this case
Java), but allows the speciﬁcation of more complex, ﬁne-
grained ACLs.
For instance, Hyperledger Composer requires a participant
and a resource to set up an ACL. Thus, the participant must
be explicitly enrolled in the blockchain network through a
suitable membership service provider.
In the context of our architecture (see Section III), this is a
strong limitation that would preclude from having more assets
Fig. 8. Hyperledger Composer ACL for reading patient info.
Fig. 9. Chaincode ACL for reading a patient asset.
Fig. 10. Hyperledger Composer ACL for reading a document.
Fig. 11. Chaincode ACL for reading a document.
communicating with each other, and from managing ACLs
through assets other than through identities.
Simulations have been carried out in the Hyperledger Fabric
2.0 runtime in order to verify that the implementations of
the ACLs via chaincode, along the same lines as previously
illustrated, permit to enforce the authorization rules performed
by INI. These simulations consist in the realization of a
scenario in which a patient is able to provide explicit autho-
rization to a speciﬁc health organization to access his/her own
prescription document produced by a general practitioner. The
implementation of this scenario was carried out by exploiting
the feature provided by the chaincode concerning the possibil-
ity of making the assets relating to the patient and that relating
to the health document able to communicate each other.
The results reached give corroborate evidence that all the
requirements listed in Tables I and II could be easily and
effectively implemented trough blockchain technologies.
B. Obscuration of patient’s documents
This section provides a proof-of-concept for the implemen-
tation of the “document obscuration” functionality using the
proposed architecture based on the blockchain technology.
This capability could be necessary for some type of docu-
ments containing sensitive data about major health problems
or addictions. In some cases, the practitioner at document
creation time has to specify that it has to be obscured because
of national regulations; however, patients have to be able to
obscure or make their documents visible at their choice [23].
We will illustrate a very simple workﬂow, where a document
is ﬁrst created as visible by a practitioner and then is obscured
by the patient (to whom it refers to).
The document creation is realized by the transaction showed
in Figure 12.
This transaction requires an Id for the health document and
a JSON String with all the ﬁelds of the asset as showed in
Figure 3. During this phase, the physician can set the ﬁeld
“obscured” either on “Yes” or on “No” (see Figure 3); in this
67
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Fig. 12. Transaction to create a health document.
Fig. 13. Transaction to read a health document.
example, the choice is “No”, whilst the document ID was set
to “TEST DOC”.
At this point, both the patient to whom the document refers
to and the other authorized participants in the network can read
the document launching the transaction in Figure 13, which
results in an outcome like that showed in Figure 14.
Actually, any other participant in the blockchain, can read
the document. This is because the ﬁeld “obscured” is set
on “No” for this document,as shown by Figure 15, and the
access control policies concerning participants in this case are
enforced at the application layer.
Now, if the patient sets to “Yes” the “obscured” ﬁeld through
the transaction shown in Figure 16 and then launches the read
transaction, he/she can read the document and verify that the
obscured ﬁeld has actually been modiﬁed (Figure 17).
The last step of this simulation consists in showing that with
any other ID different from that of the patient, the obscured
document cannot actually be read. Figure 18 shows the result
of a read attempt by a random ID, which turns out in the
error “No document satisfying your request”, as provided by
the readHealthDocument transaction.
Fig. 14. Result of read transaction submitted by the patient.
Fig. 15. Result of read transaction performed by a random Id.
Fig. 16. Transaction to obscure a document.
Fig. 17. Read transaction launched by the patient after obscuration.
Fig. 18. Error in read transaction.
All the above tests were performed using the Hyperledger
Fabric extension for VSCode that supports versions of the
Fabric framework from 1.4 onwards [30].
V. CONCLUSION AND FUTURE WORK
This paper has presented a blockchain architecture for the
decentralized management of clinical documents collected in
EHRs, compliant with the GDPR. The proposed architecture
is designed for facing the integrity and traceability issues
concerning the current national EHR framework for the inter-
operability of the regional systems in Italy. The architecture
lies on a network that represents the new core components
that, integrated with the federated EHR IT system, permits
to easily and effectively implement the health processes in
a veriﬁable and correct manner. The proposed network is
coupled with a suitable access control and security framework
to protect patient’s health data. This framework respects a
set of functional and non-functional requirements identiﬁed
on the basis of the Italian norms and the GDPR principles,
68
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

without prejudicing neither the usability of the system nor
its scalability and management. A proof-of-concept prototype
of the architecture has been developed to prove its feasibility
in two real scenarios. For this reason, a set of transactions
opportunely identiﬁed are mapped with the application ser-
vices. Even if the proposed work is customized for the Italian
context, the methodology adopted permits to simply decline it
to other contexts.
Future work is planned for implementing a testbed in
order to evaluate the effectiveness of the EHR management
system resulting by integrating it with the blockchain network
illustrated in this work.
REFERENCES
[1] M. Ciampi, A. Esposito, F. Marangio, G. Schmid, and M. Sicuranza,
“A blockchain architecture for the italian ehr system,” in The Fourth
International Conference on Informatics and Assistive Technologies
for Health-Care, Medical Support and Wellbeing HEALTHINFO 2019.
IARIA, November 2019, pp. 11–17.
[2] I. Iakovidis, “Towards personal health record: current situation, obstacles
and trends in implementation of electronic healthcare record in europe,”
International journal of medical informatics, vol. 52, no. 1-3, pp. 105–
115, 1998.
[3] “Italian
Ministry
of
Health,”
http://www.salute.gov.it/portale/lea/
dettaglioContenutiLea.jsp?lingua=italiano&id=5073&area=Lea&menu=
vuoto/, [retrieved on 2020.11.17].
[4] A. D. Black, J. Car, C. Pagliari, C. Anandan, K. Cresswell, T. Bokun,
B. McKinstry, R. Procter, A. Majeed, and A. Sheikh, “The impact of
ehealth on the quality and safety of health care: a systematic overview,”
PLoS med, vol. 8, no. 1, p. e1000387, 2011.
[5] F. Aminpour, F. Sadoughi, and M. Ahamdi, “Utilization of open source
electronic health record around the world: a systematic review,” Journal
of research in medical sciences: the ofﬁcial journal of Isfahan University
of Medical Sciences, vol. 19, no. 1, p. 57, 2014.
[6] M. Ciampi, M. Sicuranza, A. Esposito, R. Guarasci, and G. De Pietro,
“A technological framework for ehr interoperability: Experiences from
italy,” in International Conference on Information and Communication
Technologies for Ageing Well and e-Health. Springer, 2016, pp. 80–99.
[7] “Integrating the Healthcare Enterprise,” http://www.ihe.net/, [retrieved
on 2020.11.17].
[8] “HL7
Version
3
Clinical
Document
Architecture
(CDA)
Re-
lease 2,” https://www.hl7.org/implement/standards/product brief.cfm?
product id=7/, [retrieved on 2020.11.17].
[9] “Agency for Digital Italy of the Presidency of the Council of Ministers,”
https://www.fascicolosanitario.gov.it/, [retrieved on 2020.11.17].
[10] “Frost and Sullivan, Global Blockchain Technology Market in the
Healthcare Industry 2018-2022,” https://www.businesswire.com/news/
home/20191016005587/en/, [retrieved on 2020.11.17].
[11] “Patientory,”
https://patientory.com/technology/,
[retrieved
on
2020.11.17].
[12] “GemOS,” https://enterprise.gem.co/, [retrieved on 2020.11.17].
[13] “Medicalchain,” https://medicalchain.com/, [retrieved on 2020.11.17].
[14] “EncrypGen,” https://encrypgen.com/the-dna-economy/, [retrieved on
2020.11.17].
[15] “SimplyVitalHealth,”
https://github.com/SimplyVitalHealth/drs/,
[retrieved on 2020.11.17].
[16] “Hashed Health,” https://hashedhealth.com/newsletter-sept-2019/, [re-
trieved on 2020.11.17].
[17] “MedRec,”
https://medrec.media.mit.edu/technical/,
[retrieved
on
2020.11.17].
[18] A. Azaria, A. Ekblaw, T. Vieira, and A. Lippman, “Medrec: Using
blockchain for medical data access and permission management,” in
2016 2nd International Conference on Open and Big Data (OBD).
IEEE, 2016, pp. 25–30.
[19] C. McFarlane, M. Beer, J. Brown, and N. Prendergast, “Patientory: A
healthcare peer-to-peer emr storage network v1.” Entrust Inc.: Addison,
TX, USA, 2017.
[20] “CoinMarcketCap Patientory,” https://coinmarketcap.com/it/currencies/
patientory/, [retrieved on 2020.11.17].
[21] “CoinMarketCap
Medicalchain,”
https://coinmarketcap.com/it/
currencies/medical-chain/, [retrieved on 2020.11.17].
[22] “GDPR,” https://eur-lex.europa.eu/eli/reg/2016/679/oj/, [retrieved on
2020.11.17].
[23] “Italian
EHR
Interoperability:
Italy
Afﬁnity
Domain,”
https://www.agid.gov.it/sites/default/ﬁles/repository ﬁles/regole
tecniche/afﬁnitydomainitalia versione 2.1.pdf,
[retrieved
on
2020.11.17].
[24] “Italian
EHR
Interoperability:
Framework
and
Basic
Services
Dataset,”
https://www.agid.gov.it/sites/default/ﬁles/repository ﬁles/
regole tecniche/frameworkdataset versione 2.1.pdf,
[retrieved
on
2020.11.17].
[25] “SPID,” https://www.spid.gov.it/, [retrieved on 2020.11.17].
[26] “CNS,”
https://sistemats1.sanita.ﬁnanze.it/portale/
modalita-di-accesso-con-ts cns, [retrieved on 2020.11.17].
[27] M. Vukoli´c, “Rethinking permissioned blockchains,” in Proceedings of
the ACM Workshop on Blockchain, Cryptocurrencies and Contracts,
2017, pp. 3–7.
[28] “Hyperledger Composer,” https://hyperledger.github.io/composer/latest/,
[retrieved on 2020.11.17].
[29] “Hyperledger Fabric,” https://hyperledger-fabric.readthedocs.io/, [re-
trieved on 2020.11.17].
[30] “IBM
Blockchain
Platform,”
https://marketplace.visualstudio.com/
items?itemName=IBMBlockchain.ibm-blockchain-platform,
[retrieved
on 2020.11.17].
69
International Journal on Advances in Life Sciences, vol 12 no 3 & 4, year 2020, http://www.iariajournals.org/life_sciences/
2020, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

