Hironori Tanaka 
Dept. of Computer Science and Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: 22417569@stn.nitech.ac.jp 
Abstract— In this paper, an NB RCP LDPC (Non-Binary 
Rate-Compatible-Punctured Low Density Parity Check) code 
is designed over the extended Galois Field. The designed NB 
RCP LDPC code is applied to the type II HARQ (Hybrid 
Automatic Repeat reQuest) with Decode and Forward (DF) 
relay using MIMO-OFDM modulation. The designed code 
enables us to decrease the coding rate with incremental 
redundancy 
for 
each 
retransmission 
in 
HARQ. 
The 
retransmission is made by the DF relay after its successful 
decoding. We have verified through computer simulations that 
the proposed type II HARQ scheme with DF relay greatly 
improves 
the 
throughput 
and 
average 
retransmission 
characteristics compared with the scheme without DF relay. 
Keywords-NB RCP LDPC code; Hybrid-ARQ; Decode and 
Forward Relay; MIMO-OFDM; Symbol-LLR. 
I. INTRODUCTION 
An LDPC code which suits the flexible coding rate 
design and has the high error correcting capability through 
iterative decoding can be constructed on arbitrary extended 
Galois field. The Non-Binary (NB) LDPC code constructed 
on extended Galois field generally exhibits the better BER 
performance than the binary LDPC codes [1],[2]. There 
exist also Rate-Compatible-Punctured (RCP) LDPC codes 
with variable coding rate obtained by properly puncturing 
the mother LDPC code. The RCP LDPC codes enable us to 
use the same decoder as the mother code [3] and suit the 
ARQ (Automatic Repeat reQuest) error correcting schemes 
[4],[5] with the incremental redundancy. When comparing 
the HARQ using NB RCP LDPC codes with the existing 
RCPT (Rate Compatible Punctured Turbo) HARQ using 
binary Turbo codes [6], the HARQ with NB LDPC codes 
can cope with flexible coding rates, code word lengths and 
NB symbol LLR additions without using inter-leavers for 
burst errors on the channel. By combining the NB LDPC 
codes with the RCP codes, the NB RCP LDPC codes were 
designed and the designed NB RCP LDPC codes were 
applied to the type II HARQ [7],[8]. In this paper, the NB 
RCP LDPC coded type II HARQ with the MIMO-OFDM 
modulation is used for the Decode and Forward (DF) relay 
scheme [9],[10]. By using the DF relay, the source node can 
be replaced by the relay, once the relay correctly decodes 
the LDPC encoded packet from the source. This 
replacement from the source to the relay effectively reduces 
the number of retransmissions and improves the throughput 
Yasunori Iwanami 
Dept. of Computer Science and Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: iwanami@nitech.ac.jp 
 
performance very much. We have verified through 
computer simulations that the proposed DF relaying scheme 
with type II HARQ and RCP LDPC code greatly improves 
the throughput and average retransmission characteristics 
compared with the case without DF relay. 
The paper is organized as follows. In Section II, the 
RCP LDPC code is introduced. In Section III, NB LDPC 
coded Type II HARQ scheme is described. In Section IV, 
we propose decode and forward relaying scheme. In Section 
V, we present the symbol LLR generation in OFDM 
demodulation. In Section VI, the computer simulation 
results are shown. The paper concludes with Section VII. 
II. RCP LDPC CODE 
The encoding and decoding procedure of RCP LDPC 
code is as follows. We call the code before puncture and the 
code after puncture as the mother code and the efficient 
code, respectively. In RCP LDPC code, the encoder and 
decoder of mother code can also be applied to the efficient 
code. When the parity check matrix of mother code is given 
by 
(
)
M M
 N
H
 and the generator matrix by 
(
)
M N
 K
G
 
with 
(
)
K
N
M


, the coding rate of mother code becomes 
(1
/
)
/
RM
M
N
K
N



. The coding rate after the puncture 
of 
p  symbols from the mother code is given by 


RE
K
N
P


∕
. We denote the message vector as 
1
2
(
,
,
)
,
K
m m
m


m
, the code word of mother code as 
1
2
)
(
,
,
,
M
M
MN
C
C
C


CM
, the index of position to be 
punctured as 
1
2
(
,
,
)
,
p
p p
p


P
 and the code word of 
efficient code as 
1
2
(
,
,
,
)
E
E
E
EN
C
C
C
C 

. The encoding 
procedure is first to generate the mother code by 
M 
M
C
mG  and next to puncture the position using P  to 
obtain
E
C . The decoding procedure is to produce the 
symbol LLR from the receive signal and it is fed to the 
mother code decoder as the initial value for the sum-product 
algorithm. The symbol LLR for the position P  is initially 
set to 0, because there is no available symbol LLR 
corresponding to the position P . 
III. NB RCP LDPC CODED TYPE II HARQ SCHEME 
In Fig. 1, we show the block diagram of NB RCP LDPC 
coded Type II HARQ scheme using MIMO-OFDM 
modulation. At the transmitter, the data bits are firstly 
encoded by the CRC-16 error detecting code and secondly 
encoded by the NB LDPC code on GF(4) or GF(16). The 
encoded LDPC code word is divided into the OFDM frames 
for making a packet for each transmission using the 
predetermined puncture table introduced in [3]. In Fig. 2, 
we show how to divide the coded symbols of an LDPC 
On Throughput Characteristics of Type II Hybrid-ARQ with Decode and Forward 
Relay using Non-Binary Rate-Compatible Punctured LDPC Codes 
272
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

code to the OFDM frames. The encoded NB alphabets are 
mapped to QPSK signal points for GF(4) or 16QAM for 
GF(16). These signal points are then modulated by OFDM 
with guard interval insertion. The OFDM signal is then 
transmitted to the quasi-static frequency selective channel 
from each transmit antenna. At the receiver, for each 
antenna, the guard interval is first removed and then OFDM 
demodulation is made using FFT. By demodulating each 
subcarrier QPSK modulated or 16QAM modulated, the 
symbol LLR (Log Likelihood Ratio) is calculated. The 
symbol LLR will be defined in Section V. The symbol LLR 
values are then fed to the LDPC decoder and the iterative 
decoding using sum-product algorithm is made. The 
decoded information bits are error-detected by the CRC-16 
code. If error is not detected, the data bits are fed to the data 
sink and the ACK is returned to the source node 
(transmitter) to finish the transmission. But if errors are 
detected, the NACK is returned and the retransmission is 
requested. As the type II Hybrid ARQ (HARQ) scheme is 
employed, at the first transmission, only the data symbols 
without encoding are sent to the receiver. After the 2nd 
transmission, as shown in Fig. 2, the parity symbols are sent 
several times with the incremental redundancy depending 
on the error detection status at the receiver. When the 
channel quality is good, the uncoded data packet for the 
first transmission succeeds with high probability leading to 
the high throughput performance. On the other hand, when 
the channel quality is bad, the parity packets are 
retransmitted several times till the LDPC code rate reaches 
the lowest one half resulting in enough error correction 
capability. 
 
 
Fig. 1 Transmitter and receiver configuration of MIMO NB RCP LDPC 
coded type II HARQ scheme 
 
 
Fig. 2 OFDM frames obtained from the division of an LDPC code word 
 
At the transmitter side, only one time of encoding 
process of RCP LDPC code is enough and there is no need 
of re-encoding process for decreasing the coding rate 
thereafter. Accordingly the complexity of encoding process 
of RCP LDPC code does not increase compared with the 
fixed code rate LDPC code. At the receiver side, the same 
decoder can be used for each coding rate, so there is no 
increase of complexity when compared with the fixed 
coding rate. 
 
IV. DECODE AND FORWARD RELAYING SCHEME 
 
The Decode and Forward relay model is shown in Fig. 3 
and is composed of source, relay and destination. In this 
model, we assume the relay is located at the middle point 
on the straight line between the source and destination. 
When the receive power at the receiver attenuates in 
proportion to 1/ d   where d  is the distance between 
transmitter and receiver, the receive power from source to 
relay and the one from relay to destination become 2  
times larger than the one from source to destination. Next, 
we will illustrate the operation at each node in Fig. 3. At the 
source node, the encoding and modulation process using the 
NB RCP LDPC coded type II HARQ with MIMO OFDM is 
made, and uncoded and parity check packets are generated 
using the division of an LDPC code word as shown in Fig. 
2. At the 1st transmission, the source broadcasts the 
uncoded data packet to the destination and the relay 
simultaneously. The relay and the destination receive the 
packet and they make the error detection independently 
using CRC-16 code. Then the destination and relay send the 
ACK or NACK back to the source, and the error detection 
results are shared among the source, relay and destination. 
When the destination returns ACK, the data are received 
successfully 
at 
the 
destination 
through 
only 
one 
transmission and this situation is equivalent to the case 
without relay. On the other hand, when the destination 
returns NACK, retransmission must be made. Moreover, 
when the relay also returns NACK, the parity check packet 
with incremental redundancy is retransmitted from the 
source. At the destination and the relay, the received parity 
check packet is combined with the data packet for the 1st 
transmission, and the combined LDPC code word is 
decoded. Then the decoded information bits are CRC 
checked and ACK or NACK is returned to the source. If the 
destination returns NACK but the relay dose ACK, then the 
relay receives the correct information bits. Accordingly, the 
relay can encode the received information bits to the same 
RCP LDPC code word with the source, i.e., we can replace 
the source by the relay for the subsequent ARQ 
retransmission. The parity check packet with incremental 
redundancy is generated at the relay and is sent from the 
relay afterwards. Once the relay successfully receives the 
packet from the source, then the relay performs the function 
of source and the source stops any further retransmission. 
This strategy is quite useful because the relay is closer to 
the destination than the source, thus the transmission error 
does not occur so frequently compared with the source. 
1 LDPC Block length (Rate=1/2) 
Data Bit 
Parity Bit 
1OFDM 
Symbol 
Antenna1 
Antenna2 
1st 
transmission 
Division to OFDM symbol 
size
2nd 
transmission 
3rd 
transmission
CRC 
enc. 
NB 
LDPC 
enc. 
Puncture 
table 
 
Select 
Transmit 
QPSK 
or 
16QAM 
mod. 
IFFT 
IFFT 
+GI
+GI 
ACK/ 
NACK
NB 
LDPC 
dec. 
Sym. 
LLR 
cal. 
FFT 
FFT 
-GI 
-GI 
Inner Iteration 
CRC 
check 
Transmitter 
Receiver 
273
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

 
Fig. 3 DF (Decode and Forward) relaying model 
 
Another point to be noticed is that the consumption of 
total transmit power remains the same as the one without 
the relay, because the source is replaced by the relay and the 
source does not consume any transmission power after the 
replacement. 
 
V. SYMBOL LLR GENERATION IN OFDM 
DEMODULATION 
 
As an example of symbol LLR calculation in OFDM 
demodulation, we show the case where the NB LDPC code 
on GF(4) is used and the QPSK modulation is employed for 
each subcarrier of OFDM. When the transmit signal, 
receive signal, signal points of QPSK and the subcarrier 
channel fading value are denoted as x , r , 
0
1
2
3
,
,
,
s s s s  
and h  respectively, the symbol LLR for the alphabets 
a  0,1,2,3
 on GF(4) is defined as 

















 


 









0
0
0
0
0
0
,
log
log
,
0
,
log
log
,
log
log
a
a
e
e
a
a
a
e
e
a
a
e
e
P x
a r r
P s r r
P r r
LLR
P s r r
P r r
P x
r r
P s
p r r s
P s r r
P s r r
P s
P r r s
p r s
r
p r s
P r s
r
P r s

























































 





 




∕
∕
(1) 
where 
the 
priori 
probabilities 
are 
set 
to 


 


 
0
1
2
3
1/ 4
P s
P s
P s
P s




, i.e., equal probabilities. 
In (1), 


P x
 a r r

 denotes the probability that the 
transmit symbol x  equals a  when the receive signal 
point r  falls in the small area r r
  centered at r . 

p r sa 
 is the transition probability density function from 
as
 r
 and is expressed as 


2
2
2
1
exp
2
2
a
a
r
hs
p r s












                     (2) 
Accordingly, the symbol LLR is calculated as 




2
2
2
2
0
0
2
2
1
exp
2
2
log
log
1
exp
2
2
a
a
a
e
e
r
hs
p r s
LLR
p r s
r
hs





















































 
2
2
2
2
0
0
2
2
2
2
2
2
a
a
r
hs
r
hs
r
hs
r
hs
















 
 









 (3) 
 
VI. COMPUTER SIMULATION RESULTS 
 
The BER characteristics of RCP LDPC code on AWGN 
channel are examined when the rate 1/2 mother code on 
GF(4) or GF(16) is punctured to change the coding rate. 
The simulation condition is listed in Table I and the 
simulation results are shown in Figs. 4 and 5. From the 
simulation results, we know that the efficient codes on 
GF(4) or GF(16) with different coding rates are obtained 
from a mother code and the error correction capability 
corresponding to each coding rate is achieved. Next, the 
throughput performance and the average number of 
retransmission characteristic for 4
 4
 MIMO-OFDM NB 
RCP LDPC coded Type II Hybrid-ARQ with GF(4) and 
QPSK modulation are investigated. We compared the 
proposed relay model with the one without relay. The 
simulation condition is listed in Table II. The simulation 
results for throughput characteristic are shown in Fig. 6 and 
Fig. 7. The simulation results for average number of 
retransmission are shown Fig. 10 and Fig. 11. 
  
TABLE I Simulation condition of RCP LDPC code 
 
Channel 
AWGN 
Modulation
QPSK 
16QAM
Size of Galois field 
GF(4) 
GF(16) 
Mother 
code 
Size of parity 
check matrix 
(256,512) 
(128,256) 
Average weight 
(2.66,5.32) 
(2.41,4.82) 
Coding rate
4/8 
2/4
Efficient 
code 
Information bit 
length 
512 
Coding rate 
4/8,4/7,4/6,4/5,
4/4 
2/4,2/3,2/2 
Max SPA iteration 
20 
 
 
 
 
Fig. 4 BER characteristics of RCP-LDPC code on AWGN channel (QPSK) 
 
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
2
4
6
8
BER
Average Eb/N0 [dB]
Uncoded
theory
Uncoded
Rate=4/4
Efficient code
Rate=4/5
Efficient code
Rate=4/6
Efficient code
Rate=4/7
Mother code
Rate=4/8 
Source 
node 
Relay 
node 
Destination
node 
۶ௌ஽ 
۶ௌோ 
۶ோ஽ 
Source 
node 
Relay 
node 
Destination
node 
۶ௌ஽ 
۶ௌோ 
۶ோ஽ 
When error is detected at destination but not relay 
When error is detected at both destination and relay: 
Transmit 
 node 
Receive node
274
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

 
Fig. 5 BER characteristics of RCP-LDPC code on AWGN channel 
(16QAM) 
 
In the simulation, an LDPC code word is divided into 32 
OFDM symbols. As the coding rate of mother LDPC code 
is 1/2, the former 16 OFDM symbols are the information 
data symbols and the latter 16 OFDM symbols are the 
parity check symbols. For the 1st transmission, 16 OFDM 
symbols made from information data are transmitted from 4 
transmit antennas simultaneously using 4 OFDM symbol 
duration. For the 2nd transmission and thereafter, i.e., 
retransmission, 4 OFDM symbols made from the parity 
check symbols are transmitted from 4 transmit antennas 
simultaneously. In each retransmission, 1 parity check 
OFDM symbol is transmitted from each antenna using 1 
OFDM duration. The coding rate is decreased gradually 
from 4/5, 4/6, 4/7 to 4/8 for each retransmission. After all 
the parity check OFDM symbols are transmitted and the 
coding rate reaches 4/8=1/2, if the errors are still detected at 
the destination, the whole transmission of the same RCP 
LDPC code word in the same manner is repeated up to 3 
times. The symbol LLR combining is used at the 
destination for the repeated reception of the same RCP 
LDPC code word. For the comparative scheme, we 
considered the type I HARQ with the fixed coding rate  
 
TABLE II Simulation condition of NB GF(4) RCP LDPC coded type II 
Hybrid ARQ scheme with 4  4 MIMO-OFDM 
 
Channel 
Quasi-static equal power 
Rayleigh fading channel 
with 16 delay paths
Number of transmit and receive antennas 
4×4
Power attenuation constant of channel
α ൌ 3
Modulation 
QPSK-OFDM
Size of Galois field 
GF(4)
Mother 
code 
Size of parity check matrix 
(1024,2048)
Average weights 
(2.66,5.32)
Coding rate 
4/8
Efficient 
code 
Length of information bits 
2048
Coding rates 
4/4,4/5,4/6,4/7,4/8
Max SPA iteration 
20 
Number of OFDM subcarriers 
64 
GI length 
16 (=T/4)
Delay interval 
1 (=T/64)
Channel State Information (CSI) 
Perfect at receiver
Error detection code 
CRC-16 code
LDPC code and set the maximum number of repetition also 
to be 3. The packet combining at the destination is also used 
through the symbol LLR addition. Next, using the NB RCP 
LDPC code on GF(16) and with 16QAM modulation, we 
made the similar simulation to the above GF(4) with QPSK 
modulation. The simulation condition is given in Table III. 
The simulation results for throughputs are shown in Fig. 8 
and Fig. 9. The simulation results for average number of 
retransmission are shown in Fig. 12 and Fig. 13. In these 
simulations, an LDPC code word is divided into 4 
information data packets and 4 parity check packets. For 
each retransmission, the coding rate is decreased from 2/2, 
2/3 to 2/4. When the all OFDM symbols are transmitted and 
the coding rate reaches 2/4=1/2, and if the error is still 
detected, the same RCP LDPC code word is repeatedly 
transmitted up to 3 times. 
 
TABLE III Simulation condition of NB GF(16) RCP LDPC coded type II 
Hybrid ARQ scheme with 2  2 MIMO-OFDM 
 
Channel 
Quasi-static equal power 
Rayleigh fading channel 
with 16 delay paths
Number of transmit and receive antennas 
2×2
Power attenuation constant of channel 
α ൌ 3
Modulation
16QAM-OFDM
Size of Galois field
GF(16)
Mother 
code 
Size of parity check matrix 
(128,256)
Average weights 
(2.41,4.82)
Coding rate
2/4
Efficient 
code 
Length of information bits 
512
Coding rates
2/2,2/3,2/4
Max SPA iteration
20
Number of OFDM subcarriers 
64
GI length
16 (=T/4)
Delay interval
1 (=T/64)
Channel State Information (CSI) 
Perfect at receiver
Error detection code
CRC-16 code
 
We compare the type II HARQ with type I HARQ in 
Fig. 6, 7, 8, and 9. As the type I HARQ scheme has the 
fixed coding rate, the throughput for each coding rate 
saturates to the certain value less than the maximum in high 
average receive 
0
Eb /
N  region, while the throughput of 
type II HARQ approaches almost the maximum value of 8 
(bits/sec/Hz) by adaptively changing the coding rate. The 
reason why the final throughput for type II HAQR is 
slightly less than 8 (bits/sec/Hz) is due to the use of 
CRC-16 code to detect the errors in information data. In 
type II HARQ, however, the parity check packet is 
sequentially retransmitted in responding to the NACK, so 
the number of retransmission becomes large compared with 
the type I HARQ. Also in type II HARQ, the iterative 
decoding of LDPC code is done for each retransmission of 
parity check packet, thus the decoding time tends to 
increase. 
Next, we compare the cases with and without relay. 
When the average receive 
0
Eb /
N  is high, the throughputs 
with and without relay are almost equal, but when the 
average receive 
0
Eb /
N  is low, the throughput with relay is 
higher than without relay. 
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
2
4
6
8
BER
Average Eb/N0 [dB]
Uncoded
theory
Uncoded
Rate=2/2
Efficient code
Rate=2/3
Mother code
Rate=2/4
275
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

 
Fig. 6 Throughput characteristics of NB GF(4) LDPC coded type II HARQ 
scheme with incremental redundancy and type I HARQ with fixed 
coding rate (without relay, 4
 4
, QPSK) 
 
 
Fig. 7 Throughput characteristics of NB GF(4) LDPC coded type II HARQ 
scheme with incremental redundancy and type I HARQ with fixed 
coding rate (with relay, 4
 4
, QPSK) 
 
 
Fig. 8 Throughput characteristics of NB GF(16) LDPC coded type II 
HARQ scheme with incremental redundancy and type I HARQ 
with fixed coding rate (without relay, 2
 2
, 16QAM) 
 
 
Fig. 9 Throughput characteristics of NB GF(16) LDPC coded type II 
HARQ scheme with incremental redundancy and type I HARQ with 
fixed coding rate (with relay, 2
 2
, 16QAM) 
 
Fig. 10 Average number of retransmission of NB GF(4) RCP LDPC coded 
type II HARQ scheme with incremental redundancy and type I 
HARQ with fixed coding rate (without relay, 4
 4
, QPSK) 
 
 
Fig. 11 Average number of retransmission of NB GF(4) RCP LDPC coded 
type II HARQ scheme with incremental redundancy and type I 
HARQ with fixed coding rate (with relay, 4
 4
, QPSK) 
 
 
Fig. 12 Average number of retransmission of NB GF(16) RCP LDPC 
coded type II HARQ scheme with incremental redundancy and 
type I HARQ with fixed coding rate (without relay, 2
 2
, 
16QAM) 
 
 
Fig. 13 Average number of retransmission of NB GF(16) RCP LDPC 
coded type II HARQ scheme with incremental redundancy and 
type I HARQ with fixed coding rate (with relay, 2
 2
, 
16QAM) 
0
2
4
6
8
-10
-5
0
5
10
15
20
25
30
35
40
Throughput [bps/Hz]
Average Eb/N0 at S-D link [dB]/receive antenna]
TypeⅡ
Rate=4/8,4/7,
4/6,4/5,4/4
TypeⅠ
Rate=4/8
TypeⅠ
Rate=4/7
TypeⅠ
Rate=4/6
TypeⅠ
Rate=4/5
TypeⅠ
Rate=4/4
0
1
2
3
4
5
6
7
8
-10
-5
0
5
10
15
20
25
30
35
40
Throughput [bps/Hz]
Average Eb/N0 at S-D link [dB]/receive antenna
TypeⅡrelay 
Rate=4/8,4/7,
4/6,4/5,4/4
TypeⅠrelay
Rate=4/8
TypeⅠrelay
Rate=4/7
TypeⅠrelay
Rate=4/6
TypeⅠrelay
Rate=4/5
TypeⅠrelay
Rate=4/4
0
2
4
6
8
-10
-5
0
5
10
15
20
25
30
35
40
Throughput [bps/Hz]
Average Eb/N0 at S-D link [dB]/receive antenna]
TypeⅡ
Rate=2/4,2/3,
2/2
TypeⅠ
Rate=2/4
TypeⅠ
Rate=2/3
TypeⅠ
Rate=2/2
0
2
4
6
8
-10
-5
0
5
10
15
20
25
30
35
40
Throughput [bps/Hz]
Average Eb/N0 at S-D link [dB]/receive antenna]
TypeⅡrelay
Rate=2/4,2/3,
2/2
TypeⅠrelay
Rate=2/4
TypeⅠrelay
Rate=2/3
TypeⅠrelay
Rate=2/2
0
1
2
3
4
5
6
7
8
9
10
-10
-5
0
5
10
15
20
25
30
35
40
Average number of retransmission
Average Eb/No at S-D link [dB] /receive antenna]
TypeⅡ
Rate=4/8,4/7,4
/6,4/5,4/4
TypeⅠ
Rate=4/8
TypeⅠ
Rate=4/7
TypeⅠ
Rate=4/6
TypeⅠ
Rate=4/5
TypeⅠ
Rate=4/4
0
1
2
3
4
5
6
7
8
9
10
-10
-5
0
5
10
15
20
25
30
35
40
Average number of retransmission
Average Eb/No at S-D link[dB]/receive antenna 
TypeⅡrelay 
Rate=4/8,4/7,4/
6,4/5,4/4
TypeⅠrelay
Rate=4/8
TypeⅠrelay
Rate=4/7
TypeⅠrelay
Rate=4/6
TypeⅠrelay
Rate=4/5
TypeⅠrelay
Rate=4/4
0
1
2
3
4
5
6
7
8
9
-10
-5
0
5
10
15
20
25
30
35
40
Average number of retransmission
Average Eb/N0 at S-D link [dB]/receive antenna]
TypeⅡ
Rate=2/4,2/3,
2/2
TypeⅠ
Rate=2/4
TypeⅠ
Rate=2/3
TypeⅠ
Rate=2/2
0
1
2
3
4
5
6
7
8
9
-10
-5
0
5
10
15
20
25
30
35
40
Average number of retransmission
Average Eb/N0 at S-D link [dB]/receive antenna]
TypeⅡrelay
Rate=2/4,2/3,
2/2
TypeⅠrelay
Rate=2/4
TypeⅠrelay
Rate=2/3
TypeⅠrelay
Rate=2/2
276
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

This is because for the high average receive 
0
Eb /
N  region, 
the destination can receive the packet correctly without 
retransmission. Accordingly, the relay is not used for this 
high 
0
Eb /
N  region, so there is no difference between with 
and without relay. On the other hand, for the region where 
the average receive 
0
Eb /
N  is low, the transmission from 
source to destination often fails, but the transmission from 
relay to destination succeeds with high probability, thus the 
retransmission is switched from the source to the relay for 
this low 
0
Eb /
N  region. For the type I HARQ schemes in 
Fig. 7, Fig. 11, Fig. 9 and Fig. 13, we know that the 
throughput with relay is largely improved compared with 
the one without relay for the region where the average 
number of retransmission is 1. For this region the 
throughput of type I HARQ is almost one half of the 
throughput for high 
0
Eb /
N  region. This means that for 
this region the transmission is switched from the source to 
relay and the retransmission from the relay to destination is 
almost successful. This observation proves that the use of 
relay is quite effective in HARQ. 
As for the proposed type II HARQ, the throughput is 
larger than all the type I HARQ schemes and is optimum 
for all average receive 
0
Eb /
N  values. However, the 
average number of retransmission becomes larger than the 
type I ARQ schemes because of the incremental redundancy 
retransmissions. 
VII. CONCLUSIONS AND FUTURE WORKS 
In this paper, we applied the NB RCP LDPC code to the 
type II HARQ scheme with Decode and Forward relay. We 
simulated the throughput and average retransmission 
characteristics and showed the effectiveness of NB RCP 
LDPC coded type II HARQ with relay. As for the 
modulation scheme, we considered MIMO-OFDM with 
QPSK and 16QAM. Quasi-static frequency selective 
Rayleigh fading channel is considered between each 
transmit and receive antenna. The relay is located in the 
middle between source and destination. In the proposed 
type II HARQ scheme, the first transmission is made 
without error correcting code, i.e., the information packet 
with CRC check is broadcasted to the relay and the 
destination. If the error is detected at destination, the parity 
check packet is retransmitted from the source. At the relay 
and the destination, the information packet and the parity 
check packet are combined and the LDPC decoding is done. 
If the error is not detected at the relay, but is detected at the 
destination, then the relay retransmits the parity check 
packet in place of the destination. This means that the 
source is replaced by the relay. If the error is still detected at  
 
 
 
 
 
 
 
 
the destination, the parity check packets are retransmitted 
from the relay several times with the incremental 
redundancy till the coding rate reaches 1/2. We clarified that 
by using the proposed HARQ relaying scheme, the higher 
throughput 
and 
the 
fewer 
average 
number 
of 
retransmissions are achieved for the low average receive 
S/N region comparing to without relay. 
In the future study, we will investigate the scheme in 
which the transmitter knows the CSI, thus the redundancy 
of the parity check packet can be controlled by the 
transmitter, leading to fewer retransmissions. 
 
ACKNOWLEDGEMENT 
This study is partially supported by the A-STEP by 
Japan Science and Technology Agency, and the Sharp 
Corporation. 
REFERENCES 
[1] D. Declercq and M. Fossorier, “Decoding algorithm for nonbinary 
LDPC codes over GF(q), ” IEEE transactions on Communications, 
Vol.55, pp. 633-643, April 2007. 
[2] D. Kimura, F. Guilloud, and R. Pyndiah, “Application of non-binary 
LDPC 
codes 
for 
small 
packet 
transmission 
in 
vehicle 
communications,” The 5th International Conference on ITS 
Telecommunications, pp.109-112, Brest France, June 2005. 
[3] J. Ha, J. Kim, D. Klinc, and S. W. McLaughlin, “Rate-compatible 
punctured low-density parity-check codes with short block lengths, ” 
IEEE transactions on Information Theory, vol.52, No.2, pp.728-738, 
Feb. 2006. 
[4] Y. Tsuruta, Y. Iwanami, and E. Okamoto, “An evaluation of 
throughput performance of MIMO-OFDM-MLD Hybrid ARQ with 
bit LLR combining,” Proc. IEICE Gen. Conf., B-5-19, p.452, March 
2009. 
[5] M. Shimotsu, Y. Iwanami, and E. Okamoto, “An LDPC coded 
adaptive hybrid ARQ scheme with packet combining on MIMO 
eigen-mode channels,” IEICE Technical Report, RCS2005-37, 
pp.59-64, June 2005. 
[6] D. Gang, R. Kimura, and F. Adachi, “Performance evaluation of 
RCPT Hybrid ARQ schemes for DS-CDMA mobile radio over 
frequency selective Rayleigh fading channel,” IEICE Technical 
Report, RCS2001-280, pp.241-248, March 2002. 
[7] T. Kozawa, Y. Iwanami, E. Okamoto, R. Yamada, and N. Okamoto, 
“An evaluation on throughputs for Hybrid-ARQ using Non-Binary 
Rate-Compatible 
LDPC 
codes,” 
The 
32nd 
Symposium 
on 
Information Theory and its Applications (SITA2009), F21-3, 
pp.771-775, Dec. 2009. 
[8] T. Kozawa, Y. Iwanami, E. Okamoto, R. Yamada, and N. Okamoto, 
“An evaluation on throughput performance for Type II Hybrid-ARQ 
using non-binary Rate-Compatible-Punctured LDPC codes,” IEICE 
transactions on fundamentals, Vol.E93, No.11, pp.2089-2091, 
November 2010. 
[9] J. Laneman, D. Tse, and G. Wornell, “Cooperative diversity in 
wireless networks: efficient protocols and outage behaviour,” IEEE 
transactions on Information Theory, Vol. 50, No.12, pp.3062-3080, 
Dec. 2004. 
[10] A. B. A. Aziz and Y. Iwanami, “A simple symbol estimation for soft 
information relaying in cooperative relay channels,”Int. Journal of 
Commun. Networks and Systems (IJCNS), Scientific Research 
Publishing, Vol. 4, No. 9, pp.568-577, Sept. 2011. 
 
277
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

