Nonlinear Error Modeling of Reduced GPS/INS Vehicular Tracking Systems Using
Fast Orthogonal Search
Mohamed Maher Atia, Aboelmagd Noureldin
Department of Electrical & Computer Engineering
Royal Military College of Canada
Kingston, ON, Canada
Mohamed.maher.atia@gmail.com;
Aboelmagd.Noureldin@rmc.ca
Michael Korenberg
Department of Electrical & Computer Engineering
Queen’s University
Kingston, ON, Canada
Korenber@queensu.ca
Abstract— Land Vehicle Tracking systems depend mainly on
Global Navigation Satellite Systems (GNSS), such as Global
Positioning System (GPS). However, GNSS suffer from signal
blockage and degradation in urban areas. At the same time,
most land vehicles, nowadays, come with low-cost low-power
Inertial Measurement Units (IMU). Although these IMU can
be used an accurate short-term tracking system using Inertial
Navigation Systems (INS) technology, they are currently
mostly used only for safety applications. This paper proposes
an enhanced land-vehicles tracking system by integrating a
reduced IMU system with GPS to enhance the tracking
accuracy of land vehicles in downtown and urban areas.
Commonly, GPS/INS integration is based on Kalman Filter
(KF), where a linearized dynamic models for INS errors is
utilized. If Low-Cost MEMS-based inertial sensors with
complex stochastic error nonlinearity are used, performance
degrades significantly during short periods of GPS-outages.
This paper presents a nonlinear INS-errors modelling using a
fast nonlinear identification technique called fast orthogonal
search (FOS). During reliable GPS coverage, the corrected
vehicle state and sensors measurements are input to FOS and
the FOS models outputs are trained to predict the INS
deviations from GPS. During GPS-outages in urban areas, the
trained FOS models along with the most recent vehicle state
are used to predict INS deviations from GPS. The predicted
INS deviations are then feedback to the system Kalman Filter,
as updates to estimate all INS errors. The experimental setup
of this work used a very low-cost IMU from Crossbow Inc.
(USA based), the vehicle odometer measurements along with a
GPS receiver from Novatel, Inc. (Canada based). Experiments
were performed in Kingston, Ontario, Canada. Initial results
show
promising
improvement
of
tracking
accuracy
in
challenging GNSS-denied areas.
Keywords-Land Vehicles Tracking; Reduced IMU; GPS;
INS/GPS integration.
I.
INTRODUCTION
Inertial Navigation Systems (INS) utilize inertial sensors
to provide navigation information continuously with time
[1][12][24]. In a Strapdown 3D INS with full Inertial
Measurements Unit (IMU) [24][25], three acceleration
sensors (Accelerometers) and three angular rate sensors
(Gyroscopes) are utilized. The accelerometers measure the
acceleration of the moving body in three orthogonal
directions. Gyroscope measures the rotation rate around
these three basic orthogonal axes. The essential functions in
INS are defined as follows: 1) Determination of the angular
motion of a vehicle using gyroscopic sensors, from which
its attitude relative to a reference frame may be derived. 2)
Measure the acceleration using accelerometers. 3) Resolve
the acceleration measurements into the reference frame
using the knowledge of attitude. 4) Account for the gravity
component. 5) Integrate the resolved accelerations to
estimate the velocity and position of the vehicle. Although
INS systems have good short term accuracy, there are two
main problems in using such a scheme. The first problem is
the sensor imperfections and drifts [2][8]. The second
problem is that the measurements of such sensors must be
mathematically integrated to provide velocity, position, and
attitude information. Integration causes errors to accumulate
[2][8] resulting in huge drifts over time that growth without
bounds.
On the other side, GPS systems provide consistent long
term accuracy giving position and velocity updates using
GPS satellites signals processing [1][12]. A major problem
of GPS is signal blockage and multi-path in urban canyons,
under buildings, and tunnels. In these environments, signal
may be difficult to acquire or number of satellites available
may be not sufficient to provide position information [25].
Based on the complementary error characteristics of INS
and GPS, an integrated solution using both systems is often
used. Although there are many approaches to fuse data from
both systems, KF is most widely used [1][12][19]. KF
utilizes an error dynamic model of the INS system errors to
implement two main steps: Prediction step and Update step.
Prediction step is done as long as no GPS update is
available. In this step, the system uses the error dynamic
model to estimate the INS errors. In the update step, GPS
velocity and position measurements are used to get optimal
estimate of INS errors. Thus, by subtracting INS errors from
the INS output, accurate navigation information is obtained.
This integration scheme is called loosely coupled which is
utilized here in this work. This scheme is shown in Fig. 1.
The challenge with INS/GPS systems is that during GPS
16
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-348-3
VEHICULAR 2014 : The Third International Conference on Advances in Vehicular Systems, Technologies and Applications

outages, the system depends only on the INS error dynamic
model which is, in most of the cases, an approximate
linearized model. This leads to poor errors estimates during
GPS outages. Thus, the performance degrades significantly
during GPS outages. This paper presents an enhanced
GPS/Reduced INS integrated navigation system that is
based on nonlinear systems identification technique called
Fast Orthogonal Search (FOS). The novelty aspects of this
work lies in the utilization of fast nonlinear modeling of INS
errors using FOS. Compared to existing linear estimation,
such as KF [1], and existing nonlinear filtering techniques
such as Particle Filter [28], the utilization of FOS is
significantly faster and more reliable.
Figure 1. INS/GPS Integration in Loosely Coupled scheme
The remaining of the paper is organized as follows:
Section II describes the problem. Section III describes the
methodology including the reduced IMU/GPS navigation
system, the FOS algorithm, and the proposed bridging
technique. Section IV describes experimental work and
results.
II.
PROBLEM DEFINITION AND RESEARCH
OBJECTIVES
GPS/INS integration is based on KF, where a linearized
dynamic models for INS errors is utilized. If Low-Cost
MEMS-based inertial sensors with complex stochastic error
nonlinearity are used, performance degrades significantly
during GPS-outages. Although several solutions to bridge
GPS outages were introduced [4][5][6][8][9]. Majority of
these solutions are based on utilizing Artificial Intelligence
(AI) techniques to train INS errors estimation model that
can be used during GPS outages instead of KF update step.
One problem of these bridging schemes is that the resulting
models may be over-learned the data records that they were
trained on. This leads to another problem which is the short
availability period of the models. Thus, these models may
be useful in short GPS outages, but degrade significantly if
outages periods are several minutes [3-6][9]. In addition, the
scheme in which these bridging techniques is used is to
totally depend on such AI-trained model separately, without
interaction with KF. This scheme prevents such bridging
techniques from the optimal estimation that KF provides.
Moreover, these methods use models with sophisticated
parameters that need to be estimated during good GPS
availability, which add complexity and computational load
to the navigation system.
The primary objectives of this research is as follows:

To propose a KF algorithm with new GPS outage
bridging scheme to mitigate large drifts during GPS
outages.

The bridging technique should not add much
complexity to the integrated INS/GPS solution to be
suitable for real-time realization.

To provide this INS/GPS vehicular navigation
system at low cost using a reduced IMU consists of
single vertical gyro and two level accelerometer
aided by vehicle speed measurements.
III.
METHODOLOGY
A.
GPS/Reduced IMU System
The
proposed
GPS
outages
bridging
technique
is
realized on low-cost 3D land-vehicles tracking system using
Reduced IMU integrated with GPS, based on Kalman
Filtering. A low-cost 3D Reduced IMU platform consists of
one
MEMS
grade
vertically
aligned
gyroscope,
two
horizontal accelerometers, and vehicle odometer. This
platform is shown in Fig. 2.
Figure 2. 3D Reduced IMU platform
The state of the vehicle is determined by the vector:
}
,
,
,
,
,
,
,
,
{
k
k
k
k
k
k
k
k
k
h Ve Vn Vu
p
A r


, where
k
 is the
latitude of the vehicle,
k
 is its longitude, and
kh
is its
altitude,
k
k
k
Ve Vn Vu
,
,
are the East, North, and
up
velocity, respectively,
kp is the pitch angle (inclination),
kr is the roll angle, and
k
A is the azimuth angle (heading
from north). The INS error state vector
kx
 [
 kA
,
,
kr

pk
,
k
,k
, kh
,Vek
,Vnk
,Vuk
,
aod

,
 xf
,
 yf
,
 wz
] where
z
y
x
od
w
f
f
a




,
,
,
are errors
of
the
odometer-derived
acceleration,
transversal
17
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-348-3
VEHICULAR 2014 : The Third International Conference on Advances in Vehicular Systems, Technologies and Applications

accelerometer, forward accelerometer, and the gyroscope,
respectively.
The nonlinear vehicle state dynamic model is generally
given by
)
,
,
(
1
1
1




k
k
k
k
w
u
f x
x
(1)
where
uk
are the sensors reading, and
wk
is the noise
contaminating sensors measurements (process noise). The
detailed mathematical equations of this dynamic model can
be found in [28]. The measurement model involves GPS
velocity, position, and azimuth updates and it is given
generally as
)
,
(
k
k
k
v
z  h x
(2)
where
kz
are sub-set of Reduced INS system error state
vector whose elements can be directly observed from the
difference
between
Reduced
INS
output
and
GPS
measurements which are velocity, position, and azimuth.
The
kv is the GPS measurement noise.
In
KF
reduced
INS/GPS
integrated
system,
both
Reduced INS errors and GPS measurement dynamic models
in (1) (2) are linearized using Taylor series expansion [1] to
apply Kalman Filtering. After linearization, systems models
are given by
1
1
1





 
k
k
k
k
w
Gu
x
x
3)
k
k
k
v
Hx
z


(4)
When GPS observations are available, deviations of
Reduced INS output (position, velocity, and azimuth) from
GPS measurements (
GPS
kz
) is used as observations to KF
which use the difference between the actual system output
(
kz ) and the observation (
GPS
kz
) to derive the system to
correct its state which is Reduced INS error state vector.
Having the observations (
GPS
k
k
k
z
z
z



) , Reduced
INS error state
kx
is now partially known from
 kz
. Hence,
KF performs the update step to estimate the complete
Reduced INS error state vector
kx
as follows:
k
k
k
K y
x
x



(5)
where K is the Kalman gain. Hence, Reduced INS
navigation output is corrected by subtracting errors state
from it. For more details about KF equations and Kalman
gain derivations, we refer the reader to [1][12][19].
B.
Fast Orthogonal Search (FOS)
Orthogonal Search [26][27] is a general purpose nonlinear
systems identification tool that can model any general
system as seen in Fig. 3, and as explained in the following
figure, using the following general model:
[ ]
[ ]
]
[
1
0
e n
P n
a
n
Y
j
C
m
m
jm
j

 


(6)
where
m[ ]
P n
is a set of arbitrary candidates ,
ajm
are
coefficients and
[ ]
je n
is the residual errors. The purpose of
FOS is to select the best set of candidates
m[ ]
P n and the
coefficients
ajm
that minimizes
[ ]
je n
.
The candidates
m[ ]
P n can be any arbitrary function of system inputs and
outputs. For example, in an autoregressive model, the
candidates
m[ ]
P n would be the system input delayed with
specific number of samples ( [
],
1,2,....,L
x n
 l l

). In
Orthogonal Search techniques, a Gram–Schmidt procedure
[26][27] is used to replace the functions
Pm[n]
by a set of
orthogonal basis functions
Wm[ ]
n
where the model for a
specific j is represented by the following corresponding
model:
[ ]
[ ]
]
[
1
0
e n
g W n
n
Y
C
m
m m

 


(7)
In orthogonal basis function space, the coefficients
gm
that
minimize the mean square error over the observations is
given by
]
[
[ ]
]
[
2 n
W
n
Y n W
g
m
m
m 
(8)
where the over-bar in denotes the time average. The mean
square error is given by:














1
0
2
2
1
0
2
[ ]
[ ]
]
[
C
m
m
C
m
m m
Q
Y n
g W n
Y n
e
(9)
Where
(10)


]
[
[ ]
]
[
2
2
n
W
n
Y n W
Q
m
m
m 
(10)
The reduction in mean square error resulting from adding a
term
[ ]
m
m
a P n
is
Qm
. The fast orthogonal search
procedure makes use of the fact that it is not necessary to
create the orthogonal functions
Wm[ ]
n
explicitly. Only
their correlations with
m[ ]
P n , the data
[ ]
Y n , and with
themselves are required. By eliminating the generation of
the
orthogonal
functions
Wm[ ]
n
explicitly,
the
FOS
performance
is
much
faster
than
existing
traditional
modeling techniques. This enables the FOS to work well in
real-time applications that require superior performance,
18
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-348-3
VEHICULAR 2014 : The Third International Conference on Advances in Vehicular Systems, Technologies and Applications

such as video streaming, for high speed networks, such as
ATM and Internet.
Figure 3. FOS Nonlinear Systems Identification Technique
C.
Bridging GPS outages using FOS
During GPS reliable availability, we have valuable
information that should not be ignored. We have the
corrected vehicle state which is the most accurate state
estimation according to all available knowledge till the
moment. In addition, we have the current sensors readings
and
the
Reduced
INS
output
deviations
from
GPS
measurements. This valuable information represents the
error characteristics of INS or Reduced INS solution by
giving us data points that map the current vehicle state with
current sensors readings (as input) and the INS or Reduced
INS errors in position, velocity, and attitude (as output). If
enough number of data points is collected in a data set in the
format shown in Table 1, a FOS model can learn this data
set mapping [18] and provide predictions of data points that
are not seen before in the data set we already collected.
TABLE 1. INPUT/OUTPUT DATA FOR FOS MODELING
INPUT
OUTPUT
Corrected Vehicle
State (velocity and
Attitude)
Sensors Readings
Reduced INS output
deviations from GPS
velocity and attitude
…….
…….
…….
During GPS outages, FOS equations (3) and (4) are
used to predict the Reduced INS output deviations (part of
error state vector x), which then are fed to KF as a virtual
GPS updates to estimate all Reduced INS output errors. The
mechanism is shown in Fig. 4 and Fig. 5.
Figure 4. FOS-Aided Reduced INS/GPS Mechanism in training
Figure 5. FOS-Aided Reduced INS/GPS Mechanism in service
IV.
EXPERIMENTAL WORK AND RESULTS
The developed INS/GPS loosely coupled KF algorithm
was tested on physical road data records collected over two
different
trajectories.
The
set
of
equipment
used
in
experiments are as follows: Honeywell HG1700 AG11
tactical grade Inertial Measurement Unit (IMU) , Novatel
GPS receiver, CarChip E/X (8225) data logger [17] of a
General Motors Passenger Van, and Laptop computer to
control the equipments and log recorded data. Novatel CDU
interface software was used to record GPS and IMU data
which provide USB ports interface. G2 Pro-Pack Span unit
developed by Novatel provides a tightly coupled INS/GPS
navigation solution, which was used as a reference to
evaluate proposed technique. Fig. 6 shows the testing
trajectory as it appears in GPS Visualizer tool.
Figure 6. Testing Trajectory
The Root Mean Square error (RMSE) [8] of the horizontal
position of the vehicle during GPS outage was used as a
performance measure. RMSE during 20 minutes of GPS-
outage is shown in Fig. 7, which is compared with and
without the FOS-bridging technique. The FOS was trained
for only 6 minutes of good GPS availability period before
the GPS-outage starts.
19
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-348-3
VEHICULAR 2014 : The Third International Conference on Advances in Vehicular Systems, Technologies and Applications

Figure 7. RMSE during 20 minutes of GPS-outage
Figure 8. Relationship between RMSE percentage improvements vs GPS-
outage period
Fig. 8 shows the relationship between the GPS-outage period
and the improvements in RMSE obtained by applying the
proposed FOS-based bridging technique. Obviously the FOS
performs better with longer GPS-outages.
V. CONCLUSION AND FUTURE WORK
This
work
presented
an
enhanced
multi-sensors
INS/GPS tracking systems for land vehicles using Fast
Orthogonal Search (FOS) as a nonlinear identification
technique. the proposed bridging scheme of Kalman Filter
INS/GPS tracking systems successfully prevents the large
drifts that occur during long GPS outages periods.
The
bridging
scheme
utilized
FOS-based
measurements
prediction to enable Kalman Filter to perform update step on
virtual aiding measurements. Experimental results show
great RMSE improvement in longer GPS-outages. The
proposed bridging scheme can be used with any AI-based
modeling
method
or
non-linear
systems
identification
technique.
Future
work
includes
applying
the
same
mechanism on full 3D IMU/GPS configuration [2] instead
of the reduced IMU configuration. In this case, it is
expected that more FOS candidates may be required [26].
REFERENCES
[1]
A. Farrell, Aided Navigation – GPS with High Rate Sensors,
McGraw Hill, 2008.
[2]
Y. X. Niu and N. El-Sheimy, “Real-time MEMS based
INS/GPS integrated navigation system for land vehicle
navigation
application,”
Proc.
Navigation,
National
Technical Meeting (ITM), Monterey, CA, United States,
January 2006, pp. 501-507.
[3]
E.
D.
Kaplan,
Understanding
GPS
Principles
and
Applications, Artech House, Boston, 1996.
[4]
L. Semeniuk and A. Noureldin, “Bridging GPS outages
using neural network estimates of INS position and velocity
errors,” Measurement Science and Technology, vol. 17, no.
9, September 2006, pp. 2782–2798.
[5]
A. Cole, J. Wang, C. Rizos, and A.G. Dempster, “Bridging
GPS outages in the agricultural environment using virtualite
measurements,” Symp. Position, Location and Navigation
(PLANS), IEEE/ION, May 2008, pp. 497–504.
[6]
P. Chen-peng and L.Zao-zhen, “Bridging GPS outages of
tightly coupled GPS/SINS based on the Adaptive Track
Fusion using RBF neural network,” IEEE International
Symp. Industrial Electronics (ISIE), July 2009, pp. 971-976.
[7]
M. Shaik, O. Das, L. Zhao, and Z. Liao, ”Inter-vehicle range
smoothing for NLOS condition in the persistence of GPS
outages,”
Proc.
4th
IEEE
Conference
on
Industrial
Electronics and Applications (ICIEA), May 2009, pp. 3904–
3909.
[8]
W.
Abd-Elhamid,
A.
Noureldin,
and
N.
El-Sheimy,
“Adaptive Fuzzy Modeling of Low Cost Inertial Based
Positioning Errors,” IEEE Transactions on Fuzzy Systems,
vol. 15, no. 3, June 2007, pp. 519–529.
[9]
K. Kim and C. G. Park, “INS/GPS tightly coupled approach
using an INS error predictor,” Proc. 18th International
Technical Meeting of the Satellite Division of The Institute
of Navigation, Long Beach, CA, United States, September
2005, pp. pp. 488-493.
[10] U.
Iqbal,
T.
Karamat,
A.
Okou,
and
A.
Noureldin,
“Experimental Results on an Integrated GPS and Multi
Sensor System for Land Vehicle Positioning,” Hindawi
Publishing Corporation, International Journal of Navigation
and Observation, vol. 2009, Article ID 765010.
[11] B. M. Scherzinger and S. Woolven, “POS/MV-handling GPS
outages with tightly coupled inertial/GPS integration,” Proc.
OCEANS, MTS/IEEE Prospects for the 21st Century, vol. 1,
September 1996, pp. 422–428
[12] S. Mohinder, S. Grewal, R. Lawrence, and A. P.Andrews,
“Global Positioning Systems, Inertial Navigation Systems,
and Integration,” Wiley & Sons Inc. 2nd ed., 2007.
[13] L. Yong, P. Mumford , and C. Rizos, ”Performance of a low-
cost field re-configurable real-time GPS/INS integrated
system in urban navigation,” Symp. Position, Location and
Navigation (PLANS), IEEE/ION, May 2008, pp. 878–885.
[14] Z. Berman and J.D. Powell, ”The role of dead reckoning and
inertial sensors in future general aviation navigation,” Symp.
Position Location and Navigation (PLANS), April 1998, pp.
510–517.
[15] V. Malyavej, P. Torteeka, S. Wongkharn, and T. Wiangtong,
“Pose estimation of unmanned ground vehicle based on
dead-reckoning/GPS sensor fusion by unscented Kalman
20
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-348-3
VEHICULAR 2014 : The Third International Conference on Advances in Vehicular Systems, Technologies and Applications

filter,”
Proc.
International
Conference
on
Electrical
Engineering/Electronics,
Computer,
Telecommunications
and Information Technology (ECTI-CON), vol. 1, May
2009, pp. 6-9.
[16] L. M. Ha, ”MEMS INS/GPS integration using Kalman
Filters,”
Proc.
International
Conference
on
Advanced
Technologies for Communications, October 2008, pp. 449-
449.
[17] CarChip E/X OBDII-Based Vehicle Data Logger Software,
http://www.davisnet.com/product_documents/drive/spec_she
ets/8211-21-25_carchip_specsB.pdf, [retrieved: May, 2014].
[18] A. Noureldin, T. B. Karamat, M. D. Elberts, and E. Shafie,
“Performance Enhancement of MEMS-Based INS/GPS:
Integration for Low Cost Navigation Applications,” IEEE
Transactions on Vehicular Technology, vol. 58, no. 3, May
2008, pp. 1077-1096.
[19] R. V. C. Wong, K. P. Schwarz, and M. E. Cannon, “High-
accuracy kinematic positioning by GPS–INS,” J. Inst.
Navigat., vol. 35, no. 2, Summer 1988, pp. 275–287.
[20] K. W. Chiang, “INS/GPS integration using neural networks
for land vehicular navigation applications,” PhD dissertation,
Dept. Geomat., Univ. Calgary, Calgary, AB, Canada, 2004.
[21] M. D. Eberts “Performance Enhancement of MEMS based
INS/GPS integration for low cost navigation applications,”
MSc. thesis, Dept. Elect. Computer. Eng., Roy. Mil. College,
Kingston, ON, Canada, 2007.
[22] P. Zarchan, “Fundamentals of Kalman Filtering: A Practical
Approach,” 2nd ed., Reston, VA: AIAA, 2005.
[23] A. Hiliuta, R. Landry, and F. Gagnon, “Fuzzy corrections in
a GPS/INS hybrid navigation system,” IEEE Transactions on
Aerospace and Electronic Systems, vol. 40, no. 2, April
2004, pp. 591–600.
[24] D. H. Titterton, and J.L. Weston, “Strapdown inertial
navigation technology,” 2nd ed., The Institution of Electrical
Engineers, 2004.
[25] A. Noureldin, “Mobile Multi-Sensor System Integration,”
Course Notes, Royal Military College, EE 513, fall 2009.
[26] M. J. Korenberg and L. D. Paarmann, “Applications of fast
orthogonal search: Time-series analysis and resolution of
signals in noise,” Analysis of Biomedical Engineering, vol.
17, no. 3, 1989, pp. 219–231.
[27] M.
J.
Korenberg
and
L.
D.
Paarmann,
“Orthogonal
approaches to time-series analysis and system identification,”
IEEE Signal Processing Magazine, vol. 8, no. 3, 1991, pp.
29–43.
[28] J. Georgy, A. Noureldin, M. Korenberg, and M. Bayoumi,
“Low Cost 3D Navigation Solution for Reduced INS/GPS
Integration
Using
Mixture
Particle
Filter,”
IEEE
Transactions on Vehicular Technology, vol. 59, no. 2,
February 2010, pp. 599-615.
21
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-348-3
VEHICULAR 2014 : The Third International Conference on Advances in Vehicular Systems, Technologies and Applications

