Urban Energy Flow Microsimulation in a Heating Dominated Continental Climate
Diane Perez, Cl´ementine Vautey, J´erˆome K¨ampf
Solar Energy and Building Physics Laboratory
´Ecole Polytechnique F´ed´erale de Lausanne (EPFL)
1015 Lausanne, Switzerland
{diane.perez; clementine.vautey; jerome.kaempf}@epﬂ.ch
Abstract—A new energy management platform has been
developed and tested on a 600 building urban zone of the
Swiss city of la Chaux-de-Fonds. This simulation framework
for energy-efﬁcient systems simulates the buildings’ energy
demand, infers the production of the energy systems connected
and simulate the complete supply and demand side energy ﬂow
picture. The platform is designed to use measured consumption
data if available, and intended to produce correct estimates of
the average energy demands of housing and administrative
buildings if not available. This article discusses the ﬁrst
results obtained for the buildings’ heating demands and their
comparison with measured values. Two examples of energy
efﬁciency scenarios are also presented. They show that the
energy savings associated with building insulation can reach
more than 12% of the total energy consumption in buildings
in the zone studied.
Keywords- energy ﬂow simulation; simulation and measure-
ment comparison; urban simulation; heating demand simulation;
energy demand and supply.
I. INTRODUCTION
Despite the raising awareness of the problems linked to
the widely unsustainable modern energy use, much improve-
ment is still needed to reduce the resource consumption.
Buildings in urban zones can be accounted for a large part
of the energy use (20% to 40% of the total ﬁnal energy
consumption in developed countries according to [1]), and
the urban population is increasing. It is thus a domain of
interest for research to propose innovative energy efﬁciency
measures and energy management tools.
Amongst the large amount of research domains concerned
by urban energy simulation [2] [3], there is now a growing
interest in the evaluation of the energy need of larger
and/or pre-existing urban areas [4] [5], to evaluate the
energy performance associated with alternative development
or improvement scenarios. However, it remains a challenge
today to simulate the detailed energy ﬂow at the scale of a
few hundred buildings, including the demand and supply
sides [6]. The advantage of this simulation approach is
that it allows for the test of scenarios of various detail
level, covering in a large part the options available to local
politicians and energy departments
As discussed in [7], the amount of data involved in this
kind of study, as well as its quality and longevity become
important concerns. However, few publications in this do-
main intend to tackle this problem. The MEU platform
presented in this study was developed while keeping this
concern in mind. It was designed to provide the simulation
functionalities necessary for the energy management of
urban zones, accounting for both demand and supply sides,
whilst answering some of the data concerns related to this
domain.
Section II gives an overview of the structure and simu-
lation method of the MEU platform. Section III describes
the model of the case-study neighbourhood, the default
values and the origin of the data used. Section IV presents
the results, ﬁrst of the comparison between simulated and
measured values, then about two energy efﬁcient scenarios
that were studied. Finally, Section V provides a concise
conclusion of this paper.
II. THE MEU PLATFORM
The MEU platform models the urban energy ﬂow as an
oriented graph, with (currently) the following rules: source
nodes (in a broad sense) are linked to energy system nodes
or network nodes. The network nodes themselves are linked
to other network nodes or energy system nodes, the energy
system nodes in turn linked to other energy system nodes
or building nodes, seen as energy sink nodes. Measured
energy consumption can be associated to any energy system
node as its input ﬂow. Energy demands for heating, hot
water, electricity and cooling services are associated to each
building node. An arbitrary number of connections link each
of these demands with the energy system nodes supplying
them. Each connection records information about which
fraction of the demand is supplied through this connection.
The source nodes actually represent energy in any form:
it can be natural gas as well as a pre-deﬁned standard
electricity mix. These nodes are deﬁned along with their
name by environmental factors, such as a kWh primary
energy per kWh coefﬁcient and a kg CO2,eq per kWh
coefﬁcient. Network nodes are mainly characterised by a
loss factor, whereas energy system nodes refer to a dedi-
cated simulation model including any number of modiﬁable
parameters. Building nodes include data about their address,
location (footprint), allocation and a physical model used
for the estimation of their heating and cooling demand
with the simulation program CitySim presented below. Their
18
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-234-9
SIMUL 2012 : The Fourth International Conference on Advances in System Simulation

MEU spatio-
temporal
database
MEU platform graphical   
user interface (website)
Cartography 
module
GIS server
MEU web 
service
CitySim
Solver
Technology
models
Figure 2.
Web-based structure of the MEU platform
electricity and hot water needs are estimated using Swiss
norms [8], based on their allocation and treated ﬂoor area.
A GIS-based web interface provides access and editing
functionalities to the model through a map representation
(Figure 1). The data is stored in a spatio-temporal Post-
greSQL (opensource) database and can also be accessed
directly. The simulation process takes the form of a dedi-
cated web service. It includes calls to a CitySim web service
for the estimation of energy demands, and to a technology
model web service that simulates the production of an energy
system based on its consumption or vice-versa (Figure 2).
These are combined in a simulation process consisting in:
• Estimating the whole annual energy ﬂows based on the
simulated demands;
• Scaling this ﬁrst estimate to match the measured con-
sumption values available, saving both original and
scaled values for later analyses.
A. CitySim
The urban energy use simulator CitySim [9] was devel-
oped at EPFL based on multiple physical models coupled
together. CitySim can compute an estimation of the on-site
energy use for heating, cooling and lighting with an hourly
time step. A radiation model ﬁrst computes the irradiation
incident on each surface of the scene, direct from the sun,
diffuse from the sky and reﬂected by other surfaces. The
results of this model, together with predictions of long-
wave radiation exchange, are input to a thermal model.
This model determinates the thermal exchange through
buildings’ envelopes and computes the heating and cooling
energy needs to maintain predeﬁned temperature conditions
inside. Finally, energy systems providing heating, cooling
and electricity can also be deﬁned.
As input, a complete physical description of the scene
as well as climatic data are needed for the simulation.
The climatic data include hourly temperature, wind and
irradiance values, together with the geographic coordinates
and the deﬁnition of far ﬁeld obstructions (which is used
by the radiation model). The building models describe the
envelope of each building (the thermal properties of each
facade, the layered composition of the walls, the proportions
of window and the physical properties of the glazing), as
well as the inﬁltration rate and, when possible, the presence
of occupants.
CitySim is used in the MEU platform to compute heating
and cooling demands only. It was transformed for this
purpose into a web service, called by the central MEU
web service. The MEU web service prepares a simple input
model based on the data available in the database and save
the results simulated by the CitySim web service.
III. MODEL
The input model used in this study is composed of both
real data and default values, which are presented here.
A. Data sources
The chosen neighbourhood is located in la Chaux-de-
Fonds in Switzerland (alt. 1000m), a UNESCO World
Heritage Site for its watchmaking industry-driven urbanism
mixing housing and workshop at the heart of the city. The
model created for this project is based on cadastral data
deﬁning buildings’ footprints. The footprints are combined
with data from the national building register including
the address, period of construction, allocation if housing,
number of ﬂoors and optionally space heating and hot water
supply systems. These were completed with a large amount
of default data to form the physical model of the building
(see Section III-B).
The energy consumption data of gas and heat from the
district heating network (DHN) were supplied by the local
energy provider for the years 2009, 2010 and 2011. Part of
the fuel oil (supplied by various unknown companies) con-
sumption values were provided by the city, based on contacts
with building owners. Where measured consumptions of gas,
fuel oil or district heating were available respectively gas
boilers, fuel oil boilers and heat exchangers were deﬁned
in the corresponding buildings. It was assumed that these
produce space heating, as well as hot water if the building
register announced the same energy carrier for both services.
The consumption values were then affected to these systems.
The lower conﬁdence data of the building register was
used to complete the supply picture with electrical boilers
for domestic hot water in the buildings with measured
consumptions but where the register announced electricity as
the energy carrier for the production of domestic hot water.
The register was also used to create other energy systems for
both space heating and domestic hot water when information
was available for buildings without consumption data. At
this point, buildings without energy system for heating that
are semi-detached from buildings with a high consumption
value were considered to be heated by the same centralised
energy system and thus connected to that energy system.
Fuel oil boilers were eventually deﬁned in buildings without
19
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-234-9
SIMUL 2012 : The Fourth International Conference on Advances in System Simulation

Figure 1.
The web interface of the MEU platform, here showing the main energy carrier used for heating in each building and the possibility to deﬁne
any number of energy systems to provide the energy services.
any other energy system. An electricity meter providing
electrical services was also deﬁned in each building, and
associated with the electricity consumption obtained through
the energy provider. The electricity consumption of electrical
boilers was assumed to be included in the total electricity
consumption measure.
The model is completed with measured local meteorolog-
ical data for the years 2009, 2010 and 2011, which are used
for the CitySim simulation.
B. Default data
As mentioned above, in order to obtain a microsimulation
model at this scale of a few hundred buildings, numerous
default values where used. The objective of this ﬁrst crude
model is, therefore, not to obtain precise individual building
energy demands, but statistically adequate results.
Most of the default physical parameters used for the
buildings, shown in Table I, are independent of construc-
tion period or allocation, which is an admittedly rough
hypothesis. However, the default wall types (Table II) are
attributed based on the construction period, and the set point
temperature depends on the building’s allocation (Table III).
The technology models used for the energy systems are
crude; the wood, gas, oil and electrical boilers have an
efﬁciency of respectively 0.65, 0.85, 0.85 and 0.93. The
electricity meters have an efﬁciency of 1 and the heat
exchangers of 0.93. The heat pumps have a ﬁxed COP of
3.4.
When two or more energy systems are deﬁned to provide
the same service, it is supposed that each meets the same
Facades’ windows ratio
0.3
Windows U-value [W/m2K ]
1.4
Windows g-value
0.7
Windows openable ratio
0.5
Ground K-value [W/m2K ]
3
Roof U-value [W/m2K ]
0.3
Short wave reﬂectance of surfaces
0.4
Inﬁltration rate [h−1]
0.4
Table I
DEFAULT PHYSICAL PROPERTIES OF THE BUILDINGS
Period
Description
U value
[W/m2K]
Before 1945
Rough-stone wall
1.64
Before 1945*
+ inner insulation
0.19
1946 - 1960
Rough-stone, air gap and brick
1.46
1946 - 1960*
+ gap and outer insulation
0.19
1961 - 1970
Double brick wall with air gap
1.14
1961 - 1970*
+ gap and outer insulation
0.19
1971 - 1980
Concrete, ins., reinforced concrete
0.57
1971 - 1980*
+ outer insulation
0.20
1981 - 1990
Insulation and armed concrete
0.42
1991 - 2000
Insulation and armed concrete
0.29
2001 - 2010
Insulation and armed concrete
0.21
1981 - 2010*
+ more outer insulation
0.19
Table II
DEFAULT WALL TYPES, DESCRIBED OUTSIDE TO INSIDE, AND THE
INSULATED VERSION (WITH A STAR) USED FOR THE REFURBISHMENT
SCENARIO
share of the demand, an hypothesis that can be adapted
during the simulation based on the measured data.
20
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-234-9
SIMUL 2012 : The Fourth International Conference on Advances in System Simulation

Figure 3.
Discrepancy factor for the base case simulation. The ratio is deﬁned with M for the measure and S for the simulated value in order to differentiate
over- and underestimation.
Category
Electricity
need
Hot water
need
T min set
point
MJ/(m2·an)
MJ/(m2·an)
◦C
apartment
building
100
75
21
individual home
80
50
21
administrative
80
25
21
schools
40
25
21
sales
120
25
21
restauration
120
200
21
meeting venues
60
50
21
hospitals
100
100
23
industrie
60
25
18
stores
20
5
18
sports
installations
20
300
18
indoor swim-
ming pools
200
300
28
Table III
ALLOCATION-DEPENDENT DEFAULT VALUES
IV. RESULTS
The results cover two topics. First, a comparison of the
simulated and measured values was performed. The second
part of this section presents the results of two energy-
efﬁciency scenarios.
A. Comparison between simulated and measured values
The ﬁrst results conﬁrmed that the approach described
above could correctly represent urban energy ﬂow. The
scene includes several cases of centralised energy systems
providing space heating and / or hot water in different
buildings, buildings where space heating is produced by both
the district heating network and a gas boiler (in order to
free power on the DHN during heavy load periods), and
electricity meters providing both the electricity demand and
an electrical boiler, which were correctly simulated.
The map-based representation of the discrepancy between
the measured and simulated values allowed for simpliﬁed
error location and efﬁcient corrections of the model. As
the discrepancies might originate from a wrong allocation
of the measured consumption as well as from the simu-
lated model itself, a symmetric discrepancy factor D =
max( measured value
simulated value; simulated value
measured value) was used, with values close
to one representing a good match. The discrepancy factor
over the scene after the correction of the obvious error is
shown in Figure 3.
We observe a global over estimation of the buildings’
heating demand, with a median discrepancy factor of 2. The
most important sources for this difference are probably the
following :
• The internal gains have not been considered in the
model for now, which deﬁnitely results in an over
21
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-234-9
SIMUL 2012 : The Fourth International Conference on Advances in System Simulation

estimation of the demand for heating, although possibly
not of that magnitude.
• The numerous default values used for the physical
properties of the model might not be appropriate. Once
the internal gains are accounted for, it will be possible
to test for better adapted default values.
• Some of the measured consumption interpreted as cov-
ering hot water as well as space heating might actually
correspond only to space heating. As the details about
the energy systems installed in the buildings is not
known and cannot be obtained without a large survey,
this was deﬁned with several assumptions.
• Finally, the default value approach adopted here is not
expected to produce very close results for buildings
which are not of housing or administrative allocation.
The processes taking place in other allocation buildings
are too various to be represented with this method,
and the platform is intended to be used with real
consumption data for these buildings. The discrepancy
is also slightly better when excluding these ”non-
standard” buildings: the median of the discrepancy
factor is at 1.8 over the housing and administrative
allocation buildings.
The inclusion of internal gains in the simulation and the
improvement of the default values used are thus high priority
developments for the future.
B. Energy efﬁciency scenarios
Using the global energy ﬂow picture discussed above,
two energy efﬁciency scenarios where studied. The base
case simulation results are known to be of limited quality;
however the relative results of two simulations remain valid.
The energy ﬂow have been scaled to match the consumption
measurements, and this scaling of the simulation results
is used to study ﬁrst scenarios presented here. The future
improvements of the model will evidently improve the
quality of the scenarios’ results as well.
1) Refurbishment of high consumption building on the
DHN: A known intention of the energy providers in la
Chaux-de-Fonds and more generally in Switzerland, is to
make the DHN denser. The objectives are to increase their
efﬁciency as well as their proﬁtability, while adapting to the
decrease of heat demand following the recently prevailing
refurbishment policies.
The MEU platform provides a map of the density of ﬁnal
energy used for each service (Figure 4), which allowed to
easily spot a high consumption block of 5 buildings (over
400 kWh/m2 per year). As the heating demand of these
buildings was originally underestimated by the platform, the
model was adapted for the base case to represent better the
low quality of the envelope. The window U-value was set
to 3 [W/m2K], the roof U-value to 0.3 [W/m2K] and the
inﬁltration rate to 1.5, leading to a discrepancy factor lower
than 1.25. In the scenario, the building was refurbished under
Figure 4. Heating energy use density and buildings that could be connected
to the DHN with the energy saving of the ﬁrst scenario
the swiss standard Minergie so that the average U-value of
the envelope approaches 0.2 [W/m2K] :
• The wall type was changed for the insulated version of
1946-1960 (see Table II).
• The window U-value was set to 1 [W/m2K].
• The roof U-value was set to 0.2 [W/m2K].
Applying the same discrepancy factor to scale the simu-
lation results, the scenario leads to a 3.6 GWh decrease of
the heating demand, or 65% of the original value. These
buildings happen to be heated by the DHN for only 32%
of their heat needs (interruptible DHN, completed by a
gas boiler). The economy at the DHN level is still of 1.2
GWh per year, which would be sufﬁcient to connect 7
other buildings close to the DHN (shown in Figure 4) and
currently heated with oil furnaces.
2) Refurbishment of all buildings in the scene: A second
scenario was deﬁned to estimate the possible gains over the
whole scene by refurbishing all buildings. The scenario was
deﬁned by setting the same window and roof U-values as
in the ﬁrst scenario in every building, and by insulating all
facades according to Table II.
This scenario leads to the map of heating energy use
density shown in Figure 5, and to an economy of 22.3 GWh
of ﬁnal energy, representing 12.2% of the total ﬁnal energy
used in the scene for the electricity, hot water, space heating
and cooling services. All results have been scaled with
the discrepancy factor where available. Moreover, the non-
inclusion of the internal gains leads to an underestimation
of the decrease of heating demand, as these gains become
22
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-234-9
SIMUL 2012 : The Fourth International Conference on Advances in System Simulation

Figure 5.
Heating energy use density in kWh/m2 per year for the second
scenario, as shown by the platform MEU.
proportionally more important when the buildings are better
insulated.
V. CONCLUSION AND FUTURE WORK
This ﬁrst study performed with the MEU platform is ﬁrst
of all a proof of concept. It demonstrates the possibility to
simulate demand and supply side urban energy ﬂows at a
large scale and on a building basis. This approach opens
a wide panel of possibilities for more speciﬁc or detailed
studies. The ﬁrst results show that the current limitations of
the MEU platform are not structural, but mostly concern
shortcomings of the simulation input model. It requires
some adjustments regarding the inclusion of internal gains
for the heating demand simulation and the improvement of
the default values used. Whereas the simulation of energy
demands yet need improvements, a possibility to use them
together with measured values was demonstrated.
The ﬁrst scenario illustrates how the energy supply can
be quite easily rationalised. The insulation of 5 low perfor-
mance buildings liberating enough power on the DHN to
connect and heat 7 other buildings close to the network and
currently heated with oil furnaces. This is combined with
an economy of more than 2.4 GWh of gas, the insulated
buildings being heated by both gas and DHN.
The second scenario presented provides an estimate of the
energy economy possible on a urban zone by insulating the
buildings’ envelope. It amounts to more than 12% of the
ﬁnal energy used in buildings (not including transportation).
This result supports the suitability of policies encouraging
energy efﬁcient refurbishment of buildings as part of the
general efforts to reduce the global energy consumption.
ACKNOWLEDGMENT
The authors would like to thank the Swiss Federal Ofﬁce
of Energy (project number 102775) and all funders and
partners of the MEU project. The help of the city of
La Chaux-de-Fonds and the energy provider Viteos, who
provided most of the data used in this project, is gratefully
acknowledged.
REFERENCES
[1] L. Perez-Lombard, J. Ortiz, and C. Pout, “A review on build-
ings energy consumption information,” Energy and Buildings,
vol. 40, no. 3, pp. 394–398, 2008.
[2] L. Swan and V. Ugursal, “Modeling of end-use energy con-
sumption in the residential sector: A review of modeling tech-
niques,” Renewable and Sustainable Energy Reviews, vol. 13,
no. 8, pp. 1819–1835, 2009.
[3] J. Keirstead, M. Jennings, and A. Sivakumar, “A review of
urban energy system models: Approaches, challenges and
opportunities,” Renewable and Sustainable Energy Reviews,
vol. 16, no. 6, pp. 3847–3866, 2012.
[4] L. Shorrock and J. Dunster, “The physically-based model
BREHOMES and its use in deriving scenarios for the energy
use and carbon dioxide emissions of the UK housing stock,”
Energy Policy, vol. 25, no. 12, pp. 1027–1037, 1997.
[5] Y. Shimoda, T. Fujii, T. Morikawa, and M. Mizuno, “Resi-
dential end-use energy simulation at city scale,” Building and
environment, vol. 39, no. 8, pp. 959–967, 2004.
[6] J. Sn¨akin, “An engineering model for heating energy and
emission assessment – The case of North Karelia, Finland,”
Applied energy, vol. 67, no. 4, pp. 353–381, 2000.
[7] D. Perez and D. Robinson, Digital Urban Modeling and
Simulation, ser. Communications in Computer and Information
Science.
Springer, 2012, vol. 242, ch. Urban energy ﬂow
modelling: a data-aware approach.
[8] Soci´et´e suisse des ing´enieurs et des architectes, “Swiss norm
380/1 : L’´energie thermique dans le bˆatiment,” SIA Zurich,
2009.
[9] D. Robinson, A. Rasheed, J. H. K¨ampf, M. Bruse, K. Ax-
hausen, F. Flourentzou, M. Batty, F. Haldi, and D. Perez, Com-
puter Modelling for Sustainable Urban Design, D. Robinson,
Ed.
Earthscan, 2011.
23
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-234-9
SIMUL 2012 : The Fourth International Conference on Advances in System Simulation

