A Heuristic Approach Based on the Ant Colony Optimization for the Routes 
Elaboration on the Fuel Collection for the Brazilian Petrolium Agency 
 
Alex Barradas, Adriano dos Santos, Sofiani Labidi, Nilson Costa 
Federal University of Maranhão 
São Luís, Brazil 
{barradas.alex,adriano.asr,soflabidi,nilson2001}@gmail.com 
 
Abstract - The trade of petrol derivatives such as natural gas 
and biofuel is an activity that demands supervision and 
monitoring. The ANP (Petrol, Natural Gas and Biofuel 
Brazilian Agency) is responsible for guaranteeing the quality of 
the products made by the petrol industry. Nevertheless, in 
order to be efficient, the ANP has established a partnership 
that authorizes the LAPQAP/ UFMA (Analysis and Research 
in Petrol Analytical Chemistry Laboratory/Federal University 
of Maranhão) to be its representative in the State of 
Maranhão. The proposal of this research is to present a 
prototype in order to automatize part of the fuel sample’s 
collection process in order to make the tasks simpler, which 
nowadays are executed by the lab’s analysts, who make that 
work by their experiences, increasing the number of 
supervised fuel stations aiming to diminish the irregularities on 
fuels traded in the State of Maranhão. Developed the prototype 
called S-Rota that is responsible for creating a circuit between 
the starting point UFMA and the fuel stations that approaches 
the concepts regarding the Ant Colony Optimization 
Algorithm (ACO). 
Keywords - Collection; Monitoring; Quality; Fuel; ANP; 
ACO. 
I. 
 INTRODUCTION 
The ANP is responsible for the execution of the national 
policy for the Petrol, Natural Gas and Biofuel Power Sector 
according to the Petrol Law (Law number 9.478 / 1997). To 
make these actions concrete, the ANP has developed a Fuel 
Quality’s Monitoring Program (PMQC) and established a 
representative in each state. 
The PMQC has as objective to systematically evaluate 
the quality of the fuel traded in Brazil (Gas, Diesel, Ethanol 
and B2 mix) mapping situations that are good enough 
according to its parameters so that supervising actions can be 
directed. The PMQC has 23 partner laboratories. 
In State of Maranhão, the Federal University of 
Maranhão with its Analysis and Research in Petrol 
Analytical Chemistry Laboratory (LAPQAP / UFMA) is 
responsible by the PMQC – ANP in monitoring the fuel’s 
quality in Maranhão State, as well as sending Brazilian 
Automobiles Liquid Fuels’ Quality monthly reports to ANP. 
Thus, the program developed by the ANP, the PMQC 
needs to be analyzed, identified and characterized in its main 
stages so that it can be contextualized to Maranhão’s 
scenery. Afterwards, it is observed the Fuel Sample’s 
Collection (CAC) and its relationship with the other stages 
executed by the LAPQAP. 
At the Fuel Sample’s Collection stage, the LAPQAP 
focus on evaluating the costs and time spent for the inspected 
fuel stations definition, routes creation and samples’ 
collection. These days, the elaboration of the definition of 
the fuel stations inspected and the route creation is 
handmade. This action puts all the responsibility on the 
collectors (driver and analyst). This stage is fundamental 
because it influences the conclusion of all the other stages of 
PMQC and is subject to human mistakes. 
The developed prototype elaborates the better route 
between the LAPQAP and the reseller fuel stations, having 
this approach based on the Ant Colony Optimization [1]. 
II. 
PMQC 
The PMQC concept is to ascertain the quality’s standard 
of the traded fuel on its extraction, refining, distribution and 
reselling stages to the national market [2]. PMQC’s main 
objectives are surveying the general indicators of the fuel’s 
quality traded in the country and the identification of non-
conformities focus, aiming to orientate and improve the 
Agency’s inspection area performance [2]. 
A. PMQC stages 
The three stages that compound PMQC are: 
 
Fuel Samples’ Collection: The first stage is based on 
the accomplishment of raffles that indicates the 
stations that will be inspected and the fuel samples’ 
collection by the LAPQAP. 
 
Samples’ Lab Analysis: The second stage is 
responsible for collecting the samples that are 
conforming the ANP regulation and analyze their 
quality. 
 
Data Treatment and Information sending to ANP: 
This stage finds the result generated on the second 
stage to organize and insert them on the system of 
Fuel’s Quality Monitoring (MQC) to send them to 
ANP after all. 
 
 
B. Fuel Samples’ Collection Stage (CAC) 
This work objective is focused on this stage, aiming to 
automatize part of the collection process. In State of 
Maranhão, the existing fuel stations (can be called universe) 
is saved on the data base lab which represents the ANP in the 
State. 
69
GEOProcessing 2011 : The Third International Conference on Advanced Geographic Information Systems, Applications, and Services
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-118-2

Besides that, aiming to make the logistics easier, the 
Maranhão State is divided in four regions by the LAPQAP 
called R1, R2, R3 and R4, as shown in Figure 1. This way, 
the laboratory has one week to collect the samples in each 
region. 
 
 
 
Figure 1.   Four Regions [1]. 
 
The first week of the month is destined to the region R1 
(Saint Louis city), so, the initial task is to make 10% (ten 
percent) of the fuel station in the group of towns of R1. The 
same thing happens in the others regions, even though needs 
to be kept the second week to R2, the third one to R3 and the 
forth one to R4 .  
The sampling in this work focus in the region 1, 
considering no have differences in generation routes among 
the regions.  
Then, when the fuel stations to be inspected are defined, 
the responsible collaborator will have the route between the 
starting point – UFMA and the fuel stations. 
The routes nowadays are done without the help of any 
tools and/or logistical techniques, only the collaborator’s 
empirical knowledge, even though the LAPQAP establish 
some criteria to prioritize some fuel stations above others. 
The main criteria are divided in: 
 
Fuel’s Quality. 
 
Documentation. 
 
Distance. 
For the fuel’s quality criteria, the last sample of the three 
types of fuel: alcohol, gas and diesel. According to the result 
of each type of fuel, a level of priority is established. 
For the documentation criteria, the LAPQAP requires the 
inspected level to present the documentation required by the 
ANP. Then, the laboratory elaborates a list that discriminates 
and informs the situation of each document. 
For the distance criterion, the region to be inspected is 
verified and the shortest distance between the starting point 
and the fuel stations are is analyzed. In other words, the 
closest fuel stations to the starting point are prioritized. After 
this, the analyst evaluates the three criteria and defines the 
order of fuel stations to be inspected. It is important to 
mention that each criterion is applicable only to 10% (ten 
percent) of the make fuel stations. 
III. 
ANT COLONY OPTIMIZATION 
The Ant Colony Optimization (ACO) [3] is based on real 
and solved problems by an ants’ colony.  This algorithm is a 
heuristic based on probability, created for solution of 
computational problems that involve search of ways in 
graphs. The ants’ colonies are distributed systems that 
despite the individual simplicity represented in an isolated 
manner, the system’s structure present a high leveled social 
organization [4].  
 
The main functions executed by an ants’ colony between 
the relationships among the ants include: building or 
increasing the nest, finding food, feeding the brood [5]. 
 
On the interactions between ants searching for food and 
building trails, a substance called pheromone is used. This 
substance influences the ants in the choice of innumerous 
routes, in other words, how much more the tax concentration 
of pheromone in a certain way, the biggest will be the 
chances for an ant to choose the same way [6]. 
 
The main characteristics are: 
 
The ants’ population (agents) is an independent 
being moving around simultaneously without a 
central control. 
 
The search for routes happens in a deterministic 
way. 
 
The algorithm is cooperative, namely, each ant 
chooses a way based on the pheromone’s 
concentration deposited by other ants. 
The algorithm main idea is the indirect communication 
based on the pheromones routes between an agents’ colony 
called ants [7]. The mains mathematical formulations that 
compound the algorithm are described below. 
The equation (1) illustrates the mathematical formulation 
used on the work for the ants’ colony algorithm [8] for 
indicate a probability of ant   in this point i and choice point 
j: 
70
GEOProcessing 2011 : The Third International Conference on Advanced Geographic Information Systems, Applications, and Services
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-118-2


   
     
 
 
 
                
                 
          
              
 

On the equation (1), the variable α is a weighting of the 
pheromone        and β is the a weighting of the 
heuristic information        , where         
 
 is the 
visibility between the variables i and j.  
The equation (2) shows the formulation that defines the 
pheromone deposited on the route [8]: 
    
   
 
                                       
              
 

The variables that compound equation (2) are defined as 
follows: 
 
   is a project constant. 
 
   is the length of the circuit of the  -th ant. 
When an ant finishes the circuit in a          time and 
consists in a cycle of n interactions, the equation result is 
used to update the amount of substance deposited on the 
route, based on equation (3) [8]. 

   
            
         
 

On equation (3), the variable   represents the route’s 
persistence during the cycle        , in which the value 
      the trail evaporation between the field and the   and 
   . 
This way, the algorithm ACO searches for a feasible 
solution for the famous Travelling Salesman Problem (TSP), 
it is a problem that belongs to the category NP-Hard from 
complexity exponential [4]. Traveler simulating an ants’ 
walk by a graph using the mathematical modeling for the 
concentration of pheromone in the graph [9]. However, the 
ACO algorithm does not guarantee the best way but a good 
solution with polynomial execution cost. 
 
IV. 
RELATED WORK 
The TSP is of importance since similar combinatorial 
optimization problems arise in industrial applications and 
can be formulated as TSP-like instances [10]. 
In the business scenario, Google invests in solutions to 
the TSP through the routes services available in the Google 
Maps API V3. By default, the routes service calculates a path 
which includes the reference points provided in the indicated 
order. Optionally, the routes service may optimize the path 
provided by rearranging the points of reference in a more 
effective order [11].  
However, the routes service offered free by Google Maps 
API V3, have some limitations in regard the amount of 
allowed points restricting to a total of eight points. 
Moreover, the API does not offers directly the insert of new 
criterions for the creation of the path. 
The application S-route uses the Google Maps API only 
in georeferencing services and applies the ACO approach for 
route optimization that allows the use of up to 60 tested 
points. Another S-Route differential, is presente in the 
possibility of developing routes based on criterions such as 
fuel quality and documentation.  
V. 
PROPOSED SYSTEM 
The prototype s-Rota aims to automatize part of the fuel 
samples’ collection process of LAPQAP. So, the procedures 
executed by the LAPQAP are analyzed aiming to absorb and 
understand its main features.  
A. S-Rota modeling 
In order to make the visualization of the activities’ 
diagram from the Figure 2, the activities' diagram shown in 
Figure 2 has been used. This activities’ diagram is a 
generalization.  
 
Figure 2.   Activities’ Diagram. 
Figure 2 is a generalization, called, a general summary of 
the routes’ creation process by the prototype. The stage starts 
with the administrator enrolling the existing fuel stations and 
requiring the lottery or assortment in execution.  
Before that phase, the existence of stations in the data 
base is checked; if there are stations, the raffle is done and 
sent to the administrator. Then the routes definition process 
is started by the user. 
 
After the prototype search for the last raffle done and 
elaborates the route based on the distance called rota1, that 
is, at this moment the shorter a total route is, the better. After 
the router 1 is elaborated, the administrator asks for the 
elaboration of personalized route called router 2. The 
activities’ diagram finishes with the visualization of router 2 
by the administrator. 
Register Office 
  Calls Raffle  
View Raffle  
Call Route 1  
View Route 1  
View Route 2  
Doesn’t Exist  
exist  
Realize Raffle  
        Raffle  
     Route  
  Check Raffle  
  Make Route 1  
Check Route 1 
  Make Route 2  
Custom Route 
Calls 
Check Office 
Active 
Custom Route 
Calls 
71
GEOProcessing 2011 : The Third International Conference on Advanced Geographic Information Systems, Applications, and Services
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-118-2

B. S-Rota Implementation 
The S-Rota prototype has been implemented with the 
composition of the following elements: 
 
Web Server / S-Rota web application. 
 
Maps API . 
 
Data base manager system (SGBD). 
The web server is responsible for storing and make it 
available on the net the S-Rota application, specifically on 
the Internet. The software is accessed as any conventional 
website. The languages used for the prototype of the 
application making were PHP [12] and Java Script [13]. 
For the maps API, it has been searched an API of maps 
that offers services dynamically geo-referred and without 
costs concerning software’s license. An option to the 
approached criterion is Google Maps [11]. 
As the maps API uses Java Script, the applied searching 
algorithm has been developed in this language, to make the 
communication between the maps API and the prototype that 
uses data structure in XML format as well easier [14]. 
Besides the programming languages, the prototype stores the 
information recorded and generated by the application in a 
relational SGBD. 
To manage the objective of each element listed by the 
LAPQAP, the project has defined the following development 
stages: 
 
Data maintenance. 
 
Fuel Stations Selection. 
 
Routes elaboration. 
C. Data Keeping 
This stage represents the data management inserted at the 
S-Rota. Such activities are related to the administrator 
profile. The main items in this process are: 
 
Fuel station. 
 
Collector. 
 
Note. 
In the S-Rota prototype, the information regarding the 
item fuel station stores in the table called Fuel Station. These 
information work as feeding for the next stages of Fuel 
Stations selection and Routes elaboration.  
Besides that, the table Fuel Station is related to other 
tables such as the fuel’s quality (qualitycomb) and the table 
documentation (documentation). Through these relationships  
it is possible to associate the fuel station to the quality of 
each fuel traded and the documentation historical; such 
information are essential to the elaboration of the 
personalized route. 
The next item, called collector, represents the responsible 
for collecting the fuel samples. The data of each responsible 
collector are stored in a table called collector; such 
information contains personal data and the historical of each 
collector regarding the each collection done. 
In the last item (notes), the administrator inserts in the 
data bank any unexpected event in the collection process, in 
other word, in the table called reminder it is registered any 
unwanted event.  
D. Fuel Stations’ Selection 
At this stage, the prototype should select in a random and 
transparent way the reseller fuels stations that will be 
inspected by the LAPQAP. 
In this process, a class called SORTEIOCLASS has been 
projected with several functions, among them it is cited the 
function sorteio() (raffle). This function basically checks the 
data bank of the active fuel stations and then, the function 
array_rand [8], the fuel stations are organized randomly 
conforming the limited amount of fuel stations defined by 
the function countSorteio(). 
By the user watching, the administrator access the raffle 
screen and asks for the Fuel stations selection. Then, a file in 
XML format containing the information about the raffle fuel 
stations needed for the maps’ generation is generated. 
E. Routes Elaboration 
For the routes elaboration, it is necessary in advance to 
have a map with the fuel station selected. The Google Maps’ 
carry the API file having all the necessary information for 
the localization and identification of each fuel station and the 
starting point (UFMA). With these steps, the S-Rota is able 
to represent each item in the map generated by the API, 
finding them in the Maranhão State. 
 Figure 3 shows the elements geo-referred, such as: 
starting point and fuel stations present in the XML file. 
 
 
Figure 3.   Route’s elaboration. 
The API acts basically in the representation of 
geographical information and in the geo-referred data input 
for the search algorithm. 
The responsibility of evaluating the better way is given to 
the search algorithm. In this case, the algorithm optimization 
applied to solve the Travelling Salesman Problem had as a 
base the ant’s colony. 
In this context, the mathematical principles and the 
concepts regarding the ant’s colony have been implemented 
in Javascript aiming to interact with the Google Maps’ API. 
The number of ants (n Ants) and of interactions used by the 
algorithm has been 10 each [4]. 
72
GEOProcessing 2011 : The Third International Conference on Advanced Geographic Information Systems, Applications, and Services
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-118-2

In the following pseudo-code, the main function of the 
implementation of the ants’ colony, the function ACO ( ) is 
represented. 
 
 
 
In the pseudo-code, the function generateRoutes(j) 
represents the generation of the route executed by the ants 
which do by choosing the best points to follow the city i to j 
constructing the route according to equation (1). The 
function update_of_pheromone() represents the update of the 
matrix of pheromone that is carried through to each 
interactions nInterations, in which if increases or decreases 
the variable     (nivel of pheromone between i and j 
according to equation (3). 
The following stage is the definition of the course of the 
personalized route. The process that establishes the new 
sequence of priorities between the fuel stations, analyzing 
the distance, fuel’s quality and documentation criterion, 
conforming cited previously. 
So, the new scoring of the fuel stations is obtained by an 
average of the three criteria, conforming the equation (4): 

                
         


In which the variables are: 
 
  is the scoring of the fuel stations based on the 
distance. 
 
   is the weight defined by the administrator for the 
distance. 
 
  is the scoring of the fuel station based on the fuel 
quality. 
 
   is the weight defined by the administrator for the 
fuel’s quality. 
 
   is the scoring of the fuel station based on the 
documentation. 
 
    is the weight defined by the administrator for the 
documentation.  
The variable scoring            may vary between the 
values from 0 to 100. For the scoring of  , in which the fuel 
station is irregular, in only one type of fuel, the scoring 
received is 33, for two types 66 and for three types 100. For 
the scoring of     , either is 0 for the irregular fuel station or 
100 for the regular fuel station. 
The weights are defined by the administrator through the 
prototype. Thus, the user may establish a priority order for 
each criterion according to the administrator needs. 
F. Results 
To get the prototype validation process started S-Rota, 
the LAPQAP provide real data referring to the collection 
done on October 22nd, 2007. The data extraction happened 
by the application G7ToWin version A.00.183. 
The application carries the data obtained by the GPS 
Garmin that furnishes the geo-referred coordinates of each 
collected fuel station. The fields used for the results 
comparison were Fuel Station, Latitude, Longitude and 
Date/Time of the Collection as per figure 4. 
 
 
 
Figure 4.    G7ToWin Data. 
 
By the field Date/Time of the Collection it is possible to 
determine the sequence of visited fuel station in the time by 
the LAPQAP, which allows the route done by the driver to 
be traced. For the visualization of this course it was used the 
Google Maps, as per figure 5. 
 
 
Figure 5.  ANP Driver’s route 
73
GEOProcessing 2011 : The Third International Conference on Advanced Geographic Information Systems, Applications, and Services
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-118-2

 
 
The course done in figure 5 resulted in a total way of 
85,49km. The elaboration of this route is done in an 
empirical way by the driver, not having a specific standard. 
For the elaboration of the course by the prototype S-Rota, 
the following premises gave been considered:  
 
The variables      and     . 
 
The same points of the last experiment as per figure 
4. 
Figure 6.   S-Rota’s route. 
The course elaborated by the prototype S-Rota resulted in 
a way of 77.48km. The difference between the figure 5 and 
the figure 6 is of 8.01 km.  
The prototype accomplished the operation faster which 
has brought an economy of approximately 9.37% comparing 
to what accomplished the driver elaborating the route 
handmade. 
 
VI. 
CONCLUSION 
This research has presented a prototype that searches for 
the best way for the Fuel Samples’ Collection stage. As a 
complement of this prototype called S-Rota, an optimization 
algorithm based on the optimization approach of ants’ 
colony [7] has been developed, adapted to the language 
Javascript, applied to Google Maps’ API and integrated to 
the S-Route base. 
The prototype gathered with the optimization algorithm 
of ants’ colony aims to automatize part of the process of Fuel 
Samples’ Collection approaching concepts related to the 
UFMA’s Analysis and Research in Petrol Analytical 
Chemistry Laboratory needs. It also creates the fuel stations 
in a random way, selecting a percentage by the user of active 
and existing fuel stations in the data base. This way, any 
inappropriate tendency in the fuel stations selection is 
avoided. 
Despite the satisfactory and positive acquisition in this 
piece of work, some points still present limitations. As an 
example, the searching algorithm has not been tested in big 
fuel stations net yet and besides that does not evaluate the 
highways conditions and the traffic level. In these conditions, 
it is wished to improve the searching algorithm, in order to 
ascertain good results in big fuel stations nets. 
This paper applied the Classic ACO for prove this code 
with minimal conditions its can resolved with success the 
problems best way for the S- Rota Software. 
ACKNOWLEDGEMENT 
Many thanks to everyone who helped directly and 
indirectly and allowed the creation of this software 
prototype. 
 
REFERENCES 
 
[1] A. Barradas, Abordagem Baseado na Heurística de Colônia de 
Formigas para Elaboração de Rotas na Fase de Coleta de Amostras de 
Combustíveis.   São Luís, MA: Programa de Pós Graduação em 
Emgenharia de Eletricidade, Universidade Federal do Maranhão, 2009. 
[2] ANP, “Programa de Monitoramento”, Agência Nacional do Petróleo, 
Gás Natural e Biocombustíveis, 2010. Accessed september 26, 2010. 
Available at http://www.anp.gov.br/?pg=33970. 
[3] M. Dorigo, M. Birattari, and T. Stützle, “Ant Colony Optimization-- 
Artificial Ants as a Computational Intelligence Technique,” IEEE 
Computational Intelligence Magazine, 2006. 
[4] M. Dorigo, “Ant Colony Optimization,” MIT Press, 2004. 
[5] K.F. Doerner, D. Merkle and T. Stützle, “Special Issue on Ant Colony 
Optimization”, vol. 3, No. 1, Swarm Intelligence, March, 2009, pp. 1-
2, doi:10.1007/s11721-008-0025-1. 
[6] S. Nonsiri and S. Supratid, Modifying Ant Colony Optimization. IEEE 
Conference on Soft Computing in Industrial Applications (SMCia/08), 
Muroran, JAPAN, 2008. 
[7] M. Dorigo, Optimization, Learning and Natural Algorithms., M.. PhD 
thesis,  Italy: Politecnico di Milano, 1992. 
[8] K. Kai, N. Haijiao, Z. Yuejie, and Z. Weicun, “Improved integrated 
optimization Model research of mode and route in multimodal 
transportation,” IEEE International Conference on Information 
Management, Innovation Management and Industrial Engineering, 
2009, doi: 10.1109/ICIII.2009.155. 
[9] D. Angus and C. Woodward, “Multiple Objective Ant Colony 
Optimisation”, vol. 3, No. 1, Swarm Intelligence, March, 2009, pp. 69-
85, doi:10.1007/s11721-008-0022-4. 
[10] B. Fox, W. Xiang, and H. P. Lee, “Industrial applications of the ant 
colony optimization algorithm,” Int J Adv Manuf Technol, Published 
online: 6 January 2006, DOI 10.1007 
[11] GOOGLE, API Google Maps, 2010. Accessed september 26, 2010. 
Available at http://code.google.com/intl/pt-BR/apis/maps/. 
[12] PHP, Manual, 2010. Accessed september 23, 2010. Available at 
http://www.php.net/manual/pt_BR/preface.php. 
[13] J. Resig, “Pro JavaScript Techniques”, Apress, 2006. 
[14] W3C, XML, 2010. Accessed september 26, 2010. Available at 
http://www.w3.org/standards/xml/. 
 
 
 
 
 
 
74
GEOProcessing 2011 : The Third International Conference on Advanced Geographic Information Systems, Applications, and Services
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-118-2

