Electronic Payment and Encouraged Cooperation
in a Secure and Privacy-Preserving P2P Content
Distribution System
Amna Qureshi, Helena Rif`a-Pous and David Meg´ıas
Estudis d’Inform`atica, Multim`edia i Telecomunicaci´o, Internet Interdisciplinary Institute (IN3)
Universitat Oberta de Catalunya (UOC), Barcelona, Spain
E-mail:{aqureshi,hrifa,dmegias}@uoc.edu
Abstract—In this paper, we propose a peer-to-peer (P2P)
content distribution system that allows the efﬁcient distribu-
tion of large-sized multimedia contents while preserving the
security and privacy of content providers (merchants) and end
users (buyers), respectively. However, the privacy of a buyer
can be revoked as soon as he/she is found guilty of copyright
violation. A payment protocol is also proposed that provides a
secure payment mechanism, where personal information and
order information cannot be exposed to an unauthorized third
party. In addition, a reputation-based system is introduced for
the selection of the proxy peers required for secure delivery
of the ﬁngerprinted content from the merchant to the buyer.
The paper presents a thorough security analysis of the system
against several security compromising attacks.
Keywords—privacy;
security;
collusion-resistant
ﬁnger-
printing; permutation; peer-to-peer; e-payment; reputation.
1 INTRODUCTION
The low-cost, scalability and ease of content dissemina-
tion provide a lucrative opportunity for content providers
to generate revenues through P2P systems. However, the
content providers have been reluctant in adopting P2P
systems as a distribution vehicle to monetize digital content,
since these systems are plagued with piracy. The ability
to make perfect copies and the ease with which these
copies can then be distributed has given rise to signiﬁcant
problems regarding the misuse, illegal copying and re-
distribution. The content providers apparently fear losing
control of content ownership in the sense that they are no
longer in control of the content distribution and worry about
the promotion of illegal activity. Also, tracing a copyright
violator in a P2P system with millions of connected users
is an immense task. Therefore, ensuring the appropriate
use of copyrighted multimedia content in P2P systems has
become increasingly critical. This copyright infringement
problem motivates the development of content protection
techniques. Among various content protection techniques,
digital ﬁngerprinting addresses the problems of copyright
protection and traitor tracing.
Digital ﬁngerprinting gives merchants more options to
control the distribution of their content. Fingerprinting
techniques involve the generation of a ﬁngerprint (a buyer-
speciﬁc identiﬁcation mark), the embedding operation and
the realization of traceability from re-distributed copies. In
traditional ﬁngerprinting schemes, it is assumed that the
merchants are trustworthy and always perform embedding
honestly [1]. Thus, a dishonest merchant could frame an
innocent buyer, while a cheating buyer would be able to
deny his/her responsibility for a copyright violation act.
Asymmetric ﬁngerprinting schemes [2] were introduced to
overcome this problem. In these schemes, only the buyer
obtains the exact ﬁngerprinted content, and hence the buyer
cannot claim that a pirated copy was originated from the
merchant. However, most of the asymmetric ﬁngerprinting
schemes in the literature incur high computational and
communicational burdens at the merchant’s and/or at the
buyer’s end, due to the use of cryptographic protocols
such as homomorphic encryption or committed oblivious
transfer.
Though the content protection techniques enable the
merchants to enforce copyrights in the content, these tech-
niques are often criticized for breaking buyers’ privacy
by collecting information about the buyers, such as the
transaction history or the purchasing behavior. A priori,
copyright protection places the buyer into an adversarial
relation with the merchant. Hence, the incorporation of a
content protection mechanism in a P2P system can have
serious effects on the privacy interests of the buyers. Recent
years have drawn increasing attention from the research
community towards the preservation of the merchants’
ownership property and buyers’ privacy in P2P content
distribution systems. To date, very few P2P distribution
systems have been proposed that provide both copyright
protection and privacy preservation.
Meg´ıas and Domingo-Ferrer [3] introduced a novel con-
cept of a recombination ﬁngerprinting mechanism for P2P
content distribution. The proposed scheme provides copy-
right protection, collusion resistance and traitor tracing.
However, this system is implemented with a two-layer
anti-collusion code (segment level and ﬁngerprint level),
that results in a longer codeword. Furthermore, honest and
committed proxies are required for the generation of valid
ﬁngerprints at the buyer’s end. Meg´ıas [4] proposed an
improved version of [3], in which a four-party anonymous
communication protocol is proposed to prevent malicious
8
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-400-8
MMEDIA 2015 : The Seventh International Conferences on Advances in Multimedia

proxies to access clear-text ﬁngerprinted contents. However,
the system still requires a two-layer anti-collusion code.
Domingo-Ferrer and Meg´ıas [5] proposed a P2P protocol
for distributed multicast of ﬁngerprinted content in which
each receiver obtains a different ﬁngerprinted copy of the
content, which allows the provider to trace re-distributors
without affecting the privacy of honest buyers. However,
an implementation of a secure multi-party protocol results
in increased computational and communication costs at the
buyer end. Qureshi, Meg´ıas and Rif`a-Pous [6] proposed
a P2P content distribution framework for preserving pri-
vacy and security of the user and the merchant based on
homomorphic encryption. In the framework, some discrete
wavelet transform (DWT) low-frequency (approximation)
coefﬁcients are selected according to a secret key for em-
bedding an encrypted ﬁngerprint to prevent data expansion
due to homomorphic encryption. Although the selective
public-key encryption of the multimedia content results in
lesser data expansion, it imposes computational burden on a
merchant and an increased complexity in ﬁle reconstruction
at the buyer’s end.
In this paper, we present a P2P content distribution
system that provides copyright protection and conditional
privacy to the merchant and the buyer, respectively. In
the proposed system, the original multimedia ﬁle is par-
titioned by the merchant into a small-sized base ﬁle and
a large-sized supplementary ﬁle. This enables to reduce
the communication bandwidth and the computation power
required by the merchant in delivering the large-sized
multimedia ﬁle. The base ﬁle contains the most important
information and is transmitted in a semi-centralized way.
The supplementary ﬁle is unusable without the base ﬁle
and is distributed through a P2P network. A merchant
forms a base ﬁle by using a pre-computation-based secure
embedding mechanism in which the DWT approximation
coefﬁcients are embedded in parallel with all 1s and all 0s
bit streams. An asymmetric ﬁngerprinting protocol based on
collusion-resistant codes and a robust embedding scheme
is performed between a merchant, a buyer and a set of
proxies in the presence of a third party (monitor), in such a
way that the merchant does not know the ﬁngerprint or
the ﬁngerprinted content, and the proxies are unable to
frame honest buyers by combining their assigned permuted
ﬁngerprint bits. A reward and punishment mechanism is
also proposed to ensure that each proxy peer’s best strategy
is to loyally follow the prescribed ﬁngerprinting protocol.
The system also enables buyers to purchase digital contents
anonymously by using dynamic pseudonyms based on a
one-way hash function instead of their real IDs.
The paper is organized as follows. In Section 2, the
building blocks of the system are introduced. In Section 3,
the proposed P2P content distribution system is described
in detail. In Section 4, we discuss the security analysis
of the system’s protocols through a number of attack
scenarios. Section 5 presents the comparative analysis of
the proposed system with related P2P content distribution
systems. Finally, Section 6 summarizes the conclusions.
2 BUILDING BLOCKS
In this section, a brief overview of the building blocks
(embedding domain and algorithm, collusion-resistant ﬁn-
gerprinting codes, PseudoTrust model and permutation) of
the system is presented.
A. Embedding domain
In the signal processing research area, the wavelet trans-
form has gained widespread acceptance in recent years.
The DWT is used in the system to embed the collusion
resistant ﬁngerprint into a multimedia content. The DWT of
a signal results into approximation and detail coefﬁcients.
Since the low frequency coefﬁcients can effectively resist
various signal processing attacks, the ﬁngerprint bits are
typically embedded into the approximation coefﬁcients of
the signal after the DWT. Moreover, the original signal
can be reconstructed from the approximation and detail
coefﬁcients through the inverse discrete wavelet transform
(IDWT).
B. Embedding algorithm
An embedding algorithm is used to embed a ﬁngerprint
into different copies of the same content. Quantization in-
dex modulation (QIM) [7] is a relatively recent embedding
technique that has become popular because of the high
watermarking capacity and the ease of implementation. The
basic QIM scheme embeds a ﬁngerprint bit f by quantizing
a DWT coefﬁcient W by choosing between a quantizer with
even or odd values, depending on the binary value of f.
The proposed system employs a QIM-based watermarking
technique to embed the collusion-resistant ﬁngerprint into
the content.
C. Collusion-resistant ﬁngerprinting codes
Nuida et al.’s c0-secure codes [8] are used in the system
for the generation of the collusion-resistant code. Nuida
et al. proposed a discrete distribution of state-of-the-art
collusion-resistant Tardos codes with a δ-marking assump-
tion (the number of undetectable bits that are either erased
or ﬂipped is bounded by δ-fraction of the total code length
m) to reduce the length of the codewords and the required
memory amount without degrading the traceability. The
tracing algorithm of Nuida et al. outputs one user with
the highest accusation score. The details of Nuida et al.’s
ﬁngerprint generation and traitor-tracing algorithms can be
found in [8].
D. PseudoTrust model
The PseudoTrust model proposed by Lu et al. [9],
based on a zero-knowledge proof-of-identity, is used in the
system to provide revocable anonymity and unlinkability
properties. The PseudoTrust model enables pseudonym-
based trust management such that the real identities of the
peers are protected during the authentication. In addition,
the communication between two peers is anonymized using
9
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-400-8
MMEDIA 2015 : The Seventh International Conferences on Advances in Multimedia

onion routing within the system. In the PseudoTrust model,
the pseudo-identities are generated by the peers without any
trusted third party, which leads to an accountability problem
in the system. Thus, to add accountability to our system, an
internal certiﬁcate authority (CAR) is incorporated in the
PseudoTrust model. Each peer is authenticated by CAR
before he/she joins the network. Hence, each peer has a
private key, a public key and a public-key certiﬁcate signed
by CAR. The details of generation of pseudo-identities and
anonymous authentication process are provided in [6].
E. Permutation
In the proposed system, the buyer’s security and non-
repudiation (merchant’s security) are provided by using the
concept of permutation. The permuted ﬁngerprint generated
by the monitor is permuted using different permutation keys
and is then assigned to a set of proxy peers Prj in such a
way that the merchant cannot predict about the ﬁngerprint
and the ﬁngerprinted content, and Prj are unable to frame
honest buyers by combining their information bits.
Fingerprint 
fi
Permutation 
key σj 
Permutation
2
9 4 19 6 13 8 21 10 5 12 17 14 7 16 23 18 15 20 27 22 3 24 25 26 11 28 1 30 29
1 2 3
4 5 6
7 8 9 10 11 12 13 14
16
18
20
22
24
26
28
30
15
17
19
21
23
25
27
29
1 0
1
1
1 0
0
0 0 1 0
1 0
0 0
0
0
0
0 0
0
1
1
1
0
0 1
0
0
0
1 2 3
4 5 6
7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
Permuted 
fingerprint
Inverse
Permutation
0 0
0
0
0 0
0
0 0 0 0
0 0
0 0
0
0
0
0 0
1
1
1
1
1
1 1
1
1
1
1 2 3
4 5 6
7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
0 0
0
0
0 0
0
0 0 0 0
0 0
0 0
0
0
0
0 0
1
1
1
1
1
1 1
1
1
1
2 9 4 19 6 13 8 21 10 5 12 17 14 7 16 23 18 15 20 27 22 3 24 25 26 11 28 1 30 29
Fingerprint 
fi
1 2 3
4 5 6
7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
Figure. 1: Permutation of a ﬁngerprint
Figure. 1 illustrates the permutation concept of a ﬁnger-
print in the system. Figure. 1 shows a ﬁngerprint fi of 30
bits, and a random permutation key σj of 30 elements. σj
is applied to fi such that the bit position 1 of the ﬁngerprint
corresponds to the bit position 2 of a permuted ﬁngerprint
(1 → 2), the second bit position corresponds to the bit
position 9 of the permuted ﬁngerprint (2 → 9), and so on.
On applying the inverse permutation key σ−1
j
to a permuted
ﬁngerprint, the original ﬁngerprint fi is obtained.
3 PROPOSED SYSTEM
This section describes the design and functionality of the
system. In Section 3-A, we deﬁne the role of each entity.
Section 3-B deﬁnes the functionality requirements and the
security assumptions.
A. System entities
The system involves seven entities and the function of
each entity is deﬁned as follows:
• A merchant M is an entity that distributes the copy-
righted content to the buyers in the P2P system. It is
involved in the ﬁngerprint generation, the ﬁle partition-
ing, the distribution of base and supplementary ﬁles,
the traitor tracing and the dispute resolution protocols.
• A buyer Bi is an entity that can either play the role
of data requester or provider. Bi is involved in the
registration protocol, acquisition of a base ﬁle (BF)
from the merchant, the distribution of a supplementary
ﬁle (SF) through the system, the ﬁle reconstruction
protocol and a dispute resolution, in case he/she is
found guilty of copyright violation.
• A super peer SP acts as a coordinator for a small
portion of the group of peers (buyers). However, in-
stead of peers’ addresses, their pseudonyms are stored.
SP facilitates Bi’s acquisition of BF from M, and SF
from the buyers present in the system.
• A Certiﬁcation Authority CAR is a trusted party that
is responsible of issuing certiﬁcates to the buyer for the
acquisition of BF from M, and SF from other buyers.
• A monitor MO functions as a trusted party, which
is responsible for the registration of buyers and mer-
chants, the generation of collusion-resistant ﬁngerprint
codes, the distribution of BF, the ﬁle reconstruction,
the traitor tracing and the dispute resolution protocol.
MO also acts as a bank that assists Bi to download
BF from M after making a payment. In addition, MO
manages the rewards and punishments mechanism in
the system.
• A proxy peer Pr is responsible for querying content
of BF available at M’s end with the pre-assigned bits
of a ﬁngerprint codeword and transferring the retrieved
content to Bi.
• A judge J is assumed to be a trusted party, which
resolves the disputes between M and Bi with the
cooperation of MO and CAR.
B. Design requirements and assumptions
In this section, the design requirements and security
assumptions of the system are described.
• Design Requirements:
- M should be able to trace and identify an illegal re-
distributor in case of ﬁnding a pirated copy with the
help of MO, J and CAR.
- The scheme should be collusion-resistant against a
given number of colluders c0 as speciﬁed by Nuida et
al. codes [8].
- The possible collusion of Prj should be unable to
frame an honest Bi. Also M should not be able to
frame an honest Bi of illegal re-distribution.
- A Bi accused of re-distributing an unauthorized copy
should not be able to claim that the copy was created
by M or a collusion of the proxies Prj.
- The real identity of a buyer should remain anonymous
during transactions unless he/she is proven guilty of
copyright violation.
- J, with the help of MO, should be able to resolve the
disputes without involving Bi in the process.
10
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-400-8
MMEDIA 2015 : The Seventh International Conferences on Advances in Multimedia

- The reconstruction of the original ﬁle from BF and
SF should be performed at the buyer’s end. BF cannot
be shared within the buyers of the system.
- The buyers should register to MO with a subscription
fee at a system start-up.
- The coin generated by MO should be revocable, thus
enabling MO to refund the money to Bi in case of
incomplete BF delivery to Bi.
• Security Assumptions:
- M and Bi do not trust each other but they both trust
MO.
- In order to deliver BF from M to Bi, MO selects a
ﬁxed number (n) of proxy peers. These proxy peers
follow each other in a sequential manner to transfer
BF to Bi from M.
- The permutation keys σj (for j = 1, . . . , n) are gen-
erated by Bi to perform permutation of a ﬁngerprint
codeword to be assigned to the proxy peers (Prj).
- Prj are not trusted and the content transferred
through them is encrypted.
- Each entity (M, MO, Prj, Bi, CAR, J) is supposed
to have a public key Kp, a private key Ks. Public-key
cryptography is restricted to the encryption of small-
length binary strings, such as symmetric session and
permutation keys.
- Before joining the system, Bi is authenticated by
CAR of the system. Once authenticated, Bi obtains
a private key and a public key certiﬁed by CAR.
CAR generates a random number r and shares it
with an authenticated Bi for the generation of a
pseudo-identity. Each buyer can have multiple pseudo-
identities.
- M is assumed to be registered with MO at a system
start-up.
4 MODEL
In this section, we detail the system designing and how
to motivate the proxy peers in the base ﬁle distribution
protocol to rationally play their corresponding roles.
A. Registration
Before joining the system, each buyer is assumed to
be authenticated by CAR and also the pseudo-identity
of each buyer is assumed to be generated (Section 3-B).
On joining the system, Bi sends a registration request to
MO with his/her pseudo-identity. On receiving the request,
MO veriﬁes the pseudo-identity of Bi from CAR. On
veriﬁcation, MO opens up an account of Bi and sends
him/her the details of the subscription fee payment. Bi
deposits the subscription fee and sends the signed payment
receipt to MO. MO acknowledges the payment, creates a
transaction identity TID in his/her database and generates
a digital coin CBi. Then, MO signs CBi and sends it to
Bi. M is also assumed to be registered with MO. Once
registered with MO, the buyers connect with SP to obtain
the multimedia content. In case the same buyer Bi joins
the system with another pseudo-identity, he/she must send
the old pseudo-identity to MO along with the new pseudo-
identity in the registration request. Figure. 2 illustrates the
registration protocol between MO and Bi.
1. Authentication request
2. Authenticated with a Pseudo-
identity 
3. Registration request
4. Verification request for Bi’s 
credentials
5. Bi’s credentials verified
6. Account opening
of PBi
7. Subscription fee payment request
8. Deposit
subscription fee
9. Signed payement receipt
10. Creates TID
against PBi and 
generates CBi
PBi
TID PBi
CBi
11. SignKpMO (CBi)
Monitor
(MO)
Buyer
(Bi)
CertificationAuthority 
(CAR)
CBi
Figure. 2: Registration protocol
B. Fingerprint generation
The algorithm for ﬁngerprint generation takes a pa-
rameter ε for error probability, the total number N of
users and c0 colluders as inputs, and outputs a collection
F = (f1, . . . , fN) of binary codewords (fi) of size m and a
secret bias vector p. The details of the ﬁngerprint generation
algorithm can be found in [8].
C. File partitioning
The DWT decomposition on a ﬁle results in approxima-
tion (a) and detail (d) coefﬁcients. The 3-level approxima-
tion coefﬁcients (a3) are used to imperceptibly embed fi
using a blind, robust and secure QIM-based watermarking
scheme. M uses a3 twice to create BF in such a way that
it employs an embedding algorithm to insert a codeword
of all ones into a3 and simultaneously using the same
embedding scheme embeds a codeword of all zeros into
a3. The two variants of a′
3 form BF in a binary form. The
detail coefﬁcients d are used to form SF. Figure. 3 shows
the partitioning of a multimedia ﬁle into BF and SF.
D. Base ﬁle distribution
When Bi requests SP for a particular content, SP pro-
vides Bi all the details of M having a requested content.
Before the transaction, Bi generates a one-time anonymous
key pair (K∗
pBi, K∗
sBi) and sends an anonymous certiﬁcate
request to CAR. On receiving an anonymous certiﬁcate
CertCAR(K∗
pBi, PBi) from CAR, Bi negotiates with M to
set-up an agreement (AGR) that explicitly states the rights
and obligations of both parties and speciﬁes the price and
the multimedia content (X). During AGR set-up, Bi uses
his/her pseudonym PBi and CertCAR(K∗
pBi, PBi). M veri-
ﬁes the received certiﬁcate from CAR and, on veriﬁcation,
generates a transaction ID (TID) for keeping a record of
11
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-400-8
MMEDIA 2015 : The Seventh International Conferences on Advances in Multimedia

Original Signal
X
Perform DWT Level-3/4 
Decomposition
Detail Coefficients
Supplementary File
SF
Inverse DWT of Detail 
coefficients
Approximation 
Coefficients
Embed code of all 1s in 
approximation coefficients 
using an embedding scheme
Embed code of all 0s in 
approximation coefficients 
using an embedding scheme
Base File
BF1
Base File
BF0
Permutation with σj
Permutation with σj
 Encryption with 
    Ksesj
 Encryption with 
      Ksesj
Figure. 3: File partitioning
the transaction between him/her and Bi. Then, M sends
a request for fi to MO by sending CertCAR(K∗
pBi, PBi),
CertCAR(M), AGR, PBi and SignK∗
pBi (AGR). MO val-
idates the certiﬁcates and signatures of M and Bi from
CAR. After veriﬁcation, MO generates a Nuida’s c0-secure
codeword fi of length m and randomly selects n proxy
peers Prj for the delivery of a ﬁngerprinted BF from M to
Bi. MO then sends a request of permutation keys σj to Bi.
Bi then generates n random σj of length l = ⌊m/n⌋. Bi
sends EKpMO (σj) to MO. MO decrypts EKpMO (σj) with
KsMO and obtains σj. MO generates n session keys Ksesj
and divides fi into n segments (sj) of length l and permutes
sj using σj in the same order as received by Bi. MO
then sends EKpM (σj)|EKpM (Ksesj) to M. M performs
permutation on both pre-computed variants of BF with σj.
It then encrypts the permuted variants of BF with Ksesj.
MO assigns contiguous permuted ﬁngerprint segments to
Prj, who then contact M in a sequential manner to obtain
the fragments of the encrypted and permuted approximation
coefﬁcients faj. M sends a set of encrypted and permuted
fragments of pre-computed coefﬁcients to Prj. Prj selects
the correct pre-computed approximation coefﬁcients from
the received coefﬁcients using the assigned permuted ﬁn-
gerprint segments.
E. Supplementary ﬁle distribution
Initially, SP is fed with SF by M. On joining the system,
a buyer constructs an onion path with existing peers, which
points to it and adds this path to SP of its group. By doing
so, a content requesting peer R can use this onion path
to contact the content-providing peer P while knowing
nothing about the provider’s identity. The peer requests for
a particular ﬁle to SP of its group. If found, it displays the
list of the peers having that particular ﬁle; else it sends a
request for the ﬁle to other connected SPs. The other SPs,
on ﬁnding the particular content provider, send the response
to the requesting SP. SP then establishes a path between R
and P. After receiving a positive reply from P, R initiates
a two-party authenticated key exchange (AKE) protocol to
authenticate each other identities and exchange the content
of SF anonymously. The details of SF distribution can be
found in [6].
F. File reconstruction protocol
On delivering faj to Bi, Prj generates a one-time hash
of faj, encrypts it with the public key of MO (h(faj))
and sends EKpMO (h(faj)) to MO. When Bi receives
faj from Prj, he/she also generates a one-time hash of
faj, encrypts it with the public key of MO (h(faj))
and sends EKpMO (h(faj)) to MO. MO stores h(faj) in
his/her database against TID that includes date, time, AGR
and pseudo-identities of Bi and M. On receiving all the
fragments of the BF from Prj, Bi sends a request for the
session keys from MO by sending him/her a signed digital
coin SignKpMO (CBi). MO charges Bi for BF and sends the
signed receipt and encrypted session keys EK∗pBi (Ksesj)
to Bi. MO puts CBi in spent-transaction database, credits
M’s account and sends the payment conﬁrmation to M. Bi
decrypts EK∗pBi (Ksesj) with his/her K∗
sBi , then decrypts
the received fragments of BF with Ksesj, and ﬁnally applies
the inverse σ−1
j
on the decrypted fragments of BF. Bi
recombines all the un-permuted and decrypted fragments to
form a single BF. Bi receives SF in parallel to BF through
P2P network. Once both ﬁles are available at Bi’s end, an
inverse L-level DWT is performed on the approximation
(embedded BF) and detail (SF) coefﬁcients to form a
ﬁngerprinted multimedia content X′.
G. Traitor tracing
Once a pirate copy Y of content X is found, M extracts
the pirated codeword pc by decomposing Y with the same
wavelet basis used in the ﬁngerprint embedding protocol.
This gives the approximation coefﬁcient matrix in which pc
is embedded. The watermark detection technique is applied
on the approximation coefﬁcient matrix to extract pc. Then
M sends pc to MO, which performs the tracing algorithm of
Nuida’s et al. codes to identify the colluder(s). The output
of this tracing algorithm is the buyer with the highest score.
The details of the tracing algorithm can be found in [8].
H. Dispute resolution
The goal of the dispute resolution protocol, performed
between M, MO, CAR and J, is to reveal the real iden-
tity of the traitor or reject the claims made by M. In
order to reveal the real identity of the traitor, MO sends
(Y , pc, KpMO(fi)) and M sends CertCAR(K∗
pBi, PBi),
CertKpBi (K∗
pBi ), AGR, K∗
PBi and SignK∗
pBi (AGR) to
J. J veriﬁes the validity of all the certiﬁcates and the
signatures. If valid, it asks MO to decrypt EKpMO (fi). If
pc and fi match with a high correlation, it requests CAR to
12
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-400-8
MMEDIA 2015 : The Seventh International Conferences on Advances in Multimedia

provide the real identity of the buyer. Otherwise, the buyer
is proved innocent.
I. Rewards and punishments
In an attempt to induce Prj to correctly follow the
BF distribution protocol, a reputation-based mechanism
is introduced for a proxy peer who delivers the content
correctly and honestly to the buyer or behaves maliciously
and deviates from his/her course of the BF distribution
protocol. MO is responsible for awarding or punishing a
proxy peer. The reputation of a proxy peer is calculated
using the following data: the collection of feedback about
Prj from each buyer after reconstruction of his/her multi-
media ﬁle, the collection of feedback about Prj from the
merchant after completion of the BF distribution protocol,
the collection of feedback about Prj from other peers
selected by MO for an anonymous BF delivery to a buyer
and the evaluation of the transaction history of each proxy
peer maintained at MO’s end.
Based on above parameters, MO calculates a score of
each proxy peer over a period of a time, e.g., one month,
in terms of positive and negative values. A proxy peer with
a positive score is rewarded with a discount coupon for
his/her future content purchases, whereas, a proxy peer with
a negative score is punished by MO in terms of money
deduction from his/her account and other penalties (e.g.,
black listing of proxy peer’s pseudo-identity). Thus, in
terms of game theory, the dominant strategy solution for
each proxy peer is to honestly and correctly follow the BF
distribution protocol.
5 SECURITY ANALYSIS
In this section, possible security and privacy attacks on
the protocols are discussed.
• Buyer’s security: The possible collusion of Prj can-
not frame an honest Bi and held him/her responsible
for illegal re-distribution due to the fact that Prj would
need to compute l! combinations each on the colluded
ﬁngerprint. Thus, with more m-bits in fi, Prj would
need to carry out an increased number of permutations,
which would be computationally infeasible. Also, if
all Prj combine their faj, they cannot decrypt these
fragments since the fragments can only be decrypted
with Ksesj, which are known only to M and MO and
ﬁnally to Bi after making the payment.
In another scenario, if Bi is unable to obtain all the
fragments from M through Prj, he/she can request
MO for digital coin’s revocability. Since MO keeps the
details of all the signed fragments sent by Bi, he/she
can accept or deny the request of Bi.
• Merchant’s security: From the perspective of M,
the system is secure because Bi has no idea about
the original digital content and the embedded fi in
the purchased copy. Also, Bi cannot claim that Y is
created by M since fi is generated by MO, which
is trusted by both Bi and M. Also a possible Bi
and Prj collusion is prevented by assigning the task
of selecting Prj to MO using a reputation-based
mechanism. Moreover, a claim made by Bi about
receiving invalid fragments from M is repudiated by
MO. MO could deny this claim since he/she stores
the hashes of faj sent by Prj and Bi in the ﬁle
reconstruction protocol. Thus, in case of a piracy claim
made by Bi, MO could compare the hashes received
from Prj with the hashes received from Bi. If the
hashes are not equal, MO can investigate to determine
the cheating party (either Prj or Bi).
• Unlinkability: Despite the fact that anonymous
certiﬁcates provide anonymity to Bi, the transactions
carried out by the same pseudo ID can be linked
to one another. The solution to this problem is to
allow a buyer to apply for multiple pseudonyms and
anonymous certiﬁcates.
• Coin integrity: The integrity of CBi is guaranteed
due to the signature of MO that generated that coin.
Such a signature cannot be computed by anybody else,
as the private key of MO is never disclosed.
• BF security: In case a malicious buyer E steals
BF from another buyer’s machine and requests his/her
SP for SF only, this security attack is withstood by
our system. After Prj deliver faj to Bi, both Bi
and Prj generate a one-time hash of faj, encrypt
it with KpMO and send EKpMO (h(faj)) to MO. MO
saves the received EKpMO (h(faj)) in his/her database
along with other transaction details. When E sends a
request to SP for SF only, then SP asks E to send
the chain of the encrypted hashes of the fragments of
the BF that he/she had sent to MO. In this scenario,
E has the BF but he/she does not have the chain of
the encrypted hashes of the BF fragments. In case
E generates fake hashes and sends it to SP, the SF
request from E would be denied due to veriﬁcation of
the hashes stored in MO’s database.
• Buyer’s
privacy:
The
attempt
of
de-
anonymization attack by E is withstood by the
collusion resistance of the hash function that is
used for generation of a pseudo-identity of a buyer.
Moreover,
E
cannot
use
the
pseudo-identity
of
another buyer because he/she does not know the
secret number r shared by the buyer with CAR.
Also, in the BF distribution protocol, an attempt
by M to ﬁnd an identity of the buyer by relating
proxies to each buyer is withstood by considering a
ﬁxed number n of Prj for BF delivery. Moreover, to
ensure anonymous BF delivery, MO selects random
peers and creates an anonymous path in such a way
that Prj are unable to predict that the next peer in
the path is the buyer or some other peer.
6 COMPARATIVE ANALYSIS
This section presents a comparative analysis of the pro-
posed system with [3]–[6] in terms of security, privacy and
13
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-400-8
MMEDIA 2015 : The Seventh International Conferences on Advances in Multimedia

performance. Table I presents the functionality comparison
among our proposed system and related P2P content dis-
tribution systems.
TABLE I: Comparison of the proposed system with related P2P content
distribution systems
Properties
[3]
[4]
[5]
[6]
Our
Scheme
Buyer’s security
Yes
Yes
Yes
Yes
Yes
Merchant’s security
Yes
Yes
Yes
Yes
Yes
Buyer’s privacy
Yes
Yes
Yes
Yes
Yes
Traceability
Yes
Yes
Yes
Yes
Yes
Unlinkability
Yes
Yes
Yes
Yes
Yes
Payment mechanism
Yes
Yes
No
No
Yes
Length of anti-collusion
codeword
Large Large N/A Small
Small
Computational complexity Low
Low High High
Low
From Table I, it can be seen that the proposed system
and the systems in [3]–[6] provide security against cus-
tomer’s rights problem (buyer’s security), non-repudiation
(merchant’s security), piracy tracing, unlinkability and
anonymity to a buyer. Our system and the systems in [3],
[4] provide an electronic payment protocol between a buyer,
a trusted monitor and a merchant in a centralized manner.
The systems in [5], [6] do not explicitly consider payment
by the buyers to the merchant. While the ﬁngerprinting
protocol in our proposed system and the system in [6]
are based on Nuida’s et al. [8] collusion-resistant ﬁnger-
printing codewords that result in small length ﬁngerprint
codewords, the systems in [3], [4] are implemented with
a two-layer anti-collusion code, which results in a longer
codeword. Authors in [5] have not considered the collu-
sion resistance of the scheme against collusion attacks.
The lower computational complexity of our system and
systems in [3], [4] is due to the fact that these systems
do not require highly demanding technology (public-key
encryption of the content and secure multi-party protocols,
among others) unlike the systems in [5], [6]. The proposed
system utilizes the idea of permutation and ﬁle partitioning
to avoid an increased computational costs at the merchant’s
end, whereas the systems proposed by [3], [4] provide
recombined automatic ﬁngerprints, which are generated as
contents are downloaded by the buyers from other peers of
the system.
7 CONCLUSIONS
In this paper, we have proposed a P2P content distri-
bution system, which provides security and privacy to the
merchant and the buyer, respectively. The newly proposed
scheme can beneﬁt merchants to distribute their contents
such as video ﬁles, without fear of copyright violation, us-
ing the convenience of P2P networks. This scheme reduces
the burden of the merchant by only sending a small-sized
base ﬁle and making use of the P2P network to support
the majority of the ﬁle transfer process. For distribution
of a base ﬁle, an asymmetric ﬁngerprinting protocol is
performed between the merchant, the proxy peers and the
buyer in the presence of a trusted monitor. The buyer’s
privacy is preserved until he/she is found guilty of illegal
re-distribution. The buyer can access the received base ﬁle
for ﬁle reconstruction once he/she makes a payment of
the requested content to the monitor. The reputation-based
mechanism enables the monitor to select the reputed proxy
peers for secure delivery of the ﬁngerprinted content from
the merchant to the buyer.
ACKNOWLEDGMENT
This work was partly funded by the Spanish Gov-
ernment through a project TIN2011-27076-C03-02 “CO-
PRIVACY”.
REFERENCES
[1] I. J. Cox, J. Kilian, T. Leighton, and T. Shamoon, “Secure Spread
Spectrum Watermarking for Multimedia,” IEEE Transactions on Im-
age Processing, vol. 6, no. 12, 1997, pp. 1673-1687.
[2] B. Pﬁtzmann and M. Schunter, “Asymmetric Fingerprinting,” Proc.
15th Annual International Conference on Theory and Application of
Cryptographic Techniques, EUROCRYPT96, Springer, 1996, pp. 84-
95.
[3] D. Meg´ıas and J. Domingo-Ferrer, “Privacy-aware Peer-to-Peer Con-
tent Distribution using Automatically Recombined Fingerprints,” Mul-
timedia Systems, vol. 20, no. 2, 2013, pp. 105-125.
[4] D. Meg´ıas, “Improved Privacy-Preserving P2P Multimedia Distri-
bution based on Recombined Fingerprints,” IEEE Transactions on
Dependable and Secure Computing, vol. PP, no. 99, 2014, pp. 1.
[5] J. Domingo-Ferrer and D. Meg´ıas, ”Distributed Multicast of Fin-
gerprinted Content Based on a Rational Peer-to-Peer Community,”
Computer Communications, vol. 36, no. 5, 2013, pp. 542-550.
[6] A. Qureshi, D. Meg´ıas, and H. Rif`a-Pous, “Framework for Preserving
Security and Privacy in Peer-to-Peer Content Distribution Systems,”
Expert Systems with Applications, vol. 42, 2015, pp. 1391-1408.
[7] B. Chen and G. W. Wornell, “Quantization Index Modulation: A Class
of Provably Good Methods for Digital Watermarking and Information
Embedding,” IEEE Transactions on Information Theory, vol. 47, no.
4, pp. 1423-1443, 2001.
[8] K. Nuida, “Short Collusion-secure Fingerprint Codes against Three
Pirates,” International Journal of Information Security, vol. 11, 2012,
pp. 85-102.
[9] L. Lu et al., “Pseudo Trust: Zero-knowledge Authentication in Anony-
mous P2Ps,” IEEE Transactions on Parallel and Distributed Systems,
vol. 19, no. 10, 2007, pp. 1-10.
14
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-400-8
MMEDIA 2015 : The Seventh International Conferences on Advances in Multimedia

