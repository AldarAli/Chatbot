Radio Resource Unit Allocation and Rate Adaptation in Filter Banks  
Multicarrier System 
 
 
Faouzi Bader  
Centre Tecnològic de Telecomunicacions de Catalunya-
CTTC. 
Av. Carl Friedrich Gauss 7, 08860 Barcelona-Spain.  
Phone: +34 936452901, fax: +34 936452901, e-mail: 
faouzi.bader@cttc.es 
Mohammad Banat 
 
Department of Electrical Engineering, Jordan 
University of Science and Technology (JUST)  
P.O.Box 3030. Irbid 22110-Jordan. Email: 
m.banat@ieee.org 
 
 
Abstract— In this paper, the effect of the effective channel gain 
and the SNR using the improved joint resource unit (RU) 
allocation and Bit loading (JRAB) on a filter banks 
multicarrier 
(FBMC) 
system 
are 
analyzed. 
Computer 
simulations have been performed assuming a hypothetical 
WiMAX scenario in which an FBMC system substitutes 
OFDM by maintaining as much as possible the physical layer 
compatibility. From obtained simulation results it has been 
demonstrated that it is possible to upper-bound the maximum 
delay for delay-sensitive applications (rtPS and nrtPS) using 
the above mentioned effective metrics in a FBMC system. 
 
Keywords-RRM; Filter bank; WiMAX; JRAB. 
I. 
INTRODUCTION  
Adaptive modulation is considered as one of the main 
techniques to increase the data rate that can be reliably 
transmitted over a fading channel. Many forms of adaptive 
modulation and transmission techniques have been proposed 
and implemented in recent wireless systems [1] [4] [5], 
however, adaptive bit loading is one of the key features of 
very recent wireless communication systems (i.e., WiMAX, 
etc), and its importance will increase in the near future (i.e., 
LTE). Adaptive modulation technique is possible thanks to 
adjustability of many system parameters according to the 
channel fading state variability, the transmit power, the data 
rate, and channel coding rate. 
Two adaptive approaches are widely considered in the 
scientific literature. The first one is the rate adaptation (RA) 
which has been treated in [1] and [2]. The RA approach is 
based on the bite error rate (BER) (or the packet error rate -
PER) which is bounded while the maximum throughput is 
attained by allocating different transmit powers into 
different users. The second approach is the margin 
adaptation (MA). The MA method is based on the use of 
minimum transmit power while the minimum required 
quality of service (QoS) is guaranteed. It is also possible to 
generalize the (multiuser) link adaptation process using 
either the RA or the MA objective functions. The outcomes 
of these adaptations are the resources assigned to each user 
in the time, frequency or space domains, the transmitted 
power per user, and the optimum modulation and coding 
scheme (MCS). Using an orthogonal frequency division 
multiplexing (OFDM) scheme [2] resources can be 
efficiently assigned to different users without the need to 
use guard bands or time gaps (when perfect synchronization 
between the mobile station (MS) and the base station (BS) is 
assumed). The whole frequency and time domains are 
segmented into different resource units (RU) which can be 
arbitrarily (or using specific policies) assigned to different 
users. The minimum RU is a single symbol, the resource 
allocation algorithm inputs are the channel state information 
(CSI) of all users, and the maximum allowed transmission 
power. The main considered output is the power and MCS 
assigned to each RU. 
To the best knowledge of the authors, this is the first 
time the radio resource unit allocation is treated using both 
the effective channel gain and the effective signal to noise 
ratio (SNReff) concept in a filter banks multicarrier (FBMC) 
system. The FBMC communication scheme has been 
subject of intense researches during last year’s mainly 
within the Information and Communications Technology 
(ICT) European project PHYDYAS (Physical layer for 
dynamic spectrum access and cognitive radio) [9].  
      The    remainder    of   this   paper  is   organized   as   the
following:  in  Section II,  the model and main features of the
used   FBMC   system   is  summarized.  In   Section  III,  the
expression  of the effective channel transfer functions of both
OFDM and  FBMC systems is derived,  and the resource unit
(RU)  capacity is  calculated in  Section IV. The  main results
obtained   by   simulation   are  presented  in  Section  V,  and
finally, main conclusions are outlined in Section VI. 
 
II. 
INTRODUCTION TO FBMC SYSTEM 
Filter banks multicarrier system can be realized via a 
digital transmultiplexer configuration, where a synthesis 
filter bank (SFB) is used at the transmitter side while an 
analysis filter banks (AFB) is used at the receiver side [3] 
[9]. In FBMC applications, the use of a critical sampled 
filter banks would be problematic, since the aliasing effect 
would make it difficult to compensate the channel 
imperfections’ effects by processing the sub-channel signals 
only after the AFB. Therefore, a factor of two oversampling 
is commonly applied into the sub-channel signals at the 
AFB [3].  
87
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

 
 
 
q 0,n
b 0,n
X
X
C2R
X
X
C2R
M/2
M/2
A0(z2)
AM-1(z2)
+
Z-1
X
X
C2R
M/2
A1(z2)
+
Z-1
IFFT
d 0,n
d 1,n
d M-
1,n
q 1,n
q M-1,n
b 1,n
b M-1,n
b
0,n
q
0,n
X
X
M/2
Z-1
M/2
Z-1
M/2
B1(z2)
B0(z2)
BM-1(z2)
FFT
X
X
Subch.
Proc.
Subch.
Proc.
Subch.
Proc.
X
X
Re
Re
Re
b
1,n
b
M-1,n
q
1,n
q
M-1,n
R2C
R2C
R2C
~d 0,n
~d 1,n
~
d M-1,n
OQAM
modulation
Transform 
block
Polyphase
filtering
P/S
conversion
S/P
conversion
Polyphase 
filtering
Transform
block
OQAM 
demodulation
(a)
(b)
 
Figure 1: Multicarrier polyphase filter banks for SISO case, a) Synthesis filter banks (SFB), b) Analysis filter banks (AFB 
 
In this paper, a uniform modulated filter banks is assumed 
where the prototype filter 
[ ]
p m  of length L  is shifted to 
cover the whole system bandwidth. The output signal from 
the synthesis filter bank is defined as in [3] by, 
2
1
,
,
,
0
[ ]
2
M
j
M km
k n k n
k n
k
n
nM
s m
d
p m
e

q
b












 
 
(1) 
where 
 
2
1
2
,
( 1)
k L
j
kn
M
k n
e

b


 
 
(2) 
 
where M  is the total number of subcarriers (IFFT/FFT 
size), 
d ,k n
 is the real-valued symbol (of rate 2 T ) 
modulated over the 
k-th
 subcarrier and the
n-th
 time 
symbol interval. The time signaling interval T  is defined as 
the inverse of the subcarrier spacing 
f
 . The symbols 
d ,k n
 
and 
,
dk n 1
  can be seen as the in-phase and quadrature (I/Q) 
components of a complex-valued symbol 
,
ck l
 (of rate 1 T ) 
chosen from a multilevel quadrature amplitude modulation 
(M-QAM) alphabet. Note that the sign of the sequence 


,
k n
k n
j
q


 sequence can be chosen arbitrarily, but the 
pattern of the real and the imaginary samples have to follow 
definition (1) and (2) to maintain (near) orthogonality [3] 
[9]. L  is the length of the prototype filter p[m] and is equal 
to the product of the filter bank size M  and the overlapping 
factor K  (L=KM) [3]. The “C2R” and “R2C” blocks 
depicted in Figure 1, indicate the conversion from complex 
to real form, and the inverse operation respectively. 
 
As it can be observed in (1), the synthesized signal is a 
composite of M  sub-channel signals each one is a linear 
combination of time-shifted (by multiples of 
T 2
) and the 
overlapped impulse response of the prototype filter weighted 
by the respective data symbol dk,n. When a real (imaginary) 
part of a subcarrier symbol is used (to carry an information 
symbol) the unused imaginary (real) part is at the receiver a 
fairly complicated function of surrounding data symbols 
effect. 
III. 
EFFECTIVE OFDM AND FBMC CHANNEL TRANSFER 
FUNCTIONS 
In order to obtain the optimal power and the bit rate 
adaptation we need the bit error rate (BER) expression in 
additive white Gaussian noise (AWGN) which is easily 
invertible in terms of bit rate and power. Unfortunately, for 
most of non-binary modulation techniques, e.g., multi-level 
QAM (MQAM), and multi-level phase shift keying (M-
PSK), an exact expression for the BER is hard to obtain. 
Often, the BER with Gray bit mapping at high SNRs can be 
approximated as the symbol error rate (SER) divided by 
number of bits per symbol [4]. The equivalent subcarrier 
approach developed by C. Tang et al., in [5] allows a group 
of subcarriers containing spread data symbols to be 
represented by a single equivalent subcarrier to handle the 
bit and power loading mechanism in a more compact and 
simpler way. 
To better understand this concept let first consider an OFDM 
system 
where 
the 
M-QAM 
bit 
error 
estimation 
approximation developed in [4] is used to obtain the BER of 
the -th
k
 equivalent subcarrier, 
 


 
2
,
2
1.6
0.2 
2
1
k
eff k
k
b
k
H
P
BER
exp



 









 
(3) 
where 
k
BER  is the approximate BER, 
2
,
Heff k
 means the 
square magnitude of the effective channel transfer function, 
k
P  is the transmit power atthe 
k-th
 subcarrier, 
k
b  is the 
number of transmitted bits, and 
 2
 is the additive white 
Gaussian noise (AWGN) power. Using this expression as 
equality instead of an approximation, the expressions for the 
assigned power and number of bits may be solved as in [4] 
by, 
88
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

 
 
 


2
2
,
2
1
  ln
 for 
0.2
0.2
1.6
k
b
ef
k
k
f k
k
BER
P
 
BER
H











 
(4) 
 
2
,
2
2
1.6
max
max log
1
ln
0.2
eff k
k
k
k
H
P
b
BER



















 














 
(5) 
Subject to: 
k
k
BER
 BER
 
Subject to: 
1
0
M
k
T
k
P
P




  
where 
BERk
 is the upper bound BER, and 
T
P
 is the 
maximum allowed total transmit power. Knowing the value 
2
,
Heff k
 of each active user, the number of bits that can be 
loaded without exceeding a certain BER threshold is 
estimated using (4), and it’s equal to,  
 
2
,
 
2
2 
1.6 
log
1
ln
0.2
e
k
ff k
k
k
B
H
b
ER
P








 















 
(6) 
 
The first step of the adaptation process is the calculation of 
the effective channel gain over the M  subcarriers and 
transmitted frames (such parameters will be fixed in the 
simulation section, e.g., by using WiMAX standard 
specifications [8]). For purpose of an easier comprehension 
we started calculating the effective channel gain of an 
OFDM system, and after the FBMC system.  
 
A. Calculation of Effective Channel Transfer Function: 
OFDM Case 
 
We assume the single user case, where the modulated 
data symbol of the active user at the -th
k
 carrier is 
k
S . By 
removing the cyclic prefix at the demodulator the 
k-th
 
received data symbol in frequency domain is, 
 
k
k
k
k
Y
S H



 
(7) 
where 
k
H  means the channel gain, and 
k
  is the AWGN 
component at the -th
k
 subcarrier index. After using a zero-
forcing (ZF) equalization, the enhanced noise term at the 
k-th
 subcarrier is given by the term
k
Hk

. We assume 
that the noise power is equally distributed over all the 
subcarriers with a value 
 2
. Therefore, the power of the 
enhanced noise term at -th
k
 subcarrier is 
2
2
Hk

. If we 
define 
*
E
k
s
k
P
S S




  as the total power transmitted by a 
single subcarrier, the instantaneous signal to noise ratio will 
be equal to: 
 
2
2 /
s
k
k
P
SNR
H


 
(8) 
The effective channel power attenuation for the modulated 
symbol is,  
 
2
2
,
eff k
k
H
 H
 
(9) 
Substituting (9) into (8) yields to the following  
 
2
,
2  
e f
k
s
f
k
P
SNR
H


 
(10) 
Knowing the CSI values, the base station (BS) can use the 
calculated power in (9) to define the bit and power loading 
values for transmission. Then the packet scheduler is in 
charge of formatting the symbols to fit into one or several 
RUs. The MCS of the burst frame is fixed based on the 
effective SNR (
SNReff
) of the sub-channel and the symbol 
where the burst is allocated. The effective SNR function 
(
SNReff
) is a function of different instantaneous SNRs, and 
is defined as, 
 


1
1
1
M
f
k
k
SNRef
M
SNR
















 
(11) 
B. Calculation of Effective Channel Transfer Function: 
FBMC Case 
 
In contrast to the OFDM scheme, where complex valued 
symbols are transmitted at a given symbol rate the FBMC 
transmits real symbols at twice the OFDM’s rate. Therefore, 
FBMC is a scheme that preserves the spectral efficiency and 
even allows the optimization of the carrier pulse shape 
according to the channel characteristics [3] [9]. 
Hereafter we assume the use of the Zero-Forcing 
equalization. The frequency-time pair ( , )
k n  denotes the 
subcarrier k  and symbol time n  (with 
T 2
spacing time) 
position respectively within a a transmitted frame (see 
Figure 2). In FBMC, every frequency-time position suffers 
interference from neighboring sub-channels (Figure 2). For 
an ideal channel this interference affects only the sub-
channels of the imaginary symbols, while the real part of the 
symbols yields the originally transmitted symbol Sk,n. Note 
that this interference could be considered as a (sometimes 
close to zero) random variable that depends on the 
transmitted symboles around the symbol position (k,n). 
From (1) and (2), and with some mathematical arrangements 
we obtain in (12) the received FBMC signal expression  
 
 

 

,
,
,
,
,
,
,
,
,
p q
p q
p
k n
k n k n
k n
k n
q
p q
y
H
S
j
H
w
S






 
(12) 
where the {wp,q} values are the constant filter banks 
coefficients depicted in Table I, their effect constitute the 
main interference component in (12) (right summation 
value) on every transmitted data symbol.  
89
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

 
 
k
k-1
k+1
n
n+1
n-1
t
f
Sk,n
frequency
time
 
Figure 2: First time order neighbors in time-frequency representation for 
PHYDYAS FBMC system [9]. 
 
TABLE I.  
TRANSMULTIPLEXER RESPONSE OF THE FBMC SYSTEM 
USED IN PHYDYAS PROJECT [9]. ROWS REPRESENT TIME DIRECTION AND 
THE COLUMNS THE FREQUENCY DIRECTION 
 0.0006 
0.0001 
0 
0 
0 
0.0001 
0006 
- 0.0429j 
0.1250 
0.2058j 
0.2393 
0.2058j 
0.1250 
0.0429j 
-0.0668 
0.0002 
0.5644 
1.000 
0.5644 
0.0002 
0.0668 
0.0429j 
0.1250 
0.2058j 
0.2393 
0.2058j 
0.1250 
0.0429j 
0.0006 
0.0001 
0 
0 
0 
0.0001 
0.0006 
 
The neighborhood set of positions that affects a given 
frequency-time (k,n) position of a transmitted symbol is 
defined as, 




,
,
,
,
,
,
, 
 
k
n
k
p n q
k n
p q
p
k q
n H
H
 




 
 

 
(13) 
We define the set 
*
,k
 n
 such that 
*
,
,
( , )
k
n
k
n
k n
 
 

 

. 
Note that both k and n should be chosen taking into 
account the channel time coherence
c
T , and the bandwidth 
Bc. It is worth mentioning that when Bc decreases the value 
of k also decreases. The same can concluded for 
c
T  and 
n. Having a well-dimensioned real system, Bc encompass 
few subcarriers (
1
k
  ) while Tc is generally larger than T  
(
1
n
  ). This allows us to rewrite the received signal in 
(12) using zero-forcing (ZF) equalization as,  




*
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
 
 
k
n
k
n
k n
k n
k n
k
p n q
k
p n q
k
p n q
k n
p q
k
p n q
k n
k
p n q
k
p n q
k n
k n
p q
y
S
H
H
j
w
S
H
H
j
w
S
H
H

























 
(14) 
 
If we consider that the generated filter banks prototype is 
well-localized 
in 
time 
and 
frequency 
domain, 
we 
consequently have  




,
*
,
,
,
,
,
,
,
,
,
,
,
 
k
n
k
n
k
p n q
k
p n q l
p n q
k n
p q
k
p n q
k
p n q
k
p n q
k n
p q
H
w
S
H
H
w
S
H




















 
 (15) 
 
Therefore, (14) can be rewritten as (see weights’ value at 
columns 2 and 6 in Table 2) 


*
,
,
,
,
,
,
,
,
,
,
,
k
n
k
p n q
k n
k n
k n
k
p n q k
p n q
k n
k n
k n
p q
H
y
S
j
w
S
H
H
H














 
 
(16) 
using 

*
,
,
k
k
p q
 
 as the summation range in (16) means 
that we can approximate the channel gain at (
,
)
k
p n
q


 
position by that experienced at (k,n). Therefore, using the ZF 
equalizer the received symbol at the k-th sub-carrier and n-th 
time is equal to, 


*
,
,
,
,
,
,
,
,
ˆ
k
n
k n
k n
k n
k
p n q k
p n q
k n
p q
S
j
w
S
S
H












 
(17) 
,
,
,
ˆk n
k n
k n
S
S
jI


 
(18) 
From (15), the enhanced noise term after equalization is 


*
Δk,Δn
,
,
,
,
,
,
Ω
 
k n
k n
k
p n q k
p n q
k n
p q
I
w
S
j H









 
(19) 
where the power term here is, 
*
,
2
*
2
,
,
,
,
2
( , )
,
E
k
n
k n k n
k
p n q k
p n q
p q
k n
I
I
w
P
H









 




 
(20) 
If 
2
,
,
k n
k n
P
 S
 is the total transmitted power by a single 
carrier, then, the instantaneous signal to noise ratio is 
 


*
,
2
,
,
,
2
2
2
,
,
,
,
 
k
n
k n
k n
k n
k n
k
p n q k
p n q
p q
P
H
SNR
H
w
P











 
(21) 
where 
,
k
P  p n q

 is the total transmitted power by each 
symbol belongs to the set 
*
,k
 n
. From (20), it can be seen 
that the effective power for the modulated symbol is: 
 


*
,
2
2
,
, ,
2
2
,
,
,
,
2
1
k
n
k n
eff k n FBMC
k n
k
p n q k
p n q
p q
H
H
H
w
P








 





 








 
(22) 
Then the SNReff is calculated and is equal to,  
 
2
,
, ,
, ,
2
 
k n  
eff k n
eff k n FBMC
P
SNR
H
 
 
(23) 
Note that 
2
, ,
Heff k n FBMC
 has a random behavior as it’s 
strongly 
dependent 
of 
the 
interference 
part 


*
,
2
,
,
,
k
n
k
p n q k
p n q
p q
w
P


















.  
90
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

 
 
IV. 
FBMC RESOURCE UNIT ALLOCATION USING THE 
SNReff 
 
In 
time 
division 
duplex 
(TDD) 
approach 
the 
communication frame consists on Ns symbols of duration 
Tframe seconds. The numbers of downlink and uplink 
OFDM/FBMC symbols usually follow the ratio 2:1 or 3:1. 
However, this parameter can be adjusted at the BS according 
to user demands and the available resources. The total 
system bandwidth BW  consists of Nc subcarriers where 
only a limited number equal to Nused are active, while the 
remaining carriers are used as guard tones. Active 
subcarriers include both pilot subcarriers and data 
subcarriers, which will be mapped over different sub-
channels according to specific subcarrier permutation 
schemes.  
 
DLMAP + ULMAP
FCH
SYNC PREAMBLE
Time symbols  <    >
Burst #1
Burst #3
Burst #2
Burst #4
Burst #5
Downlink subframe (Ns Time symbols)
UPLINK SUBFRAME 
 
RTG
TTG
Nc subchannels
RU 
Burst
Nsc
Nst
Ns 
 
Figure 3: FBMC frame in TDD mode like burst structures based on IEEE 
802.16e standard [8]. 
 
For the full usage of subcarriers (FUSC) scheme, pilot 
subcarriers are allocated first, and the remainders are 
grouped into sub-channels, where the data subcarriers are 
mapped. On the other hand, in partial usage subcarriers 
scheme (PUSC), and in adjacent subcarrier permutation 
schemes (usually referred as band AMC) map first all the 
pilots and the data subcarriers into the sub-channels, and 
therefore, each sub-channel contains its own set of pilot 
subcarriers.  
 
For the FUSC and PUSC modes, the assigned subcarriers 
to each sub-channel are distant in frequency, whereas for 
AMC scheme the subcarriers belonging to one sub-channel 
are adjacent. Note that both FUSC and PUSC increase the 
frequency diversity and average the interference effect, 
whereas the AMC is more convenient for bit loading and 
beamforming as an increase in multiuser diversity is 
demanded. As depicted in Figure 3, and similar to WiMAX 
standard [8], the minimum RU assigned to any data stream 
within a frame has a two dimensional shape constructed by 
at least one sub-channel and two symbols1. 
  
                                                           
1 one OFDM symbol in case of OFDM scheme 
We define a RU as a resource unit formed by a set of 
sc
st
N
 N
 subcarriers and FBMC symbols, respectively. 
Once the size of the RU is defined it’s possible to obtain the 
total number of RUs per frame Q T

, where 
c
sc
Q
N
N

 is 
the number of sub-channels and T=Ns/Nst is the number of 
time slots. Note that both the RU and the data region always 
follow a rectangular shape structure. In the IEEE 802.16 
standard, the specific size of the RU varies according to the 
permutation scheme, concretely for the AMC scheme the 
RU may take the sizes; 9×6, 18×3 or 27×2, where one ninth 
of the subcarriers are dedicated to pilots [8]. By analogy, and 
taking into account that the OFDM symbol duration is twice 
that of the FBMC symbol (Figure 2) for the AMC scheme, 
the FBMC RU may takes the sizes 9×12, 18×6 or 27×4.  
 
The effective SNReff for FBMC is given by (23). The 
effective SNR merges the SNR from the different 
subcarriers, i.e., in a sub-channel or in a burst. Therefore, the 
BER, the packet error rate or the channel capacity can be 
obtained directly by assuming an AWGN channel from an 
equivalent SNR equal to the SNReff. The power is assumed 
uniformly distributed over all the subcarriers. Therefore, the 
effective channel gain can be obtained via the geometric 
mean of the subcarriers gain (considering the FBMC 
structure in the capacity calculation described in [4]) the 
total capacity CRU within each RU is calculated by 
 
 
2
2
2
1
1.6
 
 
log
1
ln
0.2
Nst
eff
RU
sc
i
H
SNR
C
f N
BER









































 
(24) 
where 
2
Heff
 is the geometric mean of the effective channel 
experienced over each i={1,2,…, Nst/2}, and the SNReff  is 
the geometric mean of the SNR values over all the 
Nsc
 sub-
channels of the RU unit. 
 
For the resource allocation scheduling we used the 
improved Joint RU Allocation and Bit Loading (JRAB) by 
Scheduling described in [11], where two competing aspects 
exist during the RU allocation and the scheduling process. 
These are 
 
 
the guarantee of the different service QoS 
constraints, and 
 
the maximization of the spectral efficiency. 
 
The packet scheduling functions described by Shakkottai et 
al. in [10] maximize both the spectral efficiency (therefore 
the bit loading) and the delay effect based on the CSI values. 
Furthermore, according to described functions in [10] the 
prevalence of the channel over the distribution of the RUs 
(to maintain the QoS) or the opposite is difficult to assure. 
From a system administrator perspective, this approach 
91
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

 
 
might be difficult to implement, and furthermore, it has been 
shown that when the physical layer is in charge of the bit 
allocation process of each active user the spectral efficiency 
increase [6]. For these reasons, the scheme proposed in [10] 
has tackled the problem from a different perspective. It is 
usually unavoidable that the packets might be fragmented to 
fit into the physical layer burst.  
 
We assume in this paper that any packet can be arbitrarily 
fragmented as many times as necessary (obviously this will 
affect the spectral efficiency due to the fragmentation of 
headers). Based on this assumption, and assuming that each 
packet is delivered within a certain time interval (no matter 
which class of service it belongs to, with either constant bit 
rate (CBR) or variable bit rate (VBR) [10]), by following the 
development in [12], we can obtain the minimum number of 
bits 
( )
k
b u
 that the system should assign to each active FBMC 
user during each frame by 
 


 
( )
( )
frame
( )
( )
1
frame
( )
)
,
( )
1
(
,
if 
,
otherwise
P
p
u
u
max
p
u
u
p
max
p
P
p
u
u
p
m
u
u
k
u
i
a
p
p
p
x
L
T
L
T
p
b
L
















 





 





 















 
(25) 
 
where Tframe is the frame time period (in seconds), and 
( )
u
Lp
 is 
the number of bits still queued from the 
p-th
 packet. Then, 
if 
( )
k
b u
 bits are allocated during each frame to each active 
user u  and the k-th RU, the delay is certainly under its upper 
bound. Note that if any p  packet has waited period more 
than 

( )
u
max
 
 all the remained bits of the packet will be 
considered for transmission in the following frame. 
The RU allocation and the bit loading problem can be solved 
for the a minimum rate 
( )
R u
 based on the allocated bits 
( )
k
b u
 as defined in (25). 
( )
k
b u
 is also used to determine the 
priority assigned to each user within each RU. Hence, for the 
k-th
 sub-channel of the 
u-th
 user the hereafter priority 
assignment is defined as  


( )
( )
( )
max
max
max
( )
( )
urgency
max
( )
min
,1
,
 if  
 
 
 
 
   
 
, otherwise                                    
u
k
k
p
u
u
u
u
k
k
u
b
p
b
P



















 





 



 (26) 
 
where 
bmax
 is a normalization factor and is equal to the 
maximum number of bits that can be transmitted within a 
frame using the highest MCS scheme. Furthermore, when a 
packet from the -th
u
 user/service flow is close to exceed its 
maximum delay, the term 
( )
max
k
b u
b
 in (26) is substituted by 
an urgency factor Purgency, which is a fixed constant 
satisfying 


urgency
1
min
max
P




inequality. As a result, 
the packets close to their maximum delay are put ahead in 
the allocation process in order to avoid the packet drops due 
to the excessive packet delay. The 
( )
k
 u
 is the achievable 
throughput or the rate from the -th
u
 user on the -th
k
 RU, 
which is obtained based on the SNReff and the available 
MCSs. 
V. 
SIMULATION RESULTS 
Table II summarizes the simulation parameters used to 
verify the results of the RU allocation using the JRAB for 
FBMC system. 
TABLE II.  
FBMC 
AIR 
INTERFACE 
AND 
SYSTEM 
LEVEL 
CONFIGURATION PARAMETERS 
Parameter 
Values/ Quantities 
Carrier Frequency, Bandwidth 
3.5GHz, 20MHz 
Sampling Frequency 
22.857Msps 
Subcarrier Permutation 
Band AMC 
FFT Length 
2048 
# of Used Subcarriers 
1728 
# of Subcarriers per Sub-Channel 
18 
# of FBMC Time Symbols per RU 
6 
# of Data Symbols per RU 
48 
Modulation  
{4,16,64}-QAM 
Channel Coding 
Punctured Convolutional 
with coding rates1/2, 2/3 
Channel Model 
Pedestrian B 
MS Velocity 
10Km/h 
Channel Estimation and CQI 
Ideal 
Shadowing Standard deviation 
5dB 
BS Transmit Power 
49dBm 
 
Figure 4 shows the cumulative density function of the packet 
delay for 50 and 100 active users. Let first focus on the case 
when the number of users is K=50. Figure 4 demonstrates 
that all the schemes achieve a delay lower than the 
maximum (50ms), in fact the 99th percentile is achieved at 
25ms using the JRAB procedure and for the PFS 
(Proportional Fair Scheduler) [12]. Furthermore, the packet 
loss rate performance for each scheme is almost zero for the 
JRAB, and about 1.610-5 for the PFS.  
For the case K =100, we can observe that the PFS is the 
algorithm that achieves the lower packet delays whereas the 
JRAB sends the packets mainly when the urgency factor is 
applied. During the simulations, the guard time  is fixed 
equal to 
( )
max
0.2
 u
, and thus the urgency factor is activated 
when 


( )
m
(
a
)
x
 
0.4 ms
u
u
p



 


. Now, for K =100 the 
packet loss rate for each scheduling function and bit loading 
procedure is 0.0824 and 0.1375 for the JRAB and the PFS 
respectively. Therefore, although most of the packets are 
sent when they are near to expire with the JRAB, a lower 
packet loss rate is achieved. 
 
92
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

 
 
0
0.01
0.02
0.03
0.04
0.05
0.06
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Cumulative Density Function
Packet Delay [s]
Real-time traffic, VBR
JRAB, K=50
JRAB, K=100
PFS, K=50
PFS, K=100
 
Figure 4: Cumulative density functions of the packet delay for the PFS, and 
JRAB algorithms with K=50 and 100 active users 
 
 
Figure 5: Cumulative density functions of the packet delay for the JRAB 
algorithm with mixed traffic and K=50 users. 
The performance of the JRAB in case of mixed traffic is shown 
in Figure 5. In this scenario K=50 users are simulated, where 
ten users require non-real time test service (nrtPS), 13 users 
require real-time test service (rtPS), ten users are browsing 
internet files (World Wide Web service), five users are 
downloading files using the File Transfer Protocol (FTP), and 
12 users require UGS connections for applications such as 
Voice over IP. The delay for the www and the FTP services has 
been assumed as max=60s and max=90s respectively.  
It is clearly shown in Figure 5 that each traffic type achieves a 
maximum packet delay lower than its defined maximum value. 
The 99th percentile for the delay sensitive applications is found 
to be 100ms, 35ms and 20ms for the nrtPS, the rtPS and the 
UGS, respectively, much lower than the fixed maximum values. 
VI. 
CONCLUSION AND FURTHER WORK 
The analysis of using the effective channel information and the 
SNReff metrics in each RU using the JRAB algorithm has shown 
that it is possible to upper-bound the maximum delay for delay 
sensitive applications (rtPS and nrtPS) in a FBMC system. This 
was achieves despite the interference effect experienced at each 
subcarrier (or sub-channel) (k,n) position due to the proper 
characteristics of filter banks prototype. Besides the higher 
achieved efficiency by using FBMC compared to OFDM ([3] 
[7]), it is even possible to obtain an extra spectral efficiency 
margin by exploiting the multiuser diversity on those 
unallocated resources. Future works will be focused on 
evaluating the effect of having partial CSI information on the 
assignment of the RU in the FBMC system. 
REFERENCES 
[1] A. Czylwik, “Adaptive OFDM for Wideband Radio Channels” 
IEEE Global Communications Conference (GLOBECOM’96), 
Vol 1, pp.713-718, Nov 18-22, 1996. London, UK. 
[2] S. Vishwanath, S. A. Jafar, and A. Goldsmith, “Adaptive 
Resource allocation in Composite Fading Environments,” 
IEEE Global Communications Conference (GLOBECOM 
2001), Vol2, pp-1312-1316. San Antonio, Texas. USA. Nov 
25-29, 2001. 
[3] M. G. Bellanger, “Transmit diversity in multicarrier 
transmission 
using 
OQAM 
modulation,” 
International 
Symposium on Wireless Pervasive Computing (ISWPC-
2008), pp. 1430 - 1469 Santorini (Greece), May 2008.  
[4] S. T. Chung and A. J. Goldsmith, “Degrees of Freedom in 
Adaptive Modulation: A Unified View”, IEEE Transactions 
on Communications, Vol. 49, Nº 9, pp. 1561-1571, September 
2001. 
[5] C. Tang and V. J. Stolpman, “Multiple User Adaptive 
Modulation 
Scheme 
for 
MC-CDMA,” 
IEEE 
Global 
Communications Conference (Globecom’04), pp. 3823-3827. 
Dallas, Texas-USA. 29th Nov to 3rd Dec 2004. 
[6] I. Gutierrez, F. Bader, and J. L. Pijoan, “Radio Resource 
Allocation in MC-CDMA Under QoS Requirements”. Book 
title: Multi-Carrier Spread Spectrum 2007. Chapter 5: 
Adaptive Transmission, pp. 207-216. Editors: S. Plass, A. 
Dammann, S. Kaiser and K. Fazel, Ed. Springer © 2007. 
ISBN: 978-1-4020-6128-8. Netherlands. 
[7] M. Shaat and F. Bader, “Power Allocation and Throughput 
Comparison in OFDM and FBMC Based Cognitive Radio”, 
22nd Meeting of the Wireless World Research Forum 
(WWRF'2009), Paris, France. May 2009. 
[8] IEEE 
802.16e-2005, 
“IEEE 
standard 
for 
local 
and 
Metropolitan Networks. Part 16: Air Interface for Fixed and 
Mobile Broadband Wireless Access Systems, amendment 2: 
Physical and Medium Control Layers for Combined Fixed and 
Mobile Operation in Licensed Bands and Corrigendum 1”. 
Feb 2006. 
[9] PHYDYAS 
European 
project 
ICT–211887, 
www.ict-
phydyas.org. (visited 31st January 2011) 
[10] S. Shakkottai and A. Stolyar, “Scheduling for Multiple flows 
Sharing a Time-Varying Channel: The Exponential Rule”, 
Analytic Methods in Applied Probability. In Memory of 
Fridrih Karpelevich. Yu. M. Suhov, Editor. American 
Mathematical Society Translations, Series 2, Volume 207, pp. 
185-202. American Mathematical Society, Providence, RI, 
2002. 
[11] I. Gutiérrez, F. Bader, and J.L. Pijoan, “New Prioritization 
Function for Packet Data Scheduling in OFDMA Systems”, 
IEEE Radio and Wireless Symposium 2009 (IEEE RWS’09), 
pp. 405-408. San Diego, USA, Jan. 2009.  
[12]  I. Gutiérrez, F. Bader, R. Aquilué, and J. L. Pijoan, 
“Contiguous Frequency-Time Resource Allocation and 
Scheduling for Wireless OFDMA Systems with QoS 
Support”, EURASIP Journal on Wireless Communications 
and 
Networking, 
Vol. 
2009, 
Article 
ID 
134579, 
doi:10.1155/2009/134579. June 2009. 
93
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

