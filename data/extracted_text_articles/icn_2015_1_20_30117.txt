Fine Angle Estimation Using Weighted Average-ESPRIT for Radar-based WSN
Sangdong Kim, Yeonghwan Ju, Daegun Oh, Jonghun Lee
Daegu Gyeongbuk Institute of Science & Technology
Advanced Radar Technology (ART) Lab., Robotics System Research Division
Daegu, the republic of Korea
e-mail: kimsd728@dgist.ac.kr, yhju@dgist.ac.kr, dgoh@dgist.ac.kr, jhlee@dgist.ac.kr
Abstract—This paper proposes a fine angle estimation using
weighted
average-estimation
of
signal
parameters
via
rotational invariance techniques (ESPRIT) for radar-based
WSN. The proposed WA-ESPRIT system is composed of a
weighted average block and an ESPRIT block. The proposed
system is verified through analysis, simulation and experiment.
We show that the proposed system has better performance
than the conventional one. The performance of the proposed
algorithm is verified through Monte-Carlo simulations in an
additive white Gaussian noise (AWGN).
Keyword-radar-based WSN; Monitoring system; Weighted-
average scheme; ESPRIT.
I.
INTRODUCTION
Historically, surveillance systems have used infrared,
acoustics and magnetics for passive sensing, and optics and
ultrasounds for active sensing, but radio detection and
ranging (radar) has been conspicuously absent. Conventional
radar systems such as the pulse Doppler radar and the
frequency
modulated
continuous-wave
(FMCW)
radar
employ transmitted and reflected microwaves to detect,
locate, and track objects over long distances and large areas.
Due to its ability, radar has found applications in defense and
remote
sensing.
However,
widespread
commercial
applications
of
the
radar
have
been
limited
because
conventional systems are expensive, bulky and difficult to
use. The radar motion sensors which have a short range and
poor false alarm rates is used in unstructured environments
such as traffic monitoring and police radar [1]. Since many
wireless sensor networks (WSN) operate in unstructured
environments
with
limited
energy
supplies,
these
conventional sensors are unsuitable for WSN. The FMCW
radar is mostly used to gather traffic data information such as
lane position and for radar-based WSN because the radar
detects the angle between the target and the radar. The
advantage of the FMCW radar is to obtain simple hardware
architecture, lower peak level and low-cost comparing with
pulse radar [2].
Among
various
estimated
parameter
such
as
distance and angle in radar detectors, the angle estimation is
focused because the angle error is directly depended on the
lane detection of the vehicle. Conventional angle estimation
method show that parametric methods such as MUSIC,
estimation of signal parameters via rotational invariance
techniques (ESPRIT) and matrix pencil (MP) are used for
super-resolution
frequency
estimation
algorithms
[3-5].
However, since conventional super-resolution method has
assumed a lot of antenna arrays, the conventional one cannot
operate well in case of a few arrays such as 2 or 3 arrays.
Therefore, we propose weighted average (WA)-ESPRIT for
low complexity realization of high resolution radar-based
WSN. This paper is organized as follows. In Section 2, we
introduce the system model for FMCW radar. Section 3
proposes WA-ESPRIT for the angle estimation, while
Section 4 discusses the performance analysis of the WA-
ESPRIT radar based on various parameters. Section 5 shows
the simulation results for WA-ESPRIT radar and Section 6
shows experiments to testify the effectiveness of the
proposed estimation. Finally, Section 7 concludes our
proposed estimation with high resolution under real channel.
II.
SYSTEM MODEL
The signal model of FMCW radar is expressed in this
section. The transmitted FMCW chirp signal can be
represented by
2
exp
(
)
for 0
( )
.
2
0
elsewhere
s
c
sym
j
t
t
t
T
s t










 





 





(1)
where ωs denotes the start frequency, ωc denotes the carrier
frequency, μ is the rate of change of the instantaneous
frequency of a chirp signal, and Tsym is the duration of chirp
signals. The relation between the bandwidth of FMCW
transmitted signal and μ is expressed by ωBW=μTsym.
TSym
(a) Transmitted signal
TSym
(b) Dechirping signal of received signal
Figure 1. The signal scheme of FMCW radar signal
Consider M targets receiving at K antenna arrays.
Let ϕm and τm denote the angle and delay of target of the m-
8
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks

th target. The received signal at each antenna array can be
represented by




1
0
2
( )
exp
1 sin
( )
M
k
m
m
m
k
m
r t
a
j
d k
s t
w t

















(2)
where am denotes the complex amplitude for the m-th target,
λ denotes the wave-length of the carrier signal, d is the
spacing between the adjacent antenna elements, and wk(t) is
the additive white Gaussian noise (AWGN) signal at the k-
th antenna element.
In FMCW radar, received chirp signals can be
easily transformed into the sinusoidal waveform by de-
chirping as shown in Figure 1. Omitting AWGN signal, the
sinusoidal signals of the received signal can be represented
by
 
1
2
0
2
exp
sin
exp
2
M
k
m
m
m
m
c m
m
y
t
a
j
dk
j
t





 

























. (3)
After analog-to-digital conversion (ADC), the discrete time
model of (3) satisfying Nyquist sampling can be derived by
yk[n]=yk(nTs) for n=0,...,N-1.
III.
WEIGHTED AVERAGE - ESPRIT
In this section, we show that the WA-ESPRIT is employed
for the fine distance estimation of the received signal and
that the proposed estimator combines the ESPRIT with a
weighted average scheme by considering the signal-to-noise
ratio (SNR) of the received signal.
A.
ESPRIT
The ESPRIT can be represented as follows. Let Y=[y1
[n],..., yK [n]]T can be a set of snapshots from K antenna
arrays. Then, autocorrelation matrix Rk can be expressed by
1
0
N
H
n

R  
YY
(4)
The eigenvalue decomposition (EVD) of the autocorrelation
matrix R has the form given by

*
0
(
)
*
(
)
1
N M
N M
N
N
M
N
N
M
L










 







 
 
 








S
R
S
G
G

where signal eigenvector matrix S=[s0, …, sM-1] contains M
eigenvectors
which
span
the
signal
subspace
of
the
correlation matrix, noise eigenvector matrix G=[g0, …, gN-M-
1] means N-M eigenvectors spanning the noise subspace of
the correlation matrix and λn denotes a n-th eigenvalues of
the correlation matrix. The largest M eigenvalue λ0,…,λM-1
correspond to the M eigenvectors of S. The other eigenvalue
λM … λL-1 correspond to the eigenvectors of G such that λM =
…= λL-1=σ2. Let us define S1 and S2 matrix, which is S1=[Im-1
0]S and S2=[0 Im-1]S. The sub-matrices, which showed in
[11] , are factorized by
1
1
2
1
1
and


S = A C
S = A DC
S

where A1=[Im-1 0]A, D=diag[δ0,…,δM-1], δm denotes the
frequency of the transformed sinusoid for the m-th path (i.e.
δm=ߤ߬mTs),
-1
  C DC
and
C
denotes
the
non-singular
transformation matrix of M by M. So  has the same
eigenvalues as D.  is uniquely determined given by
 
*
-1
*
1
1
1
2
(S
S ) S
S 
Among the number of  , the first angle estimate is found by
1
1
1
ˆ
sin
(
(
v ))






where
( )
 
means the phase angles for a complex signal
and 1v are first eigenvalue of  .
B.
Weighted Average Scheme
From (3), when the channel is not varied in processing
time,
the
WA-ESPRIT
exactly
estimated
the
angle
frequency that is affected by noise. When the power of the
received signal is applied to weighted average scheme, the
proposed WA-ESPRIT has better performance.
To estimate a frequency that is affected by noise, a
weighted average angle frequency is expressed using
1
0
ˆ
ˆ
ˆ
L
WA
i i
i

 




where
i
 denotes the signal power of i-th received signal,
ˆwa

is the proposed angle estimation result.
IV.
PERFORMANCE ANALYSIS OF THE WA-ESPRIT
RADAR
This section analyzes the performance of the WA-ESPRIT
radar. When the receiver is assumed to be perfectly received
without unwanted frequency, the detection probability of the
coherent receiver can be given by Equation (10) and (11) [5].
( (
)
)
D
FA
P
Q Q P
N SNR



(10)
2
1
1
exp(
)
2
2
x
Q
t
dt





(11)
where PFA and PD denote the false alarm rate and detection
probability, respectively. In order to evaluate the detection
probability of the proposed radar receiver, we assume that
the FFT and the square block of received signal have same
distribution characteristics as those of the square of the
Gaussian random variable. If received signal represents noise
9
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks

alone, then the probability density functions of noise can be
calculated at the receiver as




2
( /2) 1
/2
0
/2
1
1
2
2
n
D
k
k
n
n
p
y
y
e
n






(12)
where the n degree central chi-square distribution with zero
mean and variance
 2
and
 
 n
is the gamma function.
Then, when a received signal is existed with signal and
noise, then the probability density functions of yk can be
calculated at the receiver output as


2
2
(
2)/4
(
)/2
1
( /2) 1
2
2
2
1
2
k
n
s
y
k
k
n
k
y
s
p
y
e
I
y
s




















(13)
where the n degree non-central chi-square distribution with
s2 mean and variance
 2
and
I  
x

is the  th-order
modified Bessel function of the first kind. The probability of
false alarm, Pfa, is defined as the probability that a sample
yk[n] will exceed the defined threshold when noise alone is
present in the radar receiver,


/2 2
( /2) 1
/2
1
1
2
2
ky
n
fa
k
k
n
n
T
P
y
e
dy
n



 



(14)
where the n degree is the same as the N-point FFT and T is
the defined threshold level. The probability of detection, PD,
is the probability that a sample yk[n]will exceed the defined
threshold in the case of noise plus signal in the radar
receiver,
2
2
(
2)/4
(
)/2
( /2) 1
2
2
2
1
2
k
n
s
y
k
D
n
k
T
y
s
P
e
I
y
s






















.
(15)
The relation between the detection probability and the false
alarm rate of the squared non-coherent receiver is analyzed
with N-point FFT, as in Eq. (12) such that
1
1
(
(
)
)
(
(
)
)
/ 2
/ 2
D
FA
FA
P
Q Q
P
N SNR
Q Q
P
N SNR








.
(16)
V.
SIMULATION RESULTS
We present Monte-Carlo simulation results averaged over
10,000 estimates to evaluate the performance of the
proposed algorithm. The angle estimation performance of
the proposed algorithm is compared with that of the
conventional
algorithms
such
as
ESPRIT-based
angle
estimation algorithm. This paper only takes into account the
RMSE
for
single
tone
frequency.
In
the
following
simulations, we normally adopt the FMCW radar system
with M=3 and K=4.
In Figure 2, the proposed algorithm is compared to other
algorithms such as DFT and ESPRIT. Here,  means the
fractional number of the angle frequency. In case of M =3,
the RMSE of the proposed algorithm has better performance
than that of the ESPRIT at every angle frequency.
-0.5
-0.4
-0.3
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
10
-3
10
-2
10
-1
10
0

RMSE
N = 4, M = 3, SNR = 20dB
DFT
ESPRIT
Proposed
Figure 2. Performance comparison of the proposed method in various angle
4
5
6
7
8
9
10
11
12
10
-3
10
-2
10
-1
array size
RMSE
M = 3,  =0.3, SNR = 20dB
DFT
ESPRIT
Proposed
Figure 3. Performance comparison of the proposed algorithm for various
antenna arrays K
-5
0
5
10
15
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR(dB)
The probability of detection
N = 4
PFA : 10-2
PFA : 10-3
Figure 4. Performance comparison of the proposed algorithm for various
false alarm rate
Figure
3
shows
the
RMSE
of
various
estimators
according to increasing of the sample N. For the change of
the array size K, K increases from 4 to 12. When K
increases, the RMSE of the proposed estimator improves. In
particular, in the case of the proposed estimator, when N
changes from 4 to 12, the RMSE characteristics improve by
more than about 3 times, with a change from 2.59e-3 to
0.82e-3. Figure 4 shows the performance comparison of the
proposed algorithm for various false alarm rates. After
10
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks

SNR=10dB, the detection probability of PFA =10-2 and 10-3
is same.
VI.
EXPERIMENTS
In order to testify the effectiveness of the proposed
estimation in a real environment, at Daegu-Gyeongbuk
Institute of Science & Technology (DGIST) in Korea, we
fulfilled various experiments in an anechoic chamber. We
implemented a 24 GHz FMCW RF module which included
a transmitting/receiving channel. The transmitter contained
a
voltage
controlled
oscillator
(VCO),
a
frequency
synthesizer, and a 26MHz oscillator used as the input of
VCO. A frequency synthesizer controlled the input voltage
of the VCO in order to generate the FMCW source. The
source swept over the range of 24.05-24.25 GHz, i.e., a 200
MHz bandwidth. The receiver consisted of three LNAs,
three mixers, three high-pass filters (HPFs) and three low-
pass filters (LPFs). The receiver had an overall noise figure
of 8 dB. The gain and noise figure of the LNAs were 14 dB
and 2.5 dB, respectively. An RF signal was down-converted
to an IF signal (beat signal) by the mixer.
0
2
4
6
8
10
12
14
16
18
0
5
10
15
20
25
real distance
estimated distance
0mm
3mm
6mm
9mm
12mm
15mm
18mm
Figure 5. Experimental results
We verified the performance of the proposed method for
various distance between radar and target in the chamber.
When a target were placed at R=[0, 3, 6, 9, 12, 15, 18]mm
for precise estimation in the anechoic chamber, respectively,
the range map was derived as in Figure 5, where each
colored dot indicates an estimation result. The proposed
method can estimate the TOAs of various distances well.
VII.
CONCLUSION
This paper proposed the fine angle frequency estimation
system for radar-based WSN that takes into consideration
the WA-ESPRIT. In order to improve the accuracy of the
angle frequency estimation, the proposed algorithm applied
a weighted average scheme according to the average signal
amplitude of the received signal. We illustrate that the
proposed estimator has better performance than the ESPRIT
at M=3 and improves by more than about 3 times from K=4
to 2. In the future, we will make the various outdoor
experiments.
ACKNOWLEDGMENT
This work was supported by the DGIST R&D Program of
the Ministry of Science, ICT and Future Planning, Korea
(15-RS-01)
and
the
Ministry
of
Trade,
Industry
&
Energy(MOTIE),
Korea
Institute
for
Advancement
of
Technology(KIAT) and DaeGyeong Institute for Regional
Program Evaluation(DGIRPE) through the Leading Industry
Development for Economic Region.
REFERENCES
[1]
P. K. Dutta, A. K. Arora and S. B. Bibyk, “Towards radar-
enabled sensor networks,” in Proc. 5th Int. Conf. Information
Processing SensorNetworks (IPSN), Nashville, TN, Apr. 2006,
pp. 467–474.
[2]
M. S. Lee and Y. H. Kim, "Design and Performance of a 24-
GHz Switch-Antenna Array FMCW Radar System for
Automotive Applications," IEEE Transactions on Vehicular
Technology, vol.59, no.5, pp.2290-2297, Jun 2010
[3]
A. N. Lemma, A. J. Vanderveen and E.F. Deprettere,
“Multiresolution ESPRIT Algorithm,” IEEE Transactions on
Signal Processing, vol. 47, pp. 1722-1726, Jun. 1999.
[4]
T. K. Sarkar and O. Pereira, “Using the matrix pencil method
to estimate the parameters of a sum of complex exponentials,”
IEEE Antennas Propagator Magazine, vol.37, pp.48–55, Feb.
1995.
[5]
X. Li and K. Pahlavan, “Super-Resolution TOA Estimation
With Diversity for Indoor Geolocation,” IEEE Trans. on
Wireless Comm., vol. 3, pp. 224–234, Jan. 2004.
11
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks

