Brain Tumor Detection and Segmentation using Hybrid Approach of MRI, DWT
and K-means
Parvinder Singh1, Mansi Lather2
1, 2 Department of Computer Science and Engineering
1,2 Deenbandhu Chhotu Ram University of Science and Technology, Murthal, Sonepat, India
1 parvindersingh.cse@dcrustm.org
2 lathermansi@gmail.com
Abstract— In medical image processing, the detection of a
brain tumor is considered as one of the most difficult and time
consuming activities. The foremost aim of this paper is to
design an efficient algorithm for brain tumor detection and
segmentation. This paper presents an improved hybrid method
using Discrete Wavelet Transform (DWT), morphological
operators, K-means and Otsu's thresholding technique for
detecting and segmenting the tumor in the brain. DWT is used
for image denoising. Morphological operators are used for
removing the skull portions from the brain images and K-
means clustering and thresholding approaches are used for
image segmentation and finally to detect the brain tumor. The
proposed method results in low values of Mean Square Error
(MSE) and Bit Error Rate (BER) and high value of Peak
Signal to Noise Ratio (PSNR) as compared to existing
watershed and region growing segmentation methods and thus
outperforms the existing methods.
Keywords-Brain
Tumor;
Image
Denoising;
K-
means
Segmentation;
Magnetic
Resonance
Imaging
(MRI);
Morphological Operators; Skull Removal.
I.
INTRODUCTION
The brain is regarded as the command center of the
nervous system, and it is the most complicated organ inside
the human body. It is a non-replaceable, soft and spongy
mass of tissue. The human brain takes inputs from the
sensory organs and forwards them as outputs to the muscles
[1]. Intelligence, creativity, emotions, memory, etc., are
governed by the brain [2]. Therefore, any damage or harm in
the brain will cause problems for personal health including
mobility or cognition [1].
In diagnosing brain tumors, precise measurements are
very difficult because of the diversity in size, shape and
appearance of tumors. A brain tumor is an abnormal and
uncontrolled propagation of cells [3].
A brain tumor does
not only impact the immediate cells in its location, but it can
also
cause
damage
to
surrounding
cells
by
causing
inflammation. In medical image processing, brain tumor
detection is considered as one of the most difficult and time
consuming activities [12]. Medical imaging techniques play
an important role in tumor detection. Among the various
medical imaging modalities, MRI is regarded as the most
proficient means for analyzing the body’s internal structure
[5]. Timely and precise tumor detection is necessary for
efficiently planning the treatment. In this paper, we develop
a hybrid technique for brain tumor detection using DWT,
morphological operators and K-means segmentation.
The important goal of the image processing application
proposed here is to use the image data to abstract the
required attributes which are then used by a machine to
obtain an interpretative, descriptive, or reasonable diagnosis.
Among the various image processing steps, in case of
brain tumor detection, the main ones are image denoising,
morphological operation and image segmentation.
Image denoising is defined as the method of removing
noise from the image. In medical imaging, for easy and
proper diagnosis of diseases, denoising produces a clearer
image [5]. Various schemes are available for removing
noise from images [4][14]. The selected diagnostic method
should be capable of retrieving as much detail as possible
from the image regardless of any high degradation of the
image by noise. The image denoising methods are broadly
categorized as [4]:

Spatial filtering methods
Include linear and non-linear filters.

Transform domain filtering methods
Include spatial frequency filtering methods and
wavelet domain methods.
Morphological
operators
are
non-linear
operators
dealing with morphology and shape of images. They are
related to pixel ordering and they do not change the pixel’s
numerical value. These operators use a small matrix of
pixels called structuring element in which each pixel has
value one or zero and the choice of suitable structuring
element plays an important role in the process. Various
types of morphological operators include erosion, dilation,
opening and closing [5].
Image segmentation is the process of using automatic
or semi-automatic means of extracting the region of interest
from an image [9]. Segmentation techniques used for
analyzing medical images are classified as [6]:

Region based methods
Include thresholding and region growing methods.

Classification methods
Include
k-nearest
neighbor
and
maximum
likelihood methods.
7
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-665-1
ICQNM 2018 : The Twelfth International Conference on Quantum, Nano/Bio, and Micro Technologies


Clustering methods
Include K-means, Fuzzy C-Means (FCM) and
expectation maximization methods.
In this paper, we propose a new hybrid method using
DWT,
morphological
operators,
K-means
and
Otsu's
thresholding technique for detecting and segmenting the
tumor in the brain. Image denoising is done using DWT;
The skull portion of the brain images is removed using
morphological operators and image segmentation and final
brain tumor detection is done using K-means clustering and
thresholding.
This research paper is divided in five parts: in Section II,
we present related literature works; in Section III, the
proposed methodology is explained in detail; Section IV
includes performance analysis and Section V concludes the
paper.
II.
LITERATURE REVIEW
In [5], Ramya and Sasirekha proposed a segmentation
technique consisting of three phases: (1) a fourth order
partial differential equation is used to denoise the image;
then, (2) the morphological operators are used to remove the
skull part and, finally, (3) segmentation is done using region
growing segmentation. The precision of this method is
higher than the watershed segmentation algorithm [5].
In [7], Ayed, Halima and Kharrat proposed an approach
that consists of five stages: In the first stage, features are
extracted using 2D Discrete Wavelet Transform and Spatial
Gray Level Dependence Matrix (DWT-SGLDM). In the
second stage, to reduce features size, features are selected
using Simulated Annealing (SA). In the next stage, over
fitting is avoided using Stratified K-fold Cross Validation.
In the fourth stage, to optimize Support Vector Machine
(SVM) parameters, Genetic Algorithm-SVM (GA-SVM)
model is used. Finally SVM is used for creating the
classifier.
In [8], El-Khamy, El-Khoreby and Sadek presented a
hybrid approach of FCM and Conformed threshold. The
proposed technique is composed of five steps: The first step
involves enhancement of the intensity of input brain MR
image using pre-processing for the next step. The second
step involves the use of a rectangu1ar window for image
histogram in order to ca1culate the number of c1usters for
FCM input. The third step is to use FCM to find the center
of clusters. The fourth step is to use the Conformed
threshold value in order to segment the tumor. The final step
uses segmented image to detect tumor. For correctness and
processing time, this method gives better resu1ts than the
globa1
thresho1d
method
of
segmentation,
but
the
completeness is better in globa1 thresho1d method as
compared to their method.
In [10], Gopal and Karnan presented a hybrid approach
such as FCM with GA and Particle Swarm Optimization
(PSO) for detecting the tumor. The tumor detection is done
in two phases. The first phase involves pre-processing and
enhancement using the tracking algorithm to eliminate film
artifacts and median filter to eliminate the high frequency
components. The second phase involves segmentation and
c1assification using GA with FCM and PSO with FCM.
PSO with FCM technique outperforms GA with FCM
technique.
In [11], Selkar and Thakare presented watershed and
thresholding algorithm that consists of three stages. Firstly,
quality of the scanned image is enhanced by removing
noise. Secondly, thresholding and watershed segmentation
is applied to get a high intensity portion called tumor from
the whole image. Finally, edge detection operator is applied
for extracting the boundary and for finding the tumor size.
The result shows efficient tumor detection by using
thresholding algorithm rather than watershed algorithm and
canny edge operator gives efficient boundary extraction
results rather than Prewitt and Robert operator.
In
[12],
Arivoli,
Lakshmi
and
Vinupriyadharshini
proposed
a
system
consisting
of
two
main
steps:
preprocessing and segmentation. The preprocessing step
involves three methods. The first method is noise removal
using curvelet transform, next is artifact remova1 and last is
skul1
remova1
using
mathematical
morphology.
Segmentation is done using spatia1 FCM.
In [13], Beham and
Gurulakshmi proposed a method
consisting of three steps: The first step is image enhancement
in which outer elliptical shaped object is eliminated. The
second step is morphological processing, conducted for
extracting
the
needed
region.
The
final
step
is
the
segmentation using K-means clustering algorithm. This
unsupervised method is efficient and less prone to error and
can be carried out with lesser amount of data giving accurate
output compared to supervised methods.
To overcome the deficiencies of existing techniques, we
propose an improved technique which is efficient in
denoising of images corrupted by Gaussian noise. Gaussian
noise can be effectively removed by using the wavelet
techniques because of the ability of the wavelet to capture
the energy of the signal in few energy transform values [15].
Moreover, threshold selection is done using automated
means
which
gets
an
optimized
value
for
global
thresholding.
III.
PROPOSED SYSTEM
In this paper, we propose a new hybrid method using
DWT,
morphological
operators,
K-means
and
Otsu's
thresholding technique for detecting and segmenting the
tumor in the brain. DWT is used for image denoising.
Morphological operators (erosion and dilation) are used for
skul1 removal from the brain images. K-means clustering
and
thresholding
approaches
are
used
for
image
segmentation. This segmentation is finally used to detect the
brain tumor. The flow graph shown in Figure 1 depicts the
step by step procedure to be followed for detecting the
tumor.
A.
Image Acquisition
Images
are
acquired
using
non-invasive
Magnetic
resonance imaging (MRI) scan. The MRI scanner has a
sliding table, which goes inside the circular apparatus during
acquisition. A sample brain image using MRI scan is shown
8
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-665-1
ICQNM 2018 : The Twelfth International Conference on Quantum, Nano/Bio, and Micro Technologies

in Figure 2 a) and then converted into grayscale as shown in
Figure 2 b).
B.
Image Denoising
In the proposed method, noise removal is done using
DWT filtering. The wavelets are the functions that deal with
both the frequency and the temporal components. Denoising
of the images using wavelet technique is very effective,
when images are degraded by Gaussian noise. This is
because of their ability to capture the signal energy in few
energy transform values [15]. The enhanced image after
removing noise using DWT filtering is shown in Figure 2
c).
Figure 1. Proposed methodology for tumor detection.
C.
Otsu’s Thresholding
Otsu’s thresholding is applied to the enhanced image
after denoising using DWT filtering technique. The purpose
of Otsu’s thresholding method is to get an optimized value
for g1obal thresholding. In Otsu’s thresholding, it is pre-
assumed that image has 2 c1asses of pixe1s or a bimoda1
histogram. The pixels in image are divided into two
categories- foreground and background. The segmented
image after applying Otsu’s thresholding is shown in Figure
2 d).
Figure 2. a) Input brain MRI image; b) Grayscale image; c) Enhanced
image after denoising using DWT filtering; d) Image after applying Otsu’s
thresholding.
D.
Skull Removal
The segmented image after Otsu’s thresholding is taken
as input to this stage. The skull removal means elimination
of brain’s non-cerebral tissues. There is a need to remove
brain’s skull portion as the skull portion is bright and its
intensity is almost same as that of tumor and thus it can
influence the segmentation of tumor.
In the proposed method, two basic morphological
operators, erosion and di1ation are used for removing the
skull portions. Dilation fills the holes and equalizes the
contour lines. Erosion, on the other hand, eliminates the
small objects and detaches the object joined by small bridge.
These morphological operators are based on a structuring
element, that serves as a small window and scrutinize the
Read MRI image
Convert into grayscale
Apply DWT filtering for removing the noise
Apply Otsu’s Thresholding
Skull removal using Morphological Operators
Image segmentation using K-means algorithm
Tumor detected output image
9
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-665-1
ICQNM 2018 : The Twelfth International Conference on Quantum, Nano/Bio, and Micro Technologies

image. The choice of an appropriate structuring element is a
must for proper removal of the skull portion [5]. The result
of skull removal is shown in Figure 3.
Figure 3. Skull removal after applying erosion (Left) and then dilation
(Right) with structuring element ‘disk’ of radius 0,1,6 respectively from top
to bottom.
E.
Image Segmentation
Segmentation is the next important step to be carried out
after image denoising and skull removal so as to precisely
detect the tumor. Image Segmentation is the process of
taking out the region of interest from an image by
automated or semi-automated means [9]. There are various
image
segmentation
methods
such
as
watershed
segmentation, thresholding,
region growing, clustering,
classification methods and so on [6].
In the proposed method, the image segmentation is
performed
using K-means
clustering, an unsupervised
method which is efficient and less prone to error and can be
carried out with minimal data.
K-means [6] is an unsupervised method that divides the
image into K- clusters on the basis of mean of each cluster.
Initially, data is partitioned into K- clusters and thereafter
mean of each cluster is computed. Each point is then added
to the cluster having the minimum distance to the c1usters
mean on the basis of Euc1idean distance. The final detected
tumor after K-means segmentation is shown in Figure 4.
Figure 4: Final image of detected tumor using K- means segmentation.
IV.
PERFORMANCE ANALYSIS
The proposed method is implemented on MATLAB
(2010a) on a system having configuration Inte1 core 2 with
processing speed 2.54 GHz, 2 GB RAM. There are various
performance parameters for analyzing the images. The Peak
Signal to Noise ratio (PSNR) [16] is one of the most
important factor for analyzing the image. PSNR is the ratio
of origina1 image to noiseless image. For denoising
methods, PSNR average value ranges between 20-50 dB.
The formula to calculate the value of PSNR is given in (1)
where MSE is the Mean Square Error.
PSNR= 10*log10 [(MAX)2/MSE]
(1)
The PSNR is used as a measure to reconstruct the image
quality. The higher the PSNR value, the higher the image
quality.
Mean Square Error (MSE) is another important measure
for analyzing the image. MSE [16] is a risk function that
corresponds to the expected value of squared error. The
MSE is defined as:
MSE
= 10*log10 (signal/noise)
(2)
10
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-665-1
ICQNM 2018 : The Twelfth International Conference on Quantum, Nano/Bio, and Micro Technologies

The smaller the va1ue of MSE, the higher the image
quality.
One more performance evaluation parameter is Bit Error
Rate (BER) [17] defined as:
BER = 1/PSNR
(3)
The smaller the va1ue of BER, the higher the image
quality.
The values of MSE, PSNR, BER obtained by the
proposed method, when implemented on MATLAB are
shown in Figure 5.
Figure 5: Result of MSE, PSNR, BER
The values of various performance parameters such as
MSE, PSNR and BER obtained by the proposed technique
are compared with the existing techniques in Table 1.
TABLE I.
RESULT OF SEGMENTATION
Segmentation
Techniques
MSE
PSNR
BER
Watershed Segmentation
2.0244
5.0677
0.19732
Region Growing
Segmentation
9.5276
38.3749
0.02605
K-means and Otsu’s
Thresholding
7.7285
39.2498
0.02547
It can be observed from the Table 1 that the proposed
method shows better results than the other existing methods.
Here, the value of PSNR is more and the value of MSE and
BER is less for the proposed method as compared to
watershed and region growing segmentation.
V.
CONCLUSION
Finding the accurate border of the area, comprising an
identified brain tumor is a difficult task and needs to be
addressed as it is applicable to many medical moda1ities
and tumor types. In this paper, we proposed a new hybrid
method using DWT, morphological operators, K-means and
Otsu's thresholding technique for detecting and segmenting
the tumor in the brain. The proposed method efficiently
detects the tumor from the brain MRI images. The result of
the proposed method is compared with the existing methods
and it was found that the values of MSE and BER are less
and value of PSNR is high as compared to the existing
watershed and the region growing segmentation. Lower
values of MSE and BER and high value of PSNR result in
better image quality.
In the future work of this study, we will attempt to
modify the proposed technique so as to classify the type of
tumor as benign, malignant, or pre-malignant.
REFERENCES
[1]
T. Lewis and S. Writer. Human Brain: Facts, Functions &
Anatomy
[Online].
Available:
http://
www.livescience.com/29365-human-brain.
html,
[Retrieved: August, 2018].
[2]
Anatomy
of
the
Brain
[Online].
Available:
http://www.mayfieldclinic.com/PDF/PE-
AnatBrain.
Pdf,
[Retrieved: August, 2018].
[3]
A. Mandal. (2014, Apr 02). What is a Brain Tumor? [Online].
Available:
http://www.news-medical.net/health/What-is-a-
Brain-Tumor.aspx, [Retrieved: August, 2018].
[4]
F. C. Harris, M. C. Gadiya, M. C. Motwani, and R. C.
Motwani, “Survey of Image Denoising Techniques", Proc.
GSPX, pp. 27-30, 2004.
[5]
L.
Ramya
and
N.Sasirekha,
“A
Robust
Segmentation
Algorithm using Morphological Operators for Detection of
Tumor in MRI,” 2015 IEEE
International Conference on
Innovations in Information Embedded and Communication
Syststems ICIIECS 2015, pp. 1–4, 2015.
[6]
A. Norouzi et al. "Medical Image Segmentation Methods,
Algorithms, and Applications," IETE Technical Review June
2014, vol. 31, no. 3, pp. 199-213, 2014.
[7]
M. B. Ayed, A. Kharrat, and M. B. Halima, “MRI Brain
Tumor Classification using Support Vector Machines and
Meta-Heuristic
Method,”
International
Conference
on
Intelligent Systems Design and Applications ISDA 2015, pp.
446–451,2016.
[8]
S. E. El-Khamy, R. A. Sadek, and M. A. El-Khoreby, “An
Efficient Brain Mass Detection with Adaptive Clustered
based
Fuzzy
C-Mean
and
Thresholding,”
2015
IEEE
International Conference on Signal and
Image Processing
Applications ICSIPA 2015, pp. 429–433, 2015.
[9]
Image
Segmentation
[Online].
Available:
https://in.mathworks.com/discovery/image-
segmentation.html, [Retrieved: September, 2018].
[10] N. N. Gopal and M. Karnan, “Diagnose Brain Tumor through
MRI using Image Processing Clustering Algorithms such as
Fuzzy
C
Means
along
with
Intelligent
Optimization
Techniques,”
2010
IEEE
International
Conference
on
Computational Intelligence and Computing Research ICCIC
2010, pp. 694–697, 2010.
[11] R. G. Selkar and M. N. Thakare, “Brain Tumor Detection and
Segmentation
By
Using
Thresholding
and
Watershed
Algorithm,” International Journal of Advanced Information
and Communication Technology IJAICT 2014, vol. 1, no. 3,
pp. 321–324, 2014.
[12] A. Lakshmi, T. Arivoli, and R. Vinupriyadharshini, “Noise
and Skull removal of Brain Magnetic Resonance Image using
Curvelet
transform
and
Mathematical
Morphology,”
11
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-665-1
ICQNM 2018 : The Twelfth International Conference on Quantum, Nano/Bio, and Micro Technologies

International Conference on Electronics and Communication
Systems ICECS 2014, pp. 1–4, 2014.
[13] M. P. Beham and A. B. Gurulakshmi, “Morphological Image
Processing Approach On The Detection Of Tumor and Cancer
Cells,” International Conference on Devices, Circuits and
Systems (ICDCS), 2012, pp. 350–354, 2012.
[14] R. C. Gonzalez and R. E. Woods, "Image Restoration," in
Digital Image Processing, 2nd ed. New Jersey: Prentice-Hall,
2001, ch. 5, pp. 220-272.
[15] M. M. Sathik, S. A. Perumal, and S. K. Mohideen, “Image
De-noising using Discrete Wavelet Transform,” International
Journal of Computer Science & Network Security (IJCSNS),
2008, vol. 8, no. 1, pp. 213-216, January 2008.
[16] P. Kaushik and Y. Sharma, “Comparison of Different Image
Enhancement Techniques Based upon PSNR & MSE,”
International Journal of Applied Engineering and Research,
2012, vol. 7, no. 11, 2012. ISSN 0973-4562.
[17] G. Singh, S. Arora and V. K. Banga, “Comparison of F-
measure,
BER
and
PSNR
of
Tumor
Detection
using
Hybridization of Fuzzy and Region Growing,” International
Journal of Computer Applications 2015, vol.124, no. 3, pp.
32-38, August 2015.
12
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-665-1
ICQNM 2018 : The Twelfth International Conference on Quantum, Nano/Bio, and Micro Technologies

