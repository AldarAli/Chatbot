Performance Evaluation of the Opportunistic Spectrum Access in a Cognitive Radio
Network with Imperfect Sensing
Branislav Edgar Feijó Couceiro and José Marcos Câmara Brito
Instituto Nacional de Telecomunicações-INATEL
Santa Rita do Sapucaí, Brazil
branislavcouceiro@gmail.com, brito@inatel.br
Abstract—Cognitive
radio
networks
have
emerged
as
a
promising technology to shift the actual paradigm of spectrum
scarcity by allowing the cognitive users (secondary users) to
use the licensed spectrum on an opportunistic basis. A
continuous-time Markov chain (CTMC) can be used to model
the opportunistic spectrum access (OSA) in a cognitive radio
network
with
imperfect
sensing
(false
alarms
and
misdetections). In this paper, an analytic model is developed
and the performance of the system is evaluated and the
numerical results are presented in terms of capacity (average
number
of
calls
completion
per
time
unit),
blocking
probability,
force
termination
probability
and
spectrum
utilization.
Keywords—performance
evaluation,
cognitive
radio
networks,
continuous-time
Markov
chain
(CTMC)
model,
imperfect sensing.
I.
INTRODUCTION
Cognitive
radio
technology
offers
an
alternative
spectrum access, which could result in an effective use of
the spectrum. In cognitive radio networks, there are two
types of users: primary users, who own (have license for the
use of) a frequency band, and secondary users, who attempt
to use the licensed frequency band in an opportunistic way.
Primary users have priority over secondary users and
secondary users
(unlicensed)
can
access
the
licensed
spectrum band if the owner of that band is absent. In order
to access those frequency bands without interfering with
primary
users
transmissions,
secondary
users
must
accurately detect the presence of primary users by sensing
the spectrum. Different sensing techniques can be used to
perform spectrum sensing [10], but sensing techniques
cannot provide perfect sensing. So, false alarms and
misdetection cannot be fully avoided. False alarms happen
when a channel is free and the cognitive user classifies that
channel as busy, and misdetections happen when a busy
channel is classified as free. In [2], analysis of the access of
cognitive radio networks was studied using continuous time
Markov chain (CTMC), but the effect of imperfect sensing
was not taken into account. A similar state diagram based
approach was taken in [6]-[8] for modeling dynamic
spectrum access with channel assembling, but, also perfect
sensing accuracy was assumed. In [3], the effect of
imperfect sensing is studied alongside with the opportunistic
spectrum access in a cognitive radio network. Explicit
expressions
for
state
dependent
transition
rates
were
presented for the specific case of three channels. However, a
generalization of the study for more channels was not done.
The prominent feature of the state diagram in [3] is that
it has state-dependent transition rates at the nodes. These
transitions
are
found
by
going
through
all
possible
transitions from a state taking into account the channel state
and the sensing decision.
In this paper, we generalize the approach used in [3] and
provide expressions to compute the state transition rates in a
generic way, which can be used for any numbers of
channels. Also, additional performance metrics are presented
to analyze the performance of the system. The rest of this
paper is organized as follows. Section II describes the system
model and assumptions. Section III describes the CTMC
analysis. Section IV goes into details with respect to the
network
performance
analysis.
Numerical
results
are
presented in Section V. Finally conclusions are presented in
Section VI.
II.
SYSTEM MODEL AND ASSUMPTIONS
Similar to [3], we consider that there are N channels
available, and these channels can be accessed by primary
and secondary users, with primary users having priority over
the secondary users. Primary and secondary calls arrive with
rates λ1 and λ2 respectively, and are completed with rates µ1
and µ2, respectively. In order to find the same theoretical
solutions as in [3], we use the exact same assumptions.
These assumptions are:
•
When the primary user arrives to a channel occupied
by a secondary user, the secondary user will always
notice the primary user and will leave the channel.
After this, the secondary user starts to search for a
new channel. During this phase, the secondary user
will perform detection on the remaining channels in
random order until it finds a free channel or all
channels are determined to be busy. A free channel is
decided to be occupied with false alarm probability
PF and an occupied channel is determined to be free
with misdetection probability PM = 1- PD, where PD
is the detection probability, which refers to a
probability that an occupied channel is correctly
detected as busy.
78
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

•
The sensing time and the time to perform the
spectrum handover is considered negligible. So, all
states transitions are instantaneous.
•
A
secondary
user
always
knows
the
channels
occupied by other secondary users and will not sense
or use them. Therefore, there is no collision between
secondary users.
•
A primary user knows the channels occupied by
other primary users so that there will be no collision
between primary users.
•
In case of collision between primary and secondary
users,
both
colliding
users
withdraw
from the
channel. This means that both transmissions will be
lost. Note that the collision when primary user comes
to a channel used by a secondary user is assumed to
be short and does not cause the primary user to leave
the channel.
•
The search order for new free channel is random and
equally probably. The search stops after an idle
channel is found or all channels are found to be
occupied.
III.
CTMC ANALYSIS
A two-dimensional Markov chain is used to model the
system. Let x={i,j} be the general state representation,
where i represents the number of primary users’ calls in the
system and j the number of secondary users’ calls in the
system. For example, x={2,1}, refers to the state with two
primary users and one secondary user. Let N be the number
of channels available in the system. Therefore, the set of
feasible states of the system is denoted as S={x| 0 ≤ i ≤ N, 0 
≤ j ≤N, 0 ≤ i + j ≤ N}.
A. State Transition Rate
The
state-dependent
transition
rates
are
derived
considering all possible events that can trigger state
transition and all possible sensing decisions.
For example, the transition from the state x={1,0} to the
state x={0,0}, considering 3 channels [3], occurs in four
different scenarios:
1) First, it can happen if the primary user regularly
completes its call with rate µ1;
2) It can happen if a secondary user arrives to the
channel occupied by the primary user, fails to detect the
presence of the primary user (with probability PM) and
transmits on that channel resulting in a collision. In this
case, both transmissions are lost taking the chain to the state
x={0,0}. Since the secondary user searches for a new
channel randomly and with equal probability, the transition
rate in this scenario is 1/3λ2PM;
3) Another possibility is if the secondary user arrives in
one of the two idle channels (with 2/3 probability), but, after
sensing, it decide that the channel is busy (with probability
PF). In this case, if the secondary user goes to the channel
occupied by the primary user (with probability 0.5) and fails
to detect the presence of the primary user (with probability
PM) and transmits on that channel, the secondary user will
collide with the primary user and take the Markov chain to
the state x={0,0}, with rate 2/3λ2PF1/2PD.
4) The last possibility is if the secondary user arrives in
one of the two idle channels (with 2/3 probability), but, after
sensing, it decides that the channel is busy (with probability
PF), then, the secondary user searches another channel and
goes to the other idle channel (with probability 0.5) and
decides that this channel is also busy (with probability PF),
in this case, the secondary continues his search and goes to
the channel that is occupied by the primary user, fails to
detect the presence of the primary user (with probability PM)
and transmits on that channel resulting in collision and both
users withdraw from the channel and the Markov chain will
go to state x={0,0} with rate 2/3λ2PF1/2PFPM. So, the
transition from state x={1,0} to state x={0,0} will be:
1
2
2
2
1
2
1
2
1
3
3
2
3
2
M
F
M
F
F
M
i
P
P
P
P
P P
µ
λ
λ
λ
+
+
+
(1)
Figure 1 shows the Markov chain with its explicit
transition rate for the case of three channels reproduced
from [3].
The same approach should be taken to determine the
transition rate from any pair of states directly connected. As
we can see, it can be an exhaustive work, especially if the
number of channels is large. In this paper, we developed
generic expressions which can be used to determine the
transition rate from one state to another for any number of
channels N. These expressions are presented in Table I.
B. Transition Matrix and Stationary Probability
Let Q be the transition matrix of the CTMC. We
determine the total transition rate from state a to state b,
which is the summation of transition rate from state a to
state b considering all possible user activities for all a,b (a ≠ 
b) ϵ S namely qab. The diagonal elements in Q, i.e., qaa, a ϵ S 
are found as [8]:
,
a
b
a
S
a
a b
b
q
q
∈
≠
= − ∑
(2)
The stationary probabilities, π(x) can be computed from 
the global balance equations and the normalization equation,
given as:
0,
π Q
=
(
)
1
x
S
x
π
∈
=
∑
(3)
where π is the steady state probability vector.  
Once the steady state probabilities are determined, the
performance of the system can be evaluated by different
parameters, as presented in the next section.
IV.
PERFORMANCE ANALYSIS
The analysis presented in [3] considers only two
parameters, the primary user termination probability and the
probability
79
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

that a secondary call is normally terminated, and only for a
particular case (N=3).
In this paper, we introduced four new parameters to
analyze the performance of the system:
a) Secondary blocking probability
b) Primary network capacity
c) Secondary network capacity
d) Spectrum utilization
Also, using the generic transition rates presented in
Table I, we can compute the performance of the system (for
our new four parameters and the two parameters presented
in [3]) for any number of channels.
In this section, we presented the expressions to compute
each
performance
parameter.
Numerical
results
and
discussions are presented in Section V.
A.
Primary Network Performance Analysis
1) Primary user termination probability: As defined in
[3],
the
primary
user
termination
probability
is
the
probability that a primary user call, which has not been
blocked at start, is terminated due to collision with
secondary users because of misdetection. This probability is
computed by [3]:
(
)
(
)
(
)
1
1
1
( , )
( , )
(
1, )
( ,
1
1
1
1
)
2
1
0
1
1
( , )
( , )
1
N
N
N
N
i j
i j
i
j
i j
i
j
i
PT
b
j
i j
T
i
i j
T
i
P
P
π
µ
π
µ
λ
−
−
−
−
−
=
=
=
=


−
+
−




=
−
∑ ∑
∑ ∑
(4) 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
where
( , )
π i j
is the state probability of the state
( , )
i j and
( , )
(
1, )
i j
i
T − j
is the transition from state ( , )
i j to
state (
1, )
i
j
−
, and Pb1 is the primary user blocking
probability given by:
1
(N , 0 )
Pb
= π
(5)
2)
Primary network capacity: We define the term capacity
as the average number of calls completed per unit time.
Either (5) or (6) can compute the primary network
capacity:
1
1
1
(1
)(1
)
b
P T
P
P
ρ
= λ
−
−
(6) 
 
1
1
(
)
x
S
i
x
ρ
µ π
∈
= ∑
(7)
where i is the number of primary user’s calls in state x.
B. Secondary Network Performance analysis
1) Secondary User Blocking probability: A secondary
user’s call is blocked if a secondary user arrival does not
take the system to a state (i,j+1). Therefore, the blocking
probability can be expressed as:
( )
(i, j)
(1,
1 )
2
2
1
j
x
b
S
T
P
x
π
λ
+
∈


=
−






∑
(8)
80
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

2)
Secondary
user
termination
probability:
We
define the secondary user termination probability as the
probability that a secondary user call, which has not been
blocked
at
start,
is
forced
to
terminate
before
its
transmission is finished. So, the secondary user termination
probability can be expressed as:
2
2
(1
)
i n t
S T
b
R
P
P
= λ
−
(9)
where Rint is the rate that a primary user preempts a
secondary user’s call in a way that the secondary user is
forced to terminate.
Than, we have:
( ,
)
( ,
)
( ,
1)
(i 1
)
2
, j 1
( )(
)
( )
i j
i j
i j
x
i
S
x
S
R n t
x
T
j
x T
π
µ
π
−
+
−
∈
∈


=
−
+




∑
∑
(10)
Therefore, the probability that a secondary call is
normally terminated can be expressed as:
2
(1
)(1
)
S N T
b
S T
P
P
P
=
−
−
(11)
3)
Secondary
network
Capacity:
We
define
this
parameter as the average number of secondary user´s call
completion per time unit. Either (10) or (11) can compute
the secondary network capacity. Therefore, the secondary
network capacity will be:
2
2
2
(1
)(1
)
b
S T
P
P
ρ
= λ
−
−
(12)
2
2
(
)
x
S
j
x
ρ
µ π
∈
= ∑
(13)
where j is the number of primary user´s calls in state x.
C. Spectrum Utilization
We define the spectrum utilization as the average
number of utilized channels over the total number of
channels. The spectrum utilization of the cognitive radio
network can be expressed as:
(
)
(
)
x
S
i
j
U
x
N
π
∈
+
= ∑
(14)
Figure 1 State diagram
81
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

V.
NUMERICAL RESULTS
In this section, numerical results are presented to
illustrate the performance of the opportunistic spectrum
access with respect to parameters presented in the previous
section, taking into account the effect of the imperfect
sensing.
In order to compare the results presented here with the
results presented in [3], we opted to use the same values
used in [3], for the following parameters: λ1 = 7, λ2 = 3.5, µ1
= µ2 = 4, PF = 0.15 and PD = 0.713.
In our analysis, we can define the number of channels as
any value. To illustrate the results, we opted to use N=5 and
N=10. We also used N=3 for the sake of comparison with
the results in [3]. N=3 is the only value presented in [3].
1) Primary
user
termination
probability:
Figure
2
shows the termination probability of a primary user as the
PD varies. It can be seen that when the PD = 1, the
termination probability is zero (PD = 1 means perfect
detection and so there is no interruption from the secondary
network). Figure 2 also shows the primary user termination
probability for N=3 presented in [3] and reproduced here.
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
0
0.05
0.1
0.15
0.2
0.25
Detection probability
PPT
N=3
N=5
N=10
Figure 2. Primary user termination probability
2) Primary Network Capacity: Figure 3 shows that the
capacity decreases when there is less accuracy on the
detection of the primary presence. If the PD is low, then
there will be more interruptions and fewer calls will have
the chance to regularly finish their transmission.
3) Secondary User Blocking probability: Figure 4 shows
that, if the arrival rate of primary users’ calls increases, then
the secondary user blocking probability also increases. This
occurs because there will be less transmission opportunity
for the secondary network, resulting in more blocked
secondary users’ calls.
4) Probability that a
secondary call is normally
terminated: Figure 5 shows that, with the increase of the
arrival rate of the primary network, secondary users’
services will be interrupted more often. Therefore, the
probability that a secondary user´s call successfully ends
decrease. Figure 5 also shows the probability that a
secondary call is normally terminated for different values of
µ2 and N=3 presented in [3] and reproduced here.
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
4.5
5
5.5
6
6.5
7
Detection probability
Primary network capacity
N=3
N=5
N=10
Figure 3. Primary network capacity
0
1
2
3
4
5
6
7
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
λ1
Blocking probability
N=3
N=5
N=10
Figure 4. Secondary user blocking probability
1
2
3
4
5
6
7
8
9
10
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
λ1
Probability that a secundary call is normally terminated
• ← µ2=4,N=5
• ← µ2=4,N=10
• ← µ2=4,N=3
• ← µ2=8,N=3
• ← µ2=2,N=3
Figure 5. Probability that a secondary call is normally terminated
5) Secondary network Capacity: Figure 6 shows that low
capacity is achieved if the arrival of primary users’ calls are
82
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

frequent. Figure 6 also shows that higher capacity is
achieved when more channels are available.
6) Spectrum Utilization: Figure 7 shows that better
spectrum utilization can be obtained if there are less
detections errors.
0
1
2
3
4
5
6
7
8
9
10
1
1.5
2
2.5
3
3.5
λ1
Secondary network capacity
N=3
N=5
N=10
Figure 6. Secondary network capacity
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
0.2
0.25
0.3
0.35
0.4
0.45
0.5
0.55
0.6
0.65
Detection probability
Spectrum utilization
N=3
N=5
N=10
Figure 7. Spectrum utilization
In Figures 2-7, it can be seen that the performance of the
opportunistic spectrum access gets better for larger number
of channels N. It happens because if more channels are
available, then less calls will be forced to terminate due to
misdetections resulting in more capacity and better spectrum
utilization.
VI. CONCLUSIONS
In this paper, an existing state diagram based approach
for modeling the opportunistic access of a cognitive network
with imperfect sensing is improved by allowing the state
equations to be generalized to any numbers of channels.
Additionally,
we
introduced
four
new
parameters
to
evaluate the performance of such network. The developed
analytical model allows us to see the effect of the imperfect
sensing on the number of calls completed per time unit for
both primary and secondary networks and the overall
spectrum utilization for any number of channels in the
system.
ACKNOWLEDGMENT
This work was partially supported by Finep, with
resources from Funttel, Grant No. 01.14.0231.00, under the
Radiocommunication
Reference
Center
(Centro
de
Referência em Radiocomunicação ) project of the National
institute
of
telecommunications
(Instituto
Nacional
de
Telecomunicaçoes – Inatel), Bazil.
REFERENCES
[1]
J.
Mitola
III,
“Cognitive
radio:
An
integrated
agent
architecture for software defined radio,” Ph.D. dissertation,
Royal Institute of Technology, Sweden, 2000.
[2]
E. W. M. Wong and C.H. Foh “Analysis of cognitive radio
spectrum
access
with
Finite
user
population”.
IEEE
Communication Letters, May 2009, Vol. 3, No. 5, pp. 294-
296.
[3]
I. Suliman, J. Lehtomaki, T. Braysy, and K. Umebayashi,
“Analysis
of
cognitive
radio
networks
with
imperfect
sensing”, IEEE 20th Symposium On Personal, Indoor and
Mobile Radio Communications, 2009, pp. 1616-1620.
[4]
T. M. N Ngatched, S. Dong, and A. S. Alfa, “Analysis of
cognitive radio networks with channel aggregation and
imperfect
Sensing”,
Proceedings
of
20th
International
Conference on Computer Communications and Networks
(ICCCN), 2011, pp 1 – 6.
[5]
T. M. N Ngatched, S. Dong, A. S. Alfa, and J. Cai,
“Performance analysis of cognitive radio networks with
channel
assembling
and
imperfect
sensing”,
IEEE
International Conference on Communications (ICC), 2012,
pp. 1688 – 1692.
[6]
L. Jiao, F. Li, and V. Pla, “Dynamic channel aggregation
strategies
in
cognitive
radio
networks
with
spectrum
adaptation,” 2011 IEEE GLOBECOM, pp. 1-6.
[7]
L. Jiao, F. Li, and V. Pla, “Modeling and performance
analysis of channel assembling in multi-channel cognitive
radio networks with spectrum adaptation,” IEEE Transaction
on
Vehicular Technology., July 2012, vol. 61, no. 6, pp.
2686–2697.
[8]
I. Balapuwadege, L. Jiao, F. Li, and V. Pla, V. “Channel
assembling with priority-based queues in cognitive radio
networks:
strategies
and
performance
evaluation” IEEE
transactions On wireless Communication, February 2014,
Vol.13, No 2, pp. 630-645.
[9]
S. Tang and B. L. Mark, “Modeling and analysis of
opportunistic spectrum sharing with unreliable spectrum
sensing” IEEE Trans. Wireless Commun., vol. 8, 2009, pp.
1934-1943.
[10] I. Akyildiz, B. Lo, and R. Balakrishnan, “Cooperative
spectrum sensing in cognitive radio networks: A survey”
Physical Communication, December 2010, pp. 40-62.
[11] L. Kleinrock, Queueing Systems, Volume I: Theory. Jonh
Wiley and Sons, March 1975
83
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

