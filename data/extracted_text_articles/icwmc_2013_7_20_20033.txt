Cooperative Communications Using Multilevel
Bit-Interleaved Coded Modulations
Hadi E. Sawaya
Engineering Faculty - ESIB
Saint Joseph University
B.P. 11-514, Beirut, Lebanon
Email: hadi.sawaya@usj.edu.lb
Abstract—This paper deals with cooperative communica-
tions for non-ergodic block fading multiple-input multiple-output
(MIMO) channels. A 2-level bit-interleaved coded modulation
(BICM) with 16-QAM constellation is used in order to obtain
a ﬂexible scheme where one or two users can share the resources
of the relay node in order to achieve better performance. The
block fading channel is assumed to be perfectly known at the
receiver but not at the transmitter. The channel between the user
and the relay is assumed to be error free. Iterative multistage
decoding is done. The performance of the system is derived using
Monte Carlo simulation.
Keywords—Cooperative communications; MIMO channel; bit-
interleaved coded modulations; multilevel coded modulations.
I.
INTRODUCTION
Cooperative communications for wireless networks have
recently gained a lot of interest. The idea is to allow the
users of the network to cooperate and share resources in order
to provide more diversity and more resources like bandwidth
and antennas, in order to achieve better capacity, performance,
system coverage, etc. Sendonaris et al. [1] [2] proposed the
concept of cooperative diversity, with decode and forward
strategy applied by the cooperative node. T.E. Hunteret al.
[3] and B. Zhao et al. [4] studied the principles of coded
cooperation and distributed coding.
Several coded cooperation schemes based on multilevel
coded modulations (MLC) [5] or bit-interleaved coded modu-
lations (BICM) [6] were introduced [7][8][9].
In this paper, a multilevel bit-interleaved coded 16-QAM
modulation [10] with nt transmit antennas is applied by the
users or nodes in order to send information to destination
points with nr receive antennas.
In the presence of a relay node, a part or the entire data sent
by the user is retransmitted (decode and forward) by the relay
in order to achieve higher diversity. This depends on whether
or not the relay is shared by two users or is transmitting its
own data.
In the absence of a relay node, and in order to achieve better
performance, the user can reduce the data rate by sending
information over one of the two levels of the modulation.
The paper is organized as follows. The channel model is
described in Section III. In Section IV, we introduce the 2-
level BICM combined to a 16-QAM constellation. This is the
modulation used by the users and the relays in order to transmit
data. In Section V, the capacity of the proposed scheme is
derived. The iterative multistage decoder (MSD) is studied
in Section VI. The different transmission and cooperation
strategies are introduced in section VII. In Section VIII, the
performance of the different cooperation and non-cooperation
schemes are determined using Monte Carlo simulation. Results
are compared to the performance of a 1-level BICM and to
the outage probability of a non-ergodic block fading MIMO
channel.
II.
RELATED WORKS
In [7], a multilevel cooperation scheme, where each source
or relay node uses a level of the modulation, was introduced.
However, a frequency selective channel, with a single transmit
and a single receive antenna was considered. Moreover, there’s
no use of bit-interleaved coding and iterative decoding.
In [8], a one level BICM is applied by each user, and
iterative decoding is done between users or between the
decoder and the constellation. Flexible spectral efﬁciency is
reached by controlling the portion of information data repeated
by the relay.
In [9], a cooperative communications scheme, combin-
ing BICM and orthogonal frequency division multiplexing
(OFDM), is proposed.
In this paper, the main originality is the combination of
MLC and BICM into a multilevel coding scheme with a bit-
interleaved coded modulation at each level. Moreover, a MIMO
channel is considered. Notice that each source or relay uses
one level of the modulation in order to transmit its own data,
and the other levels for cooperation as in [7]. On the other
hand, iterative multistage decoding is applied. This is similar
to the second decoding strategy introduced in [8].
III.
CHANNEL MODEL
Let us consider a ﬂat fading MIMO channel with
nt transmit and nr receive antennas. The received and
the transmitted signals are related by y
=
H.x + n
where y = (y1, y2, . . . , ynr)t denotes the vector of com-
plex received signals during any given channel use, x =
(x1, x2, . . . , xj, . . . , xnt)t denotes the vector of complex trans-
mitted symbols. The superscript t stands for transpose. The
superscript h, that will be used later, stands for transpose
conjugate. The symbols xj belong to a Quadrature Amplitude
Modulation (QAM) constellation of size M
= 2m. The
129
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

channel matrix H = [hi,j] is assumed to be perfectly known at
the receiver but not at the transmitter. The fading coefﬁcients
hi,j are complex, Gaussian, circular, mutually independent and
satisfy E[|hi,j|2] = 1.
We consider the case where the channel matrix H is ﬁxed
in time. This is the so called non-ergodic block fading channel.
Notice that the ergodic fading channel is the one where the
channel matrix varies at each channel use. n denotes the vector
of additive white complex Gaussian noise with zero mean and
variance 2N0.
IV.
THE 2-LEVEL BIT-INTERLEAVED CODED
MODULATION
The 2-level bit-interleaved coded modulation with nt trans-
mit antennas is represented in Figure 1. This is a Multilevel
Coded (MLC) modulation with a Bit-Interleaved Coded Mod-
ulation at each level.
xt
bj
aj
Information
bits I
Information
bits I
Encoder 1
Encoder 2
1j
2j
N
N
b1
b2
Symbol
mapping
1
2I
I
Fig. 1.
2-level BICM transmitter.
At each level, the information bits are encoded into Nc/2
coded bits using a non-recursive non-systematic convolutional
encoder, then randomly interleaved.
Afterwards, the bits aj at level 1 and the bits bj at level
2 are mapped into Ns = Nc/4 16-QAM symbols xt. Gray
labeling of coded bits is applied as in Figure 2.
x
x
x
x
x
x
x
x
x
x
x
x
x
x
x
x
ab=00
ab=00
11
10
01
01
11
10
Fig. 2.
Gray labeled 16-QAM constellation. a → level 1. b → level 2.
Finally, the block of Ns = Nc/4 symbols is divided into
signal vectors of length nt symbols transmitted at each channel
use (the signal vector is function of L = 4.nt coded bits).
The total rate of the system in bits per channel use is
equal to R = 4 × (R1 + R2) where R1 and R2 are the rates
of encoders 1 and 2 respectively. Note that R1 and R2 are
chosen in a way to achieve the best performance. For large
code length, this is done using the capacity design rule [5],
which states that the rate Ri at level i is equal to the capacity
Ci of the equivalent channel that represents the transmission
of the bits of level i (cf. section V).
V.
CAPACITY
Let us consider an ergodic Rayleigh ﬂat fading MIMO
channel. Since H is known to the receiver and not to the
transmitter, it can be considered as part of the output. The
capacity is therefore obtained by maximizing the mutual
information I(X; (Y, H)).
It can be shown after some simple manipulations that this
quantity is equal to EH{I(X; Y|H = H)} where H denotes a
realization of H. The mutual information in this last expression
is maximized when X is a zero mean complex circularly sym-
metric Gaussian vector. This leads to the following equation
[11]:
CMIMO = EH{log2(det(Inr + ρ
nt
H.Hh))}
(1)
where ρ =
Es
N0
=
E{xh.x}
2N0
, and Es represents the total
wransmitted energy per channel use. This is also the total
energy at each receiver antenna since all elements hi,j are
independent and satisfy E{|hi,j|2} = 1.
−10
−5
0
5
10
15
20
0
1
2
3
4
5
6
7
8
9
10
Capacity in bits per channel use
ρ = Es/N0 in dB
CMIMO
C16QAM
C1
C2
Fig. 3.
Capacity of a MIMO channel. 16-QAM constellation. nt = nr = 2.
Now, in the case of a discrete 16-QAM input, the max-
imum of the mutual information is achieved by a uniform
distribution. The capacity C16QAM = EH{I(X; Y|H = H)}
is calculated using the following equation
C16QAM = EH
( 1
L
L
∑
i=1
∫
y
pH(y|xi) log
(
pH(y|xi)
1
L
∑
j pH(y|xj)
)
dy
)
(2)
where, for a ﬁxed realization H = H, the output of the channel
Y is a vector of Gaussian random variables.
pH(y|xi) ∝ exp −||y − H.xi||2
2.N0
(3)
In the case of the 2-level BICM, the random variable X
representing the input of the channel can be written as X =
(X1, X2) where X1 and X2 are the discrete random variables
representing the transmission of the coded bits of level 1 and
130
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

2 respectively. Applying the chain rule of mutual information
[12]:
I(X; Y) = I(X1; Y) + I(X2; Y|X1)
(4)
we get that the total capacity of the MIMO channel with 16-
QAM input is equal to
C16QAM = C1 + C2
(5)
where the quantities C1 = EH{I(X1; Y|H = H)} and
C2 = EH{I(X2; Y|(X1, H = H))} are the capacities of the
equivalent channels representing the transmission of the bits
at level 1 and 2 respectively.
These capacities, as well as the capacity of the MIMO
channel with continuous input, are represented in Figure 3 as
function of the signal-to-noise ratio ρ = Es
N0 .
VI.
THE ITERATIVE MULTISTAGE DECODER
The receiver, represented in Figure 4, is divided into two
parts. The ﬁrst part is non iterative and computes the received
signal conditional probabilities p(yr|c1, . . . , c4.nt) at every
antenna r using
p(yr|c1, . . . , c4.nt) = e−
||yr−∑nt
t=1
ht,rxt||2
2σ2
2πσ2
(6)
The second part of the receiver is an iterative multistage
decoder (MSD) [5]. MSD consists in decoding the ﬁrst level
of bits aj then the second level of bits bj knowing the ﬁrst
level. This is an implementation of the chain rule equation 5.

 
 
U1 
RN 
D 
Entire data 
half U1+ half U3 
U3 
Entire data 
Entire data 
Entire data 
Fig. 6.
Second cooperation strategy.
and half the coded bits bj of level 2 are retransmitted by the
relay.
VIII.
SIMULATION RESULTS
A non-ergodic block fading channel with nt = nr = 2
transmit and receive antennas is considered. For the 16-QAM
constellation, the total rate is equal to R = 4 bits per channel
use. From Figure 3, we get that the optimal code rates of
the encoders at levels 1 and 2, for R = 4, are respectively
equal to R1 = 0.6 and R2 = 0.4. The length of the coded
symbols is Ns = 100 symbols (Nb = 200 information
bits). Encoder 1 is a punctured 16-state non-recursive non-
systematic convolutional encoder with octal generators equal
to g = (23, 35). Encoder 2 is a rate-2/5 16-state non-recursive
non-systematic convolutional encoder with octal generators
equal to g = (27, 71, 52, 65, 57). The frame error rate, as
function of the signal-to-noise ratio Es
N0 in dB, is determined
using Monte Carlo simulation.
In Figure 7, we validate the good performance of the
2-level BICM by comparing it to the one obtained using a
1-level BICM based on a rate-1/2, 16-state, non-recursive
non-systematic convolutional code. We also represented the
outage probability Pout = Prob(CH < R) of the non-ergodic
block fading channel with continuous and discrete 16-QAM
inputs. Pout is the probability that the code rate is not
supported by the channel and CH is the capacity for a ﬁxed
channel use H = H. This is the optimal performance that
can be achieved over the MIMO channel.
The frame error rate of the two cooperation strategies are
sketched in Figure 8. We also represented the performance in
case of no cooperation for both, full rate (R = 4) using a
16-QAM constellation, and reduced rate (Rs = 2.4) using the
sub QPSK constellation.
In the absence of a relay node, results in Figure 8 show a
gain of 2 dB obtained by reducing the code rate to Rs = 2.4
bits per channel use. In the presence of a relay node retrans-
mitting the entire data (ﬁrst cooperation strategy), Figure 8
shows a gain close to 8 dB. However, taking in consideration
the energy transmitted by the relay, the total energy transmitted
per channel use will be Et
s = 2×Es. Therefore, the real gain is
equal to 8−10×log10(2) ≈ 5 dB. Notice that the performance
is within 2 dB of the optimal performance achieved over the
channel with a relay network retransmitting the entire data sent
by the user.
Finally, when the relay node retransmit half of the coded
symbols (second cooperation strategy), the total energy trans-
5
10
15
20
25
10
−4
10
−3
10
−2
10
−1
10
0
FER
ρ = Es/N0 in dB
 
 
Outage probability of  the channel
1−level BICM, no cooperation
2−level BICM, no cooperation
Fig. 7.
Frame error rate of the 2-level bit-interleaved coded modulation.
5
10
15
20
25
10
−4
10
−3
10
−2
10
−1
10
0
FER
ρ = Es/N0 in dB
 
 
Outage probability of the channel
No cooperation, full rate R=4
No cooperation, reduced rate Rs=2.4
First cooperation strategy
Second cooperation strategy
Fig. 8.
Frame error rate of the two cooperation strategies compared to non
cooperation.
mitted per channel use will be Et
s = 1.5 × Es. The real gain
is equal to 3.5 − 10 × log10(1.5) ≈ 1.75 dB.
IX.
CONCLUSION AND FUTURE WORK
In this paper, cooperative communications is done using a
2-level bit-interleaved coded 16-QAM modulation transmitted
over a non-ergodic block fading channel with nt = 2 transmit
and nr = 2 receive antennas. The scheme is ﬂexible allowing
cooperation to be done at half and full rate. In both cases, a
signiﬁcant improvement in performance is reached.
Further work could be on studying the cooperation between
more than two sources using an L-level BICM (L > 2).
Analyzing the performance over a frequency selective channel
is another future research item.
REFERENCES
[1]
A. Sendonaris, E. Erkip, and B. Aazhang, “User cooperation diversity,
part I: system description,” IEEE Transactions on Communications, vol.
51, November 2003, pp. 1927-1938.
132
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

[2]
A. Sendonaris, E. Erkip, and B. Aazhang, “User cooperation diversity,
part II: Implementation aspects and performance analysis,” IEEE Trans-
actions on Communications, vol. 51, November 2003, pp. 1939-1948.
[3]
T. E. Hunter and A. Nosratinia, “Cooperative diversity through coding,”
IEEE Internation Symposium on Information Theory, ISIT, Lausane,
Switzerland, July 2002, pp. 220.
[4]
B. Zhao and M. Valenti, “Distributed turbo coded diversity for the relay
channel,” IEEE Electronics Letters, vol. 39, May 2003, pp. 786 787.
[5]
U. Wachsmann, R. Fischer, and J. Huber, “Multilevel codes : Theoretical
concepts and practical design rules,” IEEE Transactions on Information
Theory, vol. 45, July 1999, pp. 1361-1391.
[6]
G. Caire, G. Taricco, and E. Biglieri, “Bit-interleaved coded modulation,”
IEEE Transactions on Information Theory, vol. 44, May 1998, pp. 927-
946.
[7]
K. Ishii, K. Ishibashi, and H. Ochiai, “Multilevel coded cooperation for
multiple sources,” IEEE Transactions on Wireless Communications, vol.
10, December 2011, pp. 4258-4269.
[8]
H. T. Nguyen, H. H. Nguyen, and T. Le-Ngoc “Bandwidth-efﬁcient Bit-
interleaved coded Cooperative Communications,” Wireless Pers Commun
(2008) 46:247-268.
[9]
T. Islam, R. Schober, R. K. Mallik, and V. Bhargava, “Analysis and
Design of Cooperative BICM-OFDM Systems,” IEEE Transactions on
Communications, vol. 59, June 2011, pp. 1742-1751.
[10] H. E. Sawaya, “Two stage bit-interleaved coded modulation for multiple-
input multiple-output channels,” IEEE Workshop on Signal Processing
Advances in Wireless Communications, SPAWC, Cannes, France, July
2006.
[11] E. Telatar, “Capacity of multi-antenna gaussian channels,” AT&T-Bell
Labs Internal Technical Memorandum, June 1995.
[12] R. Gallager, Information Theory and Reliable Communication. J. Wiley,
1968.
133
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

