A Shape Grammar with Feedback Generative Model for the Design of Compact
Microstrip Antennas
Adrian Muscat
University of Malta [adrian.muscat@um.edu.mt]
Abstract—A shape grammar based model that generates
functional initial microstrip antenna designs is developed. The
functionality of the designs is ensured with the inclusion
of a feedback mechanism that inﬂuences the rule selection
process. The grammar itself decomposes a complex shape
into a chain of rectangles, whose parameters are used in
a mathematical formula model that makes up the feedback
mechanism. This approach to antenna design is demonstrated
with the generation of compact microstrip antenna structures.
Keywords-Shape Grammar; Compact Microstrip Antenna;
Feedback; Intelligent Computer Aided Engineering;
I. INTRODUCTION
The design of compact microstrip antennas is by far a
manual task and in particular requires the antenna engineer
to combine, articulate and evolve in a constrained volumetric
space, a number of geometric shapes that yield the desired
electrical characteristics. Fig.1 shows ﬁve examples of in-
creasing design complexity. The ﬁrst design is a standard full
size single-band rectangular microstrip antenna that is not
restricted in size and its design is a straightforward process
that can be readily formalised, since the shape is always
that of a parametric rectangle. The antenna in Fig.1(b) is a
compact version of a larger single-band rectangular antenna.
A narrower and longer rectangular patch is meandered into
an S-shape. The aspect ratios of the various sections can be
varied, but the shape remains the same, however distorted
it may look. Therefore for example adding an extra twist
in the shape cannot be simply done with a change in the
value of one parameter. The antenna in Fig.1(c) is a dual-
band single feed compact design which is then modiﬁed to
accommodate within the same volume a separately fed third
band, Fig.1(d). The design process for the latter prototypes
is not obvious and difﬁcult to formalize. Additionally the
designer is rarely free to decide on the positions of the
feed and shorting posts (shown as dots in ﬁg.1) as these
are generally dictated by other system design considerations.
This means that the shape has to ﬁt around the position of
these components and not the other way round. The antenna
in ﬁg.1(e) is an example of a reconﬁgurable antenna that can
be switched between wide-band and narrow-band operation.
In such a case it is desired to use the minimum number of
switches, while at the same time, satisfy the characteristics
at a discrete number of frequency bands. The synthesis task
for this case is even more difﬁcult to formalise. Furthermore
the design task is a complex one because the electrical
characteristics are strongly coupled to the form and shape
of the antenna structure and a small change in the topology
or form can result not only in a signiﬁcant change in
performance, but can also render the design invalid. Because
of these two reasons such designs are carried out by expert
designers. Hence modifying a design to suit some additional
speciﬁcations requires a signiﬁcant time investment.
During the design process, the antenna engineer has at his
disposal two types of Computer Aided Design (CAD) tools,
empirically derived mathematical formula based models, and
full-wave numerical models. The former type is limited to
speciﬁc simple geometries, is very fast to compute, and to
some extent relates dimensional attributes to the electrical
properties. On the other hand the latter is applicable to
any arbitrary geometrical shape and is very accurate, but is
computationally intensive and does not give an explanation
of how the device works and how it can be modiﬁed to ﬁt
the speciﬁcations. During the design of compact antennas the
engineer makes use of the simple formula models to select
the components and advance the process of shape evolution
and manipulation. Once the initial form is developed nu-
merical CAD and optimisation techniques are used to reﬁne
the design, or shape. It would therefore be useful to have a
design tool that formalizes and mimics some of the informal
processes that an antenna designer goes through. This will
help speed up the synthesis task.
In [1] the use of a shape grammar with feedback based
CAD system to assist the designer in the generation of valid
and functional shapes is proposed and this system is demon-
strated on narrow constant-width-meander-line microstrip
designs. This paper extends this work to include microstrip
antennas of variable line widths and therefore shapes similar
to the ones in ﬁg.1. The grammar makes use of feedback
to yield an estimate of the electrical properties of arbitrary
shaped meander-line microstrip antennas.
Shape grammars have been originally developed by
Stiny[3] and have been used to generate architectural designs
and art works that pertain to a particular style [3], [4]. They
were later applied in engineering design for example in the
representation of solid objects [5], the design of optimal truss
structures [6], the design of coffee makers [7] and design of
microresonators [8].
57
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 1.
Microstrip and patch antenna designs (a) relatively straightfor-
ward to design and describe, (b) this design makes full use of the available
space and is harder than (a) to design, (c & d) two harder designs where
two modes are matched at the same point, and (e) an even harder problem
where the antenna can be switched between wide-band and narrow-band
operation [2].
Architectural designs have a well-deﬁned function-form
decomposition such that the generating engine ﬁrst satisﬁes
the functional requirements and then proceeds to generate
the physical forms in a particular style. However most
engineering artifacts do not have such a straightforward
form-function decomposition and are characterised by a
considerable function-form coupling. Agarwal and Cagan[9]
propose shape grammars as a new framework for geometry-
based engineering expert systems as an analysis and synthe-
sis tool. It is further stated that it is the class of products
characterised by a strong function-form coupling that stand
to gain most from formal design tools because the lack of
a pre-deﬁned generation sequence limits human designs to
a small set of valid conﬁgurations. In [9] a coupled form-
function shape grammar is proposed for the design of micro-
electromechanical resonators. This is used to generate de-
signs that function as resonators. The functional requirement
is enforced by making sure that the grammar includes all
the necessary elements that are required for the device to
function and validity is ensured in this respect. The form of
the device is then altered by choosing the rules at random
or through a search process. This however means that the
design may not necessarily meet or be close to meeting
all the required speciﬁcations for the intended applications.
However, the goal in this paper is to generate designs
that are close to satisfying all speciﬁcations without the
use of numerical CAD. An approximate model is therefore
developed and used within the generative or synthesis cycle.
The system is therefore described as a shape grammar with
feedback generative system.
The automation of the synthesis task in microstrip antenna
design has been mainly approached through the application
of the Genetic Algorithm (GA) in search of structures that
yield the required speciﬁcations. Genetic algorithms are
useful to explore poorly-understood search spaces. They
are coded with the minimum of domain knowledge and
assumptions, and use domain independent genetic operators
to explore the search space. They can be very robust and per-
sistent throughout the search but are very slow to converge to
a result and are inefﬁcient for local optimization. Systems
that rely solely on the GA, therefore, require hundreds of
iterations to reach their goal, if a solution exists in the
deﬁned search space. Several methods like pruning and
structuring of the search space can be applied to improve
the GA efﬁciency for CAD purposes. Some of these methods
are domain speciﬁc and some are not. Johnson and Yahya
Rahmat-Samii pioneered the use of the genetic algorithm
(GA) for machine evolved planar microstrip antenna shapes
that exhibit wide-band characteristics [10]. In this work a
rectangular design space is deﬁned in terms of a M × N
matrix of pixels and the GA is allowed to search new and
unknown shapes that exhibits the required speciﬁcations.
Jones and Jones developed a wire antenna array language
that deﬁnes the structure of Yagi antenna arrays and com-
bines this with a genetic programming (GP) algorithm [11].
The setup is used to obtain a machine evolved classical Yagi
structure as well non standard Yagi designs, where the GP
is allowed to try new conﬁgurations. A similar experiment
is reported by Koza [12] for loaded co-linear wire antennas
and uses the concept of a turtle that drops elements along a
linear track. In [13], a Knowledge-Based Genetic Algorithm
(KBGA) is developed to reduce the time required to evolve
novel microstrip antennas. The KBGA makes use of the
abstract shape representation described in [10] and selects
antenna design heuristics (rules of thumb) that inﬂuence the
genetic operators. The KBGA is similar to a language of
design techniques, but does not deal directly with shape.
In [14] the same encoding and crossover techniques are
used for the purpose of miniaturization. In [15] it is shown
experimentally that this encoding method is not suitable to
evolve compact structures of the types shown in Fig.1(c& d).
However this does not mean that other encoding techniques
do not yield results. The approaches described above are
limited in three ways (a) These methods call a numerical
model at each iteration and this slows down the process,
(b) the quest of these papers is machine evolved designs
rather than acting as a partner within the design team and
therefore there is little need to link any shape modiﬁcation
to its properties, and (c) these methods do not deal with the
geometric shape in a direct way.
In this paper the shape grammar is primarily used as
an automated generative tool, where the system chooses
rules to be applied based on immediate feedback on the
electrical characteristics of the partial design and on the
speciﬁcations to be met by the ﬁnal design. The feedback is
obtained through the use of the shape grammar as an analysis
tool. The emergent shapes in the design are recognized and
linked to an analytical equation that yields the electrical
58
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

characteristics. Recognition of the emergent shapes is carried
out implicitly during the shape evolution process. This is
a similar process to the procedure adopted by the human
designer where ﬁrst order models are used to evolve the
conceptual or initial shape or form. The usefulness of
this methodology lies in the fact that a large number of
designs valid for the intended application can be machine
generated allowing a system to explore a wide variety of
conﬁgurations.
The rest of the paper is organized as follows: The mi-
crostrip antenna shape grammar is ﬁrst described followed
by a discussion on how shape attributes and grammar labels
are used to obtain an approximate electrical analysis of the
structure; next, the whole process is demonstrated with an
example; in the ﬁnal section conclusions and future work
are discussed.
II. THE COMPACT MICROSTRIP ANTENNA SHAPE
GRAMMAR
A shape grammar consists of four components; the initial
shape, a ﬁnite set of shapes, a ﬁnite set of symbols and a
ﬁnite set of shape rules. A labeled shape is deﬁned as a
shape augmented by symbols. By successively applying the
transformation rules to an evolving shape, a design is derived
in the language speciﬁed by the shape grammar. Parametric
shape grammars extend shape grammars to deal with shapes
whose dimensions can be arbitrarily speciﬁed. Additionally
weights can be speciﬁed for the various shapes and used
to redeﬁne shape boolean operations. Weights ensure that
certain components are not written off by newly introduced
components. The work described in this paper makes exten-
sive use of symbols, while weights and parametric shapes
are implicitly included in the rules.
The compact microstrip antenna shape grammar is to
generate designs that ﬁt in the 2D design space available
and satisfy the electrical speciﬁcations to the point that the
structures generated can be either efﬁciently optimized with
the aid of a full-wave numerical model or combined further
to evolve reconﬁgurable structures.
In order to fulﬁll these tasks this system should (1) ensure
the inclusion of all the components necessary for the antenna
to function, (2) explore the space available so as to be able
to generate the shapes, and (3) trace the electrical current
paths from the driving point to the radiating edges so as to
be able to obtain approximate quantities for the electrical
characteristics.
In this paper the grammar is limited to describe patch
shapes that can be generated in 2D from an array of small
square shapes or pixels. Fig.2 shows some example shapes
that can be generated from an 12 × 10 array of square
pixels. The dimensions of the square pixel and the size and
boundaries of the array are variable and this arrangement can
scale-up and accommodate many real-life cases. This system
of shape representation is chosen to simplify the problem
of reasoning and interpretation of shape as well as shape
algebra. This representation has been often applied in studies
that make use of a genetic algorithm to evolve a shape that
yields the required electrical and physical characteristics,
such as in device miniaturization [14] or for wide-band
designs [10].
Figure 2.
Shapes generated from a matrix of square pixels. The grammar
described in this paper limits the number of shapes that can be generated.
Shapes (a) and (d) conform with the grammar in this paper.
In this section the basic grammar that generates one pixel-
wide meander line shapes and explores the design space is
described ﬁrst. The grammar is then extended to evolve these
initial shapes to shapes characterised by wider sections, like
the ones shown in ﬁg.1(c & d) and ﬁg.3(c). This is followed
by an explanation on how feedback is coupled with the shape
grammar to synthesize or generate valid shapes and results
are used to demonstrate the system.
Figure 3. Examples of 2D design spaces (a) rectangular shape, (b) irregular
space, and (c) Space leftover by other antenna elements - a 2D-space
optimisation problem.
A. The Basic Shapes and Symbols
The proposed grammar is a parametric 2D grammar
augmented by symbols. Fig.4 shows the basic shapes and
symbols deﬁned in this grammar. The basic shape is the
square pixel and rectangles emerge from the union of
adjacent pixels and are labeled as such. In this grammar
rectangles are deﬁned in terms of pixels rather than as a
59
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 4.
Grammar elements symbols and labels.
union of lines, as in [8]. The parametric term in this grammar
relates to the width and length of the rectangle in pixels.
Fig.5(a) shows an example of a rectangle. The symbol ’r’
is a unique integer number given to an emergent rectangle
as deﬁned by the shape rules. The diamond symbol together
with the arrows deﬁne how the pixels are connected to form
a rectangle. The arrows deﬁne the general direction to be
Figure 5.
(a) An example of how a rectangle is deﬁned, (b) an example
of how adjacent rectangles are deﬁned and connected.
followed and the diamonds deﬁne transverse paths. Fig.5(b)
depicts two rectangles adjacent to each other and also deﬁnes
the interface points, with the dot symbol. The rest of the
labels and symbols in ﬁg.4 are explained in the next section.
B. The Initial and Line Grammar Rules
Physically the compact microstrip antenna is made up of
a patch of metal supported on a substrate and attached to a
probe feed. The substrate is further backed by a ground-
plane. For the structure to perform as an antenna, these
four elements must be present; the feed or driving point, the
patch, the substrate and ground-plane. Optional components
like shorting posts and capacitive patches can also be added.
In this grammar the substrate and the ground-plane are
assumed to be inﬁnitely large and assumed to be implicitly
present. The inclusion of the feed point and the shape are
enforced by the grammar. The grammar evolves a shape as
two branches coming out of the probe feed or a shorting
post. The branches are labeled a and b and the interface
point between them is located at the probe feed or shorting
post. This setup is suitable to model structures resonating
at the fundamental mode and can also be used to model
shorted patch structures. These two types of structures are
the most common building blocks used in the design of
compact microstrip antennas.
Fig.6 shows the initial rules that deﬁne the initial patch
shape consisting of a probe feed and two branches. Rule 1
Figure 6.
The initial rules.
deﬁnes a pixel as a feed pixel. Rule 2 labels the extensible
edges with the label e. Extensible edges in this context
means that adjacent pixels can be appended to the current
pixel given that these do not touch other elements belonging
60
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

to other branches or systems. Rule 3 or 4 deﬁne the starting
points for the two branches ’a’ and ’b’. Rule 5 attaches a
pixel to one of the chosen sides and the ﬁrst rectangle is
deﬁned. Rule 6 attaches a pixel to the other chosen side
and the second rectangle is so deﬁned. This rectangle is
composed of two pixels. The initial shape is thus deﬁned
and is composed of two branches labeled a and b and the
location of the probe feed. The radiating edges or pixels are
deﬁned by labels a and b. Some possible starting shapes are
shown in ﬁg.7.
Figure 7.
Some initial shapes using the initial shape grammar of ﬁg.6.
The initial shape is further evolved or extended using the
line generation rules given in ﬁg.8. The rules are constructed
using the shape and label algebra together. The rules as
depicted here also assume that the side to be extended is
indeed extensible. One way to implement this is to include
the states of the neighbouring nodes in the rule, as depicted
in ﬁg.9. For the rest of the rules given in this paper the
provision of a mechanism that is aware of the state of the
neighbouring pixels is assumed and no further comments
on this issue are given. Furthermore ﬁg.10 deﬁnes three
operators that transform rules to suit different orientations
and an example of the rotate operator is given.
Figure 8.
Grammar rules that evolve one pixel-wide meander lines.
Fig.11 illustrates the successive application of the line
generation rules and how rectangles emerge and replace or
Figure 9.
Rule 9 deﬁned with neighbouring pixels included.
Figure 10.
Rule tranformation operators and example for the rotation
operator. This operator does not extend the shape but modiﬁes a rule, such
that it is applied in a different orientation.
modify previous ones. The arrow label indicates the direction
of where next pixel is to be found. In this case rectangles
are limited to a width of one pixel in one dimension. The
basic shape grammar of ﬁg.8 therefore generates the shapes
discussed in [1]. The grammar ensures that two and only
two branches a, b are always present; the shape evolves by
considering the extension of a branch by one pixel; and a
branch is extended if the new pixel to be added does not
touch any other pixel that is present except for the one at
the end of the branch. The shape grammar therefore ensures
that (a) the overall shape of the patch is a meandered line of
width one pixel, (b) there are no loops along the line, and
(c) one feed is always present.
61
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 11.
Application of the line grammar to evolve a shape.
C. The Extended grammar
The grammar described in the previous section is limited
to shapes made of lines that are one pixel wide. It is desired
that the grammar generates meander lines that are wider
than one pixel and of non-uniform width, commonly used
to optimise bandwidth and the driving point impedance. This
section extends the grammar with a set of rules that further
evolve a shape originally developed by the line grammar
and is termed the extended grammar. Additionally the line
grammar is implicitly used to explore the design space and
therefore takes into consideration other concurrent shapes
common in multi-band designs. The initial shape for the
extended grammar is therefore the ﬁnal shape evolved with
the line grammar rules. The ﬁnal shape for the extended
grammar is a line deﬁned by a chain of rectangles rather than
pixels. Subsets of the extended grammar can also be deﬁned
to generate speciﬁc shapes, like for example rectangular
shapes, L-shapes and C-shapes.
The extended grammar starts with a modiﬁcation to the
line grammar. Rule 4 is removed from the initial rule set.
Fig.12 shows Rule 10 and Rule 11 that deﬁne how the line
in the vicinity and including the probe feed is extended.
Figure 12.
Shape rules in the vicinity of and including the probe feed.
Fig.13 and ﬁg.14 give the rules for widening the line at
corner sections, while ﬁg.15 deﬁnes how branch ends are
widened or extended. The rules given in ﬁgs.12, 13, 14 &
15 must be applied in pairs. Fig.16 combines rules to widen
a straight run, a U shape and an S-shape. Likewise in ﬁg.17
an S-shape is evolved into a straight run and the branch end
62
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 13.
Shape evolution at the inside of corners.
is widened. The rules update the symbols accordingly and
the chain of rectangles comes out in an implicit way as a
product of the application of the rules. Fig.18 shows how the
staircase line evolves into a straight tapered run consisting of
rectangles of different widths. At this point no further rules
can be applied on the right hand side other than Rule 19 at
the end of the branch. The end result may not be desired
in practice but it demonstrates how rectangles emerge and
replace other rectangles, while at the same time maintain the
ﬂow of arrows along the path.
In general an edge is extended as follows: an edge for
extension is ﬁrst chosen, based on extensibility and priority
or a random list; this is followed by a search for a rule that
matches the section and if the search is successful the change
is carried out. Probabilities in the rule selection can be used
to inﬂuence the path taken by the line grammar. Fig.19 gives
some examples of shapes generated by the shape grammar.
Subsets of the grammar can also be deﬁned to describe
particular classes of shapes, for example L-shape, C-Shape,
G-shape. These shapes can be recognized from the number
Figure 14.
Shape evolution at the outside of corners.
of corners and the sense of arrow directions. These features
can be deﬁned as a subset of rules, some of which having
a limit on the number of rule instances that can be applied.
Other shapes having other features like for example, wider
branch ends than the rest of the line can be deﬁned as a
sequence of rules, that when applied generate these speciﬁc
shapes.
D. The Grammar in Analysis
The antenna electrical properties of major interest are
the frequency of operation, input impedance, efﬁciency,
radiation pattern and bandwidth. In compact antenna design,
radiation patterns are usually not a design variable since
the designer has very limited ability to control the patterns
[16] and most often exhibit omni-directional properties
characterised by considerable cross-polar levels. Efﬁciency
is a function of many variables including materials used and
bandwidth is mostly a function of physical conﬁguration,
including shape characteristic and is catered for by the
sequence of the grammar rules applied as described in the
previous section. Furthermore, in practice, the bandwidth is
usually enhanced with a matching circuit[17]. The frequency
63
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 15.
Shape evolution at branch end.
of operation and the input impedance are the two properties
that need to be considered explicitly in the analysis task and
this section describes how these are estimated.
In theory the microstrip antenna resonates at an inﬁnitely
number of modes. However it is mostly used in its funda-
mental mode which is excited when the size of the patch is
roughly half a wavelength long in at least one dimension, or
quarter of a wavelength long for shorted patches. This is the
concept on which the simple and natural transmission line
model for the microstrip antenna is built. The transmission
line model treats the antenna as a transmission line with
open or shorted ends. Additionally the height of the substrate
and size of the ground plane have some minor effects
on the value of the frequency of resonance. The input
impedance is modeled on a standing wave analysis that
gives the impedance as a function of position. The effect
of the patch width has a considerable effect on the input
impedance and the height of the substrate usually effects
the inductive part because of the higher inductance of the
probe feed. These models are used as guides by the compact
antenna designer during the initial design stage where ex-
actness and high accuracy are not the priority. The designer
follows rules of thumb to relate the shape of the compact
antenna to these models and obtains an approximation of
the electrical characteristics prior to optimisation using a
Figure 16.
Set one of Modiﬁcation rules in pairs.
numerical model. The feedback mechanism in the generative
grammar reported in this paper models this analysis process
and therefore can be thought of as a formalization of the
transmission line model applied to the analysis of the shapes
generated by the shape grammar, i.e. shapes that range from
straight lines to irregular meander lines.
The main task for the algorithm is to analyze the shape
and link its geometrical attributes and dimensions to the
transmission line model. This is carried out by decomposing
the shape into rectangles and tracing the current paths that
are required to estimate the resonant frequency and the input
impedance. These two tasks are carried out implicity by
the grammar rules. The next step is to pick up the shape
attributes that are used as inputs in the formula models
to yield the electrical properties. The previous discussion
highlighted that the main attribute used in the calculation of
the frequency of resonance as well as the input impedance,
is the effective length of the current path. Other physical
characteristics of the structure that have less effect on the
electrical characteristics are the height of the substrate and
the shape itself - how compact the shape is as well as the
aspect ratios of the sub-shapes.
The mechanism of this process is ﬁrst discussed and
64
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 17.
Set two of Modiﬁcation rules in pairs.
Figure 18.
Stair-case line evolved to a quasi straight run by applying the
extended grammar
demonstrated for shapes derived from the grammar of ﬁg.8,
and later for shapes derived by the whole grammar, i.e
including the extended grammar. A set of metrics is adopted
and listed below, where reference is made to ﬁg.20.
1) Number of corners along the meandered line. This is
split into two. NCa is equal to the number of corners
along branch a, and NCb is equal to the number of
corners along branch b.
2) Length of meandered line in terms of pixels. This
is split in two. La is equal to the number of pixels
between A and B, and Lb is equal to the number of
Figure 19.
Examples of shapes generated by the shape grammar.
pixels between A and C.
3) Separation in space of the two end points, B and C.
This is equal to distance BC.
4) Angle subtended by lines AB and AC. This angle is
equal to θ.
Metrics 1 and 2 are used in the calculation of the effective
lengths and metrics 3 and 4 give an indication of the
compactness of the structure.
Figure 20.
Metrics that are used to obtain properties of the shape.
The next step is to relate the metrics to the electrical
properties, so as to be able to carry out the approximate
quantitative analysis desired for the feedback mechanism.
In general the relationship can be described by a weighted
function of the shape properties as,
EPn =
∑
Weighted Shape Metrics,
(1)
where EPn is the electrical property under consideration.
For this purpose a set of 20 random elements are generated
from the grammar without feedback of ﬁg.8. Fig.21 shows
the algorithm used to generate these elements. Table I lists
the data collected for the 20 elements. The shape is described
by the metrics, and the electrical properties are obtained
with a Finite-difference-Time-Domain (FDTD) numerical
tool developed by the author [18]. The next step is to
select the shape properties that have a strong inﬂuence on
65
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

01
Generate initial shape and deﬁne branches
02
Choose a branch to extend. The choice is based on
a random number and the probability of a branch
being selected more often than the other is variable
03
Check if branch is extensible: If YES repeat step
02. If no extensible branch can be found terminate
element
04
Extend branch in a random extensible direction
05
Decide with a probability of Pcontinue whether to
continue extending the branches. If YES goto step
02 else terminate element
Figure 21.
Algorithm Generate Random Elements
each electrical property. In general this could be posed as a
regression problem. In this paper, microstrip antenna design
experience discussed previously supported by scatter plots
are used to guide the selection of the most signiﬁcant metrics
to approximate the resonant frequency and driving point
impedance.
The resonant frequency, f0 is dependent mostly on the
effective length of the meandered line given by (pathx +
pathy) in ﬁg.20, which in turn is a function of La, Lb and
NC. Scatter plots for these variables against f0 conﬁrm a
higher dependence on the branch lengths than on the number
of corners present, ﬁg.22. The relationship for f0 derived by
considering the simple transmission line model is,
f0
=
3 × 10−4/((La + Lb + 2a0
−(NCa + NCb) ∗ a1) ∗ Lp ∗ 2)
(2)
The coefﬁcients a0 and a1 are obtained by minimizing the
error and Lp is the width of the square pixel in millimeters.
The angle θ and distance BC are ignored in this equation
because the frequency’s sensitivity to these is minimal.
The driving point impedance depends mostly on the
relative position of the feed point along the current path.
Another set of scatter plots, ﬁg.23 conﬁrm that, Zin, depends
on the relative position of the probe feed to the ends of the
line. The scatter plots for the angle θ and the normalized BC
metrics show a weak and inconclusive relationship with Zin
and therefore are not included in the model. The model does
not yield a numerical value for Zin but gives an indication
of how far away it is from 50Ω, the system impedance.
The input impedance estimate is obtained by considering the
B0 : B1 ratio from which it is derived that when the ratio
is close to 0.85 the input impedance is in close proximity to
50Ω. These two relationships are used to obtain an estimate
for the frequency of resonance and the input impedance level
for the structures of I. The set of designs in table I group is
termed the Tuning Set as it is used to obtain the coefﬁcients
a0 and a1 in eq.2 using a trial and error approach. The values
1
2
3
4
5
6
7
8
9
10
0
5
10
15
20
25
30
35
40
45
Total Path Length (Element Squares)
Frequency (GHz)
La+Lb
La+Lb−NC
Figure 22.
Scatter plot for the resonant frequency.
0
0.2
0.4
0.6
0.8
1
0
100
200
300
400
500
End Separation
Input Impedance (mag)
(a)
0
50
100
150
200
0
100
200
300
400
500
Angle
Input Impedance (mag)
(b)
0.4
0.5
0.6
0.7
0.8
0.9
1
0
100
200
300
400
500
Branch Ratio
Input Impedance (mag)
(c)
Figure 23.
Scatter plots for the input impedance.
for the optimised coefﬁcients are a0 = 0.6 and a1 = 0.31.
The last two columns in table I give the estimated frequency,
and the error. The average error is 2.96% with a standard
deviation of 2.03.
A second set elements was generated using the same
algorithm as that for the tuning set. This second set is
used as a Validation Set. The average error in the estimated
frequency is 3.15% with a standard deviation of 1.85.
The randomly generated elements for the tuning set span
the frequency range from approximately 1 to 7GHz and a
histogram of these shows that their distribution is approx-
imately uniform especially in the 1 to 4GHz range. The
model is therefore ﬁtted to this wide frequency range. A
plot of the averaged error against frequency shows a gentle
downward slope favoring the high frequencies. The same
observations are noted in the validation set. If a smaller error
66
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Table I
TUNING SET
#
La
Lb
NC
NCa
NCb
BC
Θ
B0 : B1
B0/(B0 + B1)
F0
Zin
f0
Error
0
10
5
9
6
3
33.4
88
0.56
0.63
2.67
hi
2.72
1.70
1
4
2
1
0
0
17.6
90
0.61
0.66
5.14
me
5.14
0.08
2
4
1
3
2
0
14.5
132
0.47
0.71
6.4
me
6.61
3.34
3
10
3
7
6
1
33.4
129
0.41
0.71
2.85
hi
3.02
5.86
4
12
11
13
7
5
25.2
52
0.97
0.32
1.82
lo
1.82
0.17
5
11
6
6
4
2
32.1
72
0.60
0.50
2.3
hi
2.24
2.60
6
5
4
5
1
3
17.0
81
0.72
0.50
4.2
me
4.14
1.34
7
2
9
6
1
4
32.1
159
0.31
0.79
3.4
me/hi
3.49
2.69
8
4
2
3
2
0
17.6
111
0.69
0.73
5.5
me
5.62
2.22
9
9
3
5
2
2
12.6
64
0.37
0.28
3.05
hi
3.11
2.03
10
12
15
14
6
8
12.0
16
0.83
0.13
1.55
lo
1.55
0.27
11
8
2
7
6
0
28.3
122
0.43
0.80
3.83
hi
3.98
3.83
12
11
4
7
4
2
37.8
137
0.41
0.68
2.64
hi
2.60
1.56
13
15
2
7
6
1
44.1
180
0.20
0.70
2.2
hi
2.28
3.75
14
12
31
18
2
15
20.2
29
0.45
0.13
1.02
hi
0.96
5.78
15
12
9
7
3
3
29.0
57
0.75
0.37
1.92
me
1.84
4.40
16
27
8
23
16
6
36.5
78
0.31
0.32
1.29
hi
1.27
1.36
17
13
10
9
7
1
32.1
55
0.90
0.38
1.8
me
1.72
4.48
18
7
4
2
2
0
22.0
15
0.68
0.48
3.27
me/hi
3.13
4.27
19
18
16
18
11
7
28.3
71
0.95
0.24
1.35
lo
1.25
7.47
is desired the model can be ﬁtted over a smaller frequency
range. In this case the grammar will have associated with
it a set of coefﬁcient vectors from which the appropriate
one has to be selected. In the modelling mode this has to
be carried out at least over a two step iteration. However
for the initial design phase a smaller error is generally not
required.
The model is tested in the synthesis task. The simple
synthesis algorithm in ﬁg.24 was developed for this purpose.
The task of the algorithm was to develop a structure that
01
Set
frequency
of
resonance
and
desired
input
impedance
02
Start Synthesis
03
Generate initial shape at a random position
04
Obtain an estimate for the input impedance
05
If the input impedance estimate is greater than the
target randomly pick one branch that can be ex-
tended, else pick the shortest branch that can be
extended
06
If neither branch is extensible then terminate synthe-
sis
07
Extend branch in a random extensible direction
08
Obtain an estimate of the resonant frequency: If
estimate is less than the desired value terminate
synthesis else repeat as from step 04
Figure 24.
Algorithm Synthesize Elements
resonates at 2.0GHz and provides a close match to 50Ω.
The algorithm terminates either when the speciﬁcations are
satisﬁed or when the shape cannot be changed any more.
Further more, since the feed is ﬁxed at a given position,
it may be the case that the desired input impedance is
unattainable. In this case the algorithm does not attempt to
shift the feed. Table II lists ten structures that have been
developed by this algorithm. All ten cases were simulated
Table II
SYNTHESIS SET
#
Freq
Freq
Prediction
Target
Branch
Zin
Target
Model
FDTD
Error
Error
Ratio
FDTD
Error
0
1.954
2.03
3.744
2.300
0.881
53.0
6
1
1.947
2.01
3.132
2.648
0.912
13.0
74
2
1.954
2.02
3.260
2.293
0.963
15.0
70
3
1.986
2.01
1.183
0.689
0.993
35.0
30
4
1.994
2.07
3.690
0.300
0.939
44.0
12
5
1.923
1.91
0.685
3.846
0.851
45.0
10
6
1.994
2.10
5.048
0.300
0.869
57.0
14
7
1.986
2.00
0.689
0.689
0.902
80.0
60
8
1.994
2.08
4.153
0.319
0.869
60.0
20
9
1.923
1.98
2.875
3.846
0.879
40.0
20
with the FDTD numerical tool and the average error in the
resonant frequency is 2.85% with standard deviation of 1.5,
whereas the average deviation from the 2.0GHz desired
is 1.72% with a standard deviation of 1.44. The average
error for the input impedances is 31.8% with a standard
deviation of 26.2. This ﬁgure seems high. However, the
input impedance is a very sensitive quantity and for this
type of model it should be considered sufﬁciently accurate.
Furthermore the accuracy required depends on where and
how the model is utilized in practice. Certainly it is an area
for further study.
The method described above cannot be applied directly
to shapes evolved with the extended grammar and a general
67
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

method that can be applied to any shape is desired. The
way the effective length is calculated is modiﬁed. Fig.25(a)
demonstrates how this is done. The dot symbols that deﬁne
the interface points for the rectangles are joined together
by straight lines and the summation of the length of these
lines gives the initial effective length, which is equivalent to
(La +Lb) in eqn.2. The ﬁnal effective length is corrected in
the same way as in the previous section, i.e. by considering
the number of corners as well as the coefﬁcients a0 and a1.
To test this method the tuning set is used and the updated
coefﬁcients are a0 = 0.55 and a1 = 0.02. The average error
is 2.82% with standard deviation of 1.95. The average error
for the validation set is 3.32% with a standard deviation of
2.02%.
Figure 25.
Evaluation of the effective length.
The accuracy of the formula model (eqn.2) when applied
for shapes evolved with the extended grammar is discussed
next. Three slightly different approaches are considered
in calculating the effective length for the branches; (1)
(La + Lb) is equivalent to the minimum length end to
end path passing through the sub-shapes interface points
and the feed point, (2) (La + Lb) is equivalent to the
length of the path passing through the midpoint of each
sub-shape interface zone (ﬁg.25(b)), and (3) (La + Lb) is
equal to the sum of the lengths of all the rectangles that
make up the shape. A set of ﬁfty prototypes that operate
over a frequency range of 1 to 4 GHz and various shapes
ranging from rectangular to L-shapes and meander lines
are simulated with the FDTD model and used as a second
tuning set. This set is used to optimise the a0 and a1
coefﬁcients. For approach (1) a0 = 0.60 and a1 = 0.30
and the average error is 6.73% with a standard deviation
of 6.90. For approach (2) a0 = 0.55 and a1 = 0.20 and
the average error is 4.72% with a standard deviation of
3.19, and for approach (3) a0 = 0.60 and a1 = −0.28
and the average error is 5.75% with a standard deviation of
8.13. For (1) and (2) the path length is underestimated and
therefore the a1 coefﬁcients are negative. The results show
that approach (2) performed best. Intuitively this approach
is the closet to approximating the current path along the
antenna structure. However approach (3) has the advantage
of being less computationally intensive. It is also possible to
obtain higher accuracies if the set is restricted to a particular
type. The errors are greatest for the most irregular shapes and
when the interface width between rectangles is greater than 1
pixel. The simple formula model does not take into account
the various widths of the rectangles and how they scale
relative to each other. The accuracy is however adequate for
its intended application, i.e for the conceptual design stage.
This does not mean that a better model is not possible and
this issue is further discussed in the last section.
Figure 26.
Stages during the design process of a tri-band separately fed
structure.
This section ends with a multi-band structure. The design
of multi-band structures can be either evolved separately
or simultaneously. Fig.26 depicts an extracted sequence of
interim designs during the evolution of a three element
antenna with separate feed structures. Fig.26(a) is the result
of applying the line grammar rules to the three elements
simultaneously. In ﬁg.26(b) the structure on the left-hand-
side is widened but is short from satisfying the speciﬁcations
and can’t be further evolved. Therefore in ﬁg.26(c) the other
designs are removed and the ﬁrst structure is allowed to
evolve, at which point the other structures are evolved again.
Fig.26(d) shows the ﬁnal design, that can be further evolved
if necessary. The intention of this design is to operate as a
single feed dual-band antenna at 0.925GHz and 1.8GHz
68
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

and a separately fed antenna for 2.45GHz. These frequen-
cies correspond to cellular licensed mobile communications
bands and the unlicensed Industry, Scientiﬁc and Medical
(ISM) band. The frequencies of operation as predicted by
the shape grammar in analysis are 1.86GHz, 1.05GHz, and
2.47GHz, while the respective deviations from the target
values are 3.5%, 13.2% and 2.1%. These deviations are not
due to errors in the analysis model, but are function of the
stopping criteria in the application process of grammar rules.
The two major shapes derived by the grammar are joined
together to create a single feed dual-band structure and
shorting planes are added. The third shape is fed separately.
The height of the substrate is 4mm and εr = 1.0. The
resulting structure, ﬁg.27, is analyzed numerically (FDTD).
The frequencies obtained from the FDTD model for the
three fundamental modes are 0.85GHz, 1.69GHz, and
2.52GHz and the deviations from the grammar model for
the grammar derived shapes are 18%, 9% and 2%. The high
deviation for the dual-band structure is due to the increase
in length when the two shapes are joined together and due
to the shorting plane which is shorter than the width of
the line. The input impedance is also close to the system
impedance of 50Ω for both feeds. The next step for the
antenna engineer is to proceed to the second phase of the
design and optimise the structure so as to deliver the ﬁnal
design prior to measurements. Potential variables for the
optimisation stage are indicated in ﬁg.27 with lines ended
in arrows. The optimisation process does not change the
character of the shape itself, but varies the dimensions of
the sub-shapes or rectangles.
Figure 27.
The numerical model ready for optimisation derived from
ﬁg.26(d). The arrows and positions for the probe feeds are suggested
variables for the optimisation process. Possible variables for optimisation
are indicated by the arrow-ended-lines.
III. CONCLUSIONS
This paper described an original microstrip antenna shape
grammar that generates compact designs similar to meander
line structures, as well as some standard shapes. The shape
derived is represented as a chain of rectangles identiﬁed
by labels and symbols. The decomposition into sub-shapes
or rectangles is carried out by the grammar itself. The
radiating edges are labeled and the nature of the shape can
be derived from the orientation and sequence of the arrow
symbols. A set of sub-shape and full-shape parameters are
used as variables in a mathematical formula model that
yields approximate values for the electrical characteristics.
The result from the formula is used as feedback to guide
the selection of rules and therefore shape evolution. The
shape grammar is useful to synthesize and analyze compact
microstrip antennas.
The shape grammar is a tool for the conceptual or initial
design stage prior to the optimisation of the details. This tool
formalizes and mimics some of the informal processes that
an antenna designer goes through. The rule selection can be
done by the machine to generate a wide variety of potentially
useful designs and can form the basis of an Intelligent Com-
puter Aided Engineering (ICAE) software. Forbus describes
an ICAE system as a junior partner in the design team and
the goal for the system is to capture a signiﬁcant fraction
of an engineer’s knowledge that is later used to generate
potential designs as well as modiﬁcations[19]. The shape
grammar described in this paper provides such a tool and can
be used to record design knowledge that can be used later.
Alternatively the shape grammar can be integrated as part
of a CAD software and the rules applied manually by the
designer. The feedback mechanism automatically provides
an estimate of the electrical properties of the antenna.
In this paper feedback is demonstrated with a simple
weighted function. This function performs very well for
the narrow line designs but its accuracy degrades when
more variables are introduced. Not surprisingly the results
show that the accuracy of the quantitative results improve
if the formula is ﬁtted over a narrow range of shapes and
frequencies. Nevertheless, the accuracy of the model is still
good enough for the initial design phase. On the other hand it
is always desired to have a single model applicable to a wide
range of devices. The inclusion of more variables and non-
linear terms may improve the results. Of special interest is
the use of Neural Network architectures (NN) as black boxes
that replace the CAD formula. This model is suitably applied
to well known and understood conﬁgurations. Geometrical
dimensions are selected as inputs to a NN which in turn
yields the electrical properties of the device. This approach
has been shown to work for planar and microstrip antennas
[20],[21],[22] and [23]. It would also be very useful to the
designer if the model gives an estimate of how accurate
the result is [24]. The work presented in this paper may be
augmented with NN to automate the analytical derivation of
the approximate model used in the generative system.
The work reported in this paper demonstrates the fea-
sibility of a shape grammar based model that can act as
an assistant to the designer. It would therefore be useful
to extend this grammar to include other conﬁgurations and
components such that it has a wider range of applicability.
69
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Equally interesting should be the application of boolean
shape operations to shapes generated by the grammar to
extract sub-shapes that can be re-interconnected by switches.
Such a tool would be very useful during the design of re-
conﬁgurable antennas.
REFERENCES
[1] A. Muscat, “A shape-function grammar approach for the
synthesis and modelling of pixel-microstrip-antennas,” in Ad-
vanced Engineering Computing and Applications in Sciences,
2009. ADVCOMP ’09. Third International Conference on,
pp. 23 –28, 11-16 2009.
[2] J. R. Kelly, E. Ebrahimi, P. S. Hall, P. Gardner, and
F. Ghanem, “Combined wideband and narrowband antennas
for cognitive radio applications,” in Cognitive Radio and
Software Deﬁned Radio: Technologies and Techniques, IET,
18th September 2008.
[3] G. Stiny and W. J. Mitchell, “The palladian grammar,”
Environment and Planning B, vol. 5, pp. 5–18, 1978.
[4] U. Flemming, “More than the sum of parts: the grammar of
queen anne houses,” Environment and Planning B: Planning
and Design, vol. 14, pp. 323–350, 1987.
[5] P. A. Fitzhorn, “Formal graph languages of shape,” Artiﬁcial
Intelligence for Engineering Design, Analysis and Manufac-
turing, vol. 4, no. 3, pp. 151–164, 1990.
[6] K. Shea and J. Cagan, “The design of novel roof trusses
with shape annealing: assessing the ability of a computational
method in aiding structural designers with varying design
intent,” Design Studies, vol. 20, pp. 3–23, 1997.
[7] M. Agarwal and J. Cagan, “A blend of different tastes:
the language of coffemakers,” Environment and Planning B:
Planning and Design, vol. 25, pp. 205–226, 1998.
[8] M. Agarwal and J. Cagan, “A micro language: generating
mems resonators by using a coupled form-function shape
grammar,” Environment and Planning B: Planning and De-
sign 2000, vol. 27, pp. 615–626, 2000.
[9] M. Agarwal and J. Cagan, “On the use of shape grammars
as expert systems for geometry-based engineering design,”
Artiﬁcial Intelligence for Engineering Design, Analysis and
Manufacturing, vol. 14, pp. 431–439, 2000.
[10] J. M. Johnson and Y. Rahmat-Samii, “Genetic algorithms
in engineering electromagnetics,” vol. 39, pp. 7–25, August
1997.
[11] E. A. Jones and W. T. Jones, “Genetic design of linear antenna
arrays,” IEEE Antennas and Propagation Magazine, vol. 42,
pp. 92–100, June 2000.
[12] J. R. Koza, S. H. Al-Sakran, L. W. Jones, and G. Manassero,
“Automated synthesis of a ﬁxed-length loaded symmetric
dipole antenna whose gain exceeds that of a commercial
antenna and matches the theoretical maximum,” in GECCO,
(London, UK), pp. 2074–2081, ACM, July 2007.
[13] A. Muscat, The Design of Low Gain, Wideband and Multi-
band Antennas Employing Optimisation Techniques, ch. Opti-
misation Based Design, pp. 120–174. Queen Mary University
of London, January 2002.
[14] N. Herscovici, M. F. Osorio, and C. Peixeiro, “Miniaturization
of rectangular microstrip patches using genetic algorithms,”
IEE Antennas and Wireless Propagation letters, vol. 1,
pp. 94–97, 2002.
[15] A. Muscat and J. Zammit, “An efﬁcient algorithm for the con-
trol of reconﬁgurable pixel microstrip antennas,” in Advances
in Circuits, Electronics and Micro-electronics, 2009. CENICS
’09. Second International Conference on, pp. 44 –47, 11-16
2009.
[16] B. S. Collins, Antennas for Portable Devices, ch. Handset
Antennas, pp. 9–57. John Wiley & Sons, 2007.
[17] S. Kingsley, D. Ireland, S. O’Keefe, R. Langley, and L. Liu,
“In search of the perfect handset antenna,” in Antennas and
Propagation Conference, 2008. LAPC 2008. Loughborough,
pp. 62 –65, 17-18 2008.
[18] A. Muscat, The Design of Low Gain, Wideband and
Multi-band Antennas Employing Optimisation Techniques,
ch. FDTD Model for The Patch Antenna, pp. 68–118. Queen
Mary University of London, January 2002.
[19] K. D. Forbus, “Intelligent computer-aided engineering,” AI
Magazine, vol. 9, no. 3, pp. 23–36, 1988.
[20] K. C. Gupta, “Emerging trends in millimeter-wave cad,” IEEE
Transactions On Microwave Theory And Techniques, vol. 46,
pp. 747–755, June 1998.
[21] H. J. Delgado and M. H. Thursby, “A novel neural network
combined with fdtd for the synthesis of a printed dipole
antenna,” IEEE Transactions On Microwave Theory And
Techniques, vol. 53, pp. 747–755, July 1998.
[22] S. Sagiroglu, K. Guney, and M. Erler, “Calculation of band-
width for electrically thin and thick rectangular microstrip
antennas with the use of multilayered perceptrons,” Inter-
national Journal of RF and Microwave Computer Aided
Engineering, vol. 9, pp. 277–286, 1999.
[23] K. Guney, S. Sagiroglu, and M. Erler, “Generalized neu-
ral method to determine resonant frequencies of various
microstrip antennas,” International Journal of RF and Mi-
crowave Computer Aided Engineering, vol. 12, p. 131139,
2002.
[24] R. C. Booton, “Microwave cad in the year 2010 - a panel
discussion,” International Journal of RF and Microwave
Computer-Aided-Engineering, vol. 9, pp. 439–448, 1999.
70
International Journal on Advances in Systems and Measurements, vol 3 no 1 & 2, year 2010, http://www.iariajournals.org/systems_and_measurements/
2010, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

