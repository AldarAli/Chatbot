Colon Blood Vessel Detection Based on U-net
Hiroyasu Usami Yuji Iwahori
Department of Computer Science
Chubu University
Kasugai, 487-8501 Japan
Email: usami@cvl.cs.chubu.ac.jp
Email: iwahori@cs.chubu.ac.jp
Naotaka Ogasawara Kunio Kasugai
Department of Gastroenterology
Aichi Medical University
Nagakute, 480-1195 Japan
Email: nogasa@aichi-med-u.ac.jp
Email: kuku3487@aichi-med-u.ac.jp
Abstract— Detection and analysis of colon blood vessels play a
signiﬁcant role in medical diagnosis. This paper proposed the colon
blood vessel detection method based on the U-net architecture with
a few training images. The proposes method performs better colon
blood vessel detection with a few training images from experiments
result.
Keywords–Colon Blood Vessel Detection; CNN; U-net; Biomed-
ical Image Processing.
I.
INTRODUCTION
Detection and analysis of colon blood vessels play a
signiﬁcant role in medical diagnosis in a large number of
areas like retinopathy, endoscopy, etc. Colon blood vessel
lesions are frequently derived from malignant polyps. While
some algorithms [1]-[4] are proposed for retina blood vessel
extraction, they can not be used in an endoscope environment
as well. The algorithms based on convolutional neural network
(CNN) [3] [4] perform high precision in retina blood vessel.
However, common CNN needs massive datasets. It is difﬁcult
to prepare massive datasets with mask images in biomedical
image processing. The typical use of convolutional networks
is for the classiﬁcation tasks, where the output of an image is a
single class label. However, in many visual tasks, especially in
biomedical image processing, the desired output should include
localization, i.e., a class label is supposed to be assigned to
each pixel. This paper proposes a method based on the U-
net architecture [5] for colon blood vessel detection with a
few training images. Section II explains the proposed method,
Section III mentions experiments and Section IV concludes the
paper.
II.
POPOSED METHOD
The U-net is a network and training strategy that relies
on the active use of data augmentation to use the available
annotated samples more efﬁciently, and it is the so-called “
fully convolutional network”[6]. The proposed method based
on this architecture works with a few training images to try
better colon blood vessel detection.
The network architecture of the proposed method is shown
in Fig. 1. The network architecture was constructed with less
down sampling layers because the resolution of the targeted
endoscope images is not high.
Figure 1. Network Architecture
The network architecture details are as follows. The loss
function is the cross-entropy and the neural network employees
the stochastic gradient descent for optimization. The activation
function after each convolutional layer is the Rectiﬁer Linear
Unit (ReLU) and between two consecutive convolutional layers
use a dropout of 0.2 empirically set.
The following pre-processing is performed for the training
datasets before training.
•
Gray-scale conversion
•
Normalization
•
Contrast-limited
adaptive
histogram
equalization
(CLAHE)
•
Gamma adjustment
The neural network is trained based on sub-images
(patches) of the pre-processed full images. Each patch with
dimensions 48x48 is obtained by randomly selecting its center
inside the full image. Sample patches are shown in Fig. 2. Also,
selected patches partially or entirely outside the Field Of View
(FOV), thus the neural network learns how to discriminate the
FOV border from the blood vessels.
23
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-612-5
PATTERNS 2018 : The Tenth International Conference on Pervasive Patterns and Applications

Figure 2. Sample of Patches
III.
EXPERIMENTS
An evaluation experiment was conducted to conﬁrm the
effectiveness of the proposed method.
A. Training
A set of 142,500 patches was obtained by randomly ex-
tracting 71,250 patches in each of 15 training images. Although
the patches overlap, i.e., different patches may contain a same
part of original images, no further data augmentation was
performed. The ﬁrst 90% of the dataset was used for training
(128,250 patches), while the remained 10% was used for
validation (14,250 patches). Training was performed for 150
epochs, with a mini-batch size of 32 patches. It took about 4
hours using GeForce GTX 1080 GPU × 4 for the training.
B. Evaluation of the trained model
The vessel probability of each pixel was obtained by
averaging multiple predictions to improve the performance.
With a stride of 5 pixels in both height and width, multiple
consecutive overlapping patches were extracted in each test
image. Then, the vessel probability was obtained for each
pixel by averaging probabilities over all the predicted patches
covering the pixel.
Fig. 3 shows the results of colon blood vessel detection
and overall accuracy of the prediction comparison with correct
mask image was 0.8432.
Figure 3. Example of Prediction Results
Fig. 4 shows the Area Under the ROC curve (AUC ROC)
of the evaluation, and AUC was 0.9030.
Figure 4. AUC ROC
IV.
CONCLUSION
This paper proposed the colon blood vessel detection
method based on the U-net architecture with a few training
images. It was conﬁrmed that the proposed method performs
better colon blood vessel detection with a few training im-
ages from experiment results. Applying the proposed method
to another kind of endoscope image such as Narrow Band
Imaging (NBI) and detecting malignant polyp based on results
are future works.
ACKNOWLEDGEMENT
Iwahori’s research is supported by Japan Society for the
Promotion of Science (JSPS) Grant-in-Aid Scientiﬁc Re-
search(C)(#17K00252) and Chubu University Grant.
REFERENCES
[1]
Frangi, A. F., Niessen, W. J., Vincken, K. L., & Viergever, M. A.
(1998, October). Multiscale vessel enhancement ﬁltering. In International
Conference on Medical Image Computing and Computer-Assisted Inter-
vention (pp. 130-137). Springer, Berlin, Heidelberg.
[2]
Azzopardi, G., Strisciuglio, N., Vento, M., & Petkov, N. (2015). Trainable
COSFIRE ﬁlters for vessel delineation with application to retinal images.
Medical image analysis, 19(1), 46-57.
[3]
Melinˇsˇcak, M., Prentaˇsi´c, P., & Lonˇcari´c, S. (2015, January). Retinal
vessel segmentation using deep neural networks. In VISAPP 2015 (10th
International Conference on Computer Vision Theory and Applications).
[4]
Liskowski, P., & Krawiec, K. (2016). Segmenting retinal blood vessels
with deep neural networks. IEEE transactions on medical imaging,
35(11), 2369-2380.
[5]
Ronneberger, O., Fischer, P., & Brox, T. (2015, October). U-net: Con-
volutional networks for biomedical image segmentation. In International
Conference on Medical image computing and computer-assisted inter-
vention (pp. 234-241). Springer, Cham.
[6]
Long, J., Shelhamer, E., & Darrell, T. (2015). Fully convolutional net-
works for semantic segmentation. In Proceedings of the IEEE conference
on computer vision and pattern recognition (pp. 3431-3440).
24
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-612-5
PATTERNS 2018 : The Tenth International Conference on Pervasive Patterns and Applications

