27
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Spatio-Temporal Density Mapping for Spatially Extended Dynamic Phenomena  
- a Novel Approach to Incorporate Movements in Density Maps
Stefan Peters  
Department of Geoinformation 
Universiti Teknologi Malaysia 
Johor Bahru, Malaysia 
e-mail: stefan.peters@directbox.com 
Liqiu Meng 
Department of Cartography 
Technische Universität München 
München, Germany 
e-mail: liqiu.meng@bv.tum.de
 
 
Abstract -  The visualization of density information and its 
changes is a crucial support for the spatio-temporal analysis of 
dynamic phenomena. Existing density map approaches mainly 
apply to datasets with two different moments of time and thus 
do not provide adequate solutions for density mapping of 
dynamic points belonging to the same moving phenomena. The 
proposed approach termed as Spatio-Temporal Density 
Mapping intends to fill this research gap by incorporating and 
visualizing the temporal change of a point cluster in a 2D density 
map. At first either straight or curved movement trajectories 
based on centroids of spatio-temporal point clusters are 
detected. The traditional Kernel density contour surface is then 
divided 
into 
temporal 
segments, 
which 
are 
visually 
distinguished from one another by means of a rainbow color 
scheme. Furthermore, several ideas for the investigation of the 
usability of our approach are addressed. 
Keywords - spatio temporal density map; rainbow color 
scheme; visual analytics; dynamic phenomena. 
I. 
 INTRODUCTION 
As stated in a previous work by Peters and Meng [1], 
visualization helps to investigate and understand complex 
relationships in a spatial context. Maps account as one of the 
most powerful visualization forms. They represent geographic 
information in abstract ways that support the identification of 
spatial patterns and the interpretation of spatial phenomena. 
Furthermore, the visual presentation and analysis of dynamic 
data and dynamic phenomena is currently a hot research topic 
[2].  
Hence, in today’s society, the need for data abstraction 
along with the growing amount of available digital geodata is 
rapidly increasing. One reasonable way of abstracting data is 
provided by density maps [3]. Density maps can be applied 
for point data in various fields, for instance, in physical or 
human geography, geology, medicine, economy or biology [4, 
5]. How to present the density for dynamic data/phenomena 
is, however, not yet adequately addressed. 
In this paper, we introduce a novel density mapping 
approach for spatially and temporally changing data. The 
approach is based on [1], whereby in this work a different test 
dataset was used, two different types of movement trajectory 
concepts are introduced, a verification of the used rainbow 
color scheme is presented, investigations about wrongly 
assigned points are considered and a more detailed 
comparison between STDmap and its alternative in form of 
Kernel Density Estimation (KDE) maps for each temporal 
interval is provided. 
In the next section, the state of the art related to density 
maps, in particular, an overview of approaches considering 
the dynamics of movement data in the density visualization is 
given. In the section afterwards, our own approach is 
described in detail, followed by implementation processes, 
discussions of the results and a conclusion. 
II. 
DENSITY MAPS - STATE OF THE ART 
One of the most straight forward ways to visualize point 
density is a scatter plot or a dot map. Graphic variables for 
point symbols, such as size, shape, color and transparency, can 
be applied in relation with the attribute value. In order to 
discern the density distribution, these graphic variables can be 
iteratively adapted to the given map scale, but still the 
occlusion of neighboring points cannot be always desirably 
avoided. The density value of each point can be obtained by 
counting all points within a buffer around the point or within 
a grid cell the point is located in.  
In the following, the density estimation and map principles 
are shortly presented and the state of the art of density maps 
with static or dynamic data is given. 
A. KDE 
KDE [6] is a classic method widely used to determine 
densities of individual points that represent a continuous 
surface. The KDE approach is described in detail in [6-8]. The 
standard KDE, a normal distribution function, uses a Gaussian 
kernel:  
 
 
( )
∑
=
⋅
=
n
i
h
K u
n h
x
f
1
( )
1
)
 
(1) 
 whereby   
h
X
X
u
i
−
=
  and   
( )





−
⋅
=
2
2
1
exp
2
1
u
K G u
π
  
with: 
( )
f h x
)
 
=  general Kernel density function 
 
K  
 
=  Kernel function 
 
KG  
 
=  standard Gaussian function 
 
h  
 
=  smoothing parameter (bandwidth) 
 
n 
 
=  number of points 
 
X 
 
=  point (x,y) for which  
   
    
  the density will be estimated 
 
X1, X2, ..., XN  =  sample points, placed within the  
 
 
 
  kernel radius h 

28
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Beside a Gaussian kernel, also other kernel types can be 
applied, such as Triangular, Biweight, Epanechnikov or 
Uniform kernel [7]. A certain bandwidth (search radius) is 
defined for the kernels, located around each point. For each 
cell of an underlying grid (defined by a certain resolution) a 
density value is calculated as shown in equation (1) and hence 
a smooth surface is provided [9]. The kernel bandwidth value 
strongly effects the resulting density surface [10]. A formula 
for an optimal bandwidth is offered by Silverman [7] as shown 
in equation (2). 
 
 
( )
( )
5
1
.1 34
, IQR
var
.1 06 min
−
∗





∗
=
n
P
P
bw_optimal
 (2) 
with: bw_optimal =  optimal bandwidth 
  
P 
=  point dataset (coordinates) 
 
IQR(P) 
=  interquartile range  
 
var(P) 
=  variance of P 
 
n 
=  number of points 
 
 In order to detect clusters, KDE has been applied in in 
various applications, such as crime analysis and population 
analysis. Kwan [11] used KDE and 3D visualization to 
investigate spatio-temporal human activity patterns. The 
author applied the density estimation as a method of 
geovisualization to find patterns in human activities related to 
other social attributes. The classic KDE was investigated in 
[12-14], and thereby defined as a visual clustering method. In 
these works, KDE maps were created in order to visually 
provide a better overview and insight into the given data. 
B. Contour lines and intervals 
A common technique to map point densities calculated 
using KDE are isopleth maps with filled contour intervals. The 
term “isopleth map” refers to one of two types of isoline maps 
(also called isarithmic or contour maps). In the first type of 
isoline maps each contour line indicates a constant rate or ratio 
derived from the values of a buffer zone or kernel area. In this 
sense, the continuous density surface is derived from an 
originally discrete surface. In the other type of isoline maps 
(commonly referred to “isometric map”), contour lines 
(isometers) are drawn through points with directly measurable 
equal value or intensity such as terrain height or temperature 
[15]. It is assumed that the data collected for enumeration 
units are part of a smooth, inherently continuous phenomenon 
[16]. In our context, we only use contour lines to delimit the 
intervals (the areas between contour lines).  
Furthermore, Langford and Unwin [17] provided a good 
overview of density surfaces used in Geographic Information 
Systems (GIS) as choropleth population density maps, 
population density on grids, population density surfaces, and 
pseudo-3D population density surfaces. In several works as 
[4, 5], the KDE concept is adapted for the 3D space density 
mapping of static 3D data.  
C. Dynamic data and density information 
In the following sections, an overview is given about 
existing works related to density maps of dynamic points.  
1) Sequence of KDE maps for dynamic points 
A straightforward way of visualizing the density of 
dynamic points would be a sequence of density surfaces (one 
per time interval). The change of the density in time could be 
better discernable by means of an animation of these density 
maps. We could also arrange the local density contours of 
each time interval on the same map. Transparency and a 
unique color scheme for each time interval could be applied 
in order to distinguish different density contours. However, 
the tinted intervals may spatially overlap and make the map 
reading a difficult endeavor. 
2) Dual KDE 
Jansenberger and Staufer-Steinocher [18] analyzed two 
different point datasets recorded within the same area, but at 
two different moments of time. The authors suggest a Dual-
KDE approach, which results in a map illustrating the spatio-
temporal density difference of the two datasets. The absolute 
difference is used, that is, the absolute density of the second 
point dataset subtracted from that of the first one.  
3) DKDE 
The approach called Directed Kernel Density Estimation 
(DKDE) that takes the dynamics of moving points inside 
density maps into account was suggested in previous works 
[19-24]. The DKDE is applicable for discrete moving points 
and it considers two moments of time. Instead of an upright 
kernel as in the KDE method, a tilted kernel is used, as 
illustrated in Figure 1.  
 
 
Figure 1.   Linear kernel (left) and Directed linear kernel taking point speed 
and movement direction into account (right), source: [24]. 
 
The tilt depends on the movement direction vector of the 
respective point. The resulting DKDE-map shows the so-
called “ripples”, which can be interpreted as an indicator for 
the movement direction and density change of points that are 
located closely to each other with very similar movement 
speeds and directions. These ripples are visible among 
overlapped contour lines. The tinted contour intervals do not 
contain the information about movement or density change. 
Peters and Krisp [24], for instance, used 2D airplane 
positions in the area of Germany at two moments of time with 
a time lag of five minutes. The resulting DKDE-map is shown 
in Figure 2. 
 

29
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 2.   DKDE-map based on airplane positions at two moments of time, 
source: [24]. 
 
4) 3D density map using space time cube (STC) 
Nakaya and Yano [25] suggest a method using a STC to 
visually explore the spatio-temporal density distribution of 
crime data in an interactive 3D GIS. Thereby the author 
adapted the KDE by using space-time variants and scan 
statistics. In order to investigate the dynamics and density 
change, an interactive use within a 3D environment is 
essential. 
5) KDE for trajectories 
In a comprehensive review, Andrienko and Andrienko [2] 
discussed existing visual analysis methods, tools and concepts 
for moving objects. A section is dedicated to continuous 
density surfaces (fields) derived from trajectories or from 
point-related attributes. Density maps of moving objects were 
created on the basis of aggregated points of trajectories. A 
trajectory is understood as a function of time or a path left by 
a moving object in space. Moving objects can be confined 
within a network (such as cars along streets of a traffic 
network) or float freely over a region (boats) or in space 
(airplanes). Spatio-temporal density maps of trajectories were 
investigated in [26-29]. In these approaches, the KDE method 
is adapted to trajectories as a function of changing velocity 
and direction. Willems et al. [30], for example, built his 
kernels assuming constant speeds. Furthermore, McArdle et 
al. [31] investigated computer mouse trajectories. Thereby 
density maps are generated based on movement activity. For 
each scale, the density map is recalibrated in order to highlight 
the most important areas, in terms of mouse movement 
activity. Other approaches assume constant acceleration. The 
resulting density maps can reveal simultaneously large-scope 
patterns and fine features of the trajectories. This mapping 
idea was extended to the 3D space in [27], where the trajectory 
densities are visualized inside a STC.  
Another possibility of displaying density information of 
trajectories is to use derived discrete grid cells, whereby each 
cell color refers to the amount of trajectories passing through 
the cell [32, 33]. 
D. Research questions 
In the existing 2D density maps based on KDE, the time is 
either frozen on a certain moment or confined within a certain 
time interval. Consequently, the resulting contour lines do not 
carry information of temporal changes. Although various 
approaches for density visualization of trajectories have been 
investigated, an appropriate method for 2D density maps of 
moving point clouds is still missing. Whether the dynamics of 
spatially extended phenomena (SEPs) - represented by points 
– can be adequately expressed in a single contour map remains 
an open question. To tackle this question, we develop an 
approach termed as Spatio-Temporal Density Mapping or 
STDmapping. 
III. 
TEST DATASET  
We used lightning points recorded by LINET, a lightning 
detection network [34], as the test dataset. It contains 
altogether 8184 detected lightning in the region between 
Munich, Germany and Prague, Czech Republic (47°N–50°N 
Latitude and 11°E–15°E Longitude) on April 26th 2013 
between 2pm and 7pm. Each point is encoded with its 
geographic coordinates (longitude, latitude) as well as the 
exact lightning occurrence time. The recorded height 
information is not considered within our approach. 
Figure 3 illustrates the lightning points in form of blue dots 
projected onto a plane surface. The background base map 
contains topographic data of the area out of Open Street Map 
dataset. The use of such static plot of lightning data is limited 
for the investigation of the dynamics in lightning data. To 
enhance clarity of the approach, only points of the three 
largest lightning tracks are considered in the STD density 
mapping approach.  
 
Figure 3.   Initial point test dataset. 
 

30
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Visual analysis methods for these lightning points, which 
represent the moving phenomena of a thunderstorm, were 
published in [35-37]. 
IV. 
METHODOLOGY 
First of all, density contour maps can be derived from 
point datasets using KDE while an optimal kernel bandwidth 
can be calculated according to Silverman’s formula [7]. In our 
work we deal with a lightning point dataset representing a 
dynamic phenomenon. Thus, instead of creating a single 
density contour map of the entire point dataset, we applied 
KDE in each case to all points belonging to the same lightning 
track. Thereby, lightning points are clustered, afterwards 
allocated and aggregated to trajectories. In doing so, a 
temporal clustering is applied to the initial point dataset using 
a time interval of one hour. Subsequently, all points within 
each temporal interval are spatially clustered using a buffer 
threshold of six kilometers. In the resulting spatio-temporal 
clusters, the spatially overlapping parts within two time 
sequences are detected and afterwards allocated and 
aggregated to lightning trajectories. Further details of the 
temporal and spatial clustering of lightning data including 
explanations for thresholds can be found in [35, 36]. The 
results of the density contour maps derived for the test dataset 
are shown in Figure 4. The importance of grouping dynamic 
points into tracks is discussed in the next section. 
 
 
Figure 4.   KDE map applied to test point dataset. 
 
The resulting density contour layers in blue tones do not 
bear 
any 
temporal 
information. 
Nevertheless, 
the 
aforementioned temporal point clustering method provides 
time information for each lightning point. Figure 5 illustrates 
our initial point dataset, whereby lightning points were 
segmented and colored according to the different time 
intervals, thus reveal the dynamic changes. In doing so, we 
used a time interval of 1 hour starting at 2pm for the temporal 
clustering. The overlapping convex hulls surrounding all 
spatially clustered points of the same temporal interval are 
allocated to altogether three different trajectories. 
 
 
Figure 5.   Temporally clustered point data. 
 
Three main moving lightning clusters are perceivable 
within the test area. Their geographic and temporal locations 
are apart from each other with one formed at lower left part 
and one upper left, both starting around 2pm and the third one 
upper right occurring around 4pm. All clusters are moving 
north-eastwards. The upper left cluster disappears around 
5pm, whereas the lower left and the upper right last until 7pm. 
As mentioned before, traditional density mapping does not 
contain temporal information. Clustering and allocating 
dynamic point data (in our case lightning points) towards 
trajectories provides information about data movement 
(speed, direction, etc.).    
In the following, we introduce a method, which includes 
movement information, i.e., dynamics in KDE mapping. In 
other words, we suggest a solution to incorporate temporal 
information of moving points (as illustrated in Figure 5) inside 
the density contour intervals (as shown in Figure 4). 
A. STDmapping workflow 
An overview of our suggested method is illustrated 
through an overall workflow in Figure 6.  
First of all a density contour map using KDE is created. 
Additionally, the given point dataset is temporally and 
spatially clustered. In the next step, the overlapping clusters 
(in case they are temporally successive) are detected and after 
that allocated and aggregated to independent tracks. Cluster 
centroids are embedded in the trajectories. A detailed 
description about these steps can be found in [35]. 
 

31
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 6.   The workflow of STDmapping of lightning data. 
 
A linear approximation of each track results in a straight 
tendency line, which represents the average moving direction 
of the point cluster. The linear approximation can be based 
either only on the cluster centroids or on the entire point 
datasets of a track.  
If the projected trajectory is curved rather than straight, the 
tendency line can be approximated by a polyline connecting 
the cluster centroids. In our case, a cubic spline interpolation 
function is used to fit a curve through the cluster centroids 
[38]. 
Consequently, we have on the one hand the density 
surfaces represented by layered tints between neighboring 
contour lines and on the other hand the tendency line with 
either abrupt or smooth transition at borders of temporal 
clusters. This temporal border is a line perpendicular to the 
tendency line passing through the average locations of all 
points within a certain period (in our case 10 minutes) before 
and after a temporal border (e.g., full hour). If the 
phenomenon is moving, all points between two temporal 
borders (e.g., between “2pm line” and the “3pm line”) are 
grouped into the same temporal interval (period: “2pm - 
3pm”). 
The next question is how we can incorporate the dynamics 
inside the density map. The idea is to divide the tendency line 
into temporal parts, which will in turn guide the segmentation 
of the density surface.  
 
 
Figure 7.   Temporally clustered points and cluster centroids in black with 
straight tendency line and perpendicular temporal borders (left) and 
with curved tendency line and perpendicular temporal borders (right). 
 
Figure 7 illustrates two different ways of tendency line 
determination. In the left part, all points of an exemplary 
lightning track are colored according to the temporal cluster 
they respectively belong to. The cluster centroids are 
presented as black dots. A straight tendency line representing 
the general movement direction of the lightning cluster is 
based on the coordinates of all cluster centroids. The temporal 
borders in red are detected and vertically aligned to the 
straight tendency line. The locations for temporal borders can 
be defined by the half distance between two temporally 
successive cluster centroids, or, by the centroid of the 
overlapping area of two sequential temporal point sets.  
In the right part of Figure 7, the tendency line is 
represented by a curve determined through cubic spline 
interpolation of all cluster centroids. The temporal borders in 
red are defined again as perpendicular lines of the curved 
tendency line. Thus, temporal border lines are not arranged 
parallel to each other as in the case for the straight tendency 
line. However, for very small temporal clusters (clusters of 
low velocity or very small temporal thresholds) temporal 
border lines are much closer to each other, and thus – due to 
the curved tendency line route – they are almost parallel to 
each other.  
Nevertheless, it could be also possible that two sequential 
temporal borderlines intersect each other (in particular if the 
tendency line is strongly curved). In this case, the respective 
intersecting temporal borderlines need to be partly merged as 
shown in Figure 8. Thereby, different temporal segments are 
illustrated in different colors (beige, green, blue) and temporal 
borders in red. We suggest combining the two intersecting 
temporal border lines from the intersection point onwards 
towards the outer cluster extension in a way that each of both 
temporal border lines forms the same angle with the 
continuing merged border line part. 
 

32
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 8.   Suggested solution for intersecting temporal border lines (red). 
 
In the next step, density contours are separated through 
temporal borderlines into temporal surface segments as 
illustrated in Figure 9.  
As described before, temporal borders can be either 
parallel if they are based on a straight tendency line (see 
Figure 9 left) or temporal borders are perpendicular to the 
curved tendency line and thus non-parallel (see Figure 9 
right).  
 
 
Figure 9.   Density contours with temporal borders based on a linear 
tendency line (left) and with temporal borders and thresholds for 
smooth color gradients based on a curved tendency line (right). 
 
Furthermore, thresholds for temporal borderlines can be 
applied for smooth color transitions. Different temporal 
surface segments carry different color hues. Within the same 
surface segment, the color hue remains the same but its 
intensity varies with the change of density.  
In our approach, we adopted the “rainbow color scheme”, 
which 
is 
essentially 
the 
visible 
and 
continuous 
electromagnetic spectrum. Its main color hues transit from 
red, orange, yellow, green, blue to violet. The spectrum can be 
divided into an arbitrary number of intervals. Users may easily 
anticipate and comprehend the color transitions. In our 
approach, we assign each time interval to a certain color hue 
– the medium color of the rainbow subinterval.  
 
 
Figure 10.   Rainbow color scheme. 
 
Figure 10 exemplary illustrates eight different rainbow 
color hues with each being displayed in up to six different 
color intensities from light to dark. For instance, the red color 
scheme refers to time period 1 and contains six different red 
tones, which are related to six different density values/ value 
intervals. We split the entire time of our dynamic dataset into 
equal time intervals. The interval size can be determined based 
on the user’s interest.  
Hue represents time (e.g., discretized at 1 hour intervals) 
and color intensity corresponds to the density of observations 
(low intensity refers to low density and high intensity to high 
density). A continuous color scheme should not include more 
than three hues; otherwise the visual perception may suffer. 
An exception is the rainbow scheme. Most people know the 
differences in short and long wavelengths of visible light and 
are therefore familiar with the rainbow color gradation. 
We decided to use the rainbow color scheme in order to 
fulfill the following two criteria:  
‘Clear differentiation’: colors of adjacent segments should 
be clearly distinguishable from each other. In particular, the 
brightness spectrum from low to high intensity should be 
distinct for each color hue from those of the others. 
‘Continuity’: The color hues including their different 
intensities should represent the movement, thus, consists of a 
continuous color gradation. From the first hue allocated to the 
first temporal interval to the last one, the map user should be 
able to visually detect this continuity through a continuous 
color scheme. This color scheme has to be commonly 
known/familiar and intuitively understandable. 
In literature, rainbow color maps are commonly used, but 
often are considered as harmful for continuous data [39]. The 
arguments 
against 
rainbow 
schemes 
include 
the 
inappropriateness for colorblind people, the appearing of 
divisions between hues, which lead to visual “edges” in the 
map, the meaningless spectral order of the hues and 
difficulties to recognize details. In particular to differentiate 
qualitative and quantitative attributes through polygon hue, 
the use of the rainbow scheme is often criticized. Figure 11 

33
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
illustrates five different color scheme approaches for the 
STDmap using the rainbow color scheme (a) and four 
alternatives involving a color gradient from blue to purple (b) 
as well as three color scheme from Colorbrewer.org [40]: 
diverging (c), sequential multiple hues (d) and sequential 
single hue (e).  
To visualize continuous data, often bipolar color 
illustration is used. On the other hand, also the rainbow color 
scheme is frequently used, for example to visualize the earth 
gravitational field (geoid anomalies) or illustrate weather-
related intensities, such as storm severity [41]. Although the 
rainbow color scheme with its color gradation is commonly 
known, the continuity information based on color gradation 
might be easier to identify in the options provided in Figure 
11-b,c,d,e. However, in Figure 11-c,d,e individual contour 
segments are difficult to identify due to the use of/color 
transition to white or yellow. Although the movement of the 
spatially extended object (SEO) in time is clearly visible in 
Figure 11-b, individual neighboring temporal segments could 
be confusing – which is not the case in Figure 11-a. To 
fulfill/combine the two contradictory criteria of the continuity 
and the clear differentiation, we have to make a compromise. 
The rainbow scheme might be more appropriate for some 
cases while a continuous color scheme involving 2-3 hues 
might suit better for other applications. For our STDmapping 
approach, we preferred to use the rainbow scheme. However, 
a user test is needed to verify the proper use of rainbow color 
scheme for our STDmap. 
 
 
Figure 11.   Different color scheme approaches. 
 
With regard to the division of density surface by means of 
the temporal tendency lines (following either a straight or a 
curved route), we introduce the perpendicular lines to each 
tendency line as the temporal borders between the two 
neighboring time intervals of the underlying KDE map. The 
color transition between two temporal segments can be either 
abrupt or smooth. In case of smooth temporal borders, a 
defined threshold for the smooth color transition is set. The 
threshold refers to a certain time before and after the abrupt 
temporal borders. That leads to two parallel border lines – one 
to the left, the other to the right of the abrupt border line. The 
distance (time) between each smooth border line and the 
respective abrupt border line can be constant and variable. 
Thus, our STDmapping approach provides a solution for 
the visual incorporation of temporal information within 
density surfaces of layered tints. 
V. 
RESULTS AND DISCUSSION 
For applying density visualization to our test dataset, 
containing lightning points during April 26th 2013, we used 
both our proposed STDmapping approach and the commonly 
used KDE method. Applying the latter traditionally for each 
spatio-temporal cluster, a segment of density map with 
layered tints was produced as illustrated in Figure 12, which 
however is not satisfying due to parts of overlays and 
occlusion. It leads to a loss of certain local and of the overall 
density information. 
 
Figure 12.   Segmented KDE in one map. 
 
Applying transparency does not solve this drawback 
adequately. Due to the fact, that the density contour intervals 
of each temporal interval have the same hue but differ in color 
intensities, a transparency changes the intervals with low 
intensities to almost invisible – even if a contour border with 
a slightly more intense color is added. Hidden parts of 
overlapped contour intervals will still not be sufficiently 
recognizable.  
Thus, using KDE maps for each spatio-temporal cluster 
provides only direct depiction of time for non-overlapping 
contour surfaces. Furthermore, visual exploration of density 
information in the overlapping parts is only possible for the 
surface on top; in case transparency is applied it is very 
difficult. Another disadvantage occurs when one is interested 
in density information including points detected shortly before 
and after the temporal interval border. 
By applying the new STDmapping approach to our test 
dataset and following the workflow in Figure 6, we created 
eight different output maps (Figure 13 - Figure 20). The 
temporal borders were based on either straight (A) or curved 

34
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
lightning cluster moving tendency lines (B). Furthermore, we 
used two different temporal thresholds: one hour, respectively 
30 minutes. Moreover, we applied the abrupt and the smooth 
concept for color gradients between temporal segments. 
A. STDmaps based on straight tendency lines 
Four figures illustrate results for spatio-temporal density 
maps (STDmaps) based on straight tendency lines with the 
interval of one hour in Figure 13 and Figure 14 and 30 minutes 
in Figure 15 and Figure 16. The color gradients between 
temporal borders are abrupt in Figure 13 and Figure 15 and 
smooth in Figure 14 and Figure 16. 
Using straight tendency lines, the temporal borders appear 
parallel to each other, in particular with abrupt color gradients. 
Larger distances between sequential temporal borders refer to 
a faster movement phase of the dynamic phenomenon, 
whereas the closer successive temporal borders indicate a 
slower movement of the lightning clusters.  
 
Figure 13.   STDmap with abrupt color gradient based on straight 
tendency lines and the temporal interval of one hour. 
 
When fewer temporal segments are used (e.g., five 
segments in Figure 13), the map reader may fast and easily 
extract the distinctive temporal information. When a larger 
number of temporal segments are used (e.g., in Figure 15), the 
map reader has to distinguish between more different colors 
referring 
to 
temporal 
information. 
This 
explorative 
interpretation becomes more effortful. On the other hand, 
more temporal segments reveal more details and may thus 
enable a more comprehensive insight in the dynamics of the 
data (e.g., temporal change of local point density).  
 
Figure 14.   STDmap with smooth color gradient based on straight 
tendency lines and the temporal interval of one hour. 
 
Figure 15.   STDmap with abrupt color gradient based on straight 
tendency lines and the temporal interval of 30 minutes. 
 

35
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 16.   STDmap with smooth color gradient based on straight 
tendency lines and the temporal interval of 30 minutes. 
 
B. STDmap based on curved tendency lines 
Four further figures illustrate the results for STDmaps 
based on curved tendency lines. The interval of one hour was 
used in Figure 17 and Figure 18 and 30 minutes for Figure 19 
and Figure 20. The color gradients between temporal borders 
are abrupt in Figure 17 and Figure 19 and smooth in Figure 18 
and Figure 20. 
 
Figure 17.   STDmap with abrupt color gradient based on curved 
tendency line and the temporal interval of one hour. 
 
Figure 18.   STDmap with smooth color gradient based on curved 
tendency line the temporal interval of one hour. 
 
Figure 19.   STDmap with abrupt color gradient based on curved 
tendency line and the temporal interval of 30 minutes. 
 
A comparison of the results from the straight tendency line 
with those from the curved tendency line (e.g., Figure 14 with 
Figure 18 using five temporal segments or Figure 16 with 
Figure 20 using 11 temporal intervals) clearly shows the 
visual similarity of STDmaps, particularly in case of a rather 
large threshold for temporal borders. 
 

36
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 20.   STDmap with smooth color gradient based on curved tendency 
line and the temporal interval of 30 minutes. 
 
It can be obviously perceived in all STDmaps that the 
entire density information is clearly visible while the temporal 
information about phenomena dynamics in terms of speed and 
moving direction provides the added value. All lightning 
clusters are moving northeastwards. The upper left cluster is 
moving faster around 3:30pm than at any other time and it had 
two density peaks around 3pm and 4pm.  
The clear-cut temporal cluster borders reveal another 
advantage: Density information in layered tints within each 
specific time interval is clearly visible and separable from 
neighboring segments. The smooth color transitions between 
neighboring segments are closer to the reality and correspond 
better to the visual perception: lightning points occurring for 
instance some minutes after 3pm can be located inside the 2-
3pm segment and points appearing some minutes before 3pm 
might be placed inside the 3-4pm segment. With the help of 
an adaptive slider, the smoothing effect can be set for a small 
time interval (e.g., 14:55 – 15:05) or a large one (maximum 
smoothing interval: half of the time interval left and right of 
the temporal border, e.g., 14:30 – 15:30). Moreover, an elastic 
slider enables the use of different smoothing intervals adaptive 
to the cluster overlap and thus to the changing cluster speed. 
In our case we used a threshold of 10 minutes (five minutes 
before and after each abrupt border line). For an easy 
comprehension, we suggest to limit the number of colors (time 
intervals) to no more than about 15. In case of very extensive 
temporal range, the brightness of the same tone within the 
same interval can be adopted. For instance, 24 hours can be 
cut into six by four hours intervals. Within each interval four 
different brightness of the same tone can be used. In order to 
verify the proposed color mapping, an extensive user 
evaluation is necessary. 
C. Wrongly assigned points 
STDmapping approach is suitable for constantly moving 
SEOs. The approach creates a segmented contour interval for 
each track. However, the use of abrupt color gradients may 
lead to temporally wrongly assigned points. The tracking and 
in particular used clustering method (distance threshold) as 
well as the temporal segmentation (time intervals and 
tendency segmentation model) are decisive for the allocation 
of points to the temporal segments. These decisive steps 
(parameters) can be adapted to different moving situations 
along the trajectory. For example, in case a moving SEO 
changes its speed along the track, temporal intervals and 
smooth zones could be defined differently in order to reduce 
wrongly assigned points. 
The following two figures illustrate the temporally 
wrongly assigned points (in black) detected in the STDmap 
for our test dataset while using a temporal interval of one hour 
and a linear tendency line. In Figure 21 abrupt temporal 
borders were used and in Figure 22 smooth zones (for smooth 
color transitions) of +/- 10 minutes were applied (semi-
transparent pink polygons). The number of wrongly assigned 
points are displayed for each temporal border in Figure 21 and 
for each temporal interval between the smooth zones in Figure 
22. We assume that the smooth zone visually refers to both 
adjacent temporal intervals. Out of altogether 6885 points for 
the ‘abrupt’ case 788 points (11.4 %) appeared to be assigned 
wrong and for the ‘smooth’ case 189 points (2.7 %) appeared 
to have the wrong temporal color code of the underlying 
STDmap. Thus, using the smooth STDmap fewer parts are 
visually allocated to the wrong real temporal interval. 
 
 
Figure 21.   Wrongly assigned points (in black), using abrupt temporal 
borders. 
 
A lower distance threshold leads to fewer dis-allocated 
points. The smaller the number of temporal intervals, the more 
cutlines are defined and probably more temporally false 

37
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
allocated points occur. The wider the smooth area, the fewer 
the number of wrongly assigned points. 
 
 
Figure 22.   Wrongly assigned points (in black), using smooth temporal 
borders. 
 
Basically, as the tendency line and segmented cuts are 
more generalized, the more wrongly assigned points occur. 
Thus, a spline tendency line should result in less wrongly 
assigned points than the use of a linear one. If a point is 
wrongly assigned, then it is mostly behind the segment border 
to the next temporal interval. A very slow movement 
consequently results in a higher number of wrongly assigned 
points. In case a SEO is moving for- and backwards or 
intersects a lot with itself, the produced contour intervals 
would overlap and thus map reading becomes more difficult, 
even if transparency is applied.  
Between STDmapping and "KDE maps for each temporal 
interval" there are certain complementarities. We have shown 
that both approaches have their pros and cons. Our proposed 
STDmap is an alternative procedure to the overlapping KDE 
maps. Surely, there might be applications for which the use of 
KDE maps is more appropriate and others for which the 
STDmapping approach is more suitable. For our application 
case of moving lightning data, we prefer the use of STDmap. 
Comprehensive user tests are necessary to verify the right 
choice for different applications. 
D. Limitations and comparison with existing approaches 
Existing density mapping approaches are able to consider 
either two moments of time or a series of time intervals within 
density information visualization in a STC. However, the 
targeted visual communication of point density changes 
necessitates user interactions, especially when a cluster of 
interest is bounded by other clusters, it can be hardly explored 
without interaction. The 3D density STC suggested by Nakaya 
and Yano [25] is a comparable approach, where a series of 
time steps is taken into account within density information 
visualization with the aim to illustrate the change of point 
density in time. However, the density changes in time can only 
be explored interactively by panning, zooming and rotating 
etc. The STC approach does provide explicit spatio-temporal 
density information while the STDmapping method assigns 
some points to the wrong temporal intervals. However, the 
STC approach needs strong user interaction for the 
exploration of point density changes. If a cluster of interest is 
surrounded by other clusters, it can be hardly explored. Our 
approach has overcome this drawback by storing and 
presenting temporal information in different colors in a 
STDmap 
(in 
2D). 
Spatial and 
temporal 
clustering 
parameters/thresholds can be adapted in order to improve the 
resulting STDmap. The approach creates appropriate 
segmented density surfaces. In other words, the approach is 
suitable if a movement and a main movement direction of the 
phenomena (polygon) are given and thus a tendency line 
together with temporal borderlines can be automatically 
identified. However, several movement cases may cause 
difficulties to identify the segments: (1) if the SEP is 
simultaneously expanding in several directions the tendency 
line needs to be split, which is no trivial task in the practice. 
(2) If the SEP is moving and returning after a circular track 
back to a previously passed location/area; or if the SEP is 
moving for and backwards. In these cases spatio-temporal 
polygons would overlap significantly and the resulting 
STDmap may become illegible. 
E. Usability of STDmapping 
To verify the usability of our approach a comprehensive 
test of how users interact with the STDmapping is necessary. 
It deals with a multidisciplinary research field and requires 
knowledge about the user, the user’s task and the involved 
technology [42]. The target users of our approach are domain 
specialists who interact with the visualized dynamic 
phenomena and who need to identify spatio-temporal changes 
of local and global point densities. The anticipated user tests 
aim to investigate how the visualized information is perceived 
and understood. The usability of alternative STDmaps can be 
compared or iteratively improved. The iteration bears a two-
fold meaning. On the one hand, the STDmap designers benefit 
from user’s behavior. On the other hand, an improved 
STDmap will better empower the users. In the latter case, the 
users get trained to get along with the STDmapping approach. 
Since the interactive and explorative use of the STDmaps of 
dynamic SEPs requires some vocational adjustment, the 
corresponding usability tests should be conceptualized as a 
long-term endeavor involving repeating test sessions with the 
same target users. 
VI. 
CONCLUSION AND FUTURE WORK 
Visualizing density and distribution information is a key 
support for the understanding of spatio-temporal phenomena 
represented by point data. However, the temporal information 
is not yet adequately handled in existing density mapping 
approaches. Our work has closed this research gap by 
incorporating and visualizing the temporal change of point 
cluster in a 2D density map. Our approach is termed as 
STDmapping according to which a density surface of layered 
tints can be divided into different temporal segments. Each 

38
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
segment is then visualized by a color hue with varying 
intensities. The temporal borders are visualized as lines 
perpendicular to the moving tendency lines. Tendency lines 
are either straight or curved. Moreover, abrupt or smooth color 
gradients between neighboring temporal segments can be 
applied.  
The 
resulted 
STDmaps 
comprise 
spatio-temporal 
information about density, distribution, movement patterns 
such as moving direction and speed of dynamic point clusters. 
Thus, our approach supports the pattern detection/extraction 
of spatio-temporal phenomena without having to activate 
interactive tools. Furthermore, our approach can be adapted to 
dynamic phenomena represented by other point events as well 
as to moving point groups (e.g., animal swarms).  
In the next step of our work, the usability of STDmap for 
lightning data will be investigated. It requires the participation 
of users who are domain specialists and should make 
decisions based on their understanding of visualized lightning 
data. Specific user tasks related to the extraction of certain 
spatio-temporal density information or dynamic patterns 
should be repeatedly conducted and evaluated. Various 
interactive functions should be made available to allow these 
users to manipulate the visualization for the purpose of a more 
efficient exploration, for instance, by adapting the color 
scheme, changing the time interval, etc. 
Meanwhile, we plan to investigate the relation between the 
characteristics of initial data (density, distribution, spatio-
temporal change of point coordinates) and their modeling 
parameters (movement tendency, time interval, boundary 
lines) with the purpose to describe the dynamic phenomena 
with minimum information loss or distortion for the 
subsequent visualization and use of STDmaps. Furthermore, 
an adaption of our approach for 3D point data is also possible. 
Last but not least, it is worthwhile to develop the dynamic 
mapping technologies for geo-sensory systems, which, for 
example, demand the dynamic derivation of density layers, 
contour lines or discrete classes from the values regularly sent 
by various sensors. 
ACKNOWLEDGMENT 
The authors gratefully acknowledge Nowcast Company 
for providing lightning test dataset and the support of the 
Graduate Center Civil Geo and Environmental Engineering at 
Technische Universität München, Germany.  
REFERENCES 
[1] S. Peters and L. Meng, "Spatio Temporal Density Mapping of 
a Dynamic Phenomenon," in GEOprocessing 2014 - The Sixth 
International 
Conference 
on 
Advanced 
Geographic 
Information Systems, Applications, and Services, Barcelona, 
Spain, 2014, pp. 83-88. 
[2] N. Andrienko and G. Andrienko, "Visual analytics of 
movement: An overview of methods, tools and procedures," 
Information Visualization, vol. 12, pp. 3-24, 2013. 
[3] W. A. Mackaness, A. Ruas, and L. T. Sarjakoski, 
Generalisation of geographic information: cartographic 
modelling and applications. Amsterdam, The Netherlands: 
Elsevier Science, 2007. 
[4] K. Romanenko, D. Xiao, and B. J. Balcom, "Velocity field 
measurements in sedimentary rock cores by magnetization 
prepared 3D SPRITE," Journal of Magnetic Resonance, pp. 
120-128, 2012. 
[5] S. Stoilova-McPhie, B. O. Villoutreix, K. Mertens, G. 
Kemball-Cook, and A. Holzenburg, "3-Dimensional structure 
of membrane-bound coagulation factor VIII: modeling of the 
factor VIII heterodimer within a 3-dimensional density map 
derived by electron crystallography," Blood, vol. 99, pp. 1215-
1223, 2002. 
[6] J. W. Tukey, Exploratory data analysis: Addison-Wesley, 
1977. 
[7] B. W. Silverman, Density estimation for statistics and data 
analysis vol. 26: CRC press, 1986. 
[8] N. Cressie, "Statistics for spatial data," Terra Nova, vol. 4, pp. 
613-617, 1992. 
[9] D. W. Scott, Multivariate density estimation: theory, practice, 
and visualization vol. 383: Wiley. com, 2009. 
[10] D. O'Sullivan and D. J. Unwin, Geographic information 
analysis: John Wiley & Sons, 2003. 
[11] M.-P. Kwan, "Geovisualisation of activity-travel patterns using 
3D geographical information systems," in 10th international 
conference on travel behaviour research (pp. pages pending), 
Lucerne, 2003, pp. 185-203. 
[12] I. Assent, R. Krieger, E. Müller, and T. Seidl, "VISA: visual 
subspace clustering analysis," ACM SIGKDD Explorations 
Newsletter, vol. 9, pp. 5-12, 2007. 
[13] J. M. Krisp and O. Špatenková, "Kernel density estimations for 
visual analysis of emergency response data," in Geographic 
Information and Cartography for Risk and Crisis Management, 
ed: Springer, 2010, pp. 395-408. 
[14] R. Maciejewski, S. Rudolph, R. Hafen, A. Abusalah, M. 
Yakout, M. Ouzzani, et al., "A visual analytics approach to 
understanding spatiotemporal hotspots," Visualization and 
Computer Graphics, IEEE Transactions on, vol. 16, pp. 205-
220, 2010. 
[15] C. F. Schmid and E. H. MacCannell, "Basic Problems, 
Techniques, and Theory of Isopleth Mapping*," Journal of the 
American Statistical Association, vol. 50, pp. 220-239, 1955. 
[16] T. A. Slocum, R. B. McMaster, F. C. Kessler, and H. H. 
Howard, Thematic cartography and geovisualization: Pearson 
Prentice Hall Upper Saddle River, NJ, 2009. 
[17] M. Langford and D. J. Unwin, "Generating and mapping 
population density surfaces within a geographical information 
system," The Cartographic Journal, vol. 31, pp. 21-26, 1994. 
[18] E. M. Jansenberger and P. Staufer-Steinnocher, "Dual Kernel 
density estimation as a method for describing spatio-temporal 
changes in the upper austrian food retailing market," in 7th 
AGILE Conference on Geographic Information Science, 2004, 
pp. 551-558. 
[19] J. M. Krisp and S. Peters, "Directed kernel density estimation 
(DKDE) for time series visualization," Annals of GIS, vol. 17, 
pp. 155-162, 2011 2011. 
[20] J. M. Krisp, S. Peters, and F. Burkert, "Visualizing Crowd 
Movement Patterns Using a Directed Kernel Density 
Estimation," in Earth Observation of Global Changes (EOGC), 
Munich, Germany, 2013, pp. 255-268. 
[21] J. M. Krisp, S. Peters, C. E. Murphy, and H. Fan, "Visual 
Bandwidth 
Selection 
for 
Kernel 
Density 
Maps," 

39
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Photogrammetrie - Fernerkundung - Geoinformation, vol. 
2009, pp. 445-454, 2009/11/01/ 2009. 
[22] J. M. Krisp, S. Peters, and M. Mustafa, "Application of an 
Adaptive and Directed Kernel Density Estimation (AD-KDE) 
for the Visual Analysis of Traffic Data," in GeoViz2011, 
Hamburg, Germany, 2011. 
[23] J. M. Krisp and S. Peters, "Visualizing Dynamic 3D Densities: 
A Lava-lamp approach," in 13th AGILE International 
Conference on Geographic Information Science, Guimaraes, 
Portugal, 2010, pp. 10-14. 
[24] S. Peters and J. M. Krisp, "Density calculation for moving 
points," in 13th AGILE International Conference on 
Geographic Information Science, Guimaraes, Portugal, 2010, 
pp. 10-14. 
[25] T. Nakaya and K. Yano, "Visualising Crime Clusters in a Space 
time Cube: An Exploratory Data analysis Approach Using 
Space time Kernel Density Estimation and Scan Statistics," 
Transactions in GIS, vol. 14, pp. 223-239, 2010. 
[26] C. F. Schmid and E. H. MacCannell, "Basic Problems, 
Techniques, and Theory of Isopleth Mapping*," Journal of the 
American Statistical Association, vol. 50, pp. 220-239, 1955. 
[27] U. Demšar and K. Virrantaus, "Space–time density of 
trajectories: exploring spatio-temporal patterns in movement 
data," International Journal of Geographical Information 
Science, vol. 24, pp. 1527-1542, 2010. 
[28] R. Scheepens, N. Willems, H. van de Wetering, G. Andrienko, 
N. Andrienko, and J. J. van Wijk, "Composite density maps for 
multivariate 
trajectories," 
Visualization 
and 
Computer 
Graphics, IEEE Transactions on, vol. 17, pp. 2518-2527, 2011. 
[29] N. Willems, H. Van De Wetering, and J. J. Van Wijk, 
"Visualization of vessel movements," in Computer Graphics 
Forum, 2009, pp. 959-966. 
[30] N. Willems, H. Van De Wetering, and J. J. Van Wijk, 
"Visualization of vessel movements," in Computer Graphics 
Forum, 2009, pp. 959-966. 
[31] G. McArdle, A. Tahir, and M. Bertolotto, "Interpreting map 
usage patterns using geovisual analytics and spatio-temporal 
clustering," International Journal of Digital Earth, pp. 1-24, 
2014. 
[32] P. Forer and O. Huisman, "Space, time and sequencing: 
Substitution at the physical/virtual interface," Information, 
Place, and Cyberspace: Issues in Accessibility, pp. 73-90, 
2000. 
[33] G. Andrienko and N. Andrienko, "A general framework for 
using aggregation in visual exploration of movement data," 
Cartographic Journal, vol. 47, pp. 22-40, 2002. 
[34] H. D. Betz, K. Schmidt, and W. P. Oettinger, "LINET – An 
International VLF/LF Lightning Detection Network in 
Europe," 
in 
Lightning: 
Principles, 
Instruments 
and 
Applications, H. D. Betz, U. Schumann, and P. Laroche, Eds., 
ed Dordrecht: Springer Netherlands, 2009, pp. 115-140. 
[35] S. Peters, H.-D. Betz, and L. Meng, "Visual Analysis of 
Lightning Data Using Space–Time-Cube," in Cartography 
from Pole to Pole - 26th International Cartographic 
Conference (ICC), Dresden, Germany, 2013, pp. 165-176. 
[36] S. Peters and L. Meng, "Visual Analysis for Nowcasting of 
Multidimensional Lightning Data," ISPRS International 
Journal of Geo-Information, vol. 2, pp. 817-836, 2013. 
[37] S. Peters, L. Meng, and H. D. Betz, "Analytics approach for 
Lightning data analysis and cell nowcasting," in EGU General 
Assembly Conference Abstracts, 2013, pp. 32-3. 
[38] C. De Boor, A practical guide to splines vol. 27: Springer-
Verlag New York, 1978. 
[39] D. Borland and R. M. Taylor II, "Rainbow color map (still) 
considered 
harmful," 
IEEE 
Computer 
Graphics 
and 
Applications, vol. 27, pp. 14-17, 2007. 
[40] C. Brewer and M. Harrower. (2014, 10/2014). colorbrewer. 
Available: http://www.colorbrewer2.org/ 
[41] R. Wicklin. (2013, 10/2014). How to choose colors for maps 
and 
heat 
maps. 
Available: 
http://blogs.sas.com/content/iml/2014/10/01/colors-for-heat-
maps/ 
[42] M. Haklay, Interacting with geospatial technologies: Wiley 
Online Library, 2010. 
 

