Security of Entanglement Swapping QKD Protocols against Collective Attacks
Stefan Schauer, Martin Suda
Department Safety and Security
AIT Austrian Institute of Technology GmbH
Vienna, Austria
stefan.schauer@ait.ac.at, martin.suda.ﬂ@ait.ac.at
Abstract—We discuss the security of quantum key dis-
tribution protocols based on entanglement swapping against
collective attacks. Therefore, we apply a generic version of a
collective attack strategy on the most general entanglement
swapping scenario used for key distribution. Further, we
focus on basis transformations, which are the most common
operations performed by the legitimate parties to secure the
communication. In this context, we show that the angles,
which describe these basis transformations can be optimized
compared to an application of the Hadamard operation. As
a main result, we show that the adversary’s information is
reduced to a new minimum of about 0.45, which is about 10%
lower than in other protocols.
Keywords-quantum key distribution; entanglement swapping;
security analysis; optimal basis transformations.
I. INTRODUCTION
Quantum key distribution (QKD) is an important applica-
tion of quantum mechanics and QKD protocols have been
studied at length in theory and in practical implementations
[1], [2], [3], [4], [5], [6], [7], [8]. Most of these protocols
focus on prepare and measure schemes where single qubits
are in transit between the communication parties Alice and
Bob. The security of these prototcols has been discussed
in depth an security proofs have been given for example
in [9], [10], [11]. In addition to these prepare and measure
protocols, several protocols based on the phenomenon of
entanglement swapping have been introduced [12], [13],
[14], [15], [16]. In these protocols, entanglement swapping
is used to obtain correlated measurement results between the
legitimate communication parties, Alice and Bob. In other
words, each party performs a Bell state measurement and
due to entanglement swapping their results are correlated
and further on used to establish a secret key.
Entanglement swapping has been introduced by Bennett
et al. [17], Zukowski et al. [18] as well as Yurke and
Stolen [19], respectively. It provides the unique possibility
to generate entanglement from particles that never interacted
in the past. In detail, Alice and Bob share two Bell states
of the form |Φ+⟩12 and |Φ+⟩34 such that afterwards Alice
is in possession of qubits 1 and 3 and Bob of qubits 2 and
4 (cf. Figure 1). Then Alice performs a complete Bell state
measurement on the two qubits in her possession, which
results in
|Φ+⟩12 ⊗ |Φ+⟩34 = 1
2

|Φ+⟩|Φ+⟩ + |Φ−⟩|Φ−⟩
+|Ψ+⟩|Ψ+⟩ + |Ψ−⟩|Ψ−⟩

1324
(1)
After the measurement, the qubits 2 and 4 at Bob’s side
collapse into a Bell state although they originated at com-
pletely different sources. Moreover, the state of Bob’s qubits
depends on Alice’s measurement result. As presented in
eq. (1) Bob always obtains the same result as Alice when
performing a Bell state measurement on his qubits.
The security of QKD protocols based on entanglement
swapping has been discussed on the surface so far. It has
only been shown that these protocols are secure against
intercept-resend attacks and basic collective attacks (cf. for
example [12], [13], [15]). Therefore, we analyze a general
version of a collective attack where the adversary tries to
simulate the correlations between Alice and Bob [20]. A
basic technique to secure these protocols is to use a basis
transformation, usually a Hadamard operation, similar to the
prepare and measure schemes mentioned above, to make it
easier to detect an adversary. Hence, we analyze the security
with respect to a general basis transformation about an angle
θA applied by Alice and a transformation about an angle
θB applied by Bob. In the course of that, we are going to
identify, which values for θA and θB are optimal such that
an adversary has only a minimum amount of information on
the secret key.
In the next section, we are going to shortly review the
simulation attack, a generic collective attack strategy where
an adversary applies a six-qubit state to eavesdrop Bob’s
measurement result. A detailed discussion of this attack
strategy can be found in [20]. In Section III, we discuss
the security of entanglement swapping based QKD protocols
agains the simulation attack. Here, we are focussing on the
application of one and two basis transformations and deﬁne
the optimal angles for these transformations. At the end, we
summarize the results and give a short outlook on our next
steps into this topic.
II. THE SIMULATION ATTACK STRATEGY
In entanglement swapping based QKD protocols like [12],
[13], [14], [15], [16] Alice and Bob rest their security check
60
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-214-1
ICQNM 2012 : The Sixth International Conference on Quantum, Nano and Micro Technologies

Alice
Bob
|Φ+⟩
|Φ+⟩
1
2
3
4
(1)
Alice
Bob
Tθ
(2)
Alice
Bob
Tθ
(3)
Alice
Bob
3
1
4
2
|Ψ+⟩
|Ψ+⟩
(4)
Figure 1.
Illustration of a standard setup for an entanglement swapping
based QKD protocol using a basis transformation Tx.
onto the correlations between their respective measurement
results coming from the entanglement swapping (cf. eq. (1)).
If these correlations are violated, Alice and Bob have to
assume that an eavesdropper is present. Hence, a general
version of a collective attack has the following basic idea:
the adversary Eve tries to ﬁnd a multi-qubit state, which
preserves the correlation between the two legitimate parties.
Further, she introduces additional qubits to distinguish be-
tween Alice’s and Bob’s respective measurement results. If
she is able to ﬁnd such a state Eve stays undetected during
her intervention and is able to obtain a certain amount of
information about the key. In a previous article [20], we
already described such a collective attack called simulation
attack for a speciﬁc protocol [16]. The generalization is
straight forward as described in the following paragraphs. It
has been pointed out in detail in [20] that Eve uses 4 qubits
to simulate the correlations between Alice and Bob and
she introduces additional systems, i.e., |ϕi⟩, to distinguish
between Alice’s different measurement results. This leads to
the state
|δ⟩ = 1
2

|Φ+⟩|Φ+⟩|ϕ1⟩ + |Φ−⟩|Φ−⟩|ϕ2⟩
|Ψ+⟩|Ψ+⟩|ϕ3⟩ + |Ψ−⟩|Ψ−⟩|ϕ4⟩

P RQST U
(2)
which is a more general version than described in [20]. This
state preserves the correlation of Alice’s and Bob’s measure-
ment results coming from the entanglement swapping (cf. eq.
(1)). To be able to eavesdrop Alice’s and Bob’s measurement
results Eve has to choose the auxiliary systems |ϕi⟩ such that
⟨ϕi|ϕj⟩ = 0
i, j ∈ {1, ..., 4} i ̸= j
(3)
This allows her to perfectly distinguish between Alice’s and
Bob’s respective measurement results and thus gives her full
information about the classical raw key generated out of
them.
In detail, Eve distributes qubits P, Q, R and S between
Alice and Bob such that Alice is in possession of qubits P
and R and Bob is in possession of qubits Q and S. When
Alice performs a Bell state measurement on qubits P and
R the state of qubits Q and S collapses into the same Bell
H
XPe\
0
Π
4
Π
2
3 Π
4
Π
ΘA
0.0
0.1
0.2
0.3
0.4
0.5
Figure 2. Alice’s and Bob’s Shannon entropy H and the according average
error probability ⟨Pe⟩ if either Alice or Bob applies a basis transformation.
state, which Alice obtained from her measurement (compare
eq. (1) and eq. (2)). Hence, Eve stays undetected when Alice
and Bob compare some of their results in public to check
for eavesdroppers. The auxiliary system |ϕi⟩ remains at
Eve’s side and its state is completely determined by Alice’s
measurement result. Therefore, Eve has full information
on Alice’s and Bob’s measurement results and is able to
perfectly eavesdrop the classical raw key.
There are different ways for Eve to distribute the state
|δ⟩P −U between Alice and Bob. One possibility is that
Eve is in possession of Alice’s and Bob’s source and
generates |δ⟩P −U instead of Bell states. This is a rather
strong assumption because the sources are usually located
at Alice’s or Bob’s laboratory, which should be a secure
place. Nevertheless, Eve’s second possibility is to intercept
the qubits 2 and 3 ﬂying from Alice to Bob and vice versa
and to perform entanglement swapping to distribute the state
|δ⟩. This is a straight forward method as already described
in [20].
We want to stress that the state |δ⟩ is generic for all
protocols where 2 qubits are exchanged between Alice and
Bob during one round of key generation as, for example,
the QKD protocols presented by Song [15], Li et al. [16]
or Cabello [12]. As already pointed out in [20], the state
|δ⟩ can also be used for different initial Bell states. For
protocols with a higher number of qubits the state |δ⟩ has
to be extended accordingly.
III. SECURITY AGAINST COLLECTIVE ATTACKS
In the following paragraphs we discuss Eve’s intervention
on an entanglement swapping QKD protocol performing a
simulation attack, i.e., using the state |δ⟩P −U. To detect
Eve’s presence either Alice or Bob or both parties apply
a basis transformations as depicted in Figure 1.
A. General Basis Transformations
Similar to the prepare and measure schemes mentioned in
the introduction most of the protocols based on entanglement
swapping apply basis transformations to make it easier to
61
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-214-1
ICQNM 2012 : The Sixth International Conference on Quantum, Nano and Micro Technologies

detect the presence of an eavesdropper. The basis transfor-
mation most commonly used in this case is the Hadamard
operation, i.e., a transformation from the Z- into the X-
basis. In general, a basis transformation from the Z-Basis
into the X-basis can be described as a combination of
rotation operations, i.e.,
T

ΘA
ΘB
XPe\
0
Π
4
Π
2
3 Π
4
Π
0
Π
4
Π
2
3 Π
4
Π
0
0.1
0.2
Figure 3.
Eve’s expected error probability ⟨Pe⟩ if both parties apply a
basis transformation with the respective angles θA and θB.
information on the Alice’s and Bob’s result is lower com-
pared to the ﬁrst scenario, i.e., Alice’s and Bob’s Shannon
entropy is higher:
H =1
4 h

cos2 θA
2

+ 1
4 h

cos2 θB
2

+1
8 h

cos2 θA + θB
2

+ 1
8 h

cos2 θA − θB
2

(15)
This is due to the fact that it is more difﬁcult for Eve to react
on two separate basis transformations with different angles
θA and θB and is easy to see from the plot of the Shannon
entropy H in Figure 4.
IV. RESULTS
For the scenarios where either Alice or Bob applies a
basis transformation at random, the optimal value for θA and
θB, respectively, is π/2. Therefore, the Hadamard operation
is the optimal choice in this scenario for protocols using
only one basis transformation, as it is already known from
literature [13], [20]. In this case the average error probability
as well as the Shannon entropy are maximal at ⟨Pe⟩ = 0.25
and H = 0.5 (cf. Figure 2). Further, Eve’s information on
the bits of the secret key is given by the mutual information
IAE = 1 − H = 1 − 1
2 = 1
2
(16)
which means that Eve has 0.5 bits of information on every
bit of the secret key. Using error correction and privacy
ampliﬁcation Eve’s information can be brought below 1 bit
of the whole secret key as long as the error rate is below
∼ 11% [11]. This is more or less the standard threshold
value for the prepare and measure QKD protocols.
A combined application of the Hadamard operation by
both parties would indicate at a ﬁrst glance that the security
is further increased. But when we look at Figure 4 we see
that a random application of the Hadamard operation by both
Alice and Bob gives the same result as the application on just
one side. This is due to the fact that in case both parties apply
the Hadamard operation at the same time the operations
cancel out each other. But as we can further see from Figure
ΘA
ΘB
H
0
Π
4
Π
2
3 Π
4
Π
0
Π
4
Π
2
3 Π
4
Π
0
0.25
0.5
Figure 4.
Alice’s and Bob’s Shannon entropy H if both parties apply a
basis transformation with the respective angles θA and θB.
4, the Shannon entropy for a combined application of basis
transformations is much higher for some regions. In detail,
the maximum of the function plotted in Figure 4 is
H ∼ 0.55
and thus
IAE ∼ 0.45
(17)
for θA = π/4 and θB = π/2 or vice versa. Hence, if just
one of the parties applies a Hadadmard operation and the
other one a transformation about an angle of π/4 Eve’s
mutual information is about 10% lower. At the same time
we see from Figure 3 that for these two values of θA and
θB the error probability is still maximal with ⟨Pe⟩ = 0.25.
This means Alice and Bob are able to further reduce Eve’s
information about the raw key by the combined application
of two basis transformations, one about θ = π/2 and the
other about θ = π/4.
V. CONCLUSION AND FURTHER RESEARCH
In this article, we discussed the optimality of basis trans-
formations to secure entanglement swapping based QKD
prototcols. Starting from a generic entanglement swapping
scenario we used a collective attack strategy to analyse
the amount of information an adversary is able to obtain.
We showed that in case only one party applies a basis
transformation the operation Tθ reduces to the Hadamard
operation, i.e., the angle θ = π/2 allows a maximal mutual
information of IAE = 0.5. Whereas, if both parties apply
a transformation the optimal choice for the angles θA and
θB describing the basis transformations is θA = π/4 and
θB = π/2. This decreases the mutual information of an
adversary further to IAE ∼ 0.45.
The next questions arising directly from these results are
how, if at all, the results change if basis transformations
from the Z- into the Y -basis are applied. A ﬁrst inspection
shows that such basis transformations can not be plugged
in direclty into this framework. Besides the transformation
from the Z- into the Y - basis we are going to insepct the
effects of the simpler rotation operations on the results.
Since basis transformations can be described in terms of
rotation operations it could be easier to apply rotation
63
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-214-1
ICQNM 2012 : The Sixth International Conference on Quantum, Nano and Micro Technologies

operations in this framework. Due to the similar nature of
basis transformations and rotation operations we assume that
the results will be the same as presented here.
To keep the setting as general as possible the main goal
is to allow Alice and Bob to use arbitrary unitary operations
instead of just basis transformations to secure the protocol.
This should make it even more difﬁcult for Eve to gain
information about the raw key.
ACKNOWLEDGMENTS
We would like to thank Christian Kollmitzer, Oliver
Maurhart as well as Beatrix Hiesmayr and Marcus Huber
for fruitful discussions and interesting comments.
REFERENCES
[1] C. H. Bennett and G. Brassard, “Public Key Distribution
and Coin Tossing,” in Proceedings of the IEEE International
Conference on Computers, Systems, and Signal Processing.
IEEE Press, pp. 175–179, 1984.
[2] A. Ekert, “Quantum Cryptography Based on Bell’s Theorem,”
Phys. Rev. Lett., vol. 67, no. 6, pp. 661–663, 1991.
[3] C. H. Bennett, G. Brassard, and N. D. Mermin, “Quantum
Cryptography without Bell’s Theorem,” Phys. Rev. Lett.,
vol. 68, no. 5, pp. 557–559, 1992.
[4] D. Bruss, “Optimal Eavesdropping in Quantum Cryptography
with Six States,” Phys. Rev. Lett, vol. 81, no. 14, pp. 3018–
3021, 1998.
[5] A. Muller, H. Zbinden, and N. Gisin, “Quantum Cryptog-
raphy over 23 km in Installed Under-Lake Telecom Fibre,”
Europhys. Lett., vol. 33, no. 5, pp. 335–339, 1996.
[6] A. Poppe, A. Fedrizzi, R. Usin, H. R. B¨ohm, T. Lor¨unser,
O. Maurhardt, M. Peev, M. Suda, C. Kurtsiefer, H. Weinfurter,
T. Jennewein, and A. Zeilinger, “Practical Quantum Key
Distribution with Polarization Entangled Photons,” Optics
Express, vol. 12, no. 16, pp. 3865–3871, 2004.
[7] A. Poppe, M. Peev, and O. Maurhart, “Outline of the SEC-
OQC Quantum-Key-Distribution Network in Vienna,” Int. J.
of Quant. Inf., vol. 6, no. 2, pp. 209–218, 2008.
[8] M. Peev, C. Pacher, R. All´eaume, C. Barreiro, J. Bouda,
W. Boxleitner, T. Debuisschert, E. Diamanti, M. Dianati, J. F.
Dynes, S. Fasel, S. Fossier, M. F¨urst, J.-D. Gautier, O. Gay,
N. Gisin, P. Grangier, A. Happe, Y. Hasani, M. Hentschel,
H. H¨ubel, G. Humer, T. L¨anger, M. Legr´e, R. Lieger,
J. Lodewyck, T. Lor¨unser, N. L¨utkenhaus, A. Marhold,
T. Matyus, O. Maurhart, L. Monat, S. Nauerth, J.-B. Page,
A. Poppe, E. Querasser, G. Ribordy, S. Robyr, L. Salvail,
A. W. Sharpe, A. J. Shields, D. Stucki, M. Suda, C. Tamas,
T. Themel, R. T. Thew, Y. Thoma, A. Treiber, P. Trin-
kler, R. Tualle-Brouri, F. Vannel, N. Walenta, H. Weier,
H. Weinfurter, I. Wimberger, Z. L. Yuan, H. Zbinden, and
A. Zeilinger, “The SECOQC Quantum Key Distribution Net-
work in Vienna,” New Journal of Physics, vol. 11, no. 7, p.
075001, 2009.
[9] N. L¨utkenhaus, “Security Against Eavesdropping Attacks in
Quantum Cryptography,” Phys. Rev. A, vol. 54, no. 1, pp.
97–111, 1996.
[10] ——, “Security Against Individual Attacks for Realistic
Quantum Key Distribution,” Phys. Rev. A, vol. 61, no. 5, p.
052304, 2000.
[11] P. Shor and J. Preskill, “Simple Proof of Security of the BB84
Quantum Key Distribution Protocol,” Phys. Rev. Lett., vol. 85,
no. 2, pp. 441–444, 2000.
[12] A. Cabello, “Quantum Key Distribution without Alternative
Measurements,” Phys. Rev. A, vol. 61, no. 5, p. 052312, 2000.
[13] ——, “Reply to ”Comment on ”Quantum Key Distribution
without Alternative Measurements””,” Phys. Rev. A, vol. 63,
no. 3, p. 036302, 2001.
[14] ——, “Multiparty Key Distribution and Secret Sharing Based
on Entanglement Swapping,” quant-ph/0009025 v1, 2000.
[15] D. Song, “Secure Key Distribution by Swapping Quantum
Entanglement,” Phys. Rev. A, vol. 69, no. 3, p. 034301, 2004.
[16] C. Li, Z. Wang, C.-F. Wu, H.-S. Song, and L. Zhou, “Certain
Quantum Key Distribution achieved by using Bell States,”
International Journal of Quantum Information, vol. 4, no. 6,
pp. 899–906, 2006.
[17] C. H. Bennett, G. Brassard, C. Crepeau, R. Jozsa, A. Peres,
and W. K. Wootters, “Teleporting an Unknown Quantum
State via Dual Classical and EPR Channels,” Phys. Rev. Lett.,
vol. 70, no. 13, pp. 1895–1899, 1993.
[18] M. Zukowski, A. Zeilinger, M. A. Horne, and A. K. Ekert,
“”Event-Ready-Detectors” Bell State Measurement via En-
tanglement Swapping,” Phys. Rev. Lett., vol. 71, no. 26, pp.
4287–4290, 1993.
[19] B. Yurke and D. Stoler, “Einstein-Podolsky-Rosen Effects
from Independent Particle Sources,” Phys. Rev. Lett., vol. 68,
no. 9, pp. 1251–1254, 1992.
[20] S. Schauer and M. Suda, “A Novel Attack Strategy on
Entanglement Swapping QKD Protocols,” Int. J. of Quant.
Inf., vol. 6, no. 4, pp. 841–858, 2008.
64
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-214-1
ICQNM 2012 : The Sixth International Conference on Quantum, Nano and Micro Technologies

