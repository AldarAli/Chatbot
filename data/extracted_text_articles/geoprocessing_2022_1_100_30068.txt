C2 Spline Quasi-Interpolation To Downscale A Digital Elevation Model 
 
Salah Eddargani 
Department of Applied Mathematics  
University of Granada 
Granada, Spain 
email: seddargani@correo.ugr.es 
Juan Francisco Reinoso-Gordo 
Department of Architectural and 
Engineering Graphic Expression, 
Universidad de Granada, 
Granada, Spain 
email: jreinoso@ugr.es 
 
Domingo Barrera, María José Ibáñez  
Department of Applied Mathematics 
University of Granada 
Granada, Spain 
emails: {dbarrera,mibanez}@ugr.es 
Francisco Javier Ariza-López 
Department of Cartographic, Geodesic 
and Photogrammetry Engineering, 
University of Jaén, 
Jaén, Spain 
email: fjariza@ujaen.es 
 
 
 
Abstract— Digital Elevation Models (DEMs) are one of the 
products delivered by most of the national and regional 
cartographic agencies of the states. They are discrete 
representations of a territory and are of undoubted practical 
importance. Algorithms based on available discrete data make 
it possible to estimate terrain-related features and perform on 
DEMs operations of interest. Resampling is one of them 
(particularly downscaling). Traditional algorithms compute 
slope and curvature from discrete samples. In this paper a low 
computational cost spline-based procedure to construct a  C2 
continuous surface fitting the data is proposed which will allow 
to compute slope and curvature. To assess the downscaling 
quality of the quasi-interpolation-based algorithm, it is 
proposed two analysis: a) an horizontal displacement 
computation based on particle image velocimetry and b) a 
visual analysis for the height error pattern using a threshold 
parameter 
Keywords-Powell-Sabin 
triangulation; 
Bernstein-Bézier 
representation; data quality; approximating splines;  DEM; 
resampling.  
I. 
 INTRODUCTION  
Digital Elevation Models (DEMs) are used as the basis for 
multiple projects concerning Civil Engineering,  hydrology, 
geology and land-use planning. DEM resolution (cell size) 
depends on the project objective: a geological study will 
require less resolution than the DEM used to compute the 
watershed sinking on a small structure crossing a road. Many 
times there is not a DEM with the appropriate resolution and 
it is necessary to resample it at smaller or larger scales: an 
example for the first case occurs when a higher resolution 
has been used to improve urban flood zones in the absence of 
denser models [1]; the second occurs when assessing the 
altimetric accuracy between of a lower resolution DEM 
versus a higher resolution reference DEM [2]. It is 
interesting knowing the resampling process quality in the 
final product: Leon Tan et al. [3] analyze the influence of 
resampling on the streamflows derived from a DEM. 
Nevertheless, in most cases, the error introduced by the 
resampling from a higher resolution to a lower one was left 
unanalyzed, as indicated in [4]. There are traditional 
resampling methods but they are not based on continuous 
functions; they are also weak when computing variables that 
involve derivatives such as curvature and slope. The quasi-
interpolant algorithm we propose solves this problem 
because the base function is of C2-continuity. 
In Section II we explain the C2 quasi-interpolant 
algorithm. The method to assess the algorithm is based on 
the horizontal displacement computation: a DEM product 
(DEMpro) is downscaled and assessed versus a DEM 
reference (DEMref) using the particle image velocimetry 
technique (Figure 1). A pattern visual analysis is also carried 
out (Figure 2). Both methods are included in section II. And 
section III contains the conclusions. 
 
II. 
METHODOLOGY 
 
The resampling and evaluation algorithm proposal will 
be made assuming that the pixel size of the DEMref is XxX m 
and will be denoted DEMrefXxX. The pipeline will be as 
follow: 
1. Upscaling DEMrefXxX (Fig. 1): the DEMrefXxX is 
upscaled using the nearest neighbour algorithm to a 
larger cell size which is called DEMrespYxY. 
2. An approximant surface (SrespYxY) is fitted to the 
DEMrespYxY by the algorithm Aapx, based on C2 
quasi-interpolation having a good approximation 
order (Figure 1).  
3. Downscaling (Figure 1): Since the definition domain 
SrespYxY is the same as DEMrefXxX, SrespYxY can be 
evaluated at the same points that the reference 
DEMrefXxX matrix, from which a homologous 
41
Copyright (c) IARIA, 2022.     ISBN:  978-1-61208-983-6
GEOProcessing 2022 : The Fourteenth International Conference on Advanced Geographic Information Systems, Applications, and Services

DEMderXxX_from_YxY of the same size as DEMrefXxX is 
obtained. 
4. The assessment is carried out comparing the 
DEMrefXxX and DEMderXxX_from_YxY. 
5. The Aapx planimetric quality is assessed using the [5] 
method based in particle image velocimetry 
approach. 
6. The altimetric quality is assessed computing the 
height discrepancy (dhi) in absolute value and 
representing in red on a shadow map the cells where 
dhi > threshold (Figure 2). 
 
The algorithm Aapx constructs, with low computational 
cost, a spline surface SrespYxY that fits the data based on quasi-
interpolation in the Bernstein basis. Suppose that the DEM 
of the terrain under study has an associated decomposition 
into squares of length h, whose vertices are vi,j=(ih,jh), 
0≤i≤n, 0≤j≤m. Let us define a triangulation by decomposing 
the square of opposite vertices vi,j and vi+1,j+1 into macro-
triangles Ti,j,1=< vi,j, vi+1,j, vi+1,j+1> and Ti,j,2 =< vi,j, vi+1,j+1, 
vi,j+1>. The approximating spline will be defined on the 
subtriangulation obtained by refining Ti,j,1 and Ti,j,2 as 
follows: a Powell-Sabin 6-splits results if the vertices of each 
triangle are joined with the midpoints of the corresponding 
opposite sides, intersecting at the barycenter [7]. Each 
macro-triangle is decomposed into 6 micro-triangles. The 
restriction of the spline surface to each micro-triangle will be 
a polynomial of total degree less than or equal to three. 
Therefore, it can be written as a linear combination of the 
corresponding ten cubic Bernstein polynomials associated 
with that micro-triangle. The Bernstein-Bézier coefficients 
[6] of the constraints must be calculated to get a C2-
continuous surface in such that way that, if the data came 
from a cubic surface, the approximating spline obtained is 
itself (exactness on the space of polynomials of degree up 
most three). Those coefficients will be calculated as linear 
combinations of DEM values at neighboring points. Their 
coefficients will provide masks to be computed to ensure 
C2continuity and the required exactness.   
 
 
Figure 1: Proccess flowchart. 
 
 
 
Figure 2: Absolute height discrepancy larger than a predefined threshold. 
III. 
CONCLUSIONS 
In this work, it is proposed a new algorithm Aapx to get a 
DEMproYxY, motivated by the necessity to get a downscaled 
version (DEMderXxX_from_YxY) The horizontal and vertical 
accuracy have been assessed comparing it versus a 
DEMrefXxX. It is proposed as well a pipeline to assess the 
planimetric and altimetric quality. The planimetric quality 
assessment is innovative because very few cases use the 
particle image velocimetry approach; It is proposed a 
graphical threshold approach to inform about the altimetric 
error which detects pattern where the higher errors occur, 
e.g., road limits (Figure 2). In future work we will implement 
the particle image velocimetry algorithm. 
ACKNOWLEDGMENT 
This work has been financed by the research project 
"Functional Quality of Digital Elevation Models in 
Engineering" of the State Agency Research of Spain. 
PID2019-106195RB-I00/AEI/10.13039/501100011033 
(https://coello.ujaen.es/investigacion/web_giic/funquality4de
m/). 
REFERENCES 
 
[1] J. Shen, F. Tan, “Effects of DEM resolution and resampling 
technique on building treatment for urban inundation 
modeling: a case study for the 2016 flooding of the HUST 
campus in Wuhan,” Nat Hazards, vol. 104, pp. 927–957, 
2020. 
[2] B. Wang, W. Shi, E. Liu, “Robust methods for assessing the 
accuracy of linear interpolated DEM,” Int. J. Appl. Earth Obs. 
Geoinf., vol. 34, pp. 198–206, 2015. 
[3] M. Leong Tan, D. L. Ficklin, B. Dixon, A. L. Ibrahim, Z. 
Yusop, V. Chaplot, “Impacts of DEM resolution, source, and 
resampling technique on SWAT-simulated streamflow,” 
Appl. Geogr., vol. 63 pp. 357–368, 2015. 
[4] J. L. Mesa-Mingorance, F. J. Ariza-López, “Accuracy 
Assessment of Digital Elevation Models (DEMs): A Critical 
Review of Practices of the Past Three Decades,” Remote 
Sens., vol. 12, 2630, 2020.  
[5] J. F. Reinoso, C. León, J. Mataix, “Estimating Horizontal 
Displacement between DEMs by Means of Particle Image 
Velocimetry Techniques,” Remote Sens., vol. 8 (1), 14, 2016. 
[6] G. Farin, Curves and Surfaces for CAGD. A practical guide, 
Fifth Edition, Elsevier, 2002. 
[7] M. Powell, M. Sabin, “Piecewise quadratic approximations on 
triangles,” ACM Trans Math Softw, vol. 3, pp. 316–325, 1977
42
Copyright (c) IARIA, 2022.     ISBN:  978-1-61208-983-6
GEOProcessing 2022 : The Fourteenth International Conference on Advanced Geographic Information Systems, Applications, and Services

