LQG Control of a Two-Wheeled Mobile Pendulum System 
 
√Åkos Odry, Ervin Burkus, P√©ter Odry 
Department of Control Engineering and Information Technology 
College of Duna√∫jv√°ros 
Duna√∫jv√°ros, Hungary 
E-mail: {odrya, burkus, podry}@mail.duf.hu 
 
 
Abstract‚ÄîIn this paper, the linear-quadratic-Gaussian control 
of a mechatronic system will be studied. The mechatronic 
system is a special mobile robot (called two-wheeled mobile 
pendulum) having two-wheels, two contact points with the 
supporting surface and its center of mass is located under the 
wheel axis. Due to the mechanical structure, the inner body 
(which acts as a pendulum between the wheels) tends to oscillate 
during the translational motion of the robot, thus the 
application of modern control methods is essential in order to 
stabilize the dynamical system. In the first part of the paper, the 
mechatronic system and the corresponding mathematical model 
are introduced, while in the second part different controllers are 
designed for the plant. The achieved control performances are 
analyzed based on simulation and implementation results.  
Keywords-LQG control; Kalman-filter; mobile robot; self-
balancing robot; future transportation system 
I. 
 INTRODUCTION 
The linear-quadratic-Gaussian (LQG) technique is a 
beloved method in the control of dynamical systems since it 
provides the optimal state feedback gain based on the well-
developed mathematical algorithm [1]. Numerous researches 
have been dealt with its application and control performance 
in real embedded environments such as references [2] - [9]. 
Divelbiss and Wen [2] presented their experimental results of 
the tracking control of a car-trailer system, where linear 
quadratic regulator was used to track the trajectory. Ji and Sul 
[4] proposed an LQG-based speed control method for 
torsional vibration suppression in a 2-mass motor drive 
system, which gave satisfying performance and robust 
behavior against parameter variations. Bouabdallah, Noth and 
Siegwart [5] compared the control performances of the PID 
and linear-quadratic (LQ) techniques applied to an 
autonomous four-rotor micro helicopter, and emphasized that 
the control performance of the later technique was influenced 
by model imperfections. Recent efforts broaden further the set 
of experimental research results regarding the LQG control, 
including the control of inverted pendulum type assistant 
robot [6], self-balancing unicycle robot [7], unmanned 
helicopter in an uncertain environment [8], inverted pendulum 
system [9], and quadrotors [3] as well. All the mentioned 
papers show that the LQG technique have proved its 
competitive performance in the control of dynamical systems. 
Our research goal is to analyze critical balance tasks 
through the design, optimization and validation of modern 
control methods. Thus, as a first step, the design and 
implementation of the well-known LQG controller had been 
performed, where the resultant control performances form the 
initial results of our research analysis. These initial results can 
be used in the design optimization or in the comparison with 
other control methods (such as fuzzy control), which is left for 
another publication. 
On the other hand, it can be observed that nowadays 
technological efforts focus on the development and 
application of modern control solutions by which mechanical 
or other kind of anomalies are compensated in dynamical 
systems (the result of such aspirations is for example the 
transportation vehicle Segway). Since the two-wheeled 
mobile pendulum system shall be stabilized by feedback in 
order to achieve translational motion, we also strengthen and 
develop this tendency by the analysis and design of modern, 
optimized control solutions for the plant. 
The remainder of this paper is organized as follows. In 
section II, the mechatronic structure of the robot is introduced, 
while in section III, the corresponding nonlinear mathematical 
is derived. In section IV, the control tasks and the LQG control 
method are reviewed. From section V, the control strategies 
are elaborated, namely, in section V, the anti-sway speed 
control-, while in section VI, the balance control of the robot 
are designed with simulation results. Section VII deals with 
the state estimation, while in section VIII, the application of 
the complete LQG control strategies is described. The 
implementation results of the elaborated control strategies are 
given in section IX. Section X contains the conclusions and 
the future work recommendations. 
 
Figure 1.  Photograph of the fabricated robot. 
105
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-437-4
INTELLI 2015 : he Fourth International Conference on Intelligent Systems and Applications

II. 
THE FABRICATED MECHATRONIC SYSTEM 
The mechatronic system is a special mobile robot (called 
two-wheeled mobile pendulum) consisting of two wheels and 
a steel inner body (chassis). The wheels are actuated through 
DC motors that are attached to the body. As it can be seen in 
Figure 1, the diameter of the wheels is bigger than the 
diameter of the intermediate body, thus the robot has only two 
contact points with the supporting surface. Due to this 
mechanical structure, the inner body behaves as a pendulum 
between the stator and rotor of the applied DC motors, and 
tends to oscillate when the robot performs translational 
motion. 
Since the location of the center of mass of the robot can be 
under and above the wheel axis, two equilibrium points can be 
distinguished. Namely, the robot stays around its stable 
equilibrium point when the center of mass is located under the 
wheel axis. Therefore, around this state the translational 
motion of the robot is affected by the damped oscillation of 
the inner body. On the other hand, the robot is operated around 
its unstable equilibrium point when the center of mass is 
stabilized above the wheel axis. Around the unstable 
equilibrium point, the robot simultaneously performs 
translational motion and balances its inner body, which acts as 
an inverted pendulum. For video demonstration see the 
website [10]. 
The electronic construction is built around two 16-bit 
ultra-low-power 
Texas 
Instruments 
MSP430F2618 
microcontrollers (hereinafter MCU1 and MCU2). The applied 
sensors are summarized in Table 1. The actuators are 3V 
geared DC micromotors (type: 1024N003S) manufactured by 
Faulhaber. The motors are driven with pulse width modulation 
(PWM) signals through Texas Instruments DRV592 drivers. 
The electronic system is supplied from stabilized 3.3V, the 
source is a 1 cell lithium-polymer (Li-Po) battery. A 16 MHz 
quartz oscillator is used as the system clock. 
Similar construction was built at the McGill University‚Äôs 
Centre for Intelligent Machines [11]. It was proven that the 
two contact point construction is characterized by the so called 
quasiholonomic property that eases the control of 
nonholonomic systems. Another corresponding two contact 
point construction is the electric diwheel built by the School 
of Mechanical Engineering at the University of Adelaide [12]. 
III. 
MATHEMATICAL MODEL 
To be able to efficiently design the control algorithms of 
the system, its mathematical model has to be obtained first. 
Most of the electrical and mechanical parameters that 
characterize the robot dynamics (such as wheel radius or 
resistance of the motor) are quite accurately known from 
direct measurements, datasheets or from calculations 
performed by Solidworks, the rest of the parameters were 
experimentally tuned based on the measurements. 
We indicate with and  the angular displacements of 
the wheels, while with   the inclination angle of the 
pendulum (inner body). The parameters that characterize the 
robot are summarized in Table 2 in the appendix. The 
following notations will be also used:  as the mean value of 
and ,  as the change of yaw angle of the robot, and  as 
the linear speed of the robot, i.e.,  = 	 + /2,  =
	 ‚àí /, and  = . 
The motion of the system was determined by the help of 
the Lagrange equations [13], which lead us to the following 
equations of motion of the mechanical system [14]: 
 
 + ,  =  ‚àí , 
(1) 
where   denotes the 3-by 3 symmetric and positive 
definite inertia matrix, ,   denotes the 3-dimensional 
vector term including the Coriolis and centrifugal force terms 
and also the potential (gravity) force term. 
The Lagrange function and the exact elements of the 
matrices in (1) are described in the appendix. For the vector 
of generalized coordinates  = , ,   was chosen, 
since it contains the minimum number of independent 
coordinates that define the configuration of the system. The 
generalized external forces in (1) consist of the torques  
that are produced by the motors and the effect of friction  
that is modeled in the system [14]. The torques   are 
described by the differential equation (2) where the input 
voltages and currents of the motors are denoted with  =
,  and  = , . 
 
 = 1
   ‚àí !"! #1
0
‚àí1
0
1
‚àí1%  ‚àí &', 
 = !(! )
1
0
0
1
‚àí1
‚àí1
* . 
(2) 
Regarding the effect of friction , only viscous frictions 
were assumed. Namely, viscous friction was modelled at the 
bearings and between the wheels and the supporting surface: 
 
 = )
, + -.
0
‚àí,
0
, + -.
‚àí,
‚àí,
‚àí,
2,
* . 
(3) 
Based on (1) the state-space representation of the two-
wheel inverted pendulum system is obtained. With the state 
vector / = , ,  the state-space equation [14]: 
 
/0 = ‚Ñé/, , 
‚Ñé/,  =
2
3
3
3
4

5   ‚àí  ‚àí , '
1
   ‚àí !"! #1
0
‚àí1
0
1
‚àí1%  ‚àí &'6
7
7
7
8
, 
90 = /0. 
(4) 
TABLE I.  
THE APPLIED SENSORS IN THE EMBEDDED ELECTRONICS 
Sensor 
Manufacturer 
Type 
Accelerometer 
STMicroelectronics 
LIS331DL 
Gyroscope 
STMicroelectronics 
L3G4200D 
Current sensors 
Texas Instruments 
INA198 
Incremental encoders 
Faulhaber 
PA2-100 
 
106
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-437-4
INTELLI 2015 : he Fourth International Conference on Intelligent Systems and Applications

Remark: In the simulation environment the state-space 
equation (4) was implemented, however during the design of 
the LQG controllers the 6-dimensional version defined by the 
state vector / = ,  was used. This outcome was chosen 
because the current measurements were that noisy that the 
states  = ,  could not be used in the feedback. The 6-
dimensional model is derived by neglecting the inductance  
of the motors. 
IV. 
CONTROL TASKS 
Two control tasks were investigated in the analysis, 
namely the balance control and the anti-sway control of the 
plant.  Therefore, around the stable equilibrium point the 
speed control of the robot had been chosen as control task, 
where the implemented controller shall minimize the 
resulting oscillation of the inner body. While around the 
unstable equilibrium point the position control of the robot 
had been chosen as control task, where the implemented 
controller shall stabilize the inner body during the 
translational motion. 
A. LQ control 
The linear-quadratic control addresses the issue of 
achieving a balance between good system response and 
control effort [1]. It is based on a developed mathematical 
algorithm, which results the optimal state-feedback gain K. 
The feedback gain K minimizes the quadratic cost function 
 
:/,  = 1
2 ;/<
=/< + <
&<
>5
<?@
+ 1
2 />
=/>, 
(5) 
where / ‚àà ‚ÑùC  and  ‚àà ‚ÑùD  are the state and input of the 
system described by its state-space equation, while = = = ‚àà
‚ÑùC√óC, = ‚â• 0 and & ‚àà ‚ÑùD√óD, & > 0 are weighting matrixes. 
According to the LQR method, the state feedback matrix is 
given by H = & + IJI5IJK , where J = J ‚â• 0 is 
the unique solution of the Control Algebraic Riccati Equation 
(CARE). The optimal state-feedback < = ‚àíH/< ensures the 
asymptotic stability of the closed loop system. The feedback 
matrix H  is calculated by the built-in Matlab function 
lqrd(A,B,Q,R,Ts). 
B. Reference tracking 
Since the LQ control defined by the objective function (5) 
drives the system from the initial state /@ to the state /L = 0, 
the control structure shall be extended with the reference 
tracking matrixes: 
 
MNO
NPQ = #K ‚àí 
I
R
0%
5
M0C√óD
D Q, 
(6) 
where 0 and  are the zero and identity matrixes respectively 
(the sizes are given in the subscript). 
C. LQG control 
In the development of the optimal LQ control strategy it 
is assumed the state variables are measurable, and the system 
is not disturbed by either internal or external noises. However 
in practice the opposite situation is quite common, namely, 
that a part of the state vector is too noisy to use directly in the 
feedback. The LQG strategy provides optimal control gain to 
stochastic, noisy systems by minimizing the expected value 
of the quadratic objective function (5). 
Based on the separation principle the LQG control 
strategy is given by the state-feedback < = ‚àíH/S<, where H 
is the optimal control gain determined by the LQR algorithm, 
while /S<  state vector consists of the original states (those 
states of /< that were not noisy) and the Kalman-filter based 
estimation of the noisy states. Let us denote the unmeasurable 
or noisy states with T, than the corresponding noisy linear 
system can be given by: 
 
T<U = Œ¶T< + ŒìX< + Y<, 
Z< = Œ°T< + \<, 
(7) 
where the process and measurement noises are indicated with 
Y  and \  respectively, and according to the stochastic 
hypothesis these noises are uncorrelated and their mean value 
is zero. In this case the Kalman-filter algorithm provides the 
optimal estimation T] of the state T, i.e., ^_T< ‚àí T]<` = 0 and 
^ #	T< ‚àí T]<	T< ‚àí T]<
% ‚Üí inf . The estimation algorithm 
can be found in [15]. 
Therefore, the design steps are the following: i.) 
Linearization of the mathematical model around an 
equilibrium 
point, 
ii.) 
Controllability 
analysis, 
iii.) 
Specification of the weighting matrixes, iv.) Calculation of the 
optimal control gain H, v.) Identification of the noisy states, 
vi.) Specification of the noise covariance parameters of the 
filter, vii.) State estimation by Kalman filter and viii.) 
Application of the state feedback strategy < = ‚àíH/S<. 
V. 
CONTROL STRATEGY AROUND THE STABLE 
EQUILIBRIUM POINT 
Around the stable equilibrium point the anti-sway speed 
control of the robot is elaborated. 
A. Elaboration 
The linear state space equation is given by the 
linearization of (4) around the equilibrium /e, e = 0,0: 
 
/ = Mf‚Ñé
f/Q
Og,Pg
hiijiik
lm
/0 + Mf‚Ñé
fQ
Og,Pg
hiijiik
nm
0, 
(8) 
where the subscript  refers to the stable equilibrium point. In 
order to reduce the complexity of implementation the  /o =
p/ = 	, , , , , 
 coordinate 
transformation 
is 
applied. The resulting state-space representation is given by: 
 
/o = q
0√ó

0√ó
Krs,
Krs,
0√ó
0√ó
0√ó
Krs,
t /o + q
0√ó
Ius,
Ius,
t , 
9 = _0√ó
Rrs,
Rrs,`/o, 
(9) 
where the block matrices are described in the appendix.  
107
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-437-4
INTELLI 2015 : he Fourth International Conference on Intelligent Systems and Applications

The controllability matrix [1] is given by v =
wI
KI
‚Ä¶
KyIzlum,num  and the evaluation of its rank 
results rank v = 4. Therefore, according to the Kalman 
rank condition for controllability (KRCC) the system (9) is 
not controllable, since the dimension of the state vector is 
dim /o = 6. The non-controllable states of /o are the position 
 and the orientation .  
Thus, a new coordinate transformation \ = p‚Äö‚ÄöÃÖ/o  is 
defined, such that  p‚Äö‚ÄöÃÖ = p‚Äö, p‚ÄöÃÖ  is a basis for ‚Ñù‚Äû , 
furthermore the columns of p‚Äö  form the basis for the 
controllable subspace, dim p‚Äö = 6 √ó 4 and dim p‚ÄöÃÖ =  6 √ó 2. 
As a consequence of the definition, the state vector \ =
\‚Äö, \‚ÄöÃÖ  is clearly devided into two parts, namely \‚Äö =
	, , , 
  denotes the controllable states, while \‚ÄöÃÖ =
,   contains uncontrollable ones, and the state-space 
representation becomes 
 
\ = ‚Ä†K‚Äö
K‚Äö‚ÄöÃÖ
0
K‚ÄöÃÖ ‚Ä° \0 + #I‚Äö
0 % 0, 
9 = wR‚Äö
R‚ÄöÃÖz\0. 
(10) 
The LQ strategy is elaborated by using the controllable 
subsystem K‚Äö, I‚Äö. The weighting matrixes = = diag=‚Ä∞‚Ä∞ 
and & = diag	R‚Äπ‚Äπ were defined based on the Bryson‚Äôs rule, 
where = = 15 ‚àô ≈Ω/1805, = = 0.085, = = 50 ‚àô
≈Ω/1805 , =‚Ä¢‚Ä¢ = 50 ‚àô ≈Ω/1805  and & = & = 35 
were chosen. Solving the CARE the optimal control gain: 
 
Hs = #‚àí1.75
‚àí1.26
‚àí0.2
‚àí0.61
‚àí1.75
‚àí1.26
‚àí0.2
+0.61%, 
(11) 
while the reference tracking matrixes are 
 
NO
s = q
 ‚àí0.41
0
1
0
0
0
0
1
t ,
NP
s = #4.28
‚àí0.37
4.28
+0.37%. 
(12) 
B. Simulation results 
Simulation of the proposed control strategy was done in 
MATLAB Simulink environment. The simulation results of 
the closed loop behavior is depicted in Figure 2. 
 From the top, the first is the linear speed  of the robot, 
the second is the change of yaw , the third is the resulting 
oscillation  of the inner body, while the last one is the 
applied voltage to the motors. The following reference 
signals were applied: 
- 
L = ‚Äú0.4, 0, ‚àí0.2, 0‚Äù wm/sz,   
- 
L = ‚Äú0.5,0, ‚àí1.2,0‚Äù wrad/sz.  
The simulation results show that the applied control 
strategy satisfies the requirements, since the controller 
simultaneously ensures the speed control and the suppression 
of the inner body oscillations. The dynamics of the plant was 
sampled at fixed -s = 100 ‚Äì\, which equals to the sampling 
frequency of the applied sensors. 
VI. 
CONTROL STRATEGY AROUND THE UNSTABLE 
EQUILIBRIUM POINT 
Around the unstable equilibrium point the position control 
of the robot and the stabilization of its inner body is 
elaborated. 
A. Elaboration 
The state space equation is given by the linearization of 
(4) around /e = 0,0, ≈Ω, 0,0,0 and e = 0: 
 
/ = Mf‚Ñé
f/Q
Og,Pg
hiijiik
l‚Äî
/0 + Mf‚Ñé
fQ
Og,Pg
hiijiik
n‚Äî
0, 
(13) 
where the subscript  refers to the unstable equilibrium point. 
Again, 
the 
coordinate 
transformation 
/o = p/ =
	, , , , ,  is applied: 
 
/o = q
0√ó

0√ó
‚àíKrs,
Krs,
0√ó
0√ó
0√ó
Krs,
t /o + q
0√ó
Ius,
Ius,
t , 
9 = _Rrs,
0√ó
RrP,`/o, 
(14) 
where the block matrix RrP, = #0
0
1
0%.  
According to KRCC the system (14) is controllable, since 
rank v|lu‚Äî,nu‚Äî = 6 = dim /o . Similarly to the stable 
equilibrium point, the weighting matrixes were specified by 
the help of the Bryson‚Äôs rule. Therefore, = = diag=‚Ä∞‚Ä∞ and 
& = diag	R‚Äπ‚Äπ, where = = 0.15, = = 10 ‚àô ≈Ω/1805, 
 = = 0.155 , =‚Ä¢‚Ä¢ = 150 ‚àô ≈Ω/1805 , =yy = 10 ‚àô ≈Ω/
 
Figure 2.  Simulation results. Control performance around the stable 
equilibrium point. 
108
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-437-4
INTELLI 2015 : he Fourth International Conference on Intelligent Systems and Applications

1805 , =‚Äû‚Äû = 45 ‚àô ≈Ω/1805,  and & = & = 35. 
Solving 
the 
CARE 
the 
optimal 
feedback 
gain  
HP = H
P, H
P  takes the form (15), while the reference 
tracking matrices are given by (16): 
 
H
P = #‚àí7.46
‚àí5.47
‚àí11.1
‚àí0.28
‚àí7.46
‚àí5.47
‚àí11.1
‚àí0.28%, 
H
P = #‚àí4.35
‚àí0.634
+4.35
+0.634%, 
(15) 
 
NO
P = #1
0
0
0
0
0
0
0
0
0
1
0%

,
NP
P = 0√ó. 
(16) 
B. Simulation results 
Simulation results are shown in Figure 3. From the top, the 
first is the linear position  of the robot, the second is the yaw 
angle , the third is the tilt angle  of the inner body, while 
the last one is the applied voltage to the motors. The 
simulation was started with the following initial conditions: 
/@ = #0.05, 8 ‚àô
‚Ñ¢
≈°@ , 0, 0, 20 ‚àô
‚Ñ¢
≈°@ , 0%. It can be seen, that the 
calculated optimal feedback gain asymptotically stabilizes the 
closed loop system, and both the stabilization of the inner 
body and the position control is ensured. The following 
reference signals were applied in the simulation: L =
‚Äú0,0.1, ‚àí0.05,0‚Äù wmz and L = ‚Äú0,1.5,0, ‚àí0.7‚Äù wradz. 
VII. STATE ESTIMATION WITH KALMAN-FILTER 
The Kalman filter is used to estimate the tilt angle  of 
the inner body (second element of /o). Since the accelerometer 
measures the projection of gravity vector onto its axes, the 
angle is given by ,vv = atan  
≈ì
‚Ä¢'  [16]. Unfortunately, 
,vv is very noisy, in the most control methods useless and 
it can‚Äôt be considered as an accurate derived quantity at high 
frequency rates of rotation, because the accelerometer 
measures both the static acceleration of the gravity and the 
dynamic acceleration of the robot as well. Thus, it is common 
to consider the gyroscope and accelerometer as a noisy linear 
system and use the Kalman filter to estimate the state vector. 
The corresponding state-space equation is given by: 
 
T<U = #1
‚àí1/-s
0
1
% T< + #1/-s
0 % X< + Y< 
Z< = w1
0zT< + \<, 
(17) 
where the state vector T = , o consists of the inclination 
angle wradz, and the bias of the gyroscope owrad/sz. 
Furthermore, the input of the linear system is the angular 
velocity X = wrad/sz (measured by the gyroscope), while 
the output of the system is the derived angle Z = ,vvwradz 
from the pure accelerometer measurements. The covariance 
matrixes that characterize the measurement and state noises 
were defined based on offline measurements. 
VIII. THE LQG CONTROL STRUCTURES 
According to the separation principle the LQG control 
strategies are elaborated as follows. Around the stable 
equilibrium point the state feedback < = ‚àíH	≈æ, , ,  
ensures asymptotic stability of the closed loop system, where 
≈æ denotes the Kalman-filter based estimation of the tilt angle 
of the inner body and the optimal control gain H is defined by 
(11). The detailed control structure is depicted in Figure 4. 
 
Figure 3.  Simulation results. Control performance around the unstable 
equilibrium point. 
 
Figure 4.  Detailed LQG control structure. 
109
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-437-4
INTELLI 2015 : he Fourth International Conference on Intelligent Systems and Applications

While around the unstable equilibrium point, the state 
feedback 
< = ‚àíH	, ≈æ, , , , 
 provides 
the 
stabilization of the system, where the optimal control law is 
defined by (15) (the figure of the control structure is neglected 
since it‚Äôs almost the same as Figure 4). 
IX. 
IMPLEMENTATION RESULTS 
The control algorithm was coded in C language. MCU2 
was programmed to work as an inertial measurement unit 
(IMU). Its main task is to read the data of sensors (from 
accelerometer and gyroscope through SPI peripheral), and 
send a package consisting of ,vv , , and ≈æ to MCU1 
continuously (in every ps = 10 ≈∏), where ,vv indicates 
the inclination angle determined based on the pure 
accelerations measured by the accelerometer,  denotes the 
angular velocity of the pendulum measured by the gyroscope, 
while ≈æ indicates the Kalman estimation of the inclination 
angle. MCU1 executes the chosen control algorithm based on 
the 
collected 
measurements. 
It 
receives 
the 
package	,vv, , ≈æ from MCU2 and extends it with the 
instantaneous position and velocity of the robot ,  based 
on the measurements collected from the incremental encoders. 
Once the measurements are updated the chosen control 
algorithm updates the duty cycle of the PWM generator. 
Furthermore, the measurements are sent through the 
Bluetooth module with the frequency -s = 100‚Äì\. A GUI 
written in MATLAB records the measurements.  
The control performance was tested in different 
environments, i.e., both static and dynamic behavior of the 
chosen control algorithm. During the test of the dynamic 
behavior the robot was pushed away from its stable position. 
A. Control around the stable equilibrium point 
The control performance is depicted in Figure 5. From the 
top, the first is the linear speed , the second is the change of 
yaw , the third is the angle of the inner body , while the 
last one is the applied voltage. It can be seen that the 
implemented LQG control strategy successfully suppressed 
the oscillation of the inner body and ensured the speed control 
of the robot as well. 
B. Control around the unstable equilibrium point 
The implementation results are depicted in Figure 6, 7 and 
8. From the top, the first is the linear position , the second is 
the yaw angle , the third is the angle of the pendulum , 
while the last one is the applied voltage. Based on the 
measurements, it can be concluded that the elaborated LQG 
control strategy ensured both the stabilization of the inner 
body around the unstable equilibrium point, and the position 
control of the robot as well. 
In Figure 6 L = 0.2 wmz reference signal was applied 
and the stabilization took approximately 2.5 seconds. The 
noisy measurements of the tilt range and the importance of 
the Kalman filtration can be also observed in the figures, 
since ¬±50 w¬∞z oscillations were not present evidently during 
the balancing. The static behavior of the balancing was also 
investigated. It can be seen in Figure 7 that if there is no 
external perturbation the balancing range is in ¬±5 w¬∞z, while 
the position control tracks the reference with ¬±5 wmmz error. 
Finally, the dynamic behavior of the implemented control 
strategy was also tested on the robot, i.e., the robot was pushed 
away several times from its equilibrium state (the external 
perturbations are indicated with arrows). As it can be seen in 
Figure 8, both the balance and the stabilization of the robot 
 
Figure 5.  Implementation results. Control performance around the stable 
equilibrium point. Reference signals: L = 0.4 wm/sz,  L = 3 wrad/sz. 
 
Figure 6.  Implementation results. Control performance around the 
unstable equilibrium point. Reference signal: L = 0.2 wmz. 
110
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-437-4
INTELLI 2015 : he Fourth International Conference on Intelligent Systems and Applications

was successfully solved. First the robot was pushed about 
25 w¬¢≈∏z  away while the second time about 15 w¬¢≈∏z , the 
stabilization was achieved approximately in 2.5 seconds.  
X. 
CONCLUSION AND FUTURE WORK 
In this paper, LQG control strategies were elaborated to a 
two-wheeled mobile pendulum system. Namely, around the 
stable equilibrium state of the plant an anti-sway speed 
controller-, while around the unstable equilibrium point a 
position controller which ensures the stabilization of the inner 
body were developed and implemented on the real robot. The 
asymptotic stability of the closed loop system was proved 
based on simulation and measurement results. According to 
the implementation results it is concluded that the elaborated 
LQG control strategies produce satisfying and competitive 
control performances. These experiments form our initial 
results in the investigation of the control performances of 
different modern control methods. Future work will involve 
the identification of the unknown parameters, the validation 
of the developed control strategies and the development of 
modern (such as nonlinear, fuzzy) control algorithms to the 
system. 
ACKNOWLEDGMENT 
We acknowledge the financial support of this work by the 
Hungarian State and the European Union under the T√ÅMOP-
4.2.2.D-15/1/KONV-2015-0002 
project 
entitled 
‚ÄùDevelopment of Smart technologies for High-tech industry‚Äù. 
 
APPENDIX 
The Lagrange function of the system: 
‚Ñí = ; ¬§3
4 ≈∏¬• + 1
8 ≈∏¬¶ + ¬ß
2 ≈∏¬¶ sin  + 1
2 :‚Ñ¨

 + 1
2 !:¬©¬™ ‚Ä∞


‚Ä∞?
 
+ ; M1
2 ≈∏¬¶¬ß cos  ‚àí !:¬©Q ‚Ä∞

‚Ä∞?
 
+ ¬§1
4 ≈∏¬¶ ‚àí ¬ß
 ≈∏¬¶ sin  ‚àí :‚Ñ¨

¬™  
+ M1
2 ≈∏¬¶¬ß + 1
2 :- + !:¬©Q 
 ‚àí 2≈∏¬•¬Æ ‚àí ≈∏¬¶¬Æ ‚àí ¬ß cos . 
(A) 
 
Elements of the inertia matrix  = 	≈∏‚Ä∞‚Äπ√ó: 
≈∏ = 3
2 ≈∏¬• + 1
4 ≈∏¬¶ + !:¬© + ¬ß
 ≈∏¬¶ ¬Ø¬∞  + :‚Ñ¨

, 
≈∏ = ≈∏, ≈∏ = ≈∏¬¶¬ß + :- + 2!:¬©, 
≈∏ = ≈∏ = 1
4 ≈∏¬¶ ‚àí ¬ß
 ≈∏¬¶ ¬Ø¬∞  ‚àí :‚Ñ¨

, 
≈∏ = ≈∏ = ≈∏ = ≈∏ = 1
2 ≈∏¬¶¬ß ¬¢¬±  ‚àí !:¬©. 
(B) 
 
The elements of ,  = Y, Y, Y: 
Y = 2 ¬ß
 ≈∏¬¶ sin cos  	 ‚àí  ‚àí 1
2 ≈∏¬¶¬ß sin  
, 
Y = 2 ¬ß
 ≈∏¬¶ sin  cos  	 ‚àí  ‚àí 1
2 ≈∏¬¶¬ß sin 
, 
Y = ‚àí ¬ß
 ≈∏¬¶ sin  cos  	 ‚àí 
 + ≈∏¬¶¬Æ¬ß sin . 
(C) 
 
The block matrices of equation (9): 
Krs, = #0
‚àí0.08
0
‚àí136.5%, Krs, = #‚àí25.9
0.8
2338
‚àí73.6%,   
Krs, = #0
1
0
‚àí56%, Ius, = #
3
3
‚àí279.6
‚àí279.6%,  
Ius, = #
0
0
‚àí73.9
73.9%, Rrs, = #1
0
0
0%, and Rrs, = #0
0
0
1%. 
(D) 
 
Figure 7.  Implementation results. Control performance around the 
unstable equilibrium point. Static behavior. 
 
Figure 8.  Implementation results. Control performance around the 
unstable equilibrium point. Dynamic behavior. 
111
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-437-4
INTELLI 2015 : he Fourth International Conference on Intelligent Systems and Applications

TABLE II.  
NOTATION OF THE ROBOT PARAMETERS 
Symbol 
Name 
Value [SI Unit] 
 
Wheel radius 
3.15 ‚àô 105 
≈∏¬• 
Mass of the wheels 
31.6 ‚àô 105 
¬ß 
Distance between the COG 
and the wheel axle  
8.36 ‚àô 105 
≈∏¬¶ 
Mass of the inner body 
360.4 ‚àô 105 
 
Distance between the wheels 
177 ‚àô 105 
:- 
Moment of inertia of the inner 
body about the wheel axle - 
81367 ‚àô 105¬≥ 
:‚Ñ¨ 
Moment of inertia of the inner 
body about the axis ‚Ñ¨ 
574620 ‚àô 105¬≥ 
! 
Gear ratio 
64 
:¬© 
Rotor inertia 
0.12 ‚àô 105¬¥ 
& 
Terminal resistance 
2.3 
 
Rotor inductance 
26 ‚àô 105‚Äû 
!( 
Torque constant 
2.05 ‚àô 105 
!" 
Back-EMF constant 
2.05 ‚àô 105 
, 
Viscous friction coefficient 
between body - motor 
2.1 ‚àô 105y 
-. 
Viscous friction coefficient 
between wheels - ground 
1.8 ‚àô 105‚Ä¢ 
REFERENCES 
[1] G. F. Franklin, J. D. Powell, and A. Emami-Naeini, Feedback 
Control of Dynamic Systems. Pearson Prentice Hall, 2014, 
ISBN: 978-0-13349-659-8.  
[2] A. Divelbiss and J. Wen, "Trajectory tracking control of a car-
trailer system," IEEE Transactions on Control Systems 
Technology, 
vol. 
5, 
1997, 
pp. 
269 
- 
278, 
doi: 
10.1109/87.572125.  
[3] O. Araar and N. Aouf, "Full linear control of a quadrotor UAV, 
LQ vs H‚àû," UKACC International Conference on Control 
(CONTROL), 
2014, 
pp. 
133 
- 
138, 
doi: 
10.1109/CONTROL.2014.6915128. 
[4] J.-K. Ji and S.-K. Sul, "Kalman filter and LQ based speed 
controller for torsional vibration suppression in a 2-mass motor 
drive system," IEEE Transactions on Industrial Electronics, 
vol. 42, 2002, pp. 564 - 571, doi: 10.1109/41.475496. 
[5] S. Bouabdallah, A. Noth, and R. Siegwart, "PID vs LQ control 
techniques applied to an indoor micro quadrotor," IEEE/RSJ 
International Conference on Intelligent Robots and Systems 
(IROS 
2004), 
2004, 
pp. 
2451 
- 
2456, 
doi: 
10.1109/IROS.2004.1389776. 
[6] S. Jeong and T. Takahashi, "Wheeled inverted pendulum type 
assistant robot: inverted mobile, standing, and sitting motions," 
IEEE/RSJ International Conference on Intelligent Robots and 
Systems (IROS 2007), 2007, pp. 1932 - 1937, doi: 
10.1109/IROS.2007.4398961. 
[7] S. Zhiyu and L. Daliang, "Balancing control of a unicycle 
riding," 29th Chinese Control Conference (CCC), 2010, pp. 
3250 - 3254, ISBN: 978-1-4244-6263-6. 
[8] L. Yi-bo, L. Wan-zhu, and S. Qi, "Improved LQG control for 
small unmanned helicopter based on active model in uncertain 
environment," International Conference on Electronics, 
Communications and Control (ICECC), 2011, pp. 289 - 292, 
doi: 10.1109/ICECC.2011.6067810. 
[9] S. Nagaya, T. Morikawa, I. Takami, and G. Chen, "Robust LQ 
control for parallel wheeled inverted pendulum," 3rd 
Australian Control Conference (AUCC), 2013, pp. 189 - 194, 
doi: 10.1109/AUCC.2013.6697271. 
[10] AppL-DSP. Video demonstration of the robot. [Online]. 
Available from: http://appl-dsp.com/lqg-and-fuzzy-control-of-
a-mobile-wheeled-pendulum 
[11] A. Salerno and J. Angeles, "A New Family of Two-Wheeled 
Mobile Robots: Modeling and Controllability," IEEE 
Transactions on Robotics, vol. 23, 2007, pp. 169 - 173, doi: 
10.1109/TRO.2006.886277. 
[12] B. Cazzolato et al., "Modeling, simulation and control of an 
electric diwheel," Australasian Conference on Robotics and 
Automation (ACRA 2011), 2011, pp. 1-10, ISBN: 978-0-9807-
4042-4. 
[13] L. Sciavicco and B. Siciliano, Modelling and Control of Robot 
Manipulators. Springer-Verlag London, 2000, ISBN: 978-1-
85233-221-1. 
[14] √Å. Odry, I. Harmati, Z. Kir√°ly, and P. Odry, "Design, 
realization and modeling of a two-wheeled mobile pendulum 
system," 14th International Conference on Instrumentation, 
Measurement, Circuits and Systems (IMCAS '15), 2015, pp. 
75-79, ISBN: 978-1-61804-315-3. 
[15] G. Welch and G. Bishop, "An Introduction to the Kalman 
Filter," Tech. Rep. TR 95-041, Department of Computer 
Science, University of North Carolina, USA, 2001. 
[16] STMicroelectronics, "Tilt measurement using a low-g 3-axis 
accelerometer," Application note AN3182, 2010. 
 
 
 
 
 
 
 
112
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-437-4
INTELLI 2015 : he Fourth International Conference on Intelligent Systems and Applications

