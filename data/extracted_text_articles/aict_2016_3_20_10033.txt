Yasunori Iwanami 
Dept. of Computer Science and Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: iwanami@nitech.ac.jp 
Abstract—Recently, Muti-User MIMO (MU-MIMO) downlink 
system which uses multiple antennas at base station and 
accommodates multiple users with multiple receive antennas 
attracts much attention. In MU-MIMO downlink system, by 
knowing the Channel State Information (CSI) at the base 
station, Inter User Interferences (IUI’s) among users are 
pre-excluded at the base station. By increasing the number of 
transmit antennas assigned to each user, the transmission 
quality of each user is improved. In MU-MIMO, there exists 
linear precoding or nonlinear precoding method, but linear 
precoding is considered more easily implemented and adjusted 
than nonlinear precoding. In this paper, we aim the coverage 
extension and the transmission quality improvement by using 
a regenerative Detect & Forward (DF) relay in MU-MIMO 
downlink system. We use Block Diagonalization (BD) + Eigen 
mode transmission (E-SDM) for linear MU-MIMO scheme. By 
sharing the BD matrix at both base station and relay, the relay 
can demodulate the receive signal only with receive CSI and 
can forward the signal to each user. With this system 
configuration, we have shown the effectiveness of regenerative 
relay through simulations. 
Keywords-MU-MIMO; Block Diagonalization; Eigen mode 
transmission; Regenerative relay; Detect & Forward. 
I. INTRODUCTION 
Recently, Multi-User MIMO down link communication 
systems in which base station can transmit spatially 
multiplexed signals to multiple users without Inter-User 
Interference (IUI) are well investigated [1]-[7]. In 
MU-MIMO downlink system, in order to remove the IUI at 
base station, the channel state information (CSI) of 
downlink has to be known at the base station. By increasing 
the number of transmit antennas at base station, the channel 
quality to each user can be arbitrary improved. As 
representative 
methods, 
there 
exist 
BD 
(Block 
Diagonalization) [2] and Channel Inversion (CI) [3] 
categorized as linear methods, and DPC (Dirty Paper 
Coding) [4], THP (Tomlinson-Harashima Precoding) [5] 
and Vector Perturbation (VP) [6][7] as nonlinear methods. 
Although nonlinear methods can achieve greater channel 
capacity than linear methods, its complexity is higher and 
the design method is more difficult. As for the linear 
methods, the CI method has the problems of increasing 
transmit power and limited sum-rate. The BD method 
consumes a lot of degree of freedom to make the nulls, but 
it can remove the IUI completely. Also, the BD method 
matches the Eigen mode transmission (E-SDM; Eigenbeam 
Kentaro Iida 
Dept. of Computer Science and Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: cke17506@stn.nitech.ac.jp 
 
-Space Division Multiplexing) [8] well and is considered a 
practical design method. On the other hand, concerning the 
use of relay in MU-MIMO downlink, increasing the 
channel capacity by using the relay has been discussed 
[9][10]. On the relay transmission in MU-MIMO downlink 
system, the BD methods are used to remove the IUI at base 
station [11]-[15]. In [11], during the 1st time slot 
transmission from base station to relay, MU-MIMO is not 
employed, but during the 2nd time slot from relay to each 
user, it is used. In [12]-[15], the transmission from base 
station to relay is done during the 1st time slot, but the 
direct link from base station to each user during the 1st time 
slot is not considered. 
In this paper, on the DF relay in MU-MIMO downlink 
system, we employed the BD+E-SDM method for the 
transmission from base station to each user during the 1st 
time slot. We assume that the DF relay which locates 
between base station and each user already knows the 
precoding matrix of the base station. By knowing the 
precoding matrix, the relay can demodulate the receive 
signal only by using receive CSI. Accordingly, the base 
station does not need to assign the transmit antennas to the 
relay and the transmission from base station to relay 
becomes SU (Single-User)-MIMO. During the 2nd time 
slot, the DF relay transmits the signals to each user also 
using the BD+E-SDM method. At each user, the received 
signals during the 1st and the 2nd time slots are combined 
using the symbol LLR (Log Likelihood Ratio) addition and 
the combined signal is demodulated. We show the 
effectiveness of the proposed novel DF relaying system in 
MU-MIMO downlink through computer simulations. 
The paper is organized as follows. In Section II, the DF 
relay model in MU-MIMO downlink is introduced. In 
Section III, we design the downlink transmission during the 
1st time slot. In Section IV, we design the downlink during 
the 2nd time slot. In Section V, we present the symbol LLR 
combining method of received signals at each user terminal. 
In Section VI, we clarify the BER characteristics through 
computer simulations. The paper is concluded with Section 
VII with the most important results and future work. 
II. DF RELAY MODEL IN MU-MIMO DOWNLINK 
The proposed DF relaying model in MU-MIMO 
downlink system is shown in Figure1. The base station is 
equipped with 
s
N  transmit antennas. There exist total 
u
N  
users and the user 
( 1,
,
u )
i
  N
 has 
i
m  receive antennas. 
Thus, there are total 
1
u
N
d
i
i
N
   m
 receive antennas at users. 
A Regenerative Relay Transmission in Linearly Precoded MU-MIMO Downlink 
51
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-473-2
AICT 2016 : The Twelfth Advanced International Conference on Telecommunications

 
Figure 1. DF relay model in MU-MIMO downlink system 
 
The DF relay, which locates between base station and user 
terminals, has 
R
M  receive and 
R
N  transmit antennas. At 
base station, the transmit signal 
[ 1
u ]
T
i
N
s 
s
s
s


 
to each user is firstly multiplied by the precoding matrix V  
for making the multiple stream transmission using E-SDM. 
The 
transmit 
signal 
to 
user 
i  is expressed 
as 
(
)
[ (1)
]
iS
i
i
i
s
s
s 

 where 
iS  is the number of signal 
streams of user i . The matrix V  is expressed as 
1
u
N




 





V
V
V
0
0
0
0
0
0

                    (1) 
where the diagonal element matrix of V  is the precoding 
matrix of E-SDM for each user. Secondary, the precoding 
matrix 
NSD
 for BD is multiplied by Vs . The transmit 
signal from the base station antenna is then given by 
SD
x 
N Vs
1
2
[
s ]
N T
x
x
x


. During the 1st time slot, the 
transmit signal x  is broadcasted both to user terminals 
and the DF relay. The precoding matrix 
NSD
 makes the 
channel matrix 
HSD
 from base station to each user block 
diagonal. The receive signal vector
ySD
 at destination 
(users) is expressed as 
,
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD
SD











y
H
N Vs
n
B Vs
n
H
x
n
B
H
N
x
N Vs
   (2) 
BSD
 in (2) is the block diagonalized channel matrix and 
is expressed as 
1
2
u
sd
sd
SD
sdN






 







B
B
B
B
0
0
0
0
0
0







             (3) 
where 
,
1,
,
sdi
u
i
N

B

 is the block channel matrix for user 
i  and 
nSD
=
1
2
[
u ]
sd
sd
sdN
n
n
 n
 in (2) is the receive 
noise vector for each user. The size of block channel matrix 
Bsdi
 for user i  in (3) is given by 
i
i
m
n
  , 
1,
,
u
i
  N
, 
where 
i
n  is the nullity of matrix 
H sdi
(
)
d
i
s
N
m
N


[16] 
with 
H sdi
 being the matrix in which the channel matrix 
Hsdi
(
)
i
s
m
 N
 for user i  is subtracted from the entire 
channel matrix
HSD
(
)
d
s
N
 N
. The nullity 
i
n  of the 
matrix 
H sdi
 is defined by 
(
)
(
)
i
sdi
s
sdi
n
nullity
N
rank



H
H



        (4) 
As the rank of 
H sdi
 is given by 
(
)
min(
,
)
sdi
D
i
s
rank
N
m N


H
            (5) 
the nullity 
i
n  is expressed as 
(
)
0
i
s
sdi
s
d
i
n
N
rank
N
N
m






H

     (6) 
We assume that the DF relay knows the precoding 
matrix 
SD
N V  of the base station. Therefore, the base 
station has to inform 
SD
N V  to the relay before the data 
transmission starts. The transmission from base station to 
relay during the 1st time slot is done by Single User-MIMO 
(SU-MIMO). The receive signal 
ySR
1
2
[
R ]
r
r
rM
y
y
y


 
at relay is expressed as 
(
)
SR
SR
SR
SR
SD
SR




y
H
x
n
H N V s
n
           (7) 
where 
SR
n (
1
R
M  ) is the receive noise vector at relay. The 
effective channel matrix (
)
SR
SD
H N V  in (7) is assumed to 
be known at the relay and the demodulation of transmit 
signal s  is done by MMSE nulling or MLD (Maximum 
Likelihood Detection). This means that the base station 
does not need to inform the channel matrix 
HSR
 between 
base station and relay to the relay. The demodulated signal 
ˆs  at relay is transmitted to each user during the 2nd time 
slot using MU-MIMO with BD which is the same 
transmission scheme as in Source-Relay (SR) link. As in the 
Source-Destination (SD) link in the 1st time slot, the 
E-SDM is employed for the multiple stream transmission 
from relay to each user. At each user terminal, the received 
multiple stream signals during the 1st and the 2nd time slots 
are combined using symbol LLR addition and demodulated. 
When the errors are detected at relay through the CRC 
(Cyclic Redundancy Check) code for example, the 
transmission from relay to each user during the 2nd time 
slot may not be utilized. Because it causes the error 
propagation. That is, only when errors are not detected at 
relay, the demodulated signals at relay can be transmitted to 
the users. In this case, the 2nd time slot is not utilized 
between relay and each user, thus the vacant time slot can 
be used as the repeated transmission from base station to 
each user with BD+E-SDM as in the 1st time slot. 
III. DESIGN OF DOWNLINK TRANSMISSION 
A. Transmission during the 1st time slot 
1) Design of SD Link 
The SD transmission during the 1st time slot is done by 
using BD+E-SDM. The size of block channel matrix 
Bsdi
 
is given by 
Ni
i
m
n
   and the number of streams of eigen 
mode becomes min(
)
Ni
i
m
n
 
. When the number of streams 
is one, BD+E-SDM is referred to as BD+MRT (Maximum 
Ratio Transmission) [17]. From (6), the nullity 
i
n  of user 
i  can be arbitrary chosen by increasing or decreasing the 
number of transmit antennas 
s
N  at base station. If the 
elements of channel matrix 
HSD
 follow the i.i.d. complex 
Gaussian random variables, i.e., 
HSD
 is the MIMO 
channel matrix of quasi-static flat Rayleigh fading, the 
diversity order of the first eigen mode stream in E-SDM for 
1
2
u
N






 







s
s
s
s

1x
2x
1
Rx
R2
x
RNR
x
SD
N
xNs


RMR
y
R1
y
yR2
User 1
User 
u
N
User 2





Source
Relay (DF)
Destination
1
m
Nu
m
2
m
SD
H
HSR
RD
H
MU-MIMO transmission
V
52
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-473-2
AICT 2016 : The Twelfth Advanced International Conference on Telecommunications

the block channel matrix 
Bsdi
 is given by
i
m n i
   [18]. 
When the minimum number of receive antennas among 
users is 
mmin
, from (6) the nullity 
nmin
 of minimum 
antenna user is given by 
min
min
0
s
d
n
N
N
m





            (8) 
Hence, the number 
s
N  of transmit antennas at base station 
is expressed as 
min
min
s
d
N
n
N
m




             (9) 
When the number of transmit antenna is 
s
N , the nullity 
i
n  of user i  other than the minimum antenna user 
becomes 
min
i =
s
d
i
n
N
N
m
n





            (10) 
The size of block channel matrix 
Bsdi
 of user i  is 
determined as 
i
i
m
n
  . In this design method, firstly the 
nullity 
nmin
 of the user which has the minimum number 
of receive antennas 
mmin
 is determined and secondary the 
nullity 
i
n  of the other user i  is derived. The diversity 
orders of the first eigen mode stream of minimum antenna 
user and other user i  are given by 
min
min
m
n
 
 and 
min
min
i
m n i
m
n





 respectively. 
For example, we consider the case where the number of 
total users is 
3
u
N 
, the numbers of receive antennas of 
users are 
1
m  3
,
2
m  2
,
3
1
m  , and the total number of 
receive antennas is 
1
2
3
6
Nd
m
m
m




. In this case, 
3
m 1
 is minimum and it holds 
3
1
mmin
 m

. If the 
expected diversity order of the first eigen mode stream of 
user 3 is set to 3 for example, then we obtain 
3
3 1
3
min
min
n
m




. With those parameters, the total 
number of transmit antennas at base station 
s
N  is 
determined as 
s
N 
min
d
min
n
N
m



3
6 1
8


 
 and the 
size of block matrix 
3
D  of user 3 becomes 
min
min
m
n
 
1 3
  . Thus, the nullity of user 2 is determined as 
n 2


2
s
d
N
N
m


8
6
2
4




, the size of 
2
D  becomes 
2
2
m
n
  = 2
 4
, and the diversity order of the first eigen 
mode stream of user 2 is given as 
2
2
2 4
8
m
 n




. 
Likewise, the nullity 
1
n  of user 1 is given by 
n 1


1
s
d
N
N
m



8
6
3
5




, 
1
D  becomes 
1
1
m
n
 
3
5


, 
the diversity order of the first eigen mode stream of user 1 
is determined as 
1
1
3 5
15
m
 n




. 
2) Design of SR Link 
For the SD link from base station to DF relay, the 
precoding at base station is not used. This means no degree 
of freedom of transmit antennas (number of transmit 
antennas) at base station is consumed for the SR link. This 
is because if the transmit antennas at base station are 
assigned to the DF relay also for BD, in the absence of relay 
the assigned transmit antennas to relay are of no use. 
Therefore the extra transmit antennas are then used for the 
users to enhance the SD link quality. In this case, the effect 
of using relay becomes not obvious compared with the 
enhanced SD link. That is, the DF relay should be 
employed when the SD link quality is poor and the 
additional relay brings great effect to the overall 
performance. As the demodulation at DF relay is done by 
only using receive CSI, the precoding matrix 
SD
N V  at 
base station needs to be informed to the relay in advance 
before the data transmission starts. The DF relay 
demodulates the receive signal with MMSE nulling or 
MLD by using equivalent channel matrix of 
SR
SD
H
N V . So, 
the SR link transmission is done by SU-MIMO and not by 
MU-MIMO. As the SR link quality directly affects the 
subsequent Relay-Destination (RD) link quality, we must 
raise the SR link quality as much as we can. Because the 
poor SR link quality causes error propagation to the RD 
link. To solve this problem, increasing the number of 
receive antennas at relay is considered. Also at relay, MLD 
with better BER characteristic than MMSE nulling is 
considered. But when the number of transmit streams of s  
from base station is large, the exponential increase of 
complexity in MLD becomes a problem. In such case, we 
can resort the problem to employ the Sphere Decoding (SD) 
with less complexity or to use the MMSE nulling with far 
less complexity for demodulating SU-MIMO signals. Even 
though the elements of 
HSR
 are i.i.d. complex Gaussian 
random variables, the row elements of equivalent SR link 
channel matrix 
SR
SD
H
N V  do not always become i.i.d. 
complex Gaussian random variables. This channel element 
correlation deteriorates the BER characteristic of MMSE 
nulling, MLD or SD compared with i.i.d. random variable 
case. Also if errors are detected at the DF relay by using 
CRC code etc., we can consider the protocol in which the 
demodulated data at relay are not forwarded to users in the 
2nd time slot. In this case, as the RD link in the 2nd time 
slot becomes vacant, in order to utilize the vacant time slot 
effectively, we can repeat the SD link transmission from the 
base station again in the 2nd time slot. 
 
B. Transmission during the 2nd time slot 
For the RD link transmission during the 2nd time slot, 
we use BD+MRT or BD+E-SDM the same as in the 1st 
time slot. In this case, the number of streams to each user of 
SD link should coincide with the one of RD link. This is 
because the symbol LLR combining for each user stream is 
done at each user. We can design the RD link quality like 
the SD link. Thus, we can improve the RD link quality by 
increasing the number of transmit antennas at relay 
R
N . In 
order to prevent the error propagation in the RD link, we 
adopt the protocol in which the data from relay are only 
forwarded to each user in case of no error detected at the 
DF relay. When the error is detected at the relay and the RD 
link is not used during the 2nd time slot, in order to prevent 
the degradation of receive signal quality, we repeat the SD 
transmission using the vacant 2nd time slot. The signals 
received in the 1st and the 2nd time slots are symbol LLR 
combined and demodulated at each user. 
At each user terminal, each stream of MRT or E-SDM is 
equivalently represented as the AWGN channel with the 
53
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-473-2
AICT 2016 : The Twelfth Advanced International Conference on Telecommunications

complex gain h . When the received signal in each stream 
is denoted as r  and the corresponding transmitted signal 
,
0,
,
1
ls l
Q



has Q  modulation levels, the equivalent 
AWGN channel of each stream is expressed as 
,
0,1,
,
1
l
r
hs
n l
Q





               (11) 
The symbol LLR is the extension of bit LLR and defined as 




0
|
log
|
l
l
e
p r s
LLR
p r s

                   (12) 
where the transition probability density function 


|
l
p r s  
is expressed as 


2
2
1
(
)
|
exp
2
2
l
l
r
s
p r s










          (13) 
and 
2
2
(1/ 2) {|
| }
E
n
 
. From (12) and (13), it holds 
2
2
0
0
2
2 (
)
(
)
2
l
l
l
r s
s
s
s
LLR





            (14) 
When the modulation level is 
Q  2
, the symbol LLR 
coincides with the bit LLR. The symbol LLR combining (or 
addition) of two independent LLR’s is equivalent to the 
MRC (Maximum Ratio Combining) and they give the same 
BER characteristics. 
IV. INVESTIGATION OF BER CHARACTERISTICS 
THROUGH COMPUTER SIMULATIONS 
We have checked the BER characteristics of the proposed 
MU-MIMO downlink transmission using DF relay. The 
abscissa of BER characteristic is taken as the transmit SNR 
[19], which is defined as the ratio of total transmit power 
P  from the base station to the receive noise power 
2
  at 
each user receive antenna and is given as 
2
S
P
N







transmit
               (15) 
The channel from base station to each user, the channel 
from base station to relay and the channel from relay to 
each user are all assumed to be quasi-static Rayleigh fading 
channel. That is, the element 
ij
h  of channel matrix H
(
,
,
)
SD
SR
RD
H
H
H
 is an i.i.d. complex Gaussian random 
variable with the variance of 
2
{|
| }
1
ij
E
h
 . We consider the 
distance from base station to each user is equal among users 
and the DF relay locates at the middle point between the 
base station and users. We also set the power decaying 
exponent as 
  3.5
 on the different distances from the 
base station to relay and users. 
First, we investigate the case where the number of 
transmit antennas of base station is 
2
s
N 
, the number of 
user terminal 
2
u
N 
, the number of receive antennas of 
each user 
1
2
1
m
 m
 , the number of receive antennas of 
relay 
4
MR

, and the number of transmit antennas of relay 
2
R
N 
. We call this as 2 (4,2) (1,1)


 model. In this model, 
for the SD link during the 1st time slot, BD+MRT scheme 
is used as the MU-MIMO transmission. QPSK modulation 
is used for each user stream. The BER characteristic is 
shown in Figure2. In Figure2, “SD link 2 times w/o relay” 
means the scheme in which the MU-MIMO transmission on 
SD link is repeated twice without using the relay. 
“ 2 (4,2) (1,1)


 MMSE” and “ 2 (4,2) (1,1)


 MLD” mean 
the schemes in which the receive signal at DF relay is 
demodulated using MMSE nulling and the one in which the 
receive signal at DF relay is demodulated using MLD, 
respectively. 
We see from Figure2 that, by using the DF relay and 
combining the symbol LLR’s of SD link and SRD link 
signals, the BER characteristic with using relay is very 
much improved compared with 2 times transmission on SD 
link without using relay. The SD link transmission without 
relay shows the diversity order of 1 
1
(BER
10
 /10 dB)

. As 
stated in III.B, as the row elements of channel matrix 
SR
SD
H
N V  on the SR link do not always become 
independent, the SR link quality is degraded. Accordingly, 
the diversity order of 2 at each user is not achieved 
especially when the MMSE nulling is used at relay. 
However, by using the MLD at relay, the SR link quality is 
improved and we can get the diversity order of almost 2. 
Next, we consider the case where the number of 
transmit antenna at base station is 
4
T
N 
, the number of 
users 
2
u
N 
 and the numbers of receive antennas of each 
user are 
1
2
1
m
 m
 . Compared with the previous case of 
2
T
N 
, more transmit antennas are assigned to each user. 
The numbers of receive antenna and transmit antenna at 
relay are 
4
R
M 
 and 
4
R
N 
 respectively. We call this as 
4 (4,4) (1,1)


 model. The transmission protocols of SD, 
SR and RD links are the same as the previous 
2 (4,2) (1,1)


 model. The modulation format is QPSK. We 
show the simulation results in Figure3. In Figure3, the 
channel matrix 
HSD
 on SD link is 2
4
  and the channel 
matrix 
H sdi
 in which the channel matrix for user i  is 
excluded from 
HSD
 becomes 1 4
 . 
From (10), the nullity of 

Hsdi
 is calculated as 
4
2
1
3, (
1,2)
n i
i


 


. The size of block matrix 
i
D  of 
each user becomes 
1 3, (
1,2)
i
i
m
n
i

 


 and the diversity 
 
Figure 2. BER characteristics of 2
(4,2)
(1,1)


 model (Transmission 
rate to each user is 2(bps/Hz).) 
1.00E-05
1.00E-04
1.00E-03
1.00E-02
1.00E-01
1.00E+00
0
5
10
15
20
25
30
BER
Transmit SNR (dB)
SD link 2 times w/o relay
2*(4,2)*(1,1) MMSE
2*(4,2)*(1,1) MLD
54
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-473-2
AICT 2016 : The Twelfth Advanced International Conference on Telecommunications

order of each user stream is given by 
3, (
1,2)
i
i
m
n
i




. 
From Figure3, “SD link 2 times w/o relay” shows the BER 
slope 
of 
about 
10 3
 /10 (dB)
 for 
the 
transmit 
SNR=5~15(dB) and we see that the diversity order of 3 is 
almost obtained. When using relay, we can also expect the 
diversity order of 3 on the RD link as in the SD link. Thus, 
if there is no error on the SR link, then we can say the 
diversity order of 6 is obtained on the BER after the symbol 
LLR addition at each user. As the transmit SNR becomes 
higher, the errors on SR link decrease and the diversity 
order of 6 is more easily achievable at high SNR region. 
But in Figure3, we see the BER falls by 
10 1
 / 2 (dB)
 for 
SNR=7~9(dB) and we know the diversity order of 5 is 
achieved in this SNR region. 
Next, we consider the case where the number of transmit 
antenna at base station is 
4
T
N 
, the number of users 
2
u
N 
 and the numbers of receive antennas of each user 
are 
1
2
2
m
 m

. The numbers of receive and transmit 
antennas at relay are 
4
R
N 
respectively. We call this as
4 (4,4) (2,2)


 model. 
In 
this 
case, 
the 
optimum 
modulation 
formats 
which 
minimize 
the 
BER 
characteristics are selected under the constant transmission 
rate of 4(bps/Hz) on the SD link. This means one stream 
transmission with BD+MRT+16QAM or two stream 
transmission 
with 
BD+E-SDM+QPSK 
is 
adaptively 
selected for given 
HSD
 [8]. Also in case of two stream 
transmission using two QPSK’s, the optimum power 
assignment to the 1st and 2nd eigen mode channels which 
minimizes the BER is made [8]. In this two stream 
transmission, the DF relay needs to know in advance the 
precoding matrix 
NSD
 for BD, the matrix V  for the 
eigen mode transmission in E-SDM and the power 
allocation factor to the 1st and 2nd eigen mode channels. 
Also in order to make the symbol LLR addition at each user, 
the number of streams on the RD link must coincide with 
the one on the SR link. Hence, the BD+E-SDM 
transmission on RD link adopts the same number of streams 
as in the SD link. The simulation results are shown in 
Figure4. In Figure4, BD+E-SDM scheme is employed on 
the SD link and the size of block channel matrix for each 
user becomes 
2 2 (
1,2)
i
i
 

D
. The transmission to each 
user is done by one stream transmission with the maximum 
eigen value using 16QAM or two stream transmission with 
two different eigen values using two QPSK’s. Figure4 
shows 
the 
average 
BER 
characteristics. 
In 
this 
4 (4,4) (2,2)


 model, like in Figure2 and Figure3, the use 
of DF relay and the symbol LLR addition at each user 
during the 1st and 2nd time slots improve the diversity 
order and the BER characteristic when compared with the 2 
times transmission on the SD link without using relay. 
Next, we consider the case where the number of transmit 
antenna at base station is 
8
T
N 
, the number of users 
4
u
N 
 and numbers of receive antennas of each user are 
1
2
3
4
2
m
m
m
m




. The numbers of receive and transmit 
antennas at relay is 
8
R
M   and 
8
R
N   respectively. We 
call this as 8
(8,8)
(2,2,2,2)


 model. This model is the 
extension of previous 4 (4,4) (2,2)


 model to 
4
u
N 
 
users. The transmission protocols are the same as the 
previous 4 (4,4) (2,2)


 model. On the SD link, the size of 
 
Figure 3. BER characteristics of 4
(4,4)
(1,1)


 model (Transmission 
rate to each user is 2(bps/Hz).) 
 
 
Figure 4. BER characteristics of 4
(4,4)
(2,2)


 model      
(Transmission rate to each user is 4(bps/Hz) and 16QAM or QPSK is 
optimally selected to minimize the BER.) 
 
 
Figure 5. BER characteristics of 8
(8,8)
(2,2,2,2)


 model  
(Transmission rate to each user is 4(bps/Hz) and 16QAM or QPSK is 
optimally selected to minimize the BER.) 
1.00E-05
1.00E-04
1.00E-03
1.00E-02
1.00E-01
1.00E+00
0
5
10
15
20
25
30
BER
Transmit SNR (dB)
SD link 2 times w/o relay
4*(4,4)*(1,1) MMSE
4*(4,4)*(1,1) MLD
1.00E-05
1.00E-04
1.00E-03
1.00E-02
1.00E-01
1.00E+00
0
5
10
15
20
25
30
BER
Transmit SNR (dB)
SD link 2 times w/o relay
4*(4,4)*(2,2) MMSE
4*(4,4)*(2,2) MLD
1.00E-05
1.00E-04
1.00E-03
1.00E-02
1.00E-01
1.00E+00
0
5
10
15
20
25
30
BER
Transmit SNR (dB)
SD link 2 times w/o relay
8*(8,8)*(2,2,2,2) MMSE
8*(8,8)*(2,2,2,2) SD
55
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-473-2
AICT 2016 : The Twelfth Advanced International Conference on Telecommunications

block 
channel 
matrix 
for 
each 
user 
becomes 
2 2 (
1,2,3,4)
i
i



D
. 
For 
each 
user, 
one 
stream 
transmission with BD+MRT using 16QAM or two stream 
transmission with BD+E-SDM using two QPSK’s is 
adaptively 
selected 
for 
HSD
 under 
the 
constant 
transmission rate of 4(bps/Hz). The RD link transmission 
uses the same number of streams as in the SD link. We 
show 
the 
simulation 
results 
in 
Figure5. 
In 
this 
8
(8,8)
(2,2,2,2)


 model, the demodulation using MLD at 
relay becomes difficult because the number of searches in 
MLD becomes 
84
 65536
 for the total 8 streams from 
the base station. So instead of the MLD, we used the Sphere 
Decoding SE algorithm [20][21] that can obtain the same 
ML solution as the MLD with far less computational 
complexity. Like in Figure2, Figure3 and Figure4, the use 
of DF relay and the symbol LLR addition at each user 
during the 1st and 2nd time slots improve the diversity 
order and the BER characteristic compared with the 2 times 
transmission on SD link without using relay. We also see in 
Figure3~Figure5 that the BER difference between MMSE 
nulling and MLD (or Sphere Decoding) at relay is not so 
large. This is mainly because the BER of relay by MMSE 
nulling or MLD (or Sphere Decoding) is far better than the 
one of SD link, and the combined BER at destination is not 
so affected by the BER difference between MMSE nulling 
and MLD (or Sphere Decoding). 
V. CONCLUSION AND FUTURE WORK 
In this paper, we discussed the improvement of 
transmission quality when the DF relay is applied to the 
MU-MIMO down link system with the linear block 
diagonalization plus MRT or E-SDM scheme. By knowing 
the precoding matrix of base station at the DF relay, the DF 
relay can demodulate the transmit signals from base station 
only with the receive CSI. As the existence of relay does 
not affect the design of precoding matrix at the base station, 
we can add the DF relay only when the cannel quality 
between the base station and user terminals is insufficient. 
By adding the DF relay and utilizing the 2nd time slot, we 
can improve the receive quality of each user terminal. We 
made the design of SD, SR and RD links during the 1st and 
the 2nd time slots and verified the effectiveness of using DF 
relay. Although the SR link quality affects the total BER 
performance very much, we can utilize the simple MMSE 
nulling by increasing the number of receive antenna at DF 
relay to improve the SR link quality. 
As future studies, although we handled the case where 
the numbers of transmission streams on SR and RD link are 
equal, the case of different numbers will be considered. 
ACKNOWLEDGEMENT 
This study is supported by the Japanese Grant-in-Aid 
for 
Scientific 
Research 
of 
15K06059 
and 
Sharp 
cooperation. 
REFERENCES 
[1] H. S Quentin, B. P. Christian, and A. Lee Swindlehurst, M. 
Hardt, “An introduction to the multi-user MIMO downlink,” 
IEEE communications Magazine, vol.42, Issue 10, pp.60-67, 
Oct. 2004. 
[2] Q. H. Spencer, A. L. Swindlehurst, and M. Haardt, “Zero 
forcing methods for downlink spatial multiplexing in 
multiuser MIMO channels,” IEEE Trans. Sig. Processing, 
vol.52, no.2, pp.461-471, Feb.2004. 
[3] T.Haustein, C. von Helmolt, E.Jorswieck, V.Jungnickel, and 
V.Pohl, “Performance of MIMO systems with channel 
inversion,” IEEE 55th VTC Spring, vol.1, pp. 35 – 39, 2002. 
[4] S. Vishwanath, N. Jindal, and A. Goldsmith, “Duality, 
achievable rates, and sum-rate capacity of MIMO broadcast 
channels,” IEEE Trans. Inform. Theory, vol. 49, no. 10, pp. 
2658–2668, Oct. 2003. 
[5] Veljko 
Stankovic 
and 
Martin 
Haardt, 
“Successive 
optimization Tomlinson-Harashima precoding (SO THP) for 
multi-user MIMO systems,” IEEE International Conference 
on Acoustics, Speech, and Signal Processing, Proceedings 
(ICASSP '05), vol.3, pp.iii/1117-iii/1120, March 2005. 
[6] C. B. Peel, B. M. Hochwald, and A. L. Swindlehurst, “A 
vector-perturbation technique for near-capacity multi antenna 
multiuser communication-part I: Channel inversion and 
regularization,” IEEE Trans. Commun., vol. 53, pp.195-202, 
Jan. 2005. 
[7] C. B. Peel, B. M. Hochwald, and A. L. Swindlehurst, “A 
Vector-Perturbation Technique for Near-Capacity Multi 
antenna Multiuser Communication—Part II: Perturbation,” 
IEEE Trans. Commun., vol. 53, pp. 195–202, Jan. 2005. 
[8] K. Miyashita, T. Nishimura, T. Ohgane, Y. Ogawa, Y. 
Takatori, 
and 
K. 
Cho, 
“Eigenbeam-Space 
Division 
Multiplexing (E-SDM) in a MIMO Channel,” IEICE 
Technical Report，RCS2002−53，pp.13−18，May, 2002． 
[9] H. Sun, S. Meng, Y. Wan, and X. You, “Sum-rate evaluation 
of multi-user MIMO-relay channel,” IEICE Trans. Commun., 
vol.E-92-B, No.2, pp.683-686, Feb. 2009. 
[10] K. Nishimori, N. Honma, M. Mizoguchi, “Effectiveness of 
relay MIMO transmission in an actual outdoor environment,” 
IEICE Technical Report，RCS2008-228, pp.95-100, March 
2009. 
[11] K. Fujii and T. Fujii, “Adjacent Cell Interference Reduction 
Using Multiuser MIMO Relay Station,” IEICE Technical 
Report, RCS2010-164, pp.31-36, Dec. 2010. 
[12] W. 
Liu, 
C. 
Li, 
J.-D. 
Li, 
L. 
Hanzo, 
“Block 
diagonalization-based multiple input multiple output-aided 
downlink 
relaying,” 
IET 
Commun, 
Vol.6, 
Iss.15, 
pp.2371-2377, 2012. 
[13] L. Liang, W. Xu, X. Dong, “Limited feedback-based 
multi-antenna 
relay 
broadcast 
channels 
with 
block 
diagonalization,” IEEE Trans. Wireless Commun., Vol.12, 
No.8, pp.4092-4101, Aug. 2013. 
[14] Y. Tanahashi, Y. Iwanami, R. Yamada, N. Okamoto, “Study 
on VP Transmission Schemes for Multiuser MIMO 
Downlink using Non-Regenerative Relay,” IEICE Technical 
Report, RCS2013-371, pp.395-400, March 2014. 
[15] T. Taniguchi and Y. Karasawa, “An Elementary Study on 
Node Pair Selection in Relay-Aided Communication System 
Based on Stable Marriage Problem,” IEICE Technical Report, 
RCS2014-50, pp.105-108, June 2014. 
[16] G. Zhang and Y. Iwanami, “A design of communication 
quality in linearly precoded MU-MIMO downlink system,” 
IEICE Technical Report, RCS2015, March 2016. 
[17] T. K. Y. Lo,“Maximum Ratio Transmission,” IEEE Trans. 
Commun.,vol.47, no.10, pp.1458-1461, Oct. 1999. 
[18] Paulraj, R. Nabar and D. Gore, Introduction to Space Time 
wireless Communication, Cambridge University Press, 2008. 
[19] J. K. Cavers, “Single-User and Multiuser Adaptive Maximum 
Ratio Transmission for Rayleigh Channel,” IEEE Trans. On 
Vehicular Technology, Vol.49, No.6, pp.2043-2050, Nov. 
2000. 
[20] Z. 
Guo 
and 
P. 
Nilsson, 
“Reduced 
Complexity 
Schnorr-Euchner Decoding Algorithms for MIMO systems,” 
IEEE communication letters, vol.8, no.5, pp286-288, May 
2004. 
[21] B. Shim and I. Kang, “Sphere Decoding with a probabilistic 
tree pruning,” IEEE transactions on signal processing, vol.56, 
no.10, pp4867-4878, Oct. 2008. 
56
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-473-2
AICT 2016 : The Twelfth Advanced International Conference on Telecommunications

