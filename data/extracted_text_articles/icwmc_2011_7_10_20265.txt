Amplifying Matrix Design for Cooperative Relay
Networks under Channel Uncertainty and Power
Constraint
Kanghee Lee, Hyuck M. Kwon, Yanwu Ding, Zuojun Wang, Yu Bi, and Yazan Ibdah
Department of Electrical Engineering and Computer Science, Wichita State University, Wichita, Kansas 67260
Emails: {kxlee1, hyuck.kwon, yanwu.ding, zxwang3, yxbi, yxibdah}@wichita.edu
Abstract—This paper presents an optimum amplifying relay
matrix based on minimum mean square error (MMSE) criteria
for the cooperative distributed wireless relay networks under
channel uncertainty and total power constraint at the relay nodes.
A one-source-one-destination pair node and 𝑁 relay nodes are
considered, which can be extended for a general case. All relays
are assumed to exchange their received signals with no errors
for full cooperation. With the derived optimum amplifying relay
matrix, bit error rate (BER) of the relay network under channel
uncertainty is simulated and compared with that of the network
under a certain channel condition to observe the degradation.
Index Terms—AF, MMSE, channel-uncertainty, power-const-
raint.
I. INTRODUCTION
Due to the restricted power, relay nodes in wireless networks
can only retransmit their received signal from a source node
within a limited distance [1]. To overcome this limitation, vari-
ous protocols were proposed. Relay protocols can be classiﬁed
as amplify-and-forward (AF), decode-and-forward (DF), and
compress-and-forward (CF) [2]–[8]. The AF relay protocol
only retransmits a scaled version of their received signals
from the source node according to their power constraint.
Therefore, AF relay protocol employed in this current paper
is a reasonable strategy when relay nodes have limited power.
Compared to the DF and CF relay protocols, AF relay protocol
results in a lower complexity. This is due to the fact it does
not require signal processing at the relay for decoding and
compressing. In addition, AF relay protocol shows a shorter
delay at the relay node. This is also due to the same fact unlike
the DF and CF protocols.
In practice, due to wireless communication characteristics
during information transmission, all relay nodes can have an
inaccurate knowledge of their local channels, either from the
source node to relay nodes or from relay nodes to the destin-
This work was partly sponsored by the Army Research Ofﬁce under
DEPSCoR ARO Grant W911NF-08-1-0256, and by NASA under EPSCoR
CAN Grant NNX08AV84A.
Fig. 1.
Wireless relay network with one-source-one-destination pair and 𝑁
relay nodes under no channel uncertainty (h𝑠, h𝑦).
ation node. In [5], the DF relay protocol with single-input
single-output was considered for a multibranch cooperative
distributed wireless relay network with direct link between
the source and the destination under no channel uncertainty.
While, in [6], a multibranch noncooperative AF relay network
without direct link between the source and the destination was
considered for single-input single-output with 𝑁 relays under
channel uncertainty. AF relay protocol in [6] did not employ
cooperation among distributed relay nodes even though au-
thors considered channel uncertainty. Furthermore, total power
constraint at relay nodes was not included in [6]. In [7], [8],
relay nodes exchanged their received signals for cooperation,
and channels were assumed to be perfectly known at each
relay node. While, in [9], [10], total power constraint at
the destination node instead of relay nodes was considered
for noncooperative AF wireless relay networks under certain
channel condition to minimize mean square error. In addition,
channel uncertainty for noncooperative AF wireless relay
networks under the received power constraint at the destination
node was studied in [11]. Namely, recently, cooperative AF
wireless relay networks under channel uncertainty with power
constraint at relay nodes was not considered. Therefore, the
objective of this current paper is to ﬁnd an optimum relay
amplifying matrix for the cooperative distributed wireless
139
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

relay networks under channel uncertainty and total power
constraint at relay nodes. The minimum mean square error
(MMSE) criterion is used to optimize the relay amplifying
matrix. Since cooperation is employed, the optimum relay
amplifying matrix can be non-diagonal. On the other hand, it
will be a diagonal matrix if a non-cooperative relay network
is required as in [6]. The diagonal relay amplifying matrix
under total power constraint at the destination node is designed
for the case where the direct link between a source and a
destination is considered weak and can be negligible. Using
the derived optimum relay amplifying matrix, effects of three
different kinds of channel uncertainty both cooperative case
and noncooperative case on BER was studied.
The remaining paper is organized into four sections. Sec-
tion II describes the system model and information transmis-
sion scheme. Section III presents a cooperative distributed
MMSE relay scheme based on the AF strategy. Three different
imperfect channel information cases for both cooperative and
noncooperative distributed wireless networks are considered.
Section IV presents simulation results. Finally, Section V
concludes the paper.
Notation: Matrices and vectors are denoted, respectively,
by uppercase and lowercase boldface characters (e.g., A and
a). The transpose, complex conjugate, inverse, and trace of A
are denoted, respectively, by A𝑇 , A∗, A−1, and 𝑡𝑟(A). The
Hermitian of A is denoted by A𝐻, i.e., the complex conjugate
and transpose of A. An 𝑛 × 𝑛 identity matrix is denoted by
I𝑁 . A ∈ C𝑚×𝑛 is an 𝑚 × 𝑛 complex matrix. The expectation
operator is 𝐸[ ⋅ ]. Notations ∣𝑎∣, ∣∣a∣∣, and ∣∣A∣∣𝐹 denote the
absolute value of 𝑎 for any scalar, 2-norm of a, and Frobenius-
norm of A, respectively. An 𝑛 × 𝑛 diagonal matrix is denoted
by diag
(
𝑎1, ⋅ ⋅ ⋅ , 𝑎𝑁
)
. An arg minA 𝐽(A) denotes the value
of A at which 𝐽(A) is minimized.
II. SYSTEM MODEL
Figure 1 shows a wireless relay network with 𝑁 cooper-
ative distributed relay nodes between a source node and a
destination node. As shown in Fig. 1, there are two stages
for information transmission where a source node transmits
a signal symbol 𝑠 in Stage I and the relay nodes retransmit
their received signals to a destination node in Stage II using
the amplifying matrix. Certain channel and uncertain channel
conditions are described in the remaining of this section.
A. Certain Channel Condition
In a certain channel condition, all the relay nodes have
perfect information of their local channel coefﬁcients from
the source node to the relay nodes and from the relay nodes
to the destination node. Let h𝑠 ∈ C𝑁×1 denote the perfect
channel coefﬁcient complex column vector from the source
node to the relay nodes as
h𝑠 = [ℎ𝑠,1, ℎ𝑠,2, ⋅ ⋅ ⋅ , ℎ𝑠,𝑁]𝑇
where ℎ𝑠,𝑖, 𝑖 = 1, ⋅ ⋅ ⋅ , 𝑁, is the 𝑖-th element of h𝑠, repre-
senting the channel coefﬁcient from the source node to the
𝑖-th relay node. The received signal complex column vector
r ∈ C𝑁×1 at the relay nodes is written as
r = h𝑠𝑠 + v𝑠
(1)
where v𝑠 ∈ C𝑁×1 is a zero mean complex additive white
Gaussian noise column vector with covariance matrix 𝜎2
𝑣𝑠I𝑁 .
Each channel ℎ𝑠,𝑖 is assumed to be independent identically
distributed with a zero mean circular complex Gaussian of
unit variance and quasi-static Rayleigh fading so that they stay
ﬁxed during an observation interval. For the cooperation of
relay nodes, it is assumed that all the relay nodes exchange
their received signals each other with negligible errors. The
ampliﬁed signal complex column vector x ∈ C𝑁×1 at the
relay nodes is given by
x = Fr
(2)
where F ∈ C𝑁×𝑁 is an optimum relay amplifying matrix at
the relay nodes. Let h𝑦 ∈ C1×𝑁 denote the perfect channel
coefﬁcient complex row vector from the relay nodes to the
destination node as
h𝑦 = [ℎ𝑦,1, ℎ𝑦,2, ⋅ ⋅ ⋅ , ℎ𝑦,𝑁]
where ℎ𝑦,𝑖, 𝑖 = 1, ⋅ ⋅ ⋅ , 𝑁, is the 𝑖-th element of h𝑦, rep-
resenting the channel coefﬁcient from the 𝑖-th relay node
to the destination node. Each channel ℎ𝑦,𝑖 is also assumed
to be independent identically distributed with a zero mean
circular complex Gaussian of unit variance and quasi-static
Rayleigh fading. The received complex signal 𝑦 ∈ C1×1 at
the destination node can be represented as
𝑦 = h𝑦x + 𝑣𝑦
(3)
where 𝑣𝑦 ∈ C1×1 is a zero-mean complex additive white
Gaussian noise variable with variance 𝜎2
𝑣𝑦. Substituting (1)
and (2) into (3), the received complex signal 𝑦 ∈ C1×1 at the
destination node can be written as
𝑦 = h𝑦Fh𝑠𝑠 + h𝑦Fv𝑠 + 𝑣𝑦.
(4)
B. Uncertain Channel Condition
In reality, due to channel estimation errors, the estimates
of the imperfect channel coefﬁcient complex vectors ¯h𝑠 and
¯h𝑦 should be used instead of perfect h𝑠 and h𝑦, respectively,
under uncertain channel conditions.
140
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

Fig. 2.
Wireless relay network with one-source-one-destination pair and 𝑁
relay nodes under channel uncertainty for both source-relay links and relay-
destination links (¯h𝑠, ¯h𝑦).
As shown Fig. 2, the estimated channel coefﬁcient vectors
can be written, respectively, as
¯h𝑠 = h𝑠 − 𝝓𝑠 or
¯h𝑠 = h𝑠 + 𝝓𝑠
(5)
and
¯h𝑦 = h𝑦 − 𝝓𝑦 or
¯h𝑦 = h𝑦 + 𝝓𝑦
(6)
where 𝝓𝑠 ∈ C𝑁×1 and 𝝓𝑦 ∈ C1×𝑁 are, respectively, the
channel estimation error column and row vectors consisting
of complex independent identically distributed zero mean
Gaussian random variables with covariance matrix 𝜎2
𝜙𝑠I𝑁 and
𝜎2
𝜙𝑦I𝑁 . The estimated channel coefﬁcient vectors are applied
for both source-relay links and relay-destination links. There-
fore, the received signal complex column vector r1 ∈ C𝑁×1
at the relay nodes is represented as
r1 = ¯h𝑠𝑠 + 𝝓𝑠𝑠 + v𝑠
(7)
where v𝑠 ∈ C𝑁×1 is a zero-mean complex additive white
Gaussian noise vector with covariance matrix 𝜎2
𝑣𝑠I𝑁 . The
subscript 1 denotes case 1 where ¯h𝑠 and ¯h𝑦 are used. The
processed signal complex column vector x1 ∈ C𝑁×1 at the
relay node outputs is written as
x1 = F1r1
(8)
where F1 ∈ C𝑁×𝑁 is a relay amplifying matrix employed
by the relay nodes to improve performance at the destination
node. The received complex signal 𝑦1 ∈ C1×1 at the destina-
tion node can be written as
𝑦1 = h𝑦x1 + 𝑣𝑦 = ¯h𝑦x1 + 𝝓𝑦x1 + 𝑣𝑦
(9)
where 𝑣𝑦 ∈ C1×1 is a zero mean complex additive white
Gaussian noise with variance 𝜎2
𝑣𝑦. Substituting (7) into (8)
and using (9), the received complex signal 𝑦1 ∈ C1×1 at the
destination node can be written as
𝑦1 = ¯h𝑦F1 ¯h𝑠𝑠 + 𝝓𝑦F1 ¯h𝑠𝑠 + ¯h𝑦F1𝝓𝑠𝑠 + 𝝓𝑦F1𝝓𝑠
+ ¯h𝑦F1v𝑠 + 𝝓𝑦F1v𝑠 + 𝑣𝑦.
(10)
In the next section, the optimum relay amplifying matrix F
will be determined using the MMSE criteria for the channel
uncertainty conditions. Note that in [6], Khajehnouri et. al.
considered a noncooperative distributed wireless relay net-
work. Hence, the relay amplifying matrix was a diagonal
matrix in [6]. However, the relay amplifying matrix in this
current paper would be non-diagonal because cooperation is
made among the relay nodes by exchanging their received
signals.
III. COOPERATIVE DISTRIBUTED MMSE RELAY SCHEME
UNDER CHANNEL UNCERTAINTY
The MMSE will try to minimize the mean square error
between the signal component at the destination node and the
transmitted signal 𝑠 at the source node. Total power constraint
at the relay nodes will be included in the minimization.
Assume both channel estimation vectors for both source-relay
and relay-source links are not perfect, i.e., (¯h𝑠, ¯h𝑦). The
optimum relay amplifying matrix to minimize mean square
error between the signal component at the destination node
and the transmitted signal at the source node in (10) can be
found from
F†
1 = arg min
𝐹1 𝐽(F1)
(11)
s.t. 𝐸
[
∣∣x1∣∣2
2
]
= P1
under the relay power constraint where the objective function
𝐽(F1) is written using (10) as
𝐽(F1) = 𝐸
[h𝑦x1 − 𝑠
2]
= 𝐸
[¯h𝑦x1 + 𝝓𝑦x1 − 𝑠
2]
= 𝐸
[¯h𝑦F1 ¯h𝑠𝑠 + 𝝓𝑦F1 ¯h𝑠𝑠 + ¯h𝑦F1𝝓𝑠𝑠 + 𝝓𝑦F1𝝓𝑠𝑠
+ ¯h𝑦F1v𝑠 + 𝝓𝑦F1v𝑠 − 𝑠
2]
= 𝑡𝑟
(
𝜎2
𝑠 ¯h𝑦F1 ¯h𝑠 ¯h
𝐻
𝑠 F𝐻
1 ¯h
𝐻
𝑦 + 𝜎2
𝑠𝜎2
𝜙𝑠𝜎2
𝜙𝑦F1F𝐻
1
+ 𝜎2
𝑠𝜎2
𝜙𝑦F1 ¯h𝑠 ¯h
𝐻
𝑠 F𝐻
1 + 𝜎2
𝑠𝜎2
𝜙𝑠 ¯h𝑦F1F𝐻
1 ¯h
𝐻
𝑦
− 𝜎2
𝑠 ¯h
𝐻
𝑠 F𝐻
1 ¯h
𝐻
𝑦 + 𝜎2
𝑣𝑠 ¯h𝑦F1F𝐻
1 ¯h
𝐻
𝑦
+ 𝜎2
𝑣𝑠𝜎2
𝜙𝑦F1F𝐻
1 − 𝜎2
𝑠 ¯h𝑦F1 ¯h𝑠
)
+ 𝜎2
𝑠
(12)
where 𝐸[𝝓𝑦] = 𝐸[𝝓𝑠] = 0 is used in (12). The total power
constraint at the relay nodes can be represented from (8) as
P1 =𝐸
[
∣∣x1∣∣2
2
]
=𝜎2
𝑠∣∣F1 ¯h𝑠∣∣2
2+
(
𝜎2
𝑠𝜎2
𝜙𝑠 +𝜎2
𝑣𝑠
)
∣∣F1∣∣2
𝐹 .
(13)
Because the total power at the relay nodes is constrained P1,
the constrained optimization in [12] is to be performed as
𝐿(F1, 𝜆1) = 𝐽(F1) + 𝜆1
(
𝐸
[
∣∣x1∣∣2
2
]
− P1
)
= 𝑡𝑟
(
𝜎2
𝑠 ¯h𝑦F1 ¯h𝑠 ¯h
𝐻
𝑠 F𝐻
1 ¯h
𝐻
𝑦 + 𝜎2
𝑠𝜎2
𝜙𝑠𝜎2
𝜙𝑦F1F𝐻
1
+ 𝜎2
𝑠𝜎2
𝜙𝑦F1 ¯h𝑠 ¯h
𝐻
𝑠 F𝐻
1 + 𝜎2
𝑠𝜎2
𝜙𝑠 ¯h𝑦F1F𝐻
1 ¯h
𝐻
𝑦
141
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

− 𝜎2
𝑠 ¯h
𝐻
𝑠 F𝐻
1 ¯h
𝐻
𝑦 + 𝜎2
𝑣𝑠 ¯h𝑦F1F𝐻
1 ¯h
𝐻
𝑦
+ 𝜎2
𝑣𝑠𝜎2
𝜙𝑦F1F𝐻
1 − 𝜎2
𝑠 ¯h𝑦F1 ¯h𝑠
)
+ 𝜎2
𝑠
+ 𝜆1
(
𝜎2
𝑠∣∣F1 ¯h𝑠∣∣2
2+
(
𝜎2
𝑠𝜎2
𝜙𝑠 +𝜎2
𝑣𝑠
)
∣∣F1∣∣2
𝐹 −P1
)
(14)
where 𝜆1 is a Lagrangian multiplier. Take the derivative of
(14) in terms of complex conjugate of F1, i.e., F∗
1, and 𝜆1, re-
spectively, using the properties of the derivative matrices [13],
[14]. Then,
∂𝐿(F1, 𝜆1)
∂F∗
1
= ¯h
𝐻
𝑦 ¯h𝑦F1 ¯h𝑠 ¯h
𝐻
𝑠 𝜎2
𝑠 + F1 ¯h𝑠 ¯h
𝐻
𝑠 𝜎2
𝑠𝜎2
𝜙𝑦 + F1𝜎2
𝑠𝜎2
𝜙𝑦
+ ¯h
𝐻
𝑦 ¯h𝑦F1𝜎2
𝑣𝑠 − ¯h
𝐻
𝑦 ¯h
𝐻
𝑠 𝜎2
𝑠 + F1𝜎2
𝑠𝜎2
𝜙𝑠𝜎2
𝜙𝑦
+ ¯h
𝐻
𝑦 ¯h𝑦F1𝜎2
𝑠𝜎2
𝜙𝑠 + 𝜆1F1 ¯h𝑠 ¯h
𝐻
𝑠 𝜎2
𝑠
+ 𝜆1F1𝜎2
𝑠𝜎2
𝜙𝑠 + 𝜆1F1𝜎2
𝑣𝑠 = 0
(15)
and
∂𝐿(F1, 𝜆1)
∂𝜆1
= 𝜎2
𝑠∣∣F1 ¯h𝑠∣∣2
2+
(
𝜎2
𝑠𝜎2
𝜙𝑠 +𝜎2
𝑣𝑠
)
∣∣F1∣∣2
𝐹 −P1 = 0.
(16)
Therefore, the optimal amplifying relay matrix F†
1 can be
written as
F†
1 = 𝜎2
𝑠
(
h𝐻
𝑦 h𝑦 + 𝜎2
𝜙𝑦I𝑁 + 𝜆1I𝑁
)−1(
h𝐻
𝑦 ¯h
𝐻
𝑠
)
×
(¯h𝑠 ¯h
𝐻
𝑠 𝜎2
𝑠 + 𝜎2
𝑠𝜎2
𝜙𝑠I𝑁 + 𝜎2
𝑣𝑠I𝑁
)−1.
(17)
After applying the matrix inversion lemma [15] (A+BTD)−1=
A−1−A−1B
(
T−1+DA−1B
)−1DA−1, the optimal amplifying
relay matrix F†
1 can be written as
F†
1=
𝜎2
𝑠 ¯h
𝐻
𝑦 ¯h
𝐻
𝑠
(
𝜆1 + 𝜎2
𝜙𝑦 +
¯h𝑦
2
2
)(
𝜎2𝑠𝜎2
𝜙𝑠 + 𝜎2𝑣𝑠 + 𝜎2𝑠
¯h𝑠
2
2
).
(18)
Substituting (18) into (13), the total power P1 at the relay
nodes can be written as
P1 =
𝜎6
𝑠∥¯h
𝐻
𝑦 ¯h
𝐻
𝑠 ¯h𝑠∣2
2 + 𝜎4
𝑠
(
𝜎2
𝑠𝜎2
𝜙𝑠 + 𝜎2
𝑣𝑠
)¯h
𝐻
𝑦 ¯h
𝐻
𝑠
2
𝐹
[(
𝜆1 + 𝜎2
𝜙𝑦 + ∥¯h𝑦∥2
2
)(
𝜎2𝑠𝜎2
𝜙𝑠 + 𝜎2𝑣𝑠 + 𝜎2𝑠∥¯h𝑠∥2
2
)]2 .
(19)
Using (19), the Lagrangian multiplier 𝜆1 can be written as
𝜆1 =
±𝜎2
𝑠
√
P−1
1
(
𝜎2𝑠
¯h
𝐻
𝑦 ¯h
𝐻
𝑠 ¯h𝑠
2
2+
(
𝜎2𝑠𝜎2
𝜙𝑠+𝜎2𝑣𝑠
)¯h
𝐻
𝑦 ¯h
𝐻
𝑠
2
𝐹
)
𝜎2𝑠𝜎2
𝜙𝑠 + 𝜎2𝑣𝑠 + 𝜎2𝑠
¯h𝑠
2
2
−
(¯h𝑦
2
2 + 𝜎2
𝜙𝑦
)
.
(20)
The same BER performance is accomplished regardless of the
sign of 𝜆1. Hence, only the positive sign of 𝜆1 is considered,
i.e., ¯𝜆1, where ¯𝜔 = 𝑚𝑎𝑥(0, 𝜔). Substituting (20) into (18),
the optimum relay amplifying matrix F†
1 can be written as
F†
1 =
¯h
𝐻
𝑦 ¯h
𝐻
𝑠
√P1
√
𝜎2𝑠∣∣¯h
𝐻
𝑦 ¯h
𝐻
𝑠 ¯h𝑠∣∣2
2 +
(
𝜎2𝑠𝜎2
𝜙𝑠 + 𝜎2𝑣𝑠
)
∣∣¯h
𝐻
𝑦 ¯h
𝐻
𝑠 ∣∣2
𝐹
.
(21)
Note that F†
1 does not depend on 𝜎2
𝜙𝑦, but ¯h𝑦 does. The MMSE
can be computed from 𝐽(F1) in (14) by replacing F1 with F†
1.
From (14) and (17), the constrained optimal solutions ¯𝜆𝑖
and F†
𝑖, 𝑖 = 2, 3, of other two special cases under channel
uncertainty and power constraints at the relay nodes are
derived, respectively, as
¯𝜆2 =
𝜎2
𝑠
√
P−1
2
(
𝜎2𝑠
h𝐻
𝑦 ¯h
𝐻
𝑠 ¯h𝑠
2
2+
(
𝜎2𝑠𝜎2
𝜙𝑠+𝜎2𝑣𝑠
)h𝐻
𝑦 ¯h
𝐻
𝑠
2
𝐹
)
𝜎2𝑠𝜎2
𝜙𝑠 + 𝜎2𝑣𝑠 + 𝜎2𝑠
¯h𝑠
2
2
−
h𝑦
2
2
(22)
F†
2 =
h𝐻
𝑦 ¯h
𝐻
𝑠
√P2
√
𝜎2𝑠
h𝐻
𝑦 ¯h
𝐻
𝑠 ¯h𝑠
2
2 +
(
𝜎2𝑠𝜎2
𝜙𝑠 + 𝜎2𝑣𝑠
)h𝐻
𝑦 ¯h
𝐻
𝑠
2
𝐹
(23)
for only source-relay links when 𝜎2
𝜙𝑦 = 0, and
¯𝜆3 =
𝜎2
𝑠
√
P−1
3
(
𝜎2𝑠
¯h
𝐻
𝑦 h𝐻
𝑠 h𝑠
2
2+𝜎2𝑣𝑠
¯h
𝐻
𝑦 h𝐻
𝑠
2
𝐹
)
𝜎2𝑣𝑠 + 𝜎2𝑠
h𝑠
2
2
−
(¯h𝑦
2
2 + 𝜎2
𝜙𝑦
)
(24)
F†
3 =
¯h
𝐻
𝑦 h𝐻
𝑠
√P3
√
𝜎2𝑠∣∣¯h
𝐻
𝑦 h𝐻
𝑠 h𝑠∣∣2
2 + 𝜎2𝑣𝑠∣∣¯h
𝐻
𝑦 h𝐻
𝑠 ∣∣2
𝐹
(25)
for only relay-destination links when 𝜎2
𝜙𝑠 = 0.
For performance comparisons, the diagonal relay amplifying
matrices under total power constraint at relay nodes are derived
in the rest of this section. Hence, the diagonal relay amplifying
matrix F†
4 corresponding to both imperfect channel estimation
vectors ¯h
𝐻
𝑠 and ¯h
𝐻
𝑦 in noncooperative wireless networks can
be written as
F†
4 = diag
(
𝑓1, 𝑓2, ⋅ ⋅ ⋅ , 𝑓𝑁
)
, 𝑖 = 1, ⋅ ⋅ ⋅ , 𝑁
(26)
where
𝑓𝑖 =
¯ℎ∗
𝑦,𝑖¯ℎ∗
𝑠,𝑖
√P4
√∑𝑁
𝑖=1 ∣¯ℎ𝑦,𝑖∣2∣¯ℎ𝑠,𝑖∣2(
𝜎2𝑠∣¯ℎ𝑠,𝑖∣2 + 𝜎2𝑠𝜎2
𝜙𝑠 + 𝜎2𝑣𝑠
). (27)
Similarly, the diagonal relay amplifying matrices F†
5 and F†
6
corresponding to only imperfect channel estimation column
vector ¯h
𝐻
𝑠 and only imperfect channel estimation row vector
¯h
𝐻
𝑦 in noncooperative wireless networks can be written, re-
spectively, as
F†
5 = diag
(
𝑓1, 𝑓2, ⋅ ⋅ ⋅ , 𝑓𝑁
)
, 𝑖 = 1, ⋅ ⋅ ⋅ , 𝑁
(28)
where
𝑓𝑖 =
ℎ∗
𝑦,𝑖¯ℎ∗
𝑠,𝑖
√P5
√∑𝑁
𝑖=1 ∣ℎ𝑦,𝑖∣2∣¯ℎ𝑠,𝑖∣2(𝜎2𝑠∣¯ℎ𝑠,𝑖∣2 + 𝜎2𝑠𝜎2
𝜙𝑠 + 𝜎2𝑣𝑠)
(29)
142
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

and
F†
6 = diag
(
𝑓1, 𝑓2, ⋅ ⋅ ⋅ , 𝑓𝑁
)
, 𝑖 = 1, ⋅ ⋅ ⋅ , 𝑁
(30)
where
𝑓𝑖 =
¯ℎ∗
𝑦,𝑖ℎ∗
𝑠,𝑖
√P6
√∑𝑁
𝑖=1 ∣¯ℎ𝑦,𝑖∣2∣ℎ𝑠,𝑖∣2(𝜎2𝑠∣ℎ𝑠,𝑖∣2 + 𝜎2𝑣𝑠)
.
(31)
IV. SIMULATION RESULTS
The Monte-Carlo simulation results is performed to eval-
uate BER performance of the cooperative or noncoopera-
tive distributed MMSE relay scheme with imperfect channel
information. All simulations are performed for one-source-
one-destination pair 𝑁 = 2 cooperative or noncooperative
distributed relay nodes. It is assumed that all relay nodes
are located at equidistance between the source node and the
destination node. The perfect channel coefﬁcient vectors h𝑠
and h𝑦 are generated from independent Gaussian random
variables with zero mean and unity variance. All nodes with
only one antenna have the same noise power, i.e., 𝜎2
𝑣𝑠=𝜎2
𝑣𝑦.
It is also assumed that the transmitted signal at the source
node is modulated by 4-ary quadrature amplitude modulation
(4QAM). Perfect/imperfect channel coefﬁcients with unity
power are used. And, the total power constraints are set to
P1 = P2 = P3 = P4 = P5 = P6 = 1.
For three different channel uncertainty conditions, i.e., 5%,
10%, and 20% of channel uncertainty are, respectively, mod-
eled as additive white Gaussian noise and added to the perfect
channel coefﬁcient values, i.e., the variances of the channel
estimation errors are chosen to satisfy 10 log10(𝜎2
𝜙𝑠/𝜎2
ℎ𝑠) =
10 log10(𝜎2
𝜙𝑦/𝜎2
ℎ𝑦) = −13 dB, −10 dB, and − 7 dB when-
ever the links are imperfect. For comparison, the simulation
results with perfect channel information are also included, i.e.,
𝜎2
𝜙𝑠 = 𝜎2
𝜙𝑦 = 0.
TABLE I
RELAY STRATEGIES AND CHANNEL UNCERTAINTY CONDITIONS IN FIG. 3
THROUGH FIG. 6 WITH 𝑁=2 RELAY NODES
Fig. No.
Cooperative/noncooperative
Channel uncertainty
Fig. 3
cooperative
(¯h𝑠, ¯h𝑦)
Fig. 4
cooperative
(¯h𝑠, h𝑦) or (h𝑠, ¯h𝑦)
Fig. 5
noncooperative
(¯h𝑠, ¯h𝑦)
Fig. 6
noncooperative
(¯h𝑠, h𝑦) or (h𝑠, ¯h𝑦)
Figures 3 through 6 show the BER versus SNR for the
cases listed in TABLE 1, where SNR≜ 𝜎2
𝑠𝜎2
ℎ/𝜎2
𝑣 = 𝜎2
𝑠/𝜎2
𝑣
represents the signal-to-noise power ratio. For example, Fig.
3 shows BER versus SNR for 𝑁 = 2 cooperative distributed
relay networks under a (¯h𝑠, ¯h𝑦) environment, i.e., both imper-
fect links ¯h𝑠 and ¯h𝑦. Also, both perfect channel case (h𝑠, h𝑦)
is included for comparisons. Due to the effect of imperfect
channel information on both source-relay and relay-destination
links in Fig. 3, the worst BER is observed, compared to
the other cases in Figs. 4-6. In particular, it is observed
that increasing the variances of the channel estimation errors,
worse BER can be observed.
Fig. 3.
BER performance of 𝑁 = 2 cooperative distributed relay networks
under certain/uncertain channel conditions using both imperfect channel
vectors (¯h𝑠, ¯h𝑦).
It is observed from Fig. 5 that the case (h𝑠, ¯h𝑦) shows a
better performance than that of the (¯h𝑠, h𝑦) case because the
Fig. 4.
BER performance of 𝑁 = 2 cooperative distributed relay networks
under the cases of (¯h𝑠, h𝑦) or (h𝑠, ¯h𝑦).
diagonal relay amplifying matrix F†
3 in (24) is independent of
143
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

the variance of the channel estimation error 𝝓𝑦.
As observed from Fig. 3 and Fig. 5, the cooperative
distributed relay scheme provides a better BER performance
than the noncooperative one, e.g., 2 dB at BER = 10−3. As
with the case of the cooperative channel uncertainty, BER of
the noncooperative relay under the (h𝑠, ¯h𝑦) case
shows a
Fig. 5.
BER performance of 𝑁 = 2 noncooperative distributed relay
networks under certain/uncertain channel conditions using both imperfect
channel vectors (¯h𝑠, ¯h𝑦).
better performance than that of the (¯h𝑠, h𝑦) case because the
diagonal relay amplifying matrix F†
6 in (31) is independent of
the variance of the channel estimation error 𝝓𝑦.
Finally, it
Fig. 6.
BER performance of 𝑁 = 2 noncooperative distributed relay
networks under the cases of (¯h𝑠, h𝑦) or (h𝑠, ¯h𝑦).
is observed in general from Figs. 4 and 6 that the effect of
the noncooperative channel uncertainty is larger than that of
the cooperative one. And if both links are uncertain, then the
performance is worse than the other cases.
V. CONCLUSION
This paper considered distributed MMSE AF relay schemes
in wireless relay networks under channel uncertainty and
power constraints at relay nodes. It used one-source-one-
destination pair and 𝑁-relay cooperative as well as noncooper-
ative relay networks. Under either certain or uncertain channel
condition, BER performance of cooperative distributed relay
network is better than that of noncooperative case. Under
channel uncertainty, it has been observed that increasing
variances of the channel estimation error results in loss of
diversity order. In addition, BER corresponding to the channel
uncertainty before relays shows a worse performance than that
of the channel uncertainty after relays.
REFERENCES
[1] Y. W. Hong, W. J. Huang, F. H. Chiu, and C. C. J. Kuo, “Coopera-
tive communications in resource-constrained wireless networks,” IEEE
Signal Process. Mag., vol. 24, no. 3, pp. 47-57, May 2007.
[2] A. Saadani and O. Traor´e, “Orthogonal or non orthogonal amplify and
forward protocol: How to cooperate?” IEEE WCNC 2008, Las Vegas,
NV, Mar. 2008, pp 368-373.
[3] J. Laneman, D. N. C. Tse, and G. W. Wornell, “Cooperative diversity
in wireless networks: Efﬁcient protocols and outage behaviour,” IEEE
Transactions on Information Theory, vol. 50, no. 12, Dec. 2004.
[4] G. Kramer, M. Gastpar, and P. Gupta, “Cooperative strategies and ca-
pacity theorems for relay networks,” IEEE Transactions on Information
Theory, vol. 51, no. 9, pp. 3037-3063, Sept. 2005.
[5] T. Wang, A. Cano, G. B. Giannakis, and J. N. Laneman, “High per-
fromance cooperative demodulation with decode-and-forward relays,”
IEEE Transactions on Communications, vol. 55, no. 7, pp. 1427-1438,
July 2007.
[6] N. Khajehnouri and A. H. Sayed, “Distributed MMSE relay strategies
for wireless sensor networks,” IEEE Transactions on Signal Processing,
vol. 55, no. 7, pp. 3336-3348, July 2007.
[7] S. Berger and A. Wittneben, “Cooperative distributed multiuser MMSE
relaying in wireless ad-hoc networks,” IEEE 39th Asilomar Conf., Oct.
2005, pp. 1072-1076.
[8] R. Krishna, Z. Xiong, and S. Lambotharan, “A cooperative MMSE relay
strategy for wireless sensor networks,” IEEE Signal Processing Letters,
vol. 15, pp. 549-552, 2008.
[9] A. S. Behbahani and A. M. Eltawil, “Amplify-and-forward relay net-
works under received power constraint,” IEEE Transactions on Wireless
Communications, vol. 8, no. 11, pp. 5422-5426, Nov. 2009.
[10] K. Lee, H. M. Kwon, Y. Ding, Y. Ibdah, Z. Wang, and Y. Bi, “Node
geometry and broadband jamming in noncooperative relay networks
under received power constraint,” IEEE SARNOFF 2011, Princeton, NJ,
May 3-4, 2011.
[11] Y. Ibdah, H. M. Kwon, K. Lee, Z. Wang, Y. Bi, and M. Jo, “Broadband
jamming and channel uncertainty for noncooperative wireless relay
networks under received power constraint,” IEEE AMS 2011, Manila,
Philippines, May 23-27, 2011.
[12] S. Boyd and L. Vandenberghe, 𝐶𝑜𝑛𝑣𝑒𝑥 𝑂𝑝𝑡𝑖𝑚𝑖𝑧𝑎𝑡𝑖𝑜𝑛. Cambridge,
UK: Cambridge University Press, 1985.
[13] R. A. Horn and C. R. Johnson, 𝑀𝑎𝑡𝑟𝑖𝑥 𝐴𝑛𝑎𝑙𝑦𝑠𝑖𝑠. 1st ed., Cambridge,
MA: Cambridge University Press, 1985.
[14] “The Matrix Cookbook,” Online at: http://matrixcook book.com.
[15] A. H. Sayed, 𝐹𝑢𝑛𝑑𝑎𝑚𝑒𝑛𝑡𝑎𝑙𝑠 𝑜𝑓 𝐴𝑑𝑎𝑝𝑡𝑖𝑣𝑒 𝐹𝑖𝑙𝑡𝑒𝑟𝑖𝑛𝑔. Hoboken, NJ:
John Wiley & Sons, 2003.
144
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

