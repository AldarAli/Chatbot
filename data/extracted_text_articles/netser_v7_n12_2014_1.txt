1
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Analysis of the Performance for SFBC-OFDM and
FSTD-OFDM Schemes in LTE Systems over
MIMO Fading Channels
Mohammad Torabi, Ali Jemmali, and Jean Conan
Department of Electrical Engineering,
´Ecole Polytechnique de Montr´eal,
Montr´eal, QC, Canada,
{mohammad.torabi, ali.jemmali, jean.conan}@polymtl.ca
Abstract— In this paper, a performance analysis is presented
for space-frequency block coded orthogonal frequency division
multiplexing (SFBC-OFDM) and Frequency Switched Transmit
Diversity OFDM (FSTD-OFDM) schemes in the 3GPP Long
Term Evolution (LTE) system over MIMO fading channels.
Analytical expressions for the average BER, average channel
capacity and the average throughput of the system are derived for
two different MIMO schemes, SFBC-OFDM and FSTD-OFDM,
deﬁned in LTE, and are evaluated numerically. Monte-Carlo
simulation results are also provided to verify the accuracy of
the mathematical analysis. It is shown that the results obtained
from Monte-Carlo simulations match closely with those obtained
from the derived mathematical formulas.
Keywords- Performance Analysis, MIMO, LTE, M-QAM Mod-
ulation, Capacity, Throughput.
I. INTRODUCTION
To increase the capacity and speed of wireless commu-
nication systems, a new wireless data networks has been
emerged and has been standardized by the 3rd Generation
Partnership Project (3GPP). This new standard is a natural
evolution to the existing second (2G) and third (3G) generation
wireless networks in order to respond to the growing demand
in terms of data rates and speed and marketed as 4G Long
Term Evolution (LTE). In LTE, data throughput and the speed
of wireless data are increased by using a combination of
new methods and technologies like Orthogonal Frequency
Division Multiplexing (OFDM) and Multiple-Input Multiple-
Output (MIMO) techniques.
In the downlink, LTE transmission is based on Orthogonal
Frequency Division Multiple Access (OFDMA), known as a
technique for encoding digital data on multiple carrier fre-
quencies. It was shown that OFDMA is an efﬁcient technique
to improve the spectral efﬁciency of wireless systems. By
converting the wide-band frequency selective channel into a
set of several ﬂat fading subchannels, OFDM technique be-
comes more resistant to frequency selective fading than single
carrier systems. As OFDM signals are in time and frequency
domain, they allow adding frequency domain scheduling to
time domain scheduling. In LTE, for a given transmission
power, the system data throughput and the coverage area
can be optimized by employing Adaptive Modulation and
Coding (AMC) techniques. The role of a user scheduler at
the transmitter side is to assign the data rate for each user
according to the channel conditions from the serving cell, the
interference level from other cells, and the noise level at the
receiver side.
In LTE standard, the use of MIMO has been considered as
an essential technique in order to achieve the target in terms
of data throughput and reliability. MIMO is known to be a
very powerful technique to improve the system performance of
wireless communication systems. The diversity and multiplex-
ing modes are the two main modes of operation of multiple
antennas systems. The principle of diversity mode is based
on transmitting the same signal over multiple antennas and
hence to improve the reliability of the system by a diversity
gain. In this mode, the mapping function of transmit symbols
used at the transmit antennas is called Space Time Block
Coding (STBC). On the other hand, multiplexing mode uses
two or more different spatial streams and sends them through
two different antennas, consequently, the data rate can be
improved.
In [1] an analysis is performed for evaluating the average bit
error rate (BER) of MIMO schemes in LTE systems employing
the classical M-ary quadrature amplitude modulation (M-
QAM) scheme. In this paper, we provide more details about
the system model and about the considered transmit diversity
schemes in LTE and we extend the results in [1] and in
addition to the average BER analysis, we present the average
capacity analysis as well as the average throughput analysis
for two different MIMO schemes as deﬁned in LTE. Then,
the results obtained from analytical formulas are provided,
showing the performance of the considered schemes. From
those results one can simply compare the beneﬁts of using
considered MIMO schemes. In addition, the results obtained
from Monte-Carlo simulations are also provided to verify the
accuracy of the analysis for each performance metric.
To study the performance of LTE systems a MATLAB based
downlink physical layer simulator for Link Level Simulation
(LLS) has been developed in [2], [3]. A System Level Sim-
ulation of the Simulator is also available [4]. The goal of
developing the LTE simulator was to facilitate comparison
with the works of different research groups and it is publicly
available for free under academic non-commercial use license
[3]. The main features of the simulator are adaptive coding

2
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
and modulation, MIMO transmission and scheduling. As the
simulator includes many physical layer features, it can be
used for different applications in research [4]. In [5], the
simulator was used to study the channel estimation of OFDM
systems and the performance evaluation of a fast fading
channel estimator was presented. In [6] and [7], a method for
calculating the Precoding Matrix Indicator (PMI), the Rank
Indicator (RI), and the Channel Quality Indicator (CQI) were
studied and analyzed with the simulator.
In this paper, analyses of the performance for two transmit
diversity schemes, known as Space Frequency Block Coding
(SFBC) and Frequency Switched Transmit Diversity (FSTD)
MIMO schemes in LTE system, are presented for different
performance metrics. Those performance metrics are the av-
erage BER, the average capacity and the average throughput.
The average BER results obtained from the analysis are then
compared to the results of Monte-Carlo simulation using the
Link Level LTE simulator [2], [3].
The remainder of this paper is organized as follows. In
Section II, we present the system model used in the paper. In
Section III, we present performance analyses for the average
BER, the average capacity and the average throughput of
SFBC and FSTD MIMO schemes. The numerical and sim-
ulation results and discussions are presented in Section IV.
Finally, Section V concludes the paper.
II. SYSTEM MODEL
In this section, the structure of the OFDM LTE signal and
LTE transmit diversity schemes are described. However, more
details can be found in [8]. The OFDM signal has a time and
a frequency domains. In the time domain, the LTE signal is
composed of successive frames. Each frame has a duration of
Tframe = 10 msec. Each frame is divided into 10 subframes
with equal length of 1 msec. Each subframe consists of two
equal length time-slots with a time duration of Tslot = 0.5
msec. For a normal cyclic preﬁx length, each time-slot consists
of Ns = 7 OFDM symbols. In the frequency domain, the
OFDM technique converts the LTE wideband signal into sev-
eral narrowband signals. Each narrowband signal is transmitted
on one subcarrier frequency.
In LTE, the spacing between subcarriers is ﬁxed to 15 KHz.
Twelves adjacent subcarriers, occupying a total of 180 KHz,
of one slot forms the so-called Resource Block (RB). The
number of Resource Blocks in an LTE slot depends on the
allowed system bandwidth. The minimum number of RB is
equal to 6 corresponding to 1.4 MHz system bandwidth. For
20 MHz system bandwidth (Maximum Allowed bandwidth in
LTE) the number of RB is equal to 100. In a MIMO system
with MR receive antennas and MT transmit antennas, the
relation between the received and the transmitted signals on
subcarrier frequency k (k ∈ 1, · · · , K), at sampling instant
time n (n ∈ 1, · · · , N) is given by
yk,n = Hk,nxk,n + nk,n
(1)
where yk,n ∈ CMR×1 is the received vector, Hk,n ∈ CMR×MT
represents the channel matrix on subcarrier k at instant time
n, xk,n ∈ CMR×1 is the transmit symbol vector and nk,n ∼
CN(0, σ2
n.I) is a white, complex valued Gaussian noise vector
with variance σ2
n.
Assuming perfect channel estimation, the channel matrix
and noise variance are considered to be known at the receiver.
A linear equalizer ﬁlter given by a matrix Fk,n ∈ CMR×MR is
applied on the received symbol vector yk,n to determine the
post-equalization symbol vector rk,n as follows [7]
rk,n = Fk,nyk,n = Fk,nHk,nxk,n + Fk,nnk,n.
(2)
The Zero Forcing (ZF) or Minimum Mean Square Error
(MMSE) design criterion [9] are typically used for the linear
receiver and the input signal vector is normalized to unit
power. In MIMO-OFDM systems, the key factor of link error
prediction and performances is the signal to noise ratio (SNR)
which represents the measurement for the channel quality
information. In this study, the SNR is deﬁned by
γk,n =
γ
NT
∥Hk,n∥2
F
(3)
where γ = Es/N0 is the average SNR per symbol and ∥.∥2
F
is the squared Frobenius norm of a matrix.
A. LTE Frame Structure
Two types of LTE frame structures are deﬁned depending
on the duplexing mode of the transmission. Two duplexing
methods are deﬁned in LTE, namely Time Division Duplex
(TDD) and Frequency Division Duplex (FDD). In the FDD
mode, the downlink path (DL), from the eNodeB to user
equipment (UE), and the uplink path (UL), from the UE to
eNodeB, operate on different carrier frequencies. In the TDD
mode, the downlink and the uplink paths operate on the same
carrier frequency but in different time slots. In other word,
in FDD, the downlink and uplink transmissions are separated
in the frequency domain, whereas in TDD the downlink and
uplink transmissions are separated in the time domain. Type 1
frame structure of LTE is associated with the FDD duplexing
mode whereas Type 2 frame structure of LTE is associated
with the TDD duplexing mode. For both types of LTE frame
structures, the DL and UL transmissions in LTE systems are
arranged into radio frames. The duration of a radio frame is
ﬁxed at 10 msec. The radio frame is comprised of ten 1 msec
subframes, which represents the shortest Transmission Time
Interval (TTI). Each subframe consists of two slots of duration
0.5 msec.
Frame structure of Type 1 LTE FDD and Type 2 TDD are
shown in Figure 1(a) and Figure 1(b), respectively. In Type
2 TDD frame structure, as shown in Figure 1(b), each radio
frame includes 2 half frames of 5 subframes each. Subframes
can be either uplink subframes, downlink subframes or special
subframes. Special subframes include the following ﬁelds:
Downlink Pilot Time Slot (DwPTS) and Uplink Pilot Time
Slot (UpPTS). Depending on the length of the Cyclic Preﬁx
(CP) and the subcarriers spacing, each time slot consists of
6 or 7 OFDM symbols. In fact, the cyclic preﬁx represents

3
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
(a) Type 1 LTE FDD Frame Structure.
(b) Type 2 LTE TDD Frame Structure.
(c) Structure of the symbols in one slot with Normal Cyclic Preﬁx.
(d) Structure of the symbols in one slot with Extended Cyclic Preﬁx.
Fig. 1.
LTE Frame Structure.

4
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Fig. 2.
OFDM Signal Generation.
a guard period at the beginning of each OFDM symbol
which provides protection against multi-path delay spread. To
effectively combat the delay spread of the channel, the duration
of the cyclic preﬁx should be greater than the duration of the
multi-path delay spread. At the same time, cyclic preﬁx also
yields an overhead which should be minimized.
Two types of CP were speciﬁed in LTE, namely the normal
CP and the extended CP. The structure of the symbols in a 0.5
msec time slot with normal cyclic preﬁx and extended cyclic
preﬁx are shown in Figure 1(c) and Figure 1(d), respectively.
As shown, in normal CP, each slot includes 7 OFDM symbols,
whereas in extended CP each slot includes only 6 OFDM sym-
bols. The duration of the ﬁrst cyclic preﬁx and the subsequent
preﬁxes in terms of sampling time (Ts) are also shown in
Figure 1(c). Ts represents the basic time unit and is given by
Ts = 1/(15000 × 2048) seconds. It can be noticed that the
duration of the ﬁrst cyclic preﬁx is larger than the subsequent
cyclic preﬁxes. For the normal cyclic preﬁx the duration of the
ﬁrst cyclic preﬁx is deﬁned as 160 × Ts, whereas the duration
of subsequent cyclic preﬁxes is only 144 × Ts. For extended
cyclic preﬁx, all preﬁxes have the same length of 512 × Ts.
The normal cyclic preﬁx length is proposed to be sufﬁcient
for the majority of radio environment scenarios, while the
extended cyclic preﬁx is intended for radio environment with
particularly high delay spreads. As we will see later, the cyclic
preﬁx of size G is the copy of G last elements from an OFDM
block including N elements.
B. OFDM Symbol Generation
An OFDM symbol can be generated using the Inverse
Fast Fourier Transform (IFFT), which is an operation of
a transformation from frequency domain to time domain.
Accordingly, the transmitted signal is deﬁned in the frequency
domain. This means that the complex modulated symbols are
considered as the coefﬁcients in the frequency domain. The
block diagram of an OFDM signal generation is shown in
Figure 2. The serial input data stream of size M are converted
into M parallel data elements denoted a block given by
S = (S0, S1, S2, ..., SM−1)T . Then, M parallel data streams
(Si, i = 0, 1, ..., M − 1) are independently modulated (e.g.,
M-QAM modulation) to form a vector of complex modulated
symbols given by X = (X0, X1, X2, ..., XM−1)T .
The vector X is then applied to the input of an N-point
Inverse Fast Fourier Transform (IFFT). The output of this
operation is a set of N complex time-domain samples, given
by x = (x0, x1, x2, ..., xN−1)T . In practical implementation
of an OFDM system, N the size of IFFT is greater than M
the number of modulated symbols (i.e., N ≥ M).
As shown in Figure 2, for the remaining subcarriers (N −M
subcarriers) are being padded with zeros. The next important
operation in the generation of an OFDM signal is the creation
of a guard period at the beginning of each OFDM symbol by
inserting a Cyclic Preﬁx (CP). This CP is simply generated by
taking the last G samples of the IFFT output and appending
them at the beginning of vector x. This yields the OFDM
symbol in the time domain, as a vector of size G + N,
given by (xN−G, ..., xN−1, x0, x1, x2, ..., xN−1)T as shown
in Figure 2. The last step in the OFDM signal generation
is the parallel to serial conversion of the IFFT output an
then its transmissions through the transmit antennas. The
generated OFDM signal will be transmitted over multiple
transmit antennas using the transmit diversity schemes to be
explained in the following.

5
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Fig. 3.
Space Frequency Block Coding (SFBC) Scheme in LTE [11].
Fig. 4.
Frequency Switched Transmit Diversity (FSTD) Scheme in LTE [11].
C. Transmit Diversity Schemes in LTE
In LTE, two main transmit diversity schemes are employed;
the ﬁrst one (SFBC scheme) with 2 transmit antennas and
the second one (FSTD scheme) with 4 transmit antennas [10].
Both schemes use only one data stream (one signal) [11]. In
LTE, one data signal (also called data stream) is referred as one
codeword because only one transport block (TB) is used per
data stream. In order to ensure uncorrelated channels between
different antennas and hence maximizing the diversity gain, the
antennas should be well separated relative to the wavelength.
1) SFBC scheme in LTE: When a physical channel in LTE
is conﬁgured for transmit diversity operation using two eN-
odeB antennas, the diversity scheme is called Space Frequency
Block Coding. The principle of SFBC transmission is shown
in Figure 3, similarly to the one reported in [11]. As can be
seen from Figure 3, the SFBC diversity scheme is, in fact, the
frequency domain implementation of the well known Space
Time Block Coding technique, developed by Alamouti [12].
The fundamental characteristic of this family of coding is that
the transmitted diversity streams are orthogonal and they can
be simply decoded at the receiver.
STBC operates on pairs of adjacent symbols in the time
domain. Since the signal in LTE is two dimensional (time
and frequency domains) and the number of available OFDM
symbols in a subframe is not always an even number, the direct
application of STBC is not straightforward. Therefore, SFBC
scheme is proposed to be employed.

6
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
In LTE, for SFBC transmission, the symbols are transmitted
from two eNodeB antenna ports on each pair of adjacent
subcarriers as follows [10]:
y(0)(2j)
y(0)(2j + 1)
y(1)(2j)
y(1)(2j + 1)

=

x2j
x2j+1
−x∗
2j+1
x∗
2j

(4)
where y(p)(k) denotes the symbols transmitted on the k-
th subcarrier from antenna port p. x2j and x2j+1 (j
=
0, 1, 2, ..., N
2 − 1) are two adjacent subcarriers in the OFDM
modulated signals, explained earlier. An important charac-
teristic of such codes is that the transmitted signal streams
are orthogonal and a simple linear receiver can be used for
detection and decoding of the signal.
2) FSTD scheme in LTE: The diversity scheme in case
of four transmit antennas (operating on port 0 to port 3) is
called Switched Transmit Diversity [10]. The transmission
structure for FSTD diversity scheme is shown in Figure 4,
similarly to the one explained in [11]. In the FSTD scheme
a pair of modulated symbols are transmitted using SFBC
scheme over two antennas, whereas the other two antennas
are not transmitting. In other words, in the FSTD scheme, the
transmission is switched between a pair of transmit antennas
at each frequency slot. This means that in the ﬁrst frequency
slot the ﬁrst two symbols are transmitted through antenna
port 0 and antenna port 2, whereas nothing is transmitted on
antennas ports 1 and 3. Then, in the next frequency slot for
transmission of next two symbols, antenna ports 1 and 3 are
used, where antenna ports 0 and 2 are not transmitting. In LTE,
the space frequency block code, designed for FSTD employing
4 transmit antennas is deﬁned as follows:


y(0)(4j)
y(0)(4j + 1)
y(0)(4j + 2)
y(0)(4j + 3)
y(1)(4j)
y(1)(4j + 1)
y(1)(4j + 2)
y(1)(4j + 3)
y(2)(4j)
y(2)(4j + 1)
y(2)(4j + 2)
y(2)(4j + 3)
y(3)(4j)
y(3)(4j + 1)
y(3)(4j + 2)
y(3)(4j + 3)

 =


x4j
x4j+1
0
0
0
0
x4j+2
x4j+3
−x∗
4j+1
x∗
4j
0
0
0
0
−x∗
4j+3
x∗
4j+2


(5)
where y(p)(k) denotes the symbols transmitted on the k-th
subcarrier from antenna port p. x4j, x4j+1, x4j+2, and x4j+3,
(j = 0, 1, 2, ..., N
4 −1) are 4 adjacent subcarriers in the OFDM
modulated signals, explained earlier.
In the following, we present a performance analysis and
evaluation for three important metrics, namely the average
BER, the average capacity, and the average throughput of the
considered MIMO systems in LTE.
III. PERFORMANCE ANALYSIS
In the following, we ﬁrst present a performance analysis
for the average BER of 2 × 1 MIMO SFBC and 4 × 2
MIMO FSTD systems, over slow fading channels. Then an
analysis for the channel capacity of the considered systems
is presented, followed by the average throughput evaluation.
The channel capacity and throughput results can be considered
as a performance limit in terms of bits/sec/Hz for the LTE
system. Finally, the numerical results, obtained from closed-
form expressions as well as the results obtained from Monte-
carlo simulations, are presented to verify the accuracy of our
analysis.
A. Average BER Performance Analysis
In the following, we present the average BER analysis for
the SFBC and SFTD systems. For each case, we ﬁrst brieﬂy
describe the transmit diversity and space frequency coding
scheme. Then, using the Moment Generating Function (MGF)-
based approach, closed-form expressions are obtained for the
average BER performance of the system for 2 × 1 SFBC and
4 × 2 FSTD MIMO schemes.
1) BER Analysis of SFBC: As explained earlier for Figure
3, SFBC-OFDM transmit diversity scheme is in fact a 2 × 1
MIMO system employing space frequency block coding over
N OFDM subcarriers.
Since OFDM converts the multipath fading channel into N
frequency ﬂat fading sub-channels, we ﬁrst derive the BER
expressions over ﬂat Rayleigh fading sub-channels, given by
Pb (E). Then, the overall average BER over N sub-channels,
in each case can be calculated from
BERavg = 1
N
N
X
k=1
Pb,k (E)
(6)
where the index k (subcarrier/sub-channel index) is ignored
for the sake of brevity. In addition, the impact of cyclic preﬁx
in OFDM is assumed to be negligible.
For the 2 × 1 MIMO system employing SFBC scheme, the
probability density function of the SNR for each subcarrier is
given by a chi-square distribution function as follows [13]
fγ(γ) = 2
¯γ2 γe− 2
¯γ γ
(7)
where ¯γ is the average SNR per symbol given by ¯γ = Es/N0.
The moment generating function (MGF) can be determined
using the following equation:
M¯γ(s) =
Z ∞
0
e−sγf(γ)dγ.
(8)
Inserting (7) into (8) and solving the integral yields
M¯γ(s) =
4
¯γ2(s + 2
¯γ )2 .
(9)
The average BER expression for M-QAM modulation
scheme can be obtained from [14] (equation (8.111; Page 255))
Pb (E) ∼= B
√
M/2
X
i=1
1
π
Z π/2
0
M¯γ (Ai,θ) dθ
(10)

7
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
where Ai,θ = (2i−1)2
2 sin2 θ
3
(M−1) and B is deﬁned by
B = 4
 √
M − 1
√
M
! 
1
log2M

.
(11)
Then, using the MGF expression in (9), we obtain
M¯γ(Ai,θ) =
4
¯γ2
h
(2i−1)2
2 sin2 θ
3
(M−1)
i
+ 2
¯γ
2 .
(12)
Substituting (12) into (10) and after some manipulations,
we obtain
Pb (E) ∼= B
√
M/2
X
i=1
1
π
Z π/2
0

sin2 θ
sin2 θ + ci
2
dθ
(13)
where ci = 3(2i−1)2
2(M−1)
¯γ
2.
The average BER performance as a function of ¯γ = Es/N0
can be evaluated by numerical evaluation of the integral in
(13) for M-QAM modulation schemes.
Alternatively, by solving the integral, we obtain a closed-
form expression for the average BER of M-QAM modulation
as follows
Pb (E) ∼= B
√
M/2
X
i=1
I2 (π/2, ci)
(14)
where the closed-form expression for I2(., .) can be obtained
from [14](eq.5A.24) as follows
In (φ, D) = 1
π
Z φ
0

sin2 θ
sin2 θ + D
n
dθ,
−π ≤ φ ≤ π
(15)
= φ
π − β
π
(π
2 + tan−1 α
 n−1
X
q=0

2q
q

1
(4 (1 + D))q
+ sin

8
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
where γk,n =
γ
NTRc ∥Hk,n∥2
F and Rc is the SFBC code rate,
that is equal to one (Rc = 1) for Alamouti space-time coding
used in SFBC and FSTD schemes.
The average capacity averaged over time instant n for k
subcarrier can be written as
Ck = E {Ck,n} =
Z ∞
0
Rc log2(1 + γk,n) fγk,n(γk,n) dγk,n.
(24)
Finally, by averaging over N subchannels, the overall average
channel capacity can be obtained from
Cavg = 1
N
N−1
X
k=0
Ck.
(25)
1) Channel Capacity of SFBC MIMO-OFDM: For the 2×1
SFBC MIMO-OFDM scheme, the probability density function
of the SNR for each subcarrier is given by (7). Inserting (7)
into (24), we obtain
Ck =
Z ∞
0
Rc log2(1 + γ) 2
¯γ2 γe− 2
¯γ γ dγ
= Rc log2(e)
Z ∞
0
2
¯γ2 ln(1 + γ) γe− 2
¯γ γ dγ.
(26)
To solve the above integral, we use the following result [17]
µ
(M − 1)!
Z ∞
0
ln (1 + x) (µ x)M−1 e−µ x dx
= PM(−µ) E1(µ) +
M−1
X
j=1
1
j Pj(µ) PM−j(−µ)
(27)
where PM(.) is the Poisson distribution deﬁned by PM(x) =
PM−1
v=0
xv
v! e−x, and where E1(.) is the exponential integral of
ﬁrst order, deﬁned by E1 (x) = R ∞
x
t−1e−tdt for x > 0.
Therefore, using (27) and after performing changes of
variables together with some simpliﬁcations, we obtain the
solution of integral in (26) as
Ck = A1 [P1(−µ) E1(µ) + P1(µ) P1(−µ)]
(28)
where A1 = Rc log2(e) and µ = 2
¯γ . Then the overall average
channel capacity can be obtained from (25).
2) Channel Capacity of FSTD MIMO-OFDM: As men-
tioned earlier, for the 4 × 2 FSTD MIMO-OFDM scheme,
we can show that the instantaneous SNR of the system, for
k-th subcarrier, is equivalent to that for a 2×2 SFBC MIMO-
OFDM scheme. For the 2 × 2 SFBC MIMO-OFDM scheme,
the probability density function of the SNR for each subcarrier
is given by (17).
Similar to the 2×1 SFBC MIMO-OFDM case, substituting
(17) into (24), we can obtain
Ck = A2

P4(−µ) E1(µ) +
3
X
j=1
1
j Pj(µ) P4−j(−µ)

 (29)
where A = Rc log2(e)/3 and µ = 2
¯γ . Then the overall average
channel capacity can be obtained from (25).
C. Throughput Analysis
In a frequency selective fading channel, the subchannels
corresponding the OFDM subcarriers have different ampli-
tudes. To obtain a better throughput or a spectral efﬁciency,
the transmission mode on each subcarrier can be chosen
according the subchannels state information. Using the known
channel state information (CSI), the transmitter can choose
the best modulation mode and can adapt the transmission
rate and/or transmit power on each OFDM subcarrier. Here,
we consider an adaptive modulation with constant-power and
adaptive-rate transmission while satisfying a quality of service
(QoS) indicator such as a predeﬁned target BER or a target
Block error rate (BLER). We use a rate adaptive modulation
assuming L-mode square M-QAM modulations.
To perform adaptive modulation we divide the entire SNR
region into L+1 fading regions. Then, according the instanta-
neous SNR value on each subchannel in each SNR region, we
assign the best modulation mode. This method can provide the
largest throughput while satisfying a target BER value [15].
In this case, the throughput (in Bits/Sec/Hz) for the consid-
ered MIMO-OFDM systems is deﬁned as [15], [16], [18]:
Tavg = Rc
N
N−1
X
k=0
L
X
l=1
βl[k]

Fγ(αl+1) − Fγ(αl)

(30)
where βl[k] is the number of bits assigned in l-th SNR region
for k-th OFDM subcarrier, αl and αl+1 are the switching SNR
thresholds for l-th SNR region. Fγ(γ) is the cumulative dis-
tribution function (CDF) deﬁned as Fγ(αj) =
R αj
−∞ fγ(γ) dγ,
where fγ(γ) is deﬁned earlier for each MIMO-OFDM scheme.
We can simply show that substituting the fγ(γ) expressions
for 2×1 SFBC MIMO-OFDM and 4×2 FSTD MIMO-OFDM
respectively given by (7) and (17) in it we obtain
Fγ(γ) = 1 − e− 2
¯γ γ

1 + 2
¯γ

(31)
and
Fγ(γ) = 1 − e− 2
¯γ γ

1 + 2
¯γ + 2
¯γ2 +
8
3¯γ3

.
(32)
Finally, closed-form expressions for the average throughput
of 2×1 SFBC MIMO-OFDM and 4×2 FSTD MIMO-OFDM
systems can be obtained by inserting the corresponding CDF
expressions (31) and (32) into (30), respectively.

9
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
TABLE I
SIMULATION SETTINGS
Parameter
Setting
Transmission Schemes
SISO; 2 × 1 SFBC; 4 × 2 FSTD
Bandwidth
5 MHz
Simulation length
5000 subframes
Channel Type
Rayleigh Fading
Channel knowledge
Perfect
CQI
6 (QPSK), 9 (16-QAM), and 16 (64-QAM)
IV. SIMULATION AND ANALYTICAL RESULTS
In this section, we provide the performance results obtained
from the mathematical expressions derived in this paper for the
average BER, the average capacity and the average throughput
of the considered MIMO systems in LTE, and assuming γ =
Es/N0 and Rc = 1. Monte-Carlo simulation results are also
provided to show the accuracy of the analysis.
The common simulation settings for Monte-Carlo simula-
tions are summarized in Table I.
A. Average BER Performance results
The average BER performance as a function of γ = Es/N0
for SISO and MIMO schemes are shown in Figure 5, Figure
6, and Figure 7. In Figure 5, the average BER results are
provided assuming 4-QAM, i.e., QPSK modulation. Figure
6 shows the results for 16-QAM modulation and Figure 7
presents the results for 64-QAM modulation.
It can be seen that the average BER performances of QPSK,
16-QAM, and 64-QAM schemes at high SNRs decrease by
factors γ1, γ2, and γ4, for SISO, 2 × 1, and 4 × 2 MIMO
cases, respectively. Thus, the diversity order (slope of the
curves) are equal to 1, 2 and 4, respectively, for the considered
cases. As stated earlier, since in 4 × 2 FSTD, at each time-
slot/frequency-slot 2 out of 4 transmit antennas are in use,
therefore the diversity order will be 2 × 2 = 4. In fact, the
corresponding average BER curve for 4×2 FSTD is somehow
like the classical 2 × 2 STBC system, when the channel is not
a time-varying channel.
From the ﬁgures it is clear that the BER performance im-
proves as the number of transmit or receive antennas increases,
as expected. It can be observed that the negative slope of the
BER curve for the SISO case is equal to 1, meaning that the
diversity order for the SISO case is equal to 1, as expected.
The second curves in Figure 5, Figure 6, and Figure 7
represent the BER results of the 2×1 SFBC diversity scheme.
Asymptotically, the slope of these curves can be observed to
be equal to 2, which corresponds to the diversity order of 2×1
SFBC system. An SNR (Es/N0) gain improvement can also
be observed compared to the SISO scheme.
From Figure 6,
it can be observed that to achieve the BER value of 10−3,
the 2 × 1 diversity scheme needs about 10 dB less in Es/N0,
compared to the SISO case.
In Figure 7 for 64-QAM modulation, the average BER of
10−3 is achieved at Es/N0 = 39 dB in SISO conﬁguration,
however, the same value of BER is achieved with only at
Es/N0 = 29 dB in the 2 × 1 diversity scheme. Thus an
SNR gain of 10 dB is clearly observed for the 2 × 1 diversity
0
5
10
15
20
25
30
35
40
10
−4
10
−3
10
−2
10
−1
10
0
Es/No (dB)
Bit Error Rate
 
 
Simulation SISO
Theoretical SISO
Simulation 2x1
Theoretical 2x1
Simulation 4x2
Theoretical 4x2
Fig. 5.
Numerical Evaluation and Monte-Carlo Simulations of the average
BER for QPSK modulation.
0
10
20
30
40
50
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
Es/N0 (dB)
Average  BER
 
 
Simulation SISO
Numerical SISO
Simulation 2 × 1
Numerical 2 × 1
Simulation 4 × 2
Numerical 4 × 2
2 × 1
SISO
4 × 2
Fig. 6.
Numerical Evaluation and Monte-Carlo Simulations of the average
BER for 16-QAM modulation.
scheme. The BER results of the 4 × 2 diversity scheme for
both modulation schemes, i.e., 16-QAM and 64-QAM are also
shown. As described earlier, in high SNRs region the slope of
that curve tends to be equal to 4. This value corresponds to
the diversity order of a 2 × 2 system.
Finally, it can be observed from Figure 5, Figure 6 and
Figure 7 that numerical evaluation results obtained from
average BER formulas match closely to the average BER
results obtained from Monte-Carlo simulations. This veriﬁes
the accuracy of the analysis.

10
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
0
10
20
30
40
50
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
Es/N0 (dB)
Average  BER
 
 
Simulation SISO
Numerical SISO
Simulation 2 × 1
Numerical 2 × 1
Simulation 4 × 2
Numerical 4 × 2
SISO
2 × 1
4 × 2
Fig. 7.
Numerical Evaluation and Monte-Carlo Simulations of the average
BER for 64-QAM modulation.
0
5
10
15
20
25
30
35
40
0
1
2
3
4
5
6
7
8
Spectral Efficiency (Bits/Sec/Hz)
Average SNR (dB)
 
 
Simulation 4 × 2
Analysis
4 × 2
Simulation 2 × 1
Analysis
2 × 1
Simulation 1 × 1
Analysis
1 × 1
4−QAM
16−QAM
64−QAM
Fig. 8.
Numerical Evaluation and Monte-Carlo Simulations of the average
spectral efﬁciency of the system for different cases.
B. Average Channel Capacity and Throughput Results
In the following, we show the results for the average capac-
ity and the average throughput (average spectral efﬁciency)
results for the considered systems. The results are obtained
from the mathematical formulas presented in previous section
as well as from Monte-Carlo simulations. Figure 8 and Figure
9 show the channel capacity limits as well as the throughput
of 2 × 1 SFBC MIMO-OFDM, 4 × 2 FSTD MIMO-OFDM,
and SISO-OFDM systems. For evaluating the throughout, we
assume several cases considering a target BER of 10−5.
In Figure 8, we assume a case using two transmis-
sion modes, i.e., one M-QAM transmission mode (M
∈
0
5
10
15
20
25
30
35
40
0
2
4
6
8
10
12
Average SNR (dB)
Spectral Efficiency (Bits/S/Hz)
 
 
Simulation 4 × 2
Analysis
4 × 2
Simulation 2 × 1
Analysis
2 × 1
Simulation 1 × 1
Analysis
1 × 1
Capacity Limit
Adaptive 
Modulation
Fig. 9.
Numerical Evaluation and Monte-Carlo Simulations of the average
spectral efﬁciency of the system for different cases.
{4, 16, 64}) and a no-transmission mode. For example, when
16-QAM modulation and no-transmission modes are consid-
ered, when the SNR of the subchannel is below a certain
threshold we use 16-QAM for transmission, otherwise no data
is transmitted, i.e., no-transmission mode. The SNR threshold
is obtained according the target BER value. It can be observed
in Figure 8 that the capacity for 4 × 2 FSTD MIMO-OFDM
system is superior than those of 2 × 1 SFBC MIMO-OFDM,
and SISO cases, as expected.
It is also shown that 2 × 1 SFBC MIMO-OFDM system
can provide superior capacity performance compared to the
SISO system. It can be observed that in a two-mode trans-
mission case, using a higher modulation mode (e.g., 16-QAM
instead of 4-QAM) yields a throughput increase at high SNRs.
However, at low SNR values, for example between 8 to 20 dB,
4-QAM transmission can provide a higher throughput than 64-
QAM case. This is due to the fact that the SNR threshold for
4-QAM is much less than that for 64-QAM, and a two-mode
transmission using 4-QAM starts the transmission at a lower
SNR than for a two-mode transmission using 64-QAM.
To obtain a better throughput, we use more modulation
modes in the transmission. In Figure 9, we assume a case
using several transmission modes, including a no-transmission
mode, and a four-transmission mode using BPSK, 4-QAM,
16-QAM, 64-QAM schemes. In this case, we obtain 4 SNR
thresholds αl (l = 1, 2, 3, 4) corresponding to the considered
modulation schemes and satisfying the target BER of 10−5. It
can be seen that transmissions occur in a wide range of SNR
values. In 1 × 1 SISO system, and in 2 × 1, and 2 × 4 MIMO
systems, the throughput values reach a maximum rate of 6
bits/sec/Hz that is equal to the average bits transmitted by 64-
QAM, the highest mode considered. To verify the analysis
the results obtained from Monte-carlo simulations are also
provided. It can be seen that the numerical results obtained
from the formulas match closely to the simulation results.

11
International Journal on Advances in Networks and Services, vol 7 no 1 & 2, year 2014, http://www.iariajournals.org/networks_and_services/
2014, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
V. CONCLUSION
In this paper, we have presented performance analyses
for the average BER, the average channel capacity and the
throughput of MIMO schemes in the 3GPP Long Term Evo-
lution (LTE). The theoretical analysis for two different MIMO
schemes in a 5 MHz bandwidth LTE system were presented.
To verify the accuracy of the analysis the results of Monte-
Carlo simulation for the studied schemes were provided and
compared with the results obtained from theoretical analysis.
To show the performance improvement in the MIMO schemes,
the performance of a SISO conﬁguration was also presented.
The results show a good agreement between numerical results
and Monte-Carlo simulation results.
REFERENCES
[1] A. Jemmali, J. Conan, and M. Torabi, “Bit Error Rate Analysis of
MIMO Schemes in LTE Systems,” in Proc. International Conference
on Wireless and Mobile Communications (ICWMC-2013), July 2013,
pp. 190–194.
[2] C. Mehlf¨uhrer, M. Wrulich, J. C. Ikuno, D. Bosanska, and M. Rupp,
“Simulating the long term evolution physical layer,” in Proc. European
Signal Processing Conference (EUSIPCO 2009), 2009.
[3] Online,
“LTE
link
level
simulator,”
2009,
available
http://www.nt.tuwien.ac.at/ltesimulator.
[4] J. Ikuno, M. Wrulich, and M. Rupp, “System level simulation of LTE
networks,” in Proc. IEEE Vehicular Technology Conference (VTC 2010-
Spring), May 2010, pp. 1–5.
[5] M. Simko, C. Mehlfuhrer, M. Wrulich, and M. Rupp, “Doubly dispersive
channel estimation with scalable complexity,” in Proc. International ITG
Workshop on Smart Antennas (WSA), Feb. 2010, pp. 251–256.
[6] S. Schwarz, M. Wrulich, and M. Rupp, “Mutual information based
calculation of the precoding matrix indicator for 3GPP UMTS/LTE,”
in 2010 International ITG Workshop on Smart Antennas (WSA), Feb.
2010, pp. 52–58.
[7] S. Schwarz, C. Mehlfuhrer, and M. Rupp, “Calculation of the spatial
preprocessing and link adaption feedback for 3GPP UMTS/LTE,” in
Proc. 6th Conference on Wireless Advanced (WiAD), June 2010, pp.
1–6.
[8] A. Jemmali, Performance Evaluation and Analysis of MIMO Schemes
in LTE Networks Environment.
PhD Thesis, Universit´e De Montr´eal,
´Ecole Polytechnique De Montr´eal, Quebec, Canada., 2013.
[9] D. Tse and P. Viswanath, Fundamnetals of Wireless Communications.
Cambridge University Press, 2008.
[10] S. Sesia, T. Issam, and M. Backer, LTE The UMTS Long Term Evolution
From Theory To Practice.
John Wiley, 2011.
[11] E. Dahlman, S. Parkvall, and J. Skld, 4G LTE/LTE-Advanced for Mobile
Broadband.
Academic Press, Elsevier, 2011.
[12] S. Alamouti, “A simple transmit diversity technique for wireless commu-
nications,” IEEE Journal on Selected Areas in Communications, vol. 16,
no. 8, pp. 1451–1458, Oct. 1998.
[13] M. Torabi and D. Haccoun, “Performance Analysis of Joint User
Scheduling and Antenna Selection Over MIMO Fading Channels,” IEEE
Signal Process. Lett., vol. 18, no. 4, pp. 235–238, April 2011.
[14] M. S. Alouini and M. K. Simon, Digital Communications over Fading
Channels: A Uniﬁed Approach to Performance Analysis.
Wiley, 2000.
[15] M. Torabi, D. Haccoun, and W. Ajib, “Performance Analysis of Schedul-
ing Schemes for Rate-Adaptive MIMO OSFBC-OFDM Systems,” IEEE
Trans. Veh. Technol., vol. 59, no. 5, pp. 2363–2379, June 2010.
[16] L. Hanzo, C. H. Wong, and M. S. Yee, Adaptive wireless transceivers:
Turbo-Coded, Turbo-Equalised and Space-Time Coded TDMA, CDMA
and OFDM Systems.
John Wiley & Sons Ltd, 2002.
[17] C. G. G¨unther, “Comment on estimate of channel capacity in Rayleigh
fading environment,” IEEE Trans. Veh. Technol., vol. 45, no. 2, pp. 401–
403, May 1996.
[18] M. S. Alouini and A. J. Goldsmith, “Adaptive modulation over Nak-
agami fading channels,” Wireless Personal Communications, vol. 13,
no. 1, pp. 119–143, 2000.

