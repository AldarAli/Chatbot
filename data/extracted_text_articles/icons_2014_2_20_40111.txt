An Electricity Flow Optimization Problem for Effective Operation of Storage Devices
in Microgrid
Hidenobu Aoki and Norihiko Shinomiya
Dept. of Information Systems Science
Soka University
Tokyo, Japan
shinomi@ieee.org
Abstract—An electrical energy storage device has been ex-
pected to alleviate negative effects of the integration of renewable
energy resources into electricity supply systems; however, the
appropriate storage technology along with the control charac-
teristics as a component in the electricity supply system has not
been clariﬁed yet. As one of approaches, an effective control
of electricity ﬂow and an operation of storage devices have been
developing. This paper formulates an electricity ﬂow optimization
problem in reducing transmission loss to analyze the ﬂuctuation
of it followed by the adjustment of the amount of electricity
stored in storage devices.
Keywords—electrical energy storage device; microgrid; renew-
able energy resource; transmission loss; transportation problem.
I. INTRODUCTION
Smart Grid, a concept of incorporating ICT (Information
and Communication Technology) into electricity supply sys-
tem, is being developed from various perspectives, such as
enhancing the reliability of electricity supply system and
realizing low carbon society with renewable energy resources.
On the other hand, to reduce the amount of transmission
loss, physical loss of electrical energy while it is transmitted
though transmission line is also main objective of Smart Grid
technology [1].
In a traditional power grid, the large amount of electricity
can be lost since electricity is supplied from a few large-
scale power plants located in rural areas to consumer sides.
In contrast, by exploiting renewable energy resources as dis-
tributed energy resources and controlling them effectively with
the concept of Smart Grid, the reduction of transmission loss
has been expected [2].
However, the generation patterns of those renewable energy
resources ﬂuctuate irregularly due to weather conditions and
it may result in the ﬂuctuation of frequency and voltage in
a power grid. As a result, the degradation of the stability in
power grid might be caused when a large amount of them are
introduced in electricity supply system [1][2][3].
To deal with the drawback of the renewable energy resource,
management strategies of them are studied in many research
works [3]; Microgird (MG), forming a small-scale power grid
composed of local electricity consumers and distributed energy
resources has been proposed to realize a self-sufﬁcient supply
system in local areas [2]. In [4], it is stated that MG with its
locality can make energy management of renewable energy
resources improved as well as reducing transmission loss. In
addition, as a way to mitigate negative effects of the integra-
tion of renewable energy resources, utilizing grid-integrated
electrical energy storage devices has been considered as well
[5][6]. This is because it can be used to stabilize the short-
time frequency and voltage ﬂuctuation, manage peak loads,
and improve the power quality [7][8].
A. Related Work of Storage Device
A lot of research related to the use of the storage device
in electricity supply systems have been developing in order to
improve the efﬁciency and reliability of the storage technology
[9]. Moreover, although there are various types and sizes of
storage devices for different purposes, a large-scale storage
device installed beside renewable energy resources has been
developing. This is because if renewable energy resources
and storage devices are installed in geographically separated
places, transmission loss may arise to send surplus electricity
from renewable energy resources to storage devices to store
it. Furthermore, storage devices have been also expected as a
backup source of electricity for an emergency, such as when
natural disaster occurs from the perspective of the stability and
durability of the electricity supply system [10].
Many of the current research related to storage technology
mainly focus on the power balance for stable and reliable elec-
tricity supply [6][11]; however, a full potential of the storage
device and an appropriate storage technology along with the
control characteristics as a component of the electricity supply
system have not been clariﬁed yet and remained as a research
task [11] [12]. As one of approaches to analyze the control
characteristics, an effective operations of the storage device by
optimizing electricity ﬂow has been studied [9][13].
B. Research Objective
This paper assumes the situation that storage devices are
installed beside renewable energy resources which generate
surplus electricity in MG. Then, this paper tries to smooth the
amount of electricity stored in storage devices by adjusting
the amount of electricity supplied from renewable energy
resources. This is to distribute the amount of surplus electricity
as backup sources for the realization of a durable electricity
supply system for an emergency.
28
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-319-3
ICONS 2014 : The Ninth International Conference on Systems

In this situation, the amount of electricity generated in a
renewable energy resource can be divided into two types of
use, the amount of electricity supplied from a renewable en-
ergy resource and the amount of electricity stored in a storage
device; that is, there is a dependency between the amount
of electricity supplied from the renewable energy resource
and the amount of electricity stored in the storage device.
Moreover, transmission loss depends on how much and how
far electricity is transmitted. As a result, it might be indicated
that smoothing the amount of electricity stored in storage
devices may affect the total transmission loss. Therefore, this
paper analyzes how transmission loss is inﬂuenced by various
patterns of the scatter of the amount of electricity stored in
each storage device.
The rest of the paper is organized as follows: In Section I
I, the deﬁnition of MG graph, such as types of nodes and the
amount of electricity, and problem formulation are mentioned.
A simulation procedure and result are presented in section II
I. Section IV concludes the paper with future work.
II. MODEL DEFINITION AND PROBLEM FORMULATION
In this section, ﬁrstly, the model of MG graph is deﬁned.
Then, an electricity ﬂow optimization problem is formulated.
A. Deﬁnition of Microgrid Graph
This paper assumes MG graph composed of different types
of node and edge. First of all, let a node G be Central
Generation Facility (CGF) node utilizing the chemical energy
stored in fossil fuels such as coal, fuel oil, natural gas which
is converted into electrical energy. In reality, CGF will be
assigned to each MG as a supplemental power resource for
renewable energy resources;accordingly, this paper considers
as though a single G node is included as a component of MG.
Secondly, for renewable energy resources, although there
are different kinds of them, such as solar or wind power gen-
eration in reality, this paper does not consider those differences
but assume them just as a renewable energy resource. Further-
more, this paper supposes an installation of the storage device
beside renewable energy resources mentioned in Section I-
B. Thus, let a node representing renewable energy resources
contain the function of the storage device and be deﬁned as
renewable energy resource with storage device node, RSi.
Finally, a node for electricity demand, such as houses,
factories, hospitals and so on is deﬁned as Dj. This paper
assumes that the number of electricity demand nodes in MG
graph, m, is greater than that of RS nodes, n.
Those three kinds of nodes are connected in the following
manners: Every electricity demand node is connected to G so
that they can receive electricity from the stable power resource.
Furthermore, each electricity demand node is connected to all
RS nodes in MG graph to simplify the problem discussed in
the following subsections.
B. Problem Formulation
MG graph describing node types and electricity ﬂows is
shown in Figure 1. Let dj be the amount of electricity demand
Fig. 1.
A structure of MG graph.
in node Dj, and the amount of electricity derived from G
node to Dj is gj. The amount of electricity generated in RSi
is ri, and the amount of electricity supplied from RSi to Dj
is rij. The surplus electricity generated in renewable energy
resources can be stored in a storage device. Hence, let the
amount of surplus electricity stored in RSi be si which can
be described as the subtraction of the total amount of rij for
j ∈ D from the amount of ri as in (1). The sum of rij for
j ∈ D is also deﬁned as r′
i as in (2). Finally, let a rate of
transmission loss along with electricity transmission between
RS nodes and D nodes be deﬁned as lossij.
si = ri −
m
∑
j=1
rij
(1)
r′
i =
m
∑
j=1
rij
(2)
There are several constraints to match demand and supply.
Firstly, the amount of electricity demand in each D node has
to be fully met with the total amount of electricity supplied
from G node and RS nodes stated in (3).
dj = gj +
n
∑
i=1
rij
(3)
This paper focuses on optimizing electricity ﬂows from RS
nodes to D nodes. Thus, let d′
j be the amount of the electricity
subtracted gj from dj, denoting the amount of electricity that
RS nodes need to supply to Dj. In order to match demand
and supply in MG, the condition in (4) must be satisﬁed.
m
∑
j=1
d′
j =
n
∑
i=1
r′
i
(4)
In this paper, for randomly given dj and ri, the value of si
is set at ﬁrst, and r′
i is determined accordingly. Afterward, rij
is optimized.
1) Transportation Problem: To decide rij, this paper ap-
plies Transportation Problem (TP). TP is based on supply and
demand of commodities transported from several sources to
different destinations [14]. In general, TP tries to minimize
total transportation cost for the commodities transported from
source to destinations. Applying TP for an electricity ﬂow
29
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-319-3
ICONS 2014 : The Ninth International Conference on Systems

optimization, this paper considers to minimize total transmis-
sion loss from RS to D nodes. The objective function of the
electricity ﬂow optimization can be formulated as in (5).































Minimize
n
∑
i=1
m
∑
j=1
rijlossij
Subject to
m
∑
j=1
rij = r′
i,
for i = 1, 2, ..., n
n
∑
i=1
rij = d′
j,
for j = 1, 2, ..., m
rij ≥ 0
for i = 1, 2, ..., n and j = 1, 2, ..., m
(5)
2) Method to Solve Transportation Problem: There are
mainly two methods to obtain the solution for TP, Sim-
plex method and Transportation method. This paper applies
Transportation method since it is more efﬁcient one that
yields results faster and with less computational effort [14].
Transportation method consists of the following three steps.
1) Obtaining an initial feasible solution.
2) Testing Optimality.
3) Revising the solution until an optimal solution is ob-
tained.
For conducting those three steps, in general, TP can be
portrayed in a tabular form by means of a transportation table
shown in (2). In a transportation table, the number of row
represents that of RS node, n, and the number of column
denotes that of D node, m.
Fig. 2.
A transportation table.
3) North-West Corner Method: The ﬁrst step is to obtain
an initial feasible solution which satisﬁes the requirement of
demand and supply. Although an initial feasible solution can
be obtained by several methods, this paper applies North-West
Corner method (NWC), a method to compute an initial feasible
solution, which begins selecting a basic variable in the upper
left-hand corner of the transportation table. The algorithm of
NWC is described in Algorithm 1.
4) Modiﬁed Distribution Method: Once an initial solution
is obtained by NWC, the next step is to check its optimality.
Although there are several methods to ﬁnd an optimal solution
of TP, such as Vogel’s method or Stepping Stone method,
Algorithm 1 North-West Corner Method (NWC)
Require: ∑ r′
i = ∑ d′
j
Start with the cell at the upper left-hand corner
i, j ← 0
while i < n do
if rij > d′
j then
rij ← rij − d′
j
else if rij < d′
j then
d′
j ← d′
j − rij
i ← i + 1
else
i ← i + 1
j ← j + 1
end if
end while
Calculate initial transmission loss
Modiﬁed Distribution method (MODI) has been used as a
standard technique for obtaining an optimal solution [14]. This
paper applies MODI for obtaining optimal solution, and the
algorithm of MODI is described in Algorithm 2.
Algorithm 2 Modiﬁed Distribution Method (MODI)
Require: An initial feasible solution by NWC
while all pij are not a positive value do
Determine the values of dual variables, ui and vj
for each unassigned cell do
pij ← cij − (ui + vj)
end for
if all pij ≥ 0 then
Optimization is completed
Calculate optimized transmission loss
else
if pij < 0 and min(pij) then
Draw a closed path starting from rij
Assign + or - sign on the cells in it alternately
Find min(rij) in cells with − sign
end if
for each cells in closed path do
if sign is + then
rij ← rij + min(rij)
else
rij ← rij − min(rij)
end if
end for
end if
end while
III. SIMULATION AND RESULT
In this section, the simulation procedure and result are
presented.
A. Simulation Procedure
In this simulation, MG graph is created with 4 RS nodes, 8
D nodes, and a single G node. The sum of ri and dj are set
30
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-319-3
ICONS 2014 : The Ninth International Conference on Systems

as 1200 and 1000. Then, assigning a random value in each ri
for i = 1 to 4 and dj for j = 1 to 8 such that the sum of ri
is equal to 1200, that of dj, 1000, respectively. Note that it is
assumed that about 80% of each dj is supplied by G node in
this simulation. As a result, d′
j is set as the subtraction of gj
from dj. The total amount of surplus electricity is determined
by the difference of the sum of ri and that of dj, which is 200,
Based on this value, the value of si is given. This simulation
creates 2000 patterns of the set of si for i = 1 to 4 such that the
sum of si is 200. A pattern of si is, for instance, s1=37.54045,
s2=62.13593, s3=45.95469, s4=54.36893. Once the value of
si is given, set the value of r′
i, subtracting si from ri. Then,
decide rij such that transmission loss is minimized by means
of NWC and MODI method discussed in Section II-C. Note
that lossij is randomly assigned to each edge between RS
and D nodes with the value of the second decimal place in
the range shown in (6). This is because about 5% of electricity
would be lost during transmisison to consumer sides in general
although it depens on the distance it is transmitted.
0 < lossij ≤ 0.05
(6)
B. Simulation Result
A correlation between scattering of si and transmission loss
in Figure 3. In Figure 3, the horizontal axis describes the
standard deviation of the pattern of si, and the vertical axis
represents the transmission loss optimized by MODI.
Fig. 3.
Correlation between scattering of si and transmission loss.
As seen in Figure 3, when the value of standard deviation
of the pattern of si is close to 0, the transmission loss gets
the value close to the average and does not get the worst
value. In addition, the difference of the best and worst value
of the transmission loss is smaller as a standard deviation of
the pattern of si is close to 0.
This result may indicate that even if the amount of electric-
ity stored in several storage devices is smoothed by adjusting
electricity ﬂows, the transmission loss would almost take the
average value although it is not the best improved value.
IV. CONCLUSION AND FUTURE WORK
In summary, this paper formulates an electricity ﬂow op-
timization problem, presents its solution, and analyzes the
ﬂuctuation of transmission loss followed by the adjustment
of the amount of electricity stored in storage devices.
The simulation result implies that when the amount of
electricity stored in storage device is smoothed by adjusting
the electricity ﬂows, the value of the transmission loss almost
gets the mean value compared to other patterns. However, this
result comes out under a certain situation given in this paper,
and other resulst might be obtained in different situations. To
examine it, therefore, further simulation in various situations,
such as different node numbers and their values need to be con-
ducted. Moreover, since this paper does not cover all aspects
of prospective electricity supply system, there are remained
issues to make this research more practical. For example,
this paper assumes that each D node is connected to all RS
nodes in MG for the simpliﬁcation of the electricity ﬂow
optimization problem. Hence, the paper needs to reorganize
the structure of the MG which has less transmission lines by
considering the effective connections between D nodes and
RS nodes.
REFERENCES
[1] R. Ma, H Chen, Y. Huang, and W. Meng, “Smart grid communication:
its challenges and opportunities,” IEEE Trans on Smart Grid, vol. 4, no.
1, Mar. 2013, pp. 36-46.
[2] C. Ahn and H. Peng, “Decentralized voltage control to minimize
distribution power loss of microgrid,” IEEE Trans on Smart Grid, vol.
4, no. 3, Sep. 2013, pp. 1297-1304.
[3] A. Molderink, V. Bakker, M Bosman, J. Hurink, and G. Smit, “Man-
agement and control of domestic smart grid technology,” IEEE Trans
on Smart Grid, vol. 1, no. 2, Sep. 2010, pp. 109-119.
[4] T.L. Vandoorn, B. Zwaenepoel, J.D.M. De Kooning, B. Meersman,
and L. Vandevelde, “Smart microgrids and virtual power plants in
a hierarchical control structure, ” 2011 2nd IEEE PES international
Conference and Exhibition on Innovative Smart Grid Technologies, Dec.
2011, pp. 1-7.
[5] E. Sortomme and M.A. El-Sharkawi, “Optimal power ﬂow for a system
of microgrids with controllable loads and battery storage,” Power
Systems Conf and Exposition, Mar. 2009, pp. 1-5.
[6] J. P. Barton and D. G. Inﬁeld, “Energy storage and its use with
intermittent renewable energy,” IEEE Trans on Energy Conversion,
vol19, no. 2, Jun. 2004, pp. 441-448.
[7] K. M. Chandy, S.H. Low, U. Topcu, and H. Xu, “A simple optimal power
ﬂow model with energy storage,” Proc, of the 49th IEEE Conference on
Decision and Control, Dec. 2010, pp.1051-1057.
[8] T. Yau, L. Walker, H. Graham, and A.Gupta, “Effects of battery storage
devices on power system dispatch,” IEEE Trans on Power Apparatus
and Systems, vol. PAS-100, no. 1, Jan. 1981, pp. 375-383
[9] Y. Atwa and E. El-Saadany, “Optimal allocation of ESS in distribution
systems with a high penetration of wind energy,” IEEE Trans on Power
Syst, vol. 25, no. 4, Nov. 2010, pp. 1815-1822.
[10] K.C. Divya, “Battery energy storage technology for power systems,”
Electric Power System Research79, pp. 511-520, 2009.
[11] T. Shinji et al, “Evaluation of micro grid including power storage
device,” Journal of the Japan Institute of Energy, vol. 88, pp. 199-204,
2009.
[12] R. Schainker, “Executive overview: Energy storage options for a sustain-
able energy future,” IEEE Power Engineering Society General Meeting
2004, vol. 2, Jun. 2004, pp. 2309-2314
[13] Y.V. Makarov, D. pengwei,and M.C.W. Kintner-Meyer, “Sizing energy
storage to accommodate high penetration of variable energy resources,”
IEEE Trans on Sustainable Energy, vol. 3, no. 1, Jan. 2012, pp. 34-40.
[14] L. Winston, and B. Goldberg, “Operations research: applications and
algorithms,” Belmont:Thomson/Brooks/Cole, 2004, pp. 475-522.
31
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-319-3
ICONS 2014 : The Ninth International Conference on Systems

