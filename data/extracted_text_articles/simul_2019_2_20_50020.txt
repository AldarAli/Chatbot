Train Timetable Optimization for Parallel Single-track Sections 
During Track Closure 
 
Akio Hada 
Signalling and Transport Information Technology Division 
Railway Technical Research Institute 
Tokyo, Japan 
e-mail: hada.akio.71@rtri.or.jp 
Teodor Gradinariu 
Rail System Department 
International Union of Railways 
Paris, France 
e-mail: gradinariu@uic.org
 
 
Abstractâ€”In parallel single-track sections, which are common 
in high-speed railways in Europe, when one of the tracks is 
closed due to vehicle failure or maintenance work, the other 
track can be used for travel in both directions to avoid 
significant delays or cancellation of train operation. However, 
for bidirectional operation on some sections of a parallel single-
track line, it is necessary to adjust the original train timetable; 
usually, this adjustment causes some trains to be delayed. 
Therefore, in this study, we propose a mathematical model for 
train timetable planning when performing bidirectional 
operations on some parallel single-track sections to minimize the 
total delay of each train. 
Keywords-Parallel 
single-track; 
Track 
closure; 
Train 
timetable; Maintenance; Optimization. 
I. 
 INTRODUCTION 
In a railway operation site, there are cases in which tracks 
for some sections have to be closed due to vehicle or signal 
failure. In addition, there are cases where it is necessary to 
close a track for maintenance work. If a track closure occurs 
during business hours, it might have a severe negative impact 
on train operation, and in some circumstances, it may become 
necessary to cancel train operations all over. However, on a 
parallel single-track, in which single tracks capable of 
bidirectional operation are laid in parallel, even if one track is 
closed, it is possible to avoid significant train delays and 
cancellation of trains. For example, tracks of many European 
high-speed railways such as Train a Grande Vitesse (TGV) [1] 
and InterCity Express (ICE) [2] have parallel single-track 
sections; a cross section is provided approximately every 50 
km. Therefore, even if one of the tracks is closed, bidirectional 
operation can be performed on other tracks. 
When performing two-way operation on some sections of 
a parallel single-track line, it is usually necessary to adjust the 
normal train operation timetable (hereafter, simply referred to 
as the original timetable). During this time, if the delay of each 
train increases due to changes in the travel time, it disturbs 
passengers, respectively as well as rolling stock schedule and 
crew schedule. Therefore, it is desirable that the travel time 
adjustment, when performing bidirectional operation, is 
planned well to minimize the delay. 
Since track closure has significant impact on train 
operation, several studies for managing or planning a 
timetable during track closure have been carried out to date 
[3]-[9]. For example, [8] proposed the methodology to plan 
timetables in consideration of passenger services during track 
closure and [9] proposed the methodology to plan 
simultaneously the period of track closure and traffic flow. In 
these studies, it is acceptable to cancel train services during 
track closure. However, in practice, it may be required not to 
cancel train service and to plan a timetable sustaining the 
capacity in the original timetable during track closure. In this 
study, we propose a mathematical model for planning train 
timetable when performing bidirectional operation due to 
track closure to minimize total delay of each train without 
cancelling train services. We carry out simulations to verify 
the usefulness of the proposed mathematical model. 
This paper is organized as follows. Section â…¡ explains the 
problem definition of train timetable planning during track 
closure. Section â…¢ presents a mathematical formulation for 
the problem. Section â…£ provide simulation results for several 
track closure periods. We conclude the paper in Section â…¤. 
II. 
TRAIN TIMETABLE PLANNING DURING TRACK 
CLOSURE 
This section describes a problem definition of a train 
scheduling problem during track closure. 
A. Bidirectional Operation on a Parallel Single-track 
Section 
In parallel single-track sections capable of bidirectional 
operation, normal operation is carried out on two independent 
train routes with trains having different traveling directions. 
However, when a certain section of one route is closed, trains 
of that route are moved to the other route via a crossing line 
just before the closed section; they travel on that route and 
move to their original route via a crossing line at the end of 
the track closure. That is, when a certain section of one route 
is closed, two-way operation on the other route should be 
planned. Figure 1 shows an example of two independent 
Figure 1. Train paths on a parallel single-track section 
Train path 1 
Train path 2 
P1 
P2 
Q1 
Q2 
Connecting line 
32
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-756-6
SIMUL 2019 : The Eleventh International Conference on Advances in System Simulation

routes on a parallel single-track section, showing route 1 from 
left to right and route 2 from right to left in the case of normal 
operation. Further, P1 and P2 indicate the connection points of 
a crossing line on route 1, and Q1 and Q2 the connection points 
of a crossing line on route 2. Figure 2 is an example of a case 
where a track section between point P1 and point P2 is closed 
due to maintenance work; bidirectional operation between 
point Q1 and point Q2 is also shown as route 1 in Figure 1, 
which is then changed to route 3 in Figure 2 (trains on route 3 
travel in the order P1 ïƒ  Q2 ïƒ  Q1 ïƒ  P2).  
It is impossible for two trains with different traveling 
directions to simultaneously travel on a section on which 
bidirectional operation can be performed (hereafter, simply 
referred to as a bidirectional section). In other words, trains 
with the same travelling direction can continue running on a 
bidirectional section; however, if two trains with different 
traveling directions travel on a bidirectional section, train on 
one route needs to wait for the train on the other route to pass. 
Therefore, it is necessary for the train timetable on a 
bidirectional section to be planned by considering the trains 
with different traveling directions. 
B. Train Scheduling Problem During Track Closure 
There is a concern that passenger dissatisfaction will 
increase due to an increase in the congestion rate of trains due 
to longer operation intervals if trains are cancelled when 
performing a bidirectional operation. In addition, if the order 
of trains is changed, it will interfere with the vehicle operation 
schedule and the crew schedule. Moreover, if the operation 
time of each train is advanced, passengers may not be able to 
get on the scheduled trains. Therefore, the following 
assumptions with respect to a train schedule are made when 
bidirectional operation is performed due to track closure. 
1. Trains will not be canceled. 
2. The train operation sequence will be maintained as per the 
original timetable. 
3. The operation time of each train will be the same as or later 
than the original timetable. 
 
Further, the following assumptions are made with respect 
to track closure section and period (start time to end time of 
track closure). 
 
4. Only one track is closed on a certain section. 
5. The track closure section is between the crossing that is 
before the section closed for maintenance and the next 
crossing (section between points P1 and P2 in Figure 2). 
6. A train will not be in the track closure section during the 
track closure period. 
From assumption 6, for a route with a closed track section, 
a train traveling on the track closure section during the track 
closure period will be moved to the other track in the 
bidirectional section. Then, the following assumptions are 
made for routes 1, 2, and 3 in Figures 1 and 2. 
7. Trains traveling on the track closure section on route 1 
during the track closure period as per the original timetable 
travel on route 3 until the track closure ends and on route 
1 after the track closure ends. 
8. Trains traveling on the track closure section on route 2 
during the track closure period as per the original timetable 
always travel on the same route. 
Moreover, to smoothing the delay time from the original 
timetable of each train, it is necessary to plan such that the 
delay of each train is within a certain limit. Then, the 
following assumption is made. 
9. The delay time of each train has an upper limit. 
The problem to be addressed in this study is to plan the 
train timetable when performing bidirectional operation 
during track closure to minimize the total delay of each train 
under the above conditions. For this, the following times, 
shown in Figure 2, need to be planned. 
ï‚ 
The time when trains traveling on the track closure section 
on route 1 during the track closure period as per the 
original timetable pass point P1 
ï‚ 
The time when trains traveling on the track closure section 
on route 2 during the track closure period as per the 
original timetable pass point Q1 
As described above, the timetable of the bidirectional 
section must be planned considering train schedules of routes 
with different directions simultaneously. On the contrary, a 
train timetable, not on a bidirectional section, can 
independently adjust train schedules of one-directional routes. 
Therefore, we assume that, after planning a train schedule for 
a bidirectional section, the timetable for other sections can be 
adjusted for each route for synchronization. In the following, 
we also assume that the track closure section and track closure 
period are given. 
III. 
FORMULATION OF A TRAIN TIMETABLE PLANNING 
PROBLEM 
This section describes a mathematical formulation of a 
train timetable planning problem defined in Section â…¡. 
A. Terminology 
The following terms are defined with respect to Figures. 1 
and 2. For an original timetable of route 1, let ïˆï€±ï€ ï€½ï€ ï»ï€±ï€¬ï€²ï€¬ï‚¼ï€¬ï­ï½ 
be the set of all trains traveling on the track closure section 
(between points P1 and P2) during the track closure period. 
For an original timetable of route 2, let ïˆï€²ï€ ï€½ï€ ï»ï­ï€ ï€«ï€ ï€±ï€¬ï€ ï­ï€ ï€«ï€ ï€²ï€¬ï€ ï‚¼ï€¬ï€ 
ï­ï€ ï€«ï€ ï®ï½ be the set of all trains traveling on the bidirectional 
section (between points Q1 and Q2) during the track closure 
Figure 2. Change of the route of train path 1 due to track maintenance 
resulting in track closure 
Train path 3 
Train path 2 
P1 
P2 
Q1 
Q2 
Bi-directional section 
Track maintenance section 
33
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-756-6
SIMUL 2019 : The Eleventh International Conference on Advances in System Simulation

period. We also let ïˆï€ ï€½ï€ ïˆï€±ï€ ïƒˆï€ ïˆï€². Note that the operation 
sequence, according to the original timetable, of trains 
included in ïˆï€± and ïˆï€² is 1ï‚®2ï‚®ï‚¼ï‚®ï­ and ï­ + 1ï‚®ï€ ï­ + 
2ï‚®ï‚¼ï‚®ï­ï€ ï€«ï®, respectively. For example, the track closure 
period is assumed to be from 13:10 to 15:10 and the time 
required for trains on route 1 to travel on the track closure 
section and the time required for trains on route 2 to travel on 
the bidirectional section is 1 hour. In this case, if trains passing 
through point P1 at the following times exist in the original 
timetable of route 1, then trains passing point P1 at the times 
indicated by the solid underline are included in ïˆï€±. 
11:30, 12:00, 12:30, 13:00, 13:30, 14:00, 14:30, 15:00, 
15:30, 16:00 
Moreover, if trains passing through point Q1 at the 
following times exist in the original timetable of route 2, then 
trains passing point Q1 at the times indicated by the dotted 
underline are included in ïˆï€². 
11:35, 12:05, 12:35, 13:05, 13:35, 14:05, 14:35, 15:05, 
15:35, 16:05 
It should be noted that trains passing through point P1 
(respectively, point Q1) before the start time of the track 
closure period are also included in ïˆï€± (respectively, ïˆï€²). 
In Section â…¡, when the track between points P1 and P2 of 
route 1 is closed, we set up a problem to determine the times 
for passing through point P1 for trains included in ïˆï€± and times 
for passing through point Q1 for trains included in ïˆï€² to 
minimize the total delay of all trains. In the following, we 
formulate this problem into a mathematical programming 
problem. Here, from assumptions 7 and 8 in Section â…¡, trains 
in ïˆï€± are scheduled to travel on route 3 until the end time of 
track closure and are scheduled to travel on route 1 after the 
end time of track closure. On the other hand, trains in ïˆï€² are 
always scheduled to travel on route 2. 
The following times defined below are assumed to be 
given. 
ï¶ï¨ï€ : The time required for train ï¨ïƒïˆï€± to travel from point P1 
to point P2 on route 3 or for train ï¨ïƒïˆï€² to travel from 
point Q1 to point Q2 of route 2 (traveling time) 
ï·ï¨ï€ : The time required for switching the travel route from 
route 3 to route 2 for train ï¨ïƒïˆï€± and from route 2 to 
route 3 for train ï¨ïƒïˆï€² (route switching time) 
ï¡ï¨ï€ : The time interval from the time train ï¨ï€ ï€¨ï‚¹ï­ï€©ïƒïˆï€±  passes 
through point P1 to the time when the following train 
ï¨ï€ ï€«ï€ ï€±ïƒïˆï€± passes through point P1 or from the time when 
train ï¨ï€ ï€¨ï‚¹ï­ï€ ï€«ï€ ï®ï€©ïƒïˆï€² passes through point Q2 to the time 
when the following train ï¨ï€ ï€«ï€ ï€±ïƒïˆï€² passes through point 
Q2 (minimum headway) 
ï¤ï¨ï€ : The upper limit of the permissible delay time of train 
ï¨ïƒïˆ (permissible delay time) 
Here, it is assumed that the times defined above are in 
minutes and are all non-zero. In addition, it is assumed that 
traveling time ï¶ï¨ is defined considering the speed regulation 
in a section including switches, reduced speed operation on a 
maintenance section, etc., and that minimum headway ï¡ï¨ is 
defined considering the running speed of each train, various 
restrictions on train operation, etc. 
In the original timetable of trains included in ğ», train 1 
passes through point P1 first, and train ï­ï€ ï€«ï€ ï€± passes through 
point Q1 first. If we let ï³ï‚¢ be the first time when train 1 passes 
point P1 and the time when train ï­ï€ ï€«ï€ ï€± passes through point 
Q1 in the original timetable, we only need to take time ï³ï‚¢ and 
later into consideration in our problem. Therefore, we define 
ï”ï€±ï€ ï€½ï€ ï»ï€±ï€¬ï€²ï€¬ï‚¼ï€¬ï«ï½ as the set of times with one-minute intervals 
from ï³ï‚¢ to the end time of the track closure. Here, the first 
element of ï”ï€± represents time ï³ï‚¢ and the ï«th element 
represents the end time of track closure. For example, if time 
ï³ï‚¢ is 12:00 and the end time of the track closure is 15:00, then 
the elements 1, 2 and 3 of ï”ï€± will be 12:00, 12:01, and 12:02, 
respectively, and element ï«ï€ ï€½ï€ ï€±ï€¸ï€± of ï”ï€± indicates the end time 
of track closure, i.e., 15:00. We also define the following. 
ï³ï¨: The time in ï”ï€± when train ï¨ïƒïˆï€± passes through point P1 
in the original timetable of route 1 or when train ï¨ïƒïˆï€² 
passes point Q1 in the original timetable of route 2. 
For example, if ï³ï‚¢ is 12:00 and the time when train ï¨ïƒïˆï€± 
passes through point P1 in the original timetable is 13:10, then 
ï³ï¨ï€ ï€½ï€ ï€·ï€±ï€® 
In the original timetable of trains included in ïˆ, train ï­ 
passes through point P1 last and train ï­ï€ ï€«ï® passes through 
point Q1 last. On the other hand, from assumption 9 in Section 
â…¡, the delay of train ï¨ïƒïˆ must be less than or equal to ï¤ï¨. 
Therefore, if we let ï´ï‚¢ (note that it is the time in ï”ï€±) to be the 
later time between ï³ï­ï€ ï€«ï€ ï¤ï­ and ï³ï­ï€ ï€«ï®ï€ ï€«ï€ ï¤ï­ï€ ï€«ï®, in addition to ï”ï€± 
previously defined, we only need to take the time interval 
from ï«ï€«ï€± to ï´ï‚¢ into consideration for our problem. However, 
depending on the problem, there exist cases where time ï´ï‚¢ is 
earlier 
than 
time 
ï«ï€«ï€±. 
Therefore, 
we 
also 
set 
ï¬ï€ ï€½ï€ maxï»ï´ï‚¢ï€¬ï€ ï«ï€«ï€±ï½. Moreover, let ï”ï€²ï€ ï€½ï€ ï»ï€ ï«ï€«ï€±ï€¬ï€ ï«ï€«ï€²ï€¬ï‚¼ï€¬ï¬ï½ be 
the set of times of one-minute intervals from time ï«ï€«ï€± to ï¬, 
and ï”ï€ ï€½ï€ ï”ï€±ïƒˆï”ï€². 
B. Definition of the Train Scheduling Problem 
Let ïï€ ï€½ï€ ïˆï€ ï‚´ï” be the set of direct products of the set of 
trains ïˆ and the set of times ï”; the subsets of ï that restrict 
the set of train ïˆ to ïˆï€± and ïˆï€² are defined as follows. 
ï€ 
ïï€±ï€ ï€½ï€ ï»ï€¨ï¨ï€¬ï´ï€©ïƒïï€ ï¼ï€ ï¨ïƒïˆï€±ï€¬ï€ ï´ïƒï”ï½ï€ 
ï€ 
ïï€²ï€ ï€½ï€ ï»ï€¨ï¨ï€¬ï´ï€©ïƒïï€ ï¼ï€ ï¨ïƒïˆï€²ï€¬ï€ ï´ïƒï”ï½ 
Furthermore, variable ï¸ï¨ï´ is assigned to element ï€¨ï¨ï€¬ï´ï€© of 
ï. Variables ï¸ï¨ï´ï€¬ ï€¨ï¨ï€¬ï´ï€©ïƒï is 1 if the train ï¨ïƒïˆï€±ï€ ï€¨ï¨ïƒïˆï€²ï€© 
passes through point P1 (Q1) at time ï´ïƒï” and is 0 otherwise. 
Here, the total number of variables ï¸ï¨ï´ is ï¼ïï¼ï€ ï€½ï€ ï€¨ï­ï€ ï€«ï®ï€©ï€ ï‚´ï€ ï¬. 
As mentioned previously, trains in the original timetable 
were assumed to not be canceled. Therefore, train ï¨ïƒïˆ must 
be planned to pass through point P1 or point Q1 at any time 
34
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-756-6
SIMUL 2019 : The Eleventh International Conference on Advances in System Simulation

between 1 and ï¬. That is, variables ï¸ï¨ï´ must satisfy the 
following. 
ï€ 
ïƒ¥ï€±ï€ ï‚£ï€ ï´ï€ ï‚£ï€ ï¬ï€ ï¸ï¨ï´ï€ ï€ ï€½ï€ ï€±ï€¬ï€ ï¨ïƒïˆ  
(1) 
In addition, it was assumed that the operation time of each 
train must be the same as or later than the original operation 
time and that the delay of each train should not exceed the 
permissible delay. Therefore, train ï¨ïƒïˆ  must be planned to 
pass through point P1 or point Q1 at any time from ï³ï¨ to 
ï³ï¨ï€ ï€«ï€ ï¤ï¨. That is, let ï¢ï¨ï€ ï€½ï€ ï³ï¨ï€ ï€«ï€ ï¤ï¨ï€¬ï€ ï¨ïƒïˆ, variables ï¸ï¨ï´ must 
satisfy the following. 
ï€ 
ïƒ¥ï³ï¨ï€ ï‚£ï€ ï´ï€ ï‚£ï€ ï¢ï¨ï€ ï¸ï¨ï´ï€ ï€ ï€½ï€ ï€±ï€¬ï€ ï¨ïƒïˆ 
(2) 
Furthermore, the train operation sequence is assumed to 
be maintained as per the original timetable. Therefore, all 
trains operated before train ï¨ïƒïˆï€±ï€ ï€¨ï¨ï€ ï‚¹ï€ ï€±ï€© must pass through 
point P1 before time ï´ in order for train ï¨ to pass through 
point P1 at time ï´. Similarly, all trains operated before train 
ï¨ïƒïˆï€²ï€ ï€¨ï¨ï€ ï‚¹ï€ ï­ï€ ï€«ï€±ï€© must pass through point Q1 before time ï´ï€ for 
train ï¨ to pass through point Q1 at time ï´. Here, for the first 
train in ïˆï€± and first train ï­ï€ ï€«ï€± in ïˆï€², there is no need to 
consider the above constraints. Moreover, because only those 
trains can pass through point P1 or point Q1 at time 1, it is not 
necessary for trains passing through point P1 or point Q1 to 
consider the above constraints. Now, we define the subset of 
ïï€± obtained by subtracting the elements for the case ï¨ï€ ï€½ï€± and 
the case ï´ï€ ï€½ï€± and the subset of ïï€² obtained by subtracting the 
elements for the case ï¨ï€ ï€½ï€ ï­ï€ ï€«ï€ ï€± and the case ï´ï€ ï€½ï€ ï€± as follows. 
ï€ 
ïï‚¢ï€±ï€ ï€½ï€ ï»ï€¨ï¨ï€¬ï´ï€©ïƒïï€±ï€ ï€ ï¼ï€ ï¨ï€ ï‚¹ï€ ï€±ï€¬ï€ ï´ï€ ï‚¹ï€±ï½ï€ 
ï€ 
ïï‚¢ï€²ï€ ï€½ï€ ï»ï€¨ï¨ï€¬ï´ï€©ïƒïï€²ï€ ï€ ï¼ï€ ï¨ï€ ï‚¹ï€ ï­ï€ ï€«ï€ ï€±ï€¬ï€ ï´ï€ ï‚¹ï€±ï½ï€ 
Then, the constraint condition on the train operation 
sequence is expressed as follows. 
ï€ 
ïƒ¥ï€±ï€ ï‚£ï´ï‚¢ï€ ï€¼ï´ï€ ï¸ï¨ï‚¢ï´ï‚¢ï€ ï€ ï‚³ï€ ï¸ï¨ï´ï€¬ï€ ï€ ï€ ï€ ï€±ï‚£ï¨ï‚¢ï€ ï€¼ï¨ï€¬ï€ ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï€±ï€ 
ï€¨ï€³ï€©ï€ 
ï€ 
ïƒ¥ï€±ï€ ï‚£ï´ï‚¢ï€ ï€¼ï´ï€ ï¸ï¨ï‚¢ï´ï‚¢ï€ ï€ ï‚³ï€ ï¸ï¨ï´ï€¬ï€ ï€ ï€ ï€ ï­ï€ ï€«ï€ ï€±ï‚£ï¨ï‚¢ï€ ï€¼ï¨ï€¬ï€ ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï€²ï€ 
ï€¨ï€´ï€© 
From the definition of ïï‚¢ï€±ï€¬ï€ ïï‚¢ï€² for any ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï€± in (3) 
and any ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï€² in (4), there exists ï¨ï‚¢ï€  where ï€±ï‚£ï¨ï‚¢ï€ ï€¼ï¨ and 
ï¨ï‚¢ï€ ï€ where ï€±ï‚£ï¨ï‚¢ï€ ï€¼ï¨, respectively. Figure 3 shows an example 
in 
which 
ïˆï€±ï€ ï€½ï€ ï»ï€±ï€¬ï€²ï€¬ï€³ï€¬ï€´ï½, 
ï”ï€±ï€ ï€½ï€ ï»ï€±ï€¬ï€²ï€¬ï‚¼ï€¬ï€±ï€°ï½, 
and 
ï”ï€²ï€ ï€½ï€ ï»ï€±ï€±ï€¬ï€±ï€²ï€¬ï‚¼ï€¬ï€±ï€µï½, and the element of row ï¨ and column ï´ 
represents variable ï¸ï¨ï´. Note that the rows corresponding to 
ïˆï€² are omitted. In addition, the gray parts indicate variables 
ï¸ï¨ï´ï€¬ ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï€±. In Figure 3, in the case in which train 3 passes 
point P1 at time 5 is when ï¸ï€³ï€µï€ ï€½ï€ ï€±; the variables surrounding 
the bold frame must satisfy ï¸ï€±ï€±ï€ ï€«ï¸ï€±ï€²ï€ ï€«ï¸ï€±ï€³ï€ ï€«ï¸ï€±ï€´ï€ ï€½ï€± and 
ï¸ï€²ï€±ï€ ï€«ï¸ï€²ï€²ï€ ï€«ï¸ï€²ï€³ï€ ï€«ï¸ï€²ï€´ï€ ï€½ï€±. 
Next, we consider the headway between trains. From the 
definition of minimum headway ï¡ï¨, when train ï¨ï€ ï€¨ï€ ï‚¹ï€ ï­ï€©ï€ ïƒïˆï€± 
passes through point P1 at time ï´ï€ ïƒï”, the following train 
ï¨ï€ ï€«ï€±ïƒïˆï€± cannot pass through point P1 before time ï´ï€ ï€«ï€ ï¡ï¨. 
Similarly, when train ï¨ï€ ï€¨ï€ ï‚¹ï€ ï­ï€ ï€«ï®ï€©ï€ ïƒïˆï€² passes through point Q1 
at time ï´ï€ ïƒï”, the following train ï¨ï€ ï€«ï€±ïƒïˆï€² cannot pass through 
point Q1 before time ï´ï€ ï€«ï€ ï¡ï¨. Note that the last train ï­ in ïˆï€± and 
the last train ï­ï€ ï€«ï® in ïˆï€² are not included in the problem. We 
define a subset of ğ´ where the elements in case of ï¨ï€ ï€½ï€ ï­ and 
ï¨ï€ ï€½ï€ ï­ï€ ï€«ï€ ï® are excluded as follows. 
ï€ 
ïï‚¢ï‚¢ï€½ï€ ï»ï€¨ï¨ï€¬ï´ï€©ïƒïï€ ï€ ï¼ï€ ï¨ï€ ï‚¹ï€ ï­ï€¬ï€ ï­ï€ ï€«ï®ï½ 
Moreover, depending on time ï´ and minimum headway ï¡ï¨, 
ï´ï€ ï€«ï€ ï¡ï¨ may exceed the last time ï¬ in ï”; we introduce the 
following: 
ï€ 
ï¡ï€ ï€¨ï¨ï€¬ï€ ï´ï€©ï€ ï€½ï€ minï»ï€ ï´ï€ ï€«ï€ ï¡ï¨ï€¬ï€ ï¬ï€ ï€«ï€ ï€±ï½ï€¬ï€ ï€ ï€ ï€ ï€¨ï¨ï€¬ï€ ï´ï€ ï€©ïƒïï‚¢ï‚¢ï€ 
Then, the constraint conditions on the operation time 
interval are expressed as follows. In (5), from the definition of 
ïï‚¢ï‚¢ and ï¡ï¨ï€ ï€¾ï€ ï€°, there always exist ï¨ï€ ï€«ï€± and ï´ï€ ï‚¢ satisfying 
ï´ï€ ï€ ï‚£ï€ ï´ï€ ï‚¢ï€¼ï€ ï¡ï€¨ï¨ï€¬ï€ ï´ï€©ï€ for an arbitrary ï€¨ï¨ï€¬ï€ ï´ï€©ïƒïï‚¢ï‚¢. 
ï€ 
ïƒ¥ï€ ï´ï€ ï‚£ï´ï‚¢ï€ ï€¼ï¡ï€¨ï¨ï€¬ï´ï€©ï€ ï¸ï¨ï€ ï€«ï€±ï€¬ï´ï‚¢ï€ ï€ ï€«ï€ ï¸ï¨ï´ï€ ï‚£ï€ ï€±ï€¬ï€ ï€ ï€ ï€ ï€¨ï¨ï€¬ï€ ï´ï€©ïƒïï‚¢ï‚¢ 
(5) 
As mentioned above, trains with different traveling routes 
cannot travel on a bidirectional section at the same time. 
Therefore, in cases that train ï¨ï‚¢ïƒïˆï€²ï€ travels after train ï¨ï€ ïƒïˆï€±   
or that train ï¨ï‚¢ïƒïˆï€± travels after train ï¨ï€ ïƒïˆï€² on a bidirectional 
section, train ï¨ï‚¢ can travel on the bi-directional section only 
after a train ï¨ passes through the bidirectional section. Note 
that trains included in ïˆï€± and ïˆï€² travel on a bidirectional 
section until the track closure time ends. Thus, let ïï€± and ïï€² 
be limited to the time until track closure ends, and set 
ïï‚¢ï‚¢ï‚¢ï€±ï€½ïˆï€±ï‚´ï”ï€± and ïï‚¢ï‚¢ï‚¢ï€²ï€½ïˆï€²ï‚´ï”ï€±. The time required for train 
ï¨ï€ ïƒïˆ to travel on a bidirectional section is ï¶ï¨ and the time 
required for switching the travel route after train ï¨ passes 
through the bidirectional section is ï·ï¨. Therefore, if train 
ï¨ïƒïˆï€± passes through point P1 at time ï´ï€ ïƒï”ï€±, train ï¨ï‚¢ïƒïˆï€² can 
pass through point Q1 only after time ï´ï€ ï€«ï€ ï¶ï¨ï€ ï€«ï€ ï·ï¨. Similarly, 
if train ï¨ïƒïˆï€²ï€ passes through point Q1 at time ï´ï€ ïƒï”ï€±, train 
ï¨ï‚¢ïƒïˆï€± can pass through point P1 only after time ï´ï€ ï€«ï€ ï¶ï¨ï€ ï€«ï€ ï·ï¨. 
Note that depending on traveling time ï¶ï¨ and route switching 
time ï·ï¨, ï´ï€ ï€«ï€ ï¶ï¨ï€ ï€«ï€ ï·ï¨ may exceed the last time ï¬ in ï”; we 
introduce the following: 
ï€ 
ï¥ï€ ï€¨ï¨ï€¬ï€ ï´ï€©ï€ ï€½ï€ minï»ï€ ï´ï€ ï€«ï€ ï¶ï¨ï€ ï€«ï€ ï·ï¨ï€¬ï€ ï¬ï€ ï€«ï€ ï€±ï½ï€¬ï€ ï€ ï€ ï€ ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï‚¢ï‚¢ï€±ï€ 
On the other hand, from assumption 7 in Section â…¡, trains 
included in ïˆï€± travel on original route 1 as soon as the track 
closure ends. Therefore, when train ï¨ïƒïˆï€² travels on the 
bidirectional section, we need to consider the constraint 
conditions for train ï¨ï‚¢ïƒïˆï€± mentioned above until time ï« when 
the track closure ends; we do not need to consider it after time 
ï«ï€ ï€«ï€ ï€±. Here, we introduce the following. 
Figure 3. Constraints on train operation sequences 
ï¸ï€±ï€± ï¸ï€±ï€² ï¸ï€±ï€³ ï¸ï€±ï€´ 
ï¸ï€²ï€± ï¸ï€²ï€² ï¸ï€²ï€³ ï¸ï€²ï€´ 
ï¸ï€³ï€µï€ ï€½ï€ ï€± 
ïˆï€± 
ï€±ï€ 
ï€²ï€ 
ï€³ï€ 
ï€´ï€ 
ï€±ï€ 
ï€²ï€ 
ï”ï€± 
ï”ï€² 
ï€³ï€ 
ï€´ï€ 
ï€µï€ 
ï€¶ï€ 
ï€·ï€ 
ï€¸ï€ 
ï€¹ï€  ï€±ï€°ï€  ï€±ï€±ï€  ï€±ï€²ï€  ï€±ï€³ï€  ï€±ï€´ï€  ï€±ï€µï€ 
35
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-756-6
SIMUL 2019 : The Eleventh International Conference on Advances in System Simulation

ï€ 
ï¦ï€ ï€¨ï¨ï€¬ï€ ï´ï€©ï€ ï€½ï€ minï»ï€ ï´ï€ ï€«ï€ ï¶ï¨ï€ ï€«ï€ ï·ï¨ï€¬ï€ ï«ï€ ï€«ï€ ï€±ï½ï€¬ï€ ï€ ï€ ï€ ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï‚¢ï‚¢ï€² 
Then, the constraint conditions for preventing the trains 
included in ïˆï€± and ïˆï€² from simultaneously traveling on the 
bidirectional section are expressed as follows. 
ï€ 
ïƒ¥ï´ï€ ï‚£ï´ï‚¢ï€ ï€¼ï€ ï¥ï€ ï€¨ï¨ï€¬ï€ ï´ï€©ï€ ï¸ï¨ï‚¢ï´ï‚¢ï€ ï€ ï€«ï€ ï¸ï¨ï´ï€ ï‚£ï€ ï€±ï€¬ï€ ï€ ï€ ï€ ï¨ï‚¢ï€ ïƒïˆï€²ï€¬ï€ ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï‚¢ï‚¢ï€± 
(6) 
ï€ 
ïƒ¥ï´ï€ ï‚£ï´ï‚¢ï€ ï€¼ï€ ï¦ï€ ï€¨ï¨ï€¬ï€ ï´ï€©ï€ ï¸ï¨ï‚¢ï´ï‚¢ï€ ï€ ï€«ï€ ï¸ï¨ï´ï€ ï‚£ï€ ï€±ï€¬ï€ ï€ ï€ ï€ ï¨ï‚¢ï€ ïƒïˆï€±ï€¬ï€ ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï‚¢ï‚¢ï€² 
(7) 
From 
ï¶ï¨ï€¬ï€ ï·ï¨ï€ ï€¾ï€ ï€°, 
there 
always 
exist 
ï´ï‚¢ 
where 
ï´ï€ ï‚£ï´ï‚¢ï€ ï€¼ï€ ï¥ï€ ï€¨ï¨ï€¬ï€ ï´ï€© for any ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï‚¢ï‚¢ï€± in (6), and ï´ï‚¢ where 
ï´ï€ ï‚£ï´ï‚¢ï€ ï€¼ï€ ï¦ï€ ï€¨ï¨ï€¬ï€ ï´ï€© for any ï€¨ï¨ï€¬ï´ï€©ïƒïï‚¢ï‚¢ï‚¢ï€² in (7). Figure 4 shows an 
example in which ïˆï€²ï€ ï€½ï€ ï»ï€µï€¬ï€¶ï€¬ï€·ï½ is added to Figure 3. If we set 
ï¸ï€²ï€³ï€ ï€½ï€ ï€± when ï¶ï€²ï€ ï€½ï€ ï€³ and ï·ï€²ï€ ï€½ï€ ï€± in Figure 4, equation (6) shows 
that all shaded variables must be set to 0. That is, when train 
2 passes through point P1 at time 3, it indicates that trains 
included in ïˆï€²ï€  cannot pass through point Q1 from time 3 to 6. 
In addition, if we set ï¸ï€¶ï€¸ï€ ï€½ï€ ï€± when ï¶ï€¶ï€ ï€½ï€ ï€´ and ï·ï€¶ï€ ï€½ï€ ï€± in Figure 
4, equation (7) shows that the gray variables must be set to 0. 
Here, because the trains included in ïˆï€± can travel on original 
route 1 as soon as the track closure ends, the constraint 
conditions given by (7) are not imposed for the black variables. 
Based on this, the problem defined in this section is 
formulated into the following mathematical programming 
problem (P). 
(P) Minimize ïƒ¥ï¨ïƒïˆï€ ïƒ¥ï´ïƒï”ï€ ï€¨ï´ï€ ï€­ï€ ï³ï¨ï€©ï¸ï¨ï´ï€  
 
(8) 
 Subject to: Equations (1) - (7) 
ï¸ï¨ï´ï€ ïƒï€ ï»ï€°ï€¬ï€ ï€±ï½ï€¬ï€ ï€ ï€ ï€¨ï¨ï€¬ï€ ï´ï€©ïƒï 
 
(9) 
In this problem (P), equation (8) is the objective function 
to minimize the sum of the delay of each train. Equation (9) is 
the binary condition of the decision variable. Here, the 
problem to minimize the maximum delay of each train, not the 
total delay time of each train, can be formulated as the 
following mathematical programming problem (Q) by 
introducing the variable ï¹ï€ ï€¨ï€ ï‚³ï€ ï€°ï€©. 
(Q) Minimize 
ï¹ 
 
 
 Subject to: Equations (1) - (7), (9) 
ïƒ¥ï´ïƒï”ï€ ï€¨ï´ï€ ï€­ï€ ï³ï¨ï€©ï¸ï¨ï´ï€ ï€ ï‚£ï€ ï¹ï€¬ï€ ï€ ï¨ïƒïˆ  
(10) 
For the problem (P), there may not exist any feasible 
solution. However, the absence of a feasible solution shows 
that it is impossible to adjust the original timetable under the 
given parameter settings. In other words, in this case, it shows 
that measures such as extending the permissible delay time, 
shortening the minimum headway, or changing the period 
track closure are necessary. For train operation during track 
closure, it is also important to determine whether a feasible 
solution exists for the problem (P) for a given parameter 
setting. On the other hand, recent mathematical programming 
software are becoming faster every year. It is possible to 
determine the existence of a feasible solution and the 
calculation of an optimal solution for the problem with actual 
scale of parameters in relatively short time. Therefore, it is 
possible to use mathematical programming software such as 
Gurobi or MATLAB to determine the existence of a feasible 
solution and the calculation of an optimal solution for 
problems (P) and (Q). 
IV. 
SIMULATIONS 
In this section, we describe the results of a simulation 
executed to examine the variation in total delay time when the 
track closure period are 3 hours, 6 hours and 9 hours. In the 
simulations to be described, we set the parameters as follows. 
ï‚ 
The unit time is one minute. 
ï‚ 
Trains on the route 1 pass point P1 at the time 7:31, 8:01, 
9:01, 9:31, 10:31, 11:31, 12:31, 13:01, 13:31, 15:01, 15:31, 
16:31, 17:31, 18:31, 19:01, 19:31, 20:31, 21:31 as per the 
original timetable. 
ï‚ 
Trains on the route 2 pass point Q1 at the time 5:59, 7:20, 
8:14, 8:50, 9:43, 10:43, 11:50, 12:20, 12:43, 13:50, 14:41, 
15:50, 16:20, 16:50, 17:50, 18:20, 18:50, 19:20, 20:20 as 
per the original timetable. 
ï‚ 
We set the input parameters ï¶ï¨ï€ ï€½ï€ ï€²ï€°ï€¬ï€ ï¨ïƒïˆï€¬ï€ ï·ï¨ï€ ï€½ï€ ï€±ï€¬ï€ ï¨ïƒïˆï€ ï€¬ 
ï€ ï¡ï¨ï€ ï€½ï€ ï€²ï€¬ï€ ï¨ïƒïˆï€ ï€­ï€ ï»ï­ï€¬ï€ ï­ï€ ï€«ï€ ï®ï½ï€¬ï€ ï¤ï¨ï€ ï€½ï€ ï€³ï€°ï€¬ï€ ï¨ïƒïˆï€ respectively. 
Table â… , Table â…¡ and Table â…¢ show the results of the track 
closure periods 3 hours, 6 hours and 9 hours, respectively. For 
Table â… , Table â…¡ and Table â…¢ to be presented later the 
following should be noted. 
ï‚ 
ï·start is the start time of track closure. 
ï‚ 
ï·end is the end time of track closure. 
ï‚ 
ï¼ïˆï€±ï¼ï€ and ï¼ïˆï€²ï¼ are the number of trains in ïˆï€± and ïˆï€², 
respectively. 
ï‚ 
ï¼ï”ï€ ï¼ï€ is the number of elements in ï”. 
ï‚ 
ï¤total is the optimal solution value of the problem (P). 
ï‚ 
ï¤ave is the average delay time defined by ï¤aveï€ ï€½ï€ ï¤totalï€ ï€¯ ï¼ïˆï€ ï¼ï€® 
ï‚ 
time is the computational time to judge the existence of a 
feasible solution of the problem (P) or calculate the 
optimal solution of the problem (P). 
ï‚ 
We implemented simulations using Gurobi Optimizer 
8.1.0 on a personal computer having the following 
specification, IntelÂ® Coreâ„¢ i7-6700 CPU 3.40GHz, 
8.00GB RAM, running Windows 10 Pro. 
From Tables â…  to â…¢, the average delay time for track 
closure period of 3 hours, 6 hours and 9 hours are respectively 
6.24s, 6.38s and 6.32s and there are not significant differences 
between those. In general, it is more economical for track 
Figure 4. Constraints on switching train paths 
ïˆï€± 
ï€±ï€ 
ï€²ï€ 
ï€³ï€ 
ï€´ï€ 
ï€±ï€ 
ï€²ï€ 
ï”ï€± 
ï”ï€² 
ï€³ï€ 
ï€´ï€ 
ï€µï€ 
ï€¶ï€ 
ï€·ï€ 
ï€¸ï€ 
ï€¹ï€  ï€±ï€°ï€  ï€±ï€±ï€  ï€±ï€²ï€  ï€±ï€³ï€  ï€±ï€´ï€  ï€±ï€µï€ 
ï€µï€ 
ï€¶ï€ 
ï€·ï€ 
ïˆï€² 
ï¸ï€²ï€³ï€ ï€½ï€ ï€± 
ï¸ï€¶ï€¸ï€ ï€½ï€ ï€± 
36
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-756-6
SIMUL 2019 : The Eleventh International Conference on Advances in System Simulation

maintenance work to perform a few long-term work rather 
than many short-term work. Therefore, in the original 
timetable in this simulation, it is considered to be more 
economical to plan long-term work rather than short-term 
work. In this way, the mathematical model proposed in this 
paper can be used to find a cost-effective maintenance plan. 
Figure 5 shows the results calculated by the proposed 
mathematical model in the case track closure period 10:00-
16:00 in Table â…¡. In Figure 5, the vertical and horizontal axes 
means distance (or train position) and time, respectively,  
TABLE I.  
SIMULATION RESULTS FOR TRACK CLOSURE 
PERIOD OF 3 HOURS 
ï·start 
ï·end 
ï¼ïˆï€±ï¼ 
ï¼ïˆï€²ï¼ 
ï¼ï”ï€ ï¼ 
ï¤total 
ï¤ave 
time 
  6:00 
  9:00 
3 
1 
120 
21 
5.25 
0.21 
  7:00 
10:00 
4 
3 
177 
45 
6.43 
1.13 
  8:00 
11:00 
4 
3 
184 
42 
6.00 
1.28 
  9:00 
12:00 
4 
4 
184 
59 
7.38 
1.70 
10:00 
13:00 
4 
4 
213 
52 
6.50 
1.94 
11:00 
14:00 
4 
3 
158 
52 
7.43 
1.05 
12:00 
15:00 
4 
4 
184 
35 
4.38 
1.64 
13:00 
16:00 
4 
4 
184 
36 
4.50 
1.72 
14:00 
17:00 
3 
4 
181 
33 
4.71 
1.27 
15:00 
18:00 
4 
3 
184 
51 
7.29 
1.30 
16:00 
19:00 
4 
4 
186 
57 
7.13 
1.64 
17:00 
20:00 
4 
4 
154 
60 
7.50 
1.40 
18:00 
21:00 
4 
5 
181 
60 
6.67 
2.18 
 
TABLE II.  
SIMULATION RESULTS FOR TRACK CLOSURE 
PERIOD OF 6 HOURS 
ï·start 
ï·end 
ï¼ïˆï€±ï¼ 
ï¼ïˆï€²ï¼ 
ï¼ï”ï€ ï¼ 
ï¤total 
ï¤ave 
time 
  6:00 
12:00 
6 
5 
274 
80 
7.27 
5.44 
  7:00 
13:00 
8 
6 
360 
97 
6.93 
12.47 
  8:00 
14:00 
8 
6 
364 
94 
6.71 
13.14 
  9:00 
15:00 
8 
8 
390 
94 
5.88 
18.46 
10:00 
16:00 
7 
8 
367 
88 
5.87 
15.67 
11:00 
17:00 
7 
7 
338 
85 
6.07 
12.03 
12:00 
18:00 
7 
7 
338 
86 
6.14 
12.00 
13:00 
19:00 
8 
8 
390 
93 
5.81 
18.76 
14:00 
20:00 
8 
7 
361 
93 
6.20 
15.27 
15:00 
21:00 
8 
8 
364 
111 
6.94 
18.02 
 
TABLE III.  
SIMULATION RESULTS FOR TRACK CLOSURE 
PERIOD OF 9 HOURS 
ï·start 
ï·end 
ï¼ïˆï€±ï¼ 
ï¼ïˆï€²ï¼ 
ï¼ï”ï€ ï¼ 
ï¤total 
ï¤ave 
time 
  6:00 
15:00 
10 
9 
480 
115 
6.05 
35.68 
  7:00 
16:00 
11 
10 
514 
133 
6.33 
49.59 
  8:00 
17:00 
11 
10 
544 
127 
6.05 
54.08 
  9:00 
18:00 
11 
11 
544 
145 
6.59 
59.26 
10:00 
19:00 
11 
12 
573 
145 
6.30 
69.41 
11:00 
20:00 
11 
11 
518 
145 
6.59 
54.74 
12:00 
21:00 
11 
12 
518 
146 
6.35 
61.77 
diagrams of trains included in ïˆï€± and ïˆï€² are respectively 
shown by solid lines and dotted lines and the points P1, P2, Q1 
and Q2 have the same meaning as in Figure 1 and Figure 2. 
V. 
CONCLUSION 
In this paper, we addressed the problem of how to adjust 
the original timetable for parallel single-track sections during 
track closure so as to minimize the sum of the delay of each 
train by formulating the task as a mathematical programming 
problem. Then, we verified the effectiveness of our method 
through simulations. However, there are still several problems 
that remain. For example, we need to construct a method to 
recover the delay caused by track closure after track closure 
ends. We also need to extend our method so that it can be used 
in the sections including multiple track closure sections. 
REFERENCES 
[1] French National Railway Company, https://www.sncf.com/fr 
[retrieved: September, 2019] 
[2] Deutsche 
Bahn, 
https://www.bahn.de/p/view/index.shtml 
[retrieved: September, 2019] 
[3] A. Albrecht, D. Panton, and D. Lee, â€œRescheduling rail 
networks with maintenance disruptions using problem space 
search,â€ Computers & Operations Research, vol. 40, no. 3, pp. 
703-712, 2013. 
[4] M. Lake and L. Ferreira, â€œMinimising the conflict between rail 
operations and infrastructure maintenance,â€ In: Taylor, M. 
(Ed.), Transportation and Traffic Theory in the 21st Century: 
Proceedings of the 15th International Symposium on 
Transportation and Traffic Theory, Pp. Elsevier, Oxford, UK, 
pp. 63-80. 
[5] G. Budai-Balke, â€œOperations research models for scheduling 
railway infrastructure maintenance (PhD thesis),â€ Erasmus 
University, Rotterdam, The Netherlands. 
[6] F. Peng, S. Kang, X. Ouyang, K. Somani, and D. Acharya, â€œA 
Heuristic approach to the railroad track maintenance 
scheduling problem,â€ Comput Aided Civil Infrastruct. E.g. vol. 
26, no. 2, pp. 129-145, 2011. 
[7] P. Vansteenwegen, T. Dewilde, S. Burggraeve, and D. 
Cattrysse, â€œAn interative approach for reducing the impact of 
infrastructure maintenance on the performance of railway 
systems,â€ European Journal of Operational Research, vol. 252, 
pp. 39-53, 2016. 
[8] R. L. Burdett and E. Kozan, â€œTechniques for inserting 
additional trains into existing timetables,â€ Transportation 
Research Part B, vol. 43, pp.821-836, 2009. 
[9] M. Forsgren, M. Aronsson and S. Gestrelius, â€œMaintaining 
tracks and traffic flow at the same time,â€ Journal of Rail 
Transport Planning & Management, vol. 3, pp. 111-123, 2013. 
[10] Gurobi 
Optimizer, 
http://www.gurobi.com/ 
[retrieved: 
September, 20191
Figure 5. Diagrams for the adjusted train timetable calculated by the proposed methodology 
Q2 
Q1 
P1 
P2  
Track closure period 
9:30 10:00 10:30 11:00 11:30 12:00 12:30 13:00 13:30 14:00 14:30 15:00 15:30 16:00 16:30
37
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-756-6
SIMUL 2019 : The Eleventh International Conference on Advances in System Simulation

