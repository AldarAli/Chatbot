  A new Hybrid SPD-based Scheduling for 
EPONs 
Qianjun Shuai, Jianzeng Li 
Information Engineering Academy 
Communication University of China 
Beijing, China 
{sqj, jzli}@cuc.edu.cn 
 Jinyao Yan, Weijia Zhu 
Computer and Network Information Center 
Communication University of China 
Beijing, China 
{jyan, wjzhu}@cuc.edu.cn
Abstract—Dynamic bandwidth allocation (DBA) is a key issue 
of Ethernet PONs. In order to get higher resource utilization and 
lower packet delay, the problem is always dissolved into grant 
sizing and grant scheduling. In this paper, we explore grant 
scheduling techniques. We propose a modified hybrid online and 
offline scheduling with the shortest propagation delay (SPD) first 
policy (we named HSPD) which can compensate for the idle time 
under light or medium loaded traffic. Meanwhile, the last ONU 
in offline set is adaptively indicated to transmit REPORT frame 
first (called LRF), so the idle time can be eliminated especially 
under heavy loaded traffic. We evaluate the cycle length and av-
erage packet delay through analysis and simulations. Compared 
with the offline SPD first scheduling (we named it OSPD), and 
online and offline scheduling with excess bandwidth distribution 
(so-called M-DBA1), we find out our algorithm HSPD-LRF can 
achieve significant improvements in terms of average packet 
delay and channel utilization. 
 
Keywords—DBA; Online; Offline; Hybrid SPD-based Schedul-
ing (HSPD); Last REPORT First (LRF). 
 
I. 
INTRODUCTION 
Passive optical network is a point-to-multipoint (P2MP) 
optical network without active elements in the path, where an 
optical line terminal (OLT) at the center office (CO) is con-
nected to many optical network units (ONUs) at remote nodes 
through passive elements such as 1:N optical splitters. The 
network use a single wavelength in each of the two direc-
tions—downstream and upstream, and the wavelengths are 
multiplexed on the same fiber through coarse WDM (CWDM). 
In the downstream direction, packets are broadcast by the 
OLT and extracted by the destination ONU. While in the up-
stream direction all the ONUs share a single wavelength 
channel by time division multiple access (TDMA). Since the 
passive optical splitters are not able to inspect the upstream 
collision, it is the OLT who acts as the arbiter that grant time-
slots (transmission windows) to the ONUs by a certain 
scheme. In order to avoid packets collision and to utilize the 
upstream channel efficiently, a dynamic bandwidth allocation 
(DBA) is required. Ethernet PONs (EPONs) technology has 
been standardized by the IEEE 802.3ah Ethernet in the First 
Mile (EFM) Task Force, which aims at combining the 
low-cost equipment, simplicity of Ethernet, the low-cost fiber 
infrastructure and high bandwidth of PONs. However IEEE 
802.3ah does not prescribe any scheme of the upstream data 
transmission, but devises the multipoint control protocol 
(MPCP) which defines message-based mechanism to control 
information exchange between the OLT and ONUs. The 
shceme of upstream data transmission is left for choice of 
vendors. Dynamic bandwidth allocation (DBA) algorithms for 
EPONs have become a key issue and have been paid consi-
derable attention from both industry and academia in recent 
years. 
Basically, DBA algorithms that have been presented in lite-
ratures for EPONs can be divided into grant sizing and grant 
scheduling. The grant sizing determines the size of the up-
stream transmission window granted for an ONU. While the 
grant scheduling determines the beginning time of the up-
stream transmission granted for an ONU. These two aspects 
can be not separated. Grant sizing algorithms have been pro-
posed in [5]-[9]. In [9], Kramer et al. proposed the IPACT 
algorithm in which the OLT polls the ONUs in a round-robin 
way and dynamically assigns them bandwidth according to 
different approaches and indicated that the limited service has 
the best performances. Many literatures proposed excess 
bandwidth allocation algorithms [2][5][6], or prediction me-
chanisms, based on the limited service [7]. Grant scheduling 
techniques have been proposed in [1]-[4]. The authors in [4] 
partition the scheduling problem into ⑴  a scheduling 
framework and ⑵ a scheduling policy operating within the 
adopted framework. McGarry et al. [3] outlines two basic 
87
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

grant scheduler as online and offline. In an online scheduler 
any ONU is scheduled for upstream transmission as soon as 
the OLT receives its REPORT message. In an offline schedu-
ler the ONUs are scheduled for transmission of the next cycle 
once the OLT has received all REPORT messages from all 
ONUs. So online scheduling has great efficiency but lacks 
QoS control since the OLT makes scheduling decisions based 
on individual request without global knowledge of the current 
bandwidth requirements of the other ONUs. Offline schedul-
ing allows OLT to take into consideration of the current 
bandwidth requirements from all ONUs, thus, it enables the 
wide variety of QoS mechanisms. On the other hand, it con-
ducts idle time in upstream channel since OLT has to wait all 
REPORT frames from all ONUs. 
In this paper, we aim at resolving the idle time issue of of-
fline scheduling. In order to shorten or eliminate the fixed idle 
time of offline scheduling, we combine the online & offline 
scheduling based on limited service and sort the overloaded 
ONUs in ascending order by their propagation delays before 
scheduling in offline framework. Meanwhile in our proposed 
scheduling the last ONU is put into the offline scheduling set 
and the ONU with the largest propagation delay in the offline 
set transmits REPORT frame before its data in the next cycle. 
Since the ONUs in offline scheduling always have large 
enough data transmission window, the idle time can be com-
pensated especially under heavy traffic. Importantly, the whole 
algorithm is very simple to implement.  
The rest of this paper is organized as follows. In Section II, 
we discuss the related work on dynamic bandwidth allocation 
algorithms. In Section III, we analyze the idle time problem in 
offline scheduling and present the HSPD-LRF scheduling. In 
Section IV, we provide the performance result of simulations. 
In Section V, we conclude the paper. 
II. 
RELATED WORK 
Assi et al. [5] proposed an excessive bandwidth distribution 
that left from the underloaded ONUs amongst the overloaded 
ONUs (so-called DBA1). In order to implement the excessive 
bandwidth distribution, it for the first time employ a combined 
online and offline scheduling in which ONUs with requests 
smaller than its minimum guaranteed window sizes are sche-
duled immediately while those with larger requests would be 
scheduled when OLT have received all of the REPORT 
frames. Since DBA1 grants the total excess bandwidth to the 
overloaded ONUs, it sometimes mistakenly leaves most of the 
available bandwidth idle. Based on DBA1, Shami et al. in [6] 
proposed an improved dynamic bandwidth allocation algo-
rithm called M-DBA1 which grants bandwidth to overloaded 
ONUs based on a comparison of total excess bandwidth saved 
by underloaded ONUs with total extra demand bandwidth of 
the overloaded ONUs. Bai et al. [8] improved the procedure 
for allocating excess bandwidth. Nevertheless, the algorithms 
mentioned above only focus on the grant sizing but not grant 
scheduling. They did not present any optimal scheduling pol-
icy but employed the simple first come first schedule (FCFS) 
scheme in the hybrid online and offline scheduler.  
In [2], J. Zheng proposed a mechanism in which OLT al-
ways schedules underloaded ONUs before overloaded ONUs 
as well as possible. OLT maintains a time tracker to record the 
ending time of last scheduled ONU. When the upstream 
channel is going to be idle, an overloaded ONU is scheduled 
without extra excessive bandwidth if necessary. Thus, the 
upstream transmission channel is not idle between granting 
cycles. 
In [1], McGarry et al. presented a scheduling algorithm that 
employs the shortest propagation delay first (SPD) policy in 
offline framework. OLT sorts all ONUs in ascending order by 
their propagation delays before scheduling. Thus, the long 
round trip propagation delay can be masked by scheduling the 
near-by ONUs first. 
III. 
HSPD-LRF ALGORITHM 
Since an offline scheduler makes scheduling decision for all 
ONUs at once, this requires that the scheduling algorithm be 
implemented after the OLT receives the end of the last ONU’s 
REPORT frame. Thus, as illustrate in Figure 1(a), a fixed idle 
time between scheduling cycles is introduced. It is composite 
of the followings: 
 
The computation time of the scheduling in OLT 
Tsche
. 
 
The transmission time for the grant (64 bytes) frame 
which can be regarded as part of scheduling time
Tsche
. 
 
The processing time of the ONU scheduled in the next 
88
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

...
...
Cycle n
Cycle n+1
OLT
ONU
RN
R1
RN
R1
ST
RTT1
TscheTonu
...
 
G 
 
G 
R2
R3
 
 
(a)   Offline Scheduling Framework 
...
...
Cycle n
Cycle n+1
OLT
ONU
RN
R1
RN
RTT1
TscheTonu
...
R3
 
Rkn
 
G 
 
G 
 
G 
 
R1 G 
R2
online
offline
 
(b)  Online and Offline (Hybrid) Framework 
...
...
Cycle n
Cycle n+1
OLT
ONU
R1
RN
R1
RTT1
TscheTonu
R2
 
RN-1
...
 
G 
 
G 
RN
 
G 
 
(c) 
LRF based Online and Offline Scheduling (Hybrid) Framework 
Fig. 1 Different scheduling frameworks  
 
cycle
Tonu
. 
 
The RTT of the first ONU scheduled in the next 
cycle
RTT1off
. 
So, we get: 
g
off
onu
sche
idle
T
RTT
T
T
T




1
  
 
(1) 
where 
g
T is the guard time between two consecutive trans-
mission windows of two different ONUs. When the ONUs are 
scheduled based on SPD first policy, the RTT of the first ONU 
can be reduced to the minimum value. So, idle time in offline 
scheduler is shortened. Described as:  
 
g
MIN
onu
sche
MIN
idle
T
RTT
T
T
T




  
 
(2) 
However, the SPD based offline scheduling still has a fixed 
waste of idle time in upstream channel which reduces the chan-
nel utilization. In this paper, we employ a hybrid online and 
offline scheduling based on limited service and make changes in 
some aspects to address the idle time issue. First of all, all 
ONUs are divided into two sets according to their bandwidth 
requests which is given by (3). Those having bandwidth re-
quests smaller than their minimum guaranteed windows are 
ascribed to light loaded set K and scheduled as soon as OLT 
receives their REPORT messages, the others are ascribed to 
over loaded set M and scheduled all at once according to their 
propagation delays sorted in ascending order after OLT receives 
the last REPORT message. Thus, the excessive bandwidth of 
underloaded ONUs can be used to meet the bandwidth demand 
of overloaded ONUs in each transmission cycle. 






MIN
i
i
MIN
i
i
i
B
R
M
B
R
K
ONU
,
,
 
 
 
 
 
(3) 
As illustrated in Figure 1(b), if the first ONU who has re-
quest smaller that its minimum guaranteed window in the nth 
cycle is the 
n
k th to come. So, we get (4), which means the 
upstream channel idle time caused by the large RTT of the 
first ONU that belong to set K in the (n+1)th cycle and (5) 
which means the upstream channel idle time caused by the 
large RTT of the first ONU that belong to set M in the (n+1)th 
cycle. In the following, 
i
W  is the transmission window length 
(time length) of the ith ONU in the nth cycle. 
j
R  is the re-
quest length (time length) of the jth ONU. If both (4) and (5) 
are obtained simultaneously, we can achieve shorter idle time 
than the minimum idle time 
MIN
Tidle
of the SPD based offline 
scheduling. 


on
onu
sche
g
MIN
idle
N
k
i
g
i
RTT
T
T
T
T
T
W
n
1
1









    
(4) 


off
onu
shce
g
MIN
idle
K
j
g
j
RTT
T
T
T
T
T
R
n
1
1









    
(5) 
Here, we get： 


on
MIN
N
k
i
g
i
RTT
RTT
T
W
n
1
1






 
 
 
(6) 


off
MIN
K
j
g
j
RTT
RTT
T
R
n
1
1






 
 
 
(7) 
A specific situation is when
k n  N
, that means only the 
89
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

last ONU (the Nth ONU) has smaller request, so, the trans-
mission window (
g
i
W T
) in (6) is nothing. Thus, only when 
MIN
on
RTT
RTT

1
 could we get no longer idle time than 
MIN
Tidle
if the last ONU is scheduled in online set. Due to this, 
the last ONU is always put into offline set. That means 
ONUN M
. Also we can see from (7) that the more elements 
in set K, the better. 
When the traffic is getting heavier, more and more ONUs 
belonged to overloaded set M. So, the underloaded ONUs 
may not be able to compensate the idle time. In this situation, 
the last ONU of set M is indicated to transmit REPORT frame 
before its data, see Fig. 1(c). Since the ONUs in set M always 
has long enough data transmission window, it can always 
compensate the idle time. Specifically, this is easily executed 
by redefining the MPCP GATE frame granting to the ONUs. It 
is assumed that the general GATE frame can offer no more 
than 3 grants to an ONU, which means the valid range of the 
GATE number is from 0~3. As shown in Figure 2, the com-
bining of the most significant bit and the third bit from the 
right of the Number/Flag byte in GATE frame can be defined 
as the indication of transmitting REPORT first. 
IV. 
PERFORMANCE EVALUATION 
  To evaluate the performances such as the average cycle 
time, the average packet delay and channel utilization of the 
proposed LRF-based hybrid scheduling which we call 
HSPD-LRF, a simulation model comprising an access net-
work with one OLT, and 16 ONUs was developed using C++. 
Here, channel utilization was defined as the ratio of the sum of 
pure data transmission windows to the cycle time. The pure 
data transmission window did not include the overheads, such 
as Preamble, IPG and the REPORT frame that attached. In the 
simulation, the equal weighted limited grant sizing with 
excess bandwidth distribution [6] is employed. In addition, the 
traffic of each ONU was generated with the properties of 
self-similarity and long-range dependence, and the Hurst pa-
rameter was set to 0.8. The maximum cycle time was assumed 
to be 2ms. The guard time between two consecutive transmis-
sion windows of two different ONUs was 1μs. The corres- 
ponding minimum guaranteed window size, 
iBMIN
, was set  
7
6
5
4
3
2
1
0
GATE number
Discovery GATE
/Normal GATE
REPORT 
enforcement
 
Fig. 2 Number/Flag byte in MPCP GATE 
 
 
Fig. 3 Average cycle time versus traffic load 
 
 
Fig. 4 Average packet delay versus traffic load 
 
 
Fig. 5 Channel utilization versus traffic load 
 
to15500 bytes. In order to explicit the impact of the diversity 
of propagation delays, the one-way propagation delays be-
tween the ONUs and the OLT were randomly generated ac-
cording to a uniform distribution with a minimum value of 
90
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

10μs and a maximum value of 200μs to represent the distance 
between 1km and 20km. Among others, one ONU had the 
minimum propagation delay, 10μs, and another had the max-
imum propagation delay, 200μs. The performances of the of-
fline SPD based scheduling (OSPD) and the so-called 
M-DBA1 algorithm were also illustrated as comparison. 
Figure 3 shows that the overall cycle time of the proposed 
algorithm is shortened compared with OSPD scheduling. 
When the traffic load is getting heavier (load > 0.4), 
HSPD-LRF has the shortest cycle time because it efficiently 
eliminates the idle time. Figure 4 shows the average packet 
delay versus offered load. Again the proposed algorithm has 
the best performance for all traffic load. Figure 5 is the 
channel utilization. Under heavy traffic load, the proposed 
algorithm achievs about 98.6% channel utilization which 
actually means there is no idle time wasted because the chan-
nel utilization was calculated using the pure data transmission 
windows without the overheads and the REPORT frames, 
which in fact occupy the upstream channel.  
V. 
CONCLUSION AND FUTURE WORK 
This study has presented a modified hybrid online and of-
fline scheduling algorithm for EPONs, in which the under-
loaded ONUs are scheduled instantaneously without any delay, 
and the idle time issue is solved by adaptively employing the 
last REPORT first scheme when the traffic load is getting 
heavier. Specifically, the whole algorithm is executed simply 
since it only needs to sort the overloaded ONUs once before 
they are scheduled in offline mode as well as the OLT indicate 
the last ONU in overloaded set to transmit REPORT before its 
data based on slightly modified MPCP GATE frame when 
necessary. Through simulation results, the proposed algorithm 
has demonstrated that it can significantly improve the network 
performance in terms of packet delay and channel utilization 
as compared with the SPD-based offline scheduling and the 
well known M-DBA1 algorithm proposed in [6]. However, 
this study only investigated the network performances of the 
single channel EPON system. In the future work, the authors 
will investigate the issues in the multi-channel EPON, such as 
WDM EPON system. 
ACKNOWLEDGMENT 
This research is supported by the National Natural Science 
Foundation of P. R. China (No. 60970127), Science Technol-
ogy Research key Project of Ministry of Education 
(No.109029) and partly supported by Program for New Cen-
tury Excellent Talents in University (NCET-09-0709). It is 
also supported by the Campus Engineering Project (No. 
XNG0943). 
REFERENCES 
[1] 
M. McGarry, M. Reisslein, F. Aurzada, and M. Scheutzow, ―Shortest 
Propagation Delay (SPD) First Scheduling for EPONs with Heteroge-
neous Propagation Delays,‖ Selected Areas in Communications, IEEE 
Journal on Volume: 28 , Issue: 6 , Page(s): 849 – 862,2010. 
[2] 
J. Zheng, ―Efficient bandwidth allocation algorithm for Ethernet passive 
optical networks,‖ IEE Proc.-Commun., vol. 153, no. 3, pp. 464–468, 
June 2006. 
[3]  M. McGarry, M. Maier, and M. Reisslein, ―WDM Ethernet Passive 
Optical Networks,‖ IEEE Communications Magazine, vol. 44, no. 2, pp. 
S18–S25, February 2006. 
[4] 
M. McGarry et al., ―Just-in-time scheduling for multichannel EPONs,‖ J. 
Lightwave Technol., vol. 26, no. 10, pp.1204–1216, May 2008. 
[5] 
C. Assi, Y. Ye, S. Dixit, and M. Ali, ―Dynamic Bandwidth Allocation 
for Quality-of-Service over Ethernet PONs,‖ IEEE Journal on Selected 
Areas in Communications, vol. 21, no. 9, pp. 1467–1477, November 
2003. 
[6] 
A. Shami, X. Bai, C. Assi, and N. Ghani, ―Quality of Service in 
Two-Stage Ethernet Passive Optical Access Networks,‖ in Proceedings 
of IEEE the 13th International Conference on Computer Communica-
tions and Networks (ICCCN), 2004, pp. 352–357 Chicago. 
[7] 
Y. Luo and N. Ansari, ―Limited Sharing with Traffic Prediction for 
Dynamic Bandwidth Allocation and QoS Provisioning over Ethernet 
Passive Optical Networks,‖ OSA J. Opt. Net., vol. 4, no. 9, Sept. 2005, 
pp. 561–72. 
[8] 
X. Bai, A. Shami and C. Assi, ―On the fairness of dynamic bandwidth 
allocation schemes in Ethernet passive optical networks,‖ Journal of 
Computer Communications, vol. 29, no. 11, pp. 2123-2135, July 2006. 
[9] 
G. Kramer, B. Mukherjee, and G. Pesavento, ―IPACT: A dynamic 
protocol for an Ethernet PON (EPON),‖ IEEE Communications Maga-
zine, 40(2):74–80, February 2002. 
91
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

