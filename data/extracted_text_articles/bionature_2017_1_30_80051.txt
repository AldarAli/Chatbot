Optimal Sizing of the ESS for Economic Advantage of PV-ESS Generation 
 
Kyeong Hee Cho, Seul Ki Kim, Eung Sang Kim 
Smart distribution research center 
Korea Electro-technology Research Institute 
Changwon-si, Republic of Korea 
E-mail: kx1004xh@keri.re.kr 
June Ho Park 
Electronic engineering 
Busan National University 
Busan, Republic of Korea 
E-mail: parkjh@pusan.ac.kr
 
 
Abstract—Renewable energy Portfolio Standard (RPS) was 
implemented by the government of Republic of Korea. Public 
institutions have to install the renewable generator according to 
contract capacity. By mandatory systems like these, renewable 
energy market is consistently increasing. Photovoltaic power 
generation (PV) is affected by solar radiation and generate only 
during the day. If Energy Storage System (ESS) is connected to 
PV, surplus energy of PV is charged to ESS and ESS discharged 
to load in peak time period. In this paper, method of optimal 
sizing ESS for economic advantage for PV-ESS generation is 
suggested. 
Keywords- ESS sizing; PV-ESS; ESS Design; Economic 
analysis; Power pattern analysis. 
I. 
 INTRODUCTION 
Renewable energy Portfolio Standard (RPS) was 
implemented by the government of Republic of Korea. The 
RPS system defines that power generation companies that 
have a 500MW or more of power generation facilities have to 
generate by renewable energy at a certain percentage of the 
total. Recently, if customer is public institution, this customer 
has to install the renewable generator more than 5 percentage 
of contracted capacity. By mandatory systems like these, 
market related to renewable energy is consistently increasing.  
In addition, on September 19, 2016, the Ministry of Trade, 
Industry and Energy (MOTIE) in Republic of Korea 
announced a policy to significantly expand the installation of 
Energy Storage System (ESS) in solar power plants. The 
purpose of the policy is that power of PV is affected by solar 
radiation and generated only during the day, so the ESS is 
connected to PV, surplus energy of PV is charged to ESS in 
the day and ESS can discharge to grid in peak time period.  
The price of the ESS is about 622 [USD] per 1kW, which 
is very expensive compared to the electricity price. Economic 
damage may occur due to high investment costs of ESS when 
operator does not consider economic analysis for PV-ESS 
generation. Therefore, design is required before installing ESS 
and the market for ESS design to link PV is expected to 
expand significantly in Korea. 
In this paper, we proposed a method of optimal sizing ESS 
for economic advantage of PV-ESS generation based on the 
experience of operating the ESS. Using the proposed method, 
operators who want to install ESS can reduce the economic 
risk of high investment cost of ESS and gain a maximum 
profit from linking PV and ESS. 
In Section II, power pattern of PV is forecasted using local 
weather information. In Section III, the optimal scheduling 
algorithm of charging and discharging of ESS is explained. In 
Section IV, method of optimal sizing ESS for economic 
advantage for PV-ESS generation is proposed. In Section V, 
general economic analysis method is explained. In the case 
study from Section VI, ESS is designed for optimal ESS size 
selection using real solar radiation data. The paper is 
concluded with Section VII.  
II. 
POWER PATTERN ANALYSIS OF PV 
The method for pattern analysis of PV is shown in Figure 
1.  
 
 
Figure 1.  PV forecasting process 
First of all, the data tables of Vertical Solar Radiation 
(VSR) in target city are downloaded. Then, VSR is converted 
to Active Solar Radiation (ASR) on the inclined surface of PV 
panel.  
If (90- δ) is bigger than θ , then ASR is calculated 
following equation. 
 
 =  /                          (1) 
 
Else if (90-δ) is smaller than θ, then ASR is calculated 
following equation. 
 
7
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-561-6
BIONATURE 2017 : The Eighth International Conference on Bioenvironment, Biodiversity and Renewable Energies

 =  × ( +  / )               (2) 
 
Where, VSR : Vertical Solar Radiation [kW] 
ASR : Active Solar Radiation [kW] 
: Angle of declination of PV panel 
 : Meridian altitude 
 
Using hourly ASR data, PV generation is calculated using 
(3) [1]. 
 
 =  ×  ×                        (3) 
 
Where,  : Power of PV system [kW] 
  : Capacity of PV [kW] 
 : Efficiency of PCS [%] 
 
The hourly PV generation pattern is made and entered into 
ESS scheduler. 
III. 
OPTIMAL SCHEDULING OF ESS 
When ESS is connected to PV, the process for optimizing 
the daily charging and discharging schedule of the ESS is 
explained in this section. In PV forecasted generation data, 
maximum hourly peak power value becomes rated output 
power of PCS.  
A. Input data 
Input information is a daily PV generation pattern for a 
year. Unit rate of electricity sales price and characteristics of 
ESS were entered as a unit price of System Marginal Price 
(SMP) and Renewable Energy Certificate (REC), available 
State of Charge (SOC), PCS efficiency and cycle efficiency. 
B. Scheduling-charging 
There are two constraints. First, the SOC of the battery is 
limited. The available capacity of battery is estimated by the 
following equation. 
 
_ =  × ( −  )         (4) 
 
Where, _ : Available capacity of battery [kWh] 
  : Capacity of battery [kWh] 
       : Maximum of SOC [%] 
  : Minimum of SOC [%] 
 
Second, charging capacity of ESS at target hour   is 
calculated using the _   ,. 
If ∑
,


 is bigger than _, , is zero. 
Else if ∑
,


 is bigger than _ , then  , 
calculated following equation. 
 
, = _ − ∑
,


                      (5) 
 
Else, , calculated following equation. 
 
, = ,                                   (6) 
 
Where, , : Power of PV according to hour t [kW] 
 , : Charging power at target hour  [kW] 
, : Power of PV at target hour  [kW] 
 : Time from 1 to 24 [hour] 
 : Target hour [hour] 
 
C. Scheduling-discharging 
When PV generates electricity power from 6:00AM to 
7:00PM, discharge of ESS is zero. The available capacity of 
battery (_) is equally divided in 10 hours from 8:00PM 
to 5:00AM. Then that amount is discharged. The reason for 
sharing discharging of ESS is that if the discharge duration is 
long, the efficiency is high. Table I is the efficiency table of 
lithium ion battery per discharging current. 
TABLE I.  
LITHIUM ION BATTERY EFFICIENCY PER DISCHARGING 
CURRENT 
Discharge Duration 
[hour] 
Discharge Current 
[C] 
Efficiency 
[%] 
5 
0.2 
100 
1 
1 
99 
0.2 
5.2 
98 
0 
10 
95 
 
IV. 
ECONOMIC ANALYSIS 
Profit by generation is estimated using a unit price of SMP 
and REC. 
SMP is calculated by adding   and   . Daily 
SMP profit equations is following. 
 
 , = ∑
 , ×  , ,

                    (7) 
  , = ∑
 ( , − ,) ×  , ,

  (8) 
  _  = ∑
 ,


+ ∑
  ,


    (9) 
  _ = ∑
  ,


                           (10) 
 
Where,   , : SMP profit of PV at d day [] 
   , : SMP profit of ESS at d day[] 
  _  : Total SMP profit of ESS and PV 
during a target month [USD/month] 
  _  : Total SMP profit of ESS and PV 
during a target year [USD/year] 
 ∶ Target month  
 , ,: SMP unit rate at hour  []  
 
REC is calculated by adding   and . Weight 
of PV is 1.5. When ESS discharged using SOC charged from 
PV generation, weight of ESS is 5. 
 
, = ∑
∑
(,,


− ,,)


× , , ×
 (11) 
 , = ∑
∑
 ,,





× , , ×   (12) 
 _ = ∑
(, +  ,)


                (13) 
 
Where,  , : REC profit of PV at m month [] 
8
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-561-6
BIONATURE 2017 : The Eighth International Conference on Bioenvironment, Biodiversity and Renewable Energies

  ,, : Power of PV at hour() in a day() [kW] 
  ,, : Charging power at hour() in a day() [kW] 
, , :REC unit rate at month  []  
 ∶  Weight of PV []  
 , : REC profit of ESS at  month [] 
   ,, : Discharging power at hour() in a day() 
[kW] 
 ∶ eight of ESS link to PV []  
 _  : Total REC profit of ESS and PV 
during a target year [USD/year] 
 
Total profits =   _ + _       (14) 
 
Where, Total profits : Summation profits of SMP and 
REC for ESS and PV for a year [USD/year] 
 
Profit is estimated and saved according to the capacity of 
ESS for 20 years. The profit is transposed to Net Present Value 
(NPV). 
,  = , × (1 − )          (15) 
Here, n : Period operating ESS [year] 
          ,  : Profit after NPV [] 
          , : Profit before NPV [] 
 : Interest rate [%] 
 
The unit price of PCS and battery is entered. Parameter is 
entered like as increasing rate of SMP, REC and money. 
Using economic information, Internal Rate of Return (IRR) 
is estimated according to candidates of ESS. 
 
0 = ∑

( )


                           (16) 
 
Here,  : cash flow for each period t 
t : xth year from target year 
 
V. 
OPTIMAL SIZING OF ESS 
Figure 2 presents the overall flow chart on economic 
analysis method for finding optimal ESS. 
First, information on PV, ESS and price is entered. Using 
weather information in the target city, PV generation is 
forecasted. Initial and maximum capacity of ESS is selected 
and entered by the operator. ESS is scheduled for two cases 
(, ) that are initial and maximum capacity. SMP and REC 
profit are estimated. Then economic analysis is calculated 
using PV and ESS cost. 
If capacities of two cases are different (| − | > 0), 
another candidate () is selected as the center value between 
two cases. Then candidate () revised a capacity of better 
economic profit among the candidate capacities. And 
candidate () becomes candidate (). 
Two candidates are scheduled and calculated again. 
Iteration is performed until that difference of the two cases 
(| − |) is very small. This difference is set by the operator. 
Optimal size ESS is selected among all candidates. We 
assume generally that the higher the IRR, the more 
economical it is. 
 
Figure 2.  Flow chart of optimal ESS capacity estimation 
VI. 
CASE STUDIES 
In the case study, real SR data of Pusan city is downloaded 
from site of Korea meteorological administration [2]. Using 
Section II equation, PV power generation power is calculated 
monthly shown in Figure 3. PV capacity is 450 [kW] and fixed.  
The angle of declination of PV panel is 50 [degree]. 
Meridian altitude is downloaded daily and inserted from the 
site of astronomy and space science information [3].  
 
 
Figure 3.  Monthly average pattern of PV forecast results 
We assumed the boundary of battery capacity with the 
initial capacity is 100 [kWh] and maximum capacity is 800 
[kWh]. The increasing unit capacity is 100 [kWh].  
Rated output of PCS is selected to the maximum value of 
PV forecasted daily patterns for a year. But if this maximum 
9
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-561-6
BIONATURE 2017 : The Eighth International Conference on Bioenvironment, Biodiversity and Renewable Energies

value is higher than battery capacity, rated output of PCS is 
battery capacity.  
Determination of PCS rated output for each battery 
capacity is shown in Table II. As it can be seen, in Table II, 
PCS rated output does not increase linearly according to 
battery capacity. This means that the maximum value of PV 
forecasted daily patterns for a year is lower than the battery 
capacity starting from 700 [kWh]. Therefore maximum power 
of PCS is limited by 518 [kW]. 
TABLE II.  
DETERMINATION OF PCS RATED OUTPUT FOR EACH 
BATTERY CAPACITY 
Cases 
Capacity 
PV[kW] 
Battery[kWh] 
PCS rated output[kW] 
1 
450 
100 
80 
2 
450 
200 
136 
3 
450 
300 
212 
4 
450 
400 
292 
5 
450 
500 
372 
6 
450 
600 
452 
7 
450 
700 
518 
8 
450 
800 
518 
 
In the case study, the average of SMP unit rate is about 
0.12 [USD/kW] and the average of REC unit rate is about 
70.13 [USD/MW].  
The profits of SMP and REC for cases of Table II were 
calculated using equations (7)-(14). SMP profit of ESS and 
PV during a target month and year were calculated using 
equation (10) (see Table III). The total REC profit of ESS and 
PV during a target year were calculated using equation (13) 
(see Table III). The summation profits of SMP and REC for 
ESS and PV for a year were calculated using equation (14) as 
can be seen in Table III. The results of Table III show the 
accumulated profits for 20 years. 
TABLE III.  
PROFITS ESTIMATION RESULTS FOR EACH CASE 
Cases 
PV profit [USD] 
ESS profit [USD] 
Total Profit 
[USD] 
  
 
  
 
1 
58,966 
52,294 
2,801 
13,145 
127,206 
2 
55,768 
49,402 
5,574 
26,159 
136,903 
3 
52,590 
46,536 
8,320 
39,056 
146,502 
4 
49,477 
43,732 
11,006 
51,672 
155,888 
5 
46,442 
41,002 
13,627 
63,956 
165,027 
6 
43,490 
38,359 
16,175 
75,854 
173,877 
7 
40,602 
35,784 
18,665 
87,437 
182,488 
8 
37,770 
33,264 
21,106 
98,781 
190,920 
 
Using equations (15) and (16), economic analysis results 
of these cases are shown in Table IV. The NPV of profit has 
been calculated using equation (15) (see Table IV). The IRR 
has been calculated using equation (16) as can be seen in 
Table IV. The accumulated profits during 20 years are 
presented in Table IV. 
The cost of PV and ESS per unit like Table V was inserted 
to simulation.  
TABLE IV.  
ECONOMIC ANALYSIS RESULTS FOR EACH CASE 
Cases 
Cost of PV and 
ESS [USD] 
IRR 
[%] 
(Profit-Cost) 
[USD] 
Payback 
[year] 
1 
902,972 
8.23 
713,638 
8.79 
2 
965,599 
8.34 
774,577 
8.72 
3 
1,038,151 
8.26 
823,782 
8.77 
4 
1,110,704 
8.17 
870,195 
8.83 
5 
1,183,256 
8.07 
913,383 
8.90 
6 
1,241,941 
8.13 
967,385 
8.85 
7 
1,285,647 
8.36 
1,034,039 
8.71 
8 
1,329,354 
8.55 
1,098,357 
8.58 
TABLE V.  
UNIT COST OF EACH PV, BATTERY AND PCS 
Equipment 
Unit 
Cost[USD] 
PV system 
1kW 
1,594 
Battery of Lithium ion 
1kWh 
354 
PCS 
1kW 
221 
Construction cost 
1kW 
89 
 
Graph of IRR, PV profit and ESS profit for each case in 
Table IV are shown in Figure 4. As shown in Figure 4, the 
IRR was lowest when ESS and PV profits were equal.  
 
 
Figure 4.  The IRR graph according to battery capacity candidates 
In order to apply the algorithm presented in Figure 2, 
information is entered and PV generation is forecasted. The 
initial capacity was set at 200 [kWh] and the maximum 
capacity was set at 3,000 [kWh]. The ESS of two cases was 
scheduled respectively and their profits were calculated. Also, 
economy analysis is calculated. Capacity difference of two 
cases is checked. If this difference is smaller than 50 [kWh], 
simulation is terminated. If not, simulation is repeated. One 
capacity among next two cases is center capacity of previous 
candidates. Another capacity is the capacity of previous 
candidates with the largest IRR. For example, in the second 
simulation, previous candidate () is 200 [kWh], previous 
candidate () is 3,000 [kWh]. Therefore candidate () is 
1,600 [kWh], next candidate ( ) is 200 [kWh] and next 
candidate () is 1,600 [kWh]. 
10
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-561-6
BIONATURE 2017 : The Eighth International Conference on Bioenvironment, Biodiversity and Renewable Energies

TABLE VI.  
DETERMINATION OF BATTERY CAPACITY BY FIGURE 2 
AND IRR RESULTS 
Cases 
Battery capacity[kWh] 
IRR[%] 
1 
200 
8.34 
2 
3,000 
7.17 
3 
1,600 
9.33 
4 
900 
8.71 
5 
1,250 
9.14 
6 
1,425 
9.26 
7 
1,512.5 
9.30 
8 
1,556.3 
9.32 
 
Figure 5.  Selection of battery capacity for increasing IRR by Figure 2 
 
Figure 6.  IRR curve according to each case 
 
Figure 7.  IRR curve while increasing battery capacity by 100 
As it can be seen in Figure 5, optimal size, which is 1,600 
[kWh], was found by running simulation 8 times. This case 
depends on the assumed conditions. 
In this case study, full combination means all cases of 
battery capacity increasing by same term from minimum to 
maximum. Full combination had simulated capacity cases to 
increase by 100 [kWh] up to 2,000 [kWh]. We depicted the 
curve of Profits and IRR in Figure 6.  
When the battery capacity increasing by 100 [kWh] is 
simulated, the IRR curve changes as parabolic curve. This 
method requires 20 iteration and shows that optimal battery 
size is 1,600 [kWh]. 
VII. CONCLUSION 
In this paper, the method of optimal sizing of the ESS for 
the economic advantage of PV-ESS generation was proposed. 
The economic advantage included generation profits of SMP 
and REC considering REC weight of discharging power of 
ESS charged from PV. 
In the case study, in order to apply the algorithm presented 
in Figure 2, ESS capacities were selected and scheduled. The 
generation profits and IRR of each case were calculated for 
optimal ESS size selection. The simulation repeated until that 
the difference of capacities was smaller than 50 [kWh]. In the 
results, the optimal size, which was 1,600 [kWh], was found 
by running simulation 8 times. For comparison, full 
combination had simulated all capacity cases to increase by 
100 [kWh] up to 2,000 [kWh]. This method requires 20 
iteration. Optimal battery size of full combination was 1,600 
[kWh]. Since the results were the same, showing that the 
method applied was accurate and faster. 
Using the proposed method, operators who want to install 
ESS can select the optimal capacity that maximize the profit 
by linking PV and ESS for generation business. Future work 
will be focused on comparisons of optimal sizing method of 
the ESS according to two different goals of demand 
management and generation business. 
ACKNOWLEDGMENT 
This work was supported by the Power Generation & 
Electricity Delivery Core Technology Program of the Korea 
Institute of Energy Technology Evaluation and Planning 
(KETEP) granted financial resource from the Ministry of 
Trade, 
Industry 
& 
Energy, 
Republic 
of 
Korea 
(No.20143010011830). 
REFERENCES 
[1] Md. Habibur Rahman and S. Yamashiro, “Novel Distributed 
Power Generating System of PV-ECaSS Using Solar Energy 
Estimation”, IEEE Transactions on energy converstion, Vol. 
22, No. 2, pp.360, June 2007. 
[2] Korea 
meteorological 
administration 
site, 
http://web.kma.go.kr/eng/index.jsp, April, 2017. 
[3] Astronomy 
& 
space 
science 
information 
site, 
http://astro.kasi.re.kr/main/mainpage.aspx, April, 2017. 
[4] K. H. Cho, S. K. Kim, and E. S. Kim, “Optimal Capacity 
Determination Method of Battery Energy Storage System for 
Demand Management of Electricity Customer”, Transactions 
of the Korea Institute of Electrical Engineers, Vol. 62, No.1, 
pp. 21–28, January, 2013 
[5] K. H. Cho, S. K. Kim, and E. S. Kim, “Optimal Sizing of BESS 
for Customer Demand Management”, Journal of ICEE, Vol.1, 
January, 2014. 
11
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-561-6
BIONATURE 2017 : The Eighth International Conference on Bioenvironment, Biodiversity and Renewable Energies

