Half-Band FIR Filters for Signal Compression
Pavel Zahradnik and Boris ˇSim´ak
Department of Telecommunication Engineering
Czech Technical University in Prague
Prague, Czech Republic
zahradni, simak@fel.cvut.cz
Miroslav Vlˇcek
Department of Applied Mathematics
Czech Technical University in Prague
Prague, Czech Republic
vlcek@fd.cvut.cz
Abstract—An efﬁcient design of equiripple half-band FIR
ﬁlters for signal compression is presented. Solution of the
approximation problem in terms of generating function and zero
phase transfer function for the equiripple half-band FIR ﬁlter is
shown. The equiripple half-band FIR ﬁlters are optimal in the
Chebyshev sense. The closed form solution provides an efﬁcient
computation of the impulse response of the ﬁlter. One example
is included.
Keywords-FIR ﬁlter; half-band ﬁlter; equiripple approxima-
tion; wavelet compression;
I. INTRODUCTION
Half-band (HB) ﬁlters are basic building blocks in wavelet
analysis [1], signal compression and in multirate signal pro-
cessing [2]. The only available method for designing equirip-
ple (ER) HB ﬁnite impulse response (FIR) ﬁlters is based on
the numerical McClellan - Parks program [3]. It is usually
combined with a clever ”Trick” [4]. Besides this, some design
methods are available for almost ER HB FIR ﬁlters, e.g.
[5],[6]. No general non-numerical design of an ER HB FIR
ﬁlter was found in references. In our paper we are primarily
concerned with the ER approximation of HB FIR ﬁlters and
with the related non-numerical design procedure suitable for
practical design of ER HB FIR ﬁlters. We present the gener-
ating function and the zero phase transfer function of the ER
HB FIR ﬁlter. These functions give an insight into the nature
of this approximation problem. Our design procedure is based
on the Chebyshev polynomials of the second kind. Based on
the differential equation for the Chebyshev polynomials of
the second kind, we have derived formulas for an effective
evaluation of the coefﬁcients of the impulse response. We
present an approximating degree equation which is useful in
practical ﬁlter design. The advantage of the proposed approach
over the numerical design procedures relies on the fact that the
coefﬁcients of the impulse response are evaluated by formulas.
Hence the speed of the design is deterministic.
II. IMPULSE RESPONSE, TRANSFER FUNCTION AND ZERO
PHASE TRANSFER FUNCTION
A HB ﬁlter is speciﬁed by the minimal passband frequency
ωpT (or maximal stopband frequency ωsT ) and by the mini-
mal attenuation in the stopband as [dB] (or maximal attenua-
tion in the passband ap [dB]). The antisymmetric behavior of
its frequency response implies the relations ωsT = π − ωpT
and 100.05ap + 100.05as = 1. The goal in the ﬁlter design
is to get the minimum ﬁlter length N satisfying the ﬁlter
speciﬁcation and to evaluate the coefﬁcients of the impulse
response of the ﬁlter. We assume the impulse response h(k)
with odd length N = 2(2n+1)+1 coefﬁcients and with even
symmetry h(k) = h(N − 1 − k). The impulse response of the
HB FIR ﬁlter with the length N = 2(2n + 1) + 1 contains 2n
zero coefﬁcients as follows
h(2n + 1)
=
a(0) = 0.5
(1)
2h(2n + 1 ± 2k)
=
a(2k) = 0 , k = 1 . . . n
2h(2n + 1 ± (2k + 1))
=
a(2k + 1) , k = 0 . . . n .
The transfer function of the HB FIR ﬁlter is
H(z) = z−(2n+1)
"
1
2 +
n
X
k=0
a(2k + 1) T2k+1(w)
#
(2)
where Tm(w) is Chebyshev polynomials of the ﬁrst kind. The
frequency response H(ejωT ) of the HB FIR ﬁlter is
H(ejωT ) = e−j(2n + 1)ωT Q(cos ωT )
(3)
where Q(w) is a polynomial in the variable w = (z + z−1)/2
which on the unit circle reduces to a real valued zero phase
transfer function Q(w) of the real argument w = cos(ω T ).
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
−10
−5
0
5
10
15
20
25
30
35
40
45
w
G(w)
Fig. 1.
Generating polynomial G(w) for n = 20, κ′ = 0.03922835,
A = 1.08532371 and B = 0.95360863.
359
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
w
Q(w)
Fig. 2.
Zero phase transfer function Q(w) for n = 20, κ′ = 0.03922835,
A = 1.08532371, B = 0.95360863 and N = 0.55091994.
III. GENERATING POLYNOMIAL AND ZERO PHASE
TRANSFER FUNCTION OF AN ER HB FIR FILTER
A straightforward theory for the generating polynomial of
an ER HB FIR ﬁlter is currently unavailable. The generating
polynomial of an ER HB FIR ﬁlter is related to the generating
polynomial of the almost ER HB FIR ﬁlter presented in [5].
Based on our experiments conducted in [5], we have found
that the generating polynomial G(w) (Fig. 1) of the ER HB
FIR ﬁlter is obtained by weighting of Chebyshev polynomials
in the generating polynomial of the almost ER HB FIR ﬁlter,
namely
G(w) = AUn
2w2 − 1 − κ′2
1 − κ′2

+BUn−1
2w2 − 1 − κ′2
1 − κ′2

(4)
where Un(x) and Un−1(x) are Chebyshev polynomials of the
second kind and A, B, κ′ are real numbers. The zero phase
transfer function Q(w) (Fig. 2) is related to the generating
polynomial
Q(w) = 1
2 + 1
N
Z
G(w)dw
(5)
where the norming factor N is given by (17). The generating
polynomial G(w) and the zero phase transfer function Q(w)
show the nature of the approximation of an ER HB FIR ﬁlter.
IV. DIFFERENTIAL EQUATION AND IMPULSE RESPONSE
OF AN ER HB FIR FILTER
The Chebyshev polynomial of the second kind Ux(w) fulﬁls
the differential equation
(1 − x2)d2Un(x)
dx2
− 3xdUn(x)
dx
+ n(n + 2)Un(x) = 0 . (6)
Using substitution
x =
2w2 − 1 − κ′2
1 − κ′2

(7)
we get the differential equation (6) in the form
w(w2 − κ′2)

(1 − w2)d2Un(w)
dw2
− 3wdUn(w)
dw

+

κ′2(1 − w2) + 2w2(1 − w2)
 dUn(w)
dw
+ 4w3n(n + 2)Un(w) = 0 .
(8)
Based on the differential equation (8), we have derived the
non-numerical procedure for the evaluation of the impulse
response hn(k) corresponding to polynomial Un(w)
Un(w) =
Z
Un
2w2 − 1 − κ′2
1 − κ′2

dw .
(9)
This procedure is summarized in Tab. I. The impulse response
h(k) of the ER HB FIR ﬁlter is
h(k) = 1
2 + A
N hn(k) + B
N hn−1(k) .
(10)
The non-numerical evaluation of the impulse response h(k) is
essential in the practical ﬁlter design.
V. DEGREE OF AN ER HB FIR FILTER
The exact degree formula is not available. In the practical
ﬁlter design, the degree n can be obtained with excellent
accuracy from the speciﬁed minimal passband frequency ωpT
and from the minimal attenuation in the stopband as [dB]
using the approximating degree formula
n .= as[dB] − 18.18840664 ωpT + 33.64775300
18.54155181 ωpT − 29.13196871
.
(11)
The exact relation between the minimal attenuation in the
stopband as [dB], the minimal passband frequency ωpT and
the degree n were obtained experimentally.
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
wp
w01
w
Q(w)
odd n
Fig. 3.
Q(w) for odd n.
360
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

TABLE I
ALGORITHM FOR THE EVALUATION OF THE COEFFICIENTS hn(k).
given
n (integer value),
κ′ (real value)
initialization
α(2n) =
1
(1 − κ′2)n
α(2n − 2) = −(2nκ′2 + 1) α(2n)
α(2n − 4) = − 4n + 1 + (n − 1)(2n − 1)κ′2
2n
α(2n − 2) − (2n + 1)(n + 1)κ′2
2n
α(2n)
body
(for k = n down to 3)
α(2k − 6) =
{ −
3(n(n + 2) − k(k − 2)) + 2k − 3 + 2(k − 2)(2k − 3)κ′2
α(2k − 4)
−
3(n(n + 2) − (k − 1)(k + 1)) + 2(2k − 1) + 2k(2k − 1)κ′2
α(2k − 2)
− [n(n + 2) − (k − 1)(k + 1)] α(2k)
} / [n(n + 2) − (k − 3)(k − 1)]
(end loop on k)
integration
(for k = 0 to n)
a(2k + 1) = α(2k)
2k + 1
(end loop on k)
impulse response hn(k)
hn(2n + 1) = 0
(for k = 0 to n)
hn(2n + 1 ± (2k + 1)) = a(2k + 1)
2
(end loop on k)
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
wp
w01
w
Q(w)
even n
Fig. 4.
Q(w) for even n.
VI. SECONDARY VALUES OF THE ER HB FIR FILTER
The secondary real values κ′, A and B can be obtained from
the speciﬁed passband frequency ωpT and from the degree n
of the generating polynomial. In practical ﬁlter design, the
approximating formulas
κ′ = nωpT − 1.57111377 n + 0.00665857
−1.01927560 n + 0.37221484
(12)
A =

0.01525753 n + 0.03682344 + 9.24760314
n

κ′
+ 1.01701407 + 0.73512298
n
(13)
and
B =

0.00233667 n − 1.35418408 + 5.75145813
n

κ′
+ 1.02999650 − 0.72759508
n
(14)
obtained experimentally provide excellent accuracy. Further,
the exact values κ′, A and B can be obtained numerically
(e.g. using the Matlab function fminsearch) by satisfying
the equality (see Fig. 3 - 4)
Q(wp) =

Q(1)
if n is odd
Q(w01)
if n is even .
(15)
The value
w01 =
r
κ′2 + (1 − κ′2) cos2
π
2n + 1
(16)
was introduced in [6]. Relation (15) guarantees the equiriple
behaviour of the generating polynomial Q(w).
VII. DESIGN OF THE ER HB FIR FILTER
The design procedure is as follows:
• Specify the ER HB FIR ﬁlter by the minimal passband
frequency ωpT and by the minimal attenuation in the
stopband as [dB].
• Calculate the integer degree n of the generating polyno-
mial (11).
• Calculate the real values κ′ (12), A (13) and B (14).
• Evaluate
the
partial
impulse
responses
hn(k)
and
hn−1(k) (Tab. I).
361
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

• Evaluate the ﬁnal impulse response h(k) (10) where the
real norming factor N is
N =

2 [ A Un(1) + B Un−1(1) ]
if n is even
2 [ A Un(w01) + B Un−1(w01) ]
if n is odd .
(17)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−160
−140
−120
−100
−80
−60
−40
−20
0
ω T/ π
20log|H(ej ω T)| [dB]
Fig. 5.
Amplitude frequency response 20 log |H(ejωT )| [dB].
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
−5
−4
−3
−2
−1
0
x 10
−5
ω T/ π
20log|H(ej ω T)| [dB]
Fig. 6.
Passband of the ﬁlter.
VIII. EXAMPLE
Design the ER HB FIR ﬁlter speciﬁed by the minimal pass-
band frequency ωpT = 0.45π and by the minimal attenuation
in the stopband as = −120 dB.
We get n = 38.3856 → 39 (11), κ′ = 0.15571103 (12),
A = 1.17117396 (13), B = 0.83763199 (14) and N =
−2747.96038544 (17). The impulse response h(k) (Tab. II)
with the length N = 159 coefﬁcients is evaluated using
Tab. I and eq. (10). The actual values ωp actT = 0.4502π
TABLE II
COEFFICIENTS OF THE IMPULSE RESPONSE.
k
h(k)
k
h(k)
0 , 158
-0.00000070
42 , 116
0.00231877
2 , 156
0.00000158
44 , 114
-0.00283354
4 , 154
-0.00000331
46 , 112
0.00344038
6 , 152
0.00000622
48 , 110
-0.00415347
8 , 150
-0.00001087
50 , 108
0.00498985
10 , 148
0.00001799
52 , 106
-0.00597048
12 , 146
-0.00002852
54 , 104
0.00712193
14 , 144
0.00004363
56 , 102
-0.00847897
16 , 142
-0.00006481
58 , 100
0.01008867
18 , 140
0.00009384
60 , 98
-0.01201717
20 , 138
-0.00013287
62 , 96
0.01436125
22 , 136
0.00018446
64 , 94
-0.01726924
24 , 134
-0.00025161
66 , 92
0.02098117
26 , 132
0.00033779
68 , 90
-0.02591284
28 , 130
-0.00044697
70 , 88
0.03285186
30 , 128
0.00058370
72 , 86
-0.04348979
32 , 126
-0.00075311
74 , 84
0.06223123
34 , 124
0.00096097
76 , 82
-0.10523903
36 , 122
-0.00121375
78 , 80
0.31802058
38 , 120
0.00151871
79
0.50000000
40 , 118
-0.00188398
and aact = −120.91 dB satisfy the ﬁlter speciﬁcation. The
amplitude frequency response 20log|H(ejωT)| [dB] of the
ﬁlter is shown in Fig. 5. The detailed view of its passband
is shown in Fig. 6. For the speciﬁed values ωpT = 0.45π
and N = 159, the comparative numerical design based on the
”Trick” [3] combined with the Remez algorithm using the Mat-
lab function firpm results in the slightly unsatisfactory min-
imal passband frequency ωp actT = 0.44922001π < 0.45π
and consequently in a slightly better minimal attenuation in
the stopband as act = −123.29066608 [dB].
IX. CONCLUSION
This paper has presented the equiripple approximation of
halfband FIR ﬁlters. The generating polynomial and the zero
phase transfer function illustrate the nature of the approxi-
mation problem. The coefﬁcients of the impulse response are
straightforwardly evaluated from the ﬁlter speciﬁcation.
ACKNOWLEDGEMENT
This
activity
was
supported
by
the
grant
No.
MSM6840770014, Ministry of Education, Czech Republic.
REFERENCES
[1] D. F. Walnut, An Introduction to Wavelet Analysis, Birkh¨auser-Boston,
2002.
[2] N. J. Fliege, Multirate Digital Signal Processing, John Wiley and Sons,
New York, 1994.
[3] J.H. McClellan, T. W. Parks and L. R. Rabiner, A Computer Program
for Designing Optimum FIR Linear Phase Digital Filters, IEEE Trans.
Audio Electroacoust., Vol. AU - 21, Dec. 1973, pp. 506 - 526.
[4] P. P. Vaidyanathan and T. Q. Nguyen, A ”TRICK” for the Design of FIR
Half-Band Filters, IEEE Transactions on Circuits and Systems, Vol. CAS
- 34, No. 3, March 1987, pp. 297 - 300.
[5] P. N. Wilson and H. J. Orchard, A Design Method for Half-Band FIR
Filters,
IEEE Transactions on Circuits and Systems - I: Fundamental
Theory and Applications, Vol. CAS - 46, No. 1, January 1999, pp. 95 -
101.
[6] P. Zahradnik, M. Vlˇcek and R. Unbehauen,
Almost Equiripple FIR
Half-Band Filters,
IEEE Transactions on Circuits and Systems - I:
Fundamental Theory and Applications, Vol. CAS - 46, No. 6, June 1999,
pp. 744 - 748.
362
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

