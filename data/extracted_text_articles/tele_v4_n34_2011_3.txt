240
International Journal on Advances in Telecommunications, vol 4 no 3 & 4, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Design of Half-Band FIR Filters for Signal
Compression
Pavel Zahradnik, Boris ˇSim´ak and Michal Kopp
Department of Telecommunication Engineering
Czech Technical University in Prague
Prague, Czech Republic
zahradni, simak, koppmich@fel.cvut.cz
Miroslav Vlˇcek
Department of Applied Mathematics
Czech Technical University in Prague
Prague, Czech Republic
vlcek@fd.cvut.cz
Abstract—An efﬁcient design of equiripple half-band FIR
ﬁlters for signal compression is presented. Solution of the
approximation problem in terms of generating function and zero
phase transfer function for the equiripple half-band FIR ﬁlter is
shown. The equiripple half-band FIR ﬁlters are optimal in the
Chebyshev sense. The closed form solution provides an efﬁcient
computation of the impulse response of the ﬁlter. Two examples
are included. The robustness of the design is emphasized. The
Matlab code of the design procedure is included.
Keywords-FIR ﬁlter; half-band ﬁlter; equiripple approximation;
signal compression.
I. INTRODUCTION
Half-band (HB) ﬁlter is a fundamental building block in
multirate signal processing [2]. HB ﬁlters are used among
others in ﬁlter banks and in image compression techniques,
where the signal is iteratively decomposed using ﬁltering
and downsampling into its lower and higher subbands. This
procedure is found, e.g., in the JPEG2000 compression [3].
Finite impulse response (FIR) ﬁlters are preferred because
of their linear phase which is essential in the digital image
processing. The equiripple (ER) ﬁlters are attractive because
of their optimality in terms of the ﬁlter degree for the speciﬁed
ﬁlter selectivity. Hence, the ER HB FIR ﬁlters are appreciated
in these tasks. There is a numerical method for designing of
ER HB FIR ﬁlters available. It is based on the numerical
McClellan - Parks program [4]. It is usually combined with
a clever ”Trick” [5]. The analytical design procedure [6] for
trivial lowest order (n ≤ 2) ER HB FIR ﬁlters has lim-
ited practical value. Besides this, some non-numerical design
methods are available for almost ER HB FIR ﬁlters, e.g., [7]
and [8]. In [1] and [9], we have presented a general non-
numerical method for the design of ER HB FIR ﬁlters. Here
we are focused on this method in more detailed manner. We
are primarily concerned with the ER approximation of HB FIR
ﬁlters and with the related non-numerical design procedure
suitable for practical design of ER HB FIR ﬁlters. We present
the generating function and the zero phase transfer function
of the ER HB FIR ﬁlter. These functions give an insight
into the nature of this approximation problem. Our design
procedure is based on Chebyshev polynomials of the second
kind [10]. Based on the differential equation for the Chebyshev
polynomials of the second kind, we have derived formulas for
an effective evaluation of the coefﬁcients of the impulse re-
sponse. We present an approximating degree equation which is
useful in practical ﬁlter design. The advantage of the proposed
approach over the numerical design procedures consists in the
fact that the coefﬁcients of the impulse response are evaluated
by formulas. Hence, the design procedure and its speed is
deterministic.
The structure of the paper is as follows. After an
introduction of the basic terminology in Section II, we
present the generating polynomial and
the zero
phase
transfer function of an ER HB FIR ﬁlter in Section III. The
differential equation for the generating polynomial and the
impulse response of an ER HB FIR ﬁlter are presented in
Section IV. Sections V and VI introduce the degree equation
of an ER HB FIR ﬁlter and its secondary values. The design
procedure is summarizes step by step in Section VII. It
is followed by two examples in Section VIII. Section IX
emphasizes the robustness of the presented design procedure.
Appendix I summarizes the derivation of the algebraic
procedure for the evaluation of the impulse response of the
ﬁlter. In Appendix II, the Matlab code of the design procedure
is presented.
II. IMPULSE RESPONSE, TRANSFER FUNCTION AND ZERO
PHASE TRANSFER FUNCTION
A HB ﬁlter is speciﬁed by the minimal passband frequency
ωpT (or maximal stopband frequency ωsT ) and by the mini-
mal attenuation in the stopband as [dB] (or maximal attenua-
tion in the passband ap [dB]). The antisymmetric behavior of
its frequency response implies the relations ωsT = π − ωpT
and 100.05ap + 100.05as = 1. The goal in the ﬁlter design
is to get the minimum ﬁlter length N satisfying the ﬁlter
speciﬁcation and to evaluate the coefﬁcients of the impulse
response of the ﬁlter. We assume the impulse response h(k)
with odd length N = 2(2n+1)+1 coefﬁcients and with even
symmetry h(k) = h(N − 1 − k). The impulse response of the
HB FIR ﬁlter with the length N = 2(2n + 1) + 1 contains 2n
zero coefﬁcients as follows
h(2n + 1)
=
a(0) = 0.5
(1)
2h(2n + 1 ± 2k)
=
a(2k) = 0 , k = 1 . . . n

241
International Journal on Advances in Telecommunications, vol 4 no 3 & 4, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
−10
−5
0
5
10
15
20
25
30
35
40
45
w
G(w)
Fig. 1.
Generating polynomial G(w) for n = 20, κ′ = 0.03922835,
A = 1.08532371 and B = 0.95360863.
2h(2n + 1 ± (2k + 1))
=
a(2k + 1) , k = 0 . . . n .
The transfer function of the HB FIR ﬁlter is
H(z) = z−(2n+1)
"
1
2 +
n
X
k=0
a(2k + 1) T2k+1(w)
#
(2)
where
Tn(w) = cos(n arccos(w))
(3)
is Chebyshev polynomial of the ﬁrst kind. The frequency
response H(ejωT ) of the HB FIR ﬁlter is
H(ejωT ) = e−j(2n + 1)ωT Q(cos ωT )
(4)
where Q(w) is a polynomial in the variable w = (z + z−1)/2
which on the unit circle reduces to a real valued zero phase
transfer function Q(w) of the real argument w = cos(ω T ).
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
w
Q(w)
Fig. 2.
Zero phase transfer function Q(w) for n = 20, κ′ = 0.03922835,
A = 1.08532371, B = 0.95360863 (cf. Fig. 1) and N = 0.55091994.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
ω T /π
|H(ejω T)|
Fig. 3.
Amplitude frequency response |H(ejωT )| corresponding to the zero
phase transfer function Q(w) from Fig. 2.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−50
−45
−40
−35
−30
−25
−20
−15
−10
−5
0
5
ω T /π
20log|H(ej ω T)| [dB]
Fig. 4.
Amplitude frequency response 20 log |H(ejωT )| corresponding to
the zero phase transfer function Q(w) from Fig. 2.
III. GENERATING POLYNOMIAL AND ZERO PHASE
TRANSFER FUNCTION OF AN ER HB FIR FILTER
A straightforward theory for the generating polynomial of
an ER HB FIR ﬁlter is currently not available. The generating
polynomial of an ER HB FIR ﬁlter is related to the generating
polynomial of the almost ER HB FIR ﬁlter presented in [8].
Based on our experiments conducted in [8], we have found that
the generating polynomial G(w) (Fig. 1) of the ER HB FIR
ﬁlter is obtained by weighting of Chebyshev polynomials in
the generating polynomial of the AER HB FIR ﬁlter, namely
G(w) = AUn
2w2 − 1 − κ′2
1 − κ′2

+BUn−1
2w2 − 1 − κ′2
1 − κ′2

(5)
where
Un(x) = sin [(n + 1) arccos(x)]
sin [arccos(x)]
(6)

242
International Journal on Advances in Telecommunications, vol 4 no 3 & 4, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
is Chebyshev polynomial of the second kind and A, B, κ′ are
real numbers. The zero phase transfer function Q(w) (Fig. 2)
of the ER HB FIR is related to the generating polynomial
Q(w) = 1
2 + 1
N
Z
G(w)dw
(7)
where the norming factor N is given by (19). Both the gen-
erating polynomial G(w) and the zero phase transfer function
Q(w) show the nature of the approximation of an ER HB FIR
ﬁlter.
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
wp
w01
w
Q(w)
odd n
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
wp
w01
w
Q(w)
even n
Fig. 5.
Q(w) for odd and even n.
IV. DIFFERENTIAL EQUATION AND IMPULSE RESPONSE
OF AN ER HB FIR FILTER
The Chebyshev polynomial of the second kind Ux(w) fulﬁls
the differential equation
(1 − x2)d2Un(x)
dx2
− 3xdUn(x)
dx
+ n(n + 2)Un(x) = 0 . (8)
0.2
0.25
0.3
0.35
0.4
0.45
0.5
−160
−140
−120
−100
−80
−60
−40
−20
n=4
n=100
ωpT/π
as [dB]
Fig. 6.
Empirical dependence of as[dB] on ωpT/π and n.
0.43
0.44
0.45
0.46
0.47
0.48
0.49
0.5
−160
−140
−120
−100
−80
−60
−40
−20
n=4
n=100
ωpT/π
as [dB]
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
Fig. 7.
Detailed view of Fig. 6 near ωpT = 0.5π.
Using substitution
x =
2w2 − 1 − κ′2
1 − κ′2

(9)
we get the differential equation (8) in the form
w(w2 − κ′2)

(1 − w2)d2Un(w)
dw2
− 3wdUn(w)
dw

+

κ′2(1 − w2) + 2w2(1 − w2)
 dUn(w)
dw
+ 4w3n(n + 2)Un(w) = 0 .
(10)
Based on the differential equation (10), we have derived the
non-numerical procedure for the evaluation of the impulse
response hn(k) corresponding to polynomial Un(w)
Un(w) =
Z
Un
2w2 − 1 − κ′2
1 − κ′2

dw .
(11)
This procedure is summarized in Tab. I. The principle of its
derivation is shown in the Appendix I. The impulse response

243
International Journal on Advances in Telecommunications, vol 4 no 3 & 4, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
0
5
10
15
20
25
30
35
40
45
50
κ,
n ωpT
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
Fig. 8.
Empirical dependence of n ωpT on κ′.
h(k) of the ER HB FIR ﬁlter is
h(k) = 1
2 + A
N hn(k) + B
N hn−1(k)
(12)
where the real norming factor N is given by (19). The non-
numerical evaluation of the impulse response h(k) is essential
in the practical ﬁlter design because of its determinism.
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
0
20
40
60
80
100
n=100
n=4
κ,
n A
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
Fig. 9.
Empirical dependence of n A on κ′.
V. DEGREE OF AN ER HB FIR FILTER
The exact degree formula is not available. In the practical
ﬁlter design, the degree n can be obtained with excellent
accuracy from the speciﬁed minimal passband frequency ωpT
and from the minimal attenuation in the stopband as [dB]
using the approximating degree formula
n .= as[dB] − 18.18840664 ωpT + 33.64775300
18.54155181 ωpT − 29.13196871
.
(13)
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
0
10
20
30
40
50
60
70
80
90
100
n=100
n=4
κ,
n B
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
n=100
n=4
Fig. 10.
Empirical dependence of n B on κ′.
The exact relation between the minimal attenuation in the
stopband as [dB], the minimal passband frequency ωpT
and the degree n were obtained experimentally. It is shown
in Fig. 6 and Fig. 7. Equation (13) was obtained by the
approximation of exact experimental values in Fig. 7. The
approximating degree formula (13) is very precise. However,
for very low values ωpT its precision slightly decreases. In
order to demonstrate the negligible inaccuracy for very low
values ωpT , let us assume an ER HB FIR ﬁlter speciﬁed by
by the minimal passband frequency ωpT = 0.25π and by
the minimal attenuation in the stopband as = −80 dB. The
approximating degree formula (13) results in n = 4.16194938
while the ﬁlter speciﬁcation is met for n = 4, cf. Fig. 6.
VI. SECONDARY VALUES OF THE ER HB FIR FILTER
The secondary real values κ′, A and B can be obtained from
the speciﬁed passband frequency ωpT and from the degree n
of the generating polynomial. The approximating formulas
κ′ = nωpT − 1.57111377 n + 0.00665857
−1.01927560 n + 0.37221484
(14)
A =

0.01525753 n + 0.03682344 + 9.24760314
n

κ′
+ 1.01701407 + 0.73512298
n
(15)
and
B =

0.00233667 n − 1.35418408 + 5.75145813
n

κ′
+ 1.02999650 − 0.72759508
n
(16)
are obtained by the approximation of experimental values
summarized in graphs in Fig. 8 - Fig. 10. The approximating
formulas provide a very good accuracy useful in practical
ﬁlter design. If desired, the exact values κ′, A and B can be

244
International Journal on Advances in Telecommunications, vol 4 no 3 & 4, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
TABLE I
ALGORITHM FOR THE EVALUATION OF THE COEFFICIENTS hn(k).
given
n (integer value),
κ′ (real value)
initialization
α(2n) =
1
(1 − κ′2)n
α(2n − 2) = −(2nκ′2 + 1) α(2n)
α(2n − 4) = − 4n + 1 + (n − 1)(2n − 1)κ′2
2n
α(2n − 2) − (2n + 1)(n + 1)κ′2
2n
α(2n)
body
(for k = n down to 3)
α(2k − 6) =
{ −
3(n(n + 2) − k(k − 2)) + 2k − 3 + 2(k − 2)(2k − 3)κ′2
α(2k − 4)
−
3(n(n + 2) − (k − 1)(k + 1)) + 2(2k − 1) + 2k(2k − 1)κ′2
α(2k − 2)
− [n(n + 2) − (k − 1)(k + 1)] α(2k)
} / [n(n + 2) − (k − 3)(k − 1)]
(end loop on k)
integration
(for k = 0 to n)
a(2k + 1) = α(2k)
2k + 1
(end loop on k)
impulse response hn(k)
hn(2n + 1) = 0
(for k = 0 to n)
hn(2n + 1 ± (2k + 1)) = a(2k + 1)
2
(end loop on k)
obtained from (7) numerically (e.g. using the Matlab function
fminsearch) by satisfying the equality (see Fig. 5)
Q(wp) =

Q(1)
if n is odd
Q(w01)
if n is even .
(17)
The position of the local extremal value w01 (Fig. 5)
w01 =
r
κ′2 + (1 − κ′2) cos2
π
2n + 1
(18)
was introduced in [8]. The relation (17) guarantees the
equiriple behaviour of the zero phase transfer function Q(w).
VII. DESIGN OF THE ER HB FIR FILTER
The design procedure is as follows:
• Specify the ER HB FIR ﬁlter by the minimal passband
frequency ωpT and by the minimal attenuation in the
stopband as [dB].
• Calculate the integer degree n of the generating polyno-
mial (13).
• Calculate the real values κ′ (14), A (15) and B (16).
• Evaluate
the
partial
impulse
responses
hn(k)
and
hn−1(k) (Tab. I).
• Evaluate the ﬁnal impulse response h(k) (12) where the
real norming factor N is
N =
 2 [ A Un(1) + B Un−1(1) ]
if n is even
2 [ A Un(w01) + B Un−1(w01) ]
if n is odd .
(19)
The Matlab source code of the design procedure is summarized
in Appendix II.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−160
−140
−120
−100
−80
−60
−40
−20
0
ω T/ π
20log|H(ej ω T)| [dB]
Fig. 11.
Amplitude frequency response 20 log |H(ejωT )| [dB].
VIII. EXAMPLES OF THE DESIGN
Example 1.
Design an ER HB FIR ﬁlter speciﬁed by the minimal passband
frequency ωpT = 0.45π and by the minimal attenuation in
the stopband as = −120 dB.
Using formulas we get n
=
38.3856
→
39 (13),
κ′
=
0.15571103
(14),
A
=
1.17117396
(15),
B = 0.83763199 (16) and N
= −2747.96038544 (19).
The impulse response h(k) (Tab. II) with the length N = 159
coefﬁcients is evaluated using algorithm summarized in
Tab. I and eq. (12). The actual values ωp actT = 0.4502π
and aact = −120.91 dB satisfy the ﬁlter speciﬁcation. The

245
International Journal on Advances in Telecommunications, vol 4 no 3 & 4, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
−5
−4
−3
−2
−1
0
x 10
−5
ω T/ π
20log|H(ej ω T)| [dB]
Fig. 12.
Passband of the ﬁlter.
TABLE II
COEFFICIENTS OF THE IMPULSE RESPONSE.
k
h(k)
k
h(k)
0 , 158
-0.00000070
42 , 116
0.00231877
2 , 156
0.00000158
44 , 114
-0.00283354
4 , 154
-0.00000331
46 , 112
0.00344038
6 , 152
0.00000622
48 , 110
-0.00415347
8 , 150
-0.00001087
50 , 108
0.00498985
10 , 148
0.00001799
52 , 106
-0.00597048
12 , 146
-0.00002852
54 , 104
0.00712193
14 , 144
0.00004363
56 , 102
-0.00847897
16 , 142
-0.00006481
58 , 100
0.01008867
18 , 140
0.00009384
60 , 98
-0.01201717
20 , 138
-0.00013287
62 , 96
0.01436125
22 , 136
0.00018446
64 , 94
-0.01726924
24 , 134
-0.00025161
66 , 92
0.02098117
26 , 132
0.00033779
68 , 90
-0.02591284
28 , 130
-0.00044697
70 , 88
0.03285186
30 , 128
0.00058370
72 , 86
-0.04348979
32 , 126
-0.00075311
74 , 84
0.06223123
34 , 124
0.00096097
76 , 82
-0.10523903
36 , 122
-0.00121375
78 , 80
0.31802058
38 , 120
0.00151871
79
0.50000000
40 , 118
-0.00188398
amplitude frequency response 20log|H(ejωT)| [dB] of the
ﬁlter is shown in Fig. 11. The detailed view of its passband
is shown in Fig. 12.
Example 2.
Design an ER HB FIR ﬁlter speciﬁed by the minimal passband
frequency ωpT = 0.475π and by the minimal attenuation in
the stopband as = −80 dB.
We get n
=
50.2277
→
51 (13), κ′
=
0.07779493
(14), A = 1.10893402 (15), B = 0.92842531 (16) and
N
=
−226.43793850 (19). The impulse response h(k)
(Tab. III) with the length N = 207 coefﬁcients is evaluated
using algorithm summarized in Tab. I and eq. (12). The actual
values ωp actT = 0.4752π and aact = −81.23 dB satisfy
the ﬁlter speciﬁcation. The amplitude frequency response
20log|H(ejωT)| [dB] of the ﬁlter is shown in Fig. 13. The
detailed view of its passband is shown in Fig. 14.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−100
−90
−80
−70
−60
−50
−40
−30
−20
−10
0
ω T/ π
20log|H(ej ω T)| [dB]
Fig. 13.
Amplitude frequency response 20 log |H(ejωT )| [dB].
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
−5
−4.5
−4
−3.5
−3
−2.5
−2
−1.5
−1
−0.5
0
x 10
−3
ω T/ π
20log|H(ej ω T)| [dB]
Fig. 14.
Passband of the ﬁlter.
IX. ROBUSTNESS OF THE DESIGN
The
recursive
evaluation
of
the
impulse
response
summarized in Tab. I is extremely fast and robust. Using
the proposed procedure it is possible to evaluate the impulse
response of the ER HB FIR ﬁlter with the length of thousands
of coefﬁcients within a fraction of a second. In order to
demonstrate this robustness, let us design an ER HB FIR
ﬁlter with strict speciﬁcation, namely with the speciﬁed
minimal passband frequency ωpT = 0.495π and minimal
attenuation in the stopband as = −180 dB. The length of
the designed ﬁlter is N = 2347 coefﬁcients. The amplitude
frequency response |H(ejωT )| of the ﬁlter is shown in Fig. 15.
X. CONCLUSIONS
The presented design procedure is useful in the design
of equiripple halfband FIR ﬁlters. The designed ﬁlters are
optimal in Chebyshev sense. The generating polynomial and

246
International Journal on Advances in Telecommunications, vol 4 no 3 & 4, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
TABLE III
COEFFICIENTS OF THE IMPULSE RESPONSE.
k
h(k)
k
h(k)
0 , 206
-0.00003240
54 , 152
0.00279585
2 , 204
0.00002594
56 , 150
-0.00312880
4 , 202
-0.00003613
58 , 148
0.00349527
6 , 200
0.00004879
60 , 146
-0.00389883
8 , 198
-0.00006433
62 , 144
0.00434368
10 , 196
0.00008318
64 , 142
-0.00483480
12 , 194
-0.00010580
66 , 140
0.00537821
14 , 192
0.00013270
68 , 138
-0.00598122
16 , 190
-0.00016445
70 , 136
0.00665292
18 , 188
0.00020162
72 , 134
-0.00740467
20 , 186
-0.00024486
74 , 132
0.00825098
22 , 184
0.00029484
76 , 130
-0.00921066
24 , 182
-0.00035231
78 , 128
0.01030857
26 , 180
0.00041804
80 , 126
-0.01157828
28 , 178
-0.00049287
82 , 124
0.01306624
30 , 176
0.00057766
84 , 122
-0.01483857
32 , 174
-0.00067338
86 , 120
0.01699269
34 , 172
0.00078102
88 , 118
-0.01967820
36 , 170
-0.00090166
90 , 116
0.02313707
38 , 168
0.00103644
92 , 114
-0.02778764
40 , 166
-0.00118660
94 , 112
0.03442063
42 , 164
0.00135345
96 , 110
-0.04473116
44 , 162
-0.00153844
98 , 108
0.06312764
46 , 160
0.00174312
100 , 106
-0.10577606
48 , 158
-0.00196920
102 , 104
0.31817614
50 , 156
0.00221857
103
0.50000000
52 , 154
-0.00249333
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
ω T/ π
|H(ej ω T)|
Fig. 15.
Amplitude frequency response |H(ejωT )|.
the zero phase transfer function based on the Chebyshev
polynomials of second kind illustrate the nature of the
approximation problem. The degree formula indispensable
for the ﬁlter design is presented. The strength of the proposed
design method consists in the fact that the coefﬁcients
of the impulse response of the ﬁlter are straightforwardly
evaluated
using
formulas
from
the
ﬁlter
speciﬁcation.
Because of its inherent determinism resulting from the
non-numerical approach, the presented design procedure
is useful in the adaptive digital signal processing as well.
The enclosed Matlab source code is useful in the ﬁlter design.
ACKNOWLEDGEMENT
This activity was gratefully supported by the grant No.
MSM6840770014, Ministry of Education, Czech Republic.
REFERENCES
[1] P. Zahradnik, B. ˇSim´ak, M. Vlˇcek,
Half-band FIR Filters for Signal
Compression, The Tenth International Conference on Networks ICN 2011,
January 2011, St. Maarten, pp. 359-362.
[2] N. J. Fliege, Multirate Digital Signal Processing, John Wiley and Sons,
New York, 1994.
[3] D. S. Taubman, M. W. Marcellin
JPEG2000 Image Compression
Fundamentals, Standards and Practice.
Kluwer Academic Publishers,
2002.
[4] J.H. McClellan, T. W. Parks, L. R. Rabiner, A Computer Program for
Designing Optimum FIR Linear Phase Digital Filters, IEEE Trans. Audio
Electroacoust., Vol. AU - 21, Dec. 1973, pp. 506 - 526.
[5] P. P. Vaidyanathan, T. Q. Nguyen, A ”TRICK” for the Design of FIR
Half-Band Filters, IEEE Transactions on Circuits and Systems, Vol. CAS
- 34, No. 3, March 1987, pp. 297 - 300.
[6] M. Lutovac, L. Milic,
Design of Optimal Halfband FIR Filters with
Minimum Phase, Proc. XLVII ETRAN Conference, Herceg Novi, June
8-13, 2003, Vol. I, pp. 209-212.
[7] P. N. Wilson, H. J. Orchard, A Design Method for Half-Band FIR Filters,
IEEE Transactions on Circuits and Systems - I: Fundamental Theory and
Applications, Vol. CAS - 46, No. 1, January 1999, pp. 95 - 101.
[8] P. Zahradnik, M. Vlˇcek, R. Unbehauen, Almost Equiripple FIR Half-Band
Filters,
IEEE Transactions on Circuits and Systems - I: Fundamental
Theory and Applications, Vol. CAS - 46, No. 6, June 1999, pp. 744 -
748.
[9] P. Zahradnik, M. Vlˇcek,
Equiripple Approximation of Half-Band FIR
Filters, IEEE Transactions on Circuits and Systems II: Express Briefs,
Vol. 56, No. 12, December 2009, pp. 941-945.
[10] M. Abramowitz, I. Stegun, Handbook of Mathematical Function, Dover
Publication, New York Inc., 1972.
APPENDIX I
In the following considerations, the identities
2nUn−1(w) = dUn(w)
dw
− dUn−2(w)
dw
(20)
dU2n−1(w)
dw
=
n−1
X
k=0
2(2k + 1)U2k(w)
(21)
dU2n(w)
dw
=
n
X
k=1
2(2k)U2k−1(w)
(22)
wdU2n−1(w)
dw
=
n−1
X
k=0
(2k + 1) [U2k+1(w) + U2k−1(w)]
(23)
wdU2n(w)
dw
=
n
X
k=1
2k [U2k(w) + U2k−2(w)]
(24)
are useful. For the three terms in the differential equation (10)
we get the relations
w(w2 − κ′2)

(1 − w2)d2Un(w)
dw2
− 3wdUn(w)
dw

=
n
X
k=0
−α(2k)k(k + 1)1
2 [U2k+3(w) + 3U2k+1(w)
+ 3U2k−1(w) + U2k−3(w)]
+κ′2α(2k)4k(k + 1)1
2 [U2k+1(w) + U2k−1(w)] (25)

247
International Journal on Advances in Telecommunications, vol 4 no 3 & 4, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

κ′2(1 − w2) + 2w2(1 − w2)
 dUn(w)
dw
=
n
X
k=0
α(2k)κ′2 [(k + 1)U2k−1(w) − kU2k+1(w)]
+ α(2k)1
2 [(k + 1)(U2k+1(w) + 2U2k−1(w) + U2k−3(w))
− k(U2k+3(w) + 2U2k+1(w) + U2k−1(w))]
(26)
and
4w3n(n + 2)Un(w) =
n
X
k=0
n(n + 2)α(2k)1
2 [U2k+3(w) + 3U2k+1
+ 3U2k−1 + U2k−3(w)] .
(27)
By collecting and summing of the coefﬁcients belonging to
the particular degree of the Chebyshev polynomial we get
U2k+3(w) : 1
2 [n(n + 2) − k(k + 2)] α(2k)
(28)
U2k+1(w) : 1
2 [3(n(n + 2) − k(k + 2))
+ 2k + 1 + 2k(2k + 1)κ′2
α(2k)
(29)
U2k−1(w) : 1
2 [3(n(n + 2) − k(k + 2)) + 2(2k + 1)
+ 2(k + 1)(2k + 1)κ′2
α(2k)
(30)
U2k−3(w) : 1
2 [n(n + 2) − (k − 1)(k + 1)] α(2k) .
(31)
By manipulation of k in (28)-(30) we get
1
2 [n(n + 2) − (k − 3)(k − 1)] α(2k − 6)
(32)
1
2 [3(n(n + 2) − (k − 2)k) + 2k − 3
+ 2(k − 2)(2k − 3)κ′2
α(2k − 4)
(33)
1
2 [3(n(n + 2) − (k − 1)(k + 1)) + 2(2k − 1)
+ 2k(2k − 1)κ′2
α(2k − 2)
(34)
1
2 [n(n + 2) − (k − 1)(k + 1)] α(2k) .
(35)
The initial values α(2n), α(2n−2) and α(2n−4) follow from
(28)-(31). For k = n we get from (28) the relation
[n(n + 2) − n(n + 2)] α(2n) = 0
(36)
which is fulﬁlled for arbitrary value α(2n). Let us choose the
value (Tab. I)
α(2n) =
1
(1 − κ′2)n .
(37)
For k = n − 1 we get from (28) and (29) the relation
(n(n + 2) − (n − 1)(n + 1))α(2n − 2)
+(2n + 1 + 2n(2n + 1)κ′2)α(2n) = 0
(38)
yielding the initial value α(2n − 2) (Tab. I).
α(2n − 2) = −(2nκ′2 + 1) α(2n)
(39)
Finally, from (28)-(30) for k = n − 2 we get
2nα(2n − 4)
+ (4n + 1 + (n − 1)(2n − 1)κ′2)α(2n − 2)
+ (2n + 1)((n + 1)κ′2 + 1)α(2n) = 0
(40)
which yields the initial value α(2n − 4) (Tab. I). The formula
for the evaluation of the remaining coefﬁcients α(2k−6) (body
in Tab. I) follows from (32)-(35).

248
International Journal on Advances in Telecommunications, vol 4 no 3 & 4, year 2011, http://www.iariajournals.org/telecommunications/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
APPENDIX II
% Design of Equiripple Half-Band FIR Filter
%
clear, clf reset,
adB=-80;
% Specifications for Example No. 2
omp=0.475*pi;
A00=-33.64775299940740; A01=-29.13196870512581;
A10= 18.18840663850262; A11 =18.54155180910656;
N=(adB-A10*omp-A00)/(A11*omp+A01); N=ceil(N);
k00=-0.00665856769717; k01= 1.57111377495119;
k10= 0.37221483652163; k11=-1.01927559802890;
k=(N*omp-k01*N-k00)/(k11*N+k10);
a12=0.01525753184125;
a11=0.03682344002622;
a10=9.24760314166335;
a01=1.01701406973534;
a00=0.73512297663750;
b12=0.00233666682716;
b11=-1.35418408482371;
b10=5.75145813400838;
b01=1.02999650170704;
b00=-0.72759508233144;
AA=(a12*N*N+a11*N+a10)*k+a01*N+a00; BB=(b12*N*N+b11*N+b10)*k+b01*N+b00;
h1=h_uarg(N,k); h2=h_uarg(N-1,k); h = h1_plus_h2(AA*h1,BB*h2);
w01=sqrt(k*k+(1-k*k)*(cos(pi/(2*N+1)))ˆ2); om01=acos(-w01);
vals=abs(freqz(h,1,[om01 pi]));
if 2*floor(N/2)==N
extr=vals(2);
else
extr=-vals(1);
end
NN=1+2*(2*N+1);
N2=floor(NN/2);
hleft=h(1,1:N2);
hright=h(1,N2+2:NN);
h=[hleft/(2*extr) 0.5 hright/(2*extr)]; % Impulse Response
[H,om]=freqz(h,1,10000);
figure(1),
plot(om/pi,20*log10(abs(H))), grid on, axis([0 1 -100 5]),
xlabel(’\omega T/ \pi’), ylabel(’20log|H(eˆ{j \omega T})| [dB]’),
function [alfa,kc]=uarg(n,kc)
%
if n==0
alfa(2*n+1)=1/(1-kc*kc)ˆn;
elseif n==1
alfa(2*n+1)=1/(1-kc*kc)ˆn; alfa(2*n-1)=-(2*n*kc*kc+1)*alfa(2*n+1);
else
alfa=zeros(1,2*n+3);
%initialization
alfa(2*n+1)=1/(1-kc*kc)ˆn; alfa(2*n-1)=-(2*n*kc*kc+1)*alfa(2*n+1);
alfa(2*n-3)=-(4*n+1+kc*kc*(n-1)*(2*n-1))/2/n*alfa(2*n-1)-(2*n+1)*((n+1)*kc*kc+1)/2/n*alfa(2*n+1);
m=n;
% recursion
for j=m:-1:3
c7=m*(m+2)-(j-3)*(j-1); c5=3*(m*(m+2)-(j-2)*j)+2*j-3 + 2*(j-2)*(2*j-3)*kc*kc;
c3=3*(m*(m+2)-(j-1)*(j+1))+2*(2*j-1)+ 2*j*(2*j-1)*kc*kc; c1=m*(m+2)-(j-1)*(j+1);
alfa(2*j-5)= - (c5*alfa(2*j-3) + c3*alfa(2*j-1)
+ c1*alfa(2*j+1))/c7;
end
end
function h=h_uarg(m,k)
%
a=uarg(m,k);
ai=0;
for j=0:1:m,
ai(1+2*j)=a(1+2*j)/(1+2*j);
end
ai=[0 ai];
h=a2h(ai);

