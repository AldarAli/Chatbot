Yasunori Iwanami 
Dept. of Computer Science and Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: iwanami@nitech.ac.jp 
Abstract— In this paper, we have proposed the novel 
demodulation scheme of MFSK (M-ary Frequency Shift 
Keying) signals on MIMO frequency selective channel. For 
demodulating MIMO MFSK signals, we previously used the 
FDE (Frequency Domain Equalization) using CP (Cyclic 
Prefix). In order to further improve the BER characteristics, 
the novel scheme using MLD (Maximum Likelihood 
Detection) with ISI canceller and ZP (Zero Padding) has been 
considered. We further reduced the receiver complexity by 
replacing MLD with M algorithm. Through computer 
simulation, we have verified that the proposed scheme using M 
algorithm with ISI canceller exhibits the excellent BER 
characteristics compared with the FDE with CP. 
Keywords-MIMO, MFSK, ISI, IAI, MLD, M-algorithm, FDE, 
Multipath channel 
I. INTRODUCTION 
 
MFSK signal has the constant envelope property and is 
appropriate to be amplified by nonlinear amplifier with high 
power efficiency. However, as the MFSK is the nonlinear 
modulation scheme, the equalization at the receiver side has 
been difficult when it is subjected to frequency selective 
channels. On the other side, due to the increasing demand 
of high data rate and reliable data transmission, MIMO 
(Multiple Input Multiple Output) schemes with multiple 
transmit and receive antennas become quite popular 
recently. The conventional MIMO scheme processes the 
received signals using the linear matrix processing. 
However it has been difficult to apply the linear processing 
to the nonlinear modulation such as MIMO MFSK, and 
accordingly there was almost no research on MIMO FSK. 
So, we aimed to develop the MIMO FSK transmission 
scheme. 
 
TABLE I LIST of PARAMETERS 
S
N : Transmission block length 
G
N : Number of zero symbols 
2c : Number of samples per symbol 
sT : Symbol duration 
t
 : Sampling interval; 
s /(2 )
t
T
c
 
 
k : time index; present time 
(
L 1) s
 T
: Maximum symbol delay time 
M : Number of modulation level 
Tn : Number of transmit antenna 
R
n : Number of receive antenna 
J : Total number of delay paths 

: Delay path interval 
c
M : Parameter of M algorithm 
Kenji Nakayama 
Dept. of Computer Science and Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: nakayama@rose.nitech.ac.jp 
 
We had already shown that the FDE (Frequency Domain 
Equalization) scheme using CP (Cyclic Prefix) [1] is 
applicable to the signal separation and equalization of 
MIMO MFSK signals [2]-[4], where the FDE is done 
before the demodulation process of MFSK signal. This 
method was originally developed for SISO (Single Input 
Single Output) FSK signals [5]. In this paper, in order to 
improve the BER characteristics as well as the receiver 
complexity of previously developed schemes [2]-[4], we 
consider here the demodulation of MIMO MFSK where the 
MLD with ISI canceller using ZP is adopted. The receiver 
minimizes the Euclidian distance between the receive signal 
and the receive signal replica of candidate transmit signal. 
Moreover, we have replaced the MLD by M-algorithm to 
further reduce the receiver complexity. We have verified 
that the proposed receiver structure using M-algorithm with 
ISI canceller exhibits the excellent BER characteristics 
compared with the FDE with CP. 
 
II. MIMO MFSK DETECTION USING MLD WITH ISI 
CANCELLER 
 
We consider the detection scheme of MFSK using MLD 
with ISI canceller in time domain, which improves the BER 
performance compared with the FDE scheme using CP 
[2]-[4]. In Fig. 1, we show the block diagram of MIMO 
MFSK transmission scheme having the receiver using MLD 
with ISI canceller operating in time domain. At the 
transmitter side, as shown in Fig. 2, 
S
N  MFSK modulated 
symbols with 
NG
 ZP symbols (zero symbols) are 
transmitted from each transmit antenna. The ZP symbols are 
required to circumvent the Inter Block Interference (IBI) 
between the successive blocks caused by the multipath 
delay. The ZP is also used to reset the initial phase of 
continuous phase MFSK signal to be zero at the beginning 
of the transmit block. The reset of initial phase of 
continuous phase MFSK signal is necessary for generating 
the 
receive 
signal 
replica 
for 
MLD 
with 
phase 
synchronization at the receiver. Terminating the transmit 
symbol block by ZP is also useful to prevent the error 
propagation caused by erroneous ISI cancellation at the 
receiver. At the receiver side, the detection of Inphase and 
Quadrature (I and Q) components of MFSK symbols with 
the block length of (
)
S
G
s
N
N
T

 is done to get the 
complex baseband symbols. Then the discrete time samples 
at the sampling rate of 2c  per one symbol duration 
sT  
are taken in time domain, i.e., the sampling interval of 
MLD-based MFSK Demodulation on MIMO Frequency Selective Fading Channel 
30
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

 
 
Fig. 1 Block diagram of transmit and receive system of MIMO MFSK 
using MLD with ISI canceller on frequency selective channel 
 
 
Fig. 2 Transmit signal block and Zero Padding (ZP) at the transmitter side 
 
 
Fig. 3 Relation between transmit and receive signals on multipath delay 
channel in the case of SISO and symbol delay time 
  
s /(2 )
t
T
c
 
. We define the present time index as k  and 
the maximum symbol delay time due to multipath channel 
as (
1)
s
L
T

. For simplicity, we also assume the SISO 
(1 1)

 transmission in the subsequent illustration. As 
shown in Fig. 3, to detect the symbol transmitted at time k  
using MLD, we need the total L  receive symbols over the 
symbol time 
(
1)
k
k
 L

, because the transmit signal at 
time 
k  spreads over the receive symbols during 
(
1)
k
k
 L

. As those L  receive symbols contain the 
transmit 
symbol 
components 
over 
(
1)
k
 L

 to 
(
1)
k
 L

, it is required for the MLD to search all the 
transmit 
symbol 
pattern 
over 
(2
L 1)
 symbols. 
Accordingly, the number of searches in MLD becomes 
(2
L 1)
M
  in the case of SISO [6]. 
We now consider the symbol time k  in Fig. 3 as the first 
data symbol in Fig. 2, i.e., we let 
k 1
. Then all the 
transmit symbols 
(
1)
1
,
,
k
L
k
s
s


  are zero, because they 
are included in ZP duration. After receiving total L  
symbols of 
(
1)
,
,
k
k
L
r
r 
 , the first transmit symbol 
ks  
is detected using the MLD. The next 
k
L
r   is then received 
and the second transmit symbol 
1
ks   is also detected by 
using MLD. However, the ISI components caused by the 
first transmit symbol 
ks  is removed through the ISI 
canceller before the MLD by subtracting the hard receive 
replicas from the received signals. Similarly, after receiving 
the next receive symbol 
1
k
L
r   , the third transmit symbol 
ks 2
 is detected by using MLD, however the ISI 
components due to 
ks  and 
1
ks   are cancelled by the ISI 
canceller before the MLD operation. Likewise, the 
subsequent transmit symbol 
,
3 ~
k i
S
s
i
N


 is detected 
using MLD, however the ISI components caused by the 
transmit symbols already detected are cancelled by the ISI 
canceller. The ISI cancellation reduces the number of 
searches of MLD from 
(2
L 1)
M
  to 
M L
. The metric of 
MLD is taken as the squared Euclidian distance between the 
receive symbols after ISI cancellation and the receive 
symbol replicas corresponding to the candidate transmit 
symbols over L  symbol duration. The transmit symbol is 
then detected so as to minimizes the metric of MLD [6]. 
The proposed signal separation and equalization algorithm 
is illustrated in detail as follows. The channel matrix H  is 
expressed as 
0
1
0
1
0
1
0
0
0
0
0
0
0
0
l
J
l
J
l
J









 





h
h
h
H
h
h
h
h
h
h
        (1) 
where 
Tn  and 
nR
 are the numbers of transmit and 
receive antennas respectively. The element 
lh  in (1) is also 
the matrix expressed as 
( )
( )
( )
11
12
1
( )
( )
( )
21
22
2
( )
( )
( )
1
2
,
0,
,
1
T
T
R
R
R T
l
l
l
n
l
l
l
n
l
l
l
l
n
n
n n
h
h
h
h
h
h
l
J
h
h
h

















h
      (2) 
where 
 l
hji
 is the complex channel gain of l -th delayed 
path from transmit antenna i  to receive antenna j  and 
J  is the total number of delay paths. 
The delay profile between transmit antenna i  and receive 
antenna j  is shown in Fig. 4, where the maximum delay 
time is (
1)
J


 . 
The transmit symbol vector, the receive symbol vector and 
the receive noise vector at symbol time k  are expressed as 
follows. 
Transmit symbol vector at symbol time k : 


 
 




1
,2
,
,1
,
,
,
,
,
,
,
,
,
,
,
,
T
T
T
i
n
k
k
c
k q
k
k q
k q
k q
k q
x
x
x


X
x
x
x
, x
Receive symbol vector at symbol time k : 


 
 




1
,2
,
,1
,
,
,
,
,
,
,
,
,
,
,
,
R
T
T
j
n
k
k
c
k q
k
k q
k q
k q
k q
y
y
y


Y
y
y
y
, y
 
(3) 
Receive noise vector at symbol time k : 


 
 




1
,2
,
,1
,
,
,
,
,
,
,
,
,
,
,
,
R
T
T
j
n
k
k
c
k q
k
k q
k q
k q
k q
n
n
n


N
n
n
n
, n
 
where the element vector 
,
xk q
 in 
k
X  is the sampled 
 
 
Fig. 4 Delay profile between transmit antenna i and receive antenna j on 
MIMO frequency selective channel 
M-FSK
mod.
M-FSK
mod.
ISI
Canceller
MLD
Data bit
Data bit
I-Q
detec.
I-Q
detec.
Sampling
ZP
ZP
Data bit
Data bit
Detected data bits
Data
(1)
Data
(NS)
ZP
(1)
・・・
ZP
(NG)
・・・・・・
1symbol :Ts
t
1block length


S
G
s
N
N
T


Initial phase reset
ZP
NSTs
NGTs
・・・
・・・
2
1
1
(
1)
1
1
(
1)
L
L
L
k
L
k
k
k
k
L
s
s
s s
s








(
1)
k
k
L
L
r
r 

sT
2
sT
0
3
L 
0
1
2
Channel delay profile
in the case of symbol delay time

Transmit symbols
Receive symbols


0
t
(0)
ji
h
(1)
hji
(2)
ji
h
(
1)
J
hji

........
(
1)
J




2 

31
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

transmit vector at time (
1)
q
t

  in symbol time k  with
1
2
q
c

 and 
s /(2 )
t
T
c
 
. Accordingly, one symbol 
duration 
sT  is sampled at every small time interval 
t
 . 
For 
example, 
16 (
2 )
 c
 sample 
vectors 
,16
,
,1
,
,
,
,
k
k q
k
x
x
x
 are obtained for 
k
X . Also 
 
,
i
xk q
 in 
,
xk q
 is the sampled transmit symbol from transmit antenna 
i  at time (
1)
q
t

  in symbol time k . 
,
yk q
 in 
k
Y , 
 
,
i
yk q
 
in 
,
yk q
, 
,
nk q
 in 
k
N  and 
 
,
i
nk q
 in 
,
nk q
 have the same 
meaning as 
,
xk q
 in 
k
X  and 
 
,
i
xk q
 in 
,
xk q
. 
The transmit and receive equation is expressed as 






(
1)
(
1)
(
1)
(
1)
,
,
,
,
,
,
,
,
T
T
k
L
k
k
L
k
k
L
T
k
L
k










Y
Y
H X
X
X
N
N
       (4) 
where L  is 
(
1)
/
1
s
L
J
 T








 and 
x
 
   denotes the 
minimum integer number greater than or equal to x . 
(
1)
s
L
T

 also means the maximum symbol delay time. 
We further illustrate the transmit and receive equation in 
detail by setting 
2
T
R
n
 n

, 
L  2
 and 
2
J
 c
 for 
simplicity of explanation. 
The element 
 
 
1
2
,
,
,
,
,
,
,
(
1),
1
2
,
p q
p q
y
y
p
k
k
L
q
c




 
of receive vector 
 j
yp
 in (3) are represented as follows. 
 
 
 
 
 


 


 
 
 
 


 


 
 
 
 
 
 


 


 
 
 
 


 


 
 
 
 
1
0
1
1
1
2
1
1
,1
11
,1
11
1,2
11
1,2
0
2
1
2
2
1
2
1
12
,1
12
1,2
12
1,2
,1
1
0
1
1
1
2
1
1
,2
11
,2
11
,2
1
11
,1
0
2
1
2
2
1
2
1
12
,2
12
,2
1
12
,1
,2
2
0
1
,1
21
,1
c
p
p
p
c
p
c
p
p
c
p
p
c
p
c
p
c
p
c
p
c
p
c
p
c
p
p
c
p
p
y
h
x
h x
h
x
h
x
h x
h
x
n
y
h
x
h x
h
x
h
x
h x
h
x
n
y
h
x





























 
 


 


 
 
 
 


 


 
 
 
 
 
 


 


 
 
 
 


 


 
1
1
2
1
1
21
1,2
21
1,2
0
2
1
2
2
1
2
2
22
,1
22
1,2
22
1,2
,1
2
0
1
1
1
2
1
1
,2
12
,2
12
,2
1
12
,1
0
2
1
2
2
1
2
2
22
,2
22
,2
1
22
,1
,2
c
p
c
p
c
p
p
c
p
p
c
p
c
p
c
p
c
p
c
p
c
p
c
p
p
c
h x
h
x
h
x
h x
h
x
n
y
h
x
h x
h
x
h
x
h x
h
x
n



























  (5) 
Here we elaborate on the elements 
 
 
1
1
,1
,2
,
,
k
k
c
x
x
 of the 
transmit symbol vector 
kx 1
 from transmit antenna 1 and 
 
 
2
2
,1
,2
,
,
k
k
c
x
x
 of the transmit symbol vector 
 
kx 2
 from 
transmit antenna 2. The channel responses of transmit 
symbol vectors 
 
 
1
2
 and 
k
k
x
x
 spread over the receive 
symbol vectors 
 
 
1
1
(
1)
,
,
k
k
 L

y
y
 and 
 
 
2
2
(
1)
,
,
k
k
 L

y
y
 
with the maximum symbol delay time of (
1)
s
L
T

 as 
illustrated in Fig. 3. In order to detect the transmit symbol 
vectors 
 
 
1
2
 and 
k
k
x
x
, the ISI components due to already 
detected symbols from symbol time 
(
1)
1
k
L
k


  
can 
be 
removed 
from 
the 
receive 
vectors 
of 
 
 
1
1
(
1)
,
,
k
k
 L

y
y
 and 
 
 
2
2
(
1)
,
,
k
k
 L

y
y
. The ISI cancelling 
vector 
p
Y  at symbol time p  is expressed as 
 




1
,
,
(
1
,
,
)
,
R
T
n
p
p
p
p
k
k
L




Y
y
y
       (6) 
where 
 
 
 


,2
,1
,
,
T
j
j
j
p
p
c
p
y
y

y
 is the element symbol 
vector for cancelling the ISI at receive antenna j  at 
symbol time p . Using the already detected symbols during
(
1)
1
k
L
k


  symbol period, 
p
Y  in (6) is derived as 


(
1) detected symbols
symbols
(
1)
1
(
1)
,
,
,
,
,
,
,
T
L
L
T
k
L
k
k
k
L















Y
Y
H
X
X
0
0
    (7) 
where 
,
1,
,
(
1)
p p
k
k
L




X
 are 
the 
already 
detected results. Next, using 
(
1),
,
k
L
k


Y
Y  in (7), the ISI 
is cancelled as follows. 
,
(
,
,
1)
ˆ
p
p
p
L
p
k
k





Y
Y
Y
              (8) 
where 
ˆ
p
Y  is the receive symbol vector after the ISI 
cancellation. Using the transmit signal 
p
X , receive noise 
N p
 and 
residual 
ISI 
component 
εp
,
ˆ ,
,
,
(
1)
p p
k
k
 L


Y
 in (8) is also represented as 








1 symbols
 symbols
(
1)
(
1)
(
1)
(
1)
,
,
,
,
,
ˆ
ˆ
,
,
,
,
,
T
L
L
T
k
L
k
k
L
k
T
T
k
L
k
k
L
k




















Y
Y
H
X
X
ε
ε
N
N
0
0
 
(9) 
The residual ISI component 
p
ε  is 0 , if the past decision 
results are correct. Also when the ISI cancellation is perfect 
and there is no noise, i.e., 
Np 
0 , it holds 




1 symbols
 symbols
(
1)
(
1)
ˆ
ˆ
,
,
,
,
,
,
T
L
L
T
k
L
k
k
L
k














Y
Y
H
X
X
0
0
    (10) 
where 
(
1),
,
k
L
k


X
X
 are 
transmit 
signals 
to 
be 
determined. 
 The transmit signal vector 
k
X  at the present symbol time 
k  is determined so as to minimize the squared Euclidian 
distance metric as shown below. 




(
1)
2
1 symbols
 symbols
(
1)
(
1
,
)
,
,
,
,
ˆ
ˆ
arg min
,
,
,
k
L
k
T
L
L
T
k
k
L
k
k
L
k





























X
X
X
Y
Y
H
X
X
0
0
 
(11) 
The above equation is the MLD criterion by which all the 
transmit vector patterns of 
(
1)
,
k
L
k


X
X  are searched to 
determine the transmit vector 
k
X  at symbol time k . In 
minimizing the metric in (11), all the L  transmit vectors 
from symbol time 
(
1)
k
k
 L

 are simultaneously 
searched, however only the transmit vector 
k
X  at symbol 
time k  is determined as the demodulated output. 
The BER characteristics of the proposed MLD with ISI 
canceller and the previously proposed FDE with CP are 
simulated under the simulation condition in Table II. The 
delay profile between each transmit and receive antenna is 
shown in Fig. 5. 
We show the BER results in Fig. 6. From Fig. 6, 
comparing with the FDE scheme with CP, the proposed 
MLD with ISI canceller achieves the gain of 13 dB at 
32
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

TABLE II SIMULATION CONDITION IN FIG. 6 
 
 
 
Fig. 5 Delay profile of multipath channel between each transmit and 
receive antenna in for Table II and Fig. 6 
 
5
BER
10
 for 1 1
 , and 16 dB for 2
 2
. Thus the 
proposed MLD with ISI canceller achieves far better 
equalization and signal separation capability than the 
previously proposed FDE scheme with CP. By removing 
the ISI caused by the symbols already detected, the MLD 
over L  symbol span becomes available regardless of the 
block length. The long block length of 
S
s
N T  circumvents 
the degradation of transmission rate due to the insertion of 
ZP into the block. 
 
 
 
Fig. 6 BER characteristics of 4FSK (h=0.7) on MIMO quasi-static 
multipath channel 
 
III. MIMO MFSK RECEIVER USING M ALGORITHM 
WITH ISI CANCELLER 
 
In the receiver structure proposed in section II, the ISI 
canceller reduces the amount of calculation in MLD. 
However, the complexity of MLD is still high when the 
number of transmit antenna 
Tn  and the maximum symbol 
delay time of (
1)
s
L
T

 become large. This is because 
when (
1)
s
L
T

 is large, the symbol vector 
k
X  detected 
at the symbol time k  influences L  future symbols, thus 
the MLD window size L  over the transmit symbol vectors 
(
1)
,
,
k
k
 L

X
X
 becomes large. In this section, we replace 
the MLD by the M algorithm to further reduce the amount 
of calculation in MLD. The M algorithm is the 
representative of breadth first search algorithms for the tree 
structure. Based on the MLD criterion in (11), the MLD 
metric is defined as 


2
 symbols
1 symbols
 symbols
(
1)
(
1)
ˆ
ˆ
,
,
,
,
,
,
T
T
L
L
L
k
L
k
k
L
k
























Y
Y
H
X
X
0
0
   (12) 
Now, we define the receive replica vector 
ˆ
Yp
, 
,
,
(
1)
p
k
k
L



, as 


 symbols
1 symbols
 symbols
(
1)
(
1)
ˆ
ˆ
ˆ
,
,
,
,
,
,
,
,
T
T
L
L
L
k
L
p
k
k
L
k



























Y
Y
Y
H X
X
0
0
   (13) 
where ˆ
p
Y  means the receive replica vector when assuming 
there is no ISI from the past symbol vectors transmitted. 
Using ˆ
p
Y  in (13), we can simplify eq.(12) as follows.
                
(
1)
2
ˆ
ˆ
k
L
p
p
p k



 

Y
Y
                     (14) 
Then we define the cumulative metric from the symbol time 
k  to 
( 1,
, )
i
L

 as 
(
1)
2
ˆ
ˆ
k
i
p
p
p k



 Y  
Y
                     (15) 
The cumulative metric in (15) at i
 L
 coincides with the 
MLD metric in (12). The above cumulative metric can be 
used as the likelihood criterion to determine the candidates 
of transmit symbol vectors up to i , i.e., 

1 ,
,
k
k
 i

X
X . 
Using this cumulative metric, the transmit symbol vectors at 
each step i  are selected from the total 
c
M (parameter of 
M algorithm) candidates. The parameter i  is increased at 
each step. The total number of searches in M algorithm 
becomes {1
(
1)
}
T
n
c
L
M
M



, where M  is the number 
of modulation levels. On the other hand, the total number of 
searches in MLD in section II is 
T
M n L
. By using M 
algorithm, the total number of searches are reduced greatly, 
because the parameter of L  is not included in the 
exponent. 
 To illustrate the M algorithm in the proposed scheme in 
detail, we show the case of 
2
T
R
n
 n

, 
L  3
, 
M  2
  
0
t
8
sT

 
sT
0
1
2
15
15
8
sT
8
sT
2
8
sT
2
sT
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
10
20
30
BER (Bit Error Rate)
Average Eb/N0 [dB] per receive antenna
Conventional 2×2 MIMO
FDE with CP
Conventional 1×1 SISO
FDE with CP
Proposed 1×1 SISO
ISI canceller with MLD
Proposed 2×2 MIMO
ISI canceller with MLD
Modulation 
M-ary FSK (M=4) 
Modulation index h  
h  0.7 
Channel model between Tx 
and Rx antenna 
Quasi-static Rayleigh fading channel with 
equal power 16 paths 
Interval of delay 

 
sT /8

 
 
Number of antennas 
SISO:1×1, MIMO:2×2 
Channel estimation 
Perfect at receiver 
Signal separation and 
equalization 
MLD with ISI 
canceller 
FDE-CP (MMSE) 
with energy detection 
[2]~[4], [7], [8] 
Number of divisions in one 
symbol: 2c  (
2
sT
 c t
 ) 
2c =16 
Transmit block length 
S
s
N T  
4
(
4)
s
S
T
N 
 
Length of ZP or CP 
2 sT  (ZP) 
2 sT  (CP for FDE) 
FFT size: 2
S
c
 N
 
---- 
64 
33
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

 
 
Fig. 7 Example of transmit and receive blocks (
Tn  2
,
L  3
,
M  2
) in 
M algorithm 
 
 
Fig. 8 Example of path selection in M algorithm (
Tn  2
,
L  3
,
M  2
,
2
c
M 
) 
 
 
and 
2
c
M 
 in Fig. 7 and Fig. 8, as an example for 
simplicity. 
 
<Step1> Calculation of cumulative path metric at 
1
i  (Fig. 
7) 
<Step2> Based on the cumulative path metric at 
1
i  , 
(
2)
Mc

 survival paths in the tree are selected. 
(Fig. 8) 
<Step3> By increasing i  one by one and repeating the 
step 1 and 2, the transmit data symbols with the 
survival path having the minimum cumulative path 
metric are determined at i
 L
. 
 
Using the above mentioned M algorithm, the BER 
characteristics of proposed detection scheme, i.e., M 
algorithm with ISI canceller, is simulated with the 
simulation condition listed in Table III and is shown in Fig. 
9. The delay profile between each transmit and receive 
antenna is the same as in Fig. 5. 
From Fig. 9, the BER characteristics near MLD are 
obtained with the value 
16
c
M 
 with less amount of 
calculation. Accordingly, we can say that the BER 
Table III SIMULATION CONDITION IN FIG. 9 
 
 
Fig. 9 BER characteristics of 4FSK (h=0.7) on MIMO 2×2 multipath 
channel 
 
characteristics approaching the MLD are achievable by 
selecting the appropriate value of 
c
M .The amount of 
calculation of MLD is proportional to 
T
M n L
, while the one 
of M algorithm is 
M nT
. Thus, we can cope with the 
channel with large symbol delay time of (
1)
s
L
T

 and also 
can handle the larger modulation level of M . 
 
IV. EVALUATION ON AMOUNT OF CALCULATION IN 
MIMO FSK RECEIVERS 
 
The amount of calculation in MIMO MFSK receiver is 
estimated through the number of complex additions and 
multiplications for demodulating one transmit symbol. In 
Table IV, the numbers of complex additions and 
multiplications per one symbol for MIMO FSK detection 
schemes are shown, where we set 
T
R
n
 n
 and the 
approximation 
of 
NS
L
 is 
assumed 
with 
the 
notification of 
   


2
2
3
T
A
c
J n




,  


2
2
R
B
c
J n
L



       (16) 
Under the condition in Table IV, the comparison of amount 
of calculation is evaluated and is shown in Fig. 10. When 
comparing the MLD with ISI canceller to the M algorithm 
with ISI canceller in Fig. 10, the amount of calculation of M 
algorithm with ISI canceller is far less than the MLD with 
Rx1
Tx1
Tx2
Rx2
Tx1
Data
(k)
Tx1
Data
(k+1)
Tx1
Data
(k+2)
Tx2
Data
(k)
Tx2
Data
(k+1)
Tx2
Data
(k+2)
Rx1
Data
(k)
Rx1
Data
(k+1)
Rx1
Data
(k+2)
Rx2
Data
(k)
Rx2
Data
(k+1)
Rx2
Data
(k+2)
i=2
i=3=L
i=1
Based on the transmit symbol candidates in this region, the receive symbol 
replicas in this region are generated and the cumulative metric is calculated.
Tx1
Data
(k+i-1)
Tx2
Data
(k+i-1)
0
0
1
0
0
1
1
1
0
0
1
0
0
1
1
1
0
0
1
0
0
1
1
1
Tx1
Data
(k+i)
Tx2
Data
(k+i)
Survival  paths selected based 
on the cumulative path metric 
Branches for calculating the cumulative path 
metric in the next step
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
5
10
15
20
BER
Average Eb/N0 [dB] per receive antenna
ISI canceller with 
M-algorithm  
(Mc=4)
ISI canceller with 
M-algorithm   
(Mc=8)
ISI canceller with 
M-algorithm   
(Mc=16)
ISI canceller with 
Full MLD
Modulation 
M-ary FSK (M=4) 
Modulation index: h  
h  0.7 
Channel model between Tx 
and Rx antenna 
Quasi-static Rayleigh fading channel with 
equal power 16 paths 
Interval of delay 

 
sT /8

 
 
Number of antennas 
MIMO 2×2 
Channel estimation 
Perfect at receiver 
Signal separation and 
equalization 
M-algorithm/MLD with ISI Canceller 
Number of divisions in one 
symbol: 2c  (
2
sT
 c t
 ) 
2c =16 
Transmit block length 
S
s
N T  
4
(
4)
s
S
T
N 
 
Length of ZP 
(
1)
2
s
s
L
T
T


 
34
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

ISI canceller. Although the FDE with CP is superior to other 
two schemes in complexity, the BER characteristic is 
inferior to the other two. Considering the moderate amount 
of calculation at the receiver and the excellent BER 
characteristics, the proposed M algorithm with ISI canceller 
will be considered as the best choice. 
 
TABLE 
IV 
NUMBER 
OF 
COMPLEX 
ADDITIONS 
AND 
MULTIPLICATIONS PER ONE SYMBOL TO BE 
DETECTED 
 
 
TABLE V CONDITIONS FOR EVALUATING THE AMOUNT OF 
CALCLATION IN FIG.10 
 
 
 
Fig. 10 Amount of calculation at the receiver (MIMO2×2,
sT /8

 
) 
 
V. CONCLUSIONS 
 
We have proposed the MFSK receiver structure using M 
algorithm with ISI canceller on MIMO frequency selective 
channels. Our previously proposed receiver structure 
utilized the FDE with CP for signal separation and 
equalization before the demodulation of MFSK signal 
followed 
by 
energy 
detectors, 
however 
the 
BER 
characteristic of FDE scheme with CP was a little bit poor. 
To improve the BER characteristics of FDE with CP, we 
have investigated the receiver structure using MLD with ISI 
canceller which has the excellent BER characteristics. 
Although the MLD with ISI canceller exhibits the excellent 
BER characteristics, the amount of calculation at the 
receiver, which increases exponentially with the number of 
transmit antenna 
Tn  and the MLD window size L , 
becomes large and is difficult actually to be implemented. 
In order to solve the complexity problem, the MLD is 
replaced by M algorithm. By selecting the appropriate value 
of M algorithm parameter 
c
M , the BER characteristic 
approaches the lowest value achievable by MLD. In the 
proposed M algorithm with ISI canceller, the receiver 
complexity increases exponentially only with the number of 
transmit antenna, thus we can reduce the receiver 
complexity. Accordingly the proposed receiver can cope 
with large delay time of multipath channels. We have 
developed the MIMO FSK receiver with low BER and 
modest complexity, which will be effective to increase the 
transmission rate of conventional SISO FSK channels. As a 
future study, the measurement of channel state information 
at the receiver will be needed to assess the actual BER 
degradation for practical applications. 
 
ACKNOWLEDGEMENT 
This study is partially supported by the Grants-in-Aid for 
Scientific Research 21560396 of the Japan Society for the 
Promotion 
of 
Science, 
the 
Telecommunications 
Advancement Foundation and the Sharp Corporation. The 
authors also acknowledge the helps of Dr. Eiji Okamoto and 
Mrs. Kazumi Ueda. 
REFERENCES 
[1] David 
Falconer, 
Sirikiat 
Lek 
Ariyavisitakul, 
Anader 
Benyamin-Seeyar, 
and 
Brian 
Eidson, 
”Frequency 
Domain 
Equalization for Single-Carrier Broadband Wireless Systems,” IEEE 
Commun. Mag., pp.58-66, April 2002. 
[2] Manabu Hijimoto, Yasunori Iwanami, and Eiji Okamoto, “A study 
on M-ary FSK with non-coherent detection on MIMO frequency 
selective channels,” Technical report of IEICE, RCS2008-230, 
pp.107-112, Mar. 2009 (in Japanese). 
[3] Kenji Nakayama ， Yasunori Iwanami, and Eiji Okamoto, “A 
comparative study of MIMO-MFSK with frequency and energy 
detection under frequency-selective fading channels” ，  IEICE 
Society Conference, B-5-34, Sep. 2009 (in Japanese). 
[4] Kenji Nakayama, Yasunori Iwanami, and Eiji Okamoto, “MIMO 
MFSK receivers using FDE and MLD on quasi-static frequency 
selective fading channels,” International Symposium on Information 
Theory and its Applications 2010 (ISITA2010), Taichung Taiwan, 
ES2-Mo-1, 6 pages, Oct. 2010. 
[5] Masahiro Maki and Yoshihiko Akaiwa, “An adaptive equalizer for 
FSK frequency detection,” IEICE Technical Report, RCS 93-54, 
pp.23-28, September, 1993 (in Japanese). 
[6] Satoshi Nakanobu, Yasunori Iwanami, and Eiji Okamoto, “A 
Comparative Study on Time Domain Sequential Equalizer with MLD 
and MLSE Equalizer on MIMO Frequency Selective Channels,” 
IEICE Trans. on Commun., vol.E93-B, No.11, pp.3197-3202, Nov. 
2010. 
[7] Yasunori Iwanami and Paul H. Wittke, “BER analysis of binary 
CP-FSK with energy detection and sequence estimation on frequency 
selective 
multipath 
channels”, 
International 
Conference 
on 
Communications (ICC’99), Vancouver, S21.3, vol.2, pp.833-837, 
June 1999. 
[8] Yasunori Iwanami and Paul H. Wittke, “Error Performance Analysis 
of an Energy Sequence Estimation Receiver for Binary FSK on 
Frequency-Selective Fading Channels, IEEE Trans. on Wireless 
Communications, Vol. 2, No. 2, pp. 260-269, March 2003. 
1.0E+02
1.0E+03
1.0E+04
1.0E+05
1.0E+06
1.0E+07
1.0E+08
0
2
4
6
8
10
12
14
16
18
Amount of complex additions and 
multiplications / symbol
Mc (Parameter of M algorithm)
ISI canceller 
with full MLD
ISI canceller 
with M-
algorithm
FDE with CP
FDE with CP 


2
2
2
10log
2
2
2
13
S
T
T
c N
c
n
n












 
MLD with ISI 
canceller 
nT
L
ALM
  B
 
ISI canceller with 
M-algorithm 


1 ( 2
2
1
2)
T
n
c
A M
M
L
L
B






 
Modulation 
M-ary FSK (M= 4) 
Modulation index: h  
h  0.7 
Channel model between 
Tx and Rx antenna 
Quasi-static Rayleigh fading channel with 
equal power 16 paths 
Interval of delay 

 
sT /8

 
 
Number of antennas 
MIMO 2×2 
Channel estimation 
Perfect at receiver 
Number of divisions in 
one symbol: 2c  
(
2
sT
 c t
 ) 
2c =16 
Length of ZP or CP 
2 sT  
Transmit 
block 
length 
S
s
N T  
8
S
N 
 
35
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

