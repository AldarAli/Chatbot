 
Rotated Constellations with Scaled Factor for High-Rate Full-Diversity STBC of 2 
and 4 Antennas 
Yier Yan
[1][2], Jun Li
[2], Tae Chol Shin
[2],  Moon Ho Lee
[2] 
School of Mechanical and Electric Engineering, Guangzhou University
[1], Guangzhou,  51006, PR China 
Dep. Electric and Computer Engineering Chonbuk National University
[2] 
 664-14 Deokjin-dong, Jeonju 561-756, Republic of Korea 
Email: year0080@gzhu.edu.cn, Junli0502@jbnu.ac.kr,   tcshin@naver.com,  moonho@chonbuk.ac.kr 
 
 
Abstract—We design a new 
rate − 5 4
 full-diversity orthogonal 
space-time block code (STBC) transmission scheme for QPSK 
with 2 transmitting antennas (TX) by one modified QPSK 
constellation with rotated and scaled factor by maximizing the 
CGD (coding gain distance) from the set of quaternions used in 
the Alamouti code. A low-complexity maximum likelihood (ML) 
decoding algorithm has been proposed that not only provide 
good FER (frame error rate) as same as 
rate − 1
 but also 
increase the transmitted rate approach the 
rate − 9 8
 without 
additional bandwidth. Finally, we extend the design to the case 
for 4 TX with low complexity by enlarging the set of Quasi-
Orthogonal STBC proposed in without power scaling. 
Extension 
to 
general 
M-PSK 
constellation 
is 
also 
straightforward is the simulation results. The simulation result 
shows that the proposed scheme provides a better Channel 
Throughput performance than the original work.  
 
Keywords-STBC;  ML; Constellation; High-rate; MPSK. 
I. 
 INTRODUCTION  
SPACE–TIME trellis codes have been introduced in [1] 
to provide an improved error performance for wireless 
systems with multiple transmit antennas. The authors have 
shown that such codes can provide full diversity gain as well 
as additional signal-to-noise ratio (SNR) advantage that they 
call the coding gain. Code design rules for achieving full 
diversity are also provided. Using these design rules, 
examples of codes with full diversity as well as some coding 
gain constructed are not necessarily optimal. Since there is 
no general rule for designing codes that provide diversity as 
well as coding gain, it is unclear how to design new codes 
for different number of states or different rates. Also, it is not 
clear how to improve the performance of the codes, i.e., how 
to maximize the coding gain. There have been many efforts 
to improve the performance of the original space–time trellis 
codes [2]–[5]. While very interesting codes have been 
proposed in the literature, the coding gain improvements are 
marginal for one receive antenna.  
In [8], the authors have proposed a class of STBCs for a 
high rate transmission scheme by exploiting the inherent 
algebraic structure for 2 and 4 transmit antennas. Compared 
with Alamouti and Jafarkhani schemes, the diversity gain is 
attenuated due to rotating or scaling one transmit matrix 
selected from the class. 
In this work, we provide a new structure for space–time 
trellis codes that guarantees full diversity and provides 
opportunity to maximize the coding gain. We also provide a 
systematic method to maximize the coding gain for a given 
rate (rate>1), constellation, and number of states. The main 
idea of the proposed scheme is to employ two different 
signal constellations, and each constellation contains the 
information of the transmitted bit. In order to achieve the 
best system performance, the design criterion is also 
introduced in this paper to maximize the CGD to get the 
optimum rotated angle and scaled factor. The simulation is 
also given to demonstrate the reliability of the proposed 
transmission scheme.  
The organization of the paper is as follows. In Section 
II, we briefly described the transmission scheme. Then, the 
proposed constellation is briefly introduced in Section III. In 
Section IV, the proposed algorithm is also produced to 
improve the system performance. Finally, simulation results 
are used to demonstrate the proposed scheme in Section V. 
II. 
TRANSMISSION SCHEME 
The objective in this paper is to design a new 
transmission scheme for high-rate (> 1) space-time block 
codes (STBC) by exploiting the QPSK constellation 
structure in existing orthogonal designs based on quaternions 
for 2 transmitting antennas [1] and quasi-orthogonal designs 
for 4 transmitting antennas [5]. The simplest example of a 
complex orthogonal design is the 2
× 2
 code 
             
1
2
1
2
*
*
2
1
(
,
)
x
x
G x x
x
x
=
−






                                  (1) 
proposed by Alamouti [1], where 
*
( )⋅  denotes the complex 
conjugate transpose and 
,
1,2
ix
∈s i
=
and 
{
}
1
2 ( 1
) .
s
i
∈
⋅ ± ±
 
This code achieves rate-1 at full diversity and enjoys low-
complexity ML decoding by employing matched filtering.  
The main idea of this paper is to enlarge the transmitted 
signaling set with maximized CGD [1] and full diversity. 
Then, we enlarge the signaling set based on the STBC 
Matrix 
1
2
(
,
).
G x
x
 Two different QPSK constellations 
29
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

proposed by rotating and scaling the conventional 
constellation are considered. The new constellation can be 
constructed by multiplying a suitable angle exp(
)
jθ and an 
amplitude .
λ  The mathematical equation considered in this 
paper 
to 
modify 
the 
QPSK 
is 
given 
by 
'
exp(
),
s
s
j
λ
θ
=
⋅
1,
,
λ
θ
π
≤
≤
 and
{
}
1
2 ( 1
) .
s
i
∈
⋅ ± ±
 
The two different constellations are given in the Fig. 1, in 
which the outer circle can be expressed the conventional 
QPSK constellation belonged to signal set.1 s  and the inner 
circle can be expressed as the modified signal constellation 
'.
s  A very important criterion will be greatly discussed and 
calculated in this paper derived in [2] det((
)'(
)),
i
j
i
j
C
C
C
C
−
−
 
and the difference of two codes can be defined as 
,
i
j
ij
C
C
D
−
=
here the entrance of  
Gi
belongs to 
constellation s, and each the entrance of  
'
j
G belongs to ',
s  
then we briefly prove that 
'
det(
)
ij
D Dij
 be full diversity, 
2
1
2
'
*
*
2
1
(1
)
(1
)
det(
)
det
(1
)
(1
)
j
j
ij
ij
j
j
x
e
x
e
D D
x
e
x
e
θ
θ
θ
θ
λ
λ
λ
λ
−
−




−
−




=




−
−
−






 
                   =
2
1
2
*
*
2
1
(1
)
(1
)
det
(1
)
(1
)
j
j
j
j
x
e
x
e
x
e
x
e
θ
θ
θ
θ
λ
λ
λ
λ
−
−




−
−








−
−
−




    (2)                      
while in terms of suitable angle θ and amplitude 
,
λ  the 
i
j
ij
C
C
D
−
=
 is full diversity. 
 
      Fig. 1 Conventional and proposed constellations 
          
Then, 
0
G and 
1
G are given here, the entrances of 
0
G  are 
selected from conventional QPSK constellation and the 
entrances of 
1
G  are selected from proposed constellation for 
the transmission scheme. We will use the expanded set S  to 
construct new high-rate (
> 1
) full diversity space-time block 
code with low decoding complexity and optimized available 
coding gain. 
               
1
2
0
1
2
*
*
2
1
1
2
1
1
2
*
*
2
1
0
0
(
,
,
0)
(
,
,
1)
,
,
j
j
j
j
x
x
G
x x b
x
x
x
e
x
e
G x x b
x
e
x
e
θ
θ
θ
θ
λ
λ
λ
λ
=
−
=
−


=






=




        (3)                                              
We will use the expanded set S  to construct new high-
rate (> 1) and full diversity space-time block code with low 
complexity decoding and optimized available coding gain. 
The space-time code 
0
G  is selected to transmit symbols 
while the additional bit 
0b is 0 to be transmitted. With this 
idea, 
1
G  is selected for transmitting 
0
b =1.
 Then, each 
transmission frame consists of two symbols by employing 
two different constellations with 5 information bits. Without 
additional system source, the transmission can be improved 
according such transmission scheme.  
III. 
THE PROPOSED CONSTELLATION FOR TWO ANTENNAS 
A. Design Criterions for the Proposed Constellation 
Consider two distinct codewords
,
'.
i
C Cj
∈ C
 In order to 
ensure full spatial diversity, the codeword difference 
matrix
i
j
ij
C
C
D
−
=
 between any two distinct codewords in 
the extended set C must be full rank [4]. When both 
codewords 
i
C  and 
j
C  belong to 
i
G  or 
Gj ,
 
ii
D  will be full 
rank. However if 
i
i
C
∈G
 and 
,
j
j i
C
∈ G ≠
 
ij
D  loses rank 
property. To restore full-diversity, schemes based on 
rotations of information symbols have been proposed (see 
e.g. [3], [7]). In this paper, we propose to rotate constellation 
and scale amplitude transmitted signals in 's  by a suitable 
angle θ  and λ  to guarantee full-diversity for maximizing 
the CGD. For a unit-radius QPSK constellation, the rotating 
result is the same with signal constellation for transmission. 
Consider two different codewords 
,
.
i
C Cj
∈ C
 In order to 
ensure full spatial diversity, the difference matrix 
i
j
ij
C
C
D
−
=
 between any two distinct codewords in the 
extend set  S must be full rank [2]. When both codewords 
i
C  
and 
j
C  belong to the 
0
G  or 
G1,
 
ij
D will be full rank. 
However, if 
0
i
C ∈ G
and 
1
Cj
∈ G
 (or vice versa), 
ij
D  lose full 
rank property. To restore full-diversity, the scheme based on 
rotations of information symbols has been proposed [4]. For 
a unit-radius QPSK constellation, the different angle should 
guarantee that the proposed constellation is different from 
the traditional constellation. Then, the coding gain matrices 
between two different code works should be full rank to 
achieve the higher determinant as large as possible. The 
optimum combination of angle θ   and λ should follow such 
rule to design the constellations. 
 
B. Optimum Values of Angle θ  and Amplitude λ  
With different angle θ   and λ values, the system 
performance should be different. The main idea to 
introducing the angle θ   and λ  is to ensure full diversity for 
the proposed high-rate STBC. One important selection 
criteria for θ   and λ is to maximize the determinate of the 
CG with different combinations of θ   and .
λ  In addition, 
CG is defined as the minimum product of nonzero singular 
values of 
ij
D  for overall distinct codewords pairs. In order to 
ensure full spatial diversity, the codeword difference matrix 
30
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

(
) (
)
(
)
det
i
j
i
j
C
C
C
C
∗
−
−
 between 
any 
two 
distinct 
codewords in the extended set S  must be full rank. 
(
) (
)
det
ˆ
1
1
1
1
det
1
1
1
1
i
j
i
j
j
j
j
j
j
j
j
j
C
C
C
C
e
e
e
e
e
e
e
e
θ
θ
θ
θ
θ
θ
θ
θ
λ
λ
λ
λ
λ
λ
λ
λ
∗
∗
−
−
−
−


−
−
=







 

−
−
−
−



 




 



−
−
−
−

 



 (4)                                         
While difference matrix 
i
j
ij
C
C
D
−
=
 is a full rank 
matrix, det(
)
0.
ij
D Dij
∗
≠
 The optimum value of angle θ   and 
λ  while det(
)
ij
D Dij
∗
 is maximized by using the first 
derivative property. 
                                            
(
)
(
)
*
ij
ij
*
ij
ij
2
d det(D D )
=0
dθ
d det(D D )
=0
dλ
(sin
cos )
0
4
,
sin
0
1
2
λ
θ
θ
θ
π
λ
λ
θ
λ


−
=
=





⇒



−
=
=






 
                                                                                            (5)                                                                                                      
Here, the optimum value of angle θ   and λ  are derived 
from these formulas. The candidate of QPSK signal 
constellation can be obtained by the optimum values of angle 
θ  and .
λ  Then, the traditional QPSK signal constellation is 
the 
collection
{
}
1
2 ( 1
) ,
s
i
∈
⋅ ± ±
 and 
the 
proposed 
constellation 
also 
exits 
in 
another 
collection 
{
}
'
exp(
)
1 2,
.
s
s
j
i
λ
θ
∈
= ±
±
  
C. Low Complexity Decoding Algorithm 
The output symbols 
[
]
1
, 2
T
R
= r r
  received vector over 
two consecutive symbol periods can be represented as 
follows: 
               
HSGi
N
=
+
R
 , 
1
2
*
*
2
1
h
h
h
h


= 

−



H
                      (6) 
where R  are 1×2 complex matrix representations of the 
received signals corresponding to the transmitted codewords 
in the form of 
i
G  and 
j i ,
G ≠
 respectively. The path gains 
from the two transmit antennas to the mobile is Η that are 
independent 
and 
identically 
distributed 
(i.i.d) 
with 
2
~
(0,
)
ih
CN
σ
and 
(
)
0
i
E h hj
=
if 
.
i
≠ j
 The channel is 
assumed to be known perfectly at the receiver and the noise 
samples 
1
2
[
,
]
T
N
N
N
=
 are independent samples of a zero-
mean complex Gaussian random variable. The channel 
matrix Η is a quaternion and we have 
(
)
2
2
*
1
2
2
HH
h
h
I
=
+
. 
Two simple matched-filtering operations,
*
i
H G  and 
*
i
j
H G ≠  
are performed to generate two candidate solutions, namely, 
ˆ
iS and ˆ
j i
S ≠ which are then compared using the metric 
                      
2
1
2
argmin
,
T
s
S
r r
HS




=
−

                    (7) 
The decoding result for 
b0
 follows directly once the 
decision between 
iS  or 
j i
S ≠  is made. Now we begin to state 
the decoding algorithm for the proposed high-rate scheme. 
At first, the transmitted codewords can be divided into two 
parts of 
S,
 which can be expressed as mathematical 
expression 
{
}
1
, 2
S
= S S
. These two different subsets 
1
, 2
S S within the set can be used to transmit 
1,
1,
G i
S
i
∈
∀ and 
2,
2,
G i
S
i
∈
∀
 with the additional bit for transmission, 
respectively. The decoding algorithm can be divided into 
three steps by using (7) 
1. Following the decoding criterion formula (7), one 
constellation of set 
1
, 2
S S  is selected to decode the 
transmitted codes through the received vector. 
Without loss of generality, at the first step, 
1S  is 
selected to decode and note the metric of the 
decoding result and
[
]
2
1
1
1
, 2
T
d
r r
HG
=
−

, 
1
G  is the 
decoding result in our decoding procedure.  
              
1
1
1
2
1
2
argmin
,
T
s
G
r r
HS


=

 −

 
2. At this step, another subset 
2
S  is selected to 
decode the transmitted codes as the same procedure 
with step 1, and note the metric of this step 
2
2
2
1
, 2
T
d
r r
HG


= 
 −

 
3. To compare with the metrics of previous two steps 
and select the maximum value between two metrics, 
the transmitted codes and the additional bit can be 
obtained through the three steps. 
Comments: Although the proposed algorithm can improve 
the system transmission rate, the decoding algorithm should 
be more complicated then the original algorithm with more 
adders and multipliers achieving high rate property. 
IV. 
EXTENTION TO 4 ANTENNAS CASE 
Consider the following example of a candidate of the 
STBC with rate-1 and full-diversity complex quasi-
orthogonal design based on Quasi-orthogonal STBC 
proposed by Jafarkhani [5]. In our proposition, we extend the 
set of transmitted signal constellation by a multiplied factor 
of 
exp(
j )
λ
θ  to the quasi-orthogonal entrance selected from 
the conventional signal constellation.  
1
2
3
4
*
*
*
*
2
1
4
3
*
*
*
*
3
4
1
2
4
3
2
1
x
x
x
x
x
x
x
x
G
x
x
x
x
x
x
x
x




−
−


= 

−
−




−
−


                                             (8) 
31
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

We expand the signaling set and increase the rate to 9 8 
(for QPSK) by considering the following signal multiplied 
by the multiplying the factor
exp(
j ).
λ
θ  
1
2
3
4
*
*
*
*
2
1
4
3
0
1
2
3
4
0
*
*
*
*
3
4
1
2
4
3
2
1
( ,
,
,
,
0)
x
x
x
x
x
x
x
x
G x x x x b
x
x
x
x
x
x
x
x




−
−


=
= 

−
−


−
−


           (9) 
 
1
2
3
4
*
*
*
*
2
1
4
3
1
1
2
3
4
*
*
*
*
3
4
1
2
4
3
2
1
0
( ,
,
,
,
1)
j
j
j
j
j
j
j
j
j
j
j
j
j
j
j
j
x
x
x
x
x
x
x
x
G x x x x
x
x
x
x
x
x
x
x
e
e
e
e
e
e
e
e
b
e
e
e
e
e
e
e
e
θ
θ
θ
θ
θ
θ
θ
θ
θ
θ
θ
θ
θ
θ
θ
θ
−
−
−
−
−
−
−
−
−
−
=
−
−
−
−






=






   
To compare these different STBCs, the transmission scheme 
is almost the same with the two antennas case with different 
rotating angles about the original signal constellation. 
The CGD (coding gain distance) between a pair of 
codewords 
1
2
3
4
C=G(s ,s ,s ,s )  and 
1
2
3
4
C =G(s' ,s' ,s ,s )
'
'
'
 from 
the QOSTBC is given by                                                           
           
'
' H
'
2
2
2
1
1
4
4
2
2
3
3
2
2
2
1
1
4
4
2
2
3
3
CGD(C,C )=det D(C,C ) D(C,C )
( (s -s' )+(s -s' )
+ (s -s' )-(s -s' )
)
=( (s -s' )-(s -s' )
+ (s -s' )+(s -s' ) )




⋅
        (10) 
Then, in order to simplify these formulas, we replace 
1
x  
with 
1
1
s -s' ,
x2
 with 
2
s -s'2
,
x3
 with 
3
3
s -s' ,and 
x4
 with 
4
4
s -s'
2
2
3
2
2
4
1
2
2
3
2
2
4
1
)
) (
(
)
det(
x
x
x
x
x
x
x
x
G H G
−
+
+
+
+
−
=
 (11)                                              
To derive the optimum values of angle θ  and λ , the 
simpler first derivative of det(
)
H
G G  also calculates. 
        
3
4
2
2
4
3
2
2
(det(
))
(cos
sin
cos
)
(det(
))
3
cos
sin
sin cos
H
H
d
G G
d
d
G G
d
λ
θ
θ
θ
λ
λ
θ
θ
λ
θ
θ

=
−


=
−

    (12) 
,
1
3
θ
π λ
⇒
=
=
                                                           
Here, a similar way can be used to calculate the optimum 
values of angle θ  and λ , the values derived are used to 
construct the new transmitted signal constellation according 
our proposed motivation in this paper. 
V. 
NUMERICAL RESULTS 
In this section, we show some simulation results for the 
proposed transmission scheme. Fig. 2 shows the BER 
performances versus SNR to compare the proposed design 
with the Almouti code and Quasi-orthogonal [5] equipped 
with 2 or 4 transmitting and receiving antennas. The 
proposed transmission scheme simulated in this figure has a 
similar performance with Quasi-orthogonal above 20dB. 
QPSK modulation, 8PSK modulation and flat fading channel 
are considered in all simulations. In the high SNR region 20-
25 dB of Fig. 1, the BER performance of proposed scheme 
with a high rate-9/8 transmission is similar to Quasi-
orthogonal code, but there also exists a visible gap in the low 
SNR region 10-20dB. Moreover, the BER performance of 
proposed design is almost 1-2dB away from the conventional 
Almouti code and Quasi-orthogonal at the BER of 
-5
10 .  
 
                       Fig. 2 Comparisons of FER Performance 
 
In Fig. 3, we compare our proposed rate- 5/4 code with 
the Alamouti [1] code and rate- 9/8 code with the Quasi-
orthogonal code [6] using the measure of Effective 
Throughput η  defined as: 
                    
2
(1
)
log (
),
FER
R
M
η =
−
∗
∗
                       (13) 
where R is the code rate,  and M is the constellation size, and 
FER denotes the frame error rate, and means the frame error 
rate, and each frame contains 4 symbols (9 bits plus one 
additional bit). The Fig. 3 shows that at high SNR, our code 
achieves a higher throughput level of channel use (PCU) 
whereas the achievable throughput for the Alamouti code [1] 
PCU. Fig. 3 also depicts the achievable throughput of a 
rate − 9 8
code that uses pure rotations to ensure full-
diversity and maximize coding gain. The proposed 
transmission scheme achieves 2.25 bits per channel 
transmission whereas the effective throughput of the 
QOSTBC is 2 bits. A crossing point exits at a SNR level of 
20dB. Similarly, the effective throughput performance of 
high rate-9/8 [8] is also simulated in this figure. From 20dB 
to 30dB of SNR, the effective throughput has been improved 
compared to [8] due to low FER in the proposed design. This 
result is matched with the conclusion of Fig. 1 in which the 
system performance is affected by the CGD of coding gain 
matrix. 
It demonstrates that optimum rotation achieves higher 
performance for all values of SNR. The selective angle 
rotation ensures full-diversity and high rate at the cost of 
reduced coding gain. It is also possible to turn this coding 
loss into gain by introducing block codes for the fading 
32
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

channel as in [7]. For an overall rate of 1, this combination 
of coding techniques outperforms the Alamouti code [1] at 
the price of higher decoding complexity. 
 
Fig. 3 Comparisons of Throughput Performance 
VI. 
CONCLUSIONS 
We exploited the algebraic structure of quaternions to 
design and optimize a novel high-rate, full-diversity STBC 
for 2 and 4 transmitting antennas. We introduced the concept 
of selective power scaling to guarantee full diversity for the 
designed code. The angle rotation was further optimized to 
maximize available coding gain. The computer simulations 
show that the effective throughput is improved in the high 
SNR region.  
ACKNOWLEDGMENT 
This work was supported by World Class University 
R32-2009-000-2014-0 NRF, and Fundamental Research (FR) 
2010-0020942 NRF, Korea, and PH.D program and New 
seedling foundations of Guangzhou University, and Natural 
Science 
Foundation 
of 
Guangdong 
Province 
(S2011040004068), China.  
REFERENCES 
[1] 
S. M. Alamouti, “A simple transmit diversity technique for wireless 
communications,” IEEE J. Select. Areas Commun., vol. 16, pp. 
1451–1458, Oct. 1998. 
[2] 
V. Tarokh, H. Jafarkhani, and A. R. Calderbank, “Space-time block 
codes from orthogonal designs,” IEEE Trans. Inform. Theory, vol. 45, 
pp. 1456–1467, July 1999. 
[3] 
B. Hassibi, B. M. Hochwald, A. Shokrollahi, and W. Sweldens, 
Representation theory for high-rate multiple-antenna code design, 
IEEE Trans. Inform. Theory, vol. 47, pp. 2335-2367, Sept. 2001. 
[4] 
H. Jafarkhani and N. Seshadri, “Super-orthogonal space-time trellis 
codes,” IEEE Trans. Info. Theory, vol. 49, pp. 937–950, April 2003. 
[5] 
H. Jafarkhani, “A quasi-rothogonal space time block code,” IEEE 
Trans. Commun., vo. 49, pp. 1-4, Jan. 2001. 
[6] 
W. Su and X.-G. Xia, “Signal constellations for quasi-orthogonal 
spacetime block codes with full diversity,” IEEE Trans. Inform. 
Theory, vol. 50, pp. 2331–2347, Oct. 2004 
[7] 
M. Z. A. Khan and B. S. Rajan, “Single-symbol maximum likelihood 
decodable linear STBCs,” IEEE Trans. Info. Theory, vol. 52, pp. 
2062–2092, May 2006. 
[8] 
S.Das, N.Al-Dhahire, and R.Calderbank, “Novel Full-Diversity High-
Rate 
STBC 
For 
2 
and 
4 
Transmit 
Antennas,” 
IEEE 
Trans.Commun.vol.10, No.3, March 2006 
 
33
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

