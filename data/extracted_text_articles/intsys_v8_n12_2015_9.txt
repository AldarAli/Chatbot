107
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Binding of Security Credentials to a specific Environment  
on the Example of Energy Automation  
 
Rainer Falk and Steffen Fries 
Corporate Technology 
Siemens AG 
Munich, Germany 
e-mail: {rainer.falk|steffen.fries}@siemens.com 
 
 
Abstract—Information security in critical infrastructures is 
becoming an inevitable part of networked control systems. 
Examples are industrial automation, process automation, and 
energy automation systems. Characteristic for all these systems 
is the data exchange between intelligent electronic devices – 
IEDs, which are used to monitor and control the operation. In 
energy automation deployments these IEDs provide the data 
for a obtaining a system view of connected energy resources. 
This becomes increasingly important as the number of 
decentralized energy resources – DER – is constantly 
increasing. Based on the system view, a set of DER, building a 
virtual 
power 
plant, 
can 
be 
managed 
reliably. 
The 
communication 
is 
realized 
through 
domain-specific 
communication protocols like IEC 61850, or IEC 60870-5. This 
communication is performed over networks of different 
administrative domains, also over public networks. Therefore, 
IT security is a necessary prerequisite to prevent intentional 
manipulations, thereby supporting the reliable operation of the 
energy grid. Basis for protecting metering and control 
communication are cryptographic security credentials, which 
need to be managed not only during operation, but most 
importantly during installation (initial enrollment). This 
process needs to be as simple as possible to not increase the 
overall effort and to not introduce additional sources for 
failures. Hence, automatic credential management is needed to 
ensure an efficient management for a huge number of devices. 
This paper describes a new approach for the automatic initial 
security credential enrollment process during the installation 
phase of IEDs. The approach targets the binding of the 
security credentials of the installed IEDs to the operational 
environment and also to the intended utilization of the IED by 
embedding 
specific 
information 
into 
the 
enrollment 
communication, which is then reflected in the issued X.509 
certificates.  
 
Keywords–security; 
device 
authentication; 
automated 
certificate enrollment; real-time; network access authentication; 
firewall; substation automation; smart grid; smart energy; DER; 
PKI; IEC 61850; IEC 60870-5; IEC 62351 
I. 
INTRODUCTION 
Decentralized energy generation, e.g., through renewable 
energy sources like solar cells, or wind power, is becoming 
increasingly 
important 
to 
generate 
environmentally 
sustainable energy, and thus to reduce greenhouse gases 
leading to global warming. Introducing decentralized energy 
generators into the current energy distribution network poses 
great challenges for energy automation as decentralized 
energy generation needs to be monitored, and controlled to a 
similar extend as centralized energy generation in power 
plants. This requires widely distributed communication 
networks. Distributed energy generators may also be 
aggregated on a higher level to form a so-called virtual 
power plant (VPP). Such a virtual power plant may be 
viewed from the outside in a similar way as a common 
power plant with respect to energy generation capacity. But 
due 
to 
its 
decentralized 
nature, 
the 
demands 
on 
communication necessary to control the virtual power plant 
are much more challenging. Moreover, these decentralized 
energy resources may also be used in an autonomous island 
mode, without any connection to a backend system.  
Furthermore, the introduction of controllable loads on 
residential level requires enhancements to the energy 
automation communication infrastructure as used today. 
Clearly, secure communication between a control station, 
and equipment of users (e.g., decentralized energy 
generators) as well as with decentralized field equipment 
must be addressed. Standard communication technologies as 
Ethernet and the Internet protocol IP are increasingly used in 
energy automation environments down to the field level [1] 
[2][3]. 
Figure 1 depicts smart energy automation scenarios 
showing the increased communication demand, e.g., through 
the integration of microgrids, controllable loads, and also 
electro mobility. IT security is a base requirement to be 
addressed in all the scenarios to ensure the reliable operation 
of the smart grid. The communication in energy automation 
systems must therefore be cryptographically secured. For 
energy automation control protocols like IEC 61850 [4], or 
IEC 60870, the accompanying standard series IEC 62351 [6] 
is available defining various options to secure communicated 
data. One base for secure interaction are security credentials 
in the form of X.509 digital certificates, corresponding 
private keys, and a related security policy. All need to be 
provisioned during device installation, and maintained 
during operation. Especially, the exchange of devices with 
spare parts should not lead to breaches in security, which 
could occur if the key material of the replaced devices is not 
handled appropriately. This is especially important as IEDs 
may not always be placed in a physically protected 
environment, and even publicly accessible.  

108
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
To ensure that this key material cannot be misused, e.g., 
in the context of an unintended service, or in an unintended 
environment, the key material has to be bound to the 
respective device and/or application purpose. Existing 
options, e.g., using key usage extensions in X.509 
certificates, may not always be sufficient, as they relate to 
the actual usage of the cryptographic key, and not to the 
device application environment. The purpose-binding of a 
cryptographic key described in this paper therefore restricts 
the key acceptance depending on location information, and 
potential other parameters.  
The remainder of this paper is structured as follows: 
Section II provides an overview of two example Smart Grid 
use cases. Section III depicts an overview of secure 
communication with respect to the use cases explained 
before. This section motivates the handling of security key 
material. Section IV provides an overview about the utilized 
security credentials, while Section V introduces the Public 
Key Infrastructure as means for credential handling. Section 
VI introduces existing certificate enrollment methods, while 
Section VII describes an enhancement to have purpose 
bound certificates. Section 0 concludes the paper and 
provides an outlook.  
II. 
SMART ENERGY AUTOMATION USE CASES 
To motivate communication security, two example use 
cases are addressed in this paper, substation automation, and 
DER incorporation in energy control networks. They are 
explained in the following two subsections. 
A. Substation Automation  
Automation networks are typically shared networks 
connected in a ring, star, or bus topology, or a mixture of 
these. Most often, the time-critical part is realized on a 
dedicated network segment, while the rest of the 
communication supporting the automation systems is 
performed 
on 
networks 
with 
lower 
performance 
requirements.  
An example for energy automation is the communication 
within a substation. A substation typically transforms voltage 
levels, and includes power monitoring, and protection 
functions. The example in Figure 2 shows a typical setup of 
a primary substation. The red rectangle shows the area, in 
which the IEDs communicate status information, and 
provide this information into the substation automation zone, 
and further up the hierarchy to the control center.  
As depicted in Figure 2, the substation bus can be 
realized as communication ring, connecting the protection 
relays, acting in real-time typically via Ethernet. Ideally, the 
network is separated to already provide a first security 
barrier with different access restrictions. There is a 
connection to other zones within the substation, separated 
from the real-time part using Firewalls. Examples are the 
automation zone, or the remote access zone. Another 
example is the zone storing the historian information also 
interacting with a backend SCADA system. The historian 
server is a device for archiving measurements, events, and 
alarms of the substation.  
Terminal
Server
Remote Access 
Server
Remote Serial 
Configuration Zone
Physical Substation Security Perimeter
PMU
RTU
System Operation Critical
Automation Zone
Remote Access Zone
IP Switch
Station Bus Zone
Serial Server 
/ Switch
Serial IED Process Zone
IEC 61850     
DCF 77
PMU
IED
IED
IED
Serial Server / Switch
`
Local HMI
Communication, e.g., via:
- IEC 61850
- IEC 60870-5-104
- IEC 60870-6 TASE2
Utility Communications Network
Historian
DMZ
File Server
Web Navigator
`
Local HMI
Business Critical
Logging
Logging
Logging
Logging
Logging
IED
Substation 
Controller with 
OCSP Responder
IED
IED
   
Figure 2. Substation – Functional Split into Zones  
Figure 1. Typical Smart Energy Automation Scenarios 

109
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 2 above already shows security elements deployed 
within a substation, like Firewalls, virus checking tools, or 
access 
control 
means 
to 
components, 
or 
data 
as 
recommended in IEC 62351-10 [6]. 
B. DER Incorporation  
Decentralized 
Energy 
Resources 
(DER) 
may 
be 
connected to the Smart Grid at two different connection 
points. Depending on the amount of energy provided, they 
may be connected to the low voltage network, or to the 
medium voltage network (distribution network). The first 
one is rather typical for DER in residential areas, like a solar 
panel, while the connection to the medium voltage network 
is done for larger deployments like wind power farms, or 
solar parks. Necessary for both is the connectivity to a 
communication infrastructure to allow a control center to act 
on provided information about current energy generation, but 
also to provide scheduling information to the DER, e.g., 
depending on the weather forecast, to better balance the feed 
in of energy into the electrical network. Communication with 
the DER may be done using different communication 
technologies, like Power Line Communication (PLC), or 
wireless communication via the UMTS network.  
Figure 3 shows an example integration of DER utilizing a 
mapping of IEC 61850 to the XMPP (eXtensible Message 
and Presence Protocol, [7]), which is currently being 
discussed within the standardization. This approach allows 
connecting to DERs, which reside in a customer’s network 
behind a firewall. For the distribution network operator 
(DNO), it is essential to know, which DERs are associated to 
his operational control.  
  
Figure 3. DER Integration based on IEC 61850 over XMPP 
This can be supported by the used security credentials 
using additional information depending, e.g., on the 
geographic location of a DER, or on the association with a 
dedicated DNO. 
 
III. 
SECURE COMMUNICATION IN SMART GRID 
IEC 61850 [4], [5] is a standard for communication in the 
domain of energy automation. It is envisaged to be the 
successor of the currently used standards IEC 60870-5-104, 
and DNP3 especially used in the North American region. 
IEC 61850 enables interoperability between devices used in 
energy automation. For example, two IEC 61850 enabled 
devices of different vendors can exchange a set of clearly 
defined data, and the devices can interpret, and use these data 
to achieve the functionality required by the application due 
to a standardized data model. This is facilitated by the IEC 
61850 series specifying: 
 
an 
Abstract 
Communication 
Service 
Interface 
(ACSI), 
 
a semantic model based on an object oriented 
architecture, 
 
specific Communication Service Mappings (SCSM), 
 
a 
project 
engineering 
workflow 
including 
a 
configuration description language (SCL) based on 
the XML language. 
In 
particular, 
IEC 
61850 
enables 
continuous 
communication from a control station to decentralized 
energy generators, or to IEDs (like protection relays) in a 
substation. 
IT security is increasingly important in energy 
automation as on part of the Smart Grid. Here, the IEC 
62351 framework [6], shown in Figure 4, with currently 13 
defined parts kicks in, defining security services for IEC 
61850 based communication covering different deployment 
scenarios 
using 
serial 
communication, 
IP-based 
communication, and also Ethernet communication. The latter 
one is used locally within a substation to cope with the high 
real-time requirements. While it may be not always 
necessary to encrypt the communication to protect 
confidentiality, there is a high demand to protect the 
communication against manipulation, and to allow for source 
authentication.  
IEC 62351 relies on existing security technologies as 
much as possible, and profiles it for the application 
environment. One example is the application of Transport 
Layer Security (TLS, RFC 5246 [8]) to protect TCP-based 
communication. Here, IEC 62351-3 basically reduces the 
manifold options of TLS to ease interoperability. Another 
example is the adoption of Group Domain of Interpretation 
(GDOI, RFC 6407 [9]) as group-based key management in 
IEC 62351-9 to distribute key material for the protection of 
status information, and event signaling between IEDs in a 
substation, or across substations using Wide Area Networks 
(WANs).  
 
 
 
 
 

110
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 4. IEC 62351 series relation to energy automation protocols 
A specific characteristic throughout IEC 62351 is the 
consequent 
application 
of 
X.509 
certificates, 
and 
corresponding private keys for mutual authentication on 
network layer, and application layer. This requires an 
efficient handling of X.509 key material, and the availability 
of this information right from the installation. There is a 
strong need to provide these credentials without increasing 
the installation effort. For instance, devices may generate 
their own key pair, but certification needs to bind this key 
pair to the operational. This is a challenge from the pure 
technical perspective as a high number of devices need to be 
equipped with the key material. But also from the network 
operator process point of view this is challenging, as the key 
material has a lifecycle, and needs to be updated once in a 
while. These aspects will be addressed in the following 
sections.  
IV. 
SECURITY CREDENTIALS 
Security credentials are used for different purposes, and 
in different phases of the communication lifetime, and may 
comprise: 
 
Certificates and corresponding private keys: Used to 
authenticate entities and support session 
key 
establishment. 
 
Pre-shared keys (e.g., for real-time communication): 
Used as a shared secret between entities to build up 
mutual authentication between them. This scheme 
may be used when lacking a PKI, or when doing an 
initial authentication. In the latter, it may be an entity 
password, which allows an entity to authenticate itself 
against the Certificate Authority (CA), for example 
when performing a certificate signature request 
(CSR). 
 
Session secret keys (pair wise or group-based): Used 
for efficient encryption, or integrity checks on 
communication messages. 
 
Session 
parameters 
(dedicated 
cryptographic 
algorithms): Used to specify the lifetime of the 
session keys. 
 
Cryptographic access tokens: Mostly used to 
transfer/provide authorization/access of resources to 
entities for a limited time. 
For the context of this document, the focus lies on X.509 
certificates, and corresponding private keys.  
 
Figure 5. Structure of a X.509 public-key credential 
According to X.509 [10], and as shown in Figure 6, a 
public-key certificate is an electronic document that binds 
the identity of entity to the public private key pair of that 
entity. This binding is verified by a digital signature of the 
issuing CA building the certificate. In addition to the public-
key, and identity of the owner of public-key certificate, the 

111
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
public-key certificates holds verified information about 
validity period, and the identity of the issuer. 
A 
public-key 
certificate 
may 
include extensions 
providing additional information. An extension is identified 
by an object identifier allocated by the organization defining 
the extension. The use of X.509 attribute certificates, shown 
in Figure 6, can be an effective way to separate the 
management 
of 
identity 
from 
the 
management 
of 
authorizations associated with an identity.  An attribute 
certificate, as shown in Figure 6, provides an option for 
temporary enhancement of public key certificate, linked with 
the public-key certificate’s unique identifier. 
 
Figure 6. X.509 Attribute Certificate structure 
The combination of public key certificates, and attribute 
certificates provides high flexibility for operational use 
cases. One reference can be given by IEC 62351-8 [6] 
utilizing this approach for supporting Role-based Access 
Control. A different approach is provided by FlexiCert [11], 
allowing the inclusion of additional attributes during the 
lifetime of a public key certificate. 
For the context of this paper, the focus is placed on 
X.509 public key certificates, which are issued for IEDs. The 
following section provides more details about the handling 
of these credentials using a PKI. 
V. 
PUBLIC KEY INFRASTRUCTURE - PKI  
A PKI typically contains a variety of services requiring 
interfaces in the devices utilizing the PKI, and also an 
accompanying process. In general, a PKI provides a secure, 
reliable, and scalable environment for the complete lifecycle 
of key material, i.e., generating, distributing, and querying 
public keys for secrecy, correctness, and sender verification. 
Moreover, it binds the “owner” to the public key using a 
digital certificate, and thus enables identification of users, 
and components utilizing certificates. Furthermore, it 
maintains and distributes status information for the lifetime 
of that binding, i.e., from the generation till the revocation. 
The general functionality and formats are described in RFC 
5280 [10]. 
The following list provides a short overview about the 
different components, which are depicted in Figure 7Figure 7. 
 
Registration authority (RA) authenticates the user, 
or IED, or the data submitted by the user, or IED, 
performs an authorization check, and initiates the 
certificate generation at the CA. For machine-to 
machine communication, the RA can be used to 
mediate between the device applying for a certificate, 
and the CA. 
 
Certification authority (CA) is a trusted entity that 
certifies public-keys by issuing certificates.  
 
Key/certificate archive is a repository in which the 
CA stores certificates and/or generated key pairs.  
 
Key generation is a function of the PKI responsible 
for the generation of key material (public, and private 
keys), which are certified through the CA. 
 
Public Directory is a (usually publicly readable) 
database to which the CA stores all issued certificates. 
 
Revocation Lists are also a publicly readable 
database to which the CA stores all revoked 
certificates. 
 
Figure 7. PKI Components 
In the context of smart grid, a PKI may be operated by a 
utility company as internal PKI, or it may be a public PKI, 
also depending on the target use case, and the need for 
interoperation between different parties. Moreover, the 
functionality provided by the PKI needs to be streamlined to 
the target environment to avoid unnecessary effort. In any 
case, the devices utilizing key material issued by the CA 
need to provide the technical interfaces to accomplish this 
task. This is described in more detail in IEC 62351-9 
targeting the key management explicitly.  
Section VII describes an enhancement of the typical used 
PKI setup by introducing an intermediary, which provides all 
operational environment specific information. This avoids 
the pre-configuration of IEDs with this information. 
VI. 
EXISTING CERTIFICATE ENROLLMENT METHODS 
This section describes common methods for certificate 
enrollment 
taking 
device 
capabilities 
into 
account. 
Capabilities in this context relate to local, and remote key 
generation. Typically, local generation of key material is 
desired to avoid the handling of private keys outside the 
devices.  Note that depending on the key usage, there may be 
requirements to also have the private key available in a trust 

112
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
center to ensure that encrypted information can be accessed 
even the device hosting the private key was either damaged, 
or has been compromised. 
A. Manual Enrollment 
Manual enrollment relates to the manual connection of a 
device to an engineering tool to provide the key material 
during a local configuration session, prior to the connection 
in the target network. This approach requires a significant 
initial configuration effort, and is especially cumbersome in 
case of device replacements.  
 
 
Figure 8. Manual enrolment using offline engineering 
It may be realized using an offline engineering network 
to bootstrap the security credentials for connected devices, as 
shown in Figure 8. Here, the devices, or components may not 
possess a cryptographic credential up front, as the separate 
network is assumed to be physically secure. In the simplest 
form, it may be a direct connection of an engineering laptop 
to the component to be administered using purely local 
point-to-point communication. 
B. Automated Enrollment 
Automated enrollment refers to the initial configuration 
of devices including the key material. This is shown in 
Figure 9. Field devices are connected to the network, and 
contact the PKI server to obtain certified key material. Here, 
the field devices generate their public/private key pairs 
locally, and send a Certificate Signing Request (CSR) for the 
public key to the RA/CA (part of the PKI server). Part of the 
CSR may be a serial number of the device, against which the 
PKI server can check a configured list of devices allowed to 
be enrolled. This authorization may also be realized by other 
means like one-time passwords. 
 
Figure 9. Automated distribution using management protocols 
According to RFC 2986 [12] the CSR is defined in 
ASN.1 as shown in Figure 10 below. 
 
CertificationRequest ::= SEQUENCE { 
certificationRequestInfo  
  CertificationRequestInfo, 
   signatureAlgorithm AlgorithmIdentifier{{  
     SignatureAlgorithms }}, 
   Signature BIT STRING 
   } 
CertificationRequestInfo: 
CertificationRequestInfo ::= SEQUENCE { 
version       INTEGER { v1(0) } (v1,...), 
subject       Name, 
  subjectPKInfo SubjectPublicKeyInfo{{ 
 PKInfoAlgorithms }}, 
Attributes [0] Attributes{{  
 CRIAttributes }} 
} 
 
SubjectPublicKeyInfo { ALGORITHM : IOSet}  
 ::= SEQUENCE { 
 Algorithm AlgorithmIdentifier {{IOSet}}, 
 subjectPublicKey BIT STRING 
} 
Figure 10. Certification Request structure [12] 
As shown in Figure 10, a CSR is a self-contained 
structure providing the necessary information for the 
certificate application and issuing process but also a 
protection of this information regarding its authenticity. This 
is done through a signature with the private key 
corresponding to the public key in the CSR itself. This 
signature provides a proof of possession of the private key on 
at the requesting entity towards the issuing CA. 
Several protocols are known for transmitting a CSR to a 
CA. Examples are: 
 
SCEP – Simple Certificate Enrollment Protocol [13] 
was developed to simplify the enrollment of large 
numbers of devices, and to make issuing, and 
revocation of digital certificates as scalable as 
possible. Entities can use SCEP to request their 
digital certificate electronically using the PKI 

113
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
certificate forms PKCS#7 and PKCS#10 over HTTP. 
Note that SCEP cannot be used in conjunction with 
RAs using elliptic curve based certificates. 
 
CMP – Certificate Management Protocol [14] was 
developed using an own syntax to transport PKCS#10 
container. It defines a protocol for the interaction 
between a client, and the PKI components. It provides 
more options compared to SCEP but is also more 
complex. Besides CRL retrieval, certification request 
handling, identification/authorization option for the 
requester as well as proof of possession of the 
associated private key CMP provides additional 
functionality like cross certification, and certificate 
revocation, which is to be supported mandatory. CMP 
supports the client side, and server side generation of 
key material. 
 
CMC – Certificate Management over CMC [15], 
utilizes PKCS#7, and PKCS#10. It provides more 
mandatory options compared to SCEP, and results 
therefore in a higher complexity. Besides CRL 
retrieval, certification request handling, identification, 
and authorization options for the requester, as well as 
proof of possession of the associated private key, 
CMC provides additional functionality like cross 
certification, and certificate revocation. CMC defines 
a simple, and a full PKI request/response handshake, 
but requires both to be implemented. CMC supports 
the client, and server side generation of key material. 
 
EST – Enrollment over Secure Transport [16] is 
discussed below more elaborately, to provide an 
overview about the general information exchange, 
and setup for enrollment. 
 
XML Key Management Specification [17] 
In general, these protocols describe the communication of a 
CSR from a device to the CA, were the device ideally 
generates the key pair for itself. Additionally to identification 
information like the serial number, further information can 
be connected with the CSR, like a password (to be used to 
authorize a potential future revocation), or key usage 
restrictions. The CSR has to be protected to prevent 
illegitimate issuing of certificates. The CSR itself may be 
protected using the public key of the RA/CA as in case of 
SCEP. In case of CMP, the CSR is protected using an initial 
authentication key, and in EST, the CSR is transmitted over 
a secured communication link. Here TLS is applied, 
providing the opportunity to authenticate both peers during 
the connection establishment. Also, there may be an 
intermediate RA located between the device sending the 
CSR, and the CA, which already performs the verification of 
the CSR to reduce the load on the CA.  
In Figure 11, EST is taken as example to provide more 
insight to the communication during an enrollment session. 
EST bases on CMC, and defines some of the CMC 
functionality as optional resulting in reduced complexity. 
Here, only the simple PKI request/response interaction is 
mandatory, while the full procedure support is optionally. 
From a functionality perspective EST can be seen as 
evolvement of SCEP. EST utilizes TLS as secure channel, 
and leverages the authentication of the TLS channel for 
identification, and authorization of the requester by binding 
the CSR to the actual TLS session. 
The CMC part provides proof-of-possession of the 
private key corresponding to the public key in the CSR. 
Besides the CSR processing, EST allows for exchange of CA 
certificates, and corresponding chains, as well as for renewal. 
Moreover, it supports certificate attribute retrievals from a 
client side to query additional information, or boundary 
conditions prior to generating a CSR. EST supports the 
distribution of the operational CA’s certificates in a 
“enrollment preparation phase”. This distribution already 
needs to be secured as the CA’s root certificate constitutes 
the trust anchor for the operational environment. According 
to EST, this exchange may be secured using initially 
available credentials, which may be a vendor certificate, or a 
shared secret available on the device. From an automation 
perspective the device vendor’s certificate is preferred, as it 
allows the production of the devices as well as the central 
administration of the available credential in the operational 
environment, without handling device external secrets.  
The following enrollment phase basically establishes a 
mutual authenticated TLS connection (using the vendor’s 
device certificate) over which an SCR attribute request may 
be sent, followed by the CSR generated by the enrolling 
IED. The CSR itself is enhanced with the TLS session 
identifier to achieve a binding to the underlying transport.  
More information about the provisioning using EST can be 
found in [18]. 
When deployed in the operational environment, IEDs 
may not be pre-configured with information about the 
deployment environment. Hence, an intermediate component 
is used to enhance the CSR with additional information 
about the deployment environment before it is forwarded to 
the RA/CA. This information is not available at, or provided 
by the sender of the CSR itself.  
The following section describes such an enhancement of 
the CSR communication on the way from the devices to 
certification server. This enhancement is proposed to provide 
additional information about the environment in which the 
device is deployed. Such information can either be contained 
in the certificate to be issued, or associated with the device 
certificate by other means, like a central configuration 
database. This approach helps identifying, e.g., a physical 
movement of components, or devices to other locations. 
Hence, key material valid in one location may not be 
misused in a different location. Moreover, the approach also 
enhances the options for asset management, by providing 
fine-grained information already during the authentication 
processes, employing the enhanced certificate.  
 

114
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Entity
Registration 
Authority
Certification 
Authority
Enrollment Phase
T
L
S
- Open TLS Channel 
- Generate CSR (PKCS#10) using tls-unique   
  value for channel binding (identification)
- Generate SimplePKIRequest carrying CSR  
- sent SimplePKIRequest:
  POST /.well-known/est/simpleenroll HTTP/1.1
T
L
S
- Accept TLS Channel, 
- authenticate with 
  server certificate, 
- request client certificate
- Authenticate RA 
- authenticate towards RA using 
  imprinted certificate
- Authenticate client 
  (cross check with CSR 
  authorization, e.g., via LDAP)
h
tt
p
s
h
tt
p
s 
2
h
tt
p
s
- Verify CSR (PKCS#10)
- Proof of Possession
- Linking of identity  
- CSR
- Generate certificate
- Create response 
Maybe co-located or communicated over a seperate connection
SimplePKIResponse (PKCS#7)
- Create PKCS#7
- Request certificate attributes and chain 
  (optional)
  POST /.well-known/est/csrattrs HTTP/1.1
h
tt
p
s 
 
1
- Collect attributes according 
  to security policy, e.g., 
  algorithmOID, Identity linking
h
tt
p
s  
1
- Store certificate
h
tt
p
s
- Open TLS channel to query CA certificates    
  (optional)
T
L
S
- authenticate with 
  server certificate 
Collect „Root CA Key Update"
certificates OldWithOld, 
OldWithNew, and NewWithOld
- Query CA certificates
POST /.well-known/est/cacerts HTTP/1.1
T
L
S
h
tt
p
s
Store certificates as explicit Trust Anchor, 
potential out-of-band validation
Enrollment Preparation
Enrollment Process
 
Figure 11. Communication flow hen using Enrollment over Secure Transport [16] 

115
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
VII. ENHANCING CERTIFICATE ENROLLMENT WITH 
PURPOSE BINDING 
This section outlines the introduction of an additional 
network component to extend a CSR with additional 
information. Such additional information is encoded as 
additional attribute added to the original CSR as sent by the 
device. This attribute indicates the context, or other 
deployment specific information, to be added to either the 
certificate, or the configuration database. The original CSR 
from the device is left untouched including the signature, to 
preserve the proof of possession of the private key. Note that 
the original CSR already carries information to enable the 
issuing RA/CA to identify the device. This can be achieved 
by using manufacturer installed key material, which can 
either be used to wrap the CSR providing a digital signature 
or to establish a connection with the issuer, which invokes 
this key material. In both cases, the relying party needs to 
possess the device related certificate material in advance, to 
be able to perform the authentication. 
The enhancement of the original CSR is achieved by 
adding a Certificate Attribute Intermediary (CAI) along the 
CSR communication path. The CAI adds at least one 
attribute to the original CSR (as stated without otherwise 
manipulating the original CSR). The additional attribute 
acknowledges additional information about the operating 
environment. This additional information may be the 
membership of the CSR sender (device) to a dedicated zone, 
or group, or to a dedicated location, either on a geographical 
base, or on an organizational base. Moreover, the CAI may 
already check the CSR (like an RA), and signal this 
information also in the attribute. The CAI may add 
information about intended usage restrictions of the 
certificate, depending on the device type, and the security 
policy. This information can be part of the engineering 
information, which must then be available at the CAI. The 
CAI may also request that the certificate is issued using a 
dedicated signature algorithm.  
The attribute and the CSR build the Extended Certificate 
Request (ECR). The ECR is protected by a cryptographic 
checksum, binding the attributes to the original CSR. Ideally, 
this is a digital signature of the CAI. This could be realized 
as PKCS#7 structure [19], or as XML structure, but may also 
be a symmetric checksum, involving a shared secret between 
the CAI, and the CA. If the RA, and CA are separate entities, 
the CAI may be co-located with a local RA. After successful 
verification, the additional information from the attribute is 
included in the X.509 certificate within a certificate 
extension.  
Depending on the applied enrollment protocol the ECR 
may be transmitted via a TLS protected communication path 
using, e.g., HTTP POST, HTTP GET, or as REST, or SOAP 
message.  
 
Figure 12 depicts the on path enhancement of a CSR with 
attributes aa1, …, aa3. Also shown are potential functions to 
be performed by the CAI (e.g., CSR checking), and the 
enhanced functions on the RA/CA side.  
In a substation automation environment, the CAI can be 
part the substation controller, or the remote access server as 
the central ingress, and egress point of the substation. This is 
depicted in Figure 13. The different steps describe the single 
steps for the ECR processing. Note that the prerequisite is 
the availability of the central RA/CA root certificate in the 
IED. 
The following steps, which are shown in Figure 13 are 
performed for the initial enrollment of an energy automation 
device IED: 
1. Generation of key material (public/private key), 
generation of the CSR within the IED 
2. Send local generated CSR to Remote Access Server 
3. Verification of CSR through Remote Access Server. 
Remote Access Server acts as CAI. Generation of 
attributes, and ECR. Send ECR to central RA/CA 
server of the distribution network operator. 
4. Verification of ECR signature through central RA/CA, 
verification of attributes (installation information, etc.); 
optional verification of original CSR  
5. In case of successful verification device specific 
certificate will be generated, and send to the remote 
access server of the substation. 
6. Forwarding of certificate to IED 
7. Local automated installation of certificate upon 
receiving, and successful signature verification against 
local RA/CA root certificate.  
Extended Certificate Request ECR:
Client
RA/CA
- receive ECR
- check ECR
- check CSR
- issue Certificate
- provide Certificate
CAI
- receive CSR
- check CSR
- determine 
additional attributes 
aa1, aa2, aa3
Certificate Request:
Name
Attributes
Public Key
Checksum
Certificate Request:
Name n
Attributes a1, a2, a3
Public Key pk
Checksum
Certificate
Name n
Attributes a1, a2, a3, 
aa1, aa2, aa3
Public Key pk
CA 
Signature
CAI 
Checksum
Additional 
Attributes
aa1, aa2, aa3
 
Figure 12. Realization option for on path CSR enhancement with attributes characterizing the deployment environment  

116
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
There are certain prerequisites to have an automated 
certificate enrollment. First of all the devices should be able 
to generate a key pair and also to generate the CSR. This 
already involves cryptographic computations, which the 
devices need to be capable of. From an infrastructure 
perspective, the device identity needs to be known upfront. 
This can be done very efficiently, if the device already 
posses a certificate and corresponding private key. The 
certificate (or a serial number and issuer or a certificate 
fingerprint) needs to be known by the issuing CA and 
potentially by the CAI. This key material can then be used in 
the CSR communication process to authenticate the applying 
device. The device can authenticate itself by providing a 
digital signature, either for the CSR wrapper or in the context 
of the utilized communication protocol, e.g., EST.  
 
 
 
Figure 13. Enhancement of the CSR path in a substation 
 

117
International Journal on Advances in Intelligent Systems, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/intelligent_systems/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
In case of EST as enrollment protocol, it would be 
necessary that the remote access server acts as local 
registration authority (LRA) to enable the enhancement of 
the device CSR. As EST defines the binding of the CSR to 
the TLS session, by including the TLS session identifier 
(tls_unque) into the CSR, an intermediate component must 
be identifiable as trusted. This is enabled by a specific key 
usage extension in the LRA’s certificate called id-kp-cmcRA.   
Note that this paper concentrates on the concept of the 
CSR enhancement. Implementations are not finished yet. 
VIII. CONCLUSIONS AND OUTLOOK 
This paper described security enhancements for energy 
automation 
systems 
involved 
in 
standard substation 
communication but also in smart grid / smart energy 
scenarios like the integration of decentralized energy 
resources (DER). The cryptographic protection of control 
communication requires that cryptographic keys, and 
certificates are provisioned on energy automation field-level 
devices. Manual configuration would not scale to the huge 
number of devices, and be prone to configuration errors. 
Therefore, automatic configuration of automation devices is 
required not only during the operation, and service, but 
especially for the initial device enrollment. To ensure the 
correct configuration of cryptographic device credentials, 
information is required at which location a specific device 
has been installed. An additional network element has been 
described that trustfully enhances a certificate signing 
request issued by an automation device with information on 
the network segment in which the device has been installed. 
This allows the CA to issue a device certificate that is bound 
to the operational zone of the device (“location”). Moreover, 
additional information for the CSR processing can also be 
provided. A relying device towards which the considered 
device authenticates using this zone-bound certificate, can 
verify whether the device belongs to the own zone. This 
ensures that an automatically provisioned device is operable 
using the established configuration only within the 
corresponding zone. When the device is relocated, or put out 
of service, its device certificate cannot be misused, e.g., in 
other zones. 
Standardization is currently ongoing in the context of 
ISO/IEC62351-9, which defines interoperable means for 
automatic device credential management for energy 
automation equipment. The new approach described in this 
paper enhances the current credential management approach, 
and will be proposed for to be considered in future energy 
automation security standards. While applicable in the 
context 
of 
energy 
automation 
standards, 
the 
CSR 
enhancement may also be standardized in the context of the 
actual enrollment standards, as pointed out in Section VI.     
 
REFERENCES 
[1] R. Falk and S.Fries, “Purpose-bound Certificates in 
Automation Environments,” Proc. IARIA Internet 2014, June 
2014, 
ISBN 
78-1-61208-349-0, 
pp. 
29-33, 
www.thinkmind.org/index.php?view=article&articleid=intern
et_2014_2_10_40022), [retrieved April 2015] 
[2] S. Fries and R. Falk, “Efficient Multicast Authentication in 
Energy Environments,” Proc. IARIA Energy 2013, March 
2013, 
ISBN 
978-1-61208-259-2, 
pp. 
65-71, 
http://www.thinkmind.org/download.php?articleid=energy_20
13_3_30_40056 [retrieved Dec. 2014]. 
[3] M. Felser, “Real-time Ethernet – industry prospective,” Proc. 
IEEE, 
vol. 
93, 
no.6, 
June 
2005, 
pp. 
1118-1128, 
http://www.felser.ch/download/FE-TR-0507.pdf 
[retrieved: 
Dec. 2014] . 
[4] IEC 61850-5 – “Communication requirements for functions 
and 
device 
models,” 
July 
2003, 
http://www.iec.ch/smartgrid/standards/ [retrieved: Jan. 2015].  
[5] “Efficient Energy Automation with the IEC 61850 Standard 
Application Examples,” Siemens AG, December 2010, 
http://www.energy.siemens.com/mx/pool/hq/energy-
topics/standards/iec-61850/Application_examples_en.pdf 
[retrieved: Dec. 2014]. 
[6] IEC 62351-x Power systems management and associated 
information exchange – Data and communication security, 
http://www.iec.ch/smartgrid/standards/[retrieved: Jan. 2014]. 
[7] P. Saint-Andre, ”Extensible Messaging and Presence Protocol 
(XMPP): Core,” RFC 6120, https://tools.ietf.org/html/rfc6120 
[retrieved: Jan. 2014]. 
[8] T. Dierks and E. Rescorla, “The Transport Layer Security 
(TLS) Protocol Version 1.2,” RFC 5246, Aug. 2008, 
http://tools.ietf.org/html/rfc5246 [retrieved: Jan. 2015]. 
[9] B. Weiss, S. Rowles, and T. Hardjono, “The Group Domain 
of 
Interpretation,” 
RFC 
6407, 
Oct. 
2011, 
http://tools.ietf.org/html/rfc6407  [retrieved: Jan. 2015]. 
[10] D. Cooper et al., “Internet X.509 Public Key Infrastructure 
Certificate and Certificate Revocation List (CRL) Profile,” 
RFC 5280, May 2008, http://tools.ietf.org/html/rfc5280 
[retrieved: Jan. 2015]. 
[11] A. Lakshminarayanam and J. Zhou, “FlexiCert: X.509 
Identity and Attribute Certificates,” Proceedings of DEXA 
2003, ISBN 1529-4188/03 [retrieved: Jan. 2015]. 
[12] M. Nystrom and B. Kaliski, “PKCS #10: Certification 
Request Syntax Specification,” RFC 2986, Nov. 2000, 
http://tools.ietf.org/html/rfc2986 [retrieved: Jan. 2015]. 
[13] M. Pritikin, A. Nourse, and J. Vilhuber, “Simple Certificate 
Enrolment 
Protocol,” 
Internet 
Draft, 
Sep. 
2011, 
http://tools.ietf.org/html/draft-nourse-scep-23 [retrieved: Jan. 
2015]. 
[14] J.Schaad and M.Myers, “Certificate Management over CMS,” 
RFC 5272, June 2008, http://tools.ietf.org/search/rfc5272 
[retrieved: Jan. 2015]. 
[15] C. Adams, S. Farrell, T. Kause, and T. Mononen, “Internet 
X.509 Public Key Infrastructure Certificate Management 
Protocol 
(CMP),” 
RFC 
4210, 
Sep. 
2005, 
http://tools.ietf.org/html/rfc4210 [retrieved: Jan. 2015]. 
[16] M. Pritikin, P. Yee, and D. Harkins, “Enrollment over Secure 
Transport,” 
RFC 
7030, 
Oct. 
2013, 
http://tools.ietf.org/html/rfc7030   [retrieved: Jan. 2015]. 
[17] XML 
Key 
Management 
Specification, 
http://www.w3.org/TR/xkms2/  
[18] J. Foley, “Provisioning X.509 Certificates Using RFC 7030,” 
Linux 
Journal, 
September 
2014, 
http://www.linuxjournaldigital.com/linuxjournal/september_2
014/?pg=62&pm=2&u1=friend#pg62 [retrieved: Dec. 2014]. 
[19] B. Kaliski, “PKCS#7 Cryptographic Message Syntax Version 
1.5,” RFC2315, March 1998, http://tools.ietf.org/html/rfc2315 
[retrieved: Dec. 2014]. 
 

