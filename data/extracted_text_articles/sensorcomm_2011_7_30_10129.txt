Experimental Assessment of Adaptive Spatial Combining for Underwater Acoustic 
Communications 
 
Guosong Zhang  
 
 
Jens M. Hovem  
 
 
Hefeng Dong 
Dept. of Elec. and Telecomm.  
 
 
  SINTEF ICT  
 
 
Dept. of Elec. and Telecomm. 
Norwegian Univ. of Sci. and Tech.   
Norwegian Univ. of Sci. and Tech.   
Norwegian Univ. of Sci. and Tech. 
7491 Trondheim, Norway  
 
7491 Trondheim, Norway  
 
7491 Trondheim, Norway 
Guosong.Zhang@iet.ntnu.no 
 
Jens.Martin.Hovem@sintef.no 
 
Hefeng.Dong@iet.ntnu.no 
 
 
Abstract— This paper presents a receiver structure of 
passive-phase conjugation (PPC) based adaptive spatial 
combining for underwater acoustic communications. 
Based on temporal diversity exploited by PPC 
processing, the presented structure exploits spatial 
diversity by adaptive multichannel combining. The 
structure was assessed in two field experiments which 
were conducted in two different seasons in Trondheim 
harbor. The experiments were carried out with the same 
configuration, but the channel physics were different 
due to different environmental conditions. A cross 
receiving array of 10 hydrophones, deployed in a water 
depth of 10 m, was used to collect the received waveform 
in a range of 2.0 km. By off-line signal processing, we 
have demonstrated the superior performance in 
exploiting 
spatial 
diversity 
for 
underwater 
communications. 
Keywords- adaptive spatial combining; passive time reversal; 
passive-phase conjugation; underwater communication;spatial 
diversity. 
I. 
 INTRODUCTION 
Underwater acoustic communication is frequently limited 
by intersymbol interference (ISI) due to a time-varying 
extended multipath structure in an acoustic channel [1]. Time 
delayed arrivals due to multipath propagation can be spatial 
and temporal refocused by time reversal method [2, 3], 
which mitigates ISI caused by multipath. After the equal 
weight multichannel combining, there is only one channel 
equalizer required by passive time reversal communications 
[4, 5], which can be realized by passive-phase conjugation 
(PPC). PPC achieves pulse compression for the time delayed 
arrivals [6], and this property is used for underwater acoustic 
communications with a reduced number of taps for adaptive 
channel equalization. 
With multiple receivers distributed in space, there is 
spatial diversity which could be used to avoid deep fading in 
communications [7]. It is necessary to use multiple receivers 
in a time-varying acoustic channel to achieve stable 
communications. Since ISI cannot be eliminated by 
refocusing, an adaptive channel equalizer is required. It is 
known that a decision feedback equalizer (DFE) removes 
residual ISI. Spatial diversity is exploited by passive time 
reversal to mitigate ISI [8], where the side lobe level of 
( )
q t
-function is reduced with an increased number of 
receivers. Multichannel combining is performed by passive 
time reversal to achieve refocusing at the receiving array. In 
a real ocean environment, since there are interchannel 
correlations among the receivers [9], the diversity combining 
of passive time reversal does not take spatial coherence into 
account.  
In this paper, a receiver structure which is a PPC based 
multichannel equalization scheme is presented, where 
adaptive spatial combining is conducted to exploit spatial 
diversity. 
The 
structure 
takes 
advantage 
of 
pulse 
compression, where the number of taps for a multichannel 
equalizer is significantly reduced. As discussed by Yang [9], 
there is lack of model which can precisely predict the 
channel characteristics in a real ocean, and therefore the 
receiver structure is assessed by experiments. Two sea 
experiments were conducted to assess the receiver structure, 
where a receiving array of 10 hydrophones was used, and the 
received waveforms were recorded for off-line processing in 
the laboratory. The structure of PPC based multichannel 
DFE (PPC-McDFE) is used in digital signal processing, and 
it improves performance of the passive time reversal 
structure which is realized by PPC plus a signal channel DFE 
(PPC-DFE). The improvement is shown in terms of output 
signal-to-noise ratio (SNR). 
This paper is organized as follows. The proposed receiver 
structure of PPC-McDFE is introduced in Section II, and the 
diagram shows its differences from PPC-DFE. Section III 
describes the experimental setup. The information about 
experimental area and sound speed profiles are shown, and 
the signal transmission is introduced. In Section IV, the 
channel measurements and communication results are 
presented and discussed. Conclusions are given in Section V.  
II. 
THE RECEIVER STRUCTURE 
The communication information consists of a sequence 
of symbols denoted as [ ]
I n , and each symbol occupies a 
duration of T . The baseband data signal 
( )
s t
 can be 
expressed as 
( )
[ ] (
)
n
s t
I n g t
nT
=
−
∑
 
 
 
(1) 
where 
( )
g t  is the pulse shape function for each symbol 
such that 
178
SENSORCOMM 2011 : The Fifth International Conference on Sensor Technologies and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-144-1

( )
1,for 0
0,otherwise
T
g
τ
τ
≤
<
⎧
= ⎨
⎩
. 
 
 
(2) 
At the ith receiver, the received signal ( )
ir t  can be written 
as  
( )
( )
( )
( )
i
i
i
r t
h t
s t
w t
=
⊗
+
 
 
 
(3) 
where 
( )
ih t  represents the channel impulse response, 
( )
iw t  
is a band-limited noise, and ⊗  denotes convolution. PPC 
processing can be seen as match-filtering of the received data 
signal using a channel response. The output of PPC is 
expresssed as 
( )
(
)
( )
i
i
i
z
t
h
t
r t
=
−
⊗
 
(
)
( )
( )
( )
(
)
i
i
i
h
t
h t
s t
w t
=
−
⊗
⊗
+
 
       
( )
( )
( )
i
i
q t
s t
t
ς
=
⊗
+
, 
 
 
(4) 
where 
( )
iq t  is the autocorrelation function of 
( )
ih t , and 
( )
ςi t
 is a filtered noise. The main lobe width and side lobes 
of 
( )
iq t  are determined by the channel physics, and ISI 
caused by 
( )
iq t  exists after pulse compression. 
ISI can be mitigated by refocusing time delayed arrivals 
at a receiving array, where one channel output is obtained by 
passive time reversal. The output of diversity combining 
over K receivers is  
( )
(
)
( )
1
K
i
i
i
z t
h
t
r t
=
=
−
⊗
∑
 
( )
( )
( )
1
1
K
K
i
i
i
i
q t
s t
t
ς
=
=
=
⊗
+
∑
∑
 
( )
( )
( )
q t
s t
ς t
=
⊗
+
 
 
 
(5) 
where q(t) is a function of autocorrelations summed over the  
K receivers, and ζ(t) is a filtered noise. Residual ISI caused 
by q(t) can be removed by an adaptive channel equalizer [5]. 
Figure 1 shows the receiver structure for communications 
using passive time reversal, and it is realized by PPC plus a 
single channel DFE (PPC-DFE). Carrier-phase tracking is 
realized using the technique of a second order digital phase-
locked loop (DPLL) proposed by Stojanovic [10], and the 
DPLL tracks the mean frequency shift of K receivers. Based 
on the minimum mean square error (MSE) criterion, the 
coefficients for the feed-forward and feedback filters are 
obtained by the recursive least squares (RLS) algorithm 
[11]. The output error is defined as 
[ ]
[ ]
[ ]
e n
I n
I n
=
− 
 
 
 
 
(6) 
where [ ]
I n

 is the estimate. Out the training mode, [ ]
I n  is 
replaced by the decided output [ ]
ˆI n . 
The receiver structure PPC-McDFE is shown in Figure 
2, and it takes advantage of pulse compression in order to 
reduce the number of taps for the multichannel DFE. For the 
K  receivers, independent DPLLs compensate the frequency 
shifts, and the RLS algorithm updates coefficients of the 
feed-forward filters. This structure is designed to improve 
the performance of PPC-DFE by adaptive multichannel 
combining. As shown in Figure 1, one channel output 
exploits spatial diversity by low-complex combining 
without considering both the interchannel correlations and 
the output errors. For the structure shown in Figure 2, 
spatial diversity is exploited by performing adaptive spatial 
combining. Based on a previous output MSE, the RLS 
algorithm updates the filter tap coefficients for combining in 
order to minimize current output MSE. PPC-McDFE 
achieves superior performance in the trials. 
 
Figure 1. The diagram of PPC-DFE. There are N samples per symbol in baseband digital signal processing. 
 
Figure 2. The diagram of PPC-McDFE. 
179
SENSORCOMM 2011 : The Fifth International Conference on Sensor Technologies and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-144-1

III. 
THE EXPERIMENTS 
The two experiments were carried out on June 30 (Trial 
A) and September 9 (Trial B), 2010, in Trondheim harbor in 
Norway shown in Figure 3(a). In the experimental area, the 
shallow littoral region less than 20 m extends about 100 m 
off shore. The instrumentation and the source sound level 
were the same for both Trial A and Trial B. Figure 3(b) 
shows that the depth profile from the source to the CRA 
changes from 240 m to 10 m. The red dot denotes the 
position of the transmitter in a distance of 2 km to the CRA, 
and the transmitter used a hemispherical acoustic transducer 
suspended at a depth of 20 m from the NTNU research 
vessel R/V Gunnerus. The CRA is near-shore deployed in a 
water depth of 10 m, and it consists of a vertical receiving 
array of 6 hydrophones with 1 m element spacing and a 
horizontal receiving array of 4 hydrophones with 1.5 m 
element spacing. The dynamic positioning system of R/V 
Gunnerus was activated to reduce drifting. 
 
(a) 
 
(b) 
Figure 3.  (a) Experimental area in Trondheim harbor. The dash line is the 
communication direction. (b) The depth profile in the communication 
direction. The red dot on the left denotes the transmitter position, and the 
blue dot on the right denotes the receiving array. 
The sound speed profiles measured during the trials are 
shown in Figure 4. There was a sound channel at the depth 
of 25 m in Trial A. In Trial B, there was a negative gradient 
sound speed profile causing the acoustic energy emitted by 
the source bent towards the sea bottom. The receiving array 
was deployed at a depth which was different from the 
transmitter depth, and the received signal exhibited time-
varying fading due to reflections from the sea surface and 
bottom. 
 
Figure 4. Sound speed profiles measured by Gunnerus.  
The carrier frequency of the transmitted signals was 12 
kHz. The channel probe signal was a linear frequency 
modulation (LFM) chirp of 0.1 s with a Hanning window, 
and its effective bandwidth was 2.2 kHz. The chirp was also 
used as a pulse-shaping signal for the data signals, which 
were generated by binary phase shift keying (BPSK), 
quadrature phase shift keying (QPSK) modulations. The 
symbol rate in communications was R=1/T=1 kilosymbols/s.  
 
(a) 
 
(b) 
Figure 5. One period of the transmitted signal. (a) Trial A. (b) Trial B. 
Figure 5(a) shows one period of transmitted signal for 
Trial A, where the signals were repeatedly transmitted 18 
180
SENSORCOMM 2011 : The Fifth International Conference on Sensor Technologies and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-144-1

times. Figure 5(b) shows one period of transmitted signal for 
Trial B, where the signals were repeatedly transmitted 6 
times. The 60 chirps spanning 18 s in each period were used 
to measure the channel response. The received waveforms 
were recorded with a sampling frequency of 96 kHz for off-
line processing in the laboratory. 
IV. 
THE RESULTS AND ANALYSIS 
The parameters for PPC-DFE and PPC-McDFE are given 
in TABLE I. In baseband digital signal processing, the feed-
forward filter taps span 4 symbol intervals with an over 
sampling rate of N=2. As suggested in [12], the second order 
DPLL is configured with K2=K1/10 to get good performance. 
TABLE I.  
RECEIVER PARAMETERS 
Parameters 
Description 
Value 
Fs 
The sampling frequency at the CRA 
96 kHz 
fc 
Carrier frequency 
12 kHz 
R 
The symbol rate 
1000 symbols/s 
N 
Over sampling factor 
2 
Nff 
The number of feed forward filter taps 
8 
Nfb 
The number of feedback filter taps 
2 
Nt 
The number of training symbols 
72 
λ 
RLS forgetting factor 
0.999 
K 
The number of receiving channels 
10 
K1 
Proportional tracking constant in PLL 
0.01 
K2 
Integral tracking constant in PLL 
0.001 
A. Trial A 
In each period, the channel response within 18 s can be 
measured by the 60-chirp using the method of replica 
correlation. Figure 6 shows the overview of channel response 
measurements in hydrophone No. 4, which was located at a 
depth of 4.5 m above the sea bottom. The temporal 
compression is observed in the 45-minute trial, the time 
delayed arrivals in 18 periods are not aligned in delay time, 
and the first arrivals in the following periods approach the 
receiving array earlier than those in the previous periods. The 
compression rate changes with period, and the variation is 
caused by time-varying Doppler shift due to relative 
movement between the transmitter and the receiving array 
[13]. The channel response changes with time, it changes 
with receivers, and spatial diversity in the channel can be 
exploited to achieve stable communications.  
Figure 7 shows the receiver performance in the first 
frame versus the number of hydrophones, where the output 
SNR is calculated by (1-MSE)/MSE [7]. The performance 
increases with the number of receiving channels, where 
spatial diversity is exploited, and PPC-McDFE achieves 
superior performance over PPC-DFE using a small number 
of receivers. In maximum, an improvement gain of 4.5 dB is 
obtained where the signals of 7 receiving channels are used 
for processing. In the following analysis, 10 receiving 
channels are used in signal processing to assess the 
improvement in terms of output SNR. 
 
Figure 7. The performance for BPSK in terms of output SNR as a function 
of the number of receiving hydrophones. 
In the 45-minute trial, Figure 8 shows that the receiver 
performance changes with time, and PPC-McDFE achieves 
better performance than PPC-DFE. Since the receivers were 
deployed in a region of reverberation, input SNR varied 
with time. It is shown in Figure 6 that magnitude of the 
arrivals changes with time in the trial. It is calculated that 
the improvement gain for BPSK communication changes 
from 2.2 dB to 6.7 dB and the improvement gain for QPSK 
communication changes from 2.5 dB to 6.4 dB. The reason 
for the improvement variation is that interchannel 
correlations exist and change with time. 
 
Figure 6. The channel impulse response measurements during the 45-minute experiment. 
181
SENSORCOMM 2011 : The Fifth International Conference on Sensor Technologies and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-144-1

 
(a)                                                        (b) 
Figure 8. The performance in terms of output SNR. (a) BPSK. (b) QPSK. 
Spatial coherence measures the strength of interchannel 
correlation between two receivers, and it can be calculated 
by 
(
)
(
)
( )
(
)
( )
(
)
( )
max
max
max
,
m
n
m
m
n
n
r
t
r
t
m n
r
t
r
t
r
t
r
t
ψ
−
⊗
=
−
⊗
−
⊗
, (7) 
where 
(
)
( ) max
m
n
r
t
r
t
−
⊗
 denotes the maximum absolute 
value of cross-correlation between the two signals 
mr ( )
t  and 
nr ( )
t , and 
mr ( )
t  denotes the signal received by the mth 
hydrophone. Figure 9 shows the spatial coherence 
measurement in the 45-minute trial, and interchannel 
correlation exists and changes with time during the trial. 
Since it is infeasible to predict the spatial coherence 
variations in a real ocean environment [9], it becomes 
intractable to preset weights for the multichannel combining. 
PPC-DFE assumes that there are independent receivers of 
the receiving array, where the spatial diversity is exploited 
by combining prior to the adaptive channel equalization, and 
this assumption is impacted by the interchannel correlations. 
PPC-McDFE achieves superior performance which is 
attributed to the adaptive spatial combining, as the 
multichannel combining weights are updated based on output 
MSEs. 
 
Figure 9. The spatial coherence as a function of the hydrophone index. 
B. Trial B 
Due to a negative gradient sound speed profile shown in 
Figure 4, extended time delayed arrivals caused by 
reflections are observed in Figure 10. The maximum 
magnitude decreases by 10 dB in the second period, and the 
compression due to Doppler is observed, where the 
compression rate is about 3.2e-4 between the two periods. 
Figure 11 shows the BPSK performance in the first period. 
There is no bit error of 7782 bits with an output SNR of 
13.6 dB, and there is little difference in terms of the slope of 
phase offset from the DPLLs. This improvement gain is 
obtained from the adaptive spatial combining. The 
independent DPLLs are replaced by a common DPLL in the 
following processing 
 
 
(a) 
 
(b) 
Figure 10. The impulse response measurements in two continuous periods 
within 385.411 s. (a) The first period. (b) The second period. 
 
(a)                                                        (b) 
Figure 11. The receiver performance of PPC-McDFE. (a) The scatter plot. 
(b) The output of DPLL. 
A single DPLL can update an averaged value of the 
phase-offset corrections among the 10 receivers, and it is 
given by 
182
SENSORCOMM 2011 : The Fifth International Conference on Sensor Technologies and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-144-1

[ ]
[ ]
10
1
1
ˆ
ˆ
10
i
i
n
n
θ
θ
=
=
∑
 
 
 
 
(8) 
where 
ˆ [ ]
θi n
 denotes the phase offset estimate from ith 
DPLL. Figure 12 shows the performance in 6 periods, and 
improvement of passive time reversal communications is 
obtained. In calculation, the improvement gain changes 
from 1.7 dB to 5.1 dB for BPSK, and it changes from 1.8 
dB to 6.5 dB for QPSK. The improvement gain is attributed 
to spatial diversity exploited by the adaptive combining. 
Figure 13 shows the single DPLL output in 6 periods. For 
the BPSK signals, the slopes of phase offset change from 
2.1 rad/s to 9.0 rad/s, where the equivalent carrier frequency 
shifts vary from 0.3 Hz to 1.4 Hz. The equivalent carrier 
frequency shifts for the QPSK signals change from 0.5 Hz 
to 0.9 Hz. In a time-varying acoustic channel, it is necessary 
that carrier-phase tracking by DPLL is implemented to 
compensate Doppler shift for underwater communications.  
 
(a)                                                     (b) 
Figure 12. The performance in terms of output SNR. (a) BPSK. (b) QPSK. 
 
(a)                                                       (b) 
Figure 13. The single DPLL output. (a) BPSK. (b) QPSK. 
V. 
CONCLUSIONS 
The presented receiver structure which is based on pulse 
compression is assessed in two sea trials over a range 
dependent channel of 2 km. The presented results have 
shown that improvement of passive time reversal 
communications can be obtained by using adaptive spatial 
combining to exploit spatial diversity. In a real ocean, since 
the receivers of a receiving array are unable be distributed 
independently in space, there is no model which can predict 
time-varying interchannel correlations, and it is preferred 
that spatial diversity is exploited by the adaptive combining 
where the combining coefficients are updated to minimize 
output MSE. With a receiving array of a small number of 
hydrophones, we have demonstrated the performance of PC-
McDFE. 
ACKNOWLEDGMENT 
The author would like to thank PhD students Zhongxi 
Chao, Yan Jiang, technical engineer Tim Cato Netland and 
the crew of the R/V Gunnerus for the help in conducting the 
experiments. 
REFERENCES 
[1] 
D. B. Kilfoyle and A. B. Baggeroer, "The state of the art in 
underwater acoustic telemetry," IEEE J. Ocean. Eng., vol. 
25, pp. 4-27, 2000. 
[2] 
D. Rouseff, D. R. Jackson, W. L. J. Fox, C. D. Jones, J. A. 
Ritcey, and D. R. Dowling, "Underwater acoustic 
communication by passive-phase conjugation: theory and 
experimental results," IEEE J. Ocean. Eng., vol. 26, pp. 821-
831, 2001. 
[3] 
G. F. Edelmann, T. Akal, W. S. Hodgkiss, K. Seongil, W. A. 
Kuperman, and S. Hee Chun, "An initial demonstration of 
underwater acoustic communication using time reversal," 
IEEE J. Ocean. Eng., vol. 27, pp. 602-609, 2002. 
[4] 
T. C. Yang, "Correlation-based decision-feedback equalizer 
for underwater acoustic communications," IEEE J. Ocean. 
Eng., vol. 30, pp. 865-880, 2005. 
[5] 
H. C. Song, W. S. Hodgkiss, W. A. Kuperman, M. 
Stevenson, and T. Akal, "Improvement of time-reversal 
communications using adaptive channel equalizers," IEEE J. 
Ocean. Eng., vol. 31, pp. 487-496, 2006. 
[6] 
D. R. Dowling, "Acoustic pulse compression using passive 
phase-conjugate processing," J. Acoust. Soc. Am., vol. 95, 
pp. 1450-1458, 1994. 
[7] 
J. G. Proakis, Digital communications. New York: McGraw-
Hill, 2001. 
[8] 
H. C. Song, W. S. Hodgkiss, W. A. Kuperman, W. J. Higley, 
K. Raghukumar, T. Akal, and M. Stevenson, "Spatial 
diversity in passive time reversal communications," J. 
Acoust. Soc. Am., vol. 120, pp. 2067-2076, 2006. 
[9] 
T. C. Yang, "A study of spatial processing gain in 
underwater acoustic communications," IEEE J. Ocean. Eng., 
vol. 32, pp. 689-709, 2007. 
[10] M. Stojanovic, J. Catipovic, and J. G. Proakis, "Adaptive 
multichannel combining and equalization for underwater 
acoustic communications," J. Acoust. Soc. Am., vol. 94, pp. 
1621-1631, 1993. 
[11] S. Haykin, Adaptive Filter Theory. Upper Saddle River, New 
Jersey: Prentice Hall, 2001. 
[12] M. Stojanovic, "Efficient processing of acoustic signals for 
high-rate information transmission over sparse underwater 
channels," Physical Communication, vol. 1, pp. 146-161, 
2008. 
[13] B. S. Sharif, J. Neasham, O. R. Hinton, and A. E. Adams, "A 
computationally efficient Doppler compensation system for 
underwater acoustic communications," IEEE J. Ocean. Eng., 
vol. 25, pp. 52-61, 2000. 
 
183
SENSORCOMM 2011 : The Fifth International Conference on Sensor Technologies and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-144-1

