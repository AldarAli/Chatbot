Reduced Complexity Algorithm for Quantized Equal Gain Transmission Codebook
over Closed Loop MIMO Systems
Noe Yoon Park, Xun Li, and Young Ju Kim
College of Electrical and Computer Engineering
Chungbuk National University, Chungbuk 361-763 Rep. of Korea
Email: {nypark, lixun, yjkim}@cbnu.ac.kr
Abstract—In this paper, a novel index search algorithm
is proposed for quantized equal gain transmission (QEGT)
codebook based closed-loop multiple-input multiple-output sys-
tems. The codewords are grouped into a small number of
categories by utilizing Grassmannian beamforming criterion.
Then, the optimal centroid is selected within those of the
groups, which maximizes the signal-to-noise ratio or capacity
criterion. Hereby, the optimal index of QEGT codebook is
determined within the group of the selected centroid. Monte-
Carlo simulations are presented to show that the codebook
index search complexity is halved, whilst maintaining almost
the same throughput.
Keywords-Codebook; Closed-loop MIMO; Limited feedback;
Grouping; Grassmannian beamforming.
I. INTRODUCTION
For
closed-loop
multiple-input
multiple-output
(CL-
MIMO) communication systems, the transmit beamforming
(TxBF) technique alleviates the negative effect of fading
channel by exploiting spatial diversity due to the increased
number of MIMO fading channel paths. The TxBF requires
feedback of channel state information (CSI) from the re-
ceiver to the transmitter. Such CSI feedback can potentially
incur excessive overhead due to the multiplicity of channel
coefﬁcients, and thus a small number of feedback bits are
sent via a feedback path for the transmitter to recreate the
TxBF vector. These systems are known as limited feedback
systems (see [1] and the references therein). To reduce
the bandwidth requirement of the feedback systems, ﬁnite
rate techniques have been proposed for the cases of TxBF
[2]-[4]. In these limited feedback systems, the receiver
chooses a precoding matrix from a ﬁnite set of precoding
matrices, called codebook, on the basis maximizing the
effective capacity or signal-to-noise (SNR) after combining,
and sends the corresponding bits, which denotes index, to the
transmitter. The codebook design strategies which have been
suggested use either numerical optimization methods [4]-
[8] or random vector quantization (RVQ) method [9]. Such
random codebooks have been shown to be asymptotically
optimal as the number of feedback bits and transmitted
antennas increase [10], [11].
Among various codebooks for the TxBF, the QEGT code-
book is the optimal precoding matrix for maximizing the
capacity with a per-antenna equal power constraint. Also, it
has modest transmit ampliﬁer requirements than other TxBF
techniques, since it does not require the antenna ampliﬁers
to modify the amplitudes of the transmitted input signals
[5]. Similar to other codebook based CL-MIMO systems,
QEGT codebook needs a larger size codebook which gives
better performance than a small size one, as the number of
transmit antennas increases. In other words, the codebook
size increases exponentially with the number of transmit
antennas to maintain a given effective capacity or SNR loss
with respect to the ideal non-quantized system [3], [4], [8].
The increased codebook size can cause a feedback delay
due to the large amount calculation of excessive search (full
index search) [4],[5], and also reduce the effectiveness of
the precoding matrix at the transmitter [12]. It can be seen
that the feedback delay may lead to negative effects on
information capacity or symbol error rate [13]-[17]. Non-
exhaustive methods for searching unstructured codebooks
at the expense of increased memory requirements have
been well researched in [18]. Hence, employing an efﬁcient
codebook index search algorithm becomes essential.
In this paper, an efﬁcient codebook index search algorithm
with Grassmannian beamforming criterion is proposed for
ﬁnding optimal precoding matrix of QEGT codebook based
CL-MIMO systems. Monte-Carlo simulations are presented
to show that the normalized complexity is halved, whilst
maintaining almost the same achievable throughput compar-
ing to the full index search algorithm when the number of
transmit antennas is more than three.
The remainder of the paper is organized as follows.
Section II reviews CL-MIMO communication with TxBF.
In Section III, we propose reduced complexity QEGT code-
book index search algorithm which relies on a grouping
strategy. In Section IV, the results of previous sections are
demonstrated, and related discussions are given. Finally,
concluding remarks are given in Section V.
II. SYSTEM OVERVIEW
The CL-MIMO system relying on the TxBF and using
Nt transmit as well as Nr receive antennas is considered.
The M-dimensional complex transmit symbol vector at the
135
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

channel instant m (for m = 0, 1, . . .) is denoted by 1sm =
[sm,1 · · · sm,M]T ∈ CM×1 with sm ∼ CN (0M×1, IM) and
M ≤ min{Nt, Nr}. The vector Wsm is sent through the
channel where W ∈ CNt×M is the precoding matrix. Then,
the received signal vector ym at the Nr receive antennas
can be written as
ym =
r ρ
M HmWsm + nm,
(1)
where nm ∈ CNr×1 denotes the noise vector with nm ∼
CN (0Nr×1, INr) and ρ denotes the SNR. The matrix
Hm ∈ CNr×Nt represents uncorrelated Rayleigh falt fading
channel matrix with i.i.d. entries distributed according to
CN (0, 1).
The evolution of Hm is modeled by a ﬁrst-order Gauss-
Markov process [19]
Hm = ǫHm−1 +
p
1 − ǫ2Gm,
(2)
where Gm ∈ CNr×Nt has i.i.d. entries with distribution
∼ CN (0, 1). The noise process nm in (1) is indepen-
dent of Gm and H0. The time correlation coefﬁcient
ǫ (0 ≤ ǫ ≤ 1) represents the correlation between elements
hm,i,j and hm−1,i,j (where hm,i,j denotes the (i, j) entry
of Hm). We assume all the elements of Hm have the
same ǫ. The evolution variable ǫ obeys Jakes’ model [20]
according to ǫ = J0(2πfDT), where J0(·) is the zeroth
order Bessel function, T denotes the channel instantiation
interval, and fD =
vfc
c
denotes the maximum Doppler
frequency using terminal velocity v, carrier frequency fc,
and c = 3 × 108m/s.
In a TxBF system, the key question is how to design W
to maximize the system performance. For this reason, W
should be chosen to maximize the receive SNR in order
to minimize the average probability of error and maximize
the capacity. In general, it can be determined by applying
the singular vector decomposition (SVD) [21]. However,
accurate quantization and feedback of this precoding matrix
can require a large number of feedback bits quantized
TxBF techniques provide a solution for this problem by
quantizing the optimal precoder at the receiver. Speciﬁcally,
the precoder is constrained to be one of N matrices, which
is called a codebook. If the codebook of N matrices is
known to both the transmitter and the receiver, L = log2N
bits of feedback are required for indicating the index of
the appropriate precoding matrix [22]. Denote the precoding
QEGT codebook W = {Wk}N
k=1 and Wk ∈ U(Nt, M). A
procedure to generate the QEGT codebook for TxBF system
is clearly given in six steps [5].
1a bold lower case letter a denotes the vector, a bold capital letter A
denotes a matrix, A ∈ Cm×n denotes complex matrix A having m row
and n column, AH denotes the conjugation transposition of matrix A, IM
denotes the M ×M identity matrix, 0m×n denotes the m × n zero matrix,
U(m, n) denotes the set of m × n matrices with orthogonal columns,
∥·∥F denotes the Frobenius norm of a matrix, log2(·) denotes the base
two logarithm, and det(·)denotes the determinant of a matrix.
We assume that the receiver perfectly knows the current
CSI by channel estimation algorithms. In order to maximize
the system performance, two optimum codebook index se-
lection criterions are presented: one is the SNR selection
criterion and another is the capacity selection criterion. In
the SNR selection criterion, the W should be selected to
maximize the receive SNR, thus the selection criterion can
be expressed as follows [4]
W = arg max
Wk∈W
∥HmWk∥F .
(3)
Another precoding matrix selection criterion is the maximum
capacity, which can be written as follows [23]
W = arg max
Wk∈W
log2 det

IM + ρ
M WH
k HH
mHmWk

. (4)
From (3), (4), the optimal precoding matrix W satisfy both
SNR and capacity maximization criterions.
III. PROPOSED INDEX SEARCH ALGORITHM
In order to reduce the complexity of index search al-
gorithm for QEGT, we propose a new codeword grouping
algorithm. In the second subsection, the optimal precoding
matrix index selection algorithm was presented among the
generated groups.
A. Grouping the codewords of QEGT
The prcoding matrices in the codebook are divided into a
given number groups. Assuming that the QEGT codebook
elements are uniformly quantized, the precoding matrices
can be arranged into P groups, each group having Q precod-
ing matrices (N = P × Q). The proposed grouping strategy
uses Grassmannian beamforming criterion to generate P
groups of codeword. Also, another grouping strategy using
Lloyd’s algorithm will be addressed brieﬂy to compare
performance for the proposed algorithm, which has already
studied in [25]. The major difference between these two
grouping strategies is that the key idea of proposed algorithm
uses index elimination, while the Voronoi cell is used in
[25]. Also, the proposed algorithm has characteristic that the
precoding matrices in the QEGT codebook are distributed
always evenly to each group, while the grouping strategy
using Lloyd’s algorithm is not always doing so. i.e., if we
have N = 16, P = 4, Q for the proposed algorithm is
always 4, Q for Lloyd’s algorithm has a value between 3
and 5. Thus, the calculation of proposed algorithm is always
minimum comparing to the approach in [25]. This can be
extended more generally, which will be shown in Section
IV.
1) Grassmannian beamforming criterion: Using Grass-
mannian beamforming criterion, it can be maximized that the
minimum distance between any pair of lines spanned by the
codebook matrices on Grassmann manifold [4], [24]. And it
provides an approach for ﬁnding optimal line packings. We
outline the process as the following.
136
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

Figure 1.
Centroid selection using Grassmannian beamforming criterion.
Figure 2.
Grouping the precoding matrix using chordal distances.
• Step
1:
Generate
candidate
reference
codebooks
{Wc
i }N
i=1 by deleting the i-th index matrix from W.
Thereby the number of candidate reference codebooks
is N = card (W), where card(·) denotes the cardinal-
ity of a set. Let N c = card (Wc
i ).
• Step 2: Select the optimal candidate codebook Wc
opt
from the candidate codebooks which has maximized
minimum distance between each pair of matrices. This
can be expressed as follows
d (Wk, Wl) =
q
1 −
WH
k Wl
2,
(5)
δ (Wc
i ) =
min
(Wk,Wl)∈Wc
i
d (Wk, Wl) ,
(6)
and
Wc
opt =
arg max
Wc
i ∈{Wc
i }
N
i=1
δ (Wc
i ) .
(7)
• Step 3: If N c is not equal to P, let W = Wc
opt which is
previously selected. And repeat step 1 and step 2 until
N c = P, as shown in Fig. 1.
• Step 4: The deleted precoding matrices (in step 1) are
assigned to its nearest centroid by using the chordal
distance as in (5). This procedure generates new groups
which only have one centroid in each of them, as shown
in Fig. 2, where cp, p = 1, 2, . . . , P are the centroid
indices.
Figure 3.
Example of QEGT codebook grouping when Nt=2, N=64 and
M=1.
2) Lloyd’s algorithm: To illustrate the grouping strategy
with Lloyd’s algorithm, we consider the case of Nt=2,
N=64 and M=1. The 1st element of the TxBF vectors
corresponding to the 1st transmit antenna can be forced
to be real-valued owing to the rotation-invariant property
of BF vectors [4]. Then, the 2nd element of the TxBF
vectors corresponding to the 2nd transmit antenna can be
plotted on the complex-valued plane, as seen in Fig. 3, which
illustrates eight groups of TxBF vectors as the result of
Lloyds clustering algorithm. In the notation of wi,j seen
in Fig. 3, i represents the i-th element of the TxBF vector
corresponding to the i-th transmit antenna and j denotes the
index of the TxBF vector in the QEGT codebook. Fig. 3
also magniﬁes a group of eight TxBF vectors at the right,
where the cluster centroid is indicated by a square mark (□),
while the others are indicated by triangles (△). In the same
way, we can group the precoding matrices in the QEGT
codebook, when the number of transmit antennas is higher
than or equal to three. The more detailed grouping strategy
using Lloyd’s algorithm has been well documented in [25].
B. Group index selection criterion for QEGT codebook
Among the various centroids, the best of the centroids
copt is selected, which maximized the receive SNR
copt = arg max
cp∈Cset
HmWcp

F ,
(8)
or channel capacity
copt = arg max
cp∈Cset
log2 det

IM + ρ
M WH
cpHH
mHmWcp

,
(9)
where Cset is the set of {c1, c2, . . . , cp}. And then, the
optimal precoding matrix index mopt is determined within
the group of the selected best centroid, which maximized
the receive SNR as follows
mopt = arg max
mq∈Mset
HmWmq

F ,
(10)
or channel capacity
mopt = arg max
mq∈Mset
log2 det

IM + ρ
M WH
mqHH
mHmWmq

,
(11)
137
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

where mq, (q = 1, 2, . . . , Q) represents the precoding
matrices of the chosen centroid group and Mset is the set
of {m1, m2, . . . , mq}.
From the above process, proposed scheme needs only the
search of P +Q indices within QEGT codebook. It is much
smaller than the number of full index search algorithm in
(3), (4). For this reason, the entire search complexity is
signiﬁcantly reduced. Also, considering the highly tempo-
rally correlated fading channels, the group of the selected
centroid as in (8), (9) almost constants. Therefore the entire
search complexity is more reduced by researching only the
Q indices.
The problem now becomes how to determine the number
of groups, P and the number of elements Q in the group,
when QEGT codebook size N is ﬁxed. The proposed
grouping rule can be applied that the number of groups,
P should be the same or the nearest integer to the value of
N/P when the precoding matrix in the QEGT codebook are
distributed almost evenly to each group.
IV. SIMULATION RESULTS
In this section, we perform Monte-Carlo simulations to
investigate the achievable throughput performance of the
proposed algorithm in MIMO channels. The CL-MIMO
system is equipped with Nt transmit antennas, and Nr
receive antennas, we use the notation Nt × Nr to denote
Nt transmit and Nr receive antenna system. In order to
show the performance in vehicular environments, simulation
parameters employed in IEEE 802.11p/WAVE standard [26]
are used. In IEEE 802.11p/WAVE, the TxBF system assumes
mobile speed 50km/h, carrier frequency of 5.9GHz, band-
width of 10MHz, and feedback interval of 5ms, thus, typical
time correlation coefﬁcient is ǫ=0.020. In our systems, only
low mobile speed is supported (less than 60km/h), this
is supported in 3GPP LTE and IEEE 802.16p standards.
And adaptive modulation coding is assumed for orthogonal
frequency division multiplexing system whose DFT/IDFT
size is 512. The simulations were run with over 1.5 million
iterations per SNR point. Codebook for the QEGT system
was designed based on Grassmannian beamforming criterion
[5]. The entire codebook size for 3 transmit antennas is 16,
and the entire codebook size for 4 and 5 transmit antennas is
64. The maximum capacity selection criterion is used for the
optimal precoding matrix selection. The feedback channel is
assumed to be error free. Also, we assumed that the channel
estimation and synchronization are perfect and there is no
spatial correlation amongst transmit and receive antennas.
The achievable throughput performance of the proposed
and the full index search ones which have 3 × 2, 4 × 3
and 5 × 4 systems are shown in Fig. 4. We assume P
is 4 and 8 for 3 transmit antennas and 4 or 5 transmit
antennas, respectively. Fig. 4 shows the performance of
proposed algorithm, the proposed algorithm (curve label
‘proposed algorithm’) performs almost the same as those
Figure 4.
Throughput versus SNR when mobile speed is 50km/h.
Figure 5.
Comparison of the calculated indices for QEGT codebook both
the full index search algorithm and the proposed algorithm.
of the approach in [25] (curve label ‘algorithm in [25]’).
And those performance almost achieve the full index search
algorithm (curve label ‘full index search’).
Fig. 5 shows how much the QEGT codebook index
search complexity is reduced in comparison to the full
index search algorithm. When the proposed codebook index
search algorithm using group strategy based on Grass-
mannian beamforming criterion is applied, i.e., we have
(N, P, Q) = (16, 4, 4) or (64, 8, 8), we have almost
the same performance comparing to the full index search
ones, while maintaining the lowest codebook index search
138
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

complexity. From the results of Fig. 5, the optimal grouping
is that the value of P should be nearly the same at the
value of Q. In other words, the value of Q may vary around
the nearest integer of N/P. Thereby, the codebook index
search complexity is halved, whilst maintaining almost the
same throughput when the number of transmit antennas is
more than three.
V. CONCLUSION
In this paper, we have investigated the codebook index
search problem for CL-MIMO systems. A complexity re-
duced index search algorithm for QEGT codebook is pro-
posed which uses grouping strategy based on Grassmannian
beamforming criterion. From the simulation results, as the
QEGT codebook size increases, the QEGT codebook index
search complexity of the proposed algorithms were signiﬁ-
cantly decreased comparing with that of the full index search
algorithm. Moreover, the achievable throughput performance
of our proposed algorithm were almost the same as those of
the existing full index approaches.
ACKNOWLEDGMENT
This research was supported by Basic Science Research
Program through the National Research Foundation of Ko-
rea(NRF) funded by the Ministry of Education, Science and
Technology (2012R1A1B6002111).
REFERENCES
[1] D. J. Love, R. W. Heath, Jr., W. Santipach and M. L. Honig
“What is the value of limited feedback for MIMO channels?,”
IEEE Commun. Magazine, vol. 42, pp. 54-59, Oct. 2004.
[2] A. Narula, M. J. Lopez, M. D. Trott, and G. W. Wornell,
“Efﬁcient use of side information in multiple-antenna data
transmission over fading channels,” IEEE J. Selected Areas
of Commun., vol. 16, pp. 1423-1436, Oct. 1998.
[3] K. K. Mukkavilli, A. Sabharwal, E. Erkip, and B. Aazhang,
“On beamforming with ﬁnite rate feedback in multiple-antenna
systems,” IEEE Trans. on Information Theory, vol. 49, pp.
2562-2579, Oct. 2003.
[4] D. J. Love, R. W. Heath, Jr., and T. Strohmer, “Grassmannian
beamforming for multiple-input multiple-output wireless sys-
tems,” IEEE Trans. on Information Theory, vol. 49, pp. 2735-
2747, Oct. 2003.
[5] D. J. Love and R. W. Heath, Jr., “Equal Gain Transmission
in Multiple-Input Multiple-Output Wireless Systems,” IEEE
Trans. on Communications, vol. 51, pp. 1102-1110, July 2003.
[6] C. R. Murthy and B. D. Rao, “Quantization methods for equal
gain transmission with ﬁnite rate feedback,” IEEE Trans. on
Signal Processing, vol. 55, pp. 233-245, Jan. 2007.
[7] J. C. Roh and B. D. Rao, “Transmit beamforming in multiple-
antenna systems with ﬁnite rate feedback: a VQ-based ap-
proach,” IEEE Trans. on Information Theory, vol. 52, pp. 1101-
1112, Mar. 2006.
[8] P. Xia, S. Zhou and G. B. Giannakis, “Achieving the Welch
bound with difference sets,” IEEE Trans. on Information The-
ory, vol. 51, pp. 1900-1907, May 2005.
[9] W. Santipach and M. L. Honig, “Signature optimization for
CDMA with limited feedback,” IEEE Trans. on Information
Theory, vol. 51, pp. 3475-3492, Oct. 2005.
[10] W. Dai, Y. Liu, and B. Rider, “Quantization Bounds on Grass-
mann Manifolds and Applications to MIMO Communications,”
IEEE Trans. on Information Theory, vol. 54, pp. 1108-1123,
Mar. 2008.
[11] W. Santipach and M. L. Honig, “Capacity of a multiple-
antenna fading channel with a quantized precoding matrix,”
IEEE Trans. on Information Theory, vol. 55, pp. 1218-1234,
Mar. 2009.
[12] K. Huang, B. Mondal, R. W. Heath, Jr., and J. G. Andrews,
“Effect of feedback delay on multi-antenna limited feedback
for temporallycorrelated channels,” in Proc. IEEE Global Com-
mun. Conf. (GLOBECOM), San Francisco, CA, USA, Nov.
2006.
[13] J. Du, Y. Li, D. Gu, A. F. Molisch, and J. Zhang, “Estimation
of performance loss due to delay in channel feedback in MIMO
systems,” in Proc. IEEE Veh. Technology Conf., vol. 3, pp.
1619-1622, Sep. 2004.
[14] E. Au, S. Jin, M. R. McKay, W. Mow, X. Gao, and
I. B. Collings, “Analytical performance of MIMO-SVD sys-
tems in Ricean fading channels with channel estimation error
and feedback delay,” IEEE Trans. Commun., vol. 7, no. 4, pp.
1315-1325, Apr. 2008.
[15] Y. Isukapalli and B. D. Rao, “Finite rate feedback for spatially
and temporally correlated MISO channels in the presence of
estimation errors and feedback delay,” in Proc. IEEE GLOBE-
COM, pp. 2791-2795, Nov. 2007.
[16] K. Kobayashi, T. Ohtsuki, and T. Kaneko, “MIMO systems
in the presence of feedback delay,” in Proc. IEEE Int. Conf.
Communications, vol. 9, pp. 4102-4106, Jun. 2006.
[17] S. H. Ting, K. Sakaguchi, and K. Araki, “A Markov Kro-
necker model for analysis of closed-loop MIMO systems,”
IEEE Commun. Lett., vol. 10, pp. 617-619, Aug. 2006.
[18] R. M. Gray and D. L. Neuhoff, “Quantization,” IEEE Trans.
on Information Theory, vol. 44, pp. 2325-2383, Oct. 1998.
[19] R. H. Etkin and D. N. C. Tse, “Degree of freedom in some
underspread MIMO fading channel,” IEEE Trans. Inf. Theory,
vol. 52, no. 4, pp. 1576-1608, Apr. 2006.
[20] J. G. Proakis, Digital Communications, 4th edition, McGraw
Hill, 2000.
[21] D. J. Love and R. W. Heath, Jr., “Limited feedback unitary
precoding for orthogonal space-time block codes,” IEEE Trans.
on Signal Processing, vol. 53, pp. 64-73, Jan. 2005.
[22] J. G. Andrews, A. Ghosh, and R. Muhamed, Fundamentals
of WiMAX understanding broadband wireless networking,
Prentice Hall, 2007.
139
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

[23] T. J. Kim, D. J. Love and B. Clerckx, “MIMO system with
limited rate differential feedback in slowly varying channels,”
IEEE Trans. on Commun., vol. 59, no. 4, pp. 1175-1189, Apr.
2011.
[24] A. Bang and D. Y. Nogin, “Bounds on packings of spheres in
the Grassmann manifold,” IEEE Trans. on Information Theory,
vol. 48, pp. 2450-2454, Sep. 2002.
[25] Y. J. Kim, S. H. Won, N. Y. Park, and L. Hanjo, “Reduced-
complexity transmit-beamforming codebook search algorithm,”
Elec. Letter, vol. 47, pp. 938-939, Aug. 2011.
[26] IEEE Std 802.11p, “Wireless LAN medium access control
and physical layer speciﬁcations: Wireless access in vehicular
environments,” July 2010.
140
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

