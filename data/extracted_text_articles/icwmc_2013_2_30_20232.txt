An Improved Extended Kalman Filter for
Localization of a Mobile Node with NLOS Anchors
Siamak YouseÔ¨Å
Department of Electrical and
Computer Engineering, McGill University
Montreal, H3A0E9, QC, Canada
Email: siamak.youseÔ¨Å@mail.mcgill.ca
Xiao-Wen Chang
School of Computer Science,
McGill University,
Montreal, H3A0E9, QC, Canada
Email: chang@cs.mcgill.ca
Benoit Champagne
Department of Electrical and
Computer Engineering, McGill University
Montreal, H3A0E9, QC, Canada
Email: benoit.champagne@mcgill.ca
Abstract‚ÄîTracking a mobile node using a wireless sensor
network under non-line of sight (NLOS) conditions, has been
considered in this work, which is of interest to indoor positioning
applications. A hybrid of time difference of arrival (TDOA)
and angle of arrival (AOA) measurements, suitable for tracking
asynchronous targets, is exploited. The NLOS biases of the TDOA
measurements and the position and velocity of the target are
included in the state vector. To track the latter, we use a modiÔ¨Åed
form of the extended Kalman Ô¨Ålter (EKF) with bound constraints
on the NLOS biases, as derived from geometrical considerations.
Through simulations, we show that our technique can outper-
form the EKF and the memoryless constrained optimization
techniques.
Keywords‚ÄîExtended Kalman Ô¨Ålter; localization; non-line of
sight; ultra wideband.
I.
INTRODUCTION
Ground-based wireless positioning has received great at-
tention in indoor and dense urban areas due to the limitations
of the global positioning system (GPS) [1]. The Ô¨Åne timing
resolution of ultra-wideband (UWB) pulses makes them robust
against multipath fading and thus, the methods based on time
of arrival (TOA) can achieve good accuracy [2]. Localiza-
tion techniques that directly exploit the TOA measurements
require accurate target-anchor synchronization. However, if
only anchor-anchor synchronization is maintained, the time
difference of arrival (TDOA) data can be exploited for local-
ization. Furthermore, the angle of arrival (AOA) measurement
of UWB signal requires no tight synchronization among the
anchors, and its accuracy improves with increasing the system
bandwidth [3]. Although the AOA measurement of UWB
signal is challenging in practice, some methods have been
recently proposed for the joint measurement of TOA and AOA
in UWB systems [4]. Indeed, exploiting a hybrid of angle and
range information can reduce the number of required line of
sight (LOS) nodes for localization.
One of the main challenges in network-based positioning
remains the non-line of sight (NLOS) problem, which occurs
due to the blockage of target-anchor view. In a NLOS scenario,
the TOA of the Ô¨Årst detectable signal at the receiver is larger
than it would be for a direct line of sight (LOS) path, resulting
in a positively biased range measurement. Also, the AOA
measurements will be corrupted by a random perturbation
distributed within [0, 2œÄ) [1]. The TOA-based localization
in NLOS for a single time instant is summarized in [5].
More recently, the constrained optimization technique using
sequential quadratic programming (SQP) in [6] has shown a
good performance for position and NLOS bias estimation. In
[6], the lower bound on the NLOS bias is set to zero and the
upper bound proposed in [7] is employed. When the target
is moving, the history of the past measurements along with
the state equation can help in estimating a better location over
time. In [8] and [9], the TDOA-AOA data are exploited for
cellular and UWB indoor tracking, respectively. In both papers,
Kalman Ô¨Ålter (KF) preprocessing is applied on the received
TOA data for NLOS mitigation, and the variances of the range
measurements are estimated. In [9], further NLOS mitigation
is done by scaling the covariance matrix of the measurement
noise in an extended Kalman Ô¨Ålter (EKF).
While these methods enable the tracking of a moving node
under NLOS conditions, they have some disadvantages. First,
the KF preprocessing cannot mitigate the effect of NLOS
effectively, especially if the nodes are initially in a severe
NLOS situation. Second, the online variance calculation of
the range measurement of a moving target might not be done
with good accuracy for NLOS links. In [10], the state vector
of the EKF is augmented with the NLOS biases in addition to
position and velocity, which helps in improving the positioning
accuracy under NLOS conditions. Similar state equations have
been used in particle Ô¨Ålters (PF) developed for UWB indoor
tracking of a target equipped with an inertial measurement unit
(IMU) in [11], [12]. However, the computational cost of the
PF grow exponentially with the size of the state vector [12],
hence it is less suitable for practical applications.
In this paper, we propose a constrained form of the EKF
for localization of an asynchronous mobile node under mixed
LOS/NLOS conditions. The state vector of the proposed Ô¨Ålter,
similar to [10], is augmented with the NLOS biases. The steps
of the constrained EKF follow those of the EKF, except for the
estimation of the state vector at each time instant, where the
2-norm of a linearized vector function is minimized subject
to bound constraints on the NLOS biases. These constraints
are linear and depend on the geometry and the type of
the measurements exploited. Since here, we use TDOA-AOA
measurements for localization of an asynchronous node, the
upper bound given in [7] can not be exploited. Therefore,
we propose novel lower and upper bounds on the NLOS bias
by exploiting the underlying geometry of the angle and range
difference equations. Through simulations, we show that the
proposed constrained EKF outperforms the ordinary EKF in
[10], and the memoryless constrained optimization technique
25
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

in [6]. Other advantages of the proposed approach are its
simplicity and low computational cost, which makes it suitable
for practical applications.
The remainder of this paper is organized as follows: In
Section II, the system model is described, and the formulation
of the problem is given. The derivation of the bounds on the
NLOS biases and the constrained EKF technique are described
in Section III. In Section IV, illustration of simulation results
are presented. Finally, Section V concludes the paper.
II.
SYSTEM MODEL AND PROBLEM FORMULATION
A. Range and Bearing Measurements in NLOS
We consider a 2-dimensional (2D) indoor plane on which
a wireless sensor network (WSN) with M Ô¨Åxed anchors
at known positions pi = [Xi, Yi]T is deployed. The goal
is to track a mobile target with unknown position p[k] =
[x[k], y[k]]T and velocity v[k] = [vx[k], vy[k]]T at the k-th
time instant. The synchronized anchors are placed near the
boundary of the room in order to cover the area, as the anchor
placement has a direct effect on the localization accuracy [5].
For the sake of simplicity, let the indices i ‚àà {1, . . . , N}
denote the anchors that are in NLOS, and i ‚àà {N +1, . . . , M}
denote the anchors with LOS measurements. We assume that
the NLOS links can be identiÔ¨Åed accurately at every time
instant. To this end, NLOS identiÔ¨Åcation techniques based on
hypothesis testing have been proposed in [8], [9], [13], [5].
Furthermore, NLOS identiÔ¨Åcation based on the features of the
received UWB timing pulse can yield a good result [14].
The range measurement for the i-th anchor, zi[k], is ob-
tained by multiplying the corresponding TOA measurement
with the speed of wave propagation. The set of range equations
for the M anchors are
zi[k] = di[k] + «´[k] + bi[k] + ni[k],
i = 1, . . . , M
(1)
where di[k]
=
p
(x[k] ‚àí Xi)2 + (y[k] ‚àí Yi)2 is the true
range, «´[k] is proportional to the relative clock offset between
the target and the anchors (the clock offset is common among
the anchors as they are synchronized), bi[k] is the NLOS bias
which is a positive random variable for i ‚àà {1, . . ., N} and
zero for i ‚àà {N + 1, . . . , M}, and ni[k] is the measurement
noise. The distribution of the NLOS bias is location depen-
dent and time varying; therefore, assuming a priorly known
distribution is not practical. However, as the target moves, the
instantaneous value of the NLOS bias can be approximately
modelled as a random walk
bi[k + 1] = bi[k] + wb[k],
i = 1, . . . , N
(2)
where the increment wb[k] is a uniform random variable with
zero-mean and variance œÉ2
wb [11], [12]. The measurement noise
in (1) is modelled as a normal random variable with zero-mean
and variance œÉ2
ni[k]. In UWB systems, the variance of this
noise can be represented as
œÉ2
ni[k] = œÉ2
0dŒ≤
i [k],
(3)
where œÉ0 is a proportionality constant and Œ≤ is the path-loss
exponent, which might have different values based on the
environment, e.g., Œ≤ = 2 for LOS and Œ≤ = 3 for NLOS have
been considered in [15].
The AOA can be measured jointly with the TOA by means
of UWB antenna arrays as done in [4]. The AOA of the
NLOS anchors are discarded as done in [9], since they are
corrupted by random perturbations uniformly distributed in the
interval [0, 2œÄ). The AOA of the LOS anchors with respect to
a reference coordinate system are
Œ∏i[k] = tan‚àí1  y[k] ‚àí Yi
x[k] ‚àí Xi

+nŒ∏i[k], i = N +1, . . ., M (4)
where the measurement error, nŒ∏i[k], is normally distributed
with zero-mean and variance œÉ2
Œ∏.
The clock offset parameter «´[k] is cancelled out by subtract-
ing the measured range of each anchor in (1) from a reference
anchor, which amounts to employing TDOA measurements.
If all the anchors are in NLOS, i.e., N = M, then the
range difference achieved through subtraction has either a
positive or negative bias. For this scenario, the techniques
in [8] and [9] can be employed, where KF preprocessing
is used for smoothing and variance calculation. However, as
mentioned earlier, KF smoothing can not mitigate the effect
of the NLOS bias efÔ¨Åciently. In this paper, to overcome this
limitation, we assume instead that there is at least one LOS
range measurement available, i.e., N < M. In this case, the
range difference measurements can be obtained with respect
to a selected reference LOS anchor, which for simplicity is
indexed by M. If multiple LOS anchors are available, then
amongst them, we propose to select as reference anchor the one
which is closest to the target, i.e., with respect to which all the
LOS range differences are positive. Since a smaller measured
range is usually less likely to be in NLOS compared to a
larger range, this selection of the reference anchor is relatively
robust against false alarm in NLOS detection. Furthermore, the
choice of the reference anchor can change over time due to
the transition from LOS to NLOS. If the i-th anchor changes
from NLOS to LOS, then bi[k] becomes zero, while if the i-th
anchor changes from LOS to NLOS then the bias changes from
zero to a positive random value. Therefore, if the reference
anchor goes through such a transition, then another anchor
which is in LOS has to be selected as the reference. If there
are two or more LOS anchors, then by rejecting the NLOS
range measurements, the location can be estimated without
ambiguity, however, the performance highly depends on the
AOA measurement error, which might have a large error in
some applications.
The range difference equations hence take the form
‚àÜzi[k] =
‚àÜdi[k] + bi[k] + ‚àÜni[k]
i = 1, . . . , N
‚àÜdi[k] + ‚àÜni[k]
i = N + 1, . . . , M ‚àí 1
where ‚àÜzi[k] = zi[k] ‚àí zM[k], ‚àÜdi[k] = di[k] ‚àí dM[k] and
‚àÜni[k] = ni[k] ‚àí nM[k].
B. Problem Formulation
Let the unknown state vector, which includes the biases, be
deÔ¨Åned as s[k] = [x[k], y[k], vx[k], vy[k], b1[k], . . . , bN[k]]T .
The measurement equation can be expressed as
y[k] = h(s[k]) + n[k],
(5)
26
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

where
y[k] =
Ô£Æ
Ô£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£∞
‚àÜz1[k]
...
‚àÜzN[k]
‚àÜzN+1[k]
...
‚àÜzM‚àí1[k]
Œ∏N+1[k]
...
Œ∏M[k]
Ô£π
Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£ª
,
h(s[k]) =
Ô£Æ
Ô£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£ØÔ£∞
‚àÜd1[k] + b1[k]
...
‚àÜdN[k] + bN[k]
‚àÜdN+1[k]
...
‚àÜdM‚àí1[k]
tan‚àí1 
y[k]‚àíYN+1
x[k]‚àíXN+1

...
tan‚àí1 
y[k]‚àíYM
x[k]‚àíXM

Ô£π
Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫Ô£ª
,
and n[k] is a normally distributed random vector with zero-
mean and covariance matrix R[k]. We assume uncorrelated
range and angle measurements, i.e.,
R[k] =

Rr[k]
0
0
RŒ∏[k]

,
(6)
in which we let
Rr[k] = œÉ2
nM [k]1M‚àí11T
M‚àí1 + diag(œÉ2
n1[k], . . . , œÉ2
nM‚àí1[k]),
RŒ∏[k] = œÉ2
Œ∏IM‚àíN,
where 1M‚àí1 = [1, . . . , 1]T of size m√ó1, and Im is the identity
matrix of size m √ó m.
The state equation is given by
s[k + 1] = Aas[k] + Bawa[k],
(7)
where
Aa =

A
0
0
IN

, Ba =

B
0
0
IN

, wa[k] =

w[k]
wb[k]

,
A =
Ô£Æ
Ô£ØÔ£∞
1
0
Œ¥t
0
0
1
0
Œ¥t
0
0
1
0
0
0
0
1
Ô£π
Ô£∫Ô£ª ,
B =
Ô£Æ
Ô£ØÔ£∞
0.5Œ¥t2
0
0
0.5Œ¥t2
Œ¥t
0
0
Œ¥t
Ô£π
Ô£∫Ô£ª ,
w[k] is normally distributed with zero mean and covariance
matrix diag(œÉ2
x, œÉ2
y), wb[k], which is uncorrelated with w[k],
has a uniform distribution with zero mean and covariance
matrix œÉ2
wbIN, and Œ¥t is the time step duration.
The aim is to Ô¨Ånd the position and velocity of the target
at the k-th time instant, i.e., x[k] and v[k], based on all
the past and current measurements y[j] for time instants
j ‚àà {1, . . . , k}. A common approach is to employ the EKF as
done in [10]. However, in this work, we improve the estimation
accuracy by taking advantage of extra information, in the
form of practical constraints on the NLOS bias bi[k], which is
derived in the sequel.
III.
PROPOSED TECHNIQUE
We Ô¨Årst determine more accurate constraints on the NLOS
biases through the geometry of the network and then propose
the improved EKF algorithm.
A. Constraint Region
We are interested in tight lower and upper bounds on
the NLOS bias bi[k] when TDOA-AOA measurements are
exploited. Note that in UWB systems, the range measurement
noise is small compared to the NLOS bias. Also the AOA
measurement error of a LOS link is relatively low. Thus, in
deriving these bounds we assume that the noise terms are
negligible, i.e., ‚àÜzi[k] = ‚àÜdi[k]+bi[k] for i ‚àà {1 . . ., N} and
tan(Œ∏M[k]) = (y[k]‚àíYM)/(x[k]‚àíXM). Herein, we consider
the case where only one LOS anchor is available, although the
bounds are still applicable when more LOS anchors exist.
For illustrative purposes, consider the physical setting of
the anchors and target shown in Fig. 1. The measured AOA
at the LOS reference anchor, Œ∏M[k], deÔ¨Ånes a line segment
passing through the target position and denoted as LM. Fur-
thermore, the true (unbiased) ranges, ‚àÜdi[k], deÔ¨Åne a set of
hyperbolas, denoted as Hu
iM and given by
‚à•x ‚àí pi‚à• ‚àí ‚à•x ‚àí pM‚à• = ‚àÜdi[k],
i = 1, . . . , N
(8)
Therefore, if we know ‚àÜdi[k], then the target position can be
found by intersecting one of the hyperbolas Hu
iM with the AOA
line segment LM. Due to the NLOS condition, we measure
‚àÜzi[k], which is biased compared to ‚àÜdi[k]. If |‚àÜzi[k]| ‚â§
‚à•pi ‚àí pM‚à•, then all the points x, for which the difference of
the distances from the i-th and the M-th anchor is equal to
‚àÜzi[k] are located on a different set of hyperbolas, denoted as
Hb
iM and given by
‚à•x ‚àí pi‚à• ‚àí ‚à•x ‚àí pM‚à• = ‚àÜzi[k],
i = 1, . . . , N
(9)
We note, however, that, if the bias is large, we might face
a situation where ‚àÜzi[k] > ‚à•pi ‚àí pM‚à•, and then there is no
point on the plane satisfying (9). In this case, it is convenient to
redeÔ¨Åne ‚àÜzi[k] by thresholding it to its maximum permissible
value, i.e., ‚àÜzi[k] ‚Üê min(‚àÜzi[k], ‚à•pi ‚àí pM‚à•). If ‚àÜzi[k]
is replaced by ‚à•pi ‚àí pM‚à•, then (9) becomes a ray passing
through pM. In the sequel, ‚àÜzi[k] refers to the range difference
measurement after being readjusted in this way.
Since the bias is always positive, a trivial lower bound on
bi[k] is 0. Also, since by deÔ¨Ånition bi[k] = ‚àÜzi[k] ‚àí ‚àÜdi[k],
an upper bound on bi[k] can be found by Ô¨Ånding a lower
bound on ‚àÜdi[k]. Invoking the triangle inequality, it follows
that ‚àÜdi[k] ‚â• ‚àí‚à•pi ‚àí pM‚à•. Thus, loose lower and upper
bounds on bi[k] might be set as
0 ‚â§ bi[k] ‚â§ ‚àÜzi[k] + ‚à•pi ‚àí pM‚à•.
(10)
However, we can achieve tighter lower and upper bounds on
bi[k] by taking advantage of the geometry.
Let the hyperbola Hb
iM intersects with the line segment
LM at qi[k], and deÔ¨Åne ri[k] = ‚à•qi[k] ‚àí pM‚à•. By expressing
the equation of hyperbola (9) in polar coordinates, it follows
that
ri[k] =
‚à•pi ‚àí pM‚à•2 ‚àí ‚àÜz2
i [k]
2

Target
Õ¥Õ∂
¬ó  
Õ¥Õ∂
¬Ñ  
ÕµÕ∂
¬Ñ  
‡¥•Õ¥Õ∂
¬Ñ  
‡∑©Õ¥Õ∂
¬Ñ  
‹ôÕµ
‹ôÕ¥
‹ï
…ÖÕ∂
…îÕ¥
Õ∂‹òÕ≥‹òÕ¥
‹òÕµ‹òÕ∂
Fig. 1.
Geometry of the nodes in 2-D. The anchor with index M = 4 is the
reference LOS anchor and the other anchors are in NLOS. The time index k
is omitted for convenience.
ri[k] in (11) is a monotonically decreasing function of ‚àÜzi[k]
with upper bound
ri[k] ‚â§ dM[k],
i = 1, . . . , N
(12)
Let us deÔ¨Åne rj[k] = max{ri[k], i = 1, . . . , N}; then
rj[k] ‚â§ dM[k], i.e., the distance of the target from the
reference anchor has to be at least rj[k]. Note that in case
‚àÜzi[k] is replaced by ‚à•pi ‚àí pM‚à•, ri[k] = 0 and (12) is
satisÔ¨Åed. For the vector qj[k], deÔ¨Åne in turn
‚àÜ¬Øzi[k] = ‚à•qj[k] ‚àí pi‚à• ‚àí ‚à•qj[k] ‚àí pM‚à•,
(13)
which means that qj[k] is located on another set of hyperbolas,
denoted as ¬ØHb
iM, representing the points for which the distance
difference from the i-th and M-th anchors is ‚àÜ¬Øzi[k]. For
example, in Fig. 1, ¬ØHb
24 passes through q3 where j = 3.
Similar to (11), by intersecting ¬ØHb
iM and the line segment LM,
we have that
rj[k] =
‚à•pi ‚àí pM‚à•2 ‚àí ‚àÜ¬Øz2
i [k]
2

where the covariance matrix of the noise vector is
C[k] =

R[k]
0
0
Œ£[k|k ‚àí 1]

.
Now we Ô¨Ånd s[k|k], the Ô¨Åltered estimate of s[k] by solving
the bounded least square problem
min
s[k]
n(C[k])‚àí 1
2
 
Àúy[k]
s[k|k ‚àí 1]

‚àí

H[k]
IN+4

s[k]

2o
s.t.
li[k] ‚â§ bi[k] ‚â§ ui[k],
i = 1, . . . , N
(23)
Note that in ordinary EKF, (23) is minimized without con-
straints. In contrast to the unconstrained EKF, (23) is a
linear least squares problem with additional bound constraints
on the entries of the state vector, and can be solved with
moderate computational cost. In our work, we use the Matlab
routine lsqlin. We can use the nonlinear function h(s[k])
in (23) instead of the Ô¨Årst order Taylor series approximation,
however, the computational complexity would be much higher.
Moreover, we did not observe signiÔ¨Åcant improvement in the
localization accuracy in our simulation experiments.
To update the covariance, we use as an approximation the
recursive formula of the ordinary EKF algorithm, that is
Œ£[k|k] = (I ‚àí G[k]H[k])Œ£[k|k ‚àí 1],
(24)
where G[k] is the gain of the EKF
G[k] = Œ£[k|k ‚àí 1]HT [k](R[k] + H[k]Œ£[k|k ‚àí 1]HT [k])‚àí1.
At this stage, both the state and covariance matrix are
corrected and the algorithm continues recursively.
C. Initialization and Algorithm Summary
An initial guess of the position and biases can be made
using the single snapshot constrained optimization technique
in [6], while the initial values of the velocity components are
set to zero, thus s[0|0] is obtained. Since relatively decent
estimates of the location and biases are achievable using [6],
a relatively moderate diagonal error covariance matrix Œ£[0|0]
is considered. The algorithm is summarized below.
Algorithm 1 Proposed EKF with Bound Constraints
1: Initialization:
2: Initialize position and biases using [6] and set v[0|0] = 0
3: Set Œ£[0|0] = Œ±I where Œ± > 0
4: for k = 1, 2, . . ., K do
5:
Prediction using (20)
6:
Estimate di[k], compute œÉ2
ni in (3) and update R[k]
7:
Find s[k|k] via the constrained minimization in (23)
8:
Update the covariance matrix Œ£[k|k] using (24)
9: end for
IV.
SIMULATION RESULTS
We consider M = 4 anchors with Ô¨Åxed positions p1 =
[0, 10]T, p2 = [10, 10]T, p3 = [10, 0]T, and p4 = [0, 0]T,
where the units are in meters. The initial position of the
target is selected randomly within the square region covered by
the anchors. The direction of its velocity vector is initialized
randomly while its norm (i.e., speed) is set to 0.4m/s. The
location of the target changes over time according to the
dynamic model in (7) where the accelerations are normally
distributed with œÉx = œÉy = 10‚àí3m/s2. The trajectory is
evaluated for K = 200 time samples with a step size Œ¥t = 0.1s.
The reference anchor, located at p4, is in LOS, while the other
anchors are in NLOS. The exact range values are corrupted
by an exponentially distributed NLOS bias with a mean value
equal to 0.2 of the true target-anchor range [6]. The additive
noise ni[k] is modelled according to (3) with œÉ0 = 10‚àí4,
Œ≤ = 2 for the LOS anchor, and Œ≤ = 3 for the other NLOS
anchors. The true angle of the LOS anchor is also disturbed by
a normally distributed error with zero-mean and œÉŒ∏ = 1deg.
We simulate the proposed constrained EKF described in
Algorithm I with bounding constraints on the NLOS biases
as derived in Section III-A. We considered both sets of
constraints, i.e., the loose bound (10) and the new tighter
bounds in (15)-(19), and denote the corresponding algorithms
as Constrained EKF I and Constrained EKF II, respectively.
In our implementation of these algorithms, we use the true
values of œÉx, œÉy, œÉ0 and set œÉw = 3m, although the Ô¨Ånal
performance is robust to some amount of mismatch in these
parameters. We compare our result with the single snapshot
constrained optimization technique in [6] and the EKF in
[10]. The PF is not considered herein since the nonlinearity
is not severe and the distribution of the noise is Gaussian. In
fact, due to lacking a bound on the biases, the PF approach
might perform only slightly better than EKF [10]. The method
in [6], is implemented in Matlab by means of fmincon
function with the choice of SQP technique. Again, we consider
both sets of constraints (10) and (15)-(19), and denote the
corresponding algorithms as Memoryless I and Memoryless
II, respectively. The initialization of Constrained EKF I and
Constrained EKF II are done using the Memoryless I and
Memoryless II, respectively, while EKF is initialized with
Memoryless II. For the initialization of the state covariance
matrix, we use Œ£[0|0] = 10I7, which appears to be reasonable
for the considered area and the possible error in position
components and biases.
To evaluate the comparative performance of the various
tracking algorithms under study, we run Monte Carlo (MC)
simulations in Matlab for 500 different starting points and
trajectories, generated randomly as speciÔ¨Åed above. The per-
formance is evaluated in terms of the root mean squared error
(RMSE) between the true and estimated vectors. The RMSE
in the velocity estimate is also investigated.
The RMSE in positioning is plotted in Fig. 2 for the
different techniques under study. We generally Ô¨Ånd that the
performance of the EKF in [10] is strongly dependent on the
initialization and its convergence is not always guaranteed
due to the absence of bounds on the NOLS biases. The
constrained optimization technique in [6] can not yield smooth
position estimates due to its memoryless nature, although on
the average its performance is satisfactory. We emphasize that
the performance of this algorithm is notably improved when
the tighter bound given in (15) and (19) is used instead of
the simpler one in (10). Initially, Constrained EKF I has a
higher RMSE compared to the unconstrained EKF, since it
is initialized with a less accurate position. However, within a
number of iterations, its performance surpasses that of EKF
and Memoryless I. Overall, constrained EKF II exhibits the
29
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

0
50
100
150
200
1
1.5
2
2.5
3
3.5
4
4.5
5
5.5
Time Steps
Positioning RMSE [m]
 
 
EKF
Memoryless I
Memoryless II
Constrained EKF I
Constrained EKF II
Fig. 2.
RMSE of target position vs. time steps.
best performance by a signiÔ¨Åcant margin, which proves the
usefulness of our approach.
The RMSE in estimating the velocity components vx[k]
and vy[k] in Cartesian coordinates is illustrated in Fig. 3.
Again, the performance of the newly proposed EKF technique,
with bounding constraints on the NLOS biases, exceeds that
of EKF by a signiÔ¨Åcant margin.
0
50
100
150
200
0
0.2
0.4
0.6
0.8
Time Steps
vx RMSE [m/s]
 
 
EKF
Constrained EKF I
Constrained EKF II
(a) RMSE in estimating vx
0
50
100
150
200
0
0.2
0.4
0.6
0.8
Time Steps
vy RMSE [m/s]
 
 
EKF
Constrained EKF I
Constrained EKF II
(b) RMSE in estimating vy
Fig. 3.
RMSE of velocity components in logarithm scale vs. time steps.
V.
CONCLUSION
A modiÔ¨Åed EKF algorithm for localization of a moving
target was proposed in this paper, where novel bound con-
straints on the NLOS bias based on geometrical considerations
were incorporated in the Ô¨Åltering (optimization) step of the
EKF equations. The main assumption is that at least one LOS
anchor remains available for referencing purposes. Through
simulations, it was observed that our technique signiÔ¨Åcantly
outperformed EKF and memoryless constrained optimization
techniques. Our technique shows good robustness against
NLOS biases, even when most of the nodes are initially (and
remain) under severe NLOS conditions.
ACKNOWLEDGMENT
The authors would like to thank Dr. Kegen Yu of the
University of New South Wales in Australia for his helpful
comments. This work was supported by a grant from the
Natural Science and Engineering Research Council (NSERC)
of Canada and by the Fonds qu¬¥eb¬¥ecois de la recherche sur la
nature et les technologies (FQRNT).
REFERENCES
[1]
K. Yu, I. Sharp, and Y. J. Gao, Ground-Based Wireless Positioning.
John Wiley and Sons Ltd., 2009.
[2]
S. Gezici, Z. Tian, G. B. Giannakis, H. Kobayashi, A. F. Molisch, H. V.
Poor, and Z. Sahinoglu, ‚ÄúLocalization via ultra-wideband radios: a look
at positioning aspects for future sensor networks,‚Äù IEEE Signal Process.
Mag., vol. 22, pp. 70‚Äì84, Jul. 2005.
[3]
D. Dardari, R. D‚ÄôErrico, C. Roblin, A. Sibille, and M. Z. Win,
‚ÄúUltrawide bandwidth RFID: The next generation?‚Äù Proc. of the IEEE,
vol. 98, no. 9, pp. 1570 ‚Äì1582, Sep. 2010.
[4]
M. Navarro and M. Najar, ‚ÄúFrequency domain joint TOA and DOA
estimation in IR-UWB,‚Äù IEEE Trans. on Wireless Commun., vol. 10,
no. 10, pp. 1‚Äì11, Oct. 2011.
[5]
I. Guvenc and C. C. Chong, ‚ÄúA survey on TOA based wireless
localization and NLOS mitigation techniques,‚Äù IEEE Communications
Surveys Tutorial, vol. 11, no. 3, pp. 107‚Äì124, quarter 2009.
[6]
K. Yu and Y. J. Guo, ‚ÄúImproved positioning algorithms for nonline-
of-sight environments,‚Äù IEEE Trans. on Veh. Tech., vol. 57, no. 4, pp.
2342‚Äì2353, Jul. 2008.
[7]
S. Venkatraman, J. Caffery, and H. R. You, ‚ÄúA novel TOA location
algorithm using LOS range estimation for NLOS environments,‚Äù IEEE
Trans. on Veh. Tech., vol. 53, no. 5, pp. 1515‚Äì1524, Sep. 2004.
[8]
N. J. Thomas, D. G. M. Cruickshank, and D. I. Laurenson, ‚ÄúPerfor-
mance of a TDOA-AOA hybrid mobile location system,‚Äù in Second Int.
Conf. on 3G Mobile Communication Technologies, 2001, pp. 216‚Äì220.
[9]
C.-D. Wann, Y.-J. Yeh, and C.-S. Hsueh, ‚ÄúHybrid TDOA/AOA indoor
positioning and tracking using extended Kalman Ô¨Ålters,‚Äù in IEEE
Vehicular Technology Conf. Spring, vol. 3, May 2006, pp. 1058‚Äì1062.
[10]
M. Najar, J. M. Huerta, J. Vidal, and J. A. Castro, ‚ÄúMobile location
with bias tracking in non-line-of-sight,‚Äù in IEEE Int. Conf. on Acoustics,
Speech, and Signal Processing, vol. 3, May 2004, pp. 956‚Äì959.
[11]
D. B. Jourdan, J. J. Deyst Jr., M. Z. Win, and N. Roy, ‚ÄúMonte carlo
localization in dense multipath environments using UWB ranging,‚Äù in
IEEE Int. Conf. on Ultra-Wideband, Sep. 2005, pp. 314‚Äì319.
[12]
J. Gonz¬¥alez, J. L. Blanco, C. Galindo, A. O. d. Galisteo, J. A.
Fern¬¥andez-Madrigal, F. A. Moreno, and J. L. Mart¬¥ƒ±nez, ‚ÄúMobile robot
localization based on ultra-wide-band ranging: A particle Ô¨Ålter ap-
proach,‚Äù Robot. Auton. Syst., vol. 57, no. 5, pp. 496‚Äì507, May 2009.
[13]
L. Cong and W. Zhuang, ‚ÄúNonline-of-sight error mitigation in mobile
location,‚Äù in Twenty-third Annual Joint Conf. of the IEEE Computer
and Communications Societies, vol. 1, Mar. 2004, pp. 650‚Äì659.
[14]
S. Maran`o, W. M. Gifford, H. Wymeersch, and M. Z. Win, ‚ÄúNLOS iden-
tiÔ¨Åcation and mitigation for localization based on UWB experimental
data,‚Äù IEEE J. Sel. A. Commun., vol. 28, no. 7, pp. 1026‚Äì1035, Sep.
2010.
[15]
S. Venkatesh and R. M. Buehrer, ‚ÄúNon-line-of-sight identiÔ¨Åcation
in ultra-wideband systems based on received signal statistics,‚Äù Mi-
crowaves, Antennas Propagation, IET, vol. 1, no. 6, pp. 1120‚Äì1130,
Dec. 2007.
30
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

