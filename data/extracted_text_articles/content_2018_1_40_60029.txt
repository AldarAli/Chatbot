An Efficient HDR Video Compression Scheme based on a Modified Lab Color 
Space 
 
Maryam Azimi, Panos Nasiopoulos 
Electrical and Computer Engineering Department 
University of British Columbia 
Vancouver, Canada 
e-mail:{maryama,panos}@ece.ubc.ca 
Mahsa T. Pourazad 
TELUS Communications Inc., 
Vancouver, Canada 
e-mail: mahsa.pourazad@gmail.com
 
 
Abstract— With recent developments in both High Dynamic 
Range (HDR) capturing and display technologies, consumer 
distribution of HDR videos is now possible. The current 
distribution pipeline, however, is based on Standard Dynamic 
Range (SDR) signal characteristics. To accommodate HDR in 
the current pipeline infrastructure, some adjustments are 
necessary. One element of the pipeline that needs to be 
addressed is compression scheme. Current compression 
standards, such as HEVC, rely on YCbCr as their color 
encoding. However, this color encoding cannot represent the 
HDR signal without introducing visual artifacts. Two 
approaches exist for compensating for these visual errors: re-
adjustment of the HDR signal in YCbCr as a pre-processing 
step to compression, or employing a color encoding that better 
meets the HDR signal requirements. In this paper, we propose 
to use the perceptually uniform CIELAB color space for HDR 
video color encoding following the latter approach. To make 
CIELAB suitable for HDR video color encoding, we change the 
transfer function and the scaling of the a* and b* channels. 
The performance of this approach is compared to YCbCr color 
encoding in our study via compressing these signals based on 
High Efficiency Video Coding (HEVC) standard and 
comparing the bitrate of these signals at the same quality level. 
An average bit-rate saving of 12.9% in terms of Overall Signal 
to Noise Ratio (OSNR), and 41.3% in terms of DE100 are 
reported for our proposed color encoding scheme compared to 
the conventional YCbCr. A negligible average loss of 0.6% is 
reported in terms of perceptually transformed Peak Signal to 
Noise Ratio (tPSNR). 
Keywords- High Dynamic Range (HDR); color encoding; 
perceptual quantizer; color difference, CIELAB. 
I. 
 INTRODUCTION 
Recent advances in capturing and displaying technologies 
have made consumer distribution of HDR content possible. 
However, the current video distribution pipeline elements, 
including compression standards, are designed based on 
Standard Dynamic Range (SDR) videos characteristics. 
Given the distinct characteristics of HDR [1], special 
considerations in terms of both processing and compression 
need to be taken into account for efficient and true-to-
original quality HDR distribution. 
High Efficiency Video Coding (HEVC) is the latest 
compression standard used in video distribution pipelines 
[2]. HEVC and its predecessors rely on YCbCr as their color 
encoding, where Y represents luminance as a weighted 
combination of relative light Red (R), Green (G), and Blue 
(B). This relative light information is obtained by applying a 
perceptual transfer function known as gamma encoding 
(standardized as BT.1886 [3]). Cb and Cr are the blue and 
red differences from the luminance channel, respectively. 
For the limited brightness range (0.01 to 100 cd/m2) and 
color gamut (BT.709 [4]) of SDR, 8-bit YCbCr represents 
SDR signal without visible artifacts or color differences. 
On the other hand, HDR content is characterized by a 
higher range of brightness (usually 0.005 to 10000 cd/m2) 
and mainly wider color gamut of BT.2020 [5]. For signals 
with this wide range of brightness and color, gamma 
encoding and 8-bit quantization cannot perceptually 
representative. Thus, a new perceptual transfer function, 
known as Perceptual Quantizer (PQ) was designed 
specifically for HDR and later was standardized as SMPTE 
ST 2084, [6]. Although by changing the transfer function 
and increasing the bit-depth the quality of the HDR signal is 
improved by precluding most of the quantization artifacts, 
still a 10-bit PQ YCbCr HDR signal has color differences 
with the original HDR signal [7]. These color errors are 
even present before compressing the signal and are 
intensified even more after applying the chroma 4:2:0 
subsampling process as showed in [8]. The causes of these 
errors are the perceptual non-uniformity of the YCbCr signal 
and the existing correlation between luma (Y) and chroma 
(Cb and Cr) channels in YCbCr [9]. 
Two general approaches try to address the issues related 
to 10-bit PQ YCbCr 4:2:0 HDR color encoding: re-adjusting 
the YCbCr signal, or using a different color encoding which 
does not carry the known problems of YCbCr. The former 
approach requires additional pre-processing steps before 
video coding. On the other hand, the latter approach may 
need some adjustments during video coding to optimize the 
process for the new color encoding.  
In this work, we study the performance of a modified 
CIELAB color space for HDR compression [10]. To make 
CIELAB suitable for HDR compression, we propose some 
changes to its original form. The modified CIELAB signals 
18
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-611-8
CONTENT 2018 : The Tenth International Conference on Creative Content Technologies

are then quantized to 10 bits followed by chroma down-
sampling and then compressed using the HEVC codec. The 
performance of the proposed CIELAB color space for 
compressing HDR videos is compared with existing color 
encodings including YCbCr, in terms of the common HDR 
objective metrics. 
The rest of this paper is organized as follows. Section II 
provides overview of existing color encodings. Section III 
provides details on the suggested modifications of CIELAB. 
Section IV presents and discusses the results and conclusions 
are drawn in Section V. 
II. 
OVERVIEW OF EXISTING COLOR ENCODING SCHEMES 
FOR HDR VIDEO COMPRESSON 
The existing HDR video coding system is based on 10-bit 
Y’CbCr. This signal is derived from the relative light 
R’G’B’ signal. The prime on the representations of the 
signals denotes relative light, i.e., perceptually quantized 
instead of the linear light. It has been shown in [8] that two 
original linear RGB colors with similar luminance values 
transformed to 10-bit 4:2:0 Y’CbCr using the conventional 
way followed by chroma subsampling, may result in two 
very different luminance (Y) values. That is why deriving 
Y’ from relative light R’G’B’ is referred to as Non-Constant 
Luminance (NCL) approach. Since even small changes in 
luminance values are quite apparent to human eyes, visible 
artifacts appear on 10-bit 4:2:0 NCL Y’CbCr HDR signal. 
To overcome the non-constant luminance issue, Constant 
Luminance (CL) derivation of Y’CbCr that is based on linear 
light RGB content can be utilized. However, to put it in 
practice, the entire infrastructure of the current video 
transmission system needs to be updated to support CL 
approach. To avoid such a costly update, a recursive re-
adjustment algorithm of the Y’ channel (luma) in the 10-bit 
NCL Y’CbCr to the Y’ channel in the 10-bit CL Y’CbCr 
was proposed in [11]. It is reported in [11] that the visible 
artifacts of the 10-bit NCL Y’CbCr disappear in the re-
adjusted version of the signal. These pre-processing luma 
adjustments are part of Supplement 15 to ITU-T H-series 
Recommendations [12] document which offers a description 
of processing steps and guidelines for converting from 4:4:4 
RGB linear light representation video signals into adjusted 
10-bit PQ Y’CbCr 4:2:0 signal for HDR video transmission. 
A faster version of this algorithm is proposed in [13] and an 
approximation of this algorithm was proposed in [14] 
without the required pre-processing.  
To avoid the necessary pre-processing steps associated 
with using Y’CbCr, another approach for transmitting HDR 
is to replace Y’CbCr color encoding with a color encoding 
approach with more de-correlated color and brightness 
channels. One of such encoding is ICtCp [15]. The 
brightness (I) and color (Ct and Cp) channels information are 
highly de-correlated. Hence, ICtCp does not bear the chroma 
errors reported with Y’CbCr. ICtCp is designed based on 
SMPTE ST 2084 as the transfer function. 
Another color encoding for HDR video compression is 
Y’D’zD’x [16] that is based on XYZ colors space and 
SMPTE ST 2084 as the transfer function. This color space 
was investigated by Moving Picture Experts Group (MPEG) 
in the early exploration stages of HDR video compression 
and its requirements. Due to some artifacts seen on some of 
the HDR videos compressed with Y’D’zD’x, which in fact 
were clipping errors, this color encoding was no longer 
explored by MPEG. 
Another proposed color encoding for HDR video 
compression is Yu”v” [17] that is based on Yu’v’ [18].  A 
transfer function is proposed for this color space in [17]. For 
dark areas (with luminance value smaller than 5 cd/m2), u” 
and v” represent the attenuated u’ and v’ by Y. Although this 
introduces dependency on Y for u” and v” channels, it is 
shown to reduce the noise in dark areas and hence results in 
better compression efficiency compared to Yu’v’[17]. 
Figure 1 (a), (b), (c), and (d) show how NCL Y’CbCr, CL 
Y’CbCr, ICtCp, and Y’D’zD’x, respectively represent the 
whole color gamut of BT.2020 at luminance level of 
100cd/m2 in terms of CIE DE2000 error [19]. Please note to 
provide fair comparisons of the color encoding schemes 
rather than transfer functions, we did not include Yu”v” 
results as it uses a different transfer function from the 
SMPTE ST 2084. CIE DE2000 is a color difference metric. 
Errors smaller than one, i.e., invisible errors are represented 
with dark blue in Figure 1. The visible color differences 
(with error value larger than 1) are represented with light 
 
            (a)   
                                  (b) 
 
                   (c) 
        
                     (d) 
Figure 1. Color encoding error in terms of CIE DE2000 for (a) NCL Y’CbCr, (b) CL Y’CbCr, (c) ICtCp, and (d) Y’D’zD’x shown using an 
error bar (right) at luminance level of 100 cd/m2 
19
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-611-8
CONTENT 2018 : The Tenth International Conference on Creative Content Technologies

blue to red. Note that these errors are only the quantization 
errors and chroma sub-sampling is not yet applied. Figure 1 
shows that except for ICtCp (c), even before compression the 
colors of an HDR signal are visibly distorted.  
In this paper, yet another perceptually uniform color 
encoding, CIELAB, and its performance for HDR video 
compression is investigated. As CIELAB is designed for 
SDR brightness values up to of 100 cd/m2, some adjustments 
are made to its original form to accommodate HDR signal, 
which are presented in details in what follows. 
III. 
PROPOSED MODIFICATIONS TO CIELAB FOR HDR 
COMPRESSION  
CIELAB consists of one brightness channel (L*) which 
goes up to 100 cd/m2 and two color channels a* and b* 
which cover colors from green to red, and from blue to 
yellow, respectively.  Each of these channels is constructed 
as follows: 
 
 
 
  
:  ,                     (1) 
 
                
,                     (2) 
     
                 
,                     (3) 
 
 
              
,   (4) 
 
 
where Xn, Yn, and Zn are the XYZ components of the white 
point. Since HDR luminance values can go up to 10000 
cd/m2, the current CIELAB cannot efficiently handle an 
HDR signal. To address this issue, an hdr-CIELAB is 
proposed in [20]. The only change in hdr-CIELAB is the 
transfer function to have better performance for shadows and 
highlights compared to conventional CIELAB; otherwise all 
the other derivations are the same as in CIELAB. Still, the 
encoded  L* in hdr-CIELAB goes only up to 245 cd/m2. 
In this work, we propose to use SMPTE ST 2084 as the 
transfer function for HDR luminance values in CIELAB. 
Therefore, the proposed L*, a* and b* channels will be 
calculated as follows: 
 
                                     
,                                 (5) 
 
 
 
  
       
 
                                           
=       (6) 
      
                          
                         
 
 
 
 
                             (7)               
 
 
 
where X’, Y’, and Z’ are the perceptually quantized X, Y 
and Z signals using SMPTE ST 2084. In (6) and (7), a* and 
b* channels are scaled to fall within [-0.5 0.5] so that 
BT.1361 quantization [21] can be applied to them.  
The proposed CIELAB for HDR signals is somewhat 
similar to Y’D’zD’x [16]. However, in the proposed 
modified CIELAB, color difference channels are scaled 
differently for positive and negative differences so that 
codewords are utilized more efficiently. 
IV. 
EXPERIMENTAL SETUP 
To evaluate the proposed modified CIELAB color 
encoding for HDR video compression, we use four HDR 
video sequences from MPEG HDR video dataset: 
FireEater2, Market3, BalloonFestival, and SunRise. All of 
these videos are 1920x1080p, and are in the BT.2020 
container although their actual colors fall inside the BT.709 
gamut. Figure 2 shows tone mapped snapshots of the first 
frame of each video sequence. 
Figure 3 shows how the original linear light HDR content 
is encoded to the modified CIELAB, followed by 
quantization and chroma down-sampling. It is worth noting 
that our modified CIELAB-based method uses the original 
sampling filters designed specifically for Y’CbCr and as 
such they are not optimized for our proposed scheme. For 
compression, we used the HEVC encoder reference 
software HM 16.15, Main10 profile. We coded the tested 
videos at four bit-rate levels using four QPs, as suggested in 
[22]. To compare them with the original ones in terms of 
quality, the color encoded and compressed signals are then 
de-compressed and converted back to the linear light 
domain as shown in Figure 3. 
 
(a) 
                                                      (b)                                                         (c)                                                     
(d) 
Figure 2. Snapshots of the first frames of HDR test video sequences (tone-mapped version): (a) FireEater2, (b) Market3, (c) BalloonFestival, and (d) 
SunRise 
20
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-611-8
CONTENT 2018 : The Tenth International Conference on Creative Content Technologies

V. 
RESULTS AND DISCUSSIONS 
 Figure 4 (a), (b), (c) and (d) shows the bit-rate versus 
DE100, Overall Signal to Noise Ratio (OSNR) and 
perceptually Transformed Peak Signal to Noise Ratio 
(tPSNR) in terms of (db) for the proposed modified 
CIELAB, the NCL YCbCr, luma-adjusted NCL Y’CbCr, 
ICtCp and Y’D’zD’x for FireEater2, Market3, SunRise and 
BalloonFestival, respectively. tPSNR is the average of the 
PSNR X’, Y’ and Z’. OSNR is the overall SNR of X’, Y’ 
and Z’ with calculation of the error for each pixel and then 
averaging the errors.  DE100 is the PSNR based value of the 
average error in terms of CIE DE2000 metric [22]. Table I 
also shows the bit-rate savings in terms of the same metrics 
for the proposed color encoding over NCL Y’CbCr. 
As can be seen from Figure 4, the proposed modified 
CIELAB clearly outperforms the NCL Y’CbCr, luma-
adjusted NCL Y’CbCr, and Y’D’zD’x in terms of DE100. 
This shows that the proposed method can maintain the 
original colors better at any given bit-rate. The proposed 
method performs almost identical to ICtCp in terms of 
DE100.  
Moreover, it can be seen form Figure 4 that the proposed 
method also outperforms NCL Y’CbCr, luma-adjusted NCL 
Y’CbCr, and Y’D’zD’x in terms of OSNR, especially at 
higher bit-rates. All the tested color encoding schemes seem 
to be performing similarly in terms of tPSNR. 
Please note that the chroma down-sampling filter used for 
the proposed CIELAB is the same as the one in Y’CbCr. 
However, a better performance may be achieved in terms of 
tPSNR and OSNR if a new sampling filter is designed that 
better matches the a* and b* characteristics. Although this is 
not in the scope of this paper, it is part of our future work.  
Moreover, the rate-distortion optimization (RDO) setting 
inside the encoder was maintained the same in all these 
experiments. Since the current RDO is customized for 
Y’CbCr 
characteristics, 
it 
is 
expected 
that 
further 
improvements may be obtained by modifying the RDO 
process according to the proposed modified CIELAB color 
encoding. This step as well is in the scope of future work. 
Another note-worthy observation from Figure 4 is how 
Y’D’zD’x underperforms all the tested color encodings, 
although its derivation is very similar to what is proposed in 
this paper. However, as the proposed scaling of a* and b* 
employs the available codewords more efficiently, it 
achieves better compression performance compared to 
Y’D’zD’x as observed in Figure 4. 
Overall, it is shown that the proposed color encoding 
results in better performance in terms of DE100 compared 
to conventional NCL Y’CbCr, by an average of 41% over 
the four videos, hence better maintaining the original HDR 
colors. By using a chroma down-sampling filter that is 
designed for the proposed space and changing the encoder 
rate-distortion optimization process, it is expected to 
improve the performance of the tested color in terms of 
tPSNR and OSNR. 
VI. 
CONCLUSIONS 
In this paper, we presented a modified CIELAB color 
encoding scheme for efficiently compressing HDR content.  
Performance evaluations show that the proposed adjusted 
CIELAB space, even using the chroma down-sampling 
designed for Y’CbCr, maintains the original HDR colors 
better than other existing color spaces and results in an 
average of 41% bit-rate savings over four videos in terms of 
DE100 (db). The performance of the proposed modified 
color space even without changing the chroma sub-sampling 
filters of Y’CbCr is almost similar to that of ICtCp.  
The slight underperformance of the proposed approach in 
terms of tPSNR can be improved by changing the chroma 
down-sampling filter to a more tailored one to the a* and b* 
 
 
Figure 3. Pre/post processing steps of the proposed modified CIELAB for HDR video compression   
TABLE I.  BIT-RATE SAVINGS OF THE PROPOSED CIELAB COMPARED 
TO NCL Y’CBCR 
 
    Metric 
 
Video 
tPSNR 
X  
(%) 
tPSNR 
Y 
(%) 
tPSNR 
Z 
(%) 
tPSNR
XYZ 
(%) 
tOSNR 
XYZ 
(%) 
DE 
100 
(%) 
FireEater
2 
-7.4 
8.0 
-3.0 
-1.0 
-24.0 
-32.6 
Market3 
13.1 
17.4 
2.7 
10.5 
6.2 
-63.6 
SunRise 
0.2 
9.9 
-23.0 
-6.3 
-19.5 
0.0 
BalloonF
estival 
5.4 
21.5 
-17.7 
-0.7 
-14.3 
-69.2 
Average 
2.9 
14.2 
-10.2 
0.6 
-12.9 
-41.3 
 
21
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-611-8
CONTENT 2018 : The Tenth International Conference on Creative Content Technologies

characteristics. Furthermore, changing the RDO process to 
be performed in the proposed space instead of Y’CbCr may 
also result in further performance improvement in terms of 
tPSNR. 
REFERENCES 
[1] R. Boitard, M. T. Pourazad, P. Nasiopoulos, and J. Slevinsky, 
“Demystifying High-Dynamic-Range Technology: A new 
evolution in digital media,” Consumer Electron. Mag., vol. 4, 
pp. 72 – 86, 2015.  
[2] M. T. Pourazad, C. Doutre, M. Azimi, and P. Nasiopoulos, 
“HEVC: The New Gold Standard for Video Compression: 
How Does HEVC Compare with H.264/AVC?” Consumer 
Electron. Mag., vol. 1, pp. 36 –  46, 2012. 
[3] Reference electro-optical transfer function for flat panel 
displays used in HDTV studio production, ITU-R BT.1886, 
2011. 
[4] Parameter values for the HDTV standards for production and 
international program exchange, ITU-R BT.709-3, 1998. 
[5] Parameter values for ultrahigh definition television systems for 
production and international programme exchange, ITU-R 
BT.2020, 2012. 
 
(a) 
 
(b) 
 
(c)  
 
(d) 
 
Figure 4. R-D curves of the proposed color encoding compared to NCL YCbCr, luma-adjuste YCbCr, Y’D’zD’x and ICtCp in terms of DE100 (db), OSNR 
(db) and tPSNR (db) for (a) FireEater2, (b) Market3, (c) SunRise, and (d) BalloonFestival  
 
22
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-611-8
CONTENT 2018 : The Tenth International Conference on Creative Content Technologies

[6] High Dynamic Range Electro-Optical Transfer Function of 
Mastering Reference Displays, SMPTE Standard ST 2084, 
2014.  
[7] M. Azimi, R. Boitard, M. T. Pourazad, and P Nasiopoulos, “ 
Visual color difference evaluation of standard color pixel 
representations for high dynamic range video compression,” 
25th European Signal Processing Conference (EUSIPCO), pp. 
1480 – 1484, Aug. 2017. 
[8] E. Francois, “MPEG HDR AhG: about using a BT.2020 
container for BT.709 content,” 110th MPEG meeting, 
Strasbourg, France, October 2014.  
[9] R. Boitard, R. K. Mantiuk, and T. Pouli. “Evaluation of color 
encodings for high dynamic range pixels,” in Proc. SPIE 
9394, Human Vision and Electron. Imaging XX, pp. 93941K1 
– 9, Mar. 2015. 
[10] A. R. Robertson, “The cie 1976 color-difference formulae,” 
Color Research & Application, vol. 2, no. 1, pp. 7 – 11, 1977. 
[11] J. Ström, J. Samuelsson, and K. Dovstam, “Luma Adjustment 
for High Dynamic Range Video,” Proceedings of Data 
Compression Conference (DCC), pp. 319 – 328, Mar. 2016. 
[12] Conversion and coding practices for HDR/WCG Y'CbCr 4:2:0 
video with PQ transfer characteristics, ITU-T H.Sup15, 2017. 
[13] A. 
Norkin, 
“Fast 
Algorithm 
for 
HDR 
Color 
Conversion,” Proceedings of the IEEE Data Compression 
Conference (DCC),  pp. 486 – 495, Mar. 2016. 
[14] F. Xie, R. Boitard, M. T. Pourazad, and P. Nasiopoulos, 
“Optimizing Non Constant Luminance into Constant 
Luminance for High Dynamic Range Video Distribution,” 
IEEE International Conference on Acoustics, Speech and 
Signal Processing (ICASSP), pp. 1487 – 1491, 2017. 
[15] T. Lu et al., “ITP Colour Space and Its Compression 
Performance for High Dynamic Range and Wide Colour 
Gamut Video Distribution,” ZTE Communications, vol.14, 
no.1, pp. 32 – 38, Feb. 2016.  
[16] Y’D’ZD’X Color-difference Computations for High Dynamic 
Range X’Y’Z’ Signals, SMPTE Standard ST 2085, 2015.  
[17] C. Poynton, J. Stessen, and R. Nijland, “Deploying Wide 
Color Gamut and High Dynamic Range In HD and UHD,” 
SMPTE Motion Imaging J. vol. 124, no. 3, pp. 37 – 49, 2015. 
[18]  G.W. Larson, “LogLuv encoding for full-gamut, high-
dynamic range images,” J. Graph. Tools, vo. 3, no.1, pp. 15 – 
31, 1998. 
[19] G. Sharma, W. Wu, and E. N. Dalal, “The ciede2000 color-
difference formula: Implementation notes,supplementary test 
data, and mathematical observations,” Color Research & 
Application, vol. 30, no. 1, pp. 21 – 30, 2005. 
[20] M. D. Fairchild, Color Appearance Models, 3rd Edition. 
Wiley, 2013. 
[21] Worldwide unified  colorimetry and related characteristics of 
future television and imaging systems, ITU-R BT.1361, 1998. 
[22] A. Luthra, E. Francois, and W. Husak, “Call for Evidence 
(CfE) for HDR and WCG video coding,” ISO/IEC 
JTC1/SC29/WG11 
N15083, 
Feb. 
2015. 
 
23
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-611-8
CONTENT 2018 : The Tenth International Conference on Creative Content Technologies

