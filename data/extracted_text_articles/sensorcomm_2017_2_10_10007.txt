An Electromyography Signal Conditioning Circuit Simulation Experience
Jorge R. B. Garay1,2, Arshpreet Singh2, Moacyr Martucci2, Hugo D. H. Herrera2,3, Gustavo M.
Calixto2, Stelvio I. Barbosa2, Sergio T. Kofuji2,
1 University of Mogi das Cruzes - UMC, São Paulo - Brazil
2University of São Paulo - EPUSP, São Paulo - Brazil
3 Federal University of Mato Grosso - UFMT - Brazil
jorgegaray@umc.br, {Arshpreet.singh, mmartucc}@usp.br, {hugo, calixto}@lsi.usp.br, {stelvio,
kofuji@pad.lsi.usp.br}
Abstract
-
This
paper
deals
with
concepts
about
the
electromyography signal (EMG), which is a record of action
potentials presented by muscles, and presents the software
simulation
of
a
low-cost
conditioning
circuit
for
electromyography
signals
including
component
blocks
capable of signal processing and adaptation for micro-
controlling devices. The low cost and high sensitivity make
the developed EMG, a good choice in medical applications,
such as sleep disorders.
Keywords — EMG; Conditioning Circuit for EMG Signals;
Circuit Simulation; Instrumentation.
I.
INTRODUCTION
The EMG spectrum includes signals with frequencies
varying from 10 Hz to 1 kHz, primarily between 50 and
150 Hz, and voltage peaks going from 1 µV to 100 mV,
mainly between 50 µV and 9 mV. While acquiring an
EMG signal, some high levels of interference and noise
can be noted, requiring a carefully projected conditioning
circuit to enable the signal's analysis. The main noise
sources involved in this analysis are the environmental
noise and the transducer noise, even though the noise from
other sources can not be discarded. The environmental
noise
results
from
electromagnetic
wave
generators
present, mainly, the frequency of 60 Hz (line frequency).
It should be noted that the 60 Hz frequency is part of the
EMG spectrum and should not be ruled out of the
analysis. The transducer noise, on the other hand, results
from the electrode-skin junction during the conversion of
ionic current to electrical current, presenting DC portion
(from the impedance gradient present between the skin
and the electrode)
and an
AC portion (impedance
fluctuations). Finally, there are other noises involved in
the analysis, such as electromagnetic interference and
cardiac noise.
Each muscle’s EMG signal involves many action
potentials resulting in the various MUAP (Motor Unit
Action Potential) of each motor unit. In this way, it is
possible to distinguish the muscle’s spectrum in function
of the distance between the electrodes and the contractions
intensity
level.
The
whole
process
involves
some
challenges
surrounding
signal
processing
and
noise
treatment, with the intention of allowing a more accurate
measure and a greater sensitivity level, considering the
kind of application given to the EMG [2][3][4][6].
In this paper, the surface EMG’s development process
is described with a special emphasis on noise treatment.
The simulation analysis involves the inputs signal’s
processing
and
amplification,
verifying
the
signal’s
accuracy for frequencies of 10 Hz, 250 Hz, 600 Hz and 10
kHz.
II.
THE ELECTROMYOGRAPHIC SIGNAL
The electromyography signal is a small amplitude
signal, with high noise levels and frequencies ranging
between ± 50 and ± 500 Hz. In order to allow this signal
to be interpreted by a micro-controlling device, it must be
amplified, filtered and rectified, as well as the noise levels
must be reduced.
The first amplification stage requires the use of an
instrumentation amplifier. This amplifier is specifically
made for noise attenuation at small amplitudes. For this
work,
and
bench
experiments,
we
used
the
instrumentation amplifier INA129 [1], whose details will
be
described
in
the
following
sections.
The
instrumentation
amplifier
works
according
to
the
principles of a differential amplifier, involving the CMRR
(Common Mode Rejection Rate) properties [1]. The
rejection rate, in general, is the amplification of a potential
difference, which, in this case, is the difference between
the two electrodes positioned over the muscle surface.
Considering that the existing level of noise in both
electrodes is similar, a fact that results from their similar
exposure conditions, the amplification of the potential
difference would eliminate much of the external noise [1].
III.
THE AMPLIFIER’S DETAILS
The instrument amplifier (INA129) is a variable gain
and high precision amplifier, especially designed for low
voltages. With a resistor in the input, the unit gain can
vary from 1 to 10,000 approximately: the output voltage
can be from 1 to 10,000 times the input voltage. The
internal circuitry is designed to withstand voltages up to ±
40V without damage in operation. The operation can be
made with feeds of at least ± 2.25 V, with a quiescent
current of only 700μA, making it suitable for battery 
powered systems (Figure 1).
19
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-580-7
SENSORCOMM 2017 : The Eleventh International Conference on Sensor Technologies and Applications

Figure 1: INA129 Instrumentation Amplifier’s Internal Circuit
The internal circuitry of the instrumentation amplifier
involves three amplifiers and a combination of resistors,
so the total gain obeys equation (1). Using a resistor of
240Ω, for example, the circuit obtains a gain of 206.83 
(With 200Ω, it obtains a gain of 248). It is noteworthy that 
the main function of this amplifier, however, is to ensure a
significant
reduction
in
the
input
noise
of
the
electromyography signal.
(1)
After the first amplification, the signal is filtered using
initially a high-pass filter with a cutoff frequency of 500
Hz. Then, the signal travels through (with) a low-pass
filter with a cutoff frequency of 50 Hz. Therefore, the
most significant part of the EMG signal proceeds to the
rectification stage, in order to achieve the appropriate
values for the microcontroller.
Upon conclusion of the simulation, using the National
Instruments software Multisim, the circuit is printed in a
PCB,
substituting
the
equivalent
circuit
for
SMD
components.
IV.
SIMULATION AND EXPERIMENTS
The first circuit consists of four functional blocks: a)
the primary amplifier, b) filter, c) rectifier and d)
smoother. Using a sinusoidal signal as input (assuming
that the signal has a frequency within the filter passband),
the wave output is rectified and smoothed. In other words,
the signal is adjusted to positive, the negative portions are
kept in amplitude but are transformed into positive
portions and then the signal peaks are used as DC
stretches. Thus, the DC output is proportional to the
amplitude of input signal: by increasing the intensity of
the muscle contractions detected by surface electrodes, the
circuit’s output signal is higher (Figure 2).
The circuit, in this way, fulfills the objective of
detecting the muscle contraction at different intensity
levels and condition the detected signal to an electrical
signal that is compatible with a microcontroller device, so
that the final output is between 0 and 5V. Thus, the
simulation circuit is shown in Figure 3.
Figure 2: Circuit 1 Input Signal
Figure 3: Simulation Circuit Configuration
The sinusoidal signal generator is used as the input of
the circuit and an oscilloscope (Tektronix brand) is used at
the output. Thus, in order to confirm the basic operation of
the
circuit,
the
simulation
should
provide
four
measurements:
the
initial
amplification
(made
by
INA129U), the filtering (attenuation of signals outside the
range 50-500Hz), the rectification (final results entirely
positive) and the smoothing of the output waveform. Only
the noise reduction can't be verified by simulation with
sine waves, since the generated signal is ideal.
Firstly, the circuit is mounted in a way of analyzing
the instrumentation amplifier, as shown in Figure 4 and
viewed on an oscilloscope (Figure 5):
Figure 4: Simulation Circuit Configuration for Instrumentation Amplifier
Analysis
20
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-580-7
SENSORCOMM 2017 : The Eleventh International Conference on Sensor Technologies and Applications

Figure 5: Results of Instrumentation Amplifier Analysis
Analyzing the results, there was a gain of nearly 206,
as expected for a resistor of 240Ω. It is noteworthy that 
the input signal has 3mVrms, a value compatible with the
EMG signal. It can also be inferred that there were no
changes regarding the input signal’s frequency or phase.
After checking the operation of INA129U, the filter
must be analyzed. The circuit’s final output must be
checked for four input frequencies: 10Hz, 250Hz, 600Hz
and 10 kHz. The analysis will be done by checking a
possible output signal attenuation (the signal’s amplitude
values will be checked). It is important or remarkable that
the signal frequency is changed in the rectification and
smoothing process, as the negative portion of the signal is
bounced to the positive voltage range, amplifying or
magnifying the signal repetition (doubling its frequency).
Figure 6 displays the oscilloscope positioning.
Figure 6: Simulation Circuit Configuration for Filter Analysis
Figure 7: Results for 10 Hz input
For an input frequency of 10 Hz (Figure 7), it appears
that the oscilloscope shows only a portion of the signal
(the rising of the sinusoid), since the sample period chosen
is too large. The circuit’s output, on the other hand, has a
very low value (within the range of 0 to 5V). Then, the
signal, despite of being amplified, was attenuated in the
circuit, since the frequency is not suitable for an EMG
signal. In other words: the signal which was not detected,
as an EMG signal, was filtered by the conditioning circuit.
For an input of 250Hz (Figure 8), with an amplitude
close to the maximum of a typical EMG signal, a 2.39V
output can be seen. As such, voltage values within 0 to 5V
are proportional to the input value, so, it could be
concluded that the signal is not attenuated, i.e., was not
filtered. In fact, as the frequency is in the appropriate
range for electromyography signal, the circuit must keep
the amplifications and let the signal passes to the exit
without suffering attenuation.
Figure 8: Results for 250 Hz input
For an input of 600 Hz (Figure 9), the attenuation is
still unclear, although the frequency is already outside the
range of the EMG signal. Because the value is close to the
500Hz filter cutoff frequency, the signal is not intensely
attenuated. In practice, it is impossible to design a filter
able to fully attenuate signals above 500Hz, as signals
near cut-off frequency will continue passing through to
the circuit output. However, the actual spectrum of an
EMG signal is not that precisely located in the pass band
mentioned above (50 to 500Hz) and, in addition, signals
near to 500Hz are not very common. Thus, it is not
expected or required for the circuit to be able to filter
signals with frequencies that close to the cutoff frequency.
Figure 9: Results for 600 Hz Input
21
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-580-7
SENSORCOMM 2017 : The Eleventh International Conference on Sensor Technologies and Applications

For an input signal of 10 kHz (Figure 10), the
attenuation becomes evident. The output signal, in this
case, has zero amplitude, illustrating a signal completely
filtered. Unlike the previous case, the frequency of 10 kHz
is distant from the circuit’s cut-off frequency (500 Hz)
and therefore, in a real situation, would not be part of the
EMG. That frequency represents only noise, featuring as
an unwanted signal. Then, the complete attenuation of the
signal is indicative of a good filtering performed by the
circuit.
Figure 10: Results for 10 kHz input
After the filtering, the rectification and the smoothing
must be verified. For that, the oscilloscope is positioned,
both before and after the rectification circuit, as shown
below (Figures 11-12):
Figure. 11: Simulation Circuit Configuration for Rectification Analysis
Figure 12: Results for Rectification Circuit
V.
CONCLUSION AND FUTURE WORKS
The result observed on the oscilloscope evidence the
frequency amplification is double and the signal’s average
value’s rise. In fact, the full-bridge rectification results in
a modular signal of the input; thus, the output presents, for
a sinusoidal input, a signal with the double of the
frequency and a “displacement” of the average value for a
positive portion of the signal, since the negative portions
were reflected upside.
The filters used in these experiments present cutoff
frequencies of 50Hz and 500Hz. Using sinusoidal inputs
of 10Hz, 250Hz, 600Hz and 10kHz, it could be noted the
good functioning of the filters. It was observed that the
circuit is able to attenuate completely the signals with
10Hz and 10 kHz (signals with frequencies too distant of
the EMG spectrum), attenuate partially the input signals
with
600Hz
(uncommon
frequency
for
the
EMG
spectrum) and not attenuate signals of 250Hz (typical
frequency of the EMG spectrum).
Besides that, it should be noted that the amplified
signals did not exceed 5V, such as they did not assume
negative values. In this way, it can be concluded that the
circuit is able to meet the conditions imposed by a micro-
controlling device, which operate with input signals
between 0 and 5V.
Finally, the signal's smoothing was verified. For that,
it was sufficient to insert a typical signal as the input and
verify the aspect of the output signal. The smoothing of an
infinite sinusoidal signal is a DC voltage, since all the
peaks are the same (it can be seen that the DC voltage is
equal to the maximum peak value of the sinusoidal signal,
already amplified, filtered and rectified).
The high sensitivity of the EMG may allow its use in
several medical applications, such as studies of sleep
disorders, specifically bruxism [7], even considering its
low manufacturing cost.
ACKNOWLEDGMENTS
This work was funded by the Huawei Company -
project number: 2994. The project is managed by the
University of São Paulo Support Foundation and the
Electronic Systems Department of University of São
Paulo
(PSI).
Number
of
Company
/
Institution
Agreement:
OTABRA09160202003286840274.
REFERENCES
[1]
Burr-Brown Corporation. Datasheet: "Precision, Low
Power Instrumentation Amplifiers ". Access:
http://instrumentation.obs.carnegiescience.edu/ccd/part
s/INA128.pdf , Feb. 2017.
[2]
J.D. Geyer, P. R. Carney, and T. Payne, "Atlas of
Polysomnography," Lippincott Williams and Wilkins,
2009.
[3]
S. Devuyst et al., "Automatic Sleep Spindle Detection
in Patients with Sleep Disorders," 2006 International
Conference of the IEEE Engineering in Medicine and
Biology Society, New York, NY, 2006, pp. 3883-3886.
[4]
J.F. Gagnon, R. B. Postuma, and J. Montplaisir,
"Update on the pharmacology of REM sleep behavior
disorder," Neurology, vol. 67, no. 5, pp. 742–747,
2006.
[5]
A. Siddiqi, D. Kumar and S. Arjunan, "Surface EMG
model
for
Tibialis
Anterior
muscle
with
experimentally
based
simulation
parameters," 5th
22
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-580-7
SENSORCOMM 2017 : The Eleventh International Conference on Sensor Technologies and Applications

ISSNIP-IEEE Biosignals and Biorobotics Conference
(2014): Biosignals and Robotics for Better and Safer
Living (BRC), Salvador, 2014, pp. 1-5.
[6]
M. E. G. Bigelow et al., "Point-of-Care Technologies
for the Advancement of Precision Medicine in Heart,
Lung, Blood, and Sleep Disorders," in IEEE Journal of
Translational Engineering in Health and Medicine,
vol. 4, no., pp. 1-10, 2016.
[7]
N. Jirakittayakorn and Y. Wongsawat, "An EMG
instrument designed for bruxism detection on masseter
muscle," The
7th
2014
Biomedical
Engineering
International Conference, Fukuoka, 2014, pp. 1-5.
23
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-580-7
SENSORCOMM 2017 : The Eleventh International Conference on Sensor Technologies and Applications

