Stochastic Models of Traffic Flow Balancing and Management of Urban Transport 
Networks 
 
Dmitrii Zhukov 
Institute of Information Technologies 
Moscow state technical university, MIREA 
Moscow, Russia 
e-mail: ZhukovDm@yandex.ru 
Sergey Lesko 
Institute of Information Technologies 
Moscow state technical university, MIREA 
Moscow, Russia 
e-mail: Sergey@testor.ru 
Anton Alyoshkin 
Institute of Information Technologies 
Moscow state technical university, MIREA  
Moscow, Russia 
e-mail: Antony@testor.ru 
 
Abstract— In this paper, we developed models and algorithms 
for 
managing 
stochastic 
flows 
with 
indeterminate 
characteristics of distributing static parameters in urban 
transport networks. The proposed models describe the 
dependence of the single nodes blocking probability on the 
urban traffic parameters changing over time. In addition, we 
have modeled a city transport network and traffic flow with 
the traffic lights switching time regulated according to the 
proposed model and with rigidly set switching regimes (a 
‘conventional traffic’ mode). The conducted research of the 
line-up lengths appearing at the traffic lights exhibits a double 
reduction of the traffic jams when using the elaborated model 
of the ‘regulated’ traffic lights in comparison with a 
conventional model of traffic management. 
Keywords-transport 
network; 
stochastic 
dynamics 
of 
transport network nodes blocking; traffic flow balancing; traffic 
flows management algorithms. 
I. INTRODUCTION 
In order to develop efficient algorithms of information-
and-transport systems performance, one should have 
adequate mathematical models.  
The mathematical models used to analyse the traffic 
networks are diverse according to the tasks they solve, 
mathematical tools employed and the degree of detailing the 
traffic flow and the data used. 
Therefore, it is impossible to provide an exhaustive 
classification of the transport models, yet we can tentatively 
specify three major classes of models based on the tasks 
solved, i.e.:  
 
Forecast models. They solve the tasks of defining a 
number of averaged parameters of the traffic flow, 
e.g., the flow rate, the quantity of automobiles and 
passengers on various parts of a road, the transfer 
volume etc.  
 
Simulation models. They allow to describe the 
traffic flow dynamics, reproducing the movement of 
any single vehicle separately. The application of 
simulation models lets us estimate the traffic flow 
dynamics, speed, behaviour and length of line-ups 
and traffic jams and some other parameters. 
 
Optimisation models. They aim at optimising 
trucking or passenger travel routes, improving the 
calculations of traffic lights regimes, defining 
optimal configuration of the network model and so 
on.  
The now existing models of traffic flow dynamics can 
also be classified by their properties and types [1]: 
 
Macroscopic models. They describe the movement 
of objects in averaged terms, e.g., density, vehicle 
cruising speed etc. 
 
Kinetic model. When describing a traffic flow, one 
equals it to the flow of some liquid, thus such 
models are also called hydrodynamic. 
 
Microscopic models describing the movement of 
each vehicle more precisely in comparison to the 
macroscopic models. 
A kinetic approach to building transport models is the 
following. The traffic flow is described via density in the 
phase space, i.e., in the field of coordinates and speeds of the 
vehicles [1]. A kinetic equation defines the dynamics of the 
phase density. A kinetic approach is closer to a micro-level, 
whereas an averaged description allows transition to a 
macro-level. The main benefit of the kinetic model is that 
one can use it to develop macroscopic models. Knowing how 
phase density changes over time, we can calculate 
macroscopic features of the traffic flow, e.g., the average 
speed and the density of the traffic. Kinetic models consider 
the changes of automobile speeds accounted by processes of 
interaction. Interaction means the following: if a speedier car 
catches up with a slower one moving ahead, the former must 
either slow down or pass it. In a freely moving traffic flow, 
there is natural distribution of cars by ‘desirable’ speeds. 
126
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-505-0
UBICOMM 2016 : The Tenth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

Desirable is the speed at which the car could move without 
any obstacles or interactions. One of the most serious 
drawbacks of this model is the hypothesis of an automobile 
chaos. According to it, during mutual interactions of cars 
there is no connection between their speeds.  
Kerner theory [2] of the three-phase traffic flow can be 
attributed to macroscopic models, as it can predict and 
explain empirical properties of dense traffic breakdown and 
resulting space and time structures in the traffic flow.  
One of the most efficient micro-models is the cellular 
automation model (Cellular automata models, CA [3]). 
Cellular automata are idealised representations of physical 
systems in which the time and space are represented as 
discreet, and all elements of the system have some discreet 
range of possible states. 
A road is divided into conditional cells of the same 
length ∆x, at that at each moment the cell is either empty or 
occupied by a single vehicle. At each time step t → t + 1, the 
condition of all cells simultaneously (in a parallel way) 
updates according to some set of rules. The choice of some 
set of rules defines the diversity of CA options [4]. Traffic 
models based on CA can correlate the traffic flow dynamics 
at a micro-level with the traffic flow behaviour at a macro-
level. 
We should note that the afore-mentioned models are not 
universal and have some flaws necessitating the search for 
new models, e.g., the ones founded on stochastic dynamics.  
The rest of the paper is structured as follows. In Section 
II, we will describe stochastic model of traffic flow. In 
Section III, we will describe the results of mathematical 
simulation of the traffic flows in urban transport networks 
and improvements of road situations when we use the model 
of ‘managed’ traffic lights. We conclude in Section IV. 
II. A STOCHASTIC MODEL OF TRAFFIC FLOW DISTRIBUTION 
WITH INDETERMINATE CHARACTERISTICS IN URBAN 
TRANSPORT NETWORKS 
To develop a dynamic model of traffic network 
performance, we propose decomposing the task set and 
dividing it into solutions of two levels: 
 
The level of describing a single node performance 
dynamics. 
 
The level taking into consideration the network 
topology and a single node performance dynamics. 
The essence of the model we developed for performance 
of single nodes is the following. If we consider the change of 
traffic flow as a random process and we set for each 
direction, each node of the transport network (a junction) a 
critically admissible number of cars in line Li,j, then we can 
define the probability P(Li,j, t) of the situation that by 
moment t the number of cars in a line will not exceed Li,j 
(there is no traffic jam). 
Suppose that over some time interval τ there arrive ε cars 
and leave ξ cars in the i direction of the line at j junction. The 
whole data processing will be adding single steps h having 
duration τ, with 


 
 being the intensity of the traffic 
inflow, and 


 
 being the intensity of traffic outflow. 
Let us denote by Px-ε,h the probability of the number of 
cars (x-ε) in line after h steps of processing, by Px,h the 
probability of x cars, and by Px+ξ,h the probability of (x+ξ) 
cars. Then probability Px,h+1 (see Figure 1) of x cars at step 
h+1 will equal: 
 
Px,h+1 = Px-ε,h + Px+ξ,h - Px,h  
 
 
Figure 1.  The scheme of probable transitions between the states 
characterising the number of cars at j junction in i direction at h+1 step of 
traffic lights performance. 
Let us introduce t=hτ, where t is the total time of 
processing, we thus get: 
 
P(x,t+τ)=P(x-ε,t)+P(x+ ξ,t)-P(x,t)  
 
Expanding this equation in a Taylor series, we obtain:  
 




...
, )
(
2
( , )
, )
(
2
2
2
dt
P x t
d
dt
dP x t
P x t


 
 
 





...
, )
(
2
( , )
, )
(
2
2
2
dx
P x t
d
dx
dP x t
P x t


 
 
 
( , ).
...
, )
(
2
( , )
, )
(
2
2
2
P x t
dx
P x t
d
dx
dP x t
P x t







  
The second derivative of t can be excluded as it naturally 
describes the process at which cars themselves could bear 
additional cars. Taking into account the members in the left 
part containing no more than the first derivative of t, and the 
members of the right part having no more than the second 
derivative of x, we receive:  
 
,)
( ,
)
(
, )
(
2
, )
(
2
2
2
2
dx
x t
dP
dx
P x t
d
dt
dP x t









  
 
.)
( ,
)
(
, )
(
2
, )
(
2
2
2
2
dx
x t
dP
dx
P x t
d
dt
dP x t









  
Assuming that µ and λ do not depend on x and 
introducing the insymbol 



2
2
2 
a 
 and 
b    
, 
we get: 
 
.)
( ,
( , )
, )
(
2
2
dx
b dP x t
dx
a d P x t
dt
dP x t


 
 
As the function P(x,t) is continuous, we can transgress 
from probability P(x,t) to the probability density ρ(x,t), 
which enables us to formulate and solve a boundary problem 
for describing a stochastic model of processing applications 
127
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-505-0
UBICOMM 2016 : The Tenth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

at a single node with indeterminate parameters of the 
statistical law of their incoming times distribution.  
With the number of cars x=L lining up for j junction in i 
direction, where L is some critical limit number, we assume 
that the node of processing (j junction in i direction) becomes 
overloaded and a traffic jam is formed. The probability of 
detecting such a state will be different from zero, and the 
probability density defining the traffic flow in state x=L 
should be put down as 0 (we are trying to avoid this 
condition), i.e.: 
 
ρ(x,t)x=L=0 
(a) 
We choose the second limit condition based on the fact 
that condition x=0 defines a standstill in the processing. The 
probability to detect such a state will be nonzero, however, 
the probability density defining the traffic flow under 
condition x=0 must be laid down as equal to 0 as well. We 
must also strive to avoid this condition as it correlates to the 
case when the traffic lights do not close this direction, and it 
contradicts the logic of its work, i.e.:  
 
ρ(x,t)x=0=0 
(b) 
As at time t=0 (the start of the calculation) there may be 
x0 cars under the processing. Let us set the initial condition in 
the following form: 
 









0
0
0
,0
,1
)
(
0)
( ,
x
x
x
x
x
x
x t


 
 
Since the initial condition is set as a δ-function, it leads to 
the fact that the solution of the obtained differential equation 
remains indiscreet (continuous) at point x = x0  and the 
equation will suffer derivative discontinuity at this point.  
Employing operational calculus methods for probability 
P(Li,j, x0|t) of the traffic jam not being formed by some t 
moment (the number of cars in a line will not exceed Li,j), we 
can obtain the following expression: 
 




j
i
i j
j
i
a
t
b
x
b
i j
e
t
x
L
P
,
2
,
0
,
4
2
0
,
2
| )
,
(
 
 
 
2
,
,
2
2
,
,
,
1
2
,
2
,
2
,
1
,
0
,
,
0
2
4
)1
(
)
sin(
)
sin(
j
i
j
i
j
i
i j
j
i
L
t
a
n
M
n
j
i
i j
i j
n
j
i
j
i
j
i
a
L
b
e
na
b L
n
L
x
n L
L
n x
e




















 (1) 
where 
j
i
i j
j
i
j
ia
,
2
,
2
,
,
2




 and 
i j
i j
ib j
,
,
,




, µi,j are the 
number of cars leaving j-node of traffic network 
(junction/traffic lights) in i-direction per unit of time (an 
outflow), λi,j is the number of cars entering the node per unit 
of time (an inflow), t is time, x0 is the number of cars in a 
line at the start time of traffic lights operation step. 
Solving (1) relative to time t allows determining optimal 
time intervals of traffic lights switch on. Yet it is input-
intensive computational task. Taking into consideration that 
the computations should be simultaneously carried out for 
multiple directions and junctions, and one should also 
synchronise (see (2)) the traffic inflows and outflows as 
neighbouring junctions, it is reasonable to use parallel 
computations to simulate the traffic flow.  
 

k
x i j
0 ,
 
 
 
k
j
i
k
j
i
k
j
i
k
j
i
r
i
k
j
i
k
j
i
k
i j
t
T
r
x
,
,
1
,
1
,
1
1
,
1
,
1
0 ,
)
(
1














 
(2) 
 
,
,
1
,
0
,
j
i
D
k
i j
k
i j
l
V
 x

 
 
where 
1
,
0

k
x i j
 is the number of cars which did not manage 
to get through in direction i of j junction after performing (k-
1) step, r is the number of directions at the junction, 
1
,

k
i j
 
are the outflows at step (k-1) per each r direction at the 
chosen junction. Any car from those traffic inflows at step 
(k-1) can equally likely choose at next k step one of r 
directions, that is why we introduce a numerical coefficient 
(1 / r) before the summation symbol. 
1
,
k
iT j
 is the time during 
which the chosen direction was closed by the traffic lights (it 
is not the ‘open’ time, but the time of ‘idle cycle’) between 
two chained openings. Let us note that opening of all 
directions at the chosen junction may happen not in the 
rigidly set periodical sequence. The order of directions 
openings may vary depending on the traffic behavior. The 
time interval between two chained openings of the same 
chosen direction will simply be the ‘idle cycle’, which value 
1
,
k
iT j
 can change dynamically. 
k
i, j
 is the change of traffic 
inflow in the chosen direction at the chosen node of traffic 
flow over time 
1
,
k
iT j
. The total number of cars in the 
transport network at any time of the day corresponds to the 
function of the number of cars on the time of the day. 
1
,

k
i j
 
is the time during which at (k-1) step the directions of traffic 
inflows are open while the chosen outflowing direction is 
closed during time 
1
,
k
iT j
. 
1
,

k
i j
 is the traffic outflow in the 
chosen direction at step k, 
k
j
it ,  is the time interval of traffic 
lights switch on at step k of the chosen direction. It is 
important to determine the time interval value in order to 
solve the equation defining probability P(Li,j, x0|t) of the fact 
that by time t the number of cars in line will not exceed Li,j 
(the gridlock do not form). VD1 is the recommended speed. 
III. SIMULATING AND BALANCING THE TRAFFIC FLOWS IN 
URBAN TRANSPORT NETWORKS ON THE BASIS OF THE 
STOCHASTIC MODEL 
To simulate transport network and determine whether it 
is possible, as a matter of principle, to dynamically change 
the time intervals of traffic lights switching in a city to 
prevent traffic gridlock, besides (1) and (2), we should have 
a model of how the number of cars varies with the time of 
the day. For modelling, the total number of cars in a 
transport network may be set, for example, by the function 
depicted in Figure 2 (The traffic load is measured with 10 
128
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-505-0
UBICOMM 2016 : The Tenth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

generating units (points) and correlated to the situation when 
all vehicles registered in Moscow or Moscow Region are on 
the road at the same time. According to statistics, autumn is 
the busiest time of the year). 
 
 
Figure 2.  Traffic load in Moscow during a workday (curve 1 represents 
autumn of 2013; curve 2 is for autumn 2014). 
Basing on (1) and (2) as well as on the function in Figure 
2, we developed an algorithm of managing the transport 
network and tested the proposed approach. 
For the simulation purposes, we elaborated a number of 
algorithms and software allowing us to model a city transport 
network and traffic situations with ‘controlled’ traffic lights, 
which are regulated according to the proposed model, and 
‘uncontrolled’ traffic lights which have rigidly set modes of 
switching (classical traffic). 
To serve as a technological concept, we realised the 
function of maps downloading as Open Street Map (OSM) 
and wrote a parser of this format, the output of which is a 
graph of transport network with featured properties of arcs (a 
road) and peaks (a junction). This is important for simulation 
and emulation of traffic flow, and the set of WPF (Windows 
Presentation Foundation) objects is vital for their onto 
mapping.  
At the second stage, we constructed a structural model of 
a city, which featured all classes of roads, junctions, traffic 
directions, traffic lights and their modes, as well as cars and 
line-ups. Besides, we realised the tools for entering the cars 
according to their per diem spread (see Figure 2) and the 
tools to set the cars behaviour.  
 
Figure 3.  Comparison between performing efficiencies of the proposed 
model and the traffic lights switching at a fixed time  
We chose the index of total length of all line-ups at all 
junctions of the loaded map to be the simplest efficiency 
criterion. A traffic jam is a line-up of cars at the traffic lights 
waiting for the permissive signal.  
For the experiment, we downloaded a small real map of 
Vasilievskiy Island in Saint Petersburg and simulated daily 
traffic flow. Careful examination of line-ups length (see 
Figure 3) demonstrates that the number of gridlocks halved 
when we use the model of ‘managed’ traffic lights in 
comparison with the rigid classic traffic mode.  
The traffic lights with fixed phases of operation help to 
solve the problem of regulating the traffic, yet they are less 
efficient and cannot react to traffic situation changes as they 
lack feedback. For instance, if cyclical (daily) variations 
could be accounted for when we develop the traffic lights 
operational phases, plenty of various accidental (random) 
factors, such as weather conditions, road works, accidents, 
cannot be fully factored in.  
It is evident that real traffic situation can greatly diverge 
with the experimental mathematical simulation, but the 
obtained results allow us to state the adequacy of the 
proposed model and its potential application in designing 
control services in automated systems of traffic flow.  
IV. 
CONCLUSIONS  
We developed models and algorithms of controlling 
stochastic flows with indeterminate characteristics of 
statistical parameters spread in urban transport networks; 
they allow to describe the dependence of single node 
blocking probability on the traffic flow parameters over time.  
In the elaborated mathematical models, we provided a 
description of how to service junctions (the times of traffic 
lights switching), accounted for the traffic burden balance of 
cars in the system and connection of traffic flows between 
neighbouring junctions. The proposed model enables the 
creation of a dynamic model using a real transport network 
map and thus emulating its work and testing the way 
gridlocks are formed.  
Simulation of urban transport network and traffic 
situation according to the proposed model of ‘controlled’ 
switching times of traffic lights in comparison with fixed 
modes of switching (‘classical traffic’) shows a double 
reduction of gridlocks when we use the former model of 
‘controlled’ switching instead of the latter one.  
In our future works we plan to develop traffic lights 
control algorithms based of stochastic models of balancing 
and flow control that focus not on the "priority of the shortest 
possible route", but on the load state of each node (or group 
of nodes). Given the fact that some nodes can be soon 
overloaded and such nodes should be balanced. Depending 
on how close node is to critical state in a transport network, 
the metric for this node can be proportionally increased 
linearly or nonlinearly (the closer to critical state, the greater 
value of the metric). 
We also note that the above approach can also be applied 
in case when the transport network is divided into several 
areas and inner traffic lights within areas have information 
about the topology of the other parts of the network. 
129
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-505-0
UBICOMM 2016 : The Tenth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

ACKNOWLEDGMENT 
This work is supported by Russian Foundation for Basic 
Research (grant 16-37-00373 mol_a). 
REFERENCES 
[1] S. Göttlich and A. Klar, “Model hierarchies and optimization for 
dynamic flows on networks,” Modeling and optimization of flows on 
networks, Cetaro (CS), June 15–19, 2009, C.I.M.E, Courses, 2009. 
http://php.math.unifi.it/users/cime/Courses/2009/01/200914-
Notes.pdf  [retrieved: 09, 2016] 
[2] B. S. Kerner, “Introduction to Modern Traffic Flow Theory and 
Control,” Berlin: Springer, 2009. 
[3] S. Maerivoet and B. De Moor, “Cellular automata models of road 
traffic,” Physics Reports 2005, V. 419, № 1, P. 1–64., 2005. 
[4] H. J. Ruskin and R. Wang, “Modeling Traffic Flow at an Urban 
Unsignalized Intersection,” Lecture Notes in Computer Science. 
2002. Т. 2329. P. 0381. 
 
 
 
130
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-505-0
UBICOMM 2016 : The Tenth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

