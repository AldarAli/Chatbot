A Low-cost and Portable System for Real-time Impedimetric Measurements and 
Impedance Spectroscopy of Sensors 
Michele Rossi, Marco Bennati, Federico Thei, and Marco Tartagni 
ARCES – Advanced Research Center on Electronic Systems 
Second School of Engineering, University of Bologna - Via Venezia 52, 47521 – Cesena (FC), Italy 
mrossi@arces.unibo.it, mbennati@arces.unibo.it, fthei@arces.unibo.it, mtartagni@arces.unibo.it  
 
Abstract— This paper presents a low cost and portable system 
that is able to perform real time or spectra impedance 
characterization of impedimetric sensors interfaces. It is also 
able to perform simple amperometric measurements for real-
time DC current-voltage characterization or studies of the 
behavior of the sensor with respect to different target stimuli. 
Due to its flexible design, the system can be easily adapted to 
different 
applications 
and 
experimental 
requirements. 
Synthetic devices under test (DUTs) were used for testing 
purposes and the performances have been compared to those 
obtained using a commercial dedicated impedance analyzer. 
The system allows displaying results in Nyquist and Bode plots 
using a friendly graphical user interface. Results show 
remarkable fair accuracy, considering the much lower price, 
smaller sizes and flexibility of use of the developed system. 
Keywords – Biosensors; Sensor interfaces; Impedance 
spectroscopy; Real time; Amperometry measurements. 
I. 
 INTRODUCTION 
In the last decade, the convergence of nanotechnology 
with biology and medicine and the ability to fabricate 
structures 
using 
standard 
wafer-scale 
semiconductor 
processing techniques has shown an emerging and evolving 
interest in the development of new classes of rapid, sensitive, 
and reliable biosensors devices, such as nanowires and 
carbon nanotubes [1][2][3][4][5]. 
These devices could have a great impact on many 
application fields related to our life: from health-care and 
environment, to food production and bio-warfare thanks to 
their properties of electrical, label-free and real time readout.  
Moreover, the possibility of integration of this class of 
sensors with the readout structure makes them even more 
interesting. However, the integration of sensors with 
interfaces demands a quick although accurate knowledge of 
electrical parameters (such as impedance, noise and 
bandwidth) [6] and their related behaviors to target stimulus, 
in order to understand the design constraints of the readout 
systems. Another important issue to point out is the lack of 
instrumentation 
able 
to 
perform 
both 
impedance 
spectroscopy and real-time impedance measurements in 
order to identify the electrical parameters model and real 
time behaviors of biosensors depending upon the specific 
structure and fabrication process [7][8]. 
For the above reasons, there is a demand for low cost, 
portable readout structures able to perform accurate 
preliminary tests on biosensors and/or to perform routine 
tests with respect to experimental conditions avoiding skilled 
personnel and bulky instruments. 
The main characteristics needed for the readout system 
are: 
• 
Compact and low cost; 
• 
Flexible to cope with different kind of biosensors; 
• 
Able to perform parallel acquisitions, allowing high 
throughput; 
• 
Perform differential measurements in order to further 
increase sensitivity and selectivity; 
• 
Perform a full characterization of impedance in the 
magnitude and in the phase, since the latter could 
offer a better understanding of the surface molecular 
interaction [9]. 
This paper presents a low cost, versatile and portable test 
board for sensors implementing a two electrode potentiostat, 
conjugated with a lock-in technique for complex impedance 
detection which allows obtaining comprehensive information 
on the impedance magnitude and phase (Figure 1). More 
specifically, the instrument has been designed to be 
interfaced to bionanosensors, such as nanowires or carbon 
nanotubes; however it is not the purpose of this paper to 
describe a single specific application related to this kind of 
biosensors, but rather investigate the potentiality of this 
system interface to be used for different kinds of sensors.  
Section II will show the system architecture and 
functionalities. Section III will present the developed 
acquisition board features and working principles. Section IV 
will show the LabVIEW software interface and the 
implemented digital signal conditioning process. Finally, 
Section V will present the results of tests performed on 
synthetic DUTs simulating sensors behaviors and a 
comparison between the developed system and a commercial 
impedance analyzer. 
 
 
 
Figure 1.  Schematic of the lock-in technique for complex impedance 
detection. 
101
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-208-0
SENSORDEVICES 2012 : The Third International Conference on Sensor Device Technologies and Applications

II. 
SYSTEM STRUCTURE AND SETUP 
The system consists of a custom printed circuit mother 
board (PCB) hosting both the DUT and the readout interface. 
The latter performs the readout of the current signal coming 
out of the sensors in response to a sinusoidal or DC Vref 
signal generated by a waveform generator (Tektronix AFG 
3102 [10]) and digitized by a National Instruments 6009 
DAQ card [11] whose output is sent to a laptop for storing 
and online (or post) processing using a LabView interface. 
The above approach, based on performing the filtering 
and data manipulations in the digital domain, allows the 
system to be particularly flexible, maintaining a simple 
analog front-end for different applications with respect to the 
system required performances. 
In particular, the developed system is designed to be as 
much versatile as possible allowing to perform the following 
measurements in lock-in readout configuration: 
1) Real-time DC current measurements; 
2) DC voltage sweeps, for device characterization; 
3) Real-time 
AC 
measurements 
of 
sensor 
impedance/admittance magnitude and phase; 
4) Impedance AC spectra. 
The graphical user interface is able to reconstruct in real 
time both Nyquist and Bode plots. 
III. 
ACQUISITION BOARD INTERFACE 
The designed acquisition board (block diagram shown in 
Figure 2) is characterized by the following features: 
• 
Two identical and independent readout branches to 
allow differential measurements on sensors (Zref and 
Zsens in Figure 2). The board could be used for array 
of sensors as well; 
• 
Addressable 
switching 
system 
to 
select, 
independently on the two branches, single sensors in 
a chip array (see Figure 1); 
• 
Operating frequency in the range of 0.1Hz-2KHz 
(typical for nanowires or nanotube sensors lock-in 
readout measurements) [2][4][5][8][12][13]; 
• 
DC measurements bypassing the demodulation stage 
(this possibility is represented with switches on each 
branch of Figure 2); 
• 
Four 
different 
current 
ranges 
selectable 
by 
mechanical switch, in particular ±7.85µA, ±785nA, 
±78.5nA, ±7.85 nA. 
• 
Auxiliary potential (Vbulk) control circuit to set the 
back-gate and/or liquid gate potential of nanowires 
or nanotubes chip [2][13][15]. 
• 
Real time parallel measurements of both real and 
imaginary part of sensors impedance using two 
independent demodulators for each branch of the 
system. 
• 
Custom designed socket (4x4 cm) for hosting the 
DUT/sensor. 
Special attention was paid to the four layer PCB layout in 
order to shield as much as possible the analog signals on 
the board from external noise sources. 
 
 
Figure 2.  Block diagram of the designed acquisition board.  
The zoom shows the working principle of the AD 630 demodulator. The 
switch is driven by a comparator that compares the reference signal (Vref 
and VrefQ) with its DC offset level, resulting in a square wave in-phase with 
the reference signal. 
Each branch of the circuit can be represented by two 
stages: a transimpedance input amplifier that converts the 
current signal coming from sensors to an amplified voltage 
signal prior to be sent to the integrated circuit (AD630) that 
performs the phase-sensitive detection. The signal is 
preamplified by an AD822 due to its low-power rail-to-rail 
and low noise operating performances (13 nV/√Hz @ 10 
kHz) and low input bias current [16]. 
The demodulation is implemented by using an AD630 
since it is currently used in precision signal processing and 
instrumentation applications requiring wide dynamic range 
[16].  
The AD630 demodulator is configured to have a gain of 
±1 and, since the positive or negative gain is controlled by a 
switch controlled by a comparator (zoom in Figure 2), thus 
the demodulator multiplies the input waveform for a unitary 
square wave whose Fourier series is [17]: 
 
∑
∞
=






−
⋅
−
⋅
=
1
1
2
)
)1
sin((2
4
)
(
k
square
k
t
k
t
V
ω
π
  
(1) 
and the reference waveform sent to both the DUT and the 
comparator input is: 
 
)
sin(
t
V
V
i
i
ref
ω
⋅
=
  
(2) 
the output of the in-phase branches of the circuit is: 
102
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-208-0
SENSORDEVICES 2012 : The Third International Conference on Sensor Device Technologies and Applications

∑
∞
=






−
⋅
−
 ⋅




⋅
+
⋅




⋅
−
=
1
1
2
)
)1
sin((2
4
)
sin(
)
(
k
i
sens
f
i
o
k
t
k
t
Z
R
V
t
V
ω
π
ϕ
ω
  
(3) 
where Rf and Zsens are respectively the selected feedback 
resistance, which sets the range of measurements of the 
system, and the sensor impedance. As can be seen, the output 
signal presents a high harmonic content associated to the 
square wave components of the signal. 
The output of the two “real part” branches of the PCB 
that are externally digitized and filtered could be derived 
from (3) as:  
)
Re(
cos( )
2
( )
sens
sens
f
i
o
Y
Z
R
V
V t
⋅
=
⋅
⋅ 




⋅
= −
α
ϕ
π
  
(4) 
Similarly, the output of the quadrature branches, in which the 
comparator input is shifted of 90° (VrefQ in Figure 2), of the 
circuit is: 
∑
∞
=






−
⋅
−
 ⋅




⋅ 
+
 ⋅




⋅ 
−
=
1
1
2
)
)1
cos((2
4
)
sin(
)
(
k
i
sens
f
i
o
k
t
k
t
Z
R
V
V t
ω
π
ϕ
ω
  
(5) 
by which it is possible to obtain the output of the two 
“imaginary part” branches of the PCB, then externally 
digitized and filtered yielding: 
)
Im(
sin( )
2
( )
sens
sens
f
i
o
Y
Z
R
V
V t
⋅
=
⋅




⋅




⋅
= −
α
ϕ
π
  
(6) 
Figure 3 shows a picture of the PCB where on one side 
are arranged: 
• 
An input signal SMB connector for the Vref, 
• 
A dual power supply connector, 
• 
4 output SMB connectors (Re1, Im1 Re2 Im2). 
The socket connectors provides the power supply, 
Ground, Vref and Vbulk signals to the PCB plug interfaces for 
different (eventually based on active components) solutions 
and connects the selected sensor to the selected branch of the 
circuit (see Figure 1). 
 
 
Figure 3.  Picture of designed acquisition board PCB interface. 
IV. 
LABVIEW INTERFACE AND FILTER DESIGN 
The implemented software interface allows to: 
• 
control the function generator and set Vref waveform 
properties (frequency, amplitude, DC offset) using 
the USB interface; 
• 
control the NI-DAQ, setting the proper (adapted to 
the Vref frequency) sampling rate and DAQ 
acquisition voltage range; 
• 
simultaneously control the real time signal value for 
the four outputs of the acquisition board to finally 
have the mean Re1, Im1 Re2 Im2 values;  
• 
perform real time calculation to finally display the 
real time Nyquist diagram of the admittance (or 
impedance), as well as Phase and Magnitude values 
and calculate the simple RC equivalent circuit. 
• 
save data in users-specified text files. 
The main signal conditioning process (represented in 
Figure 4) was segmented into 3 stages: two stages 
implementing finite impulse response digital low-pass filters 
(FIR Kaiser window) and one devoted to decimation. Weight 
taps have been calculated with MATLAB to have the best 
configuration for all the frequency in the functioning range. 
In order to optimize the computational resources, an adaptive 
filtering based on the input frequency (fi) and the signal band 
(user selectable) cut off frequency (fcfinal) was implemented 
in the software interface.  
The interface also allows selecting the highest harmonic 
of the signal (see (3) and (5)) to be considered following the 
Nyquist criterion, consequently changing the sampling ratio 
of the NI DAQ. 
 
 
fs(k,fi) 
 
fdec(k,fi,fc final) 
FIR 1: 
fc FIR1(k,fi,fc final) 
100 taps 
 
 
Decimation 
factor  
(k,fi,fc final) 
Mean 
Value 
FIR 2: 
fc final = User 
selectable 
100 taps 
 
 
fs(k,fi) 
 
Figure 4.  Representation of the adaptive two stages low pass FIR filter 
implemented in the LabView interface . 
In order to perform real time, 4-channel measurements 
with a low final cutoff frequency (usually 1 or 0.1 Hz) and 
relatively limited computational resources (e.g., if using a 
laptop), a good trade-off between performances and 
computational complexity has been found to be the cascade 
of two 100-tap adaptive filters. 
The two stages are dimensioned to satisfy the condition 
of same ratio between cutoff frequency and bandwidth: 
 
fcFIR1
fs
= fcfinal
fdec
,   
(7) 
whose expression, considering fdec=2* fc FIR1, allows 
calculating the first filter cutoff frequency (fcFIR1) and the 
decimation ratio as: 
 
2
1
s
cfinal
cFIR
f
f
f
⋅
=
  
(8) 
 
cfinal
s
dec
s
f
f
f
f
dec ratio
⋅
=
=
2
  
(9) 
103
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-208-0
SENSORDEVICES 2012 : The Third International Conference on Sensor Device Technologies and Applications

The obtained filtered voltage signals are then real time 
manipulated to evaluate magnitude and phase from each 
branch of the circuit: 
{
}
{
}





⋅





⋅
=
+
=
π
2
( )
Im
( )
Re
( )
2
2
sens
f
i
o
o
o
Z
R
V
t
V
t
V
t
V
  
(10) 
{
}
{
( })
Re
( )
tan 1 Im
V t
t
V
o
o
−
ϕ =
 
(11) 
Other data manipulation implemented in the LabView 
software interface also allows to calculate in real-time the 
equivalent resistance and capacitance of the series and 
parallel RC models. 
Figure 5 shows the implemented LabView interface. 
 
 
 
  
  
Saving 
options 
Outputs 
Function generator 
 controls 
NI DAQ controls 
 
Figure 5.  Implemented LabView interface. 
V. 
RESULTS 
Preliminary AC real time tests on synthetic DUTs 
(resistors, capacitors and RC combinations) in different 
measurement ranges and at different frequencies were 
performed connecting the DUT between Vref and a selected 
socket connector. In particular, Vishay precision resistor of 
1MΩ and 10MΩ, 0.005% tolerance and Dale RNX-3/8 
100MΩ resistor, 1% tolerance and capacitor of 100pF and 
1nF were used. 
Figure 6 shows results of performed measurements using 
an R=1MΩ, C=1nF parallel circuit. The figure shows a full 
scale view of the admittance in the Nyquist plane, while the 
zoomed version shows the details of the measurement. As 
can be seen in the figure zoom, a small phase shift caused by 
parasitic effects is present; this could be compensated in post 
processing after the calibration. 
Table I sums up the different configurations for the four 
different selectable ranges of measurements and shows the 
worst effective final resolution experimentally obtained for 
each configuration during the tests performed using different 
DUT circuits. 
 
 
TABLE I.  
SYSTEM PERFORMANCES 
 
Current Range [A] 
 
±7.85µ 
 
±785n 
 
±78.5n 
 
±7.85n 
Full Scale (Y) [S] 
±1.57x10-5 
±1.57x10-6 
±1.57x10-7 
±1.57x10-8 
Minimum 
detectable 
impedance [Ω] 
6.37x104 
6.37x105 
6.37x106 
6.37x107 
Min experimental 
resolution (ENOB) 
(worst case)  
11.3 
9 
11.4 
8.5 
 
In the above table, “Full Scale (Y)” should be considered 
in terms of admittance using a sinusoidal input amplitude of 
1 Vpp; its reciprocal is the “Min readable impedance” and 
“Min experimental resolution (ENOB)” is the minimum 
effective 
final 
resolution 
experimentally 
obtained 
(considering all the experimental tests performed in testing 
conditions) in terms of effective numbers of bits (ENOB); 
 
 
Figure 6.  Example of AC real time admittance measurement of a RC 
parallel circuit in the Nyqist plane, for different input working frequencies. 
 
 
 
104
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-208-0
SENSORDEVICES 2012 : The Third International Conference on Sensor Device Technologies and Applications

 
Figure 7.  Bode plots obtained using the developed system interface and the commercial Novocontrol Alpha-A Impedance analyzer with two different 
parallel RC test circuits. 
TABLE II.  
COMPARISON WITH IMPEDANCE ANALYZER 
 
R=1 MΩ - C=1 nF 
R=10 MΩ - C=100 pF 
 
Acquisition Board 
Impedance Analyzer 
Acquisition Board 
Impedance Analyzer 
 
R 
C 
R 
C 
R 
C 
R 
C 
Fitting error 
0.5% 
0.5% 
0.06% 
0.06% 
0.6% 
0.6% 
0.8% 
0.8% 
Accuracy Error 
0.6% 
0.5% 
0.04% 
0.1% 
1% 
1.1% 
0.04% 
4.3% 
 
Moreover a comparison between the developed system 
interface and specific commercial Novocontrol Alpha-A 
Impedance analyzer, performing 50 points frequency scans 
in the range 10 Hz-2 KHz on different test circuits were 
made in order to analyze measurements accuracy in 
impedance frequency analysis and to calibrate the system. 
Figure 7 shows the results obtained using two different 
parallel RC test circuits. 
As can be seen the response of the commercial system 
seems noisier considering the higher impedance DUT; this 
can be explained considering that in the developed system 
each frequency point is obtained mediating (by the LabView 
software interface) the real time AC measurements of a 
selected number of acquired samples (usually 200 samples), 
thus reducing the final effective bandwidth of about ten 
times and thus reducing the external noise. 
The obtained points are then saved in a text file in the 
ZView format and analyzed with ZView software. Table II 
shows the results in terms of fitting and accuracy errors, 
where the fitting error is directly calculated by ZView 
software taking into account the entire spectrum, where 
accuracy error is calculated using the expression: 
 
100
(%)
⋅
−
=
value
actual
fitted value
actual value
Accuracy Error
  
(12) 
The system shows a fair accuracy, which is sufficient for 
many purposes. The above statement should be taken into 
account considering the much lower price and smaller sizes 
of the developed system in comparison with commercial 
instruments currently used for impedance spectroscopy. 
VI. 
CONCLUSIONS 
A low cost, portable and versatile system, allowing both 
real time and frequency domain impedance characterization 
(as well as amperometric measurements) for sensor 
impedimetric interfaces has been successfully developed and 
tested. According to the tests, the proposed system has 
accuracy that is comparable with laboratory instruments on 
some 
ranges. 
Thus, 
it 
allows 
rapid 
and 
precise 
characterization of sensor interfaces at lower cost without 
highly equipped instrumentation. Moreover, the system 
could be further shrunk using surface mount device (SMD) 
implementation allowing to be directly coupled with sensors 
as readout system. The whole system can be improved and 
optimized implementing the digital filter stage and input 
signal generation by means of an FPGA, allowing to further 
increase the performance in terms of working ranges and 
time response.   
 
 
 
105
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-208-0
SENSORDEVICES 2012 : The Third International Conference on Sensor Device Technologies and Applications

ACKNOWLEDGMENTS 
The research leading to these results has received funding 
from the European Community's Seventh Framework 
Programme 
(FP7/2007-2013) 
under 
grant 
agreement 
NANOFUNCTION 
(n°257375) 
and 
ENIAC 
END 
(n°120214) 
projects. 
The 
authors 
acknowledge 
M. 
Crescentini for helpful suggestions and comments. 
REFERENCES 
[1] J. Li, H. T. Ng, and H. Chen, “Carbon nanotubes and 
nanowires for biological sensing”, Methods in molecular 
biology, vol. 300, 2005, pp. 191-223. 
[2] N. S. Ramgir, Y. Yang, and M. Zacharias, “Nanowire-Based 
Sensors”, Small, vol. 6, 2010, pp. 1705-1722. 
[3] E. Stern et al., “Label-free biomarker detection from whole 
blood”, Nature Nanotechnology, vol. 5, no. 2, 2010, pp.138-
142. 
[4] G. Zheng, F. Patolsky, Y. Cui, W. U. Wang, and C. Lieber, 
“Multiplexed electrical detection of cancer markers with 
nanowire sensor arrays”, Nature Biotechnology, vol. 23, no. 
10, 2005, pp. 1294-1301. 
[5] S. Sorgenfrei et al., “Label-free single-molecule detection of 
DNA-hybridization kinetics with a carbon nanotube field-
effect transistor”, Nature Nanotechnology, vol. 6, no. 2, 2011, 
pp. 126-132. 
[6] M. K. Joo, P. Kang, Y. Kim, G.T. Kim, and S. Kim, “A dual 
analyzer for real-time impedance and noise spectroscopy of 
nanoscale devices”, Rev. Sci Instrum., vol. 82, no. 3, 2011, 
034702. 
[7] F. Patolsky, G. Zheng, and C. Lieber, “Fabrication of silicon 
nanowire devices for ultrasensitive, label-free, real-time 
detection of biological and chemical”, Nature Protocols, vol. 
1, no. 4, 2006, pp. 1711–1724. 
[8] S. Chen, J. G. Bomer, W.G. van der Wiel, E. T. Carlen, and 
A. van den Berg, “Top-Down Fabrication of Sub-30 nm 
Monocrystalline Silicon Nanowires Using Conventional 
Microfabrication”, ACS NANO, vol. 3, no.11, 2009, pp. 
3485-3492. 
[9] S. Ingebrandt et al., “Label-free detection of single nucleotide 
polymorphisms utilizing the differential transfer function of 
field-effect transistors”, Biosensors and Bioelectronics, vol. 
22, no. 12, 2007, pp. 2834-2840. 
[10] Tektronix, 
Inc., 
USA 
Data 
Sheet. 
Available 
at 
http://www.tek.com/signal-generator/afg3000-function-
generator [retrieved: 07, 2012]. 
[11] National Instruments Corporation, Data Sheet. Available at 
http://sine.ni.com/nips/cds/view/p/lang/en/nid/201987 
[retrieved: 07, 2012]. 
[12] S. Deng, G. Jian, J. Lei, Z. Hu, and H. Ju, “A glucose 
biosensor based on direct electrochemistry of glucose oxidase 
immobilized 
on 
nitrogen-doped 
carbon 
nanotubes”, 
Biosensors and Bioelectronics, vol. 25, no. 2, 2009, pp. 373-
377. 
[13] S. Choi, I. Park, Z. Hao, H.Y.N. Holman, and A.P. Pisano, 
“Quantitative studies of long-term stable, top-down fabricated 
silicon nanowire pH sensors”, Applied Physics A, 2012, doi: 
10.1007/s00339-011-6754-9. 
[14] M.P. Lu et al., “Semiconducting single-walled carbon 
nanotubes exposed to distilled water and aqueous solution: 
Electrical measurement and theoretical calculation”, Applied 
Physics Letters, vol. 88, no. 5, 2006, pp. 053114-053114-3. 
[15] O. Knopfmacher et al., “Nernst limit in dual-gated Si-
nanowire FET sensors”, Nano Letters, vol. 10, no. 6, 2010, 
pp.2268-2274. 
[16] Analog Devices, Inc., Norwood, MA, USA Data Sheet. 
Available at http://www.analogdevices.com [retrieved: 07, 
2012]. 
[17] Georgi P. Tolstov, Fourier Series, Courier-Dover, 1976. 
 
 
 
 
106
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-208-0
SENSORDEVICES 2012 : The Third International Conference on Sensor Device Technologies and Applications

