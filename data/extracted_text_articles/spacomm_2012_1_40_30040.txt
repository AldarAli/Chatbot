Nonlinearity Compensation Technique for Common
Band Satellite Channel
Takehiro Ishiguro, Takao Hara, and Minoru Okada
Graduate School of Information Science, Nara Institute of Science and Technology,
8916-5, Takayama-cho, Ikoma, Nara, 630-0192, Japan
Email:{takehiro-i,takao-ha,mokada}@is.naist.jp
Abstract—For effective use of frequency band, carrier su-
perposing (common band) technique has been introduced to
satellite communication systems. Meanwhile the satellite’s Trav-
eling Wave Tube Ampliﬁer (TWTA) is preferred to be operated
near saturation level for power efﬁciency. However nonlinearity
characteristics of TWTA around that level become the cause
of interference for carrier superposing systems. Therefore, in
this paper, a post compensation technique for TWTA nonlinear
distortion is introduced and veriﬁed for practical use of carrier
superposed Point to Point satellite communication system which
adopts interference canceller. Result of the simulation shows it is
possible to drastically reduce the BER degradation at all range,
specially at nonlinear operating point. This paper also reveals
the effect of operating point mismatch that can be caused by
rainfall and other environmental changes.
Index Terms—satellite, common band, nonlinearity compensa-
tion, TWTA
I. INTRODUCTION
Recently, larger transmission capacity for satellite commu-
nication is demanded due to the growing usage like digital
broadcasting and internet. From this, common band technique,
where two carriers are superposed is becoming a considerable
technique as a solution to this problem. In carrier superposing
communication system, outbound and inbound signals that are
sent on two different frequency bands are superposed and sent
in the same frequency band. It is possible to retrieve wanted
signals by cancelling out the unwanted signals, signals sent
from itself, by subtracting replica signals before demodulating
superposed signals. From this, frequency utilization efﬁciency
of two way communication channel composed of outbound
and inbound signals can be twice as before at maximum.
Thus, many researchers, including authors, have investigated
possibilities of carrier superposing technique and is now being
in practical use [1]–[6].
However, carrier superposing technique is highly affected
by channel nonlinearity. From our previous work it is known
that when TWTA (Traveling Wave Tube Ampliﬁer) on satellite
is operated near saturation level, signals are degraded very
seriously and effective frequency usage achieved by carrier
superposing drops down [7]–[9]. To avoid this, authors have
proposed a scheme which adds a nonlinear distortion to
replica signal to emulate TWTA’s nonlinear characteristics for
compensation [8], [10], [11]. The methods shown in these
references were proposed to give same nonlinearity on the
replica signal by digital signal processing at the canceller
as the interference signal is received by the satellite TWTA.
Though this method can only be used in point to multi-point
VSAT system which has an obvious level difference between
outbound and inbound signals, and cannot adopt to more
general type of channel.
Therefore, in this paper, a scheme which linearizes the
received signal by reversely distort received signal based on
AM/AM and AM/PM characteristics of satellite’s TWTA is
proposed. By using this scheme, this paper also proposes a
nonlinearity compensation scheme which is adoptable to gen-
eral type bidirectional satellite communication systems with
any kind of level difference between inbound and outbound
signals. For nonlinearity compensation of satellite TWTA,
there are other types of method like pre-compensation by
adding reverse nonlinear distortion at transmitter. However
this could cause spectrum spreading in outbound signal and
occupies extra band regions. Moreover, it is quite meanless in
the common band network to pre-compensate two individual
signals at the transmitter side of each earth station because
nonlinear distortion is affected to superposed signal. In the
case of nonlinearity compensation at modulator for earth
station HPA, the pre-compensation method is valid [12].
From these reasons, we adopt post-compensation of satellite
TWTA nonlinearity at receiver. Post-compensation method
has not been researched by others. In this research, a case
of adopting carrier superpose technique to Point to Point
bidirectional channel using QPSK modulation is concerned.
A simulation model that is close to the actual system is
built to evaluate the performance of interference canceller and
demodulator.
Our research reveals the effectiveness of proposed post-
compensation scheme. This paper also reveals the effect on
the post compensation when rain fall occurs in down path
of the link or other environment changes since the proposed
scheme may be affected by the change of relation of signal
operating level (power) between satellite nonlinearity and
its compensator in the receiver. This paper has improved
our previous paper [13] by adding detail investigations and
simulating in more realistic transmission path model which
includes ﬁlters between satellite TWTA and receiver.
This paper is organized as follows. Section II explains the
detail of nonlinearity compensation algorithm and simulation
model of carrier superposed Point to Point satellite commu-
nication system. Section III describes the simulation result,
16
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-194-6
SPACOMM 2012 : The Fourth International Conference on Advances in Satellite and Space Communications

evaluate those results, and shows the effectiveness of proposed
scheme. Finally Section IV concludes this paper.
II. CARRIER SUPERPOSED NETWORK WITH
NONLINEARITY COMPENSATION
IB
OB
Satellite
A
B
IB
OB
Conventional
Carrier Superposed
IB+OB
f
f
Fig. 1.
P to P equal level carrier superposed satellite network
Figure 1 shows P-to-P satellite communication system
model used in this research which two opposite carriers have
the same level. In this ﬁgure, the channel is setup between two
earth station A and B. Here, we state the signal carrier from
station A to station B an outbound (OB) signal and signal
carrier from station B to station A an inbound (IB) signal.
In conventional satellite communication systems, OB and
IB signals are transmitted on different frequency band. In
contrary, in carrier superposed system, those signals are su-
perposed and transmitted on same frequency band. From this,
either the outbound or inbound signal’s frequency band will
be free and both carrier frequency can be twice as wide
as before, which means doubling the frequency band usage
efﬁciency. To retrieve wanted signal from received signal,
unwanted signal, in this case self transmitted signal, which
is superposed on wanted signal must be cancelled out. This is
done by subtracting the replica of self transmitted signal from
received signal.
A. Interference Canceller
Interference is cancelled by generating replica of unwanted
signal [4], [6]. In Figure 2, two earth stations transmit the
signals, and the signals to the left and right are denoted by
S1(t) and S2(t) respectively.
Let us assume that the cancellation is performed at the
earth station to the left in the ﬁgure. Since both earth stations
transmit the signal at the same frequency, the received signal is
the sum of S1(t) and S2(t). The received signal at the station
is given by:
r(t) = αS1(t − τ) + βS2(t − ζ) + z(t)
(1)
where α and τ are the round-trip propagation path loss and
round-trip delay between the station and the satellite, and β
and ζ are the propagation path loss and trip time between two
earth stations via satellite. Further, z(t) is an additive Gaussian
noise (AWGN) component.
At the canceller, the transmitted signal, S1(t), is applied
to the delay block whose delay time is set to be the same
τ : One round trip time
OB data
Modulator
delay
τ
S1(t)
Tx 1
S1(t)
αS1(t − τ) + βS2(t − ξ)
S1(t − τ)
α
+
−
βS2(t − ξ)
Satellite
IB data
Mod
S2(t)
Tx 2
Fig. 2.
Concept of interference canceller for superposed transmission.
as the round-trip delay, τ. The output of the delay block
S1(t − τ) is then fed to the variable gain ampliﬁer to adjust
amplitude of the replica and the interference signal. If the
adjustment is perfect, the gain of the variable gain ampliﬁer
is set to be α. The output of the variable gain ampliﬁer is
then subtracted from the received signal. The output of the
interference canceller is given by
u(t) = r(t) − αS1(t − τ) = βS2(t − ζ) + z(t).
(2)
From this equation, we can ﬁnd that the interference signal
S1(t) is successfully cancelled. However, to cancel the inter-
ference from the received signal, it is necessary to estimate
the round-trip delay of the received signal. Here the accuracy
of the delay estimation affects interference suppression per-
formance of the canceller [4], [6].
It is also required to adjust the phase and amplitude of both
OB signal and its replica signal. Our previous paper handles
the solution to these requirements and has shown that they are
performed by applying extended matched ﬁlter with phaser
locked loop.
B. Nonlinearity Compensation Algorithm
In satellite communications, transponder TWTA is prefer-
able to be operated near the saturated region in order to use
its power efﬁciently. However if used in the saturated region,
the signals ampliﬁed there suffer from the effects of inter-
modulation and distortion due to AM/AM and AM/PM prop-
erties. Figure 3 shows a typical nonlinear characteristics of the
TWTA used in ordinary communication satellite. In the case of
carrier superposed system, two or more carriers are ampliﬁed
together. Figure 4 shows an example of vector diagram of
input and output signals through TWTA. Composite signal (a)
of outbound (OB) and inbound (IB) is provided to TWTA and
converted to TWTA output signal (b).
If the power of OB is large enough compared with IB, the
output of TWTA will be almost the same as the TWTA output
when only OB signal is input so to cancel the interference,
nonlinear distorted OB must be fed to the canceller. On the
17
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-194-6
SPACOMM 2012 : The Fourth International Conference on Advances in Satellite and Space Communications

 0
 0.2
 0.4
 0.6
 0.8
 1.0
 
 0.5
 1.0
 1.5
 2.0
 2.5
 3.0
Output Amplitude (AM/AM)
Input Amplitude
Output Phase (AM/PM) [rad]
AM/AM
AM/PM
 1.0
 0.8
 0.6
 0.4
0.2
Fig. 3.
Nonlinear characteristics of TWTA
Fig. 4.
Signal vectors of TWTA input and output
other hand, if the power of IB is not negligible compared with
OB, TWTA output will be different from nonlinear distorted
OB signal and this difference causes interference if simply
fed to the canceller. To avoid this interference, we adopt
post-compensation scheme to compensate nonlinear effects of
TWTA when operated in saturated region.
Amplitude of input vector is distorted according to AM/AM
characteristics [14]
f(r) =
αxr
1 + βxr2
(3)
and phase of input vector is distorted according to AM/PM
characteristics
g(r) =
αφr2
1 + βφr2
(4)
where r is the amplitude of input vector and α, β are TWTA
parameters.
In post-compensation, ﬁrst, the original TWTA input signal
is calculated by the following equation
f −1(y) = −
√
α2x
4β2xy2 − 1
β2x
+
αx
2βxy
(5)
where y is the amplitude of received signal vector. This
equation can be derived from above equation 3. After received
signal’s amplitude is ﬁxed with equation 5, the signal’s phase
is rotated inversely according to equation 4. These processes
of nonlinear compensator are shown in Figure 5. z in the ﬁgure
represents input signal of nonlinear compensator. Linearization
by these methods is actually performed by digital signal
processing at receiver side.
z
|z|
f  (|z|)
-1
g(r)
r  z / |z|
.
phaser
r
theta
AM/AM compensator
AM/PM compensator
Fig. 5.
Block diagram of nonlinear compensator.
Because of the thermal noise added to the receiver’s input
signal and ﬁlters before nonlinearity compensation, the theory
of linearization mentioned above will not be satisﬁed and thus
the signals output from compensator does not exactly match
to the satellite’s input signal. Therefore, overcompensation and
undercompensation might occur and this causes remaining in-
terference after passing the canceller. The simulator explained
next is used to explore the effect of thermal noise and ﬁlter
on nonlinearity compensation.
C. Simulation Model
Transmitter
Satellite
Receiver
Fig. 6.
Block diagram of the simulator
Figure 6 shows the block diagram of simulator used in
this research. The purpose of this simulator is to verify the
performance of nonlinearity compensator. Therefore the syn-
chronization mechanism is not implemented in this simulation
model. The upper path in the ﬁgure represents satellite signal
path and lower path represents the replica signal path inside the
earth station. To make the transfer function of two paths equal,
ﬁlters used in satellite path are also inserted in replica path.
Nonlinearity compensator is inserted before the interference
canceller to ﬁx the distortion that signal receives in TWTA.
Root cosine roll-off ﬁlter is inserted after transmitter’s modu-
lator, TWTA, and before nonlinearity compensator, receiver’s
demodulator. These ﬁlters are for suppression of sideband
signal and noises, and also for timing adjustment that is in
replica signal path.
18
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-194-6
SPACOMM 2012 : The Fourth International Conference on Advances in Satellite and Space Communications

III. SIMULATION RESULTS AND CONSIDERATIONS
Simulation is done using software simulator, based on the
model described in previous section. The parameters for this
simulation is shown in Table I and the parameters for TWTA
nonlinearity is shown in Table II.
TABLE I
SIMULATION PARAMETERS
Modulation Method
QPSK
Modulator Transmit Filter
BW = 1.0, α = 0.35
System
Satellite Transmit Filter
BW = 1.2, α = 0.35
Parameter
Earth Station Receive Filter
BW = 1.2, α = 0.35
Demodulator Receive Filter
BW = 1.0, α = 0.35
Number of Symbol
200, 000
Over Sampling Factor
4
Transmission
DUR (IB/OB ratio)
0dB
Channel
Channel
AWGN
TABLE II
NONLINEARITY PARAMETERS
αx
1.0
βx
0.25
αφ
π/12
βφ
0.25
10-6
10-5
10-4
10-3
10-2
10-1
100
 0
 5
 10
 15
 20
 25
BER
CNR(dB)
ibo=3dB, without comp
ibo=6dB, without comp
ibo=9dB, without comp
ibo=12dB, without comp
ibo=3dB, with comp
ibo=6dB, with comp
ibo=9dB, with comp
ibo=12dB, with comp
Fig. 7.
Effect of changing input back-off on bit error rate
Figure 7 shows bit error rate (BER) curve when changing
backoff. Eight lines on the ﬁgure represents the BER at input
back-off (IBO) = 3,6,9,12dB each with compensation and
without compensation. It is shown on the ﬁgure that when
IBO is small, which means TWTA operation point is more in
nonlinear region, the difference of BER between compensated
signal and non-compensated signal becomes larger. Moreover,
our compensator recovers BER in more linear region like
IBO = 12dB. TWTA’s property shown in Figure 3 has slight
nonlinearity in amplitude gain and certain amount of phase
rotation even if large amount of input back-off is taken.
Therefore the compensator is valid on linear region.
 0
 2
 4
 6
 8
 10
 12
 14
 16
 18
 20
 6
 8
 10
 12
 14
 16
 18
Degradation(dB)
IBO(dB)
Without compensation
With compensation
Fig. 8.
Degradation due to TWTA nonlinearity with and without compen-
sation
Figure 8 shows CNR degradation of BER for each IBO
with compensation and without compensation. From this ﬁgure
it is possible to read the amount of BER improvement at
same IBO by using nonlinearity compensator. For example,
at IBO = 8dB, CNR improvement will be about 3dB which
means signal power can be reduced to half to achieve same
BER using compensator. Another thing that can be read from
this ﬁgure is the IBO difference between when nonlinearity
is compensated or not at the same CNR. For example, when
degradation is 2dB, IBO difference will be about 1.8dB which
means amplitude of TWTA operating point can be shifted to
1.2 times higher. This means the TWTA can be used at higher
operating level by 2dB.
10-5
10-4
10-3
-6
-4
-2
 0
 2
 4
 6
BER
OBO offset(dB)
center IBO=8, CNR=14
center IBO=10, CNR=13
Fig. 9.
BER difference when rain attenuation level changes.
Next the effect of rainfall attenuation is evaluated by inten-
tionally simulating attenuation between satellite and receiver.
Figure 9 shows the change of BER when OBO is offseted
from ideal value. Two lines in the ﬁgure represents the BER
change when centers are IBO = 8dB, CNR = 14.0dB and
IBO = 10dB, CNR = 13.0dB. This result shows that when
19
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-194-6
SPACOMM 2012 : The Fourth International Conference on Advances in Satellite and Space Communications

environment changes and channel attenuation varies for a few
dB, BER varies in the order of 10−4. This means that CNR
degradation will be within about 1 ∼ 2dB, even in the rain
attenuation of ±6dB. If an automatic gain control circuit is
used at the receiver input, the change of compensator input
level due to the rainfall can be compressed within 1dB or so.
Then the value of OBO offset in Figure 9 can be reduced to
1dB order.
IV. CONCLUSION
In this paper, a nonlinearity compensation scheme for car-
rier superposed point to point (P-P) satellite communication
system using interference canceller is proposed. To show the
effectiveness of proposed scheme, a basic software simulation
is performed. The result of simulation shows that it is possible
to signiﬁcantly reduce the degradation caused by nonlinearity
of satellite TWTA. This scheme reduces the distortion of
received signal vector and from this it is adoptable not only
to superposed signals but also to single carrier communication
systems and conventional broadcasting signals. Previously, it
was very challenging to run this scheme, reverse-nonlinear
operation of received signal, on real-time with analog circuit
but now the digital signal processing technologies have made
it much easier. The result also showed that BER degradation
due to operating point mismatch when environment condition
changes.
For future work, we are planning to verify the performance
of proposed nonlinearity compensator with multi-level modu-
lation such as 32APSK (Amplitude Phase Shift Keying) for
more practical use in current satellite systems. In general,
multi-level modulation is operated in high CNR condition,
which means it is more preferable to nonlinearity compensator.
When CNR is large, the difference between compensated
signal and original signal becomes smaller. Authors are also
planning to verify the effect of nonlinearity compensator
from other veiw points like signal constellation, not only
the BER performance shown here. Moreover, authors are
planning hardware experimentation for complete veriﬁcation
of compensator.
REFERENCES
[1] N. Ishida, “Common-band satellite communication system,” Technical
report of IEICE. SAT, vol. 97, no. 556, pp. 107–114, 1998-02-20.
[Online]. Available: http://ci.nii.ac.jp/naid/110003193193/en/
[2] H. Toshinaga, K. Kobayashi, K. Ohata, and H. Kazama, “Interference
cancellation for multimedia satellite communication systems employing
superposed transmission,” Technical report of IEICE. SAT, vol. 100, no.
484, pp. 5–10, 2000-12-01.
[3] M.
D.
Dankberg,
M.
J.
Miller,
and
M.
G.
Mulligan,
“Self-
interference cancellation for two-party relayed communication,” U.S.
Patent 5 596 439, Jan 21, 1997.
[4] T. Hara, M. Ichikawa, M. Okada, and H. Yamamoto, “Canceller design
for carrier super-positioning frequency re-use of vsat satellite commu-
nications,” The transactions of the Institute of Electronics, Information
and Communication Engineers. B, vol. 88, no. 7, pp. 1300–1309, 2005-
07-01.
[5] M. Osato, H. Kobashi, R. Y. Omaki, T. Hara, and M. Okada, “De-
velopment of signal canceller in the carrier super-positioning satellite
networks,” in Proceedings of the Third International Conference on
Wireless and Mobile Communications, ser. ICWMC ’07, 2007, pp. 35–
35.
[6] S. Kuroda, S. Tanaka, S. Naoi, Y. Takeda, R. Miyamoto, T. Hara,
and M. Okada, “Development of an interference canceller in satellite
communications using a multi-level modulation with superposed trans-
mission.” IEICE Transactions, vol. E92-B, no. 11, pp. 3354–3364, 2009-
11.
[7] T. Uratani, R. Miyamoto, T. Hara, and M. Okada, “Performance of an
interference canceller for p-mp satellite networks with nonlinear twta,”
in International Symposium on Communications, Control and Signal
Processing (ISCCSP’08), March 2008.
[8] K.
Kubo,
R.
Miyamoto,
T.
Hara,
and
M.
Okada,
“Nonlinear
compensations
for
interference
canceller
of
super-positioning
satellite
system,”
Technical
report
of
IEICE.
SAT,
vol.
109,
no.
254,
pp.
35–40,
2009-10-22.
[Online].
Available:
http://ci.nii.ac.jp/naid/110007483048/en/
[9] K. Kubo, H. Matsuda, K. Osawa, T. Shimada, S. Naoi, Y. Takeda,
R. Miyamoto, T. Hara, and M. Okada, “Experimental test of frequency
reuse interference canceller in the path containing nonlinear twta,”
Technical report of IEICE. SAT, vol. 109, no. 254, pp. 23–28, 2009-
10-22.
[10] T. Hara, K. Kubo, and M. Okada, “Adaptive back-off nonlinearity com-
pensation for interference canceller in carrier super-positioning satellite
communications,” IEICE Transactions on Communications, vol. 94,
no. 7, pp. 2022–2031, 2011.
[11] T. Hara, H. Matsuda, K. Kubo, and M. Okada, “Performance im-
provement of interference canceller for carrier super-positioning by
the nonlinearity compensation in satellite communications,” in The
Sixth International Conference on Wireless and Mobile Communications
(ICWMC2010), September 2010.
[12] M. Kojima, Y. Suzuki, A. Hashimoto, H. Sujikai, S. Tanaka, T. Kimura,
and K. Shogen, “Non-linear compensation technique based on signal
point error estimation on satellite transmission system,” Technical report
of IEICE. SAT, vol. 108, no. 440, pp. 37–42, 2009-02-19.
[13] H. Matsuda, T. Ishiguro, T. Hara, and M. Okada, “Nonlinearity compen-
sation for super-positioning satellite system with interference canceller,”
in The Seventh Advanced International Conference on Telecommunica-
tions (AICT2011), March 2011.
[14] G. Santella and F. Mazzenga, “A model for performance evaluation in m-
qam-ofdm schemes in prescence of nonlinear distortions,” in Vehicular
Technology Conference, 1995 IEEE 45th, vol. 2, Jul 1995, pp. 830 –834
vol.2.
20
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-194-6
SPACOMM 2012 : The Fourth International Conference on Advances in Satellite and Space Communications

