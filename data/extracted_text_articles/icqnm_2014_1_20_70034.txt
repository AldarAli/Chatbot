Optimal Choice of Basis Transformations
for Entanglement Swapping Based QKD Protocols
Stefan Schauer and Martin Suda
Safety and Security Department
AIT Austrian Institute of Technology GmbH
Vienna, Austria
Email: stefan.schauer@ait.ac.at, martin.suda.fl@ait.ac.at
Abstract—In this article, we discuss the optimality of basis trans-
formations as a security measure for quantum key distribution
protocols based on entanglement swapping. To estimate the
security, we focus on the information an adversary obtains on
the raw key bits from a generic version of a collective attack
strategy. In the scenario described in this article, the application
of general basis transformations serving as a counter measure
by one or both legitimate parties is analyzed. In this context, we
show that the angles, which describe these basis transformations,
can be optimized compared to the application of a Hadamard
operation, which is the standard basis transformation recurrently
found in literature. As a main result, we show that the adversary’s
information can be reduced to an amount of IAE ≃ 0.20752
when using a single basis transformation and to an amount of
IAE ≃ 0.0548 when combining two different basis transforma-
tions. This is less than half the information compared to other
protocols using a Hadamard operation and thus represents an
advantage regarding the security of entanglement swapping based
protocols.
Keywords–quantum key distribution; optimal basis transforma-
tions; security analysis; entanglement swapping
I.
INTRODUCTION
One of the major applications of quantum mechanics is
quantum key distribution (QKD). In the last three decades,
QKD protocols have been studied at length in theory and
in practical implementations [1]–[8]. Most of these protocols
focus on prepare and measure schemes, where single qubits are
in transit between the communication parties Alice and Bob.
The security of these protocols has been discussed in depth
and security proofs have been given for example in [9]–[11].
In addition to these prepare and measure protocols, several
protocols based on the phenomenon of entanglement swapping
have been introduced [12]–[17]. Entanglement swapping has
been introduced by Bennett et al. [18], Zukowski et al. [19]
as well as Yurke and Stolen [20], respectively. It provides the
unique possibility to generate entanglement from particles that
never interacted in the past. In the aforementioned protocols,
entanglement swapping is used to obtain correlated measure-
ment results between the legitimate communication parties,
Alice and Bob. In other words, each party performs a Bell
state measurement and due to entanglement swapping their
results are correlated and further on used to establish a secret
key.
A basic technique to secure a QKD protocol is to use a
basis transformation, usually a Hadamard operation, to make it
easier to detect an adversary. This is implemented, for example,
in the prepare and measure schemes described in [1] and [3]
but also in QKD schemes based on entanglement swapping
(e.g., [13] [16] [21]). In this article, we analyze the application
of a general basis transformation Tx, deﬁned by the angles θ
and φ (cf. (2)), to secure entanglement swapping based QKD
protocols (cf. Figure 1). In the course of that, we are going
to identify which values for θ and φ are optimal such that an
adversary has only a minimum amount of information on the
secret raw key.
Although basis transformations have been used as means of
improving the security of QKD protocols based on entangle-
ment swapping, this security measure has just been discussed
on the surface so far. It has only been shown that these
protocols are secure against intercept-resend attacks and basic
collective attacks (cf. for example [12] [13] [16]). Therefore,
we will analyze the simulation attack, a general version of a
collective attack, which is based on the following idea [22]: the
adversary Eve tries to ﬁnd a multi-qubit state, which preserves
the correlation between the two legitimate parties. Further, she
introduces additional qubits to distinguish between Alice’s and
Bob’s respective measurement results (cf. also Figure 2). If
she is able to ﬁnd such a state, Eve stays undetected during
her intervention and is able to obtain a certain amount of
information about the key. Such a multi-qubit state would be
|δ⟩ = 1
2

|Φ+⟩|Φ+⟩|ϕ1⟩ + |Φ−⟩|Φ−⟩|ϕ2⟩
|Ψ+⟩|Ψ+⟩|ϕ3⟩ + |Ψ−⟩|Ψ−⟩|ϕ4⟩

P RQST U
(1)
where the |ϕi⟩ are the additional systems introduced by Eve.
To perfectly distinguish between Alice’s and Bob’s results,
these state |ϕi⟩ have to be pairwise orthogonal. Thus, she is
able to eavesdrop Alice’s and Bob’s measurement results and
obtains full information about the classical raw key generated
out of them. A detailed discussion of this attack strategy can
be found in [22].
In the next section, we look in detail at the general
deﬁnition of basis transformations and their effect onto Bell
states and entanglement swapping. Using these deﬁnitions, we
discuss in the following sections the effects on the security
of entanglement swapping based QKD protocols. Therefore,
we look at the application of a general basis transformation
by one communication party in Section III and at the appli-
cation of two different basis transformations by each of the
communication parties in Section IV. In the end, we sum up
the implications of the results on the security of entanglement
based QKD protocols.
8
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-380-3
ICQNM 2014 : The Eighth International Conference on Quantum, Nano/Bio, and Micro Technologies

Figure 1. Sketch of a standard setup for an entanglement swapping based
QKD protocol. Qubits 2 and 3 are exchanged (cf. picture (2)) and a basis
transformation Tx is applied on qubit 1 and inverted by using Tx qubit 2.
II.
BASIS TRANSFORMATIONS
In QKD, the most common way to detect the presence
of an adversary is to use a random application of a basis
transformation by one of the legitimate communication parties.
This method can be found in prepare and measure protocols
(e.g., in [1] or [3]) as well as entanglement swapping based
protocols (e.g., in [13] [16] or the improved version of the
protocol in [17]). The idea is to randomly alter the initial state
to make it impossible for an adversary to eavesdrop the in-
formation transmitted without introducing a certain error rate,
i.e., without being detected. The operation most commonly
used in these protocols is the Hadamard operation, which is
a transformation from the Z- into the X-basis. In general,
a transformation Tx from the Z basis into the X-basis can
be described as a rotation about the X-axis by some angle θ
combined with two rotations about the Z-axis by some angle
φ, i.e.,
Tx

addresses the angle φ, i.e., the rotation about the Z-axis. In
the security discussions in [24], the angle φ is ﬁxed at π/2
for reasons of simplicity. That means, the rotation about the
Z-axis is constant at an angle of π/2 such that only the angle
θ can be chosen freely.
In this section and the next one, we want to extend the re-
sults from [24] [25] by applying general basis transformations,
which means Alice and Bob are able to choose both angles θ
and φ in (2) freely. We are at ﬁrst looking only on one party
performing a basis transformation on the respective qubits
and in the next section on two different basis transformations
performed by each of the parties. For each scenario we will
show, which values for θ and φ are optimal to give an adversary
the least information about the raw key bits. In the course of the
two scenarios, we will denote Alice’s operation as Tx

Figure 3. Error probability ⟨Pe⟩ depending on θA and φA
Accordingly, Eve’s mutual information on the raw key is
slightly above 20%, i.e., IAE ≃ 0.20852. Hence, the security
of the protocol is drastically increased using a general basis
transformation compared to the application of a Hadamard
operation.
IV.
COMBINED APPLICATION OF GENERAL BASIS
TRANSFORMATIONS
In the previous section, we discussed the application of one
general basis transformation Tx

Figure 5. Error probability ⟨Pe⟩ depending on θA and θB. The remaining
parameters φA and φB are ﬁxed at π/4.
example, using
θA ≃ −0.18865π
θB ≃ 0.42765π
φA ≃ −0.22405π
φB ≃ 0.36218π.
(21)
The maximal Shannon entropy can also be reached using other
values but they are not as nicely distributed as in the case of
the average error probability.
Looking again at set of values for θ{A,B} and φ{A,B},
which are more suitable for a physical implementation than
the values mentioned above, one possibility for Alice and Bob
is to choose
θA = −3π
16
θB = 7π
16
φA = −π
4
φB = 3π
8
(22)
leading to an almost optimal Shannon entropy H ≃ 0.9399 and
a average respective error probability ⟨Pe⟩ ≃ 0.39288. In this
context, more suitable for a physical implementation means
that a transformation about an angle of π/4 or 3π/8 is easier
to realize in a laboratory than an angle of 0.42765π. Keeping
φA and φB ﬁxed – as already discussed in the previous section
– such that
θA = 3π
16
θB = 7π
16
φA = π
4
φB = π
4
(23)
the same average error probability ⟨Pe⟩ ≃ 0.39288 and a
slightly smaller Shannon entropy H ≃ 0.91223 compared to
the previous values are achieved. Hence, we see that using a set
of parameters more suitable for a physical implementation still
results in a high error rate and leaves Eve’s mutual information
IAE below 10%.
V.
RESULTS AND IMPLICATIONS
The results presented in the previous sections have direct
implications on the security of QKD protocols based on
entanglement swapping. Where in some QKD protocols [13]
[16] [17] a random application of a Hadamard operation is used
to detect an eavesdropper and secure the protocol, the above
results indicate that the Hadamard operation is not the optimal
choice. Using the Hadamard operation leaves an adversary
with a mutual information IAE = 0.5 and an expected error
probability ⟨Pe⟩ = 0.25 (cf. Table I), which is comparable to
standard prepare and measure protocols [1]–[3].
Figure 6. Shannon entropy H of the raw key depending on θA and θB. The
remaining parameters φA and φB are ﬁxed at π/4.
Giving Alice an increased degree of freedom, i.e., choosing
both θA and φA freely, she is able to further decrease the
adversary’s information about the raw key bits. By shifting
φA from π/2 to π/4 and θA from π/2 or π/4 to 3π/8, the
adversary’s information is reduced to IAE ≃ 0.208 (cf. (15)).
This is a reduction by almost 60% compared to QKD schemes
described in [1]–[3] [13] [17] and more than 50% compared to
the combined application of two different basis transformations
(cf. also [24] [25]). At the same time, the expected error
probability is increased by one third to ⟨Pe⟩ ≃ 0.333 (cf. (13)).
Hence, an adversary does not only obtain fewer information
about the raw key bits but also introduces more errors and
therefore is easier to detect.
Following these arguments, the best strategy for Alice and
Bob is to apply different basis transformations at random to
reduce the adversary’s information to a minimum. As already
pointed out above, this minimum of IAE ≃ 0.0548 is reached
with a rather odd conﬁguration for θ{A,B} and φ{A,B} as
described in the previous section. Hence, it is important to look
at conﬁgurations more suitable for physical implementations,
i.e., conﬁgurations of θ{A,B} and φ{A,B} described by simpler
fractions of π as given in (22) and (23). In this case, we
showed that φ{A,B} can be ﬁxed at φA = φB = π/4 and
with θA = 3π/16 and θB = 7π/16 almost maximal values
can be achieved resulting in IAE ≃ 0.088 and ⟨Pe⟩ ≃ 0.393
(cf. (23) and also Table I).
Regarding physical implementations, another – even sim-
pler – conﬁguration can be found, involving only π/2 and π/4
rotations (cf. Table I). In this case, θA = 0, φA = π/4 and
θB = φB = π/2, which leaves the expected error probability
at ⟨Pe⟩ ≃ 0.334. The adversary’s information is nowhere near
the minimum but still rather low at IAE = 0.125.
In terms of security, these results represent a huge advan-
tage over QKD protocols based on entanglement swapping
[13], [16], [17] or standard prepare and measure protocols [1]–
[3]. As pointed out, such protocols usually have an expected
error probability of ⟨Pe⟩ = 0.25 and a mutual information
IAE = 0.5. Due to the four degrees of freedom, the error rate
is between one third (⟨Pe⟩ ≃ 0.334) and more than one half
(⟨Pe⟩ = 0.411) higher in the scenarios described here than
in the standard protocols, which makes it easier to detect an
adversary.
12
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-380-3
ICQNM 2014 : The Eighth International Conference on Quantum, Nano/Bio, and Micro Technologies

TABLE I. OVERVIEW OF THE ERROR RATE ⟨PE⟩ AND EVE’S
INFORMATION IAE ON THE RAW KEY BITS FOR DIFFERENT
VALUES OF θA,B AND φA,B.
φA = 0
φA = π
2
φA = π
4
φB = 0
θA = 0, θB = 0
⟨Pe⟩ = 0
IAE = 1
θA = π
2 , θB = 0
⟨Pe⟩ = 0.25
IAE = 0.5
θA = 3π
8 , θB = 0
⟨Pe⟩ ≃ 0.333
IAE ≃ 0.208
φB = π
2
θA = π
2 , θB = π
4
⟨Pe⟩ = 0.25
IAE ≃ 0.45
θA = 0, θB = π
2
⟨Pe⟩ ≃ 0.40625
IAE = 0.125
φB = π
4
θA = 3π
16 , θB = 7π
16
⟨Pe⟩ = 0.393
IAE = 0.088
VI.
CONCLUSION
In this article, we discussed the effects of basis transfor-
mations on the security of quantum key distribution proto-
cols based on entanglement swapping. We showed that the
Hadamard operation, a transformation from the Z- into the
X-basis often used in prepare and measure protocols, is not
optimal in connection with entanglement swapping based pro-
tocols. Starting from a general basis transformation described
by two angles θ and φ, we inspected the effects on the
security when the adversary follows a collective attack strategy.
We showed that the application of a basis transformation by
one of the communication parties decreases the adversary’s
information to about IAE ≃ 0.2075, which is less than half of
the information compared to an application of the Hadamard
operation. At the same time, the average error probability
introduced by the presence of the adversary increases to
⟨Pe⟩ = 1/3. Hence, the application of one general basis trans-
formation is more effective, i.e., reveals even less information
to the adversary, than the application of a simpliﬁed basis
transformation as given in [24] [25]. A combined application
of two different basis transformations further reduces the
adversary’s information to about IAE ≃ 0.0548 at an average
error probability of slightly more than 0.41.
Since the conﬁguration of the angles θ and φ to reach
these maximal values is not very suitable for a physical
implementation, we also showed that these maximal values
are almost reached with more convenient values for θ and φ.
In this case, the adversary’s information is still IAE < 0.1 with
an average error rate ⟨Pe⟩ ≃ 0.393 for a combined application
of two basis transformations.
These results have a direct impact on the security of such
protocols. Due to the reduced information of an adversary and
the high error probability introduced during the attack strategy,
Alice and Bob are able to accept higher error thresholds
compared to standard entanglement-based QKD protocols.
REFERENCES
[1]
C. H. Bennett and G. Brassard, “Public Key Distribution and Coin
Tossing,” in Proceedings of the IEEE International Conference on
Computers, Systems, and Signal Processing.
IEEE Press, 1984, pp.
175–179.
[2]
A. Ekert, “Quantum Cryptography Based on Bell’s Theorem,” Phys.
Rev. Lett., vol. 67, no. 6, 1991, pp. 661–663.
[3]
C. H. Bennett, G. Brassard, and N. D. Mermin, “Quantum Cryptography
without Bell’s Theorem,” Phys. Rev. Lett., vol. 68, no. 5, 1992, pp. 557–
559.
[4]
D. Bruss, “Optimal Eavesdropping in Quantum Cryptography with Six
States,” Phys. Rev. Lett, vol. 81, no. 14, 1998, pp. 3018–3021.
[5]
A. Muller, H. Zbinden, and N. Gisin, “Quantum Cryptography over 23
km in Installed Under-Lake Telecom Fibre,” Europhys. Lett., vol. 33,
no. 5, 1996, pp. 335–339.
[6]
A. Poppe et al., “Practical Quantum Key Distribution with Polarization
Entangled Photons,” Optics Express, vol. 12, no. 16, 2004, pp. 3865–
3871.
[7]
A. Poppe, M. Peev, and O. Maurhart, “Outline of the SECOQC
Quantum-Key-Distribution Network in Vienna,” Int. J. of Quant. Inf.,
vol. 6, no. 2, 2008, pp. 209–218.
[8]
M. Peev et al., “The SECOQC Quantum Key Distribution Network in
Vienna,” New Journal of Physics, vol. 11, no. 7, 2009, p. 075001.
[9]
N. L¨utkenhaus, “Security Against Eavesdropping Attacks in Quantum
Cryptography,” Phys. Rev. A, vol. 54, no. 1, 1996, pp. 97–111.
[10]
——, “Security Against Individual Attacks for Realistic Quantum Key
Distribution,” Phys. Rev. A, vol. 61, no. 5, 2000, p. 052304.
[11]
P. Shor and J. Preskill, “Simple Proof of Security of the BB84 Quantum
Key Distribution Protocol,” Phys. Rev. Lett., vol. 85, no. 2, 2000, pp.
441–444.
[12]
A. Cabello, “Quantum Key Distribution without Alternative Measure-
ments,” Phys. Rev. A, vol. 61, no. 5, 2000, p. 052312.
[13]
——, “Reply to ”Comment on ”Quantum Key Distribution without
Alternative Measurements””,” Phys. Rev. A, vol. 63, no. 3, 2001, p.
036302.
[14]
——, “Multiparty Key Distribution and Secret Sharing Based on
Entanglement Swapping,” quant-ph/0009025 v1, 2000.
[15]
F.-G. Deng, G. L. Long, and X.-S. Liu, “Two-step quantum direct
communication protocol using the Einstein-Podolsky-Rosen pair block,”
Phys. Rev. A, vol. 68, no. 4, 2003, p. 042317.
[16]
D. Song, “Secure Key Distribution by Swapping Quantum Entangle-
ment,” Phys. Rev. A, vol. 69, no. 3, 2004, p. 034301.
[17]
C. Li, Z. Wang, C.-F. Wu, H.-S. Song, and L. Zhou, “Certain Quantum
Key Distribution achieved by using Bell States,” International Journal
of Quantum Information, vol. 4, no. 6, 2006, pp. 899–906.
[18]
C. H. Bennett et al., “Teleporting an Unknown Quantum State via Dual
Classical and EPR Channels,” Phys. Rev. Lett., vol. 70, no. 13, 1993,
pp. 1895–1899.
[19]
M. Zukowski, A. Zeilinger, M. A. Horne, and A. K. Ekert, “”Event-
Ready-Detectors” Bell State Measurement via Entanglement Swap-
ping,” Phys. Rev. Lett., vol. 71, no. 26, 1993, pp. 4287–4290.
[20]
B. Yurke and D. Stolen, “Einstein-Podolsky-Rosen Effects from Inde-
pendent Particle Sources,” Phys. Rev. Lett., vol. 68, no. 9, 1992, pp.
1251–1254.
[21]
Y.-S. Zhang, C.-F. Li, and G.-C. Guo, “Comment on ”Quantum Key
Distribution without Alternative Measurements”,” Phys. Rev. A, vol. 63,
no. 3, 2001, p. 036301.
[22]
S. Schauer and M. Suda, “A Novel Attack Strategy on Entanglement
Swapping QKD Protocols,” Int. J. of Quant. Inf., vol. 6, no. 4, 2008,
pp. 841–858.
[23]
M. A. Nielsen and I. L. Chuang, Quantum Computation and Quantum
Information.
Cambridge University Press, 2000.
[24]
S. Schauer and M. Suda, “Security of Entanglement Swapping QKD
Protocols against Collective Attacks,” in ICQNM 2012 , The Sixth
International Conference on Quantum, Nano and Micro Technologies.
IARIA, 2012, pp. 60–64.
[25]
——, “Application of the Simulation Attack on Entanglement Swapping
Based QKD and QSS Protocols,” International Journal on Advances in
Systems and Measurements, vol. 6, no. 1&2, 2013, pp. 137–148.
13
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-380-3
ICQNM 2014 : The Eighth International Conference on Quantum, Nano/Bio, and Micro Technologies

