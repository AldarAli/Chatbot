Efficient Packet Scheduling Schemes with Built-in Fairness Control for  
Multiantenna Packet Radio Systems 
 
 
Stanislav Nonchev and Mikko Valkama 
Tampere University of Technology 
 Department of Communications Engineering 
P.O. Box 553, FI-33101, Tampere, FINLAND 
Email: stanislav.nonchev@tut.fi, mikko.e.valkama@tut.fi  
 
 
 
Abstract – In this article, we propose fairness-oriented dual 
stream 
multiple-input 
multiple-output 
(MIMO) 
packet 
scheduling schemes with efficient utilization of channel quality 
indicator (CQI) feedback for emerging multiantenna packet 
radio systems. In general, multiuser multiantenna transmission 
schemes allow users to be scheduled on different parallel streams 
on the same time-frequency resource. Based on that, 
implementations of more intelligent scheduling schemes that are 
aware of the instantaneous state of the radio channel require 
utilization of time, frequency and spatial domain resources in an 
efficient manner. Stemming from the earlier advanced 
proportional fair (PF) scheduler studies, we extend the 
developments to dual stream MIMO packet radios with fairness-
oriented scheduling metric and practical feedback reporting 
mechanisms, including the effects of mobile measurement and 
estimation errors, reporting delays, and CQI quantization and 
compression. Furthermore, we investigate the resulting fairness 
distribution among users together with the achievable radio 
system performance in terms of throughput and coverage, by 
simulating practical OFDMA cellular system environment with 
MIMO functionality in Micro and Macro cell scenarios. As a 
concrete example, we demonstrate that by using the proposed 
fairness-oriented multiuser scheduling schemes, significant 
coverage improvements in the order of 40% can be obtained at the 
expense of only 16% throughput loss for all feedback reporting 
schemes. Furthermore, the user fairness is also greatly increased, 
by more than 30%, when measured using Jain’s fairness index.  
 
Keywords - radio resource management; packet scheduling; 
proportional fair; channel quality feedback; fairness; coverage; 
throughput; multiantenna 
I. INTRODUCTION 
The advancement of new radio technologies for beyond 
third generation (3G) cellular systems continues steadily. 
This includes, e.g., third generation partnership project 
(3GPP) long term evolution (LTE) [2], worldwide 
interoperability for microwave access (WiMAX) [3] and the 
work in various research projects, like WINNER [4]. Some 
common elements in most of these developments are 
orthogonal frequency division multiple access (OFDMA) 
based air interface, operating bandwidths of at least 10-20 
MHz, and the exploitation of multiple-input multiple-output 
(MIMO) techniques and advanced channel-aware packet 
scheduling principles [2]. MIMO in terms of spatial 
multiplexing (SM), possibly combined with pre-coding, is 
considered as one core physical layer technology towards 
increased link spectral efficiencies compared to existing 
radio systems. In addition, it also provides the packet 
scheduler (PS) with an extra degree of freedom (spatial 
domain), by offering a possibility to multiplex multiple data 
streams of one or more users on the same physical time-
frequency resource. The two principal concepts widely 
analyzed in literature (see, e.g., [5]-[6] and the references 
therein) in this context are single user (SU) and multiuser 
(MU) MIMO. The SU-MIMO approach allows only the 
streams of one individual UE to be scheduled at the same 
time-frequency resource block (RB), while MU-MIMO 
provides additional flexibility so that streams of multiple 
users can be scheduled over the same time-frequency RB. 
Assuming relatively accurate channel state feedback in 
terms of channel quality indicator (CQI) reports from 
mobile stations (MS) to base station (BS), together with fast 
link adaptation mechanisms, advanced channel-aware 
packet scheduling schemes have major impact on the 
system-level performance optimization in terms of, e.g., 
throughput 
and 
coverage. 
Practical 
CQI 
reporting 
mechanisms in this context are described, e.g., in [7]-[13]. 
Another important feature of multiuser radio systems related 
to scheduling, in addition to throughput and coverage, is 
fairness, implying that also users with less favorable channel 
conditions should anyway be given some reasonable access to 
the radio spectrum. This is especially important in serving 
users at, e.g., cell edges in cellular networks.  
Recently, multiantenna oriented packet scheduling 
principles have started to be investigated in the literature, 
see, e.g., [14]-[19]. New scheduling algorithms have been 
proposed and their performance been evaluated in different 
simulator environments in [1], [16]-[19]. In this article, we 
concentrate on the proportional fair (PF) principle, which in 
general offers an attractive balance between cell throughput 
and user fairness, and extend it with spatial domain 
functionality for the needs of SU- and MU-MIMO 
operation. More specifically, we extend our earlier studies 
182
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

in [1], [18]-[19] on algorithm development by deploying 
SM functionality to frequency domain (FD) PF scheduling 
schemes that can efficiently utilize the provided feedback 
information from all the user equipments (UEs), in terms of 
quantized CQI reports. A new packet scheduler is proposed, 
called MIMO modified PF (MMPF), with built-in fairness 
control in its scheduling metric, which is shown to improve 
the system performance considerably, in terms of cell-edge 
coverage and overall scheduling fairness, when compared to 
existing reference schedulers. For practicality, all the 
performance evaluations are carried out in 3GPP LTE system 
context, covering both Micro and Macro Cell scenarios, and 
conforming to the 3GPP evaluation criteria [2]. The used 
radio system performance measures are cell throughput 
distribution, average throughput, cell-edge coverage and 
Jain’s fairness index [21].  
In general, while the increased flexibility of channel-
aware 
scheduling 
can 
offer 
great 
performance 
enhancements, compared to fixed resource allocation, it also 
has some practical disadvantages. This includes, e.g., 
relatively higher scheduling complexity, in terms of 
scheduling metric calculations and increased signaling 
overhead to facilitate CQI reporting. Keeping these at 
reasonable levels requires thus some constraints on the 
scheduling algorithm, so for simplicity we assume here that 
only one MIMO mode (SU or MU) and fixed modulation 
and coding scheme (MCS) is allowed per user within one 
time-frequency scheduling element (RB). For simplicity, we 
also assume that the BS as well as all the UE’s are equipped 
with 2 antennas (dual antenna TX and RX). 
The rest of the article is organised as follows: Section II 
describes the MIMO channel-aware scheduling principles 
and the proposed fairness-oriented scheduling scheme. 
Section III, in turn, gives an overview of different feedback 
reporting schemes in packet scheduling context. The overall 
radio system model and simulation assumptions are then 
presented and discussed in Section IV. The corresponding 
simulation results and analysis are presented in Section V, 
while the conclusions are drawn in Section VI.  
II. CHANNEL-AWARE MIMO SCHEDULING 
In general, the task of the packet scheduler is to select 
the most suitable users to access the overall radio resources 
at any given time window, based on some selected priority 
metric calculations. Typically the scheduler also interacts 
with other radio resource management (RRM) units such as 
link adaptation (LA) and Hybrid ARQ (HARQ) manager as 
shown in Figure 1. The scheduling decision is based on 
received users’ signaling information in terms of 
acknowledgements 
(ACK/NACK) 
and 
channel 
state 
information (CQI reports) per given transmission time 
interval (TTI) [9] and per frequency domain physical 
resource block (PRB). More specifically, in this article in 
multiantenna radio system context, we assume that both 
single stream and dual stream CQIs are reported to BS by 
each UE. Depending on the selected CQI reporting scheme, 
the accuracy and resolution of the channel quality 
information can then easily differ considerably [7], [8], [11], 
[12], as will be explained in Section III. Moreover, the CQI 
information is not necessarily available for all the individual 
subcarriers but more likely for certain groups of subcarriers 
only [13], [22], [23]. Based on this information, the BS 
scheduler then decides whether the particular time-
frequency resource is used for (i) transmitting only one 
stream to a specific UE, (ii) two streams for a specific UE 
(SU-MIMO) or (iii) two streams to two different UEs (MU-
MIMO, one stream per UE). 
 
HARQ info
Requests
Decisions
 
Figure 1: Joint time- and frequency-domain scheduling process. 
A. Proposed Scheduler at Principal Level 
In general, we use the well-known two-step PF approach 
with extended functionality in extra spatial dimension to 
enable MIMO operation [1], [5], [18]-[19]. The first step is 
time-domain (TD) scheduling in which the scheduler selects 
a sub-group of users in each TTI, called scheduling 
candidate set, based on the full bandwidth channel state 
information. More specifically, the TD step selects those 
IBUFF UE’s (out of the total number of UE’s, say ITOT) whose 
total instantaneous throughput, per TTI, calculated over the 
full bandwidth is highest [20]. In this stage, we also take the 
different spatial multiplexing possibilities (single stream, 
dual stream SU, dual stream MU) into account, in 
calculating all the possible full bandwidth reference 
throughputs.  
The second step is then frequency-domain (FD) / 
spatial-domain (SD) scheduling in which the scheduler first 
reserves the needed PRB’s for pending re-transmissions (on 
one stream-basis only for simplicity) and the rest available 
PRB’s are allocated to the selected UE’s of the scheduling 
candidate set obtained from the TD step. The actual metric 
in FD/SD allocation is based on the PRB-level and stream-
wise channel state information, and the corresponding 
183
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

throughput calculations, as will be explained in more details 
below.  
B.  Exact Scheduling Metrics 
Here we describe the actual scheduling metrics used in 
ranking users in the TD scheduling step as well as mapping 
the users to FD/SD resources in the second step. First a 
multistream extension of “ordinary” PF is described in sub-
section II.B.1, used as a reference in the performance 
simulations, and then the actual proposed modified metric 
with increased fairness-control is described in sub-section 
II.B.2. 
1) Multistream Proportional Fair:  
For the PF scheduler, scheduling decision per TTI is 
based on the following priority metric  
 
, ,
, ,
( )
arg max
( )
i k s
i k s
i
i
R
n
T n
γ
⎧
⎫
⎪
⎪
⎪
⎪
=
⎨
⎬
⎪
⎪
⎪
⎪
⎩
⎭
 
(1) 
in which Ri,k.s(n) is the estimated instantaneous throughput 
of user i at sub-band k on stream s for the  time instant (TTI) 
n (calculated based on the CQI reports through, e.g., EESM 
mapping [1]). Ti(n), in turn, is the average delivered 
throughput to the UE i during the recent past and is 
calculated  by  
 
1
1
( )
1
(
1)
(
1)
i
i
i
c
c
T n
T n
R n
t
t
⎛
⎞⎟
= ⎜
−
−
+
−
⎟
⎜
⎟
⎜⎝
⎠
 
(2) 
Here tc controls the averaging window length over which 
the average delivered throughput is calculated [11]-[15] and 
Ri(n-1) is the actually delivered throughput to user i at 
previous TTI n-1, calculated over all sub-bands k and 
possible streams s. In general, 1/tc is also called the 
forgetting factor.  
Considering the previous TD and FD/SD steps described 
earlier in Section II.A, the above metrics are used as 
follows: 
a) TD: Metric (1) is evaluated over the full 
bandwidth and for different stream options to rank the ITOT 
UE’s. Out of these, IBUFF < ITOT UE’s with highest metric 
are picked to the following FD/SD stage. In the following, 
this subset is called scheduling candidate set (SCS), and is 
denoted by ( )
Ω n
. 
b) FD/SD: The access to individual PRB and 
stream(s) is granted for the user(s) belonging to the above 
SCS with the highest metric (1) evaluated for the particular 
PRB and stream at hand. 
2) Modified Multistream Proportional Fair (MMPF):  
Stemming from the earlier work in [1], [11], the 
following modified multistream PF metric is proposed: 
 
1
2
, ,
, ,
( )
( )
arg max
( )
( )
i k s
i
i k s
ave
i
i
tot
CQI
n
T n
CQI
n
T
n
α
α
γ
−
⎧
⎫
⎛
⎞
⎪
⎪
⎛
⎞
⎪
⎪
⎟
⎟
⎜
⎜
=
⎟
⎨
⎟
⎬
⎜
⎜
⎟
⎟
⎜
⎪⎜
⎪
⎝
⎠
⎝
⎠
⎪
⎪
⎩
⎭
  (3) 
Here, α1 and α2 are scheduler optimization parameters 
ranging basically from 0 to infinity, CQIi,k,s is the CQI of 
user i at PRB k and stream s, and CQIave
i is the average CQI 
of user i calculated using  
 
(
)
, ,
1
1
1
( )
1
(
1)
1
1
1
( )
TOT
TOT
avg
avg
i
i
c
c
TOT
TOT
S
K
i k s
s
k
CQI
n
CQI
n
t
t K
S
CQI
n
=
=
=
−
−
+
∑ ∑
  (4) 
In above, KTOT is the total number of available PRB’s while 
STOT denotes the maximum number of streams which is here 
two (max two streams). In (3), Ttot(n) is the average 
delivered throughput (during the recent past) to all IBUFF 
users served by the BS and is calculated as 
    
(
1)
( )
1
1
1
1
(
1)
(
1)
tot
tot
i
c
c
BUFF i
n
T
n
T
n
T n
t
t I
∈Ω
−
=
⎛
⎞⎟
⎜ −
−
+
−
⎟
⎜
⎟
⎜⎝
⎠
∑
  (5) 
Intuitively, the proposed scheduling metric in (3) is 
composed of two elements affecting the overall scheduling 
decisions. The first dimension measures in a stream-wise 
manner the relative instantaneous quality of the individual 
user’s radio channels against their own average channel 
qualities while the second dimension is related to measuring 
the achievable throughput of individual UE’s against the 
corresponding average throughput of scheduled users. In 
this way, and by understanding the power coefficients α1 
and α2 as additional adjustable parameters, the exact 
scheduler statistics can be tuned and controlled to obtain a 
desired balance between the throughput and fairness. This 
will be demonstrated later using radio system simulations. 
Considering finally the actual TD and FD/SD steps 
described at general level in Section II.A, the same 
approach as in sub-section II.B.1 is deployed but the metrics 
(1)-(2) are of course here replaced by the metrics in (3)-(5). 
III. FEEDBACK REPORTING PROCESS 
The overall channel state reporting process between 
UE’s and BS is illustrated in Figure 2. Within each time 
window of length tr, each mobile sends channel quality 
indicator (CQI) reports to BS, formatted and possibly 
compressed, with a reporting delay of td seconds [7] , [8], 
[11], [12]. Each report is naturally subject to errors due to 
imperfect decoding of the received signal.  In general, the 
CQI reporting frequency-resolution has a direct impact on 
the achievable multiuser frequency diversity and thereon to 
184
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

the overall system performance and the efficiency of radio 
resource management, as described in general, e.g., in [12]. 
In our studies here, the starting point (reference case) is that 
the CQI reports are quantized SINR measurements across 
the entire bandwidth (wideband CQI reporting), to take 
advantage of the time and frequency variations of the radio 
channels for the different users. Then also alternative 
reduced feedback schemes are described and evaluated, as 
discussed below.  
 
 
Figure 2: Reporting mechanism between UE and BS. 
A. Full CQI Reporting 
In a general OFDMA radio system, the overall system 
bandwidth is assumed to be divided into v CQI 
measurement blocks. Then quantizing the CQI values to say 
q bits, the overall full CQI report size is  
 
Sfull
q
v
=
×
 
(6) 
bits which is reported by every UE for each TTI [2]-[4], 
[12]. In case of LTE, with 10 MHz system bandwidth and 
grouping 2 physical resource blocks into 1 measurement 
block, it follows that v = 25. Assuming further that 
quantization is carried with q = 5 bits, then each UE is 
sending 25x5 = 125 bits for every 1ms (TTI length). 
B. Best-m CQI Reporting 
One simple approach to reduce the reporting and 
feedback signaling is obtained as follows. The method is 
based on selecting only m < v different CQI measurements 
and reporting them together with their frequency positions 
to the serving cell [9], [12]. We assume here that the 
evaluation criteria for choosing those m sub-bands for 
reporting is based on the highest SINR values (hence the 
name Best-m). The resulting report size in bits is then given 
by  
 
2
!
log
!(
)!
best
m
v
S
q
m
m v
m
−
⎡
⎛
⎞⎤⎟
⎜
=
×
+ ⎢
⎥⎟
⎜
⎟
⎜⎝
−
⎠
⎢
⎥
⎢
⎥
 
(7) 
As an example, with v = 25, q = 5 bits and m = 10, it 
follows that Sbest-m = 72 bits, while Sfull = 125 bits. 
Furthermore, on the scheduler side, we assume that the 
PRBs which are not reported by the UE are allocated a CQI 
value equal to the lowest reported one.  
C. Threshold based CQI Reporting 
This reporting scheme is a further simplification and 
relies on providing information on only the average CQI 
value 
above 
certain 
threshold 
together 
with 
the 
corresponding location (sub-band index) information. First 
the highest CQI value is identified within the full 
bandwidth, which sets an upper bound of the used threshold 
window. All CQI values within the threshold window are 
then averaged and only this information is sent to the BS 
together with the corresponding sub-band indexes. On the 
scheduler side, the missing CQI values can then be treated, 
e.g., as the reported averaged CQI value minus a given dB 
offset (e.g., 5 dB; the exact number is again a design 
parameter). The number of bits needed for reporting is 
therefore only  
 
Sthreshold
q
v
=
+
 
(8) 
As an example, with v = 25 and q = 5 bits (as above), it 
follows that Sthreshold  = 30 bits, while Sbest-m = 72 bits and Sfull 
= 125 bits. The threshold-based scheme is illustrated 
graphically in Figure 3 [11].  
 
 
Figure 3: Basic principle of threshold-based CQI reporting. 
IV.    QUASI-STATIC RADIO SYSTEM SIMULATOR 
A. Basic Features 
System-level performance of the proposed scheduling 
scheme is evaluated based on a quasi-static radio system 
185
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

simulator for LTE downlink, providing traffic modeling, 
multiuser packet scheduling and link adaptation [2]. As a 
practical example, the 10 MHz system bandwidth case of 
LTE is assumed, meaning that there are 50 physical 
resource blocks each consisting of 12 sub-carriers with sub-
carrier spacing of 15 kHz. This sets also the basic resolution 
in FD/SD UE multiplexing (scheduling), i.e., the allocated 
individual UE bandwidths are multiples of the PRB 
bandwidth. The actual reported CQI’s are based on received 
signal-to-interference-and-noise ratios (SINR), calculated 
by the UE’s for each PRB. Here the UE’s are assumed to 
deploy dual antenna linear MMSE (LMMSE) receiver 
principle, and utilize in the SINR calculations the actual 
radio channel response, the received noise level, and the 
structure of the detector (like described in more details 
below). Furthermore, like mentioned already earlier, the 
UE’s always report single stream as well as both SU and 
MU dual stream SINR’s (at the corresponding detector 
output).  
In a single simulation run, mobile stations are randomly 
dropped or positioned over each sector and cell. Then based 
on the individual distances between the mobile and the 
serving base station, the path losses for individual links are 
directly determined, while the actual fading characteristics 
of the radio channels depend on the assumed mobility and 
power delay profile. In updating the fading statistics, the 
time resolution in our simulator is set to one TTI (1ms). In 
general, a standard hexagonal cellular layout is utilized with 
altogether 19 cell sites each having 3 sectors in Macro case 
and 1 sector in Micro case as show in Figure 4. In the 
performance evaluations, statistics are collected only from 
the central cell site while the others simply act as sources of 
inter-cell interference.  
 
Figure 4: Macro and Micro cell scenarios. 
The main simulation parameters and assumptions are 
generally summarized in TABLE 1 for both Macro and 
Micro cell scenarios, following again the LTE working 
assumptions. The used MIMO scheme is per-antenna rate 
control (PARC) with two transmit antennas at the BS and 
two receive antennas at the UE’s and the receivers are 
equipped with LMMSE detectors. As illustrated in Figure 1, 
the RRM functionalities are controlled by the packet 
scheduler together with link adaptation and HARQ 
mechanisms. Notice that the maximum number of 
simultaneously multiplexed users (IBUFF) is set to 10 here 
while the total number of UE’s (ITOT) is 15. In general, we 
assume that the BS transmission power is equally 
distributed among all PRB’s. In the basic simulations, 15 
UE’s are uniformly dropped within each cell and experience 
inter-cell interferences from the surrounding cells, in 
addition to path loss and fading. The UE velocities are 
3km/h, and the typical urban (TU) channel model 
standardized by ITU is assumed in modeling the power-
delay spread of the radio channels. Infinite buffer traffic 
model is applied in the simulations, i.e. every user has data 
to transmit (when scheduled) for the entire duration of a 
simulation cycle. Exponential effective SINR mapping 
(EESM) is used for link-to-system level mapping 
(throughput calculations), as described in [2]. The length of 
a single simulation run is set to 5 seconds which is then 
repeated for 10 times to collect reliable statistics. 
Considering MIMO functionality, every UE has an 
individual HARQ entry per stream, which operates the 
physical layer re-transmission functionalities. It is based on 
the stop-and-wait (SAW) protocol and for simplicity, the 
number of entries per UE is fixed to six. HARQ 
retransmissions are always transmitted with the same MCS 
and on the same PRB’s (if scheduled) as the first 
transmissions in a single stream mode. The supported 
modulation schemes are QPSK, 16QAM and 64QAM with 
variable rates for the encoder as shown in TABLE 1.  
Link adaptation handles the received UE reports 
containing the channel quality information for each PRB 
based on single and dual stream MIMO modes. The 
implemented link adaptation mechanism consists of two 
separate elements – the inner loop (ILLA) and outer loop 
(OLLA) LA’s – and are used for removing CQI 
imperfections and estimating supported data rates and MCS. 
It is assumed that the CQI reporting errors are log-normal 
distributed with 1dB standard deviation. 
B. Detectors and SINR Modeling  
The actual effective SINR calculations rely on 
subcarrier-wise complex channel gains (estimated using 
reference symbols in practice) and depend in general also 
on the assumed receiver (detector) topology. Here we 
assume that the LMMSE detector, properly tailored for the 
transmission mode (1-stream SU, 2-stream SU or 2-stream 
MU) is deployed. The detector structures and SINR 
modeling for different transmission modes are described in 
detail below. 
 
 
 
186
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

TABLE 1. Basic simulation parameters. 
Parameter 
Assumption 
Cellular layout 
Hexagonal grid, 19 cell sites, 
3 sectors per site for Macro / 
1 sector per site for Micro 
Inter-site distance 
500 m - Macro / 1732 m - 
Micro 
Carrier frequency / Bandwidth 
Number of active sub-carriers 
Sub-carrier spacing 
Sub-frame duration 
2000 MHz / 10 MHz 
600 
15 kHz 
0.5 ms 
Channel estimation 
Ideal 
PDP 
ITU Typical Urban 20 paths 
Minimum distance between UE 
and cell 
>= 35 meters - Macro 
>= 10 meters - Micro 
Average number of UE’s per 
sector 
15 
Max. number of frequency 
multiplexed UEs (IBUFF) 
10 
UE receiver type 
LMMSE 
Shadowing standard deviation 
8 dB 
UE speed 
3km/h 
Total BS TX power (Ptotal) 
46 dBm 
Traffic model 
Full Buffer 
Fast fading model 
Jakes Spectrum 
CQI reporting schemes 
Full CQI, 
Best – m (with m=10), 
Threshold based (with 5dB 
threshold) 
CQI log-normal error std. 
1 dB 
CQI reporting time 
5 TTI 
CQI delay  
CQI quantization 
CQI std error 
2 TTIs 
1 dB 
1 dB 
MCS rates 
QPSK (1/3, 1/2, 2/3), 
16QAM (1/2, 2/3, 4/5), 
64QAM (1/2, 2/3, 4/5) 
ACK/NACK delay 
2 ms 
Number of SAW channels 
6 
Maximum number of 
retransmissions 
3 
HARQ model 
Ideal chase combining (CC) 
1st transmission BLER target  
20% 
Scheduler forgetting factor 
0.0025 
Scheduling schemes used 
Ordinary PF 
Modified PF (proposed) 
Simulation duration (one drop) 
5 seconds 
Number of drops 
10 
 
1) Single Stream SU Case 
In this case, only one of the two BS transmit antennas is 
used to transmit one stream. At individual time instant 
(time-index dropped here), the received spatial 2x1 signal 
vector of UE i at sub-carrier c is of the form 
 
,
,
,
,
,
i c
i c i c
i c
i c
x
=
+
+
y
h
n
z
 
(9) 
where 
x ,i c
, 
h ,i c
, 
n ,i c
 and 
z ,i c
 denote the transmit symbol, 
2x1 channel vector, 2x1 received noise vector and 2x1 
inter-cell interference vector, respectively. Then the 
LMMSE detector 
,
,
,
ˆ
H
i c
i c
i c
x
= w
y
 is given by 
 
2
2
1
,
,
,
,
,
,
,
,
(
)
H
i c
x i
i c
x i
i c
n i
z i
i c
σ
σ
−
=
+
+
w
h
h
h
Σ
Σ
 
(10) 
where 
2
,
σx i
, 
,
Σn i
 and 
Σ ,z i
 denote the transmit power (per 
the used antenna), noise covariance matrix and inter-cell 
interference covariance matrix, respectively. Now the SINR 
is given by 
 
2
2
,
,
,
,
,
,
,
,
,
,
H
i c
i c
x i
i c
H
H
i c
n i
i c
i c
z i
i c
σ
γ
=
+
w h
w
w
w
w
Σ
Σ
 
(11) 
The noise variables at different receiver antennas are 
assumed uncorrelated (diagonal 
,
Σn i
) while the more 
detailed modeling of inter-cell interference (structure of 
Σ ,z i
) takes into account the distances and channels from 
neighboring base stations (for more details, see, e.g., [19]). 
2) Dual Stream SU Case 
In this case, both of the two BS transmit antennas are  
used for transmission, on one stream per antenna basis. At 
individual time instant, the received spatial 2x1 signal 
vector of UE i at sub-carrier c is now given by 
 
,
,
,
,
,
i c
i c
i c
i c
i c
=
+
+
y
H x
n
z
 
(12) 
where 
x ,i c
 and 
,
, ,1
, ,2
[
,
]
i c
i c
i c
=
H
h
h
 denote the 2x1 
transmit 
symbol 
vector 
and 
2x2 
channel 
matrix, 
respectively. Now the LMMSE detector 
,
,
,
ˆi c
i c
i c
=
x
W y
 is 
given by 
 
1
,
,
,
,
,
,
,
,
, ,1
, ,2
(
)
H
H
i c
x i
i c
i c
x i
i c
n i
z i
H
i c
H
i c
−
=
+
+
⎡
⎤
⎢
⎥
= ⎢
⎥
⎢
⎥
⎣
⎦
W
H
H
H
w
w
Σ
Σ
Σ
Σ
 (13) 
where 
2
2
2
2
,
, ,1
, ,2
,
,
{
,
}
{
/2,
/2}
x i
x i
x i
x i
x i
diag
diag
σ
σ
σ
σ
=
=
Σ
 
denotes the 2x2 covariance matrix (assumed diagonal) of 
the transmit symbols. Note that compared to single stream 
case, the overall BS transmit power is now divided between 
the two antennas, as indicated above. Then the SINR’s for 
the two transmit symbols are given by 
, ,1
2
2
, ,1
, ,1
, ,1
2
2
, ,1
, ,2
, ,2
, ,1
,
, ,1
, ,1
,
, ,1
, ,2
2
2
, ,2
, ,2
, ,2
2
2
, ,2
, ,1
, ,1
, ,2
,
, ,2
, ,2
,
, ,2
i c
H
i c
i c
x i
H
H
H
i c
i c
x i
i c
n i
i c
i c
z i
i c
i c
H
i c
i c
x i
H
H
H
i c
i c
x i
i c
n i
i c
i c
z i
i c
γ
σ
σ
γ
σ
σ
=
+
+
=
+
+
w
h
w
h
w
w
w
w
w
h
w
h
w
w
w
w
Σ
Σ
Σ
Σ
(14) 
187
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

3) Dual Stream MU Case 
In this case, the transmission principle and SINR 
modeling are similar to subsection 2) above, but the two 
spatially multiplexed streams belong now to two different 
UE’s, say i and i’. Thus the SINR’s in (14) are interpreted 
accordingly. 
Finally, for link-to-system level mapping purposes, the 
exponential effective SINR mapping (EESM), as described 
in [2-4], is deployed.  
V. NUMERICAL RESULTS 
In this section, we present the results obtained from the 
quasi-static radio system simulations using the PS 
algorithms described in the article. The system-level 
performance is generally measured and evaluated in terms 
of: 
a) Throughput – the total number of successfully 
 
delivered bits per unit time. Usually measured 
 
either in kbps or Mbps. 
b) Coverage – the experienced data rate per UE at 
 
the 95% coverage probability (5% throughput 
 
CDF point). 
c) Fairness – measures the resource allocation 
 
fairness among all UE’s from the average 
 
throughput point of view. Evaluated using Jain’s 
 
fairness index [21] which is calculated here as 
 
TOT
TOT
2
1
2
TOT
1
I
i
i
I
i
i
fairness
I
μ
μ
=
=
⎛
⎞⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜⎝
⎠
=
∑
∑
 
(15)  
where 
iμ  denotes the average throughput value 
of user i across different simulation realizations 
(here ten). In single simulation run, the 
corresponding throughput of user i is given by 
 
1
1
( )
TTI
N
i
i
TTI n
R n
N
μ
=
=
∑
 
(16) 
where NTTI denotes the length of a single 
simulation run in TTI’s while Ri(n) is the actually 
delivered throughput to user i at individual TTI n. 
 
In the following, we illustrate the behavior of the 
proposed MMPF scheduler with using different power 
coefficients α1 and α2 as shown in TABLE 2. To focus 
mostly on the role of the channel quality reporting in the 
priority metric calculation in equation (3), α2 is fixed here to 
1 and different values are then demonstrated for α1. More 
specifically, with large α2 values, the effect of second term 
in priority metric calculation based on throughput 
estimation would be emphasized and the scheduling 
algorithm would behave like maximum throughput 
scheduler, which in turn would imply reduced fairness 
distribution. Consequently, the impact of the different CQI 
reporting schemes is seen now more clearly. For the cases 
of Best–m and Threshold based CQI reporting schemes, we 
fix the value of m equal to 10 and threshold to 5 dB, 
respectively. Similar example values have also been used by 
other authors in the literature earlier, see, e.g., [12]. 
Complete performance statistics are gathered for both 
Macro cell and Micro cell case scenarios.  
A. Macro Cell Case 
Figure 5 (left column) illustrates the average user 
throughput and coverage for the different schedulers. The 
power coefficient values from TABLE 2 are presented as 
index M, where M1 represents the first couple, etc. The 
obtained results are compared with the reference PF 
scheduler described also in Section II. By using the first 
term (M1) of the new metric calculation for MMPF, in 
combination with full CQI reporting scheme, we achieve 
coverage gain in the order of 63% at the expense of 20% 
throughput loss as shown in Figure 5 (a) and (b). This sets 
the basic reference for comparisons in the other cases. In the 
case of Best-m and Threshold based reporting schemes 
presented in Figure 5 (c) and (d), and Figure 5 (e) and (f), 
we have coverage increases by 69% and 74% with 
throughput losses of 15% and 20%, correspondingly. 
Continuing on the evaluation of relative system 
performance using the proposed scheduler, we clearly see a 
trade-off between average cell throughput and coverage for 
different power coefficient cases. Furthermore, the 
remaining power coefficient values shown in TABLE 2 are 
used for tuning the overall system behavior together with 
the choice of the CQI reporting scheme. In the case of full 
CQI feedback and coefficient α1 varying between 2 and 8 
(M2 –M5) the cell throughput loss is decreased to around 
7%, while the coverage gain is reduced to around 21%. 
Similar results are obtained for the other feedback reporting 
schemes as well. Consequently, an obvious trade-off 
between average cell throughput and coverage is clearly 
seen. In order to preserve the average sector throughput and 
still to gain from the coverage increase, coefficient values 
should thus be properly chosen. The exact percentage 
values for the coverage gains and throughput losses are 
stated in TABLE 3 at the end of the article. 
Further 
illustrations 
on 
the 
obtainable 
system 
performance are presented in Figure 5 (right column) in 
terms of the statistics of individual UE data rates for the 
applied simulation scenarios. The slope of the CDF reflects 
generally the fairness of the algorithms. Therefore we aim 
188
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

to achieve steeper slope corresponding to algorithm 
fairness. This type of slope change behavior can clearly be 
established for each simulation scenario. Clearly, at 5% 
(coverage) 
point 
of 
the 
throughput 
CDF 
curves, 
corresponding to users typically situated at the cell edges, 
we observe significant data rate increases indicated by shift 
to the right for all CQI feedback schemes when the 
coefficient α1 is changed in the proposed metric. This 
indicates improved overall cell coverage at the expense of 
slight total throughput loss.  
Figure 6 (left column) shows the modulation and coding 
scheme (MCS) distributions for different schedulers and 
with applied feedback reporting schemes. The negligible 
decrease in higher order modulation usage (less than 3%) 
leads to the increase in the lower (more robust) ones for 
improving the cell coverage. In all the simulated cases, the 
MCS distribution behavior has a relatively similar trend 
following the choice of the power coefficients in the 
proposed packet scheduling. In general, the use of higher-
order modulations is affected mostly in the case of Best-m 
and Threshold based reporting schemes.  
   Figure 6 (right column) illustrates the HARQ 
distributions for the different scheduler scenarios and 
reporting schemes. Clearly, the 20% BLER target rate is 
achieved in all simulated cases. Moreover, the MMPF 
scheduler provides slight increase in probability of 
successful first transmission of around 2% for the Best-m 
and Threshold based feedback cases.  
 
 
TABLE 2. DIFFERENT POWER COEFFICIENT COMBINATIONS 
Coefficient 
Value 
α1 
1 
2 
4 
6 
8 
α2 
1 
1 
1 
1 
1 
 
B. Micro Cell Case 
The performance statistics obtained for Micro cell case 
demonstrate similar trends, as in the previous Macro case, 
as shown in Figure 7. Starting from the primary case M1, 
with full CQI, we obtain a 17% loss in throughput and 92% 
coverage improvement. For the reduced feedback reporting 
schemes – Best-m and Threshold based – we have 21% and 
19% throughput losses and 100% and 96% coverage gains, 
respectively. Furthermore, similar behavior is observed in 
the CDF’s of individual UE throughputs, as well as MCS 
and HARQ distributions. The exact percentage values read 
from the figures are again stated in table format in TABLE 
4 at the end of the article. 
C. Jain’s Fairness Index 
Figure 8 illustrates the Jain’s fairness index per 
scheduling scheme for Micro and Macro cell scenarios, 
calculated over all the ITOT = 15 UE’s. The value on the x 
axis corresponds to used scheduler type, where 1 refers to 
the reference PF scheduler, 2 refers to MMPF with index 
M1, etc.  The value of Jain’s fairness index is generally in 
the range of [0,1], where value of 1 corresponds to all users 
having the same amount of resources. Clearly, the fairness 
distribution with MMPF outperforms the used reference PF 
scheduler for both cases. The received fairness gains are in 
range of 13%-37% with full CQI feedback, 15-32% with 
Best-m CQI feedback and 17-35% with Threshold based 
CQI 
feedback 
in 
the 
Macro 
case 
scenario. 
The 
corresponding fairness gains in Micro case scenario are 25-
46%, 32-41% and 34-43% for full CQI, Best –m and 
Threshold based reporting schemes, correspondingly. The 
exact percentage values read from the figures are again 
stated in table format in Table 5 in the end of the article. 
VI. CONCLUSIONS 
In this article, we have studied the potential of advanced 
multiuser packet scheduling algorithms in OFDMA type 
radio system context, using UTRAN long term evolution 
(LTE) downlink in Macro and Micro cell environment as 
practical example cases. New multistream proportional fair 
scheduler metric covering time-, frequency- and spatial 
domains was proposed that takes into account both the 
instantaneous channel qualities (CQI’s) as well as resource 
allocation fairness. Also different practical CQI reporting 
schemes were discussed, and used in the system level 
performance evaluations of the proposed scheduler.  
Overall, the achieved throughput performance together with 
coverage and fairness statistics were assessed, by using 
extensive radio system simulations, and compared against 
more 
traditional 
proportional 
fair 
scheduling 
with 
multiantenna spatial multiplexing functionality. In the case 
of fixed coverage requirements and based on the optimal 
parameter choice for CQI reporting schemes, the proposed 
scheduling metric calculations based on UE channel 
feedback offers better control over the ratio between the 
achievable cell/UE throughput and coverage increase, as 
well as increased UE fairness. As a practical example, even 
with limited CQI feedback, the fairness in resource 
allocation together with cell coverage can be increased 
significantly (more than 40%) by allowing a small decrease 
(in the order of only 10-15%) in the cell throughput. 
ACKNOWLEDGMENT 
The authors would like to thank Markku Kuusela, Nokia 
Devices, Helsinki, Finland, and Dr. Toni Huovinen, 
Tampere University of Technology, Tampere, Finland, for 
fruitful discussions. 
189
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

REFERENCES 
[1] S. Nonchev and M. Valkama, “Efficient packet scheduling 
schemes for multiantenna packet radio downlink,” in  Proc. 
Fifth Advanced Int. Conf. Telecommunications (AICT-2009), 
Venice, Italy, May 2009. 
[2] “Physical Layer Aspects for Evolved UTRA”, 3GPP 
Technical Report TR 25.814, ver. 7.1.0, Oct. 2006. 
[3] WiMAX Forum™, http://www.wimaxforum.org, Aug. 2006. 
[4] “Wireless World Initiative New Radio (WINNER),” IST-
507581, 
European 
Information 
Society 
Technologies, 
Technical Report, Dec. 2006. 
[5] N. Wei, B. Talha, T. B. Sørensen, T. E. Kolding, and P. E. 
Mogensen, “Spectral efficiency of closed-loop transmit 
diversity with limited feedback for UTRA Long Term 
Evolution,” in Proc. IEEE Int. Symp. Personal, Indoor and 
Mobile Radio Communications (PIMRC-2006), Helsinki, 
Sept. 2006. 
[6] R. W. Heath, M. Airy, and A. Paulraj, “Multiuser diversity 
for MIMO wireless systems with linear receivers,” in Proc. 
Asilomar Conf. Signals, Systems and Computers, Pacific 
Grove, CA, 2001. 
[7] E. Dahlman et al., 3G Evolution: HSPA and LTE for Mobile 
Broadband, Academic Press, 2007. 
[8] Y. Sun et al., “Multi-user scheduling for OFDMA downlink 
with limited feedback for evolved UTRA,” in Proc. IEEE 
Vehicular Technology Conf. (VTC-2006 Fall), Montreal, 
Canada, Sept. 2006. 
[9] S. Yoon, C. Suh, Y. Cho, D. Park, “Orthogonal frequency 
division multiple access with an aggregated sub-channel 
structure and statistical channel quality measurements,” in  
Proc. IEEE Vehicular Technology Conf. (VTC-2004 Fall), 
Los Angeles, CA, Sept. 2004. 
[10] I. Toufik and H. Kim, “MIMO-OFDMA opportunistic 
beamforming with partial channel state information,” in Proc. 
IEEE Int. Conf. Communications (ICC-2006), Instanbul, 
Turkey, June 2006. 
[11] T.E. Kolding, F. Frederiksen, A. Pokhariyal, “Low-bandwidth 
channel quality indication for OFDMA frequency domain 
packet scheduling,” in Proc. IEEE Int. Symp. Wireless 
Communication Systems (ISWCS-2006), Valencia, Spain, 
Sept. 2006. 
[12] K.I. Pedersen, G. Monghal, I.Z. Kovacs, T.E. Kolding, A. 
Pokhariyal, F. Frederiksen, P. Mogensen,  “Frequency 
domain scheduling for OFDMA with limited and noisy 
channel feedback,” in Proc. IEEE Vehicular Technology 
Conf. (VTC-2007 Fall), Baltimore, MD, Sept. 2007. 
[13] P. Svedman, D. Hammarwall, B. Ottersten, “Sub-carrier SNR 
estimation at the transmitter for reduced feedback OFDMA,” 
in Proc. European Signal Processing Conf., Florence, Italy, 
Sept. 2006. 
[14] C. Wengerter, J. Ohlhorst, and A.G.E Von Elbwert, “Fairness 
and Throughput Analysis for Generalized Proportional Fair 
Frequency Scheduling in OFDMA,” in Proc. IEEE Vehicular 
Technology Conf. (VTC-2005 Spring), Stockholm, Sweden, 
May 2005. 
[15] T. E. Kolding, “Link and system performance aspects of 
proportional fair scheduling in WCDMA/HSDPA,” in Proc. 
IEEE Vehicular Technology Conf. (VTC-2003 Fall), 
Orlando, FL, USA, Oct. 2003.  
[16] P. Svedman, S.K.Wilson, L.J. Cimini, and B. Ottersten, “A 
simplified opportunistic feedback and scheduling scheme for 
OFDMA,”  in Proc. IEEE Vehicular Technology Conf. 
(VTC-2004 Spring),  Milan, Italy, May 2004. 
[17] I. Z. Kovács et al, “Effects of non-ideal channel feedback on 
dual-stream MIMO OFDMA system performance,” in Proc. 
IEEE Vehicular Technology Conf. (VTC-2007 Fall), 
Baltimore, MD, Oct. 2007. 
[18] S. Nonchev, J. Venäläinen and M. Valkama, “New frequency 
domain packet scheduling schemes for UTRAN LTE 
downlink,” in Proc. ICT-MobileSummit, Stockholm, Sweden, 
2008. 
[19] S. Nonchev and M. Valkama, “A new fairness-oriented 
packet scheduling scheme with reduced channel feedback for 
OFDMA 
packet 
radio 
systems,” 
Int. 
Journal 
of 
Communications, Network and System Sciences (IJCNS), 
vol. 2, No. 7, Oct. 2009. 
[20] N. Wei, et al., “Performance of MIMO with frequency 
domain packet scheduling,” in Proc. IEEE Vehicular 
Technology Conf. (VTC-2007 Spring), Dublin, Ireland, May 
2007. 
[21] D. Chui and R. Jain, “Analysis of the increase and decrease 
algorithms for congestion avoidance in computer networks,” 
Computer Networks and ISDN Systems, 1989. 
[22] P. Svedman, L.J. Cimini, B. Ottersten, “Using unclaimed sub-
carriers in opportunistic OFDMA systems,” in  Proc. IEEE 
Vehicular Technology Conf. (VTC-2006 Fall), Montreal, 
Canada, September 2006. 
[23] S. Sanayei, A. Nosratinia, N. Aldhahir, “Opportunistic 
dynamic sub-channel allocation in multiuser OFDM networks 
with limited feedback,” in Proc IEEE. Information Theory 
Workshop, San Antonio, TX, October 2004, pp. 182-186. 
190
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

 
 
Figure 5: Left column: Average sector throughput and coverage for different scheduling schemes for Macro cell scenario with full CQI 
feedback (a, b), Best -m CQI feedback (c, d) and Threshold based CQI feedback (e, f). M1-M5 refer to the proposed scheduler with power 
coefficient values as given in TABLE 2. Right column: CDF’s of individual UE throughputs for different scheduling schemes for Macro 
cell scenario with full CQI feedback (a), Best -m CQI feedback (b) and Threshold based CQI feedback (c). 
 
 
 
 
191
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

 
Figure 6: Left column: MCS distributions [%] for different scheduling principles for Macro cell scenario with full CQI feedback (a), Best -
m CQI feedback (b) and Threshold based CQI feedback (c). Right column: HARQ distributions for different scheduling schemes for Macro 
cell scenario with full CQI feedback (a), Best -m CQI feedback (b) and Threshold based CQI feedback (c). 
192
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

 
 
Figure 7: Average cell throughput and coverage gain over the 
reference PF scheduling scheme for Micro cell simulation 
scenario. The schemes M1-M5 refer to the new proposed scheduler 
with power coefficient values as given in TABLE 2. 
 
Figure 8: Jain’s fairness index per feedback reporting scheme for 
the different simulation scenarios – Macro cell (a) and Micro cell 
(b). Scheduler type 1 means ordinary PF, while 2-6 means 
proposed modified PF with power coefficients as described in 
TABLE 2.     
 
 
 
 
193
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

 
 
TABLE 3. 
OBTAINED PERFORMANCE STATISTICS COMPARED TO ORDINARY PF SCHEDULER WITH DIFFERENT CQI REPORTING SCHEMES AND DIFFERENT 
POWER COEFFICIENTS (M1-M5) FOR THE PROPOSED SCHEDULER. MACRO CELL CASE SCENARIO. 
 
 
Coverage Gain [%] 
Throughput Loss [%] 
 
full 
best-m 
threshold 
full 
best-m 
threshold 
M1 
63 
69 
74 
20 
15 
20 
M2 
51 
57 
60 
16 
11 
16 
M3 
36 
40 
43 
13 
6 
12 
M4 
28 
29 
33 
9 
2 
8 
M5 
21 
24 
32 
7 
0 
6 
 
 
TABLE 4. 
OBTAINED PERFORMANCE STATISTICS COMPARED TO ORDINARY PF SCHEDULER WITH DIFFERENT CQI REPORTING SCHEMES AND DIFFERENT 
POWER COEFFICIENTS (M1-M5) FOR THE PROPOSED SCHEDULER. MICRO CELL CASE SCENARIO. 
 
 
Coverage Gain [%] 
Throughput Loss [%] 
 
full 
best-m 
threshold 
full 
best-m 
threshold 
M1 
92 
100 
96 
17 
21 
19 
M2 
76 
88 
84 
13 
17 
16 
M3 
53 
64 
60 
9 
14 
14 
M4 
44 
54 
46 
6 
11 
12 
M5 
36 
40 
42 
5 
8 
10 
 
TABLE 5. 
OBTAINED JAIN’S FAIRNESS INDEXES COMPARED TO ORDINARY PF SCHEDULER WITH DIFFERENT CQI REPORTING SCHEMES AND DIFFERENT 
POWER COEFFICIENTS (M1-M5) FOR THE PROPOSED SCHEDULER. MACRO AND MICRO CELL CASE SCENARIOS. 
 
 
Macro case Fairness Gain [%] 
Micro case Fairness Gain [%] 
 
full 
best-m 
threshold 
full 
best-m 
threshold 
M1 
37 
32 
35 
46 
41 
43 
M2 
32 
28 
32 
44 
40 
42 
M3 
19 
21 
25 
29 
36 
39 
M4 
16 
15 
20 
27 
33 
37 
M5 
13 
15 
17 
25 
32 
34 
 
 
194
International Journal on Advances in Networks and Services, vol 2 no 2&3, year 2009, http://www.iariajournals.org/networks_and_services/

