Transmit Beamforming Strategies with Iterative Equalization                                  
for Hybrid mmW Systems
Roberto Magueta, Daniel Castanheira, Adão Silva, and 
Atílio Gameiro. 
DETI, Instituto de Telecomunicações 
University of Aveiro 
Aveiro, Portugal 
e-mail: rlm@av.it.pt, dcastanheira@av.it.pt, asilva@av.it.pt, 
and amg@ua.pt 
Rui Dinis 
Instituto de Telecomunicações 
Faculdade de Ciências e Tecnologia, Univ. Nova de Lisboa 
Lisboa, Portugal 
e-mail: rdinis@fct.unl.pt
Abstract– The aim of this manuscript is to compare the perfor-
mance of two transmit beamforming approaches with an itera-
tive equalizer for millimeter wave (mmW) systems. At the trans-
mitter, we assume two hybrid beamforming: a sparse beam-
forming approach recently proposed and fixed random beam-
forming which the coefficients are computed independently of 
the instantaneous channel realization. At the receiver, we con-
sider a hybrid iterative block space-time structure to efficiently 
separate the spatial streams. We consider that both the trans-
mitter and the received are equipped with a large antenna array 
and the number of radio frequency (RF) chains is lower that the 
number of antennas. The hardware limitations impose several 
constraints in the analog domain that are considered when the 
transmit beamforming/precoder is generated. Our performance 
results have shown that the performance of the sparse precoder 
is better for low signal-to-noise ratio (SNR) regime while ran-
dom precoder outperforms sparse based one for medium to high 
SNR regime. 
Keywords—massive MIMO, mmWave communications, itera-
tive block equalization, hybrid analog/digital architectures. 
I. INTRODUCTION 
The use of a large number of antennas makes achievable 
higher data rates for future wireless networks [1]. Addition-
ally, the global bandwidth shortage facing wireless carriers 
has motivated the exploration of the underutilized millimeter 
wave (mmW) frequency spectrum for future broadband cel-
lular communication networks [2] and that allows the access 
to more bandwidth. Due to the small wavelength, the use of 
mmW with massive MIMO (mMIMO) is very attractive, 
since the terminals can be equipped with large number of an-
tennas very compacted [3]. 
In mmW, the channel is very correlated that is critical for 
a mMIMO implementation, where propagation tends to be 
line of sight (LOS) or near-LOS. Thus, the use of beamform-
ing to minimize de interference is very important for these 
systems [3]. MmW massive MIMO systems may exploit new 
and efficient spatial processing techniques [4], but the design 
at these techniques should follow different approaches than 
the ones adopted for lower frequencies counterparts, mainly 
due to the hardware limitations [5]. The high cost and power 
consumption of some mmW mixed-signal components, make 
it difficult to have a fully dedicated radio frequency (RF) 
chain for each antenna [6] as in conventional MIMO systems 
[7] and to overcome these limitations, hybrid analog/digital 
architectures were proposed. At these architectures, some sig-
nal processing is done at the digital level and some left to the 
analog domain, as discussed in [8]. 
Some 
beamforming 
and/or 
combining/equalization 
schemes have been proposed for hybrid architectures 
[9]-[13]. A precoding scheme based on the knowledge of par-
tial channel information at both terminals, in the form of an-
gles of arrival (AoA) and departure (AoD), was proposed 
in [9]. The authors in [10] designed a joint digital and analog 
beamforming at the transmitter side, where first a set of fixed 
analog beamforming coefficients is selected and then a digital 
eigenmode based precoder is computed, but they consider a 
fully digital receiver. In [11], a hybrid spatially sparse pre-
coding and combining approach was proposed for mmW 
massive MIMO systems. The spatial structure of mmW chan-
nels was exploited to formulate the single-user multi-stream 
precoding/combining scheme as a sparse reconstruction 
problem. A digitally assisted analog beamforming technique 
for mmW systems was considered in [12], where a digital 
beamsteering system using coarsely quantized signals assists 
the analog beamformer. In  [13], a turbo-like beamforming 
was proposed to jointly compute the transmit and receive an-
alog beamforming coefficients, but the digital processing part 
was not taken into account.  
Nonlinear equalizers are considered to efficiently separate 
the spatial streams in the current MIMO based networks [14]. 
Iterative block decision feedback equalization (IB-DFE) ap-
proach was originally proposed in [15] and it is one of the 
most promising nonlinear equalization schemes [14]. IB-
DFE can be regarded as a low complexity turbo equalizer im-
plemented in the frequency-domain that does not require the 
channel decoder output in the feedback loop. The IB-DFE 
principles can be used in mmW massive MIMO context to 
efficiently separate the spatial streams. However, as dis-
cussed, mmW massive MIMO brings new major challenges 
that prevent a direct plug and play of the iterative equalization 
based solutions developed for conventional fully digital 
MIMO systems. 
In this paper, we evaluate the performance of two transmit 
beamforming strategies combined with an efficient iterative 
block space-time equalizer for hybrid mmW massive MIMO 
systems. In the first strategy, we consider fixed random pre-
coders computed without the knowledge of the channel state 
information (CSI) keeping the transmitter with very low com-
43
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-559-3
SIGNAL 2017 : The Second International Conference on Advances in Signal, Image and Video Processing

plexity. In the second one, we assume a sparse transmit beam-
forming recently proposed in [11]. At the transmitter side, a 
space-time encoder structure is employed, before the digital 
and analog precoders, to 1) ensure that the transmit signal and 
consequently the noise plus interference, at the receiver side, 
are Gaussian distributed (which simplifies the receiver opti-
mization), 2) warrant that the signal to interference plus noise 
ratio (SINR) is independent of each spatial stream and time 
slot and 3) increase the inherent diversity of the mmW mas-
sive MIMO system. At the receiver, we design a hybrid iter-
ative block space-time structure to efficiently separate the 
spatial streams. We assume a fully connected hybrid archi-
tecture where each RF chains are connected to all antennas. 
The analog and digital parts of the hybrid equalizer are jointly 
optimized using as a metric the mean square error (MSE) be-
tween the transmitted data vector and its estimate after the 
digital equalizer. The specificities of the analog domain im-
pose several constraints in the joint optimization. To effi-
ciently deal with the constraints the analog part is selected 
from a dictionary based on the array response vectors.  
The remainder of the paper is organized as follows: Sec-
tion II describes the hybrid mmW massive MIMO systems 
model. Section III, presents the random precoder. Section IV, 
starts by briefly describing the iterative space-time receiver 
structure. Then, the fully digital equalizer is presented and fi-
nally the proposed hybrid space-time equalizer is derived in 
detail. Section V presents the main performance results and 
the conclusions will be drawn in section VI.  
Notations: Boldface capital letters denote matrices and 
boldface lowercase letters denote column vectors. The oper-
ation (.)H  represents the Hermitian transpose of a matrix. 
Consider a vector a  and a matrix A , then diag( )
a  and 
diag( )
A correspond to a diagonal matrix with diagonal en-
tries equal to vector a  and a diagonal matrix with entries 
equal to the diagonal entries of the matrix A , respectively.
( , )
A j l
 denotes the element at row j and column l of the 
matrix A . 
N
I  is the identity matrix with size N
× N
. 
II. SYSTEM CHARACTERIZATION 
In this section, we present the mmW massive MIMO signal 
definition, the transmitter and receiver characterization. We 
consider a hybrid based architecture, as shown in Fig 1. Fur-
thermore, we assume a single-user mmW system with 
t
N  
transmit antennas and 
r
N  receive antennas, where the trans-
mitter sends 
s
N  data streams to the receiver, per time-slot. 
   We considered a clustered channel,
r
t
N
×N
H ∈
ℂ
, that is the 
sum of the contribution of 
Ncl
 clusters, each of which 
contribute 
Nray
 propagation paths which follows the clus-
tered sparse mmW channel model discussed in [11].  It may 
be expressed as  
 
H
r
t
H =
A ΛA  
(1) 
where Λ is a diagonal matrix, with entries (
)
,j l  correspond-
ing to the paths gains of the lth ray in the ith scattering cluster. 
1,1
,
[
(
),
,
(
))]
cl
ray
t
t
t
t
t
N
N
θ
θ
=
…
A
a
a
, 
1,1
,
[
(
),
,
(
))]
cl
ray
r
r
r
r
r
N
N
θ
θ
=
…
A
a
a
 are the matrix of array re-
sponse vectors at the transmitter and receiver, whereas 
,
r
θ j l
 
and 
,
t
θ j l
 are the azimuth angles of arrival and departure, re-
spectively. The channel path gains and the angles are gener-
ated according to the random distributions discussed in [11]. 
We consider a block fading channel, i.e., the channel remains 
constant during a block, with size T , but it varies inde-
pendently between blocks. 
III. RANDOM PRECODER 
In this section, we present a low complexity transmitter. 
We assume that the transmitter have no access to CSI simpli-
fying the overall system design. The transmitter processing is 
decomposed into two parts, the digital baseband and the ana-
log circuitry that are modeled mathematically by precoder 
matrices 
RF
t
t
N
N
a
×
F ∈
ℂ
 and
RF
t
s
N
N
d
×
F ∈
ℂ
, respectively. The 
digital part has 
NtRF
transmit chains, with 
RF
s
t
t
N
N
N
≤
≤
. 
Due to hardware constraints, the analog part is implemented 
using a matrix of analog phase shifters, which force all ele-
ments of matrix 
a
F to have equal norm 
2
1
(|
( , ) |
)
a
t
i l
= N −
F
. As 
such the analog precoder matrix is generated randomly ac-
cordingly to 
 
,
2
,
1
1
[e
,
]
n p
RF
t
t
a
n N
N
j
p
πφ
≤ ≤
≤ ≤
F =
 
(2) 
where  
φ ,n p
, 
{1,
,
t }
n
N
∈
…
, 
{1,
,
tRF }
p
N
∈
…
 are i.i.d uni-
form random variables with support 
,
[0,1]
φn p
∈
. 
We assume that all RF resources are used by transmitter, 
i.e.,  
RF
s
t
N
= N
, and then we can assume that digital precoder 
is equal to identity matrix, 
Fd = Ns
I
. The transmitter total 
power constraint is
2
||
||F
= NsT
X
. The transmit signal is given 
by 
 
,
a
d
X =
F F C  
(3) 
where 
1
[ ,
,
]
Ns
T
T
×
=
…
∈
C
c
c
ℂ
 denotes a codeword con-
structed by using a space-time block code (STBC) that can be 
mathematically described by 
 
 
,
t
t
z =
Sf
 
(4) 
 
,
t
t
t
c =
Π z
 
(5) 
where 
1,
,
t
T
=
…
denotes the time index,
T
ft ∈
ℂ denotes col-
umn t  of a T -point DFT matrix 
1
(
[ ,
,
])
T
T
=
…
F
f
f
, 
,
1,
,
s
s
N
N
t
t
T
×
∈
= …
Π
ℂ
 is a random permutation matrix, 
known both at the transmitter and receiver sides and 
,
1
,1
[
]
s
s
N
T
s t
s N
t T
s
×
≤ ≤
≤ ≤
=
∈
S
ℂ
, 
with 
, ,
st s
{1,
, }
t
T
∈
…
, 
{1,
,
s}
s
N
∈
…
denoting a complex data symbol chosen from 
a 
QAM 
constellation 
with 
2
2
,
[|
s t | ]
s
s
= σ
E
, 
where 
2
1
s
N
s
s
s
N
= σ
=
∑
. For the sake of simplicity and, without loss of 
generality, in this work we consider only QPSK constella-
tions. To compute codeword C  we need to apply an FFT 
44
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-559-3
SIGNAL 2017 : The Second International Conference on Advances in Signal, Image and Video Processing

transform to the rows of the symbol matrix S  (see (4)) and 
then permute each of the resulting T  columns with a random 
permutation 
,
1,
,
t t
T
=
…
Π
 (see (5)). 
IV. HYBRID ITERATIVE SPACE-TIME RECEIVER DESIGN 
In this section, we derive the hybrid iterative block space-
time feedback equalizer shown in Fig. 2. We start by design-
ing the fully digital receiver, that can serve as lower bound 
for the hybrid one and then a detailed formulation of the iter-
ative approach is presented. The received signal is given by  
 
,
=
+
Y
HX
N  
(6) 
where 
[ 1
,
,
]
Nr
T
T
×
=
…
∈
Y
y
y
ℂ
 denotes the received signal 
matrix, 
[ 1
,
,
]
Nt
T
T
×
=
…
∈
X
x
x
ℂ
 is the transmitted signal and 
[ 1
,
,
]
Nr
T
T
×
=
…
∈
N
n
n
ℂ
 a zero mean Gaussian noise with 
variance 
2
n
σ . The received signal is firstly processed through 
the analog phase shifters, modeled by the matrix 
RF
r
r
N
N
a
×
W ∈
ℂ
, then follows the baseband processing, com-
posed of 
NrRF
 processing chains. All elements of the matrix 
a
W must have equal norm 
2
1
(|
( , ) |
)
a
r
j l
= N −
W
. Specifically, 
the baseband processing includes a digital feedback closed-
loop comprising a forward and a feedback path. For the for-
ward path the signal first passes through a linear filter 
RF
s
r
N
N
d
×
W ∈
ℂ
, then follows the decoding of the STBC (de-
modulation included). In the feedback path, the data recov-
ered in the forward path is first modulated and encoded using 
the STBC, then it passes through the feedback matrix 
s
s
N
N
d
×
B ∈
ℂ
. The encoding of the STBC follows (4) and (5), 
and its decoding obeys 
 
1
1
[
,
,
] ,
H
H
T
T
=
…
Z
Π c
Π c
ɶ
ɶ
ɶ
 
(7) 
 
TH .
S =
ZF
ɶ
ɶ
 
(8) 
The feedback and feedforward paths are combined by sub-
tracting the signal output of the feedback path from the fil-
tered received signal 
d
a
W W Y . At the ith iteration the re-
ceived signal at the tth time slot, after the de-interleaver, is 
given by 
 
( )
( )
( )
( )
(
1)
,
,
,
ˆ
(
) ,
i
H
i
i
i
i
t
t
d t
a t
t
d t
t
t
−
=
−
z
Π
W W y
B
Π z
ɶ
 
(9) 
 
(
1)
(
1)
ˆ
ˆ
,
i
i
T
−
−
=
Z
S
F
 
(10) 
where
s
s
N
N
H
t
×
∈
Π
ℂ
is the de-interleaver matrix and
(
1)
(
1)
(
1)
1
ˆ
ˆ
ˆ
[
,
,
]
Ns
T
i
i
i
T
×
−
−
−
=
…
∈
Z
z
z
ℂ
is the DFT of the detector 
output 
(
ˆ i−1)
S
. The matrix 
( )
( )
( )
1
1
ˆ
ˆ
ˆ
[
,
,
]
i
i
i
T
T
=
…
C
Π z
Π z
 is the 
hard estimate of the transmitted codeword C  and 
(
)
( )
( )
ˆ
sign
i
i
=
S
Sɶ
 the hard decision associated to QPSK data 
symbols S , at iteration i. 
 
From the central limit theorem the entries of vector
tz , 
{1,
, }
t
T
∈
…
 are Gaussian distributed, then as the input-out-
put relationship between variables 
tz  and 
( )
ˆ i
tz
, 
{1,
, }
t
T
∈
…
is memoryless, follows 
 
( )
( )
( )
ˆ
ˆ
,
{1,
, } ,
i
i
i
t
t
t
t
T
=
+
∈
…
z
Ψ z
ε
 
(11) 
where 
Ψ( )i
 is a diagonal matrix given by 
 
(
)
( )
( )
( )
( )
1
diag
,
,
,
,
,
s
i
i
i
i
s
N
ψ
ψ
ψ
=
…
…
Ψ
 
(12) 
 
( )
*
( )
2
ˆ
( )
( )
,
{1,
,
},
|
( ) |
i
t
t
i
s
s
t
s
s
s
N
s
ψ




=
∈
…




z
z
z
E
E
 
(13) 
and 
( )
ˆ i
tε
 is a zero mean error vector uncorrelated with 
tz , 
{1,
, }
t
T
∈
…
, with 
(
)
2
( )
( )
( )
2
ˆ
ˆ
H
s
i
i
i
t
t
N
σs

 =
−


I
Ψ
E ε ε
, and then 
it can be proven that the average error power is given by 
( )
( )
2
2
( )
( )
(
1)
2
,
,
2
2
( )
(
1)
2 1/2
2
( )
2
,
,
MSE
[||
|| ]
(
)
(
)
(
) (
|
|
(
)
)
,
s
s
i
i
t
t
i
i
i
ad t
t
N
d t
s
F
i
i
i
d t
N
s
ad t
F
t
n
F
σ
σ
σ
Π
Π
Π
−
Π
−
Π
+
=
−
=
−
−
+
−
z
z
W
H
B
Ψ
B
I
Ψ
W
I
ɶ
E
 (14) 
where 
t
a
d
t
HΠ =
HF F Π
,
( )
( )
,
,
(
i )
H
i
d t
t
d t
t
Π =
W
Π W Π
, 
( )
( )
,
,
(
i )
H
i
a t
t
a t
Π =
W
Π W
, 
( )
( )
( )
,
,
,
(
)
(
) (
)
i
i
i
ad t
d t
a t
Π
Π
Π
=
W
W
W
 and 
( )
( )
,
,
(
)
i
H
i
d t
t
d t
t
Π =
B
Π B
Π . 
A. Design of Digital Iterative Space-time Receiver 
Firstly, we design the fully digital iterative space-time re-
ceiver based on the IB-DFE principles. The performance of 
this approach can be regarded as a lower bound for the hybrid 
iterative block equalizer designed in the next section. The 
equalizer is designed by minimizing the MSE 
 
 
(
)
( )
( )
( )
,
,
( )
1
,
(
)
,(
)
diag((
)
arg min MS
s
 
)
.
E
.t.
s
i
i
i
ad t
opt
d t
opt
t
T
t
i
ad t
t
N
T
=
Π
Π
Π
Π =
=
∑
W
B
W
H
I
 
(15) 
In this case, the number of receiver RF chains is equal to the 
number of receiver antennas, and thus we only have a digital 
 
Fig 1. Transmitter block diagram. 
Time 
Precoder
T
F
Interleaver
()
Digital 
Precoder
()
d
F
()
RF Chain 1
RF Chain 2
RF Chain Nt
RF 
Digital Part
Analog 
Precoder
a
F
()
Ant. 1
Ant. 2
Ant. Nt
Data 
Molulation
Data 
Molulation
Data 
Molulation
()
()
()
Bit stream 1
Bit stream 2
Bit stream Ns 
S
T
Π
Z
X
C
45
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-559-3
SIGNAL 2017 : The Second International Conference on Advances in Signal, Image and Video Processing

linear feedforward filter referred as 
,
Wad t
 and a feedback fil-
ter 
,
Bd t
. The solution to the optimization problem (15) is 
 
 
(
)
1
( )
(
1)
,
(
)
(
)
,
i
i
H
ad t
opt
t
t
−
Π
−
Π
=
W
Ω R
H
 
(16) 
 
(
)(
)
( )
( )
(
1)
,
,
(
)
(
)
,
s
H
i
i
i
d t
opt
ad t
opt
t
N
Π
Π
Π
−
=
−
Ψ
I
B
W
H
 
(17) 
 
(
)
(
)
1
1
(
1)
1
diag
(
)
,
i
H
t
t
t
t
T
T
−
−
−
Π
Π
=


=




∑
Ω
R
H
H
 
(18) 
 
(
1)
(
1)
2
2
2
|
(
|
)
(
)
.
s
s
i
H
i
t
t
t
N
n
s
N
σ σ
−
Π
Π
−
−
=
−
+
R
H
H
I
Ψ
I
 (19) 
B. Design of Hybrid Iterative Space-time Receiver 
In this section, we design the hybrid iterative block space-
time receiver. Clearly, the previous optimization problem 
of (15) does not take into account the analog domain con-
straints. Let us denote by 
a
W  the set of feasible RF equaliz-
ers, i.e., the set of 
RF
t
t
N
× N
 matrices with constant-magni-
tude entries, then the reformulated optimization problem for 
the hybrid iterative equalizer is as follows 
 
 
(
)
( )
( )
( )
( )
,
1
,
,
( )
( )
,
,
( )
,
,
arg min MSE
s
(
)
(
)
,(
)
diag((
) (
.
)
(
)
.
t. 
)
s
i
i
i
i
a t
opt
T
t
d t
opt
d t
opt
t
i
i
d t
a t
t
N
i
a t
a
T
=
Π
Π
Π
Π
Π
Π
Π
=
∈
=
∑
W
W
B
W
W
H
I
W
W
 (20) 
Due to the digital nature of the feedback equalizer 
( )
,
(
)
i
d t
Π
B
 
and since the new constraint does not impose any restriction 
on this matrix, the feedback equalizer for the hybrid iterative 
equalizer is similar to the fully digital iterative equalizer dis-
cussed in the previous section, and thus given by 
 
 
(
)(
)
( )
( )
( )
(
1)
,
,
,
(
)
(
)
(
)
.
s
H
i
i
i
i
d t
opt
d t
opt
a t
opt
t
N
Π
Π
Π
Π
−
=
−
B
W
W
H
Ψ
I
(21) 
From (14) and (21), the MSE expression simplifies to is equal 
(up to a constant) to 
 
 
(
)(
)
1/2 2
( )
( )
( )
( )
(
1)
,
,
,
MSE
(
) (
)
,
)
(
i
i
i
i
i
t
ad t
d t
a t
opt
t
F
Π
Π
Π
−
=
−
W
W
W
Rɶ
 (22) 
 
(
1)
(
1)
2
2
2
(
)(
)
,
|
|
s
r
i
i
H
t
t
N
t
n
N
σ σs
−
Π
−
Π
−
+
−
=
R
H
I
Ψ
H
I
ɶ
 (23) 
 
( )
(
1)
2
1
( )
,
,
(
|
| )
(
)
(
)
,
s
i
i
i
ad t
opt
N
ad t
opt
Π
−
−
Π
=
−
W
I
Ψ
Ω
W
 
(24) 
where 
( )
,
(
)
i
ad t
opt
Π
W
 and 
(
i 1)
t
Rɶ −
 denote a non-normalized ver-
sion of the optimum fully digital feedforward matrix and the 
correlation of the ISI plus channel noise. 
Due to the non-convex nature of the feasible set 
a
W , an 
analytical solution to the problem (20) is difficult to obtain, if 
not impossible. Nevertheless, we find an approximate solu-
tion to problem (20) by assuming that the matrix 
( )
,
(
i )
a t
Π
W
 is 
a 
NrRF
sparse linear combination of vectors 
,
,
,
(
)
r u
r u
θj l
a
or 
equivalently a 
NrRF
sparse linear combination of the columns 
of matrix 
,1
,
[
,
,
]
r
r
t U
=
…
A
A
A
. We may say that 
( )
,
(
i )
a t
Π
W
 has 
a
NrRF
term representation over the dictionary 
r
A . Therefore, 
optimization problem can be approximated as follows 
(
)(
)
( )
,
1/2 2
( )
( )
(
1)
,
,
( )
,
( )
,
1
( )
,
0
(
)
(
)
diag((
)
diag( (
)
(
)
arg min 
(
)
s.t. 
)
(
)
)
,
s
i
d t
opt
i
i
H
i
ad t
d t
r
opt
t
F
i
H
d t
T
r
t
N
i
H
i
RF
d t
d
t
t
t
T
N
Π
Π
Π
−
Π
Π
Π
Π
=
−
=
=
=
∑
A
A
W
W
W
R
W
H
I
W
W
ɺɺɺ
ɺɺɺ
ɶ
ɺɺɺ
ɺɺɺ
ɺɺɺ
 (25)  
where 
( )
( )
,
,
0
diag(((
) ) (
) )
i
H
i
RF
d t
d t
Nt
Π
Π
=
W
W
ɺɺɺ
ɺɺɺ
 represents the 
sparsity constraint and enforces that only 
NrRF
 columns of 
matrix 
( )
,
(
i )
d t
Π
W
ɺɺɺ
are non-zero. The optimum digital feedfor-
ward 
matrix
( )
,
(
)
i
d t
opt
Π
W
 is 
obtained 
from 
( )
( )
( )
,
,
(
)
)
]
([
,
i
i
i
d t
opt
d t
opt
Π
=
W
W
0
ɺɺɺ
 by removing the zero columns and 
the optimum analogue feedforward matrix 
( )
,
(
)
i
a t
opt
Π
W
 is ob-
tained from 
H
r
A  by selecting the rows corresponding to the 
non-zero columns of 
( )
,
(
i )
d t
Π
W
ɺɺɺ
. 
From optimality condition (associated Lagrangian equal to 
zero), we obtain 
( )
,
i
Wres t
 that is the residue matrix that is given 
by 
 
Fig 2. Receiver block diagram. 
Time 
Precoder
Interleaver
()
RF Chain 1
RF Chain 2
RF Chain Nr
RF 
Digital Part
Analog 
Equalizer
( )i
a
W
()
Ant. 1
Ant. 2
Ant. Nr
Digital 
Equalizer
( )i
d
W
De-
Interleaver
()
Time 
Equalizer
TH
F
()
Decoding
Decoding
Decoding
()
Delay
Delay
Delay
()
()
Σ
()
( )i
d
B
()
+
+
+
()
_
_
Y
 ( )i
C
ɶ ( )i
S
H
T
Π
ΠT
T
F
 (
C i−1)
ɵ (
i−1)
S
ɵ ( )i
S
 ( )i
Z
 (
i−1)
Z
46
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-559-3
SIGNAL 2017 : The Second International Conference on Advances in Signal, Image and Video Processing

(
)(
)
( )
,
( )
( )
(
1)
,
,
(
(
)
(
)
.
)
i
res t
i
i
H
i
H
ad t
d t
r
opt
t
d
t
Π
Π
−
Π
−
=
+
W
W
A
W
R
U
H
ɺɺɺ
ɶ
 (26) 
From the definition of matrices
(
i 1)
t
Rɶ −
, 
(
i 1)
t
R −
,
( )
,
(
)
i
ad t
opt
Π
W
 and
( )
,
(
)
i
ad t
opt
Π
W
 equation (26) simplifies to 
 
 
( )
( )
(
1)
,
,
(
,
)
)
(
i
i
H
i
H
res t
d t
r
t
d
t
Π
−
Π
−
=
W
W
A R
Ω
H
ɺɺɺ
ɶ
 
(27) 
where 
(
1)
2
|
|
s
i
d
N
d
−
+
−
Ω =
I
Ψ
U  denotes a redefined Lagran-
gian multipliers matrix, that must be selected so that the con-
straint of the optimization problem  (25) is respected. The 
matrix 
diag( 1
,
,
)
s
d
N
µ
µ
=
…
U
 is a diagonal matrix where 
,
{1,
,
}
s
s
s
N
µ
∈
…
 are the Lagrange multipliers. 
To enforce the sparsity constraint, the best columns of the 
dictionary 
r
A  are selected using an iterative greedy method. 
At each iteration the column of 
r
A  that is most correlated 
with the actual value of the residue 
( )
,
i
Wres t
 is selected. In the 
first iteration, the residue is set to the trivial value 
(
)
( )
( )
(
1)
,
,
(
)
i
i
i
ad t
res t
opt
t
Π
−
= −
W
W
Rɶ
. Then, after identifying a set of 
columns of the matrix 
r
A  (one column per iteration) to form 
the analog feedforward equalizer matrix 
( )
,
(
)
i
a t
opt
Π
W
, we obtain 
the optimum digital feedforward equalizer matrix 
( )
,
(
)
i
d t
opt
Π
W
 
using the orthogonality condition. It can be proven that the 
optimum digital feedforward matrix is 
 
(
) (
)
1
( )
( )
(
1)
,
,
,
(
)
(
)
,
H
i
i
i
d t
opt
d
a t
opt
t
d t
−
Π
Π
Π
−
=
W
Ω
W
H
R
 
(28) 
where 
(
1)
( )
(
1)
( )
,
,
,
((
)
)
(
)
i
i
i
i
H
d t
a t
opt
t
a t
opt
−
Π
−
Π
=
R
W
R
W
ɶ
and to respect the 
constraint of problem (25) 
d
Ω is given by 
 
 
(
) (
)
(
))
1
( )
(
1
1
)
,
,
1
( )
,
d
(
i
)
,
(
)
ag
H
i
i
d
a t
o
T
t
pt
t
d t
i
a t
opt
t
T
−
Π
Π
−
−
Π
Π
=

=

×
∑
Ω
W
H
R
W
H
 (29) 
After obtaining the optimum value of the digital feedfor-
ward matrix 
( )
,
(
i )
d t
Π
W
 the residue matrix (26) is updated. The 
previous steps iterate on the updated residue value to obtain 
the 
NrRF
 index set to index the dictionary 
r
A .  
The proposed iterative hybrid space-time equalizer is iden-
tical to the equalizer proposed in [11] when the block length 
is equal to one (
T = 1)
 and for iteration one (
i =1)
. 
V. PERFORMANCE RESULTS 
In this section, we access the performance of the two trans-
mit beamforming approaches combined with the iterative 
space-time equalizer. We consider a clustered channel model 
with 
8
Ncl
=
 clusters, each with
10
Nray
=
 rays, with Lapla-
cian distributed azimuth angles of arrival and departure. The 
average power of all 
cl
N clusters is the same and the angle 
spread at both the transmitter and receiver is set to 8 degrees. 
We assume that the transmitter’s sector angle is 60º wide in 
the azimuth domain and the receiver antenna array has omni-
directional antenna elements. The antenna element spacing is 
assumed to be half-wavelength. The channel remains con-
stant during a block, with size 
T = 32
, and takes independent 
values between blocks. 
We present results for a scenario whose the parameters are
32
r
N =
, 
128
t
N =
, 
8
s
N =
, 
8
RF
RF
r
t
N
= N
=
. These results 
are presented for iteration 1, 2 and 4 of the digital and hybrid 
iterative space-time receivers, which are referred as digital 
and hybrid, in the following. 
The performance metric considered is the BER, which is 
presented as a function of the 
0
Eb /
N , with 
b
E  denoting the 
average bit energy and 
0
N  denoting the one-sided noise 
power spectral density. We consider 
2
2
1
,
1
Ns
σ
=… = σ
=  and 
then the average 
0
Eb /
N
 is identical for all streams
{1,
,
s}
s
N
∈
…
. 
From Figs. 3 and 4 we can see the performance improves 
as the number of iterations increases as expected. Further-
more, the proposed hybrid equalizer is quite close to the dig-
ital counterpart for the 2-4th iterations. From these results, we 
verify that the gaps from the 1st to the 2nd iteration are much 
higher than from the 2nd iteration to the 4th.This larger gap 
 
Fig 3. Performance for sparse precoder. 
Fig 4. Performance for hybrid random precoder. 
-24
-20
-16
-12
-8
-4
0
4
8
10
-5
10
-4
10
-3
10
-2
10
-1
Eb/N0 (dB)
BER
 
 
Digital
Hybrid
Iteration 1
Iteration 2
Iteration 4
-12
-10
-8
-6
-4
-2
0
2
4
6
10
-5
10
-4
10
-3
10
-2
10
-1
Eb/N0 (dB)
BER
 
 
Digital
Hybrid
Iteration 1
Iteration 2
Iteration 4
47
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-559-3
SIGNAL 2017 : The Second International Conference on Advances in Signal, Image and Video Processing

is mainly due to the removal of the residual ISI which enables 
the added benefit of a larger diversity. From the 2nd to the 
4th iteration there is also a benefit from ISI removal, but the 
gains are smaller since most of the ISI is removed in the 4nd 
iteration. At iteration 1, the BER target of 
3
10−  is achieved 
for an 
0
Eb /
N  of 6 and 2dB, for sparse precoder and random 
precoder, respectively. However, at iteration 4, the BER tar-
get of 
3
10−  is achieved for an 
0
Eb /
N  of -15.4 and -4.5dB, 
respectively. Therefore, the random precoder get a better per-
formance for iteration 1, but the gain for sparse precoder was 
higher and the sparse precoder has a better performance than 
random precoder at iteration 4. This happens because the 
mmW massive MIMO are very correlated. The random 
precoder deals better with interference, but we get a higher 
beamforming gain with sparse precoder that despite dealing 
worse with interference, this one can be mitigated with an ef-
ficient non-linear equalizer. 
VI. CONCLUSION 
In this paper, we compared the performance of two hybrid 
transmit beamforming approaches, with different levels of 
CSI knowledge, combined with a hybrid iterative space-time 
equalizer for mmW massive MIMO systems. The analog part 
considers the specific hardware limitation inherent to the an-
alog domain processing. A space-time encoder was used, be-
fore the analog precoders, to ensure transmit Gaussian based 
signals, which allowed to simplify the receiver optimization 
and to increase the system diversity. 
The results have shown that the sparse precoder with a hy-
brid iterative space-time receiver achieved the best perfor-
mance, mainly for low SNR regime, with a very few number 
of iterations. This happens because a larger beamforming 
gain can be achieved with sparse precoder and the interfer-
ence can be efficiently removed with the iterative receiver 
structure. On the other hand, the random precoder explores 
the diversity and overcomes the problem of very correlated 
mmW massive MIMO channels. Therefore, the random pre-
coder achieved the best performance for a linear equalizer 
(single iteration), because the signal at receiver suffers of less 
interference. Thus, we can conclude that the random precoder 
based transmitter structure is interesting for practical mmW 
massive MIMO based systems, where the channels are very 
correlated and it does not require CSI. 
ACKNOWLEDGMENT 
This work was supported by the Portuguese Fundação 
para a Ciência e Tecnologia (FCT) PURE-5GNET 
(UID/EEA/50008/2013) project. 
 
REFERENCES 
[1] F. Rusek et al. "Scaling up MIMO: opportunities and challenges with 
very large arrays,'' IEEE Signal Process. Mag., vol. 30, no. 1, pp. 40-
60, Jan. 2013. 
[2] S. Rangan, T. S. Rappaport, and E. Erkip, "Millimeter-wave cellular 
wireless networks: potentials and challenges", Proceedings of the 
IEEE, vol. 102, no. 3, pp. 366-385, March 2014. 
[3] A. Swindlehurts, E. Ayanoglu, P. Heydari, and F. Capolino, 
“Millimeter-wave massive MIMO: The next wireless revolution?,” 
IEEE Commun. Mag., vol. 52, no. 9, pp. 52–62, Sep. 2014. 
[4] W. Roh et. al., "Millimeter-wave beamforming as an enabling 
technology for 5G Cellular communications: theoretical feasibility and 
prototype results," IEEE Commun. Mag., vol. 52, no. 2, pp. 106-113, 
2014. 
[5] T. Rappaport et. al., Millimeter wave wireless communications, 
Prentice Hall, 2014. 
[6] T. S. Rappaport, J. N. Murdock, and F. Gutierrez, “State of art in 60 
GHz integrated circuits and systems for wireless communications,” 
Proceedings of the IEEE, vol. 99, no. 8, pp. 1390-1436, 2011. 
[7] M. Vu, and A. Paulraj,” MIMO wireless linear precoding,” IEEE 
Signal Processing Mag., vol. 24, no. 5, pp. 86-105, 2007. 
[8] S. Han, Chih-Li I, Z. Xu, and C. Rowell, “Large-scale antenna systems 
with hybrid analog and digital beamforming for millimeter wave 5G,”, 
IEEE Commun. Mag., vol. 53, no. 1, pp. 186–194, 2015. 
[9] A. Alkhateeb, O. El Ayach, G. Leus, and R. Heath, “Hybrid precoding 
for millimeter wave cellular systems with partial channel knowledge,”, 
in Proc. Information Theory and Applications Workshop (ITA), 2013. 
[10] T. Obara, S. Suyama, J. Shen, and Y. Okumura, “Joint fixed 
beamforming and eigenmode precoding for super high bit rate massive 
MIMO systems using higher frequency bands”, in Proc. IEEE PIMRC, 
2014. 
[11] O. Ayach, S. Rajagopal, S. Surra, Z. Piand, and R. Heath., “Spatially 
Sparse Precoding in millimeter wave MIMO systems”, IEEE Trans. 
Wireless Commun., vol. 13, no. 3, pp. 1499–1513, Mar. 2014. 
[12] A. Kokkeler, and G. Smit, “Digitally assisted analog beamforming for 
millimeter-wave communications,” in Proc. ICC’15-Workshop on 5G 
& Beyond – Enabling Technologies and Applications, 2015. 
[13] X. Gao, L. Dai, C. Yuen, and Z. Wang, “Turbo-like beamforming based 
on Tabu search algorithm for millimeter-wave massive MIMO 
systems”, IEEE Trans. Veh. Technol., Jul. 2015 (online). 
[14] N. Benvenuto, R. Dinis, D. Falconer, and S. Tomasin, “Single carrier 
modulation with non linear frequency domain equalization: An idea 
whose time has come - Again,” Proceedings of the IEEE, vol. 98, no. 
1, pp. 69-96, Jan. 2010. 
[15] N. Benvenuto, and S. Tomasin, “Block iterative DFE for single carrier 
modulation,” Electron. Lett., vol. 39, issue 19, pp.1144-1145, Sep. 
2002 
 
48
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-559-3
SIGNAL 2017 : The Second International Conference on Advances in Signal, Image and Video Processing

