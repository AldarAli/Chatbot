126
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Hierarchical Routing for Small World Wireless Networks 
 
Juhani Latvakoski 
VTT Technical Research Centre of Finland 
Oulu, Finland 
Juhani.Latvakoski@vtt.fi
 
 
Abstract — The number of embedded systems capable for 
wireless machine-to-machine service communication has 
continuously been increasing in recent years. In these kinds of 
dynamic ecosystems, the problems related to complexity and 
heterogeneity seriously challenges interoperability. As a 
contribution to this research, the small world paradigm from 
social sciences is being applied in a wireless networks context. 
A novel hierarchical networking concept, related routing 
algorithm and network optimization solutions are created to 
enable solving these problems. Logical short cuts are 
established between neighboring overlay nodes in order to 
avoid global flooding in distant route searches. In addition, 
physical short cuts may be created to remove the bottlenecks 
from the communication paths. The concept has been 
evaluated by graph theoretical analysis of the Hi-Search 
algorithm, simulation of the network optimization step and 
service discovery procedure. The evaluation results indicate 
that the algorithm with network optimization functions is able 
to lower the search delays, make the physical routes shorter 
and also improve throughput. In addition, solving the 
complexity and heterogeneity problems is made possible by 
localizing route search and abstracting communication to two 
hierarchical routing layers. 
Keywords- dynamic wireless networks; small world; routing 
I. 
 INTRODUCTION 
The number of wirelessly communicating embedded 
systems has been increasing continuously in recent years. 
This trend is assumed to lead to novel types of dynamic 
wireless networks, which are more and more necessary for 
communication between machines instead of only human-
machine communication. Such dynamic wireless networks 
have previously been studied for example in the context of 
ad hoc and peer-to-peer overlay networks. 
Ad hoc networks usually refer to a wireless network that 
can be established without any preceding configuration on 
the fly whenever required. The challenges in ad hoc 
networking solutions arise from the heterogeneity of 
operating environments, because of the different delay 
requirements, reaction times for route changes, power 
capabilities of the routing devices, and the limitations of the 
bandwidth usage, quality of service level and security. 
Because of these challenges, it can be assumed that the 
solution should be modular enough to enable smooth 
configuration and usage of multiple ad hoc routing protocols 
in different domains of the network. When multiple ad hoc 
routing solutions are applied, then their interoperability will 
become one of the most critical requirements. 
A well-known solution for solving the interoperability 
problem has been building overlay networks. In such an 
overlay network, a number of peers are connected to each 
other in a logical sense, and they can thus route messages 
between each other at a logical level even if no direct 
physical connections exist. Such solutions are able to 
improve robustness, availability, error resilience and even 
help in the transition to improved technological systems. One 
essential drawback of overlay networks is the overhead 
caused by the additional headers in the messages. Therefore, 
more processing power and memory is required in the 
overlay network nodes. However, there are still several open 
problems in communication between the nodes in dynamic 
wireless networks, such as heterogeneity of nodes, their 
dynamic existence, mobility, security, multiple radios, 
unreliable paths and topology, and continuous changes 
occurring in the network. 
The motivation for the hierarchical routing arises from 
these challenges, especially complexity and heterogeneity of 
dynamic wireless networks. In addition, the wireless paths 
between communicating nodes usually tend to be too long 
and they go via nodes, which are not appropriate or willing 
to act as a router, which also makes the performance to be 
weak. Therefore, we focus here on hierarchical routing. This 
article is an extended version of the CTRQ 2012 conference 
paper [1]. The original CTRQ 2012 paper is here extended to 
clarify the main results of the hierarchical routing as a whole, 
including enhanced clarifications of the selected essential 
details also discussed in previous publications [2], [3], [4], 
and [5]. 
The selected approach for solving the problem in this 
research is the application of the small world paradigm for 
wireless networks. The small world paradigm has initially 
been studied in the context of social networks, where a 
small-world phenomenon has been detected [6], [7]. 
According to this, the average number of intermediate steps 
in a successful social communication chain is between five 
and six, “six degree of separation”. It is here expected that 
the well-connected nodes in wireless networks tend to 
behave in a networking sense like the well-connected people 
in social networks. Thus the small world paradigm from 
social sciences is here applied in wireless networks context. 
Based on this paradigm, a novel hierarchical networking 

127
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
concept related routing and network optimization solutions 
and their evaluation results are provided in this work. The 
hierarchical route search algorithm provided is based on a 
graph theoretical system model and network search tree 
analysis both on overlay and at a physical level. Logical 
short cuts are established between neighboring overlay nodes 
to avoid global flooding in distant route searches. In 
addition, physical short cuts may be created in a network 
optimization step to make the end-to-end delays shorter, 
physical routes shorter and improve throughput. The Hi-
Search algorithm is evaluated in terms of search path depths, 
number of control messages, and delay in the search, which 
are compared against the flat physical routing approach. The 
related network optimization step and procedures enabling 
service discovery for a user are evaluated by means of 
simulations. 
The paper is organized as follows: The related work of 
small world wireless networks is described in section II. The 
conceptual system model for hierarchical networking and its 
reasoning is clarified in section III. The hierarchical routing 
solution is described in section IV. The simulation-based 
evaluation results are provided in section V, and finally, 
conclusions are given in section VI. 
II. 
SMALL WORLD WIRELESS NETWORKS 
A. Small World 
The small world phenomenon originates from the 
observation that individuals are often linked by a short chain 
of acquaintances - “six degree of separation” [6], and [7].  
Watts & Strogatz produced the network model, showing that 
rewiring a few links, called short cuts, in a regular graph can 
decrease the average path length between any two nodes 
while still maintaining a high degree of clustering between 
neighboring nodes [8].  The concept of small worlds is 
characterized by the facts that average path length is short 
and clustering is high degree. This means that most nodes are 
on average a few hops away from each other. High clustering 
means that most of the nodes’ neighbors are also neighbors 
of each other. The small world phenomenon has been 
detected, for example, in email delivery experiments, and in 
the context of the Internet and the World Wide Web [9], 
[10], and [11]. 
Complex dynamic self-organizing wireless networks tend 
also to be scale-free [12]. They usually expand continuously 
by the addition of new nodes, and the new nodes tend to 
attach to nodes that are already well connected. The dynamic 
growth and preferential attachment lead to a scale-free 
property. Scale-free means that majority of nodes have very 
few neighbors, and only a few nodes have many neighbors. 
Thus, only a few well-connected nodes nicely connect a 
large number of poorly connected nodes. This phenomenon 
is independent of the network size, and such a scale-free 
network is also a small world. 
Application of small world and scale-free features has 
also been studied in the context of wireless networks [13]. 
The dynamic wireless networks are spatial graphs that are 
usually much more clustered and have higher path length 
characteristics than random networks. In such a network, the 
links depend on the radio range, which is usually a function 
of the distance. Adding a few wired short-cuts into the 
wireless networks, the degree of separation may be reduced 
drastically. Such short-cut links need not be random but may 
be confined to a limited number of hops, which is only a part 
of the network diameter. 
Strategies for adding long-ranged links to centrally 
placed gateway node in wireless mesh networks are provided 
in [14]. The constraints of wireless networks, such as 
transmission range of long-ranged links (LL), limited radios 
per mesh router and limited bandwidth for wireless links are 
discussed. As a result, the constrained Small World 
Architecture for Wireless Mesh Networks is provided with 
three addition strategies of LL, which are able to provide a 
43% reduction in average path length (APL). The LL 
addition strategies are random LL addition strategy (RAS), 
Gateway aware LL addition strategy (GAS), and Gateway 
aware greedy LL addition strategy (GAGS). In RAS, the 
links are randomly chosen and then some checks related to 
distance and the availability of radio are carried out. In GAS, 
there is an additional check and logic related to improving 
the gateway APL (G-APL). In GAGS, the logic for 
improving the G-APL is further optimized. Significant 
performance improvements in wireless mesh networks have 
been detected as the results of the LL addition strategies 
provided . 
Summarizing, it has been discovered in the earlier 
theoretical small world-related research that, by adding a few 
short-cut links, average path length can be reduced 
significantly. However, the previous work has been mainly 
related to the application of wired links as short-cuts [13] or 
long-ranged links in mesh networks [14]. While in our 
approach, the dynamic wireless networking situation with 
multiple radio accesses, interoperability of routing protocols, 
and the problem related to the heterogeneity of nodes and 
links are taken as the starting point. Moreover, both logical 
and physical short cuts are created to solve these problems in 
practical situations. 
B. Routing Protocols 
The ad hoc networking protocols, such as, e.g., Topology 
Dissemination Based on Reverse-Path Forwarding (TBRPF) 
[15], Ad hoc On-Demand Distance Vector (AODV) [16], 
Optimized Link State Routing Protocol (OLSR) [17], and 
Dynamic MANET On-demand (DYMO) [18] are not 
optimal for specific operating environments due to 
differences in delay requirements, reaction times for route 
changes, the power capabilities of the routing devices, and 
the limitations of the bandwidth usage, quality of service 
level and security. Delay-Tolerant Networks (DTN) and 
opportunistic networking [19], [20], and [21] solutions 
enable communication also when the source and destination 
nodes are not necessarily reachable at the time of 
communication need. Therefore, usage of multiple ad hoc 
routing protocols optimized for different domains and 
situations of the dynamic wireless network should be 
enabled. A possible solution approach to these challenges is 
overlay networking. However, the heterogeneity of nodes, 

128
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
radio links, and dynamic topologies still triggers challenges 
for both overlay networking and ad hoc networking systems. 
There are multiple routing solutions implemented for 
overlay networking, such as the concept of a Content 
Addressable Network (CAN), which is a distributed 
application-level overlay infrastructure providing hash table 
functionality at an Internet-like scale [22]. A hash table is a 
data structure that efficiently maps keys into values. The 
CAN resembles a hash table, and the basic operations are the 
insertion, lookup and deletion of (key, values) pairs. Each 
CAN node stores a chunk (zone) of the entire hash table. In 
addition, the node holds information on a smaller number of 
adjacent zones in the table. Requests (insert, lookup, delete) 
for a particular key are routed by intermediate CAN nodes 
towards the CAN node whose zone contains that key. There 
are also several other routing overlay solutions, such as 
Chord [23], Tapestry [24], and Pastry [25]. Tapestry and 
Pastry differ from CAN and Chord in the sense that they take 
the network distances into account when constructing the 
routing overlay. SkipNet differs from Chord, CAN, Pastry 
and Tapestry in the sense that it provides controlled data 
placement and guaranteed routing locality by organizing data 
primarily by string names [26]. Tapestry, Chord, Pastry and 
CAN assume that most nodes in the system are uniform in 
resources such as network bandwidth and storage. Brocade 
provides a secondary overlay that exploits knowledge of the 
underlying network characteristics [27]. Usually, in peer-to-
peer systems, nodes are connected to a small set of random 
neighboring nodes, and queries are propagated along these 
connections. Such a query tends to be very expensive in 
terms of bandwidth usage. A possible solution is the 
semantic overlay network (SON), which connects nodes 
having the same type of content to each other [28]. Queries 
are routed to the appropriate SONs, increasing the chances 
that matching files will be found quickly and reducing the 
search load on the nodes that do not have any related content. 
The hierarchical routing schemes with distributed hash tables 
(DHT) are discussed in [8]. The challenge with the DHT-
based hierarchical routing schemes and also with most of the 
other overlay routing solutions is that they do not take  
physical level routing into consideration at all. 
Small world-based routing, called SWER, dedicated to 
supporting sink mobility and small transfers has been 
provided in [29]. The hierarchy is based on clustering and 
cluster heads, and short cuts are applied for long-range links 
between clusters. The cluster head selects a sensor node to 
act as agent node to form the short-cut. The challenge in this 
solution is that the weak sensor nodes and radio links are still 
applied in realizing the short-cut. Hierarchical routing based 
on clustering using adaptive routing using clusters (ARC) 
protocol is provided in [30]. A new algorithm for cluster 
leader revocation to eliminate the ripple effect caused by 
leadership changes is provided. The ARC starts from the 
need to select a cluster leader. However, in our work we 
assume that the capability to act as a cluster head is 
preconfigured into the overlay nodes. Then there is no need 
to select a cluster head, but instead they need only to 
discover each other. 
Helmy et al. have developed a contact-based architecture 
for resource discovery in large-scale wireless ad hoc 
networks (CARD) [31]. The mechanism is suitable for 
resource discovery as well as routing very small data 
transfers or transactions, in which the cost of data transfers is 
much smaller than the cost of route discovery. In CARD, 
resources within the vicinity of a node, up to a limited 
number of hops, are discovered using a proactive scheme. 
For resources beyond the vicinity, each node maintains links 
to a few distant nodes called contacts. The contacts help in 
creating an efficient way to query for distant resources. Two 
protocols for contact selection were introduced and 
evaluated: (a) probabilistic method, and (b) edge method, 
which was found to be a more efficient way for contact 
selection. Comparison with other schemes shows overhead 
savings reaching over 93% (vs. flooding) and 80% (vs. 
border casting or zone routing) for high query rates in large-
scale wireless networks. The concept of contacts can be 
compared to our concept of overlay nodes. However, the 
contact nodes act as short-cuts in CARD, while our short-
cuts are either logical or physical wireless links. Our 
approach in particular further enhances the system in such a 
way that the network optimization checks whether it is also 
possible to establish the physical wireless short cuts between 
overlay nodes as direct radio connections. 
Variable-length short-cuts are constructed dynamically 
using mobile router nodes called data mules in disconnected 
wireless networks [32]. The data mules transfer data between 
nodes, which do not have a direct wireless communication 
link and belong to otherwise isolated networks. Their 
simulations indicate that even a small number of data mules 
can significantly reduce average path length. The overlay 
nodes might also act as mobile routers, but network 
optimization may not be possible or at least is not trivial in 
disconnected networks. 
P2P network can be established using small world 
concepts, and it has been realized as SWOP, small world 
overlay protocol [33]. The average hop distance between 
P2P nodes can reduce the numbers of link traversals in object 
lookup, reduce the latency and can effectively satisfy a large 
number of users requesting a popular data object. However, 
the physical level routing is not taken into concern at all in 
the SWOP approach. 
There are also quite a number of solutions for neighbor 
discovery such as [34], and [35]. However, route discovery is 
usually executed in a flat manner, e.g. [17]. The problem in 
such a search is that the search queries are also forwarded 
into the deep leaves of the search trees. Our approach is 
different in the sense that only the nearest logical overlay 
nodes are searched at the physical route level, and the 
network can be optimized by removing non-optimal radio 
links and physical routers from the path. 
III. 
HIERARCHICAL NETWORKING CONCEPT 
The applied system model of heterogeneous wireless 
network is shown in Figure 1. The system consists of 
heterogeneous nodes, which are shown using color codes for 
the different node types. In addition, the colors in the dotted 
circles represent the usage of different radio access types. 

129
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Each node may have one or more radio access capabilities, 
which can also be applied to temporarily connect the 
heterogeneous wireless network with legacy static Internet 
(blue clouds). The referred nodes may be switched on and 
off at any given time, which means that their presence is 
dynamic. Therefore, dynamic life cycle management is 
required for both the nodes and the networks. 
The network nodes are categorized according to their 
capabilities. U node is a user interface (UI) node, which is 
able to host the network and services, which it may visualize 
for a user. S node is service node, which may provide set of 
services, act as super peer (cluster head) for services and 
overlay router. R node is a physical router node, which can 
route data traffic between different interfaces of the node. T 
node can for example be a sensor (Ts), actuator (Ta) or 
camera (Tc). P node is a special node in the sense that it is 
usually plugged in to be a logical part of U or S node. Each 
of the referred nodes may not always be on, and they may be 
mobile and can apply whatever wireless/wired access means 
for communication with the neighbor nodes. 
The problem is related to the heterogeneity of nodes; 
some of the nodes do not have good capabilities for routing, 
while others do. For example, the radio access may not be 
power-efficient enough and the device may be battery-
operated. In addition, some of them do not want to route at 
all for some owner-originated reasons. Having flat routing in 
such a system seems to lead to long path lengths and low 
performance, or even to the impossibility of establishing a 
connection at all. 
The heterogeneous nodes may have several different 
radio accesses for communication with neighbor nodes. 
Some of the nodes may act as a relay for the specific radio 
technology. The lowest level of routing can thus be 
considered to be radio specific, and its main function is to 
relay (“route”) the received signal forward so that the nodes, 
which are not in the radio coverage of the original sender can 
also receive it. This kind of “radio relay routing” solution is 
dependent on the radio technology applied, which means that 
it needs to be realized in a specific way for each different 
radio technology. 
 
Figure 1.  System model of a heterogeneous wireless network. 
 
Some clusters of the network may need a specific method 
and optimized algorithm for physical level routing. Such 
optimization may be needed, for example, because of the 
limited power capabilities of the sensor nodes. For some 
network clusters such ad hoc routing protocol, like AODV, 
may be good enough; however, some of the nodes such as 
very limited capability sensor networks may require more 
optimized ad hoc routing protocol in the sense of memory 
and battery consumption. In addition, it may be more 
efficient to have a proactive protocol in operation when the 
network cluster is more static and not mobile. This means 
that the heterogeneous wireless network may consist of 
network clusters applying different physical routing 
algorithms. Therefore, several different physical ad hoc 
routing methods and protocols should be supported. When 
several different radio access and physical routing protocols 
are integrated into a single system, interoperability will be 
very big challenge. As a solution for interoperability, the 
overlay approach has been used in this work. 
Thus, our hierarchical networking concept relies on the 
overlay approach, in which the radio relay routing, physical 
ad hoc routing and overlay routing are executed on top of 
each other, as in Figure 2. The overlay routing is applied on 
top of the physical networking and radio access specific 
networking. In the overlay routing, the application level 
messages are stored in packets called bundles, which are 
routed between logically neighboring overlay routers, e.g., a, 
b, and c. There can be several physical routers between the 
referred neighboring overlay routers, for example 1-5. And 
there can also be several radio relays between physical 
routers respectively. However, radio relays are beyond the 
scope of this paper. 
 
Figure 2.  An example of hierarchical routing configuration. 
 
IV. 
HIERARCHICAL ROUTING 
Hierarchical routing is analyzed in this chapter with the 
aid of network graphs. A novel hierarchical routing 
algorithm is provided, based on the reasoning. Finally, a 
procedure for the hierarchical search and network 
optimization is discussed. 
A. Network Graphs 
An example of a heterogeneous wireless network system 
is shown in the form of a graph in Figure 3. In the example, a 
physical network graph (GPN), vertex (VPN=0) i.e., node (0) 
represents the User node. Each vertex has certain 
characteristics such as location (L), overlay routing 
capabilities (OR), physical routing capabilities (PR), radio 
capabilities (R), power capabilities (P) and computing power 
(Cp), VPN{L, OR, PR, R, P, Cp}. The edges (EPN) represent 

130
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
the possible physical communication links between two or 
more nodes. Each edge has certain characteristics such as, 
for example, distance (D) and delay (Δt), EPN{D, Δt}. In the 
example, the overlay network graph (GON) is established by 
the U, and S vertices (VON). The dotted lines represent the 
edges of the overlay network (EON). The overlay network 
graph is here said to be a virtual graph of the physical 
network graph (GON c GPN). Respectively, we can define the 
radio network graph (GRN), which shows the radio network 
below the physical network (GON c GPN c GRN). Therefore, 
the system model is here said to be hierarchical. 
The GPN can be represented in the form of a (search) tree 
(TPN) from the perspective of the VPN=0, i.e., user node 0 
(A), shown in Figure 4.  Such a tree does not have cycles, 
and the source of the search is represented as the root of the 
tree (TPN (VPN=0)). A search path is a route from the root of 
the tree to the leaf of the tree, representing the destination of 
the search. Such a search tree can be created for each node of 
the GPN respectively. 
Respectively, GON can be represented in the form of a 
tree (TON) shown in Figure 5.  It is easy to see that the height 
of the overlay network tree is smaller than the height of the 
physical network tree. This means that the overlay network 
path from source to the destination usually contains a smaller 
number of hops. 
 
Figure 3.  
Example System Graph (GPN and GON). 
 
 
Figure 4.  
Example System physical network Tree (TPN). 
 

131
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 5.  
Example System Overlay Network Tree (TON).  
 
B. Reasoning 
The reasoning of the hierarchical search algorithm is 
represented in the following: 
 
 
Each edge in the search path means an additional 
communication delay for the search. Therefore, the 
number of levels in the search tree needs to be 
minimized. For example, if the search proceeds into 
deep sub trees, which do not have the destination, the 
search unnecessarily disturbs the vertices and consumes 
the radio bandwidth in the area of the leaf sub tree. 
 
Each vertex in the search tree processes the search, and 
it adds processing delay (Δtp) to the search. Therefore, 
the number of vertices in the search path needs to be 
minimized. It can be claimed that the search 
unnecessarily disturbs all vertices in the search path, if 
the vertex is not the destination. Unnecessary 
disturbance of any vertex should be minimized. 
 
Let us call the minimization of the search tree levels, 
minimization of the number of vertices in the search 
path and minimization of vertex disturbance search tree 
minimization.  
 
The number of levels in the search tree is lower for the 
TON than for TPN. Therefore, it is assumed that the search 
tree can be minimized by relying on hierarchical search, 
in which the search is executed in the overlay level 
(TON) and the physical level search is limited to the 
discovery of the physical paths between each pair of 
neighboring S nodes (TPN is split into sub trees). This 
also means that the hierarchical search is executed in 
TON (Figure 5. ) and in the split sub trees of TPN 
visualized in Figure 6.  In this way, the physical level 
search results in a local optimum physical path, called a 
logical short-cut, between neighboring S/U nodes, and 
the overlay level search results optimum path between 
source and destination (S/U or T* nodes). 
 
Some of the vertices are more powerful than others, for 
example, some can have good power sources and a good 
computing platform while others may be battery-
operated. It is clear that powerful vertices are better 
nodes for routing. Therefore, they are preferable nodes 
in the search path, and the usage of limited capability 
nodes (bottlenecks) will  be minimized. 
 
When looking at different search paths in GPN, TPN it is 
assumed that removing the bottleneck nodes from the 
search path reduces the total communication delay (Δtc) 
of the search. Let us here call the removal process 
network optimization. 
 
The network optimization process is focused on the split 
sub trees of TPN; see Figure 6. Because, the R nodes are 
assumed to be the bottleneck nodes, the S/U nodes 
actively try to remove them from the local physical 
communication paths, and create a physical short cut 
between the neighboring S/U nodes. As a result of 
successful network optimization, the search tree is like 
the TON visualized in Figure 5.  
 
Summarizing, the hierarchical search with search tree 
minimization and network optimization processes results in a 
situation, where the search path consists only of powerful 
and well-connected S/U nodes and not bottleneck nodes. 
 
 
Figure 6.  
Split sub trees of TPN.  
 
C. Hierarchical Search Algorithm 
The hierarchical search algorithm is represented in  
Figure 7. When the power of a U/S node is switched on, the 
device will broadcast DiscoverReq to all of its neighbors 
with the information of the node itself. Each overlay node 
receiving the DiscoverReq stores its key contents and replies 
with DiscoverRep, which is sent in a unicast manner to the 
source of the DiscoverReq. The DiscoverRep contains 
overlay level routing and service information, which will be 
delivered to the original source of the DiscoverReq. Sending 
the DiscoveRep triggers searching for the physical route 

132
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
between the neighboring overlay nodes, for example using 
the AODV RREQ/RREP procedure. When the original 
source receives DiscoverRep via the discovered physical 
route, the system has established a logical short cut between 
the neighboring overlay nodes, and is ready to provide 
messaging services for applications. 
When an application message (APP-msg) is received 
from the upper layer and the overlay route is known, it is 
forwarded towards its intended destination. Otherwise, an 
overlay route is searched first, and then the message is 
forwarded towards the destination. In this manner, the 
application message will be delivered to the destination using 
hierarchical search. At any time after the system is ready, the 
network optimization can be initiated. In the network 
optimization, direct wireless communication links for the 
neighboring overlay nodes may be created as physical short-
cuts in the cases where it is physically possible with the 
available radio access technologies of the overlay nodes. 
 
 
 
Figure 7.  
Hierarchical Search Algorithm.  
 
D. Procedure of the Hierarchical Search 
The basic procedure of the hierarchical search algorithm 
is shown in Figure 8. First, after power on, each overlay node 
initiates the logical neighbor discovery procedure by sending 
DiscoveryReq  messages to indicate their presence to their 
neighbors . Based on these broadcast messages, the physical 
routers in the chain can add the information about their 
physical neighbors into their routing tables. These messages 
are forwarded by all the nodes until an overlay node receives 
them.  When an overlay node receives the DiscoverReq, 
unicast sending of DiscoverRep to the source of the 
DiscoverReq is activated. This activates searching of 
physical routes between the overlay node, and neighboring 
source overlay node. 
The network may consist of different routing clusters, 
clouds in Figure 8. , which may apply different physical 
routing protocols. For example, in cluster 1, the AODV route 
discovery will be executed, and as a result, a physical route 
between A and C can be discovered. The other clusters may 
use any other routing protocol for route discovery. When the 
physical route has been discovered, then the DiscoverRep is 
sent to the source overlay node. As a result of the logical 
neighbor discovery procedure, the overlay nodes know their 
physical and logical overlay neighbors and the logical short-
cut has been established between the overlay neighbors. The 
physical routes between logical neighbors are stored in the 
physical level routing tables. After this phase, network 
optimization may be activated. 
When an application message (APP-msg) is received 
from upper layers, it triggers searching of the overlay route 
by sending ON-RouteReq towards the logical neighbors. 
Each intermediate overlay node forwards the ON-RouteReq 
until the destination is discovered. The destination node then 
replies with ON-RouteRep message, which is sent via the 
same route, which the ON-ReouteReq used. The nodes in the 
path update the routing tables accordingly to enable smooth 
forwarding of the APP-msg from source to destination i.e., 
from A to E. 
 
Figure 8.  Hierarchical routing procedure. 
 
E. Network Optimization 
In 
the 
network 
optimization, 
direct 
wireless 
communication links between the neighboring overlay nodes 
are created (See Figure 7. row 22, and dotted red links in 
Figure 3. ). These links are called physical short-cuts, and 
they can be created in the cases when the overlay nodes can 
apply larger transmit power or use a longer distance radio 
Algorithm HI-Search  
 
/* Hierarchical Search */ 
 
1. WHEN n(OFF) →n(ON) THEN 
2. 
send (DiscoveryReq, Bcast) 
3. WAIT until receive (Msg)  
4.  
SWITCH Msg  
4.  
 
CASE DiscoverRep (ucast) 
5. 
 
 
store (DiscoverRep) 
6. 
 
 
start (timer, Net-Opt) 
7. 
 
CASE DiscoverReq (Bcast) 
8. 
 
 
IF n == ON THEN 
9. 
 
 
  store (DiscoverReq) 
10. 
 
 
  send (DiscoverRep, Ucast) 
11. 
 
 
ELSE 
12. 
 
 
  update (DiscoverReq) 
13. 
 
 
  forward (DiscoverReq, Bcast) 
14. 
 
CASE applicationMsg 
15. 
 
 
IF no route THEN  
  send (ON-RouteReq) 
16. 
 
 
IF route THEN send APP-msg 
17. 
 
CASE ON-RouteReq 
18. 
 
 
IF n == destination THEN 
19. 
 
 
  send ON-RouteRep 
20. 
 
 
ELSE forward ON-RouteReq 
21. 
 
CASE Timeout (Net-Opt) 
22. 
 
 
optimize (network) 
23. 
 
 
start (timer, Net-Opt) 
24. 
ENDSWITCH 
25. ENDWAIT 

133
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
access method to communication with the neighboring 
overlay node(s) directly. 
Because of these physical short-cuts, the physical route 
can skip some of the physical routers, which makes the path 
shorter compared with a communication without them. For 
example, the physical communication path without the 
physical short cuts between B and D can consist of 3 
intermediate physical hops via physical routers numbered 4, 
6 and 7 (see Figure 3. ). In that case, the logical short-cut 
between B and D is available via the referred intermediate 
hops, and it can be used to make long -distance routing more 
efficient. However, enabling also a physical short-cut link 
could enable node B to reach node D via a direct radio link 
without any intermediate physical routers by using, for 
example, a somewhat larger transmit power or other radio 
access system. 
It is here assumed that the overlay node is a higher 
capability node, which usually has more power capabilities 
and can also have several different radio access technologies 
to be used for communication. Therefore, such nodes are 
able to create referred physical short-cuts. In addition, it is 
assumed that such nodes are able to act as cluster heads in 
the network topology. Therefore, the number of overlay 
nodes can be used as a measure of clustering level in the 
system. If there is smaller number of cluster heads, i.e. 
overlay nodes, then there are not many clusters in the 
network. If there are more cluster heads, then there are more 
clusters in the network. 
Let us define low degree (DL) to indicate the number of 
nodes, which have a small (0-2) number of neighbors. 
Usually, these kinds of nodes are other than overlay nodes, 
because those nodes usually have a limited number of radio 
accesses and power capabilities. Respectively, high degree 
(DH) indicates the number of nodes, which a have higher (> 
2) number of neighbors. Usually, these kinds of nodes are 
overlay nodes i.e., cluster heads. The degree of clustering 
(D) is here defined as a function (1) depending on the 
number of low and high degree nodes, and it is used to 
indicate the level of clustering in a specific topology (T) in a 
specific moment of time (t). 
 
The degree of clustering (1) is larger when the number of 
high degree nodes increases, and smaller when there are 
fewer high degree nodes. When the number of low degree 
nodes is significantly larger than the number of high degree 
nodes, the system represents a scale-free network. Then a 
majority of nodes have very few neighbors, and only a few 
nodes have many neighbors. Usually, the heterogeneous 
wireless network represents this kind of scale-free 
phenomenon. Because the degree of clustering depends on 
the topology and time, the effect of physical short-cuts for 
the path lengths and performance are in this work studied by 
means of simulations . 
V. 
EVALUATION 
Evaluation of the hierarchical search algorithm, network 
optimization and related procedures is provided in this 
chapter. 
A. Evaluation of Hi-Search Algorithm 
The depths of the search paths for the example graph 
shown in Figure 3. are shown in Figure 9.  There are 37 
possible search paths for both physical and overlay networks, 
see Figures 4 and 5 respectively. Each search path is shown 
in the x-axis, and the depth of the search path is shown in the 
y-axis in Figure 9. For example, for search path number 11, 
the depth of the physical search path is 10 and the depth of 
the overlay search path is 5. In general, the search path 
depths for the overlay routes are lower than the search path 
depths for the end-to-end physical routes. The Hi-Search 
algorithm provided applies overlay route search, which 
means lower search paths. 
The physical search path depths of overlay hops are 
shown in Figure 10. (See also Figure 5. ). The y-axis shows 
the physical search path depths, and the x-axis shows the 
number of their required searches in Figure 3. in a physical 
routing situation. For example, the physical search path 5-9-
2, whose depth is 2, happens 17 times in a physical routing 
situation. The referred physical search paths seem generally 
to happen multiple times in the example network in a 
physical routing situation. This is not very efficient, and 
therefore the algorithm creates logical short-cuts between the 
neighboring overlay nodes. Then there is a need to execute 
referred physical search paths only once for the network, and 
network optimization can be based on it. The referred 
network optimization action is initiated in row 22 of the Hi-
Search algorithm to check and create possible physical short-
cut link between the neighboring overlay nodes. 
The number of control message sending actions is shown 
in the y-axis of Figure 11. When the physical route between 
neighboring overlay nodes is searched initially and 
optimized, the number of control message send actions is at 
about the same level as in physical routing (x=7). However, 
after the optimization has been executed, then the number of 
control message send actions drops significantly, because 
there is no need to repeat optimization. It can be seen that the 
number of control message send actions is lower when 
applying the Hi-Search algorithm compared with physical 
routing. 
The total delay in the search is shown in the y-axis of 
Figure 12. It is assumed here that the delay in each physical 
hop, i.e. the radio link, is 10ms, the optimization happens in 
a parallel manner and the processing delay in each node is 
zero. The peaks of the delay for the Hi-Search algorithm are 
related to optimization of the network. After optimization, 
the delays are at a lower level. As a result, it is seen that the 
Hi-Search algorithm is better because it has lower search 
delays than physical routing. 
 

134
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 9.  
Search path depths.  
 
 
Figure 10.  Physical search path depths of overlay hops.  
 
 
 
Figure 11.  The number of control message sending.  
 
 
 
Figure 12.  Delay  the search.  
 
In practical situations, the physical characteristics 
including the delay in each edge vary according to applied 
radio access technology. The network optimization removes 
weak and high delay edges from the path, which may make 
the delay difference between physical search and Hi-Search 
algorithm even larger than what is shown in Figure 12. In 
addition, the processing delay of each vertex is usually 
bigger than zero. When applying the Hi-Search algorithm, 
the number of intermediate hops in the path is minimized in 
such a manner that weak nodes are removed from the path by 
network optimization. Therefore, in a practical situation the 
delay difference between physical search and Hi-Search 
algorithm is even larger than what is shown in Figure 12.  
B. Evaluation of network optimization 
The evaluation of network optimization has been carried 
out with NS-2 simulations to evaluate its effects to the end-
to-end delays, physical route lengths and throughput. In 
addition, the effects of degree of clustering, i.e. the number 
of physical short-cuts to these, have been studied. Mobility is 
not allowed in the simulations, and the comparison is carried 
out in such a manner that the only changing factors are the 
number of physical short-cuts and the transmission power. In 
this way, it is expected that the effect is seen in pure manner. 
Four different topologies have been simulated, each of 
which have a different number of nodes: 61, 100, 150 and 
200. The applied simulation parameters are shown in  Figure 
13. The physical level routing solution is called eAODV, and 
the overlay level solution is called eORCP. 
Delay in sending a packet between source and destination 
as a function of the number of nodes is shown in Figure 14. 
The blue line represents  eAODV routing in the network, in 
which all the nodes have transmission power Pt_ 0.002818, 
which means 2.818 mW and ca. 50m transmission range. In 
this case, there are no overlay nodes, which means that all 
the nodes are in the same cluster. The other lines represent 
eORCP with a different number of overlay nodes (2, 4, and 
6) added into the same network topology. The overlay nodes 
have transmission power Pt_ 0.2818, which means 281.8 
mW and approx. 150m transmission range. Therefore, the 

135
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
overlay nodes can be connected with neighbor nodes in a 
larger neighborhood area. In the simulations, the end-to-end 
delay is an average of 50 measured round trip end-to-end 
delays. According to the simulation results, the end-to-end 
delay is shorter when the number of overlay nodes increases. 
The differences in the delays of eAODV and eORCP-* cases 
are not very big, however; the simulations give a clear 
indication that the larger number of physical short-cuts 
makes the end-to-end delay shorter. 
 
 
set val(chan)     Channel/WirelessChannel 
;# channel type 
set val(prop)    Propagation/TwoRayGround  ;#radio-propagation model 
set val(netif)    Phy/WirelessPhy 
; 
# wireless 
set val(mac)     Mac/802_11  
 
;# MAC type 
set val(ifq)       Queue/DropTail/PriQueue 
;# queue type 
set val(ll)         LL  
 
 
;# Link layer type 
set val(ant)      Antenna/OmniAntenna 
 
;# antenna type 
…. 
# SharedMedia interface with parameters to make 
# it works like the 914MHz Lucent WaveLAN DSSS radio interface 
 
Phy/WirelessPhy set CPThresh_ 10.0 
Phy/WirelessPhy set CSThresh_ 1.559e-11 
Phy/WirelessPhy set RXThresh_ 3.652e-10 
Phy/WirelessPhy set Rb_ 2*1e6 
 
#the range is about 50 meters 
 
Phy/WirelessPhy set Pt_ 0.002818 
Phy/WirelessPhy set freq_ 914e+6  
Phy/WirelessPhy set L_ 1.0 
Figure 13.  Simulation parameters. 
 
 
End to end Delay
0
0,2
0,4
0,6
0,8
1
1,2
61
100
150
200
Number of nodes
End to End Delay in seconds
eAODV
eORCP-2
eORCP-4
eORCP-6
 
Figure 14.  End-to-End Delay. 
 
The reason for the shorter end-to end-delay can be seen 
from Figure 15. Because the overlay nodes use larger 
transmits power when implementing the wireless short-cuts, 
they enable a shorter physical route to the destination. 
Because there is some delay in each of the wireless links, the 
end-to-end delay is shorter when the number of hops is 
fewer. For example, in 61 node network, the end-to-endroute 
for the pure physical router network (eAODV) consist of 55 
hops, and when applying 6 overlay nodes, the physical route 
consist of 15 hops. This gives a clear indication that the 
larger number of physical short-cuts reduces the number of 
intermediate hops, i.e. the path of a route is shorter. 
However, it is obvious that the absolute quantity of reduction 
in the delay and the number of intermediate hops in the route 
depends on the topology. 
Throughput in delivering a large number of packets 
between source and destination as a function of number of 
nodes is shown in Figure 16. In the measurement, the applied 
packet size has been 512 Bytes. As can be seen, the system 
with eAODV solution has a somewhat lower throughput 
compared with, for example, eORCP-2, eORCP-4 and 
eORCP-6. This means that the performance improves when 
the number of overlay nodes increases independent of the 
number of nodes attached into the system. Thus, the 
simulations give a clear indication that increasing the number 
of physical short cuts in the system improves system 
performance. The improvement is not very big, however. It 
is seen that this improvement is generic, even if it is obvious 
that the absolute quantity of the performance improvement 
depends on the topology. 
 
Number of Physical Hops in the Route
0
20
40
60
80
100
120
140
160
180
200
61
100
150
200
Number of nodes
Number of hops
eAODV
eORCP-2
eORCP-4
eORCP-6
 
Figure 15.  The number of physical hops in the route. 
 
The degree is here used to indicate the level of clustering 
in a specific topology and moment of time. In addition, the 
number of overlay nodes is used to indicate the level of 
clustering, as described earlier. In our simulation cases, the 
overlay nodes have larger transmission power (Pt_ 0.2818, ~ 
150m range); and it enable them to have more than 2 
neighbors in the communication range in the simulated 
topologies. Instead, the physical router nodes have lower 
power (Pt_ 0.002818, ~50m range), and therefore they can 

136
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
have only 0-2 neighbors. In the simulation cases, the number 
of overlay nodes (DH: 0, 2, 4, 6) has been significantly 
smaller than the number of physical router nodes (DL: 61, 
100, 150 and 200). Therefore, the simulated topologies 
represent scale-free networks, because the majority of nodes 
have very few neighbors (DL is big), and only a few nodes 
have many neighbors (DH is small). 
The discovered physical route lengths are shown in 
Figure 17. The simulation of 4 topologies all indicate that 
when the degree of clustering increases, the number of hops 
in the discovered physical route decreases. This result 
indicates typical small world phenomena, where the high 
clustering means shorter physical routes between nodes. 
Throughputs of 4 topologies as functions of degree of 
clustering are shown in Figure 18. As can be seen, 
throughput increases when clustering increases. This means 
that the degree of clustering has a positive effect on the 
throughput. The system can be claimed to scale better 
because, when the clustering is higher, throughput is better 
and delay lower. 
The simulation results indicate clearly that when 
increasing the number of physical short-cuts in the system, 
the end to end delays and the physical routes become shorter, 
and throughput improves. Thus, when the degree of 
clustering increases, the physical routes become shorter and 
the performance of the system improves. Simultaneously, the 
system scalability is improved, because when the clustering 
is higher, throughput is better and delay lower. These 
improvements seem to be generic; however, it is obvious that 
the absolute quantity of the improvement depends on the 
topology. 
 
 
Throughput
4,08
4,085
4,09
4,095
4,1
4,105
4,11
4,115
4,12
61
100
150
200
Number of nodes
Throughput kBit/s
eAODV
eORCP-2
eORCP-4
eORCP-6
 
Figure 16.  Throughput. 
 
 
 
 
 
 
Figure 17.  Route length as a function of degree of clustering. 
Topology 1
0
10
20
30
40
50
60
0
0,0327869
0,0491803
0,0983607
Clustering degree
Number of hops
61 nodes
Topology 2
0
20
40
60
80
100
0
0,02
0,03
0,06
Clustering degree
Number of hops
100 nodes
Topology 3
0
20
40
60
80
100
120
140
160
0
0,01333333
0,02
0,04
Clustering Degree
Number of hops
150 nodes
Topology 4
0
50
100
150
200
0
0,01
0,015
0,03
Clustering degree
Number of hops
200 nodes
 

137
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 18.  Throughput as a function of degree of clustering. 
 
C. Evaluation of Procedures 
The topology of the simulated network is shown in 
Figure 3. The simulated network consist of two U nodes, six 
S nodes, six R nodes, ten sensor nodes (Ts), four actuator 
nodes (Ta) and two camera nodes (Tc). The blue lines 
represents physical routes, and the dotted lines shows 
overlay neighbor connections. The numbers represent the 
physical addresses of nodes, and letters of the alphabet 
represent overlay addresses. In this example, all the nodes 
have both physical address (1…30) and the service nodes (U, 
S, Ts, Ta and Tc) have a logical address (A … H, a … p). 
The numbers in parenthesis indicate the location of the 
nodes. The simulation parameters of the radio links are 
shown in Figure 19.  
The procedure for simulation is described briefly in the 
following: 
 
Initialization and startup of the nodes and their services: 
During this process, all the layers of the nodes are 
started including the services of the nodes. The services 
include virtualized M2M services such as overlay router 
(P2P router), switch, heating regulator, temperature 
sensor, and surveillance camera. 
 
Hierarchical 
Neighbor 
Discovery: 
During 
this 
procedure, the physical router inside the nodes detects 
physical neighbors, and the logical overlay router inside 
some nodes becomes aware of its logical neighbors. The 
length of the logical short-cut, i.e. the intermediate 
wireless hops between the path of neighboring overlay 
nodes, and the delay between logical neighbors have a 
significant contribution to the efficiency of the neighbor 
discovery process. 
 
Network optimization: During this procedure, the 
network creates the physical shortcut. In the simulations, 
the capabilities of the creation of physical short-cut are 
analyzed and evaluated in a functional sense. 
 
Service Discovery: During this procedure, the user is 
searching via the U node for all the services, which are 
available to him/her at the time of the search. The list of 
all the available services is shown as a result of the 
search. The number of discovered services and the 
waiting time of the search have an essential meaning for 
the user. 
 
Service use: During service use, service level payloads 
are transferred from the service node to the user node. 
Measuring the end-to-end delay, the number of physical 
intermediate hops in the route and throughput is used in 
the evaluations. 
 
The measured delays in hierarchical neighbor discovery 
are shown in Figure 20. The delay values are shown on the Y 
axis in seconds as a function of intermediate physical hop 
numbers. In the simulated topology, there were only 1, 2 or 4 
physical hop routes between the overlay neighbors. The 
delays represent time from the sending of NeighborHelloReq  
(DiscoveryReq in step 2 of Figure 7. ) to receiving 
NeighborHelloRsp (DiscoverRep in step 4 of Figure 7. ), i.e. 
the creation of logical short-cuts. The delay includes 
discovery of the physical route to the logical neighbor, and 
delivery of the related messages using the route. The 
measurements indicate that the number of physical hops 
increases the average delay in the hierarchical neighbor 
discovery. However, the variance in the measured delays in 
the hierarchical neighbor discovery is quite a high. The 
reason for this is assumed to be the loss of messages in the 
simulated radio channel (Propagation/TwoRayGround) or message 
drops in the physical router queue (Queue/DropTail/PriQueue). 
 
 
Topology 1
4,107
4,108
4,109
4,11
4,111
4,112
4,113
4,114
4,115
4,116
0
0,032787
0,04918
0,098361
Clustering degree
Throughput kBit/s
61 nodes
Topology 2
4,1
4,102
4,104
4,106
4,108
4,11
4,112
4,114
0
0,02
0,03
0,06
Clustering degree
Throughput kBit/s
100 nodes
Topology 3
4,096
4,097
4,098
4,099
4,1
4,101
4,102
4,103
4,104
0
0,013333333
0,02
Clustering degree
Throughput kBit/s
150 nodes
Topology 4
4,088
4,09
4,092
4,094
4,096
4,098
4,1
4,102
0
0,01
0,015
0,03
Clustering degree
Throughput kBit/s
200 nodes
 

138
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
set val(chan) Channel/WirelessChannel 
;# channel type 
set val(prop) Propagation/TwoRayGround 
;# radio propagation model 
set val(netif) Phy/WirelessPhy 
 
;# wireless 
set val(mac) Mac/802_11 
 
;# MAC type 
set val(ifq)  Queue/DropTail/PriQueue 
;# queue type 
set val(ll) LL 
 
 
;# link layer type 
set val(ant)  Antenna/OmniAntenna 
;# antenna type 
… 
# unity gain, omni-directional antennas 
# set up the antennas to be centered in the node and 1 meter above it 
Antenna/OmniAntenna set X_ 0 
Antenna/OmniAntenna set Y_ 0 
Antenna/OmniAntenna set Z_ 0.95 
Antenna/OmniAntenna set Gt_ 1.0 
Antenna/OmniAntenna set Gr_ 1.0 
 
# Initialize the SharedMedia interface with parameters to make 
# it work like the 914MHz Lucent WaveLAN DSSS radio interface 
Phy/WirelessPhy set CPThresh_ 10.0 
Phy/WirelessPhy set CSThresh_ 1.559e-11 
Phy/WirelessPhy set RXThresh_ 3.652e-10 
Phy/WirelessPhy set Rb_ 2*1e6 
 
# Transmitter power is divided by 100 for the smaller nodes. 
# The range is about 50 meters 
Phy/WirelessPhy set Pt_ 0.002818 
Phy/WirelessPhy set freq_ 914e+6  
set val(chan) Channel/WirelessChannel 
;# channel type 
set val(prop) Propagation/TwoRayGround 
;# radio propagation model 
set val(netif) Phy/WirelessPhy 
 
;# wireless 
set val(mac) Mac/802_11 
 
;# MAC type 
set val(ifq)  Queue/DropTail/PriQueue 
;# queue type 
set val(ll) LL 
 
 
;# link layer type 
set val(ant)  Antenna/OmniAntenna 
;# antenna type 
… 
# unity gain, omni-directional antennas 
# set up the antennas to be centered in the node and 1 meter above it 
 
Antenna/OmniAntenna set X_ 0 
Antenna/OmniAntenna set Y_ 0 
Antenna/OmniAntenna set Z_ 0.95 
Antenna/OmniAntenna set Gt_ 1.0 
Antenna/OmniAntenna set Gr_ 1.0 
 
# Initialize the SharedMedia interface with parameters to make 
# it work like the 914MHz Lucent WaveLAN DSSS radio interface 
 
Phy/WirelessPhy set CPThresh_ 10.0 
Phy/WirelessPhy set CSThresh_ 1.559e-11 
Phy/WirelessPhy set RXThresh_ 3.652e-10 
Phy/WirelessPhy set Rb_ 2*1e6 
 
# Transmitter power is divided by 100 for the smaller nodes. 
# The range is about 50 meters 
 
Phy/WirelessPhy set Pt_ 0.002818 
Phy/WirelessPhy set freq_ 914e+6  
Phy/WirelessPhy set L_ 1.0 
Figure 19.  The simulation parameters. 
The number of discovered services and the waiting time 
of the search have an essential meaning for the user. The 
discovered services are shown as printed output from the U 
nodes 0 and 1 in a simulation execution in Figure 21. In the 
example simulation execution, 6 services were discovered 
out of 16 possible. The service reply messages from the P2P 
router C and D and sensor nodes j, h and g were dropped in 
the simulated radio channel, and therefore the services 
behind them were not discovered. The measured waiting 
time of the service discovery results was on average 0.4573 
sec. The example service discovery simulation case indicates 
that loss of messages in the wireless channels causes 
undiscovered services unless reliable delivery services are 
not provided by the communication layer for the services 
layer. 
During service use, service level payloads are transferred 
from the service node to the user node. The measured 
performance of simulated service use is shown in Tab I. 
When increasing the sending power, the number of 
intermediate hops decreases. For example, in our topology 
visualized in Fig. 6, the number of intermediate nodes 
between U-nodes 0 and 1 was reduced from 5 to 3. As a 
result of this, the end-to-end delay was decreased from 30.2 
ms to 17.9 ms. In addition; throughput is also improved 
somewhat, from 4.1268 kbit/s to 4.1272 kbit/s. The measured 
performance of simulated service use indicates that the 
establishment of wireless short-cuts can be very useful, 
because it reduces the number of intermediate hops, makes 
end-to-end delay shorter and improves throughput. 
Simulation of dynamic network optimization proved to 
be very challenging with the NS-2 simulator, because it did 
not seem to be possible to change the transmission power or 
applied radio technology dynamically after the node had 
been created in the simulator. 
 
0
0,05
0,1
0,15
0,2
0,25
0,3
0,35
0,4
0
1
2
3
4
5
Neighbor Discovery 
Delay
Lowest Neighbor 
Discovery Delay
Highest Neighbor 
Discovery Delay
 
 
Figure 20.  Average delays in seconds in hierarchical neighbor discovery. 
 
Figure 21.  The discovered services in the U – nodes. 
**************** Node 0's Services at 200.00 **************** 
 -- Location / Updated / Service -- 
 --      l   /   98.22  / H_sensor_A2  -- 
 --      k   /   96.21  / T_sensor_A1  -- 
 --      F   /   150.12  / P2P_Router4  -- 
 --      G   /   150.40  / P2P_Router5  -- 
 --      d   /   150.40  / H_Regul_G1  -- 
 --      i   /   150.40  / T_sensor_G2  -- 
 --      o   /   150.40  / S_camera_G4  -- 
 --      H   /   150.44  / P2P_Router6  -- 
 --      c   /   150.44  / H_Regul_H1  -- 
 --      D   /   150.45  / P2P_Router2  -- 
 ******************************************************** 
 **************** Node 1's Services at 200.00 ***************** 
 -- Location / Updated / Service -- 
 --      g   /   88.17  / A_sensor_B1  -- 
 ******************************************************** 
 
 

139
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
TABLE I.  
MEASURED PERFORMANCE OF SIMULATED SERVICE USE 
Sending 
power Pt_ 
Number of 
intermediate hops 
End to end 
delay ms 
Throughput 
kbit/s 
0.009818 
3 
17.9 
4.1272 
0.002818 
5 
30.2 
4.1268 
 
D. Discussion 
The problem in flat route discovery is that search queries 
are also forwarded in the deep leaves of the search trees. This 
problem is solved in the hierarchical routing in the sense that 
only the nearest logical overlay nodes are initially searched 
at the physical route level. The result of this step is 
discovered physical routes between neighboring overlay 
nodes. After this phase, the network can be optimized by 
removing non-optimal radio links and physical routers from 
the referred local physical path. The result of this step can be 
direct connection between neighboring overlay nodes, which 
may be most optimal for local communication. When an 
application message needs to be sent, then searching of the 
end-to-end route is triggered. If network optimization has 
been successful, then the search paths depths are as in 
overlay search, i.e. significantly lower than the search path 
depths for the end-to-end physical routes. The evaluations 
also indicate that then  the number of control message send 
actions and delay of the search are also lower. In addition, 
the search queries do not unnecessarily disturb the nodes, 
which are in the deep leaves of the search trees. 
The measurements of hierarchical neighbor discovery 
simulations indicate that the number of physical hops 
increases the average delay in the hierarchical neighbor 
discovery, but the variance is quite high because of message 
losses in the communication channel. The loss of messages  
also causes undiscovered services when no reliable 
communication is provided by communication layer to the 
services layer. The measured performance of simulated 
service use indicates that the establishment of wireless short-
cuts can be useful, because it decreases the number of 
intermediate hops, makes end-to-end delay shorter and 
improves throughput. 
The evaluations of the hierarchical routing have been 
carried out in multiple steps: theoretical evaluation of the Hi-
Search algorithm, simulation of the network optimization 
and simulation of the procedures. The theoretical evaluation 
is limited in the sense that only one example network has 
been represented; however, the aim is to enlarge and 
generalize the graph theoretical evaluation in the next step. 
Limitations of the NS-2 environment cause serious 
challenges in simulation-based evaluation of network 
optimization and procedures. This is because it is not 
possible to simulate properly the features of dynamic 
wireless networks, such as, for example, changing the 
transmission power, changing applied radio technology 
dynamically after the node has been created, and having 
more than one different radio and network interfaces for a 
single node. Therefore, evaluation of the network 
optimization and procedures was limited here to quite simple 
topologies without any mobility. The aim in the next step is 
to simulate more complicated dynamic networks, more 
complex topologies, mobility and advanced features of 
hierarchical network with NS-3, and also to evaluate in a real 
experimental case. 
VI. CONCLUSIONS 
The evaluation indicates that the search path depths for 
the Hi-Search algorithm are lower than the search path 
depths for the end-to-end physical routes. The logical short-
cuts, i.e. the physical routes between logically neighboring 
vertices, are searched only once, which reduces the number 
of required control message send actions. The search delays 
are lower compared with physical routing. The network 
optimization removes weak and high delay edges and 
vertices from the path, which may make the delay difference 
between physical search and Hi-Search algorithm even 
greater. The evaluation of network optimization indicates 
that increasing the number of referred physical short-cuts 
reduces the end-to-end delays, makes the physical routes 
shorter, and also improves throughput. When the degree of 
clustering increases, the physical routes become shorter and 
the performance of the system improves. The detected 
evaluation results of the network optimization with physical 
short-cuts conforms quite well to the phenomenon of small 
world and scale-free networks. The evaluation of procedures 
indicates that the average delays in neighbor discovery are 
increased by the number of physical hops. In addition, 
message losses in the radio channel increases variance in the 
neighbor discovery delays. Generally speaking, the service 
discovery delays were at a feasible level in the simulated 
topology. However, loss of messages in the wireless 
channels causes undiscovered services. The measured 
performance of simulated service use indicates that the 
establishment of physical short-cuts can be useful, because it 
reduces the number of intermediate hops, makes end to end 
delay shorter and improves throughput. 
Summarizing, the evaluation results indicate that the Hi-
Search algorithm with network optimization  is able to lower 
search delays, make the physical routes shorter, and also 
improve throughput. In addition, solving the complexity and 
heterogeneity problems is made possible by localizing route 
search and abstracting communication to two different 
routing layers. However, because of practical limitations 
with the applied simulation platform, it was not possible to 
simulate properly dynamic features of different topologies 
and mobility. Therefore, the aim in the next step is to work 
with more complicated dynamic networks, more complex 
topologies, 
mobility 
and advanced 
features of 
the 
hierarchical network with NS-3, and also to evaluate 
hierarchical routing in a real experimental platform. 
ACKNOWLEDGMENT 
We would like to thank Tekes and VTT for funding this 
work. 
 
REFERENCES 

140
International Journal on Advances in Internet Technology, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/internet_technology/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
[1] Latvakoski J., A Hierarchical routing algorithm for small 
world wireless networks. The Fifth International Conference 
on Communication Theory, Reliability, and Quality of 
Service, CTRQ 2012. 6p. 
[2] Latvakoski, J. Towards hierarchical routing in small world 
wireless networks. The Fifth International Conference on 
Wireless and Mobile Communications ICWMC 2009. 
[3] Latvakoski, J. Hierarchical routing concept for small world 
wireless wetworks. 6 p.  ICWMC 2010: The Sixth 
International 
Conference 
on 
Wireless 
and 
Mobile 
Communications September 20-25, 2010 - Valencia, Spain. 
[4] Latvakoski, J. and Aapaoja, T. Towards a Routing Overlay 
for a Mobile Ad hoc Network. 6p. First International 
Workshop on Convergence of Heterogeneous Wireless 
Networks (ConWiN) 10th Jul 2005 Budapest, Hungary. 8p. 
[5] Latvakoski J., Aapaoja T., and Kärnä J. Evaluation of routing 
overlay solution for a Hybrid Mobile ad hoc networks. 12p. 
ERCIM Emobilty workshop. 28-30 May 2008 Tampere, 
Finland. 12p. 
[6] Milgram S. The small world problem. Psychol. Today 2, Pp 
60-67. 1967 
[7] Watts D. and Strogatz S. Collective Dynamics of small world 
networks. Nature Vol 393. Pp 440-442. 1998. 
[8] Korzun, D. and Gurtov, A. 2011, "Survey on hierarchical 
routing schemes in “flat” distributed hash tables", Peer-to-
Peer Networking and Applications, vol. 4, no. 4, pp. 346-375. 
[9] L. Adamic, “The small world web,” in Proc. Eur. Conf. on 
Digital Libraries(ECDL), Sept. 1999, pp. 443–452. 
[10] A. Broder, R.Kumar, F. Maghoul, P. Raghavan, S. 
Rajagopalan, R. Stata A. Tomkins, and J. Wiener, “Graph 
structures in the web,” Computer Networks, vol. 33, pp. 309–
320, June 2000. 
[11] R. Albert, H. Jeong, and A. Barabasi, “Diameter of the world 
wide web,” Nature, vol. 401, pp. 130–131, 1999. 
[12] Bettstetter C, (ed) Self-Organization in Communication 
Networks: Overview and State of the Art. Wireless world 
research forum white paper. Version 1.2. Aug 11, 2005. 44p. 
[13] Helmy, A. Small Worlds in Wireless Networks. IEEE 
Communications Letters, Vol 7. No 10. October 2003. 
[14] Verma, C.K., Tamma, B.R., Manoj, B.S., and Rao, R. 2011, 
"A Realistic Small-World Model for Wireless Mesh 
Networks", IEEE Communications Letters, vol. 15, no. 4, pp. 
455-457. 
[15] Orier R., Templin F., and Lewis M. 2004. Topology 
Dissemination based on reverse-Path Forwarding (TBRF). 
IETF RFC 3684. Feb 2004. 
[16] Perkins C., Royer-Belding E., and Das S. RFC 3561. Ad hoc 
On-Demand Distance Vector Routing. IETF. Jul 2003. 
http://tools.ietf.org/html/rfc3561,  Available 26th Nov 2012. 
[17] Clause T. and Jacquet, P. (eds). Optimized Link State Routing 
Protocol 
(OLSR). 
IETF 
RFC 
3626. 
http://www.ietf.org/rfc/rfc3626.txt. Available 26th Nov 2012. 
[18] Ian D. Chakeres and Charles E. Perkins Dynamic MANET 
On-Demand Routing Protocol. IETF Internet Draft, draft-ietf-
manet-dymo-12.txt, February 2008 (Work in Progress). 
Retrieved 2, 2012. 
[19] Luciana Pelusi, Andrea Passarella,  and Marco Conti. (2006). 
"Opportunistic Networking: Data Forwarding in Disconnected 
Mobile Ad hoc Networks." IEEE Communications Magazine 
Nov 2006: Pp. 134-141. 
[20] V.Cerf (ed) (2007) Delay-Tolerant Networking Architecture. 
IETF RFC 4838. Apr 2007. 
[21] Latvakoski, J. and Hautakoski, T. Situated Message Delivery 
for Opportunistic Networks. 9p. ICT Mobile and Wireless 
Communications 
Summit 
2008. 
 
10-12 
Jun 
2008. 
Stockholm/Sweden. 
[22] Sylvia Ratnasamy, P. F., Mark Handley, and Richard Karp 
(2001). 
"A 
Scalable 
Content-Addressable 
Network." 
SIGCOMM'01, Aug 27-31, San Diego, USA: Pp. 161-171. 
[23] Ion Stoica, R. M., David Krager, M. Frans Kaashoek, and 
Hari Balakrishnan (2001). "Chord: A Scalable Peer-to-peer 
Lookup Service for Internet Applications." SIGCOMM'01, 
Aug 27-31, San Diego, USA 
[24] Ben Y. Zhao, L. H., Jeremy Stribiling, Sean C.Rhea, Anthony 
D. Joseph, and Jon D. Kubiatowicz (2004). "Tapestry: A 
Resilient Global-Scale Overlay for Service Deployment." 
IEEE  Journal on Selected Areas in Communications Vol 
22(No 1, January 2004): Pp. 41-53. 
[25] Antony 
Rowstron, 
P. 
D. 
(2001). 
"Pastry: 
Scalable, 
decentralized object location and routing for large-scale peer-
to-peer 
systems." 
Proceedings 
of 
18th 
IFIP/ACM 
International Conference on Distributed Systems Platforms 
(Middleware 2001). Heidelberg,D. 
[26] Nicholas J.A.Harvey, M. B. J., Stefan Saroiu, Marvin 
Theimer, and Alec Wloman (2003). "SkipNet: A Scalable 
Overlay Network with Practical Locality Properties." 
Proceedings of USITS Seattle, WA. Mar 2003.: 14. 
[27] Ben Y. Zhao, Y. D., Ling Huang, Anthony D. Joseph, and Jon 
D. Kubiatowicz (2002). "Brocade: Landmark Routing on 
Overlay 
Networks." 
Proceedings 
of 
1st 
International 
Workshop on Peer-to-peer Systems, IPTPS'02.: 6p. 
[28] Arturo Crespo and H. G.-M. (2002). "Semantic Overlay 
Networks for P2P Systems." Computer Science Department, 
Stanford University. CA USA.: 15p. 
[29] Liu, X., Guan, J., Bai, G., and Lu H. 2009, "SWER: small 
world-based efficient routing for wireless sensor networks 
with 
mobile 
sinks", 
FRONTIERS 
OF 
COMPUTER 
SCIENCE IN CHINA, vol. 3, no. 3, pp. 427-434. 
[30] Belding‐Royer, E.M. 2002, "Hierarchical routing in ad hoc 
mobile networks", Wireless Communications and Mobile 
Computing, vol. 2, no. 5, pp. 515-532. 
[31] Helmy A., Garg S., and Nahata N. CARD: A contact-based 
Architecture for Resource Discovery in Wireless Ad hoc 
Networks. Mobile networks and applications 10, pp. 99-113. 
2005. Springler-Verlag. 
[32] Jiang C-J, Chen C., Chang J-W., Jan R-H., and Chiang T. C.. 
Construct Small Worlds in Wireless Networks using Data 
Mules. Pp 28-35. Proceedings of IEEE International 
Conference 
on 
Sensor 
Networks, 
Ubiquitous, 
and 
Trustworthy Computing. Pp. 28-35. 
[33] Ken Y.K. Hui, John C.S. Lui, and David K.Y. Yau. Small 
world overlay P2P Networks. Quality of Service, 2004. 
IWQOS 2004. Twelfth IEEE International Workshop on 7-9 
June 2004. Pp. 201 – 210. 
[34] Narten T., Nordmark E., and Simpson W. Neighbor 
Discovery 
for 
IP 
version 
6. 
IETF 
RFC 
2461. 
http://www.ietf.org/rfc/rfc2461.txt. Available 26th Nov 2012. 
[35] Clausen T., Dearlove C., and Dean J. MANET Neighborhood 
Discovery Protocol (NHDP), http://tools.ietf.org/html/draft-
ietf-manet-nhdp-04, Expires December 31, 2007. Available 
26th Nov 2012. 
 
 
 
 
 
 

