Using Visible Light Communication to Guide Mobile Users Inside Large Buildings 
 
Manuela Vieira, Manuel Augusto Vieira, Paula Louro, 
Alessandro Fantoni 
ADETC/ISEL/IPL,  
R. Conselheiro Emídio Navarro, 1959-007  
Lisboa, Portugal 
CTS-UNINOVA  
Quinta da Torre, Monte da Caparica, 2829-516,  
Caparica, Portugal 
  
e-mail: mv@isel.ipl.pt, mv@isel.pt, plouro@deetc.isel.pt, 
afantoni@deetc.isel.ipl.pt 
 
Pedro Vieira 
ADETC/ISEL/IPL,  
R. Conselheiro Emídio Navarro, 1959-007  
Lisboa, Portugal 
Instituto das Telecomunicações  
Instituto Superior Técnico, 1049-001,  
Lisboa, Portugal 
e-mail: pvieira@isel.pt 
 
Abstract— The main goal of this paper is a Visible Light 
Communication (VLC) based guidance system to be used by 
mobile users inside large buildings. This system is composed of 
several transmitters (ceiling luminaries), which transmit map 
information and path guidance messages. Mobile devices, with 
VLC support, decode the information. A mesh cellular hybrid 
structure is proposed. The luminaires, via VLC, deliver their 
geographic position and specific information to the users, 
making them available for whatever use they request. The 
communication protocol, coding/decoding techniques, and 
error control are examined. Bidirectional communication is 
implemented and the best route to navigate through venue 
calculated. We propose several guidance services and multi-
person cooperative localization. By analyzing the results, it 
became clear that the system not only provides self-location, 
but also the capability to determine the direction of travel and 
to interact with information received in order to optimize the 
route towards a static or dynamic destination. 
 
Keywords- Visible Light Communication; Assisted indoor 
navigation; Bidirectional Communication; Optical sensors; 
Transmitter/Receiver;  Edge-Fog architecture.  
I. 
INTRODUCTION 
This paper is an extended and polished version of the 
paper presented in SENSORDEVICES 2022 conference [1]. 
The main goal is to specify the system conceptual design 
and define a set of use cases for a VLC based guidance 
system to be used by mobile users inside large buildings. 
The most obvious method of using guidance signs is 
through billboards located in high traffic areas. Handheld 
devices allow customers to stay informed, gather 
information and communicate with others without being 
tied to a physical location.  
With the rapid increase in wireless mobile devices, the 
continuous increase of wireless data traffic has brought 
challenges to the continuous reduction of radio frequency 
(RF) spectrum, which has also driven the demand for 
alternative technologies  [ 2 ][ 3 ]. In order to solve the 
contradiction between the explosive growth of data and the 
consumption of spectrum resources, VLC has become the 
development 
direction 
of 
the 
next 
generation 
communication network with its huge spectrum resources, 
high security, low cost, and so on [4][5].  
With the increasing shortage of radio frequency 
spectrum and the development of Light-Emitting Diodes 
(LEDs), VLC has attracted extensive attention. Compared to 
conventional wireless communications, VLC has higher 
rates, lower power consumption, and less electromagnetic 
interferences. VLC is a data transmission technology that 
can easily be employed in indoor environments since it can 
use the existing LED lighting infrastructure with simple 
modifications [6][7]. The use of white polychromatic LEDs 
offers the possibility of Wavelength Division Multiplexing 
(WDM), which enhances the transmission data rate. A 
WDM receiver based on tandem a-SiC:H/a-Si:H pin/pin 
light controlled filter can be used [8][9] to decode the 
received information. Here, when different visible signals 
are encoded in the same optical transmission path, the 
device multiplexes the different optical channels, performs 
different filtering processes (amplification, switching, and 
wavelength conversion) and finally decodes the encoded 
signals recovering the transmitted information. 
Visible light can be used as an Identifier (ID) system and 
can be employed for identifying the building itself. The 
main idea is to divide the service area into spatial beams 
originating from the different ID light sources and identify 
each beam with a unique timed sequence of light signals. 
The signboards, based on arrays of LEDs, positioned in 
strategic directions [10], are modulated acting as down- and 
up-link channels in the bidirectional communication. For the 
consumer 
services, 
the 
applications 
are 
enormous. 
Positioning, navigation, security and even mission critical 
services are possible use cases that should be implemented.  
In this paper, a VLC based guidance system to be used 
by mobile users inside large buildings is proposed. After the 
Introduction, in Section II, a model for the system is 
proposed and the communication system described. In 
Section III and Section IV, the main experimental results are 
presented, 
downlink 
and 
uplink 
transmission 
is 
31
International Journal on Advances in Systems and Measurements, vol 16 no 1 & 2, year 2023, http://www.iariajournals.org/systems_and_measurements/
2023, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

implemented and the best route to navigate calculated. In 
Section V, the conclusions are drawn. 
II. 
SYSTEM MODEL 
The system model of the proposed system will be 
presented in this section.  
 
A. 
Communication system 
The system model is composed by two modules: the 
transmitter and the receiver. The block diagram is presented 
in Figure 1. Both communication modules are software 
defined, where modulation/demodulation can be programed. 
 
Optical Channel (LOS)
pin/pin Mux 
device
Receiver circuit
Decoding
Message Output
Receiver
Data
Encoding
Map information
Buddy localisation
RGBV 
LEDs
Luminaires
Signboard
Transmitter
System 
controller
OOK 
Modulation
Driver 
circuit
Amplification 
and filtering
 
Figure 1. Block diagram.  System model of the proposed control scheme 
applied to OOK modulation.  
Data from the sender is converted into an intermediate 
data representation, byte format, and converted into light 
signals emitted by the transmitter module. The data bit 
stream is input to a modulator where an ON–OFF Keying 
(OOK) modulation is utilized. On the transmission side, a 
modulation and conversion from digital to analog data is 
done. The driver circuit will keep an average value (DC 
power level) for illumination, combining it with the analog 
data intended for communication. The visible light emitted 
by the LEDs passes through the transmission medium and is 
then received by the MUX device.  
To realize both the communication and the building 
illumination, white light tetra-chromatic sources (WLEDs) 
are used providing a different data channel for each chip. 
The transmitter and receiver relative positions are displayed 
in Figure 2a. Each luminaire is composed of four 
polichromatic WLEDs framed at the corners of a square. At 
each node, only one chip is modulated for data transmission 
(see Figure 2b), the Red (R: 626 nm¸ 25 μW/cm2), the 
Green (G: 530 nm, 46 μW/cm2), the Blue (B: 470 nm, 60 
μW/cm2) or the Violet (V, 400 nm, 150 μW/cm2). Data is 
encoded, modulated and converted into light signals emitted 
by the transmitters. Modulation and digital-to-analog 
conversion of the information bits is done using signal 
processing techniques. An OOK modulation scheme was 
used to code the information. This way digital data is 
represented by the presence or absence of a carrier wave. 
 The signal is propagating through the optical channel, 
and a VLC receiver, at the reception end of the 
communication link, is responsible to extract the data from 
the modulated light beam. It transforms the light signal into 
an electrical signal that is subsequently decoded to extract 
the transmitted information. The obtained voltage is then 
processed, by using 
signal conditioning 
techniques 
(adaptive bandpass filtering and amplification, triggering 
and demultiplexing), until the data signal is reconstructed at 
the data processing unit (digital conversion, decoding and 
decision) [11] [12]. At last, the message will be output to 
the users. 
 
 
 
R
B
G
V
LED Transmitters
pinpin receivers
FVO
 
a) 
400
500
600
700
0,0
0,2
0,4
0,6
0,8
1,0
V
B
G
R
 
 
Normalized sensitivity
Wavelength (nm)
 B
 C
 D
 E
b) 
c) 
Figure 2. a)3D relative positions of the transmitters and receivers. b) 
Spectra of the input channels. c)Configuration and operation of the pin/pin 
Mux device 
On the receiving side, a MUX photodetector  acts as an 
active filter for the visible region of the light spectrum. The 
integrated filter consists of a p-i'(a-SiC:H)-n/p-i(a-Si:H)-n 
heterostructure with low conductivity doped layers [7] as 
displayed in Figure 2c. Independent tuning of each channel 
is performed by steady state violet optical bias (bias= 2300 
μW/cm2) superimposed from the front side of the device and 
the generated photocurrent measured at -8V. The generated 
photocurrent is processed using a transimpedance circuit 
obtaining a proportional voltage. Since the photodetector 
response is insensitive to the frequency, phase, or 
polarization of the carriers, this kind of receiver is useful for 
intensity-modulated signals. After receiving the signal, it is 
in turn filtered, amplified, and converted back to digital 
32
International Journal on Advances in Systems and Measurements, vol 16 no 1 & 2, year 2023, http://www.iariajournals.org/systems_and_measurements/
2023, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

format for demodulation. The system controller consists of a 
set of programmable modules. 
In this system model, there are a few assumptions that 
should be noted: The channel state information is available 
both at the receiver and the transmitter; compared with the 
direct light, the reflected light is much weaker in the indoor 
VLC systems; only the Line OF Sight (LOS) path is 
considered and the multipath influence is not considered in 
the proposed indoor VLC system.  
The received channel can be expresssed as: 
 
y=μhx+n         
 
where y represents the received signal, x the transmitted 
signal, μ is the photoelectric conversion factor which can be 
normalized as μ = 1, h is the channel gain and n is the 
additive white Gaussian noise of which the mean is 0. 
The LEDs are modeled as Lambertian sources where the 
luminance is distributed uniformly in all directions, whereas 
the luminous intensity is different in all directions. The 
luminous intensity for a Lambertian source is given by 
Equation (2) [13]: 
 
 Iሺ∅ =𝐼𝑁 cos ∅𝑚 ;  m=
𝑙𝑛ሺ2 
𝑙𝑛 cos ∅1/2  
 
IN is the maximum luminous intensity in the axial 
direction,  is the angle of irradiance and m is the order 
derived from a Lambertian pattern. For the proposed 
system, the commercial white LEDs were designed for 
illumination purposes, exhibiting a wide half intensity angle 
(1/2) of 60º. Thus, the Lambertian order m is 1. Friis’ 
transmission equation is frequently used to calculate the 
maximum range by which a wireless link can operate. The 
coverage map is obtained by calculating the link budget 
from the Friis transmission equation [14].         
The Friis transmission equation relates the received 
power (PR) to the transmitted power (PE), path loss distance 
(LR), and gains from the emitter (GE) and receiver (GR) in a 
free-space communication link. 
 
          PR [dBm]=PE [dBm]+GE [dB]+GR [dB]-LR [dB] 
 
 
(3) 
Taking into account Figure 2a, the path loss distance and 
the emitter gain will be given by:  
 
LR [dB]=22 +20ln d
 
 
 
( 
 
                    GE [dB]= 
ሺ𝑚 + 1 𝐴
2𝜋𝑑𝐸−𝑅
2
Iሺ∅  cos ሺ𝜃  
 
 
 
  
With A the area of the photodetector and dE_R the 
distance between each transmitter and every point on the 
receiver plane. Due to their filtering properties of the 
receptors the gains are strongly dependent on the 
wavelength of the pulsed LEDs. Gains (GR) of 5, 4, 1.7 and 
0.8 were used, respectively, for the R, G, B and V LEDs. IN 
of 730 mcd, 650 mcd, 800 mcd and 900 mcd were 
considered. The coverage map, for a square unit cell, is 
shown in   Figure 5.  
 
B. 
Building model and  Architecture 
Lighting in large environments is designed to illuminate 
the entire space in a uniform way. The proposed scenario is 
a multi-level building. Ceiling plans for the LED array 
layout, in floor level is shown in Figure 3. A square lattice 
topology was considered for each level. 
1
R5,2,1
V4,3,1
B4,2,1
G5,3,1
1
1
1
1
2
2
4
5
4
5
5
6
6
6
8
8
8
9
9
9
9
8
4
2
4
6
2
3
7
G3,3,1
R3,2,1
3
3
4
2
2
2
9
9
1
1
1
1
1
7
4
6
6
8
8
8
8
5
7
2
2
8
6
6
6
4
4
4
5
V2,3,1
5
B2,2,1
V2,1,1
R5,4,1
B4,4,1
3
R3,4,1
3
3
B2,4,1
G5,1,1
V4,1,1
7
7
G3,1,1
7
G1,1,1
G1,3,1
R1,4,1
R1,2,1
G5,5,1
V4,5,1
G3,5,1
V2,5,1
G1,5,1
1
2
8
4
5
6
1
1
1
1
1
1
2
2
2
2
2
2
6
6
6
6
6
9
9
5
9
9
8
8
8
8
8
8
4
4
4
4
4
3
3
9
7
9
7
7
7
7
Level 1
7
 
Figure 3. Clusters of cells in square topology.  Illustration of the optical 
scenario. (RGBV =modulated LEDs spots).  
In fog /edge computing, computing, storage, networking, 
and data management services are provided on nodes within 
close proximity to IoT devices, bridging the gap between 
the cloud and end devices.  
R
B
G
V
R
B
G
V
R
B
G
V
•
Luminaire
Router node
I2D
D2D
D2I
•
receiver
•
Luminaire/signboard
•
mesh/cellular node
I2CM
I2I
Datacentre
(CM)
I2I
 
 
Figure 4. Mesh and cellular hybrid architecture.  
In Figure 4, the proposed architecture is illustrated. 
Under this architecture, the short-range mesh network 
purpose is twofold: enable edge computing and device-to-
(1) 
(2) 
G1,1,0
V1,2,0
R1,2,0
B2,2,0
X
Y
Z
B1,2,-1
V1,1,1
R2,2,1
G1,2,1
V1,1,-1
R2,2,-1
B1,2,1
G1,2,-1
Floor 1
Floor 0
Floor -1
P (x,y,z)
(4) 
(5) 
33
International Journal on Advances in Systems and Measurements, vol 16 no 1 & 2, year 2023, http://www.iariajournals.org/systems_and_measurements/
2023, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

cloud communication, by ensuring a secure communication 
from a luminaire controller to the edge computer or 
datacenter (I2CM), through a neighbor luminaire/signboard 
controller with an active cellular connection; and enable 
peer-to-peer communication (I2I), to exchange information. 
A user navigates from outdoor to indoor. It sends a 
request message (D2I) to find the right track and, in the 
available time, he adds customized points of interest 
(guidance services). The requested information (I2D) is sent 
by the emitters at the ceiling to its receiver. 
In this architecture, the polychromatic WLEDs are 
placed on the ceiling in a square lattice topology (see Figure 
3), but only one, chip is modulated (R, G, B, V). The 
principle is that each WLED transmits a VLC signal with a 
unique identifier. The optical receiver uses this information 
and a position algorithm, based on the received joint 
transmission, calculates the track of the user.  
To 
receive 
the 
I2D 
information 
from 
several 
transmitters, the receiver must be located at the overlap of 
the circles that set the transmission range (radial) of each 
transmitter.  
G
V
B
R
#1
RGBV
#4
RBV
#6
GBV
#8
RGV
#2
RGB
#7
GV
#9 RG
#3
RB
#5 BV
a) 
 
1
2
3
7
5
9
6
8
4
450
y
t2 (goal point)
t1 (current point)
N
S
E
NE
W
NW
SW
SE
x
b) 
 
 
Figure 5. Illustration of the coverage map in the unit cell: a) Footprint 
regions (#1-#9). b) Steering angle codes (2-9). 
Taking into account (1)-(5), the coverage map for a 
square unit cell is displayed in Figure 5. All the values were 
converted to decibel (dB). The nine possible overlaps (#1-
#9), defined as fingerprint regions, as well as receiver 
orientations (2-9 steering angles; ) are also pointed out for 
the unit square cell, in Figure 5. The input of the aided 
navigation system is the coded signal sent by the 
transmitters to an identified user (I2D), and includes its 
position in the network P(x, y, z), inside the unit cell and the 
steering angle, , that guides the user across his path at a 
given time, t. The device receives multiple signals, finds the 
centroid of the received coordinates, and stores it as the 
reference point position. Nine reference points, for each unit 
cell, are identified giving a fine-grained resolution in the 
localization of the mobile device across each cell. 
The indoor route throughout the building (track; q(x, y, z, 
, t)) is presented to the user by a responding message (I2D) 
transmitted by the ceiling luminaires that work also either as 
router or mesh/cellular nodes.  
Two-way communication (D2I-I2D) between users and 
the infrastructure is carried out through a neighbor 
luminaire/signboard controller with an active cellular 
connection (I2CM). With this request/response concept, the 
generated landmark-based instructions help the user to 
unambiguously identify the correct decision point where a 
change of direction (pose) is needed, as well as offer 
information for the user to confirm that he/she is on the right 
way. 
C. Communication protocol, coding/decoding techniques 
and error control 
0.0
1.0
2.0
3.0
Error
PB
PG
PR
Parity signal (I2)
ID
Sinc.

 MUX signal (I1)
1110
CODEWORD
Wayfinding Data
  pin1pin2  
z
y
x
0000
1111
V4,3,1
B4,4,1
G3,3,1
R3,4,1
 
 
MUX signal
Time (ms)
 R1
 G1
 B1
 V1
 1
 R2
 G2
 B2
 RB2
a) 
0.0
1.0
2.0
3.0
RGBV
p7
p4
p5
p6
p1
p3
p2
p0
1010
1100
0110
0100
0010
1000
d13
d15
d14
d11
d12
d10
d9
d8
d7
d3
d4 d5
d6
d1
d0
d2
PB
PG
PR
Parity signal
 MUX signal
1110
CODEWORD
0000
1111
V
B
G
R
 
 
MUX signal
Time (ms)
 R1
 G1
 B1
 V1
 1
 R2
 G2
 B2
 RB2
b) 
Figure 6.  Code and parity MUX/DEMUX signals. On the top the 
transmitted channels [R G B V : PR PG PB] are shown. a) Calibrated cell. b) 
Error control assigned to a request from user “7261” at C4,3,1; #1 N. 
Steering angle code  1 
2 
3 
4 
5 
6 
7 
8 
9 
Square topology () 
- 
(SE)º 
 (E) 
 (NE) 
 (N) 
(NW) 
 (W) 
 (SW) 
 (S) 
 
34
International Journal on Advances in Systems and Measurements, vol 16 no 1 & 2, year 2023, http://www.iariajournals.org/systems_and_measurements/
2023, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Using the photocurrent signal measured by the 
photodetector, it is necessary to decode the received 
information. A calibration curve is previously defined to 
establish this assignment [15]. As displayed in Figure 6b, 
calibration curves make use of 16 distinct photocurrent 
thresholds which correspond to a bit sequence that allows all 
the sixteen combinations of the four RGBV input channels 
(24). If the calibrated levels (d0-d15) are compared to the 
different four-digit binary codes assigned to each level, then 
the decoding is obvious, and the message may be read [14]. 
Due to the proximity of successive levels (see Figure 6a) 
occasional errors occur in the decoded information. A parity 
check is performed after the word has been read [16]. The 
parity bits are the SUM bits of the three-bit additions of 
violet pulsed signal with two additional RGB bits and 
defined as: 
 
PR= Vx R x B; PG= Vx R x G;  PB= V x G x B  (6) 
 
In Figure 6b, the MUX signal that arises from the 
transmission of the four calibrated RGBV wavelength 
channels and the MUX signal that results from the 
generation of the synchronized parity MUX are displayed. 
On the top the seven bit word [R,G,B,V, PR, PG, PB] of the 
transmitted inputs guides the eyes. The colours red, green, 
blue and violet were assigned respectively to PR, PG , PB and 
PV. For simplicity the received data (d0-15 levels) is marked 
in the correspondent MUX slots as well as the parity levels 
marked as horizontal lines. On the top the decoded 7-bit 
coded word is exhibited. In the right side 4-bit binary codes 
assigned to the eight parity sublevels are inserted.  
In Figure 6a we illustrate how error control is achieved 
using check parity bits. A request from user "7261" is 
shown at C4,3,1; #1 N, along with the matching parity signal. 
To automate the process of recovering the original 
transmitted data, an algorithm was developed. The 
transmitted data is decoded by comparing the code MUX 
signal with the parity MUX levels. The decoding algorithm 
is based on a proximity search [17]. 
For each time slot, the data are translated into a vector in 
multidimensional space, which is determined by the signal 
currents I1 and I2, where I1 is the d level and I2 is the p level 
for the 4-bit codeword (RGBV). The corresponding parity 
levels, [PR, PG PB] in the respective time slot are also 
obtained and are assumed to be correct. The result is then 
compared with all vectors resulting from the calibration 
sequence (Figure 6a) where each code level, d (0-31) is 
assigned the corresponding parity level, p (0-15). Euclidean 
metrics are used to calculate distances.  
The tests were done with a variety of random sequences, 
and we were able to recover the original colour bits. Figure 
7 illustrates the encoding/decoding process with and without 
check parity error. In Figure. 7a, the encoded optical signals 
(codewords) and the experimental received signals are 
depicted. After encoding, Figure 7b shows how information 
can be recovered with and without error control. The 
encoded signals transmitted by the LEDs are determined 
through the interpolation of the signals received by the 
photodiode, (MUX and Parity, Figure 6a), with the 
calibration curves (Figure 6b). 
Mux Signals
Encoded signals
Time (ms)
Time (ms)
R G B V
PR PGPB
MUX
Parity
a) 
      
Parity
control
No error 
control
V4,3,1
PR
B4,4,1
G3,3,1
R3,4,,1
Error 
control
PB
PG
V5,1,1
B5,4,1
G3,3,1
R3,4,,1
Time (ms)
b) 
Figure 7.  Encoding/decoding process with and without check parity error. 
a) Transmitted code signals [R G B V : PR PG PB] and received MUX and 
Parity signals. b) Decoded information with and without error control 
assigned to a request from user “7261” at cell C4,3,1 #1 NE. 
 
Results show that without check parity bits, decoding 
was difficult primarily when levels were close together 
(dotted arrow). Based on the results for the analysed cases, 
the BER is high (4.6% without error correction) whereas it 
is negligible with error correction. 
III. 
COOPERATIVE SELF-LOCALIZATION AND GUIDANCE 
SERVICES 
Concepts of self-localization and route control will be 
present in this section. 
 
A. Self-localization 
Self-localization is a fundamental issue since the person 
must be able to estimate its position and orientation (pose) 
within a map of the environment it is navigating. We 
consider the path to be a geometric representation of a plan 
35
International Journal on Advances in Systems and Measurements, vol 16 no 1 & 2, year 2023, http://www.iariajournals.org/systems_and_measurements/
2023, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

to move from a start pose to a goal pose (Figure 5). Let us 
consider a person navigating in a 2D environment. Its non-
omnidirectional configuration is defined by position (x, y) 
and orientation angle , with respect to the coordinate axes. 
q(t) = [x(t), y(t), (t)] denote its pose at time t, in a global 
reference frame. In cooperative positioning systems, persons 
are divided into two groups, the stationary persons and the 
moving persons. Let us consider that qi(t,t´) represents the 
pose of person i at time t´ relative to the pose of the same 
person at time t and qij(t) denotes the pose of person j 
relative to the pose of person i at time t. qi(t,t´) is null for 
people standing still and non-zero if they move. These three 
types of information qi (t), qi (t,t´)and qij (t) compose the 
basic elements of a pose graph for multi-person cooperative 
localization. 
We consider that the risk of catching a disease exists if 
qij(t) is less than 2 m. The system will alert the users to stay 
away from those regions and to plan the better route to the 
desired wayfinding services. To estimate each person track 
the pure pursuit approach [18][19] is used. The principle 
takes into account the curvature required for the mobile 
receiver to steer from its current position (t1) to its intended 
position (t2). By specifying a look-ahead distance, it defines 
the radius of an imaginary circle. Finally, a control 
algorithm chooses a steering angle in relation to this circle. 
This then allows to iteratively construct the intermediate 
arcs between itself and its goal position as it moved, thus, 
obtaining the required trajectory for it to reach its objective 
position. To avoid the risk of transmission, in the same 
frame of time and in known crowded regions, qij(t) is 
estimated and the steering angle readjusted [20].  
  
B. Geotracking, Navigation and Route Control 
VLC geotracking is the process of identification or 
estimation of the geographic position of a device through 
visible light. It involves the generation of a set of 
geographic coordinates but its usefulness is enhanced by the 
use of these coordinates to determine a meaningful location, 
to help the user navigation through an unfamiliar building or, 
to guide him to an intended destination or planned meeting.  
In Figure 8, the MUX received signal and the decoding 
information that allows the VLC geotracking and navigation 
in successive instants (t0, t1, t2) from user “7261” guiding 
him along his track is exemplified. In the right side, the 
match between the MUX signals and the 4-binary codes are 
pointed out (horizontal dotted lines) to facilitate the 
decoding process. On the top, the decoded channels packets 
are shown [R, G, B, V]. The visualized cells, paths and the 
reference points (footprints) are also shown as inserts.  
After decoding the MUX signals, and taking into 
account the frame structure, the ID of the receiver in the 
network (footprint and 3D coordinates), wayfinding services 
required (pin1, pin2) orientation () and wayfinding data are 
revealed.  
 
0.0
1.0
2.0
3.0
4.0
5.0
ID
Sinc.
E
SE
SE

t1
t2
G3,3,1
#2
#1
B4,2,1
R3,2,1
t2
t0
1010
#3
t1
t0
   Wayfinding Data               
R3,2,1
1110
B4,2,1
pin1pin2
z
y
x
0000
1111
V4,1,1
B4,2,1
G3,1,1
R3,2,1
 
 
MUX signal
Time (ms)
 R1
 G1
 B1
 V1
 1
 R2
 B2
 RB
 R3
 G3
 B3
 RG
 
 
Figure 8. Fine-grained indoor localization and navigation in successive 
instants. On the top the transmitted channels packets are decoded [R, G, B, 
V] 
Data shows that as a receiver moves between generated 
point regions, the received information pattern changes. 
Between two consecutive data sets, there is always a 
navigation data bit transition (channels are missing or 
added). At t0, a maximum in the synchronism amplitude was 
detected and corresponds to the binary word [1111], 
meaning that the user has received the overlap transmission 
from all the four channels, footprint #1, while at t1 the green 
and violet channels were missing, indicating footprint #3, 
and at t3 the green channel from an adjacent cell was added, 
footprint #2. The transmitter’s node address comes directly 
from the ID bits. At t0 the network location of the received 
signals are R3,2,1, G3,1,1, B4,2,1 and V4,1,1, at t1 the user 
receives the signal only from the R3,2,1, B4,2,1 nodes and at t2 
he was moved to the next cell since the node G3,1,1was 
added at the receiver. The next 12 bits identify the user code 
(pin1, “7621”), the meeting code, (pin2, 3) and the steering 
angles () required for the mobile receiver to steer from its 
current position (#1) to its intended position (#9). Finally, 
the last block is reserved for the transmission of the 
wayfinding message (Payload data). Hence, the mobile user 
“7261” begins his route into position #1(t0) and wants to be 
directed to his goal position, in the next cell (# 9). During 
the route the navigator is guided to E (code 3) and, at t1, 
steers to SE (code 2), cross footprint #2 (t3) and arrives to #9. 
The proposed VLC dynamic geolocation system gives 
every location a unique perceptual identity, so that the 
navigator can associate their immediate surroundings (unit 
cell) with a location in the larger space (building network). 
This is one of the main principles of wayfinding. The ceiling 
lamps (landmarks) are spread over all the building and can 
act as edge/fog nodes in the network (see Figure 4), 
providing well-structured paths that maintain a navigator’s 
#1E
2
7
5
5
9
9
6
6
8
8
4
4
V4,3,1
V4,1,1
B4,2,1
R3,2,1
G3,1,1
G3,3,1
6
8
7
#3
1
SE
SE
#2
36
International Journal on Advances in Systems and Measurements, vol 16 no 1 & 2, year 2023, http://www.iariajournals.org/systems_and_measurements/
2023, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

orientation with respect to both the next landmark along the 
path and the distance to the eventual destination. Also, the 
VLC dynamic system enables cooperative and oppositional 
geolocation. In some cases, it is in the user’s interest to be 
accurately located, so that they can be offered information 
relevant to their location and orientation (pin1, pin2 and  
blocks). Since geolocation software can get the information 
of user location, companies using geomarketing may 
provide web content or products that are famous or useful in 
that specific location. In other cases, users prefer not to 
disclose their location for privacy, in this case these last 
three blocks are set to zero and the user only receives its 
own 
location. 
This 
architecture 
also 
allows 
that 
advertisements and content on a website that uses 
geolocation software may be tailored to provide the 
information that a certain user wants. 
IV. 
MULTI-PERSON COOPERATIVE LOCALIZATION AND 
GUIDANCE SERVICES 
 A VLC system consists of two entities, infrastructure 
and device (I and D), which establish bidirectional 
communication through cellular edge nodes. Bi-directional 
communication between VLC emitters and receivers is 
available at a VLC ready handheld device, through the 
control manager interconnected with a signboard receiver 
located at each unit cells (#1). Via the control manager, a 
handheld device with VLC connectivity communicates 
bidirectionally with a signboard receiver in each unit cell 
(#1). Each user (D2I) uplinks to the local controller a 
“request” message with the pose, qi (t), (x, y, z, ), user code 
(pin1) and also adds its needs (code meeting and wayfinding 
data). For route coordination the CM, using the information 
of the network’s VLC location capability, downlinks a 
personalized “response” message to each client at the 
requested pose with his wayfinding needs (I2D). 
These communication channels constitute the uplink 
(D2I) and downlink channels (I2D) as exemplified in Figure 
9a. Each user (D2I) sends to the local controller a “request” 
message with the pose, qi (t), (x,y,z, ), user code (pin1) and 
also adds its needs (code meeting and wayfinding data). For 
route coordination the CM, using the information of the 
network’s VLC location capability, sends a personalized 
“response” message to each client at the requested pose with 
his wayfinding needs. 
In Figure 9b, the MUX synchronized signals received by 
two users that have requested guidance services, at different 
times, are displayed. We have assumed that a user located at 
C2,3,-1,  arrived first (t1), auto-identified as ("7261") and 
informed the controller of his intention to find a friend for a 
previously scheduled meeting (code 3). A buddy list is then 
generated and will include all the users who have the same 
meeting code. User “3009” arrives later (t3), sends the alert 
notification (C4,4,1; t3) to be triggered when his friend is in 
his floor vicinity, level 1, identifies himself (“3009”) and 
uses the same code (code 3), to track the best way to his 
meeting.  
Request
Response
I
D
D
D
a) 
 
0.0
1.0
2.0
3.0
4.0
5.0
#1
#6
t3
t1
7261
3009
#6
V4,5,1
G3,5,1
=180
o
=180
o

#1
   Wayfinding Data               
R3,4,1
0111
B4,4,1
z pin1pin2
y
x
0000
1111
V2,3,-1
B2,4,-1
G1,3,-1
 
 
MUX signal
Time (ms)
 G1
 B1
 V1
 GBV23-1
 R3
 G3
 V3
 B3
 RGBV4414
b) 
Figure 9. a) Communication channels established between the 
infrastructure and the vehicles for geolocation and navigation. b) 
MUX/DEMUX signals assigned requests from two users (“3009” and 
“7261”) at different poses (C4,4,,1; #1W and C2,3,-1; #6 W ) and in 
successive instants (t1 and t3). 
Upon receiving this request (t3), the buddy finder service 
uses the location information from both devices to 
determine the proximity of their owners (qij (t)) and provides 
the best route to the meeting, avoiding crowded areas. 
An example of the MUX signals assigned to a 
request/response received by user “3009” during his path to 
reach user “7261” is displayed in Figure 10. In the top of the 
figure, the decoded information is shown and the simulated 
scenario is inserted to guide the eyes.  
The “request” message includes, beyond synchronism, 
the identification of the user (“3009”), its address and 
orientation (C4,4,1, #1W) and the help requested (Wayfinding 
Data). Since a meet-up between users is expected, its code 
was inserted before the right track request. In the 
“response”, the block CM identifies the sender [0000] and 
the next blocks the cell address (C4,4,1), the user (3009) for 
which the message is intended and finally the requested 
information: meeting code 3, orientation NE (code 4) and 
wayfinding instructions.  
 
C
M
3009/3
1
2
3
7
5
9
6
8
4
V2,3,-1
B2,4,-1
R1,4,-1
G1,3,-1
t1
1
4
7
3
9
5
8
6
2
V4,5,1
B4,4,1
R3,4,1
G3,5,1
7261/3
37
International Journal on Advances in Systems and Measurements, vol 16 no 1 & 2, year 2023, http://www.iariajournals.org/systems_and_measurements/
2023, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

0.0
1.0
2.0
3.0
4.0
5.0
response
request
   Wayfinding Data          
3009
3009
CM
NE
 z pin1pin2  
 y
 x
W
#1
V4,5,1
=45
o
=180
o

G3,5,1
#1
   Wayfinding Data               
R3,4,1
B4,4,1
z pin1pin2
y
x
0000
1111
V4,5,1
B4,4,1
G3,5,1
R3,4,1
 
 
MUX signal
Time (ms)
 
Figure 10.  Request from user “3009” and response from the CM to him. 
On the top the transmitted channels packets are decoded [Xi,j,k]. 
1
2
2
7
5
5
9
9
6
6
8
8
4
4
V4,3,1
V4,1,1
B4,2,1
R3,2,1
G3,1,1
G3,3,1
R3,4,1
B4,4,1
V4,5,1
G3,5,1
1
1
3
7
9
9
5
5
6
4
6
4
2
2
8
8
Floor 1
7261/3
3009/3
t2
7
3
1t4
7261/3
2
2
5
9
9
6
6
8
8
4
4
V2,1,-1
V2,3,-1
B2,4,-1
R1,4,-1
G1,3,-1
G1,1,-1
4
9
R1,2,-1
2
8
6
Floor -1
7261/3
5
B2,2,-1
5
3009/3
t3
W
3
7
7
1
3
1
1
W
t1
E
0.0
1.0
2.0
3.0
4.0
5.0
t4
t3
t2
t1
#1
3009
W
R3,4,1
G3,5,1
B4,4,1
V4,5,1
#1
R3,2,1
G3,3,1
B4,2,1
W
7261
V4,3,1
   Wayfinding Data          
7261
7261
E
pin1pin2  
 z
 y
 x
E
#1
V2,3,-1
G1,3,-1
#1
R1,4,-1
B2,4,-1
V4,1,1
B4,2,1
G3,1,1
R3,2,1
 
 
Time (ms)
Figure 11.  Decoded messages from the two users as they travel to a pre-
scheduled meeting. 
 
In response to the estimated relative pose position, qi,j (t), 
between the users with the same meeting code, the CM 
sends a new alert that takes into account the occupancy of 
the service areas along the paths, qi (x,y,z, , t), which 
optimizes the path without crowding the users. This allows 
the CM to recalculate, in real time, the best route for the 
users, qi (t,t´), that request wayfinding services avoiding 
crowded regions. 
In Figure 11, the decoded messages from the two users 
as they travel to the pre-scheduled meeting is displayed.  
Decoded data shows that user “7621” starts (t1) his 
journey on floor -1, C2,3,-1; #1W, goes up to floor 1 in C2,1,-1 
and at t2 he arrives at C4,1,1  heading for E. During his 
journey, user “3009” from C4,4,1 #1 asks the CM (t3) to 
forward him to the scheduled meeting and follows course to 
W. At t4 both friends join in C4,3,1.  
The pedestrian movement along the path can be thought 
as a queue, where the pedestrians arrive at a path, wait if the 
path is congested and then move once the congestion 
reduces. In Figure 12, a graphical representation of the 
simultaneous localization and mapping problem using 
connectivity as a function of node density, mobility and 
transmission range is illustrated.  
. 
 
Map merging
Local map
I2D2I
Local map
D2D
Service distance
D2D
Queue  distance
I2CM
Luminaire (Router nodes)
I2I
I2I
Luminaire/signboard
(mesh/cellular node)
I2I
Datacentre
(CM)
n(qi,j(t))
qK(t0))
qi(t0))
qj(t0))
qi,j(t)
Path
 
Figure 12. Graphical representation of the simultaneous localization and 
mapping problem using connectivity as a function of node density, mobility 
and transmission range. 
The following parameters are therefore needed to model 
the queuing system: The initial arrival time (t0) and the path, 
defined as the time when the pedestrian leaves the previous 
path and the actual movement along the path, qi (t, t’). Here, 
the service time is calculated using walking speed and 
distance of the path. The number of service units or 
resources is determined by the capacity of the pathway, n(qi 
(x,y,z, , t))  and walking speed which depends on the 
number of request services, and on the direction of 
movement along the pathway qi (x,y,z, , t). The pedestrians 
are served as soon as the request message is appended by 
the CM (response message) as displayed in Figure 12. 
1
4
7
3
9
5
8
6
2
V4,5,1
B4,4,1
R3,4,1
G3,5,1
1
4
7
3
9
5
8
6
2
V4,5,1
B4,4,1
R3,4,1
G3,5,1
38
International Journal on Advances in Systems and Measurements, vol 16 no 1 & 2, year 2023, http://www.iariajournals.org/systems_and_measurements/
2023, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

 
If the number of pedestrians exceeds the path capacity, a 
backlog is automatically formed until the starting node. The 
hybrid controller integrates the number of requests and 
individual positions received during the same time interval. 
Once the individual positions are known, qi (t), the relative 
positions are calculated, qij (t). If the relative position is less 
than a threshold distance, a crowded region locally exists, 
and an alert message is sent for the users. This alert allows 
the CM to recalculate, in real time, the best route for the 
users, qi (t,t´), that request wayfinding services avoiding 
crowded regions. 
V. 
CONCLUSIONS 
A VLC based guidance system to be used by mobile 
users inside large buildings was proposed and characterized. 
According to global results, the location of a mobile 
receiver is found in conjunction with data transmission. 
VLC's dynamic LED-aided guidance system is designed to 
give users accurate route guidance and enable navigation 
and geotracking. The multi-person cooperative localization 
system detects crowded regions and alerts the user to 
reschedule meetups, as well as provides guidance 
information. With those alerts, the CM can recalculate, in 
real time, the best route for users requesting wayfinding 
services, avoiding crowded areas. Further research activities 
are still necessary to optimize the coverage, namely the 
effects of synchronization, shadowing and ambient light. 
Also, the LED design and positioning has to be improved in 
the future, in order to optimize the communication 
performance while meeting the illumination constraints. 
ACKNOWLEDGEMENTS 
This work was sponsored by FCT – Fundação para a 
Ciência e a Tecnologia, within the Research Unit CTS – 
Center 
of 
Technology 
and 
Systems, 
reference 
UIDB/00066/2020 and IPL/2022/POSEIDON_ISEL.  
REFERENCES 
 
[1] M. Vieira, M. A. Vieira, P. Louro, A. Fantoni, and P. Vieira, 
“VLC Based Guidance System to Be Used by Mobile Users 
Inside Large Buildings,” SENSORDEVICES 2022: The 
Thirteenth International Conference on Sensor Device 
Technologies and Application Copyright (c) IARIA, 2022. 
ISSN: 2308-3514, ISBN: 978-1-68558-006-3 pp. 9-14. 
[2] F. Zafar, D. Karunatilaka, and R. Parthiban, “Dimming 
Schemes for Visible Light Communication: The State of 
Research, “ IEEE Wireless Commun., 22, pp. 29–35, 2015. 
[3] L. U. Khan, “Visible Light Communication: Applications, 
Architecture, Standardization and Research Challenges,” 
Digit. Commun. Netw. 3, pp. 78–88, 2017.  
[4] N. U. Hassan, A. Naeem, M. A. Pasha, T. Jadoon, and C. 
Yuen, “Indoor positioning using visible led lights: A 
survey,”ACM Comput. Surv., vol. 48, pp. 1–32,  2015. 
[5] E. Ozgur, E. Dinc, and O. B. Akan, “Communicate to 
illuminate: State-of-the-art and research challenges for visible 
 
light communications,” Physical Communication 17, pp. 72–
85, 2015. 
[6] D. Tsonev et al., “A 3-Gb/s single-LED OFDM-based 
wireless VLC link using a Gallium Nitride μLED,” IEEE 
Photon. Technol. Lett. 26 (7), pp. 637–640,  2014. 
[7] D. O’Brien et al., “Indoor visible light communications: 
challenges and prospects,” Proc. SPIE 7091, 709106, 2008. 
[8] M. Vieira, P. Louro, M. Fernandes, M. A. Vieira, A. Fantoni 
and J. Costa “Three Transducers Embedded into One Single 
SiC Photodetector: LSP Direct Image Sensor, Optical 
Amplifier and Demux Device,” Advances in Photodiodes 
InTech, Chap.19, pp. 403-425, 2011. 
[9] M. A. Vieira, P. Louro, M. Vieira, A. Fantoni, and A. Steiger-
Garção, “Light-activated amplification in Si-C tandem 
devices: A capacitive active filter model,” IEEE Sensor 
Journal, 12, NO. 6,  pp. 1755-1762, 2012. 
[10] S. B. Park et al., “Information broadcasting system based on 
visible light signboard,” presented at Wireless and Optical 
Communication 2007, Montreal, Canada, 2007. 
[11] M. Vieira, M. A. Vieira., P. Louro., P. Vieira, A. Fantoni, 
“Light-emitting diodes aided indoor localization using visible 
light communication technology,” Opt. Eng. 57(8), 087105, 
2018. 
[12] M. A. Vieira, M. Vieira, P. Louro, and P. Vieira, "Bi-
directional communication between infrastructures and 
vehicles through visible light," Proc. SPIE 11207, Fourth 
International Conference on Applications of Optics and 
Photonics, 
112070C 
(3 
October 
2019); 
doi: 
10.1117/12.2526500. 2019. 
[13]  Y. Zhu, W. Liang, J. Zhang, and Y. Zhang, “Space-
Collaborative Constellation Designs for MIMO Indoor 
Visible Light Communications,” IEEE Photonics Technology 
Letters, vol. 27, no. 15, pp. 1667–1670,  2015. 
[14]  H. T. Friis, “A note on a simple transmission formula,” Proc.  
IRE34, pp. 254–256, 1946. 
[15] M. Vieira, M. A. Vieira, P. Louro, A. Fantoni, P. Vieira, 
"Dynamic VLC navigation system in Crowded Buildings," 
International Journal On Advances in Software, vol. 14, no. 
3&4, pp. 141-150, 2021. 
[16] M. A. Vieira, M. Vieira, V. Silva, P. Louro, and J. Costa, 
“Optical signal processing for data error detection and 
correction using a-SiCH technology,” Phys. Status Solidi C 
vol. 12, no. 12, pp. 1393–1400, 2015. 
[17] M. A. Vieira, M. Vieira, P.  Louro, V. Silva, J.  Costa, and A. 
Fantoni, “SiC Multilayer Structures as Light Controlled 
Photonic Active Filters,” Plasmonics, vol. 8, no. 1, pp. 63-70, 
2013. 
[18]  R. Rajamani, “Dynamic Vehicle and control,” Mechanical 
Engineering Series, ISBN 978-1-4614-1433-9 . 2012. 
[19]  J. Ackermann, J.  Guldner, W. Sienel, R. Steinhauser, and  V. 
Utkin, “Linear and Nonlinear Controller Design for Robust 
Automatic Steering,” IEEE Transactions on Control Systems 
Technology, vol. 3, no. 1, pp. 132 – 143, Mar. 1995, 
DOI: 10.1109/87.370719.   
[20] M. Vieira, M. A. Vieira, P.  Louro, A. Fantoni, and  P. Vieira, 
"Geolocation and communication in unfamiliar indoor 
environments through visible light," Proc. SPIE 11706, Light-
Emitting Devices, Materials, and Applications XXV, 
117060P (5 March 2021).   
39
International Journal on Advances in Systems and Measurements, vol 16 no 1 & 2, year 2023, http://www.iariajournals.org/systems_and_measurements/
2023, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

