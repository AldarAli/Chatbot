SL(2,R) Multi-scale Contour Registration Based on
Riemannian Calculation
Khaoula Sakrani
CRISTAL Laboratory, GRIFT Group
National School of Computer Science
Manouba university, Tunisia
Email. sakrani.khaoula@gmail.com
Sinda Elghoul
CRISTAL Laboratory, GRIFT Group
National School of Computer Science
Manouba university, Tunisia
Email. sinda.elghoul@ensi-uma.tn
Faouzi Ghorbel
CRISTAL Laboratory, GRIFT Group
National School of Computer Science
Manouba university, Tunisia
Email. faouzi.ghorbel@ensi-uma.tn
Abstract—We introduce a novel Affine multi-scale registration
based on the Riemannian metric in the Lie group SL(2, R) to
estimate the best alignment between two planar curves. First, we
smooth and re-simpling the input shapes. Then, in each level, we
compute the special linear transformations Aσp and translation
vectors Bσp using the pseudo-inverse algorithm. The obtained
matrices Aσp are then projected in the Lie algebra of SL(2, R)
which is sl(2, R) to compute their average. In the final step, we
register and calculate the L2 distance.
Keywords—Multi-scale registration; Special affine transformation;
Riemannian metric; Affine Spacial group SA(2, R).
I. INTRODUCTION
The comparison process between images is complicated and
restricted when the images were captured using multiple
sensors and poses and were not shot simultaneously. Most
of the time, a machine will not be able to find the same
thing in different pictures because it can change. In this
situation, it is challenging to integrate two comparable forms.
To address these issues, researchers created different curve
registration methods. The main goal of this method is to find
the geometric transformation between two or more images in
order to get the most desirable alignment. The registration of
the planar curves’ shapes is the optimum solution that has been
presented for a great number of applications, including motion
tracking [1], mosaicing [2] [3], object recognition [4], remote
sensing [5], 3D curve reconstruction [6] [7] and medical
image analysis [8] [9]. Different methods of shape registration
have been proposed in recent years to estimate motion and
align two shapes. Thus, 2D affine shapes can be registered
using techniques that rely on the Riemannian calculation. The
authors in [10] introduce a subspace method for aligning two
2D shapes and estimating the affine transformation between
them. By minimizing the projection error in the subspace
spanned by the two shapes, the affine transformation is es-
timated in the proposed 2D signal method. Bryner et al. [11]
propose a broad Riemannian framework for shape analysis
of planar objects, whose metrics and related quantities are
invariant under the action of affine and projective groups.
Within the framework of landmark-based shape analysis, Sparr
[12] develops affine shape theory through the use of sub-
space computations. Begelfor and Werman [13] provide a
Riemannian geometric metric for computing the averages and
distributions of point configurations, such that configurations
up to affine transformations are regarded as equivalent. Also,
authors in [14] introduce a framework for contour-based shape
analysis based on Riemannian geometry that is robust against
affine transformation and contour re-parameterization. By in-
tegrating the Iwasawa decomposition of GL(2, R) and Lie
group parametrization into the regular Iterative Closest Point
(ICP) method, Ying et al. [17] introduce new techniques for
2D affine shape registration. Moreover, authors in [18] show
how to find a geodesic that is invariant to scale, translation,
rotation, and re-parameterization using a Riemannian quasi-
Newton approach. YI MA [28] highlights how multiple-view
geometry can be studied in three-dimensional spaces with
constant curvatures, like Euclidean space, spherical space, and
hyperbolic space. In [29], the authors talk about the manifold
and Lie group SO(n) of special orthogonal related to the non-
negative independent component analysis (ICA). Huang et al.
[30] come up with a new way to use Riemannian optimization
to align curves in elastic shape analysis.
The purpose of this paper is to introduce a novel Affine Multi-
Scale Curve Registration that employs Riemannian geometry.
For this technique, two curves are taken as input (the source
image and the target image), and then they are sequentially
smoothed and reparametrized with affine arc-length. The
pseudo-inverse algorithm is then used to compute the special
linear transformations Aσp and translation vectors Bσp for
each smoothed and reparametrized shape. These matrices Aσp
belong to the affine spacial group SA(2, R). The average of
these matrices, A, is then found using Riemannian calculation
in SA(2, R). Finally, the alignment process is done.
The following is the outline for this paper: In Section II, we
present the affine multi-scale curve registration based on the
Riemannian calculation that we propose. In Section III, we
assess the performance of the suggested methods for shape
retrieval with MCD. Ultimately, a final conclusion is reached.
II. AFFINE MULTI-SCALE CURVE REGISTRATION BASED
ON RIEMANNIAN CALCULATION
Here, we will talk about the main parts of the proposed
method, which is called Affine Multi-Scale Curve Registration
based on Riemannian calculation. In this new method, the
input normalized contours are filtered over and over again,
51
Copyright (c) IARIA, 2023.     ISBN:  978-1-68558-057-5
SIGNAL 2023 : The Eighth International Conference on Advances in Signal, Image and Video Processing

and the Riemannian calculation in the special linear group
SL(2, R) is used to find the best transformation. Fig. 1
demonstrates the Affine Multi-Scale Curve Registration based
on the Riemannian calculation procedure.
• A-1: Normalize the input shapes f and h using the affine
arc-length normalization [15]. Fig.2 shows two shapes
that have been normalized with affine arc-length.
• A-2: Convolve each of the two re-sampling curves using
the Gaussian calculation [15], where the resulting curve
is depicted in Fig.3.
• A-3: The obtained p systems at each level are formed by
the following 2N linear equations.





hσ1(l1) = Aσ1fσ1(l1) + Bσ1
hσ1(l2) = Aσ1fσ1(l2) + Bσ1
...
hσ1(lN) = Aσ1fσ1(lN) + Bσ1





hσ2(l1) = Aσ2fσ2(l1) + Bσ2
hσ2(l2) = Aσ2fσ2(l2) + Bσ2
...
hσ2(lN) = Aσ2fσ2(lN) + Bσ2
(1)
...





hσp(l1) = Aσpfσp(l1) + Bσp
hσp(l2) = Aσpfσp(l2) + ˆBσp
...
hσp(lN) = Aσpfσp(lN) + Bσp
• A-4, A-5: The Aσp matrices, which contain the elements
of the special affine group SA(2, R), and the Bσp trans-
lation vectors, are obtained by performing the pseudo-
inverse calculation [16] on each system.
• A-6: Riemannian calculation in SA(2, R).
We provide a brief introduction to the Special Affine
SA(2), which is the underlying geometric space for non-
rigid registration. In affine space, the special affine group
consists of transformations by scaling, rotation, and then
translation. Specifically, it is the semi-direct product of
the Special Linear group SL(2) and R2.
SA(2) = SL(2) × R2
(2)
It is worth remembering that a Lie group is both a group
and a differential manifold, and that a Lie algebra is a
vector space on which a Lie bracket is defined.
The SL(2, R) special linear group contains all determi-
nants of unit size that are real matrices of size 2 by 2.
SL(2, R) =

A ∈ R2/det(A) = 1
	
(3)
An Iwasawa decomposition exists for this 2-dimensional
Lie group SL(2, R) of real matrices.
SL(2, R) = AshearAscaleArotation
(4)
In our case, the affine transformation matrices Aσp ∈
SL(2, R) and Ashear represent shears, Ascale is for
scales and Arotation list the rotation matrices.
Aσp =
a11σp
a12σp
a21σp
a22σp

Aσp = AshearAscaleArotation
(5)
Aσp =
1
b
0
1

×
a
0
0
1/a

×
cos θ
− sin θ
sin θ
cos θ

(6)
=
a cos θ
b a cos θ − (1/a) sin θ
a sin θ
b a sin θ + (1/a) cos θ

with det(Aσp) = 1, a ∈ R∗ and θ, b ∈ R.
The Lie algebra of SL(2, R) is denoted by sl(2, R), and
is identified with the set of 2 × 2 matrices and they have
a basis provided by en:n = 1, 2, 3.
e1 =
1
0
0
−1

,
e2 =
0
1
0
0

,
e3 =
0
0
1
0

(7)
Lie group theory relies heavily on the Lie algebra of a
Lie group since it encodes many of the group’s global
topological features. Exp, a local diffeomorphism, is
also known as exponential mapping.
In the first step, we do the projection in the space tangent
of the Aσp matrices using the following equation Eq (8)
[19].
Once calculated, the logarithm map of matrices belonging
to the lie algebra elements ln(Aσp) ∈ sl(2, R) is pro-
jected in the tangent space, and we are in the vector space
where the matrices must satisfy the following conditions
Eq(9):

ln(Aσp) ∈ sl(2, R)/Tr(ln(Aσp)) = 0
	
.
(9)
Therefore the exponential mapping of the logarithm map-
ping ln(Aσp) is expressed as below in Eq(10) [19]:
• A-7: The registration is then performed using the special
linear transformation A obtained after the Riemannian
calculation and the translation vector B deduced after
applying average arithmetic.
A =
a11
a12
a21
a22

B =
Bx
By

(11)
Finally, we calculate the euclidean distance L2, which is
denoted by:
L2 = min
(A,B = ∥Af (la) + B − h (la)∥2 ≈ e
(12)
III. EXPERIMENTS
In this section, we compare the proposed Affine Multi-Scale
Curve Registration based on Riemannian metrics to the cur-
rently available shape alignment methods and present the
recognition rates of each. The MCD dataset is used for testing.
A. MCD image database retrieval
One of the most important uses of the proposed algorithm is
in shape registration. Therefore, we will evaluate the Affine
Multi-Scale Curve Registration based Riemannian metrics on
the Multiview Curve Dataset (MCD) [20], which is made
up of 40 shape classes from the MPEG-7 database. Figure
52
Copyright (c) IARIA, 2023.     ISBN:  978-1-68558-057-5
SIGNAL 2023 : The Eighth International Conference on Advances in Signal, Image and Video Processing

Fig. 1. Workflow of multi-scale contour registration using Riemannian calculation
(a)
(b)
Fig. 2. Example of re-sampling shapes with affine arc-length parametrization
Fig. 3. Example of a convolved shape
4 shows that there are 14 different curves in each of these
categories that are distorted in the same way as the original
curve.
In Table 1, we compare our methods to some of the cur-
rent state-of-the-art studies. We discovered that our technique
(89.21%) performs better than Arber (41%) [21], SC (56.29%)
[22] , Huang (71%) [23], Rube (79%) [24], and Mai (89%)
TABLE I. RETRIEVAL RESULTS ON THE ENTIRE MCD DATASET
Methods
Average
Arber [21]
41%
SC [22]
56.29%
Huang [23]
71 %
Rube [24]
79 %
Mai [25]
89 %
Our method
89.21%
Fast and non-rigid global registration [26]
92.8%
ACMA [16]
94 %
Partial Contour Matching Based on ACSS [27]
95.98%
AMSCR [15]
96.36 %
AMSCR with Binary-EM [15]
96.58 %
[25]. Our method, on the other hand, is less effective than the
methods of fast and non-rigid global registration (92.8%) [26]
and ACMA (94%) [16]. Moreover, when compared to AMSCR
(96.36%) [15] and AMSCR with Binary-EM (96.58%) [15],
our technique demonstrated its limits. The difficulty of the
computation in SL(2, R), which will be resolved in future
work, demonstrates this limitation clearly.
In Figure 5 we see an example of successfully registered
shapes made with our approach.
IV. CONCLUSION AND FUTURE WORK
In this paper, we suggested a new affine multi-scale curve
registration method based on the Riemannian calculation that
deals with occlusion and affine transformations. First, the two
curves are normalized and smoothed out on different scales.
So, for each level, we have several rectangular linear systems.
The pseudo-inverse computation is used for each level to
compute the special linear transformations Aσp and translation
vectors Bσp. Afterward, the average of the Aσp matrices is
then calculated using the Riemannian metric in the spatial
affine group SA(2, R). After that, the two shapes are lined
up, and the euclidean distance L2 is calculated.
Despite the novelty of the proposed method, the obtained
results are not always as good as those of other methods since
several numerical challenges remain, such as the choice of the
point in the tangent space and the shape’s starting point. So,
in the future, we will be working to resolve these issues.
53
Copyright (c) IARIA, 2023.     ISBN:  978-1-68558-057-5
SIGNAL 2023 : The Eighth International Conference on Advances in Signal, Image and Video Processing

if
a11σp + a22σp ⩾ 2
ln(Aσp) =
ln
h
a11σp + a22σp +
q
(a11σp + a22σp )2 − 4

/2
i
q
(a11σp + a22σp )2 − 4
a11σp − a22σp
2a12σp
2a21σp
a22σp − a11σp

if − 2 < a11σp + a22σp ≤ 2
ln(Aσp) =
arccos
h
a11σp + a22σp

/2
i
q
4 − (a11σp + a22σp )2
 a11σp − a22σp
2a12σp
2a21σp
a22σp − a11σp

(8)
if
a2
11σp + a12σp a21σp ≥ 0
Aσp = cosh
hq
a2
11σp + a12σp a21σp
i
I + ln

general curves, using factorization and bundle adjustment. International
Journal of Computer Vision, 41(3), 171-182.
[7] Mai, F., Hung, Y. S., & Chesi, G. (2010). Projective reconstruction of
ellipses from multiple images. Pattern Recognition, 43(3), 545-556.
[8] Roche, A., Pennec, X., Malandain, G., & Ayache, N. (2001). Rigid
registration of 3-D ultrasound with MR images: a new approach com-
bining intensity and gradient information. IEEE transactions on medical
imaging, 20(10), 1038-1049.
[9] Rui, W., & Minglu, L. (2003, September). An overview of medical
image registration. In Proceedings Fifth International Conference on
Computational Intelligence and Multimedia Applications. ICCIMA 2003
(pp. 385-390). IEEE.
[10] Mai, F., Chang, C. Q., & Hung, Y. S. (2011). A subspace approach for
matching 2D shapes under affine distortions. Pattern Recognition, 44(2),
210-221.
[11] Bryner, D., Klassen, E., Le, H., & Srivastava, A. (2013). 2D affine
and projective shape analysis. IEEE transactions on pattern analysis and
machine intelligence, 36(5), 998-1011.
[12] Sparr, G. (1992). Depth computations from polyhedral images. Image
and Vision Computing, 10(10), 683-688.
[13] Begelfor, E., & Werman, M. (2006, June). Affine invariance revisited.
In 2006 IEEE Computer Society Conference on Computer Vision and
Pattern Recognition (CVPR’06) (Vol. 2, pp. 2087-2094). IEEE.
[14] Bryner, D., Srivastava, A., & Klassen, E. (2012, June). Affine-invariant,
elastic shape analysis of planar contours. In 2012 IEEE Conference on
Computer Vision and Pattern Recognition (pp. 390-397). IEEE.
[15] Sakrani, K., Elghoul, S., Falleh, S., & Ghorbel, F. (2021, December).
SA (2, R) Multi-scale contour registration based on EM Algorithm. In
2021 International Conference on Visual Communications and Image
Processing (VCIP) (pp. 1-5). IEEE.
[16] Elghoul, S., & Ghorbel, F. (2022). A fast and robust affine-invariant
method for shape registration under partial occlusion. International
Journal of Multimedia Information Retrieval, 11(1), 39-59.
[17] Ying, S., Peng, Y., & Wen, Z. (2011). Iwasawa decomposition: a
new approach to 2D affine registration problem. Pattern Analysis and
Applications, 14(2), 127-137.
[18] You, Y., Huang, W., Gallivan, K. A., & Absil, P. A. (2015, December). A
Riemannian approach for computing geodesies in elastic shape analysis.
In 2015 IEEE Global Conference on Signal and Information Processing
(GlobalSIP) (pp. 727-731). IEEE.
[19] Qiao, Z.,& Dick, R. (2019). Matrix logarithms and range of the expo-
nential maps for the symmetry groups, and the Lorentz group. Journal
of Physics Communications, 3(7), 075008.
[20] Zuliani, M., Bhagavathy, S., Manjunath, B. S., & Kenney, C. S. (2004,
October). Affine-invariant curve matching. In 2004 International Con-
ference on Image Processing, 2004. ICIP’04. (Vol. 5, pp. 3041-3044).
IEEE.
[21] Arbter, K., Snyder, W. E., Burkhardt, H., & Hirzinger, G. (1990).
Application of affine-invariant Fourier descriptors to recognition of 3-D
objects. IEEE Transactions on pattern analysis and machine intelligence,
12(7), 640-647.
[22] Mori, G., Belongie, S., & Malik, J. (2005). Efficient shape matching us-
ing shape contexts. IEEE Transactions on Pattern Analysis and Machine
Intelligence, 27(11), 1832-1837.
[23] Huang, X., Wang, B., & Zhang, L. (2005). A new scheme for extraction
of affine invariant descriptor and affine motion estimation based on
independent component analysis. Pattern Recognition Letters, 26(9),
1244-1255.
[24] El Rube, I., Ahmed, M., & Kamel, M. (2005). Wavelet approximation-
based affine invariant shape representation functions. IEEE transactions
on pattern analysis and machine intelligence, 28(2), 323-327.
[25] Mai, F., Chang, C. Q., & Hung, Y. S. (2010, September). Affine-invariant
shape matching and recognition under partial occlusion. In 2010 IEEE
international conference on image processing (pp. 4605-4608). IEEE.
[26] Elghoul, S., & Ghorbel, F. (2021). Fast global SA (2, R) shape
registration based on invertible invariant descriptor. Signal Processing:
Image Communication, 90, 116058.
[27] Elghoul, S., & Ghorbel, F. (2021). Partial Contour Matching Based
on Affine Curvature Scale Space Descriptors. In New Approaches for
Multidimensional Signal Processing (pp. 73-81). Springer, Singapore.
[28] Ma, Y. (2004). A differential geometric approach to multiple view
geometry in spaces of constant curvature. International Journal of
Computer Vision, 58, 37-53.
[29] Plumbley, M. D. (2005). Geometrical methods for non-negative ICA:
Manifolds, Lie groups and toral subalgebras. Neurocomputing, 67, 161-
197.
[30] Huang, W., Gallivan, K. A., Srivastava, A., & Absil, P. A. (2016).
Riemannian optimization for registration of curves in elastic shape
analysis. Journal of Mathematical Imaging and Vision, 54, 320-343.
55
Copyright (c) IARIA, 2023.     ISBN:  978-1-68558-057-5
SIGNAL 2023 : The Eighth International Conference on Advances in Signal, Image and Video Processing

