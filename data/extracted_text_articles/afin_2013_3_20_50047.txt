Method to Minimize Redundancy of Intra-Mode 
 
Kibaek Kim, Dongjin Jung, and Jechang Jeong 
Department of Electronics and Computer Engineering 
Hanyang University 
Seoul, South Korea 
k2b0002@hanyang.ac.kr, dling@naver.com, 
jjeong@hanyang.ac.kr 
 
Gwanggil Jeon 
Department of Electronics and Computer Engineering 
University of Incheon 
Incheon, South Korea 
ggjeon@gmail.com
 
Abstract— In this paper, we present a method to minimize 
redundancy of intra-prediction mode. To minimize spatial 
correlation, H.264/AVC standard utilizes intra-prediction 
approach, which has nine modes for 4x4, 8x8 blocks, and this 
mode information should be signaled and four bits are needed 
to represent nine modes in binary. To minimize the average 
length of mode information, H.264/AVC estimates Most 
Probable Mode (MPM) and if the MPM is the same as the best 
intra-predicted mode, only one bit needs to be signaled. In this 
paper, we propose merging MPM approach to reduce the bits 
for signaling. By using adaptive scheme of intra-mode 
signaling, we could achieve 0.801% bit reduction while giving 
similar performance. In particular, 1.901% bit reduction was 
achieved in low bit rate condition. 
Keywords-H.264/AVC; Intra-prediction; Coding efficiency; 
most probable mode. 
I. 
 INTRODUCTION  
To reduce the coded information of an image within a 
video sequence, Intra-prediction is an efficient tool. Intra-
prediction in the spatial domain was proposed in several 
proposals and was involved into its current form of 
H.264/AVC [1-3]. Intra-prediction is to create a predictor 
block by extrapolation of neighboring coded block’s pixels. 
The predictor block is subtracted from the target block and 
the residual components are coded by using transform, 
quantization and variable length coding. Since there are 
several directions to extrapolate for the target block, we need 
to determine the direction of prediction from neighboring 
coded block’s pixels. H.264/AVC specifies a DC and 8 
directional modes for 4x4 and 8x8 luminance blocks. Only 
DC, horizontal, vertical and planar modes are available for 
16x16 luminance blocks and chrominance blocks. To save 
mode bit to be sent the decoder, H.264/AVC specifies MPM 
that estimate prediction mode by selecting direction having 
small mode number among modes between left and upper 
block. If the best mode is not equal to MPM, we send best 
mode to be selected among remaining modes except MPM. 
Then we need three bits to represent the best mode because 
one is selected among eight candidate modes (except MPM 
out of nine modes).  
H.264/AVC provides several profiles to support various 
video services. Among the profiles, H.264/AVC supports 
baseline profile for low bit rate condition’s devices. For low 
bit rate condition’s devices, we can use high quantization 
parameter (QP) for coding video sequences. In low bit rate 
conditions, the importance of intra-prediction becomes 
higher, so we need to reduce the quantity of mode 
information. To reduce the quantity of mode information, 
Kim et al. [4] proposed an intra-mode skip method based on 
adaptive single-multiple prediction and Zhu et al. [5] 
proposed a clustering approach for reducing the number of 
intra-modes. 
By 
analysis 
on 
neighboring 
block’s 
characteristics, it can reduce the intra-mode bits efficiently. 
Although some tool can be less complex in the encoder, 
analysis can be burden in the decoder complexity.  
In the paper, we focus on the accuracy rate of MPM and 
we try to reduce mode bits efficiently. In the decoder, there 
is no additional analysis, so there is no complex increase. 
The reminder of this paper is organized as follows. In 
Section 2, we present the proposed algorithm. Simulation 
results for a variety of video sequences are provided in 
Section 3. Finally, conclusions are given in Section 4. 
 
II. 
PROPOSED ALGORITHM 
A. Intra-prediction in H.264/AVC 
Intra-prediction is conducted in the transform domain, 
by referring to neighboring samples of previously coded 
blocks, which are to the left and above the block to be 
predicted. Macroblock (MB) is the basic coding unit of 
H.264 and its size is 16x16. According to image 
characteristic, various block size is applied for prediction. 
For luminance samples, intra-prediction may be formed for 
each 4x4 block or for each 8x8 block or a 16x16 block. 
There are a total of 9 optional prediction modes for each 4x4 
and 8x8 luminance block; 4 modes a 16x16 luminance block. 
Similarly for chrominance 8x8 block, 4 modes are supported.  
 
 
(a) 
73
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

 
(b) 
Figure 1. Labelling and direction of intra-prediction, (a) Neighboring 
pixels and pixels of current block (b) Eight directional prediction modes 
 
Figure 1 shows labeling and direction of intra-prediction. 
In Fig. 1(a), the small letter pixels (a~p) are the current 4x4 
block and the capital letters (A~L, Q) are the prediction 
pixels, which are already decoded. Eight of the nine 
directional predictions are already shown in Fig. 1(b), where 
DC prediction (mode 2) that uses the average value of the 
eight boundary pixels (A~D and I~L) as the predictor is not 
shown. Each block is independently coded as one of the 
nine prediction modes. One of these nine modes is selected 
through the Rate-Distortion Optimization (RDO) process 
[6,7]. To efficiently compress the prediction mode in 
H.264/AVC, the prediction mode of the current block is 
estimated from the smaller directional prediction number 
between the above and left adjacent blocks of the current 
block. The estimated prediction mode is called the MPM. 
Just one bit flag is sent to the decoder if the MPM is equal 
to the best mode of the current block that is determined by 
computing a Lagrangian cost function [6] in the H.264/AVC 
encoder. Otherwise, an one bit flag indicating that the MPM 
does not match the best mode of the current block and an 
additional three bits are sent to the decoder to represent one 
of the eight directional modes. 
 
B. Background about statistic of intra-mode 
Figure 2 shows the sample of Keiba3 and City sequence 
and its accuracy rate of MPM, respectively. When QP 
becomes higher, the accuracy rate of MPM also becomes 
high. As shown in Fig. 3, bit rate is more important than 
distortion in low bit rate condition, which loss of residual 
data incurred by big quantization value. RDO is used to 
decide which mode is the most appropriate for each MB or 
block by minimizing the following equation: 
 
( , ,
)
( , ,
)
( , ,
)
J s c Mode
SSD s c Mode
 R s c Mode

 
 
2
( ( , )
( , ))
m
n
x i y
j
SSD
s x y
c x y





                   
(1) 
 
where λ is the Lagrange multiplier for the mode decision 
and Mode indicates the mode chosen from the possible 
prediction mode candidates. SSD is the sum of squared 
differences between the original 4x4 block luminance signal 
(s) and its reconstruction signal (c) and R represents the 
number of bits associated with the chosen Mode. s(x,y) and 
c(x,y) denote the original luminance and reconstructed pixel 
values, respectively. When QP increases, λ also increases. 
Mode with short R (that is, MPM) is advantageous in low bit 
rate condition. High QP means an increase of quantization 
step size. 
  
            
(a) Keiba3 sequence (832x480) 
 
  
            
(b) City sequence (1280x720) 
Figure 2. The sample of Keiba3 and City sequence and its accuracy rate of MPM  
 
74
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

 
 
 
Figure 3. Change of bitstream according to QP increase (QP_A < 
QP_B) 
 
Therefore, intra-prediction mode should be identical to 
MPM to reduce mode bits unless there is big difference in 
terms of distortion. The cases that block’s intra-mode is 
equal to MPM increase according to the increase of QP as 
shown in Fig. 2. When QP is equal to 47, the accuracy rate of 
MPM in Keiba3 and City sequence reach 82% and 86%, 
respectively. It is obvious that the most sequence’s accuracy 
rate of MPM increases according to the increase of QP. That 
the accuracy rate of MPM becomes higher, which means that 
entropy becomes lower. In other words, we can use this 
statistic to reduce the mode information. 
 
C. Proposed method 
Figure 4(a) shows the composition of intra-mode in 
H.264/AVC If MPM is selected as best mode of block, it 
requires one bit. Otherwise, we need four bits to represent 
best mode by using MPM and remaining modes. Since the 
accuracy rate of MPM increases according to the increase of 
QP as shown in Fig. 2, it is wasteful to send MPM per every 
block.  
 
MPM
Remaining 
modes
 
(a) 
Number of 
remaining 
modes in MB
Position 
information of 
remaining 
modes in MB
Remaining 
modes
(b) 
Figure 4. Bit format of the proposed algorithm, (a) conventional method, 
(b) proposed method 
 
We place the MPM into other flags to represent the mode 
information for MBs with a high accuracy rate of MPM. The 
proposed flag contains the number of MPM in MB along 
with the position information of the remaining modes. For 
MBs with a low accuracy rate of MPM, we use the 
conventional method in H.264/AVC. For distinguishing the 
boundary between a high and low accuracy rate of MPM, we 
set a specific threshold as the boundary. If the accuracy rate 
of MPM in an MB is higher than the threshold, the proposed 
method is chosen. Otherwise, the conventional method is 
chosen.  
We changed the bit format as shown in Fig. 4. The 
conventional method to be applied to MB with low accuracy 
rate of MPM is described in Fig. 4(a), while the proposed 
method to be applied to MB with high accuracy rate of MPM 
is described in Fig. 4(b). 
 
 
Start
Initialize: i=16, j=0
S ≥ κ
i > 0
MPM(16-i) = 
best_ipmode(16-i)
j < κ - 1
‘1’
j++
Remaining mode 3 bits
i++
No 
No 
No 
Yes 
Yes 
Yes 
S == i
Yes 
No 
‘0’ flag
i--
‘1’ flag
i ≥ 16
No 
Signal info of position
Remaining mode 3 bits
Yes 
i++
End 
 
Figure 5. Flowchart of the proposed algorithm 
75
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

The proposed method replaces MPM in additional flags. If 
the accuracy rate of MPM in an MB is higher than the 
threshold, then we send the number of blocks. This is 
because the best intra-mode in the block is different from 
MPM, and we denote this as MPMNB, which means the best 
mode is not equal to MPM. If the best intra-mode is equal to 
MPM, we denote this as MPMBM.  
 In the proposed method, blocks with MPMNB are the 
target, so we should signal the position information of blocks 
with MPMNB. Then, one mode among the remaining modes 
except MPM is coded. The proposed method is not effective 
if there are many blocks with MPMNB. The threshold is 
determined empirically, and it should be set as a high 
number. If we set the threshold to thirteen, number of block 
with MPMNB is equal to three. For number of remaining 
modes in MB, it requires three bits by using truncated unary 
binarization [8]. In order to represent the position 
information of block with MPMNB, each block needs four 
bits since a MB has sixteen 4x4 blocks. There are three 
blocks with MPMNB. We need twelve bits. And it requires 
additional nine bits to represent remaining mode of three 
blocks. If we apply this in the proposed method, it requires 
twenty-four bits. In conventional method, we need thirteen 
bits in blocks with MPMBM and twelve bits in blocks with 
MPMNB, respectively. Total twenty-five bits are required in 
conventional method. Through the comparison between two 
methods, we can know that proposed method can save one 
bit compared to the conventional method. However, when 
threshold is lower thirteen, there is no compression effect in 
the proposed method. This is the reason why threshold 
should be set as high number. We can know the range of 
threshold 13 to 16.  
The encoder signals one bit per MB to distinguish 
whether or not the accuracy rate of MPM in an MB is over 
the threshold. Figure 5 shows the flowchart of the proposed 
algorithm, where S is the number of blocks to be MPM as 
the best mode, and κ is the threshold mentioned above. If the 
number of blocks with MPMBM is less than κ, then 
conventional mode signaling is used (this is the same as the 
H.264/AVC case). The proposed algorithm is an adaptive 
scheme that is composed of the proposed intra-mode 
signaling combined with conventional intra-mode signaling. 
The method is determined by the number of blocks with 
MPMBM. In Fig. 5, the left part shows the proposed method 
and the right part shows the conventional method. 
 
III. 
EXPERIMENTAL RESULTS 
The proposed method based on the accuracy rate of 
MPM was simulated in JM 16.0 reference software [9] in 
order to evaluate its performance. Various types of test 
sequences were used and a group of experiments were 
carried out on different QP ranges for evaluating coding 
efficiency in the low bit rate condition. Experimental 
conditions were: (a) one set of QP values were 22, 27, 32 and 
37 and the other set of QP values were 32, 37, 42, 47, (b) 
Baseline profile was used, (c) number of frames was 100, 
and (d) entropy coder was CAVLC.  
In this paper, we used κ=13 as the threshold value, which 
was determined empirically. All frames were coded as Intra. 
In order to evaluate the performance of the proposed method, 
it was compared with H.264/AVC. To calculate the 
efficiency, the proposed method was used to calculate the 
average BD-PSNR and BD-bitrate [10,11]. The RD 
performance comparisons are shown in Table 1. 
 
TABLE I.   CODING EFFICIENCY RESULTS WITH DIFFERENT 
QP RANGE 
Sequence 
Resolution 
QP range 1 
QP range 2 
Bit-rat
e (%) 
PSNR 
(dB) 
Bit-rate 
(%) 
PSNR 
(dB) 
Foreman 
 
CIF 
(352x288) 
-0.099 
0.006 
-1.581 
0.093 
Container 
-0.365 
0.026 
-1.551 
0.092 
Paris 
-0.260 
0.025 
-1.219 
0.087 
Nuts5 
 
WQVGA 
(416x240) 
-1.125 
0.062 
-1.838 
0.111 
Nuts3 
-1.355 
0.080 
-2.067 
0.136 
Keiba3 
-0.496 
0.035 
-2.584 
0.158 
Flower4 
 
WVGA 
(832x480) 
-0.871 
0.062 
-1.331 
0.074 
BQmall 
-0.561 
0.037 
-1.612 
0.089 
Keiba3 
-0.627 
0.035 
-2.904 
0.164 
Bigships 
 
 
HD 
(1280x720) 
-0.223 
0.012 
-2.154 
0.084 
City 
-0.181 
0.013 
-1.588 
0.072 
Crew 
-1.486 
0.060 
-2.117 
0.100 
Jets 
-2.185 
0.088 
-2.050 
0.112 
Vidyo3 
-1.376 
0.091 
-2.023 
0.138 
Average 
-0.801 
0.045 
-1.901 
0.109 
 
The average bit saving is 0.801% and the average PSNR 
gain is 0.045 dB for various test sequences in the Baseline 
profile. For additional information on the low bit rate 
condition, the proposed algorithm was also tested at QP 
range 2 (32, 37, 42, and 47). In QP range 2, the average bit 
saving is 1.901% and the average PSNR gain is 0.109 dB. 
The average bit saving increases according to the increase of 
QP. Especially, it is effective in some sequences. In the case 
of Foreman and City sequence, the bit saving of QP range 1 
is 0.099% and 0.181%, respectively. It is relatively small 
compared to other sequences. However, the accuracy rate of 
MPM increases rapidly according to the increase of QP. In 
low bit rate condition, the bit saving of QP range 2 is 1.581% 
and 2.904%, respectively. Thus, we can verify that the 
proposed method is effective in the low bit rate condition. 
This means that the attempt to reduce redundancy of MPM is 
successful. As QP increases, the accuracy rate of MPM 
increases and the number of blocks with MPMBM increase. 
Hence, mode signaling of the proposed method occurs often 
in the low bit rate condition.  
In H.264/AVC, Intra-4x4 has an advantage regarding the 
PSNR because of the accuracy of its predictions. However, 
in the low bit rate condition, it also has a disadvantage in its 
bit rate because the mode information of 16 blocks is 
signaled. So, Intra-16x16 is selected as the best partition in 
76
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

the low bit rate condition. However, in the low bit rate 
condition in the proposed algorithm, Intra-4x4 is more often 
selected as the best partition compared to H.264/AVC 
because it can reduce the burden of bit rate. In other words, 
the number of bits used to represent the intra-mode 
information is reduced in the proposed algorithm. Table 2 
shows the increase of Intra-4x4 partition compared to 
H.264/AVC. In the table, △I4x4 is used to calculate the 
number of Intra-4x4 partitions in the proposed algorithm 
compared to H.264/AVC. △I4x4 is calculated like 
following: 
 
.264
4 4
4 4
4 4
.264
4 4
100
prop
H
H
I
I
I
I








                    
(2) 
 
 
TABLEⅡ.   INCREASE OF INTRA-4X4 PARTITION COMPARED 
TO H.264/AVC 
 
Sequence 
         
Resolution 
QP = 37 
QP = 42 
△I4x4 (%) 
△I4x4 (%) 
Foreman 
CIF 
(352x288) 
6.680 
11.425 
Container 
9.697 
8.783 
Paris 
5.594 
5.286 
Nuts5 
WQVGA 
(416x240) 
17.53 
36.922 
Nuts3 
27.910 
49.278 
Keiba3 
6.681 
16.130 
Flower4 
WVGA 
(832x480) 
29.250 
31.941 
BQmall 
9.050 
17.125 
Keiba3 
10.621 
25.798 
Bigships 
 
HD 
(1280x720) 
17.999 
38.404 
City 
5.796 
23.488 
Crew 
36.205 
57.326 
Jets 
25.880 
27.542 
Vidyo3 
11.381 
16.577 
Average 
15.734 
26.145 
 
When QP is equal to 37, the average of △I4x4 is 
15.734%. It means that Intra-4x4 partition increases 
15.734% compared to Intra-4x4 in H.264/AVC. In particular, 
when QP is equal to 42, Intra-4x4 partition increases 
26.145% as shown in Table Ⅱ. 
 
IV. 
CONCLUSION 
In this paper, we proposed mode signaling to use the 
accuracy rate of MPM. An adaptive scheme is applied to the 
blocks according to number of block with MPMBM. Two 
types of bit format are supported to code intra-mode 
information and it is selected based on the accuracy rate of 
MPM. Especially, the proposed algorithm can improve the 
coding efficiency in the low bit rate condition. According to 
the experimental results, the average bit reduction is 0.801% 
and the average PSNR gain is 0.045 dB. In particular, in the 
low bit rate condition, the average bit rate reduction is 
1.901% and the average PSNR gain is 0.109 dB. This paper 
is enhancing the compression efficiency at low bit rate 
application such as video-conferencing and video telephony. 
 
ACKNOWLEDGMENT 
 
This work was supported by the National Research 
Foundation of Korea (NRF) Grant funded by the Korean 
Government(MOE) (NRF-2011-0011312) 
 
REFERENCES 
 
[1] G. Bjøntegaard, "Coding improvement by using 4x4 blocks 
for motion vectors and transform," ITU-T/Study Group 
16/Video Coding Experts Group (Question 15), Eibsee, 
Germany, document Q15-C-23, December. 1997. 
[2] G. Bjøntegaard, "Response to Call for Proposals for 
H.26L," ITU-T/Study Group 16/Video Coding Experts 
Group (Question 15), Seoul, Korea, document Q15-F-11, 
November. 1998. 
[3] G. Conklin, "More Results on New Intra Prediction 
Modes," Joint Video Team (JVT) of ISO/IEC MPEG & 
ITU-T VCEG (ISO/IEC JTC1/SC29/WG11 and ITU-T 
SG16 Q.6), Geneva, Switzerland, document JVT-B080, 
January. 2002. 
[4] D. Kim, K. Han, and Y. Lee, "Adaptive Single-Multiple 
Prediction for H.264/AVC Intra Coding," IEEE Trans. on 
CSVT, vol. 20, no.4, April. 2010, pp. 610-615. 
[5] W. Zhu, W. Ding, Y. Shi, Y. Sun, and B. Yin, “Adaptive 
intra modes reduction by clustering for H.264/AVC,” ICIP 
2011, September.  2011, pp. 1665-1668. 
[6] K. Takagi, Y. Takishima, and Y. Nakajima, “A study on 
rate-distortion optimization scheme for JVT coder,” in Proc. 
Int. Soc. Opt. Eng., vol. 5150, July. 2003, pp. 914-923. 
[7]  G. 
J. 
Sullivan 
and 
T. 
Wiegand, 
“Rate-distortion 
optimization for video compression,” IEEE Signal Process. 
Mag., vol. 15, no. 6, November. 1998, pp. 74–90. 
[8] D. Marpe, H. Schwarz, and T. Wiegand, “Context-based 
adaptive binary arithmetic coding in the H.264/AVC video 
compression standard,” IEEE Trans. on CSVT, vol. 13, no. 
7, July. 2003, pp. 620-636. 
[9] Available:http://iphome.hhi.de/suehring/download/old _jm.  
[10] G. Bjøntegaard, “Calculation of average PSNR differences 
between RD-curves,” ITU-T SG16 Q.6 Doc., VCEG-M33, 
Austin, US, April. 2001. 
[11] S. Pateux and J. Jung, “Improvements of Excel macro for 
BD-gain computation,” ITU-T/Study Group 16/Video 
Coding Experts Group (Question 6), Geneva, Switzerland, 
document SG16-C358, October.  2009. 
 
77
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-300-1
AFIN 2013 : The Fifth International Conference on Advances in Future Internet

