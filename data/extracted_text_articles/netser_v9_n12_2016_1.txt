1
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Practical Design of Network Coded Multicast over Satellite
Paresh Saxena* and M. A. V´azquez-Castro**
*AnsuR Solutions Barcelona, Advanced Industry Park,
c/Marie Curie 8-14, 08042 Barcelona, Spain.
**Dept. of Telecommunications and Systems Engineering,
Universitat Aut`onoma de Barcelona, Barcelona, Spain.
Email: paresh.saxena@ansur.es, angeles.vazquez@uab.es
Abstract—In this paper, we present the practical design of
systematic random network coding (SNC) for multicast over
satellite. In particular, the satellite coverage is over a large
geographical area that consists of several users. These users may
face different channel conditions and undergo different packet
loss rates. In this work, we show two regions of transmission.
First, the general multicast region where all users subscribed
to the multicast channel can recover all the data packets and
second, we identify the multi-unicast region where only users
with good channel conditions can recover all the data packets
but those with bad channel accept transmission losses. Further,
we present the architectural and encapsulation feasibility of SNC
at satellite-dependent and satellite-independent layers. We derive
theoretically and by simulation the beneﬁts of SNC against
state-of-the-art end-to-end coding at these layers. Our results
show that: (i) SNC at link layer can achieve up to 26.90%
and 24.26% higher maximum achievable rates for multicast
and multi-unicast, respectively and (ii) SNC at application layer
requires up to 6.66% and 30.02% smaller available network
bandwidth for multicast and multi-unicast respectively.
Index Terms—Network coding; Multicast; Satellite communica-
tion; Achievable rates.
I. INTRODUCTION
This paper extends our earlier work [1]. In this paper, we
consider more detail analysis of system model and introduces
the results and analysis for multicast and multi-unicast us-
ing network coding at both satellite-dependent and satellite-
independent layers.
Network coding (NC) extends traditional network opera-
tions from routing and store-and-forward to more powerful
operations that allow for coding information at intermediate
nodes. NC was ﬁrst introduced in [2], where it is shown that
NC can achieve the min-cut capacity of the error-free networks
by allowing coding at intermediate nodes. In subsequent work
[3], it is also shown that the linear encoding and decoding
operations at intermediate nodes are sufﬁcient to achieve the
min-cut max-ﬂow performance. These results lead to the in-
vestigation of efﬁcient linear encoding and decoding strategies
for network coding. As a result, it is shown that random
linear network coding (RNC) [4], where information packets
transmitted in the network are random linear combinations of
the original data packets, is asymptotically capacity achieving.
The main philosophy of using RNC as a capacity-achieving
network coding scheme is that it allows the practical applica-
tion of network coding in a distributed manner. For example,
there is no need of a centralized architecture to take care
of coding coefﬁcients used at all the nodes. The coding
coefﬁcients are generated at random and they are send within
the packet headers [5]. Although RNC has several theoretical
beneﬁts, it has three main limitations for the practical appli-
cations of network coding: high complexity, high delay, and
high overhead. The high decoding complexity is due to the
use of Gaussian elimination (GE) algorithm. In order to solve
a system of linear equations, GE needs to solve a densely
ﬁlled decoding matrix. This results into the high decoding
complexity. The high delay is due to the time the receiver
waits for the arrival of the complete block in order to start the
decoding process and the high overhead is due to the coding
coefﬁcients, which are attached as a side information with
the coded packets [5] in practical network coding schemes.
Therefore, RNC is not the most efﬁcient form of network
coding and because of all the aforementioned constraints,
it can adversely effect the applications like real-time video
streaming, where there can be impairments in video quality
due to high complexity and delay.
Recently, systematic network coding (SNC) [6]-[14] has
been investigated as a powerful practical network coding
solution. If systematic coding is used, the sinks can receive
both uncoded and coded packets. There are three main beneﬁts
of using systematic coding. Firstly, the sink has to decode only
the packets, which have not arrived in their original form.
Hence, some rows of the decoding matrix are singleton and
contain only one non-zero element. In this case, the decoding
is done over a sparse decoding matrix that contains several
zero elements that reduces the decoding complexity signiﬁ-
cantly. Secondly, the sink does not have to wait for complete
block to start recovering packets. The packets that are received
in their original form, are recovered instantly, which decreases
the overall per-packet delay. Finally, the systematic packets
do not have overhead of coding coefﬁcients, as these are
not the encoded packets. This reduces the overall overhead
signiﬁcantly. Therefore, SNC can overcome all the limitations
imposed by RNC. In this work, we explore the beneﬁts of
using SNC for transmission over satellite.
A. Network coding over satellite
In the literature, there are speciﬁcally two directions of work
on the use of network coding for transmission over satellite.
The ﬁrst direction focuses on throughput improvement. In
[15][16], network coding is shown to enhance throughput by
load balancing and allocating coded packets across different
beams in multi-beam satellite systems. Further, works in
[17][18] take advantage of orthogonal transmission available

2
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
using multi-link reception in multi-beam satellite systems.
In [17][18], network coding is shown to provide beneﬁts in
terms of higher throughputs subject to the location of user
terminals. In [19][20], network coding is shown to improve
end-user quality-of-experience for video streaming application
over relay satellites.
A different direction looks at the application of network cod-
ing to counteract packet losses and guarantee higher reliability.
It has been shown that network coding together with conges-
tion control algorithm can provide many-fold improvements
than existing transport layer protocols [21]. In addition, it has
been shown in [22], that unequal-protection aware overlapping
network coding together with congestion control algorithms
can provide improvements in quality-of-experience (QoE) of
video streaming. Further, network coding implementation at
link layer has shown to provide several advantages in terms of
reliability, complexity, delay, etc. for unicasting over satellite
networks with several intermediate nodes [11]-[13]. In [23],
it is also shown that it can be used to cope with packet
losses, thus counteracting prediction failures of the handover
procedures in smart gateway diversity satellite systems.
B. Our contributions
Existing results on the use of SNC has dealt mainly with
unicast with a source and a sink connected via several in-
termediate nodes. In this paper, we extend existing results
and investigate the use of SNC for multicast and multi-
unicast over satellite. We identify two regions of transmission,
one for multicast and another for multi-unicast with one in-
network (re)encoding node to increase the achievable rates
and the reliability of satellite networks. The one in-network
re-encoding node can be a satellite gateway or other node at
satellite ground station.
Further, we also present the application of network coding
in two different sets of layers of a satellite network protocol
architecture. These are satellite-dependent layers (link and
physical layers) and satellite-independent layers (application,
transport and IP layers). In particular, the satellite-dependent
layers are of interest for the system operators while the
satellite-independent layers are of interest for application de-
velopers who have access to the data ﬂowing in these layers
but not to the system operational kernel. Speciﬁcally, we
present ﬁrst the implementation of network coding at the link
layer of the satellite systems and second, the implementation
of network coding at the application layer for better internet
communication over satellite systems. The overall architectural
design is also presented showing the practical feasibility of
SNC over different layers.
The rest of the paper is organized as follows. In Section II,
we formalize the system model. In Section III, we describe
the proposed SNC scheme for multicast and multi-unicast
transmission. In Section IV, we present the theoretical analysis
and derivation of theoretical expressions for the reliability and
the achievable rate. Section V and Section VI present the
implementation of SNC at the link layer and application layer
respectively. Section VII presents the simulation results and
Section VIII concludes this paper.
!"
!"
!"
#$%&'("
)*+(&,(-./+("
#.*01"
!1
!"
!"
!"
!2
!3
! j
!L
Figure. 1: System model.
II. SYSTEM MODEL
We consider a system topology (Figure 1), where a source
is connected to all the sinks via an intermediate node. This
system topology is a relevant case in satellite systems where
there is one intermediate node, which could be a gateway (or
others) and there can be several sink nodes which are the users
distributed in a large geographical area undergoing different
packet loss rates. Our theoretical derivations and simulation
results on the reliability and the achievable rates show the
beneﬁts of network coding with respect to state-of-the-art end-
to-end forward erasure codes (FEC) codes like Reed-Solomon
(RS) codes for both multicast and multi-unicast.
Consider that a source node has K data packets to send to
L − 1 sink nodes. Each packet is a column vector of length
M over a ﬁnite ﬁeld Fq. The set of data packets in matrix
notation is S =

s1
s2
.
.
.
sK

, where st is the
tth data packet. The source is connected to all the sinks via
an intermediate node as shown in Figure 1. All the links are
modeled as memoryless erasure channels. There are L links
in the network. The erasure probability from the source to the
intermediate node is denoted by ϵ1 and the erasure probability
from the intermediate node to the sink node j is denoted by
ϵj, j = 2, .., L.
We assume there is no feedback from the sinks (or from
the intermediate node) due to the inherent large latency of
satellite systems. We also assume that packet transmissions
occur at discrete time slots such that each node can transmit
one packet per time slot. We will also assume that the coding
schemes run for a total of N time slots (N is larger than or
equal to K) and every node (except the sinks) transmits a
packet in each time slot t = 1, 2, ..., N.
III. SYSTEMATIC NETWORK CODING FOR MULTICAST AND
MULTI-UNICAST
A. Encoding at the source node
The SNC encoder sends K data packets in the ﬁrst K time
slots (systematic phase) followed by N − K random linear
combinations of data packets in the next N − K time slots
(non-systematic phase). Let,

3
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
X = SG
represent K systematic packets and N − K coded packets
transmitted by the SNC encoder during N consecutive time
slots. The generator matrix
G =
 IK
C 
consists of the identity matrix IK of dimension K and C ∈
FK×N−K
q
with elements chosen randomly from a ﬁnite ﬁeld
Fq. The code rate is given by ρ = K
N .
B. Re-encoding at the intermediate node
The SNC re-encoder performs re-encoding operations at
every time slot and sends N packets to the sink nodes. Let,
XI = XD1T
represent N packets transmitted by the SNC re-encoder during
N consecutive time slots, where D1 ∈ FN×N
q
represents
erasures from the source node to the intermediate node and
T ∈ FN×N
q
represents the re-encoding operations at the
intermediate node.
The erasure matrix D1 is an N × N diagonal matrix with
every diagonal component zero with probability ϵ1 and one
with probability 1 − ϵ1.
The re-encoding matrix T is modeled as an upper triangular
matrix. The non-zero elements of T are selected as follows.
During the systematic phase, if a packet st is lost, i.e.,
D1(t, t) = 0 then the non-zero elements of the tth column
of matrix T are randomly selected from Fq. This represents
that if the systematic packet is lost from the source node to
the intermediate node, then the intermediate node transmits
a random linear combination of the packets stored in its
buffer. If a packet st is not lost, i.e., D1(t, t) = 1 then the
tth column of matrix T is the same as the tth column of
identity matrix IN. This represents that the intermediate node
forwards this systematic packet to the sinks. During the non-
systematic phase, the intermediate node sends a random linear
combination of the packets stored in its buffer and all the
non-zero elements of last N − K columns of T are chosen
randomly from the ﬁnite ﬁeld Fq.
C. Decoding at the sink nodes
Let Yj = XIDj, j = 2, 3, ..., L represents N packets
received by the sink node j where Dj represents erasures from
the intermediate node to the sink node j. Dj is N×N diagonal
matrix of the same type as D1 but with erasure probability ϵj.
If the sink node j does not receive any packet in time slot t
then the tth column of Yj is a zero column.
The overall SNC coding strategy can be expressed using
a linear operation channel (LOC) model, where the output
at the sink node j is Yj = SGHj where Hj = D1TDj
represents the transfer matrix from the source to the sink j.
We assume that the coding vectors are attached in the packet
headers so that the matrix GHj is known at the sink j.
However, the overhead, due to the attached coding vectors, is
kept low due to the use of systematic coding (coding vectors
are not attached with the systematic packets). The decoding is
progressive using the Gaussian Jordan algorithm as in [11]. All
the K data packets are recovered when K innovative packets
are received at the sink j, i.e., rank(GHj) = K.
IV. THEORETICAL ANALYSIS
In this section, we present the theoretical expressions of
the average reliability and the average achievable rate of the
considered topology. First, let us note that the capacity of the
topology is the min-cut of the network, which is given by
min
j (1 − ϵj).
Let us now deﬁne η as the residual erasure rate of any link
that could be achieved after the overall coding and decoding
operations. The reliability of the link is given by (1−η). Based
on the deﬁnitions of the residual erasure rate and using the
deﬁnition of achievable rate from [25], we deﬁne the average
achievable rate of the considered topology as,
Rav = ρ (1 − ηav)
(1)
with,
ηav =
1
L − 1
L
X
j=2
[1 − (1 − η1)(1 − ηj)]
(2)
as the average reliability of the considered topology where
η1 is the residual erasure rate from the source node to the
intermediate node and ηj is the residual erasure rate from the
intermediate node to the sink node j. Here,
ηl = ϵl(φl1 + φl2), l = 1, 2, ..., L.
(3)
where ϵl is the probability by which a systematic packet is
lost at link l.
Let us now derive the residual erasure rate ηl. Note that the
residual erasure rate is zero if the decoding is sucessful and all
the data packets are recovered. Further, a decoding failure will
result into a ﬁnite value of residual erasure rate. The decoding
failure can be due to two reasons. First, when the number of
total packets received is less than K. The probability of this
event is represented as,
φl1 = Pr(A < K − 1)
(4)
where A is the total number of packets received. Second, when
the number of total packets received is more than K but they
are not linearly independent to have successful decoding. This
event corresponds to a not full rank decoding matrix and its
probability is represented as,
φl2 = Pr(A ≥ K − 1)Pr(rank(GHj) < K)
(5)
Assuming Bernoulli distributed erasures and using the prob-
ability mass function α(f, v, p) =
 v
f

(1−p)f(p)v−f, we
have,
φl1 =
K−1
X
f=0
α(f, N − 1, ϵl),
(6)

4
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
φl2 =
K−1
X
f1=0
α(f1, K, ϵl)
N−K
X
f2=K−f1
α(f2, N − K, ϵl) (1 − π (f2, K − f1)) .
(7)
where f1, f2 are the number of systematic and coded packets
received, respectively, and π (f2, K − f1) is the probability of
f2 coded packets having K − f1 degrees of freedom. When
there are f1 degrees of freedom from f1 systematic packets
and K − f1 degrees of freedom from f2 coded packets then
rank(GH) = K. Using (equation 7, [26]), we have the exact
expression for π (f2, K − f1) =
K−f1−1
Y
f3=0
1 − qf3−f2. From the
above expressions, we can obtain the average residual erasure
rate and average achievable rate using (2).
In the next sections, we will present the practical application
of network coding at different layers of the satellite systems. In
particular, we consider the application at link and application
layers of the satellite systems.
V. IMPLEMENTATION IN LINK LAYER OF SATELLITE
SYSTEMS
A. State-of-the-art link layer protocols in satellite systems
The current state-of-the-art link layer protocols in the
satellite systems provide efﬁcient encapsulation of network
layer (IP) protocol data units (PDUs) over the physical layer
frames. For example, generic stream encapsulation (GSE)
protocol [27] in digital video broadcasting by satellite - second
generation (DVB-S2) based systems is used as a link layer
protocol to encapsulate network layer IP packets.
The existing link layer forward erasure correction (LL-
FEC) frameworks in the satellite systems are mainly based
on RS or Raptor codes [28]. However, the main limitation
of the existing frameworks is that they operate only in end-
to-end fashion and do not utilize the coding opportunities
at the intermediate node. In this section, we will present an
architectural and encapsulation framework to enable link layer
systematic network coding (LL-SNC) at the source and at the
intermediate node of the satellite systems.
B. LL-SNC architecture and encapsulation
In Figure 2, we present the complete information ﬂow with
LL-SNC architecture and LL-SNC encapsulation, where IP
packets are transmitted from the source and recovered at the
sinks. This ﬁgure represents the case when there is only one
sink in the network. When there are several sinks, the same
LL PDUs are transmitted from the intermediate node to all the
sink nodes.
At the source, the network layer IP packets are encapsulated
into an LL-SNC frame. The LL-SNC frame consists of an
application data table (ADT) to store IP PDUs, a network
coding data table (NCDT) to store network coded packets and
a coefﬁcient data table (CDT) to store coding coefﬁcients. The
data from the LL-SNC frame is then encapsulated into LL
PDUs. The LL PDUs are then encapsulated into the physical
(PHY) frames.
At the intermediate node, the payload of correctly received
LL PDUs is stored in the LL-SNC frame. The IP PDUs are
stored in the ADT of the intermediate node. The coded packets
and the corresponding coefﬁcients are stored in NCDT and
CDT of the intermediate node. When the intermediate node
receives LL PDU without error, it sends the LL PDU to the
sink node and also stores it in the LL-SNC frame. When the
intermediate node receives LL PDU with errors, it discards
the LL PDU and generates new coded packet and coding
coefﬁcients as explained in Section III. These new coded
packets and the corresponding coefﬁcients are stored in NCDT
and CDT of the intermediate node.
At the sink node, the correctly received LL PDUs are stored
in the LL-SNC frame. The IP PDUs are stored in the ADT of
the sink node. The coded packets and the coding coefﬁcients
are stored in NCDT and CDT, respectively. The progressive
decoding is performed and the lost IP PDUs are recovered.
These IP PDUs are then passed to the upper layers.
The encapsulation process is similar to the encapsulation
of LL-FEC over GSE [28] but with some modiﬁcations
to accomodate network coding parameters. A source block
(ADT) consists of K columns and stores ADUs. Now, ADUs
are arranged column wise starting from the upper left corner.
If an ADU does not ﬁt in one column, it continues at the top of
the following column and so on. If the ADT is not completely
ﬁlled then the zero-padding bytes are inserted in last column
to ﬁll it completely. Each ADU is then encapsulated in a
single or multiple RTP packets. The FEC block (NCDT)
contains N − K columns with N − K coded packets and
the coefﬁcient block (CDT) contains N − K columns with
N − K set of coding coefﬁcients. Each coded packet from
NCDT and the corresponding coding coefﬁcients from CDT
are encapsulated in one RTP packet. The ﬁrst K bytes of
RTP payload contain K coding coefﬁcients followed by the
corresponding NCDT column. The value of K is signaled
through the RTP header of the RTP packet. Finally, CRC-
32 is added with every RTP packet to detect errors in RTP
packets at the receiving end. Now, if an ADU is lost, then
the corresponding part of the column or the complete column
is also lost. The progressive decoding is performed and lost
columns (or lost part of columns) in ADT are ﬁlled with the
recovered data.
VI. IMPLEMENTATION IN APPLICATION LAYER OF
SATELLITE SYSTEMS
A. State-of-the-art application layer protocols in satellite sys-
tems
The current state-of-the-art application/transport layer pro-
tocols primarily include transmission control protocol (TCP)
based schemes, which are most commonly used to guarantee
reliabiity. TCP used retransmission mechanism to recover
from packet losses. However, TCP and TCP variants have
limited performance over satellite due to long round-trip times
(RTT) [31]. In addition, for the real-time multimedia delivery,
speciﬁcally for audio and video transmission, TCP is not

5
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
&
16&N5,0-2>&>-/2&
$/,5N>*<5R)/&2)&&
!!&678L>&
$/,5N>*<5R)/&2)&&
6WX&#+53->&
!!&678L>&&
+-,)M-+-4&
6WX&#+53->&&
+-,)M-+-4&
$/,5N>*<5R)/&2)&&
!!&678L>&
$/,5N>*<5R)/&2)&
&6WX&#+53->&
')*+,-&
1/2-+3-4.52-&
'./0&
6=;>.,5<"<5;-+&
<)>>->&
6=;>.,5<"<5;-+&
<)>>->&
'(%&52&1/2-+3-4.52-&
(-2:)+0&!5;-+&&
99$%:7',;<=6>-)'
!./0&<5;-+&
6=;>.,5<&<5;-+&
6WX&#+53->&&
+-,)M-+-4&
&
16&N5,0-2>&&
+-,)M-+-4&
9-/-+52-&(%&N5,0-2&5/4&,)-T,.-/2>&
'2)+-&2=-3&./&(%7J&5/4&%7J&
V-,)M-+&(%&N5,0-2&5/4&,)-T,.-/2>&&
'2)+-&2=-3&./&(%7J&5/4&%7J&
9-/-+52-&(%&N5,0-2&5/4&,)-T,.-/2>&
'2)+-&2=-3&./&(%7J&5/4&%7J&
V-,)M-+&16&678&
'2)+-&.2&./&I7J&&
!!&678&
:B)&-++)+>&
!!&678&
:.2=&-++)+>&
!!&678&
:.2=&-++)+>&
!!&678&
:B)&-++)+>&
:*1$,>,0-A6BC'(D6,-'
%>,0-A6BC'(D6,-'
%>,0-A6BC''
'
:*1$'
%>,0-A6BC''
'2)+-&16&
678>&./&
I7J&
9-/-+52-&&
5/4&>2)+-&
(%&N5,0-2>&&
5/4&&
,)-T,.-/2>G&
./&(%7J&&
5/4&%7J&
:*1$'
%>,0-A6BC''
'2)+-&16&
678>&./&
I7J&
'2)+-&(%&
N5,0-2>&&
5/4&
,)-T,.-/2>&
./&(%7J&
&5/4&%7J&
%>,0-A6BC''
6+)P+->>.M-&&
7-,)4./P&
!!&678L>&
&+-,)M-+-4&
!!&&678&
:B)&-++)+>&
!!&&678&
:B)&-++)+>&
Figure. 2: Flow diagram with LL-SNC architecture and LL-SNC encapsulation in satellite system.
suitable for timely delivery as it requires heavy feedback and
acknowledgements [32], [33], [34]. Another disadvantage of
TCP is its compatibility with the mutlicast and broadcast
communication. There may exist parallel TCP connections
with the sender to different receivers, but each TCP connection
can require transmission of different lost packets that will
result into a resource-intensive solution.
Therefore, most of the real-time protocols for the multime-
dia delivery are built on the top of user datagram protocol
(UDP). As the reliability is not guaranteed with UDP, forward
erasure correction (FEC) codes are used to recover from
packet losses. Speciﬁcally, Reed-Solomon (RS) code, which
is a maximum distance separable (MDS) code, is optimal
in terms of erasure correction performance and mainly used
as a start-of-the-art FEC scheme. However, there are mainly
three limitations of using RS codes. Firstly, a construction
of the RS code is based on a ﬁnite algebraic arithmetic,
therefore, the receiver has to wait for all the packets to start the
decoding process. Secondly, the constraints on the RS coding
parameters, make its incompatible with adaptive solutions and
ﬁnally, when there are multiple hops where intermediate nodes
can perform coding, they have to ﬁrst decode the original
packets and then re-encode to generate the coded packets. This
results into an additional delay because of decoding and then
re-encoding the original packets at every node. In this section,
we will present an architectural and encapsulation framework
to enable application layer systematic network coding (AL-
SNC) at the source and at the intermediate node of the satellite
systems.
B. AL-SNC architecture and encapsulation
The encapsulation process is similar to the encapsulation
of RS codes over real-time transport protocol (RTP) [30]. In
addition, there are some modiﬁcations to accomodate network
coding parameters. In Figure 3, we present the modiﬁed
encapsulation process to be used for the network coding. An
application layer source block (AL-ADT) consists of K ADUs
in K columns. The number of rows in the source block is
M = E + 2, where E is the length of the largest ADU. The
columns, which do not have the largest ADU, are ﬁlled with
zeros to be completely ﬁlled. Each column can be considered
as a data packet. The ﬁrst two bytes of each column in the
source block contain the length of the corresponding ADU.
ADUs are then encapsulated into RTP packets. The ﬁrst two
bytes and the zero paddings are not sent over the network.
The application layer FEC block (AL-NCDT) contains N −K
columns with N − K coded packets and the application layer
coefﬁcient block (AL-CDT) contains N − K columns with
N −K set of coding coefﬁcients. FEC packets and coefﬁcients
are then encapsulated into RTP packets. Each RTP packet
contains RTP payload, RTP header and FEC payload ID. This
FEC payload ID is used for signaling the coding parameters
like source block ID, FEC packet ID, values of K and N,
etc. The CRC-32 is added with every RTP packet to detect
errors in RTP packets at the receiving end. At the receiver,
the values of coding parameters are extracted from the FEC
payload ID. Now, if ADUs are lost then the complete columns
are lost. So, if FEC decoding succeeds, the receiver recovers

6
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
I78&D&&
I78&A&&
I78&#"
XJ6&
5-6.-)'
XJ6&
XJ6&
I&
7&
8&
D&
I&
7&
8&
A&
FFFFFFFFF&
FFGG&
(
%&
(
%&
FFG&
,
)
HG&
,
)
HG&
787'
5-6.-)'
787'
787'
5-6.-)'
FFFFF&
FFF&
'(%&H+53-&
A&
K;2->&
A&
K;2->&
A&
K;2->&
E-+)>&
E-+)>&
I&
7&
8&
Z&
%7J&
Y("Z&,)<*3/>[&
Q&+):>&
&
(%7J&&
Y("Z&,)<*3/>[&
I7J&
YZ&,)<*3/>[&
Figure. 3: Encapsulation of application layer data units over RTP with network coding.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Achievable rate
Code rate
N = 256, Number of sinks = 2
 
 
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
10
10
20
30
40
50
60
70
80
90
100
Reliability
 
 
Rate (SNC)
Rate (LL−FEC)
Theoretical (SNC)
Reliability (SNC)
Reliability (LL−FEC)
Theoretical (SNC)
Multi−unicast region
Multicast Region
Figure. 4: LL-SNC multicast and multi-unicast region with two sinks.
ADUs by ﬁlling the erased columns. The initial two bytes are
used to remove zero padding from the data packets to recover
the ADUs.
VII. SIMULATION RESULTS
A. Performance metrics
1) Achievable rates and reliability: The theoretical expres-
sions of the average achievable rate and the average reliability
are derived in Section IV. In this section, we will present
the simulation results on the average achievable rate and
the average reliability. In the results, we also compare the
simulation results with the theoretical expressions derived in
Section IV.
2) Average delay per-packet: If a packet st is transmitted
by the source at time tj and it is recovered at the sink at time
tr then packet st incurs a delay δt where, δt = tr − tj. For
TABLE I: MAXIMUM ACHIEVABLE RATES FOR MUTI-
CAST AND MULTI-UNICAST
N
Application
Sinks
LL-SNC
LL-FEC
Gain
256
Multicast
2
0.3486
0.2747
26.90%
256
Multi-unicast
2
0.4794
0.3858
24.26%
256
Multicast
10
0.3575
0.3043
17.48%
256
Multi-unicast
10
0.6745
0.5404
24.81%
50
Multicast
2
0.3035
0.2553
18.88%
50
Multi-unicast
2
0.3852
0.3579
7.63%
50
Multicast
10
0.3107
0.2751
12.94%
50
Multi-unicast
10
0.5406
0.4990
8.34%
the block of K packets, the average delay per-packet is given
as, △ =
PK
t=1 δt
K
. Note that the delay is evaluated only for the
packets that are recovered at the sink.

7
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Achievable rate
Code rate
N = 256, Number of sinks = 10
 
 
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
10
10
20
30
40
50
60
70
80
90
100
Reliability
Rate (SNC)
Rate (LL−FEC)
Theoretical (SNC)
Reliability (SNC)
Reliability (LL−FEC)
Theoretical (SNC)
Multicast Region
Multi−unicast region
Figure. 5: LL-SNC multicast and multi-unicast region with two sinks.
0.2
0.3
0.4
0.5
0.6
0
50
100
150
200
250
300
350
400
Code Rate
Average delay per−packet (in milli−seconds)
 
 
LL−SNC (Two sinks)
LL−FEC (Two sinks)
LL−SNC (Ten sinks)
LL−FEC (Ten sinks)
Figure. 6: Average delay per-packet
B. Results for the implementation at link layer
1) Simulation setup:
In our simulation setup, ﬁrst we
consider network coding implementation at the link layer. We
consider realistic satellite transmission scenarios with links
having light rainfall (erasure rate of 0.2) and/or heavy rainfall
(erasure rate of 0.6) [29]. These erasures correspond to the
loss of LL-PDUs. In each case, we compare LL-SNC with
LL-FEC. We assume IP PDUs of length 1500 bytes. Each IP
PDU is mapped to a column of the ADTs of consecutive LL-
SNC frames. Two LL-SNC frame lengths, N ∈ {50, 256} and
several values of code rates are considered for comparison.
The size of ADT, i.e., K changes with the code rate. We set
the physical layer symbol rate of Bs = 27.5 Mbaud/s, ς = 2
as the modulation constellation and rphy = 1/2 as the physical
coding rate such that the bit rate is Bsςrphy = 27.5 Mbps.
The transmission delay is set to be 250 ms. In each case, we
average over 1000 experiments for every performance metric.
The number of erasures per-frame varies (according to the
random erasure rate) between 1000 experiments.
2) Results: In Figure 4, we show the results on achievable
rates and reliability when there are two sinks in the network.
The multicast capacity of the network is limited by one of
the links joining the intermediate node to the sink node. We
consider the following erasure probabilities: ϵ1 = 0.2, ϵ2 = 0.2
and ϵ3 = 0.6. In Figure 5, we show the results on achievable
rates and reliability when there are ten sinks in the network.
The multicast capacity of the network is limited by one of
the links joining the intermediate node to the sink node. We
consider the following erasure probabilities: ϵ1 = 0.2, ϵj =
0.2, j = 1, 2, ..., 9 and ϵ10 = 0.6. Furthermore, we present
the maximum achievable rates for both multicast and multi-
unicast in Table I. Following are the key conclusions from
these results:
• We have identiﬁed two regions in these graphs: one for

8
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Achievable Rate
Code rate
rs = 200 Kbps, K = 50, Number of sinks = 2
 
 
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
10
10
20
30
40
50
60
70
80
90
100
Reliability
 
 
Achievable Rate (AL−SNC)
Achievable Rate (RS, No Re−encoding)
Reliability (AL−SNC)
Reliability (RS, No Re−encoding)
Multicast region
Multi−unicast region
(a) AL-SNC multicast and multi-unicast regions with video codec rate rs = 200 Kbps.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Achievable Rate
Code rate
rs = 500 Kbps, K = 125, Number of Sinks = 2
 
 
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
10
10
20
30
40
50
60
70
80
90
100
Reliability
 
 
Achievable Rate (AL−SNC)
Achievable Rate (RS, No Re−encoding)
Reliability (AL−SNC)
Reliability (RS, No Re−encoding)
Multicast region
Multi−unicast region
(b) AL-SNC multicast and multi-unicast regions with video codec rate rs = 200 Kbps.
Figure. 7: AL-SNC multicast and multi-unicast regions with different video codec rates.
multicast, and another for multi-unicast (represented by
dashed boxes). The region for multicast is corresponding
to the case when the average reliability approaches 100%.
This would mean that all the sinks in the network are able
to recover all the data packets. We have also identiﬁed
the multi-unicast region where the sinks with better
channel recover all the data packets and the sink(s) with
bad channel still suffer from some losses. The beneﬁt
of multi-unicast over multicast is that one can achieve
overall higher transmission rates by not sacriﬁcing the
rate due to the bottleneck sink (link with higher erasure
rate). Hence, based on the requirements of the users, our
results provide optimal usage of available bandwidth for
transmission.
• The multicast is feasible only when the code rate is
smaller than the capacity of the network, which is
min
j (1−ϵj) = 0.4. However, when the code rate is higher
than the multicast capacity, multi-unicast is feasible. This
is because the capacity of the sinks with good channel is
different and higher than the capacity of the network (in
our example it is 0.8). Therefore, when the code rate is
smaller than 0.8, the sinks with good channel can recover
all the data packets making multi-unicast feasible.
• LL-SNC provides higher transmission rates and higher
reliability than LL-FEC in all the cases. When the number
of sink increases, LL-SNC can provide close to 100% re-
liability in the multi-unicast region itself. This is because
there is only one bottleneck link in the network and only

9
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
100
150
200
250
300
350
400
450
500
0
500
1000
1500
2000
Video Codec Source Rate rs (in Kbps)
Minimum Required Bandwidth (in Kbps)
 
 
AL−SNC, Multicast (bottleneck: 60% erasures)
RS, Multicast (bottleneck: 60% erasures)
AL−SNC, Multi−unicast (bottleneck: 60% erasures)
RS, Multi−unicast (bottleneck: 60% erasures)
AL−SNC, Multicast (bottleneck: 30% erasures)
RS, Multicast (bottleneck: 30% erasures)
AL−SNC, Multi−unicast (bottleneck: 30% erasures)
RS, Multi−unicast (bottleneck: 30% erasures)
Figure. 8: Minimum network bandwidth requirement for multicast and multi-unicast with AL-SNC.
one sink suffers from the bad channel. In this case, it
would be efﬁcient to transmit in the multi-unicast region
such that the higher transmission rates are achieved and
almost all the sinks (except the one with the bad channel)
are able to recover all the data packets. Furthermore,
LL-SNC also provides higher maximum achievable rates
than LL-FEC for both multicast and multi-unicast. The
maximum achievable rate increases as the frame length
increases or the number of sinks increases. Our results
(Table I) show that LL-SNC can achieve up to 26.90%
and 24.26% higher maximum achievable rates than LL-
FEC for multicast and multi-unicast respectively.
In Figure 6, our simulation results also show that LL-SNC
provides smaller average delay per-packet than LL-FEC. This
is because of the following two reasons. First, the progressive
decoding in LL-SNC allows the sinks to start decoding and
recovering as soon as it receives the ﬁrst packet. Second, the
re-encoding in LL-SNC helps the sink to receive K degrees
of freedom and complete the decoding process in fewer time
slots than LL-FEC. The overall delay includes the inherent
transmission delay of 250 ms of the satellite systems. Note
that the average per-packet delay for LL-SNC and LL-FEC
are very close. This is due to the fact that the transmission
delay majorly contributes to the overall delay and per-packet
delay is smaller due to the higher rates. However, at the lower
rates, when per-packet delay is higher, LL-SNC is expected to
provide higher advantage than LL-FEC.
C. Results for the implementation at application layer
1) Simulation setup: For the case of network coding imple-
mentation at application layer, we also consider different cases
with erasure rates of 0.2 and 0.6. These erasures correspond to
the loss of RTP packets. We assume that the source generates
packets of length M = 1500 symbols over Galois Field with
size q = 28. We consider state-of-the-art video codecs with
video frames grouped into Groups of Pictures (GoPs). Each
GoP contains several packets. The codec outputs each GoP in a
ﬁxed time TGoP such that the source block is K =
j
rs×TGoP
M×8
k
where rs is the video codec source rate. Several values of code
rates are considered for comparison. The size of coded block,
i.e., N varies with the change in code rate. In each case, we
average over 1000 experiments for every performance metrics.
2) Results: Figure 7 shows the achievable rates for the
application of network coding at application layer. Two con-
ﬁgurations of codecs are considered with rs = 200 kbps
and rs = 500 kbps with TGOP = 3 seconds. The source
blocks corresponding to these conﬁgurations are K = 50 and
K = 125, respectively. We show the multicast and multi-
unicast region of transmission in these ﬁgures.
The main difference between the simulation of link and ap-
plication layer network coding implementation is the variation
of block sizes and frame sizes. In case of link layer implemen-
tation, the frame size (N) is constant (K changes with the code
rate). In case of application layer implementation, the block
size (K) is constant (N changes with the code rate). Here, the
block size depends on the codec rate, GoP time and packet
sizes. In this paper, we have presented results with K changing
with codec rates. However, the conclusions remain the same
with the variations in packet sizes and GoP time.
Finally, we also show the minimum network bandwidth
required for enabling multicasting and multi-unicasting at
application layer. The minimum network bandwidth required
is calculated as the ratio of video codec source rate and
achievable rate. We consider several video codec source rates
ranging from 100 Kbps to 500 Kbps. We consider two erasure
rates for the bottleneck (worst) link: 30% erasures and 60%
erasures. It is shown that to achieve 500 Kbps video codec rate,
it is required to have at least 1.8 Mbps network bandwidth for
multicasting (100% average reliability). Note that 500 Kbps is
used for the video code source rate, and the rest of the available
network bandwidth is used for the network coding rate to
couteract packet losses and to guarantee 100% reliability.
In addition, with the help of SNC, the required network
bandwidth can be reduced from 1.786 Mbps to 1.667 Mbps in
case of multicasting. This is equivalent to save around 6.66%
in network bandwidth when SNC is used instead of RS coding.
In case of multi-unicasting, the gain is even higher where SNC
helps to reduce the network bandwidth requirement from 1.429

10
International Journal on Advances in Networks and Services, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/networks_and_services/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Mbps to 1 Mbps (around 30.02% save in bandwidth).
VIII. CONCLUSIONS
In this paper, we have focussed on the use of SNC for
multicast and multi-unicast over satellite. We have identiﬁed
the transmission regions for multicast and multi-unicast over
satellite by characterizing the reliability and achievable rates
offered by SNC in these two different regions. We have
derived the theoretical expressions for the average reliability
and the average achievable rate of the considered topology.
Our theoretical and simulation analysis present the beneﬁts
of SNC over end-to-end coding for both multicast and multi-
unicast. Our results have shown that a higher rate is achievable
for the multi-unicast however, not all the users in multi-
unicast can recover all the data packets. Therefore, based on
the requirements from different users, the transmission region
can be chosen for the optimal usage of available bandwidth.
Finally, we have explored the beneﬁts of network coding at
different layers of the satellite network protocol stack. We
have shown the encapsulation and architecture feasibility of
network coding application in the satellite-dependent layers
and satellite-independent layers. Future work includes the
investigation of SNC on more complex networks such as
network with multiple sources. Several other factors like bursty
erasures, video codec characteristics, processing complexity,
etc should be taken into account while analyzing the perfor-
mance of network coding schemes for multicasting.
REFERENCES
[1] P. Saxena and M. A. V´azquez-Castro, “Network coding multicast and
multi-unicast over satellite,” in the Seventh International Conference on
Advances in Satellite and Space Communication (SPACOMM), 2015,
pp. 40-45.
[2] R. Ahlswede, N. Cai, S. yen Robert Li, and R.W. Yeung, “Network
information ﬂow,” IEEE Transactions on Information Theory, vol. 46,
no. 4, 2000, pp. 1204–1216.
[3] S. yen Li, R. W. Yeung, and N. Cai, “Linear network coding,” IEEE
Transactions on Information Theory, vol. 49, 2003, pp. 371–381.
[4] T. Ho et al., “A random linear network coding approach to multicast,”
Information Theory, IEEE Transactions on, vol. 52, no. 10, 2006, pp.
4413– 4430.
[5] P. A. Chou, Y. Wu, and K. Jain, “Practical network coding,” 41st Annu.
Allerton Conf. Communication, Control and Computing, 2003.
[6] J. Heide, M. Pedersen, F. H. P. Fitzek, and T. Larsen, “Network
coding for mobile devices - systematic binary random rateless codes,”
in Communications Workshops, 2009. ICC Workshops 2009. IEEE
International Conference on, 2009, pp. 1–6.
[7] Y. Li, P. Vingelmann, M. Pedersen, and E. Soljanin, “Round-robin
streaming with generations,” in Network Coding (NetCod), 2012 In-
ternational Symposium on, 2012, pp. 143–148.
[8] B. Shrader and N. Jones, “Systematic wireless network coding,” in
Military Communications Conference, 2009. MILCOM 2009. IEEE,
2009, pp. 1–7.
[9] D. Vukobratovic, C. Khirallah, V. Stankovic, and J. Thompson, “Random
network coding for multimedia delivery services in LTE/LTE- Ad-
vanced,” Multimedia, IEEE Transactions on, vol. 16, 2014, pp. 277–282.
[10] S. Teerapittayanon et al., “Network Coding as a WiMAX Link Relia-
bility Mechanism,” in Multiple Access Communications, vol. 7642 of
Lecture Notes in Computer Science, Springer Berlin Heidelberg, 2012,
pp. 1–12.
[11] P. Saxena and M. A. V´azquez-Castro, “Network coding advantage over
MDS codes for multimedia transmission via erasure satellite channels,”
in lecture notes of the institute for computer sciences, social informatics
and telecommunications engineering, (Springer 2013), Volume 123,
2013, pp. 199-210.
[12] P. Saxena and M. A. V´azquez-Castro, “DARE: DoF-Aided Random
Encoding for network coding over lossy line networks,” IEEE com-
munication letters, vol. 19, no. 8, 2015, pp. 1374-1377.
[13] P. Saxena and M. A. V´azquez-Castro, “Link layer random network
coding for DVB- S2X/RCS,” IEEE Communication Letters, vol. 19,
no. 7, 2015, pp. 1161-1164.
[14] M. A. V´azquez-Castro and P. Saxena, “Network coding over satellite:
from theory to design and performance,” in proceedings of the 7th EAI
International Conference on Wireless and Satellite Systems, Bradford
(Britain), 2015.
[15] F. Vieira, S. Shintre, and J. Barros, “How feasible is network coding in
current satellite systems ?” in ASMS conf. and SPSC Workshop, 2010,
pp. 31-37.
[16] F. Vieira, D. Lucani, and N. Alagha, “Load-aware soft-handovers for
multibeam satellites: A network coding perspective,” in ASMS conf.
and SPSC Workshop, 2012, pp. 189-196.
[17] R. Alegre-Godoy, N. Alagha, and M. A. Vazquez-Castro, “Offered
capacity optimization mechanisms for multi-beam satellite systems,” in
IEEE ICC, 2012, pp. 3180-3184.
[18] M. A. Vazquez-Castro, “Graph model and network coding gain of
multibeam satellite communications,” in IEEE ICC, 2013, pp. 4293-
4297.
[19] S. Gupta and M. A. Vazquez-Castro, “Location-adaptive network-coded
video transmission for improved quality-of-experience,” in 31st AIAA
International Communications Satellite Systems Conference (ICSSC),
2013.
[20] S. Gupta, M. A. Pimentel-Ni˜no and M. A. Vazquez-Castro, “Joint
network codedcross layer optimized video streaming over relay satellite
channel,” in 3rd international conference on wireless communications
and mobile computing (MIC-WCMC), 2013.
[21] J. Cloud, D. Leith and M. Medard, “Network Coded TCP (CTCP)
Performance over Satellite Networks,” in International conference on
advances in satellite and space communications (SPACOMM), 2014,
pp. 53-556.
[22] M. A. Pimentel-Ni˜no, P. Saxena, and M. A. Vazquez-Castro, “QoE
driven adaptive video with overlapping network coding for best effort
erasure satellite links,” in 31st AIAA international communications
satellite systems conference (ICSSC), 2013.
[23] M. Muhammad, G. Giambene and T. De Cola, “Channel prediction and
network coding for smart gateway diversity in terabit satellite networks,”
in GLOBECOMM, 2014, pp. 3549-3554.
[24] D. S. Lun, M. Medard, R. Koetter, and M. Effros,“On coding for reliable
communication over packet networks,” Physical Communication, vol. 1,
no. 1, 2008, pp. 3 – 20.
[25] S. Yang and R. Yeung, “Coding for a network coded fountain,” in Infor-
mation Theory Proceedings (ISIT), 2011 IEEE International Symposium
on, 2011, pp. 2647–2651.
[26] O. Trullols-Cruces, J. Barcelo-Ordinas, and M. Fiore, “Exact decoding
probability under random linear network coding,” IEEE Communica-
tions Letters, vol. 15, 2011, pp. 67–69.
[27] “ETSI TS 102 606 V1.1.1, Digital Video Broadcasting (DVB); Generic
Stream Encapsulation (GSE) Protocol,” 2007.
[28] “DVB BlueBook a155-2, Digital Video Broadcasting (DVB); Second
Generation DVB Interactive Satellite System (DVB-RCS2); Part 2:
Lower Layers for Satellite standard,” 2013.
[29] F. de Belleville, L. Dairaine, J. Lacan, and C. Fraboul, “Reliable
multicast transport by satellite: A hybrid satellite/terrestrial solution with
erasure codes,” in High Speed Networks and Multimedia Communica-
tions, vol. 3079, Springer Berlin Heidelberg, 2004, pp. 436–445.
[30] S.Galanos, O.Peck, and V.Roca, “RTP payload format for Reed Solomon
FEC,” Internet-Draft, 2011.
[31] A. Pirovano and F. Garcia, “A new survey on improving tcp perfor-
mances over geostationary satellite link,” Network and Communication
technologies, 2, 2013.
[32] S. Floyd, M. Handly, J. Padhye, and J. Widmer. TCP Friendly Rate
Control (TFRC): Protocol Speciﬁcation, IETF RFC 5348, 2008.
[33] H. Seferoglu and A. Markopoulou. Video-aware opportunistic network
coding over wireless network. Journal of Selected Areas in Telecommu-
nications (JSAT), 27:713–728, 2009.
[34] H. P Shiang and M. van der Schaar. A quality-centric TCP-Friendly
congestion control for multimedia transmission. Multimedia, IEEE
Transactions on, 14(3):896–909, 2012.

