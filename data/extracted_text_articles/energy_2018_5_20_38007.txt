Energy Determination of Superconducting Vortex Lattices with Stochastic Methods 
Calculated on GPUs 
 
Manuel Rodríguez-Pascual, José A. Moríñigo, Rafael Mayo-García 
CIEMAT 
Avda. Complutense, 40 
28040 Madrid, Spain 
email: {manuel.rodriguez, josea.morinigo, rafael.mayo}@ciemat.es 
 
 
Abstract—By fabricating Nb films on top of array of Ni 
nanodots with different geometries, the vortex lattice for 
specific values of the external applied magnetic field is 
modified by the array of periodic pinning potentials. In this 
work, a GPU-based code developed from scratch simulating 
this phenomenon is presented. It evaluates the vortex–vortex 
and the vortex–nanodot interactions providing the total 
interaction between vortices and pinning sites, as well as the 
position of the vortices in the array unit cell. This final position 
is obtained with different stochastic processes being able to 
simulate square, rectangular, or triangular arrays of 
nanodefects of different size. A computational performance 
study is also made. 
Keywords- 
Superconducting 
vortices; 
nanostructures; 
heuristics; supercomputation; GPU. 
I. 
 INTRODUCTION 
Superconducting vortex lattice dynamics and vortex 
lattice pinning are strongly modified by arrays of 
nanodefects embedded in superconducting films. By using 
arrays of holes (antidotes), which thread the films or dots 
embedded in the sample, this effect can be studied. Thus, 
many effects can be observed on these hybrid samples, for 
example, reconfiguration of the vortex lattice, effects 
induced by arrays made with different materials, different 
diameters of the pinning centers, channeling effects, etc. 
Magnetoresistance measurements are a perfect tool to 
study these effects, since resistance vs. applied magnetic 
fields shows deep minima when the vortex lattice matches 
the unit cell of the array due to geometric matching occurs 
when the vortex density is an integer multiple of the pinning 
center density. These phenomena are ruled by the balance 
among different interactions, (i) vortex–vortex, (ii) vortex–
artificially induced pinning center (array of nanodefects), 
(iii) vortex–intrinsic and random pinning centers. The 
magnetoresistance minima show up only when the 
temperature is close to Tc, since, at these temperatures, the 
effect of the vortex–array interaction is enhanced. The large 
roughness of the sample surface precludes the use of 
standard local probe methods to detect experimentally the 
vortex position and symmetry of the vortex lattice, which 
could be only inferred from the experimental matching 
conditions. 
Therefore, theoretical approaches have been undertaken 
by computer simulation methods. In a pioneering work, in 
the framework of molecular dynamics, Reichhardt et al. [1], 
by integrating numerically the Langevin equation of motion, 
were able to predict some of the matching fields at which 
commensurate vortex arrangements happen. According to 
this approach, the superconducting penetration depth is the 
crucial parameter. These authors use cut-off conditions, 
pinning strengths and other relevant parameters governed by 
the penetration superconducting depth. In a similar scenario, 
Langevin equation of motion of the vortices, Dinis et al. [2] 
have been able to simulate the rectifier behavior of the vortex 
lattice in the transverse ratchet effect. In this case, the 
parameters are taken from the experiment and the random 
intrinsic pinning of the superconductor plays a crucial role. 
Simulations of vortex dynamics in superconducting films 
with pinning array have been also reported by Kato and 
Enomoto [3], Gropp et al. [4] and Rodríguez-Pascual et al. 
[5].  
In 
this 
work, 
the 
possibility 
to 
simulate 
the 
commensurability experiments in the framework of the 
Langevin equation of motion is explored without any initial 
conditions neither constraints and using only as input the 
vortex–vortex interaction and the periodic pinning sites 
(array unit cell). This process is carried out with genetic 
algorithms and simulated annealing techniques on GPUs. 
The 
experimental 
magnetoresistance 
minima 
permit 
obtaining the number of vortices in the array unit cell and 
figuring out the vortices position for different arrays and 
matching fields, as well as evaluating the vortex lattice 
interaction. 
The article reads as follows. After this Introduction 
section, the experiment that can measures the energy of 
superconducting vortex lattices is described. In Section III, 
the simulation that has been implemented with a code that 
runs on GPUs is presented, as well as the stochastic 
methodologies that have been designed. The obtained results 
are included in Section IV, while the conclusions come in 
Section V. 
II. 
EXPERIMENT 
Superconducting/magnetic hybrids have been grown by 
magnetron sputtering, electron beam lithography and etching 
techniques, for more details see for example. In brief, the 
samples are Nb film on top of array of submicrometric Ni 
82
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-635-4
ENERGY 2018 : The Eighth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

dots which have been fabricated by electron beam 
lithography on Si (100) substrates. Thus, 400×600 nm2 
rectangular arrays of Ni dots have been selected as the 
artificially fabricated pinning arrays for the present work, 
though the code can also simulate squares, rectangles, and 
triangles of any size. The thickness of the Ni dots is 40 nm, 
while the thickness of the Nb film is 100 nm. The diameter 
of the Ni dots is 200 nm. The maximum number of vortices 
that could accommodate one of these pinning sites, i.e., the 
so-called filling factor could be estimated as one vortex per 
dot. 
A cross-shaped bridge of 40 µm is patterned in the 
hybrids for magnetotransport measurements by means of 
standard photolithography and etching techniques. The 
magnetic fields are applied perpendicular to the sample and 
magnetoresistance measurements have been done in a 
commercial cryostat with superconducting solenoid. 
Minima appear at applied magnetic fields Hn = n · φ0/(a · 
b), where a and b are the lattice parameters of the rectangular 
array and φ0 = 2.07 · 10−15 Wb is the fluxoid. The number of 
vortices n per array unit cell can be known by simple 
inspection of the magnetoresistance curves, in which the first 
minimum corresponds to one vortex per unit cell, the second 
minimum to two vortices per unit cell, and so on. 
III. 
SIMULATIONS 
The next step is to model these behaviors by computer 
simulation. This have been done by implementing the DiVoS 
code. Computer simulation with DiVoS reproduces the 
aforementioned 
experimental 
effects, 
but 
different 
geometries of lattices have been also evaluated by 
calculating the interaction of each possible vortices 
configuration and choosing the most convenient, i.e., the one 
with 
the 
lowest 
energy 
according to 
the desired 
specifications (physical parameters) used as input data. This 
code has been implemented from scratch; it does not take 
advantages neither of matching conditions with respect to the 
vortices lattices nor computational cutoff approximations to 
place the vortices. Several interactions are present and the 
code obtains the configuration with the lowest energy, so the 
interactions in the overdamped equation of vortex motion 
can be described as follows: 
 
fi = fi
vv +fi
vp = Σj=1
N
V f0K0( | ri −rj | / λ ) +   
+ Σk=1
N
p (fp/rp)|ri −rk| Θ[(rp − |ri −rk| / λ)]rik         (1) 
 
where fi is the total force per unit length acting on vortex i, 
fi
vv is caused by the vortex–vortex interaction and fi
vp is the 
pinning force. 
The first sum runs up to the total number of vortices Nv 
and K0 is the zero order modified Bessel function, which 
depends on the distance rij and the penetration depth λ, 
being λ (at 0.99Tc) = 2.6 µm in the experiment. Specifically, 
f0 is 3.08·10−6 T2nm in our experiment. 
In addition, the second sum related to pinning force has k 
as the index referring to the different pinning sites in the 
system, Θ as the Heaviside step function, fp as the maximum 
pinning force (it has been considered as 0.5 times the 
constant f0) and rp as the pinning radius (100 nm in our 
experiment). 
The DiVoS code represents the following physical 
model: Surface is represented as a 2D grid; pinning sites 
define either rectangular or triangular cells; there are 1,2...n 
vortices per cell; and, vortex-vortex and vortex-pinning site 
interactions rule the system according to the previous 
formula (1). 
As for the previous experiments, the number of cells 
sums up to 60x60. Considering each cell could contain up to 
3 vortices, for example, the problem to be tackled results in 
7,200 vortices. The interaction of 2 vortices is simulated by 
calculating the distance first and applying the Bessel 
Modified Function afterwards. Doing so, the vortices 
dynamics is performed as a vortex in a given position moves 
by looking at the interactions with all the others and the 
pinning sites and moving to the less energetic adjacent 
position. Thus, there are about 25 million interactions to be 
calculated in every simulation step; in other words, 
considering for example a rectangular cell size of 400x600 
nm (simulated points), there are 240,000 positions for each 
vortex. 
Altogether, an efficient way of calculating the system 
energy and algorithms to discard most of the possible 
configurations is needed, which results in stochastic 
processes such as Genetic Algorithm and/or Simulated 
Annealing in this work. Stochastic processes have 
demonstrated their correct approach [6]. 
A. Genetic algorithm 
A genetic algorithm has been implemented as part of the 
code. As it is well known, a population of candidate 
solutions (called genes) to an optimization problem is 
evolved toward better solutions. Each candidate solution has 
a set of properties which can be mutated and altered 
randomly as the process goes on. 
The evolution starts from a population of randomly 
generated individuals, and is an iterative process. In each 
generation, the fitness of every individual in the population 
is evaluated; the fitness is usually the value of the objective 
function in the optimization problem being solved, i.e. 
previous formula (1). The more fit individuals are 
stochastically selected from the current population, and each 
individual's genome is modified (recombined and possibly 
randomly mutated) to form a new generation. The new 
generation of candidate solutions is then used in the next 
iteration of the algorithm. The algorithm terminates when 
either a maximum number of generations has been 
produced, or a satisfactory fitness level has been reached for 
the population. 
Once the genetic representation and the fitness function 
are defined, the genetic algorithm proceeds to initialize a 
population of solutions and then to improve it through 
repetitive application of the mutation, crossover, inversion, 
and selection operators. The code initializes several genes 
83
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-635-4
ENERGY 2018 : The Eighth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

and let them evolve in a way in which also mutation, 
crossover, inversion, and selection operators can do cross- 
fitting. 
B. Simulatted annealing 
Simulated annealing uses a probabilistic technique for 
approximating the global optimum of the given function (1). 
It is a metaheuristic to approximate global optimization in a 
large search space, mainly used when the search space is 
discrete as it is the case. Simulated annealing is usually 
preferable to alternatives such as gradient descent for 
problems where finding an approximate global optimum is 
more important than finding a precise local optimum in a 
fixed amount of time. 
In the implemented code, fi moves to fi+1 via a proposal, 
i.e. the vortices move randomly to any of the 8 adjacent 
positions (N, NE, E, SE, S, SW, W, and NW). If the new 
state has lower energy, then fi+1 is accepted; unlike, fi+1 is 
accepted with probability A=exp(-∆f/KT) By doing so, 
stochastic acceptance of higher energy states allows the 
process to escape local minima. If the vortices move 1 by 1 
and the comparison is made, the code reproduces molecular 
dynamics processes; if all the vortices move at the same 
time in the single step, multidimensional Gaussian is carried 
out. When T is high, the acceptance of these moves is 
higher, and local minima are discouraged. As T is lowered, 
more concentrated search near current local minima is 
performed due to only few moves will be allowed. Thus, if 
we get the temperature decrease schedule right, it can be 
hoping that there will be converge to a global minimum. 
Reannealing interval, or epoch length (L), is the number 
of points to accept before reannealing (change the 
temperature), i.e., L represents the number of iterations at a 
particular temperature. Larger decreases in T require 
correspondingly longer L to re-equilibrate. Also, running 
long L at larger temperatures is not very useful, so T is 
decreased rapidly at first. Reannealing interval evolves with 
Lk+1=βLk with β>1.  
Thermostat can be simulated in three different ways: 
• 
Linear: Temperature decreases as Tk+1=αTk, (with 
1<α<0) or Tk–α (with α>0) 
• 
Exponential: Temperature decreases as 0.95α with α
≥1 
• 
Logarithmic: Temperature decreases as 1/log(α) 
with α≥10 
IV. 
RESULTS 
In this work, preliminary results of the execution of the 
code for values of the matching point 1, 2, and 3 are 
reported. They are simply  intended to test the computational 
performance as well as the behavior of the different 
stochastic processes. 
Regarding the parallelization, the GPU cluster located at 
CETA was used. Out of the whole amount of resources, 
several GPU cards were used so the number of Nvidia cores 
moved between 1,000 and 5,000. Also, several outcomes 
have been cloncluded: 
• 
Over 99% of the computing time gets into the 
evaluation of interactions 
• 
Original scalability is of O(N²), being N the number 
of vortices 
• 
Parallel scalability is of O(N²/2G), being G the 
number of GPU cores 
• 
By using a cache mechanism, a GPU core is faster 
than a CPU for this problem 
With respect to the genetic algorithm, up to 200 
individuals were randomly created and allocated in different 
Nvidia cores in order to be executed independently. This 
test performed up to 500 generations, i.e., number of steps 
to allow the individual to evolve. Mutation and crossover 
rate are constant 
The data related to the simulated annealing were as 
follow: 
• 
Initial value of T was 25,000 K 
• 
Temperature decreased as Tk+1 = 0.8*Tk 
• 
Population in the simulated annealing is 1 
Also, an experiment which combined simulated 
Annealing and Genetic experiment was carried out. It was 
programmed in a way in which the output of a simulated 
annealing (20 epochs) was employed as input for the genetic 
algorithm (population 20). 
All experiments have been executed 5 times and the 
results are the average values. In order to properly depict the 
obtained results with figures as large as possible, the latter 
are shown below. As it can be seen in Figs. 1 and 2, that for 
the genetic algorithm case, there is no influence of the 
number of individuals in the obtained result of the energy of 
the system as it is roughly constant. Unlike, the higher the 
number of generations, the better result. 
Regarding the execution time, it increases as the number 
of generations increases linearly, but it shows a worse 
behavior with the number of individuals generated. Thus, 
there is a double reason for not increasing the population 
unnecessarily. 
The simulated annealing case is more interesting (see 
Fig.3). It provides the best result both in execution time and 
energy. Also, it can be deducted that the ideal number of 
epochs is close to 100 as it is the region where the energy 
decreases significantly. But not only due to the physical 
interest, which is the higher one in order to obtain valid 
results, the execution time vs. the number of epochs also 
demonstrate that from 150 on the system saturates. 
With respect to the hybrid case, it does not provide a 
significant enhancement as the genetic algorithm behavior 
penalize the simulated annealing one. 
V. 
CONCLUSIONS 
Hybrid superconducting/magnetic samples are fabricated 
with superconducting films on top of array of pinning 
centers. The magnetoresistance of these hybrids, close to 
critical temperature, shows deep and equal spaced minima 
84
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-635-4
ENERGY 2018 : The Eighth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

which are due to commensurability effects between the 
vortex lattice and the unit cell of the array. The first 
minimum appears when the density of the pinning centers 
equals the density of the vortex lattice, upper order minima 
take place at Hn = n(Φ0/S), where n>1 is an integer number 
and Φ0 is the quantum fluxoid. Taking into account the 
vortex–vortex and the vortex–pinning center interactions, a 
GPU-based 
computing 
simulation 
code 
has 
been 
implemented. This code can calculate different values and 
positions for different lattices in size, matching field values, 
and geometry of the pinning sites, which allows having a 
picture of the different vortex lattices. 
The position of the vortices, as well as the minimum 
energy are obtained with three different stochastic 
methodologies: genetic algorithm, simulated annealing, and, 
a combination of the former. The best results are provided 
by the simulated annealing version. 
Further tests are needed to be carried out in order to 
properly match experiment and simulation switching 
different parameters for the simulated annealing case. 
ACKNOWLEDGMENT 
This work was partially funded by the Spanish Ministry 
of Economy, Industry and Competitiveness project CODEC2 
(TIN2015-63562-R) with European Regional Development 
Fund (ERDF) and by the European Commission H2020 
project HPC4E (Grant Agreement n 689772). This work was 
carried out on the computing facilities provided by the 
Extremadura Research Centre for Advanced Technologies 
(CETA-CIEMAT) with ERDF funds and the CYTED 
Network RICAP (517RT0529). 
REFERENCES 
[1] C. Reichhardt, C.J. Olson, F. Nori, “Commensurate and Incommen-
surate Vortex States in Superconductors with Periodic Pinning 
Arrays”, Phys. Rev. B 57(13), pp. 7937-7943, 1998. 
[2] L. Dinis, D. Pérez de Lara, E.M. González, J.V. Anguita, J.M. 
Parrondo, J.L. Vicent, “Transverse Ratchet Effect and Supercon-
ducting Vortices: Simulation and Experiments”,  New J. Phys. 11, 
073046, 2009. 
[3] R. Kato and Y. Enomoto, “Simulations of Vortex Dynamics in 
Superconducting Films with Pinning Array”. Physica B: Condensed 
Matter 284–288, pp. 899-900, 2000. 
[4] W.D. Gropp, H.G. Kaper, G.K. Leaf, D.M. Levine, M. Palumbo, 
V.M. Vinokur, “Numerical Simulation of Vortex Dynamics in Type-
II Superconductors”, J. Computational Physics 123(2), pp.254-
266,1996.  
[5] M. Rodríguez-Pascual, A. Gómez, R. Mayo-García, D. Pérez de Lara, 
E.M. González, A.J. Rubio-Montero, J.L. Vicent, “Superconducting 
Vortex Lattice Configurations on Periodic Potentials: Simulation and 
Experiment”, J. Supercond. 25, pp. 2127-2130, 2012. 
[6] N.G. Van Kampen, “Stochastic Processes in Physics and Chemistry”, 
3ed., North Holland, 2007. 
 
 
 
 
 
85
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-635-4
ENERGY 2018 : The Eighth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

 
Figure 1.  Genetic algorithm version of the code. Influence of the population on the energy obtained and the executiont time. 
86
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-635-4
ENERGY 2018 : The Eighth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

 
Figure 2.  Genetic algorithm version of the code. Influence of the generations on the energy obtained and the executiont time 
87
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-635-4
ENERGY 2018 : The Eighth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

 
Figure 3.  Simulated annealing case. Influence of the number of epochs in the obtained energy amdon the execution time 
 
88
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-635-4
ENERGY 2018 : The Eighth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

