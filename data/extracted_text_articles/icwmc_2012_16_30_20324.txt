Performance Analysis of Synchronization for an OFDMA System
Jihyung Kim, Jung-Hyun Kim, Kwang Jae Lim, and Dong Seung Kwon
Mobile Convergence Research Division
ETRI
DAEJEON, KOREA
Email: {savant21, jh.kim06, kjlim, dskwon}@etri.re.kr
Abstract—We present the time and frequency synchroniza-
tion algorithm as well as the cell search scheme for cellular sys-
tems. Coarse time and fractional frequency offset estimates are
performed in the time domain by using the primary preamble,
while the cell search and the integer frequency offset estimate
are performed in the frequency domain and afterwards the ﬁne
time and frequency offset estimates are performed by using
the secondary preamble. All algorithms are evaluated under
rapidly time-varying multipath fading channels and an initial
carrier frequency mismatch. The simulation results show that
the proposed algorithm can provide a robust synchronization
and cell-search capability, even in bad cellular environments.
Keywords-synchronizatoin; preamble; OFDMA.
I. INTRODUCTION
Orthogonal
frequency
division
multiplexing
access
(OFDMA) is an efﬁcient multicarrier technique which has
been proposed for current and next generation wireless
communication systems, for example IEEE 802.16e (mobile
WiMAX) and IEEE 802. 16m [1] [2]. However, time offsets
(TOs) and frequency offsets (FOs) between the base-station
(BS) and the mobile users (MUs) arising due to local
oscillator mismatch and/or the mobility of the users destroy
the orthogonality among the user’s sub-carriers. Inter symbol
interference (ISI) and Inter carrier interference (ICI) caused
by these TOs and FOs severely degrade the performance
of the whole system. Therefore, the estimation and the
compensation of TO and FO are imperative at the BS and
the MUs.
In many situations that time delays and Doppler spreads
exist, TO and FO synchronization only at the downlink of
OFDMA systems is not sufﬁcient and calls for TO and
FO synchronization at the uplink as well. However, TO
and FO synchronization is much more challenging at the
uplink due to the presence of multiple TOs and FOs and
the fact that the received signal at the BS is the sum of the
transmitted signals from all the users. In addition, ensuring
the identiﬁability of cell is also an important requirement.
By utilizing cell-speciﬁc reference signal, target TO and FO
can be restored from a signal disturbed by other users’ TOs
and FOs mismatch.
Various solutions of synchronization for OFDMA systems
have been proposed in the literature [3]∼ [6], but only a few
of them also discuss the identiﬁability [7] [8]. In this paper,
P-preamble
S-preamble
Data Slot
Data Slot
Nframe
Primary
preamble
CP
G
N
Ns
Figure 1.
Abstract frame structure
we invest an overall synchronization process including the
identiﬁcation. Moreover, we consider the mobility. The
mobility of the receiver relative to transmitter is the main
factor that affects the rate of fading. As the receiver moves
with some velocity relative to the transmitter, the phase
shifts of the received signal changes. This phenomenon is
known as the Doppler effect. In practical OFDMA systems,
a frequency offset due to the Doppler effect usually exists
between the transmitter and the receiver.
This paper is organized as follows: Section II introduces
a basic OFDMA system. Section III presents the proposed
synchronization algorithm in detail. Section IV shows the
performance of overall proposed scheme and compari-
son with the performance of without-ﬁne synchronization
scheme. Finally, Section V gives some conclusions.
II. SYSTEM MODEL
As shown in Figure 1, we consider a packet-based
OFDMA communication system, where a preamble is placed
at the beginning of the packet. The preamble consists of
two different components, which are denoted as the pri-
mary preamble and the secondary preamble as similar to
IEEE802.16m [2]. The length of each preamble is an OFDM
symbol, which is the same length of a data symbol. We
consider an OFDM symbol with two identical halves in the
time domain as the primary preamble. The primary preamble
is common for all BSs and is used for the TO and FO
synchronization. The secondary preamble is used for the
cell-ID identiﬁcation and it can also be used to estimate
more accurate TO and FO in bad cellular environments. In
this paper, we propose a robust synchronization technique
376
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

using the primary preamble for coarse synchronization and
using the secondary preamble for the ﬁne synchronization
as well as the cell-ID identiﬁcation.
In the time domain, the n-th sample of a base-band
equivalent OFDM symbol is given by
x(n) =
1
√
N
N−1
X
k=0
X(k)ej2πkn/N,
(1)
where j = √−1, −G ≤ n ≤ N − 1, N is the total
number of subcarriers for an OFDM symbol, X(k) is the
k-th modulated signal in the frequency domain, and G is the
length of cyclic preﬁx (CP), which is assumed to be longer
than the length of channel impulse response. The signal
is transmitted through a frequency selective channel. Let
h(n) denote the base-band equivalent discrete-time channel
impulse response of length ν. A carrier frequency offset of ϵ
(normalized with subcarrier spacing) causes a phase rotation
of 2πϵn/N. Assuming a perfect sampling clock, the received
samples of the OFDM symbol are given by
y(n) = ej[(2πϵn/N)+ϵ0]
ν−1
X
l=0
h(l)x(n − l) + z(n),
(2)
where ϵ0 is an initial arbitrary carrier phase and z(n) is a
zero mean symmetric complex white Gaussian noise with
variance σ2
z. x(n − l) is the (n − l)-th transmitted sample in
the time domain.
III. ROBUST SYNCHRONIZATION AND CELL SEARCH
SCHEME
We construct a procedure including coarse time and
frequency synchronization, cell search, and ﬁne time and
frequency synchronization as illustrated in Figure 2. If
the decoder fails several times by a wrong cell-ID or
large synchronization errors, the synchronization will be
refreshed. Similarly when the estimated cell is not conﬁrmed
after several iterations, which means that the cell were
estimated falsely, the complete process is performed from
the beginning. We now introduce the procedure of overall
synchronization scheme step by step.
A. Coarse Time and Frequency Offset Estimation
For coarse synchronization, the primary preamble is used.
The primary preamble excluding CP consists of two identi-
cal halves. Using the character of the primary preamble, we
can obtain a coarse TO and FO jointly. Based on [9], the
timing metric by using auto-correlation in the time domain
is given by
M(k) = |P(k)|2
R2(k) ,
(3)
Coarse time and
fractional frequency
offset estimation
Coarse time and
fractional frequency
offset compensation
Cell search and
integer frequency 
offset estimation
Integer frequency 
offset compensation
Fine time and
fractional frequency 
offset estimation
Fine time and
fractional frequency 
offset compensation
Figure 2.
Proposed synchronization process
where P(k) and R(k) are
P(k) =
G+N/2−1
X
i=0
y(k + i)y∗(k + i + N/2),
(4)
R(k) = 1
2
G+N−1
X
i=0
|y(k + i)|2,
where (·)∗ denotes the complex conjugate, y(k) is the k-
th sample of the base-band equivalent received signal, and
R(k) gives an estimate of the energy in G + N samples
of the received signal for the normalization. N/2 is chosen
such that the angle of P(k) lies in the range [-π,π] [10].
Then, we can obtain the estimated TO, τcoar, and the
estimated FO, εcoar, from the metric M(k) and P(k),
separately.
τcoar = arg max
k
M(k),
(5)
εcoar = − 1
π ∠(P(k)).
B. Cell search and integer FO estimation
The cell-ID can be jointly estimated with the integer FO.
For the cell search, a simple method is to use a cross
correlation between the received signal and the secondary
preamble in the frequency domain. However, the algorithm
based on the cross correlation between the reference signal
and the received signal of the secondary preamble has per-
formance degradation due to TO and FO mismatch between
them. Therefore, we adopt a differential cross-correlation
method that is robust to TO and FO over frequency selective
channels and has the clear peak value at the estimated frame
timing from the coarse synchronization.
For the integer FO estimation, we exploit the cyclic shifts
of the secondary preamble sequence according to the cell-
ID. The quantity of integer FO can be estimated by the
subcarrier cyclic shift value maximizing the metric. This is
described as follows:
C(k, i) = W(k, i)
V (k, i) ,
(6)
377
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

where
W(k, i) =
Nl−D−1
X
k=0
αk+Dα∗
kβ∗
k+D,iβk,i,
(7)
V (k, i) = 1
4η
Nl−D−1
X
k=0
|αk+D|2 + |αk|2
(8)
+ η|βk+D,i|2 + η|βk,i|2,
αk = Y (Lc(k)), αk+D=Y (Lc (k + D)), βk,i=S((Lc(k) +
i)modN), and βk+D,i=S((Lc(k + D) + i)modN). η is
1
Nl
PNl−D−1
k=0
Y (Lc(k)) which is the normalization factor.
Y (·) is the received signal and S(·) is the reference sig-
nal, and Lc(·) is a pilot subcarrier index allocated in the
frequency domain. D is the coefﬁcient for the differential
cross-correlation and set to 1 in this paper.
Then, we can obtain the estimated cell-ID, κ, and the
estimated integer FO, ξ, from the metric C(k, i).
κ = arg max
k
C(k, i),
(9)
ξ = arg max
i
C(k, i).
The magnitude |C(k, i)| is expected to show a centrally
located high peak over threshold when the cell-ID was
correctly estimated. In the opposite case, if a correlation
will be performed between two unequal reference sequences
or between a reference sequence and received signal, then
|C(k, i)| will not show a signiﬁcant peak and the estimated
cell-ID shall be considered as false.
C. Fine Time and Frequency Offset Estimation
After performing the coarse time synchronization scheme,
the estimated time is moved earlier by a few samples. This
means that the FFT starting point is located within CP, and
then makes to avoid ISI. The conventional method applied
to ﬁne time synchronization calculates a cross correlation
value generated by producing the received signal and local
samples with known long training symbols. However, the
multipath channel introduces inter-path interference (IPI)
into the received signal which can not be removed by the
correlation based method in the conventional time offset
estimation. Thus, we propose a new ﬁne time and frequency
synchronization scheme by using the secondary preamble.
Assuming a candidate of FO as ϵ in the ﬁxed point, we
can calculate j(n) from the received signal y(n) as follows:
j(n) = e−2πϵny(n).
(10)
For a sake of simplicity, j is a vector of j(·) in the time
domain and S is a vector of the reference signal S(·) in the
frequency domain.
J = FFT(j).
(11)
Then,
h = IFFT(J · S∗),
(12)
= 1
N
N−1
X
k=0
Y (k)S∗(k)ej2πkn/N
= 1
N
N−1
X
k=0
X(k)H(k)ej2πkδ/NS∗(k)ej2πkn/N
= 1
N
N−1
X
k=0
H(k)ej2πk(n+δ)/N
= h(n + δ)
where X(k)S∗(k)=1 in the case of the corrected cell-ID
estimation and the h is the channel impulse response vector.
Then, we can jointly obtain the estimated TO, τfine, and the
estimated FO, εfine, from the ﬁnal metric, h
′(·).
τfine = max
k
h
′(k, ϵ),
(13)
εfine = arg max
ϵ
h
′(k, ϵ),
where
h
′(k, ϵ) =
H−1
X
k=0
h(k, ϵ).
(14)
Here, h
′(·) is calculated by a summation of the ﬁrst metric
h(·) with length H in order to improve the performance of
the peak value in the multi-path fading channel.
IV. SIMULATION RESULTS
Several simulations are carried out to evaluate the per-
formance of the proposed synchronization method. The
main parameters for an OFDMA system are chosen as
follows: The number of subcarriers is 2048 and the nom-
inal channel bandwidth is 20MHz, and the carrier fre-
quency is 2.4GHz. The used channel is Veh-A of ITU-
R of which the relative delay and the average power
are [0;310;710;1090;1730;2510](ns) and [0;-1;-9;-10;-15;-
20](dB), respectively [11].
The performance achieved by the proposed estimator is
evaluated in terms of the mean squared error(MSE) accord-
ing to signal-to-noise ratio(SNR), E[|H(k)S(k)|2/|Z(k)|2].
It is computed as
MSE(ˆθ) = E[|ˆθ − θ|2],
(15)
where E[·] denotes the expectation and ˆθ is an estimated
value with respect to θ.
Figures 3 and 4 depict the MSE curve when the time
offset by propagation delay is 500µs and the normalized
frequency offset is 1.01. We can see that the proposed
algorithm works robustly for a high delay spread fading
channel in the presence of both Doppler spread and an initial
frequency offset.
378
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

−6
−4
−2
0
2
4
6
8
10
0
500
1000
1500
2000
2500
3000
3500
4000
4500
Time Synchronization
SNR (dB)
MSE of time offset
 
 
without fine sync (veh−A 350km/h)
with fine sync (veh−A 350km/h)
without fine sync (veh−A 240km/h)
with fine sync (veh−A 240km/h)
Figure 3.
Mean Squared Error of time synchronization
−6
−4
−2
0
2
4
6
8
10
1
2
3
4
5
6
7
8
9
x 10
−4
Frequency Synchronization
SNR (dB)
MSE of normalized frequency offset
 
 
without fine sync (veh−A 350km/h)
with fine sync (veh−A 350km/h)
without fine sync (veh−A 240km/h)
with fine sync (veh−A 240km/h)
Figure 4.
Mean Squared Error of frequency synchronization
Figure 5 shows the code detection probability for cell
search. It provides the reliable cell search ability without
additional reference signal by the result of time synchro-
nization. Furthermore, the simulation results show that the
performance of the proposed estimator is tolerant to the
variation in the mobility of a user.
V. CONCLUSION
In this paper, a novel preamble-based synchronization
and cell-search technique for OFDMA cellular systems was
proposed. The preamble is composed of the primary and the
secondary preamble. With the primary preamble, the initial
coarse time and frequency offset estimation are performed.
With the secondary preamble, the cell-search algorithm is
proceeded in a hierarchical manner, the integer frequency
-6
-4
-2
0
2
4
6
8
10
0.88
0.9
0.92
0.94
0.96
0.98
1
Cell Search
SNR (dB)
Code success probability (%)
 
 
veh-A 350km/h
veh-A 240km/h
Figure 5.
Success probability of cell search
offset estimation and the cell-ID sequence estimation. The
ﬁne time and frequency offset estimation is also performed
with the secondary preamble. The overall performance of
the synchronization and cell search was analyzed in terms
of MSE in time and frequency-selective fading channels.
Therefore, we conclude that the proposed algorithm provides
the robust synchronization and cell-search capability, even
in bad cellular environments.
ACKNOWLEDGMENT
This research was supported by the KCC (Korea Com-
munications Commission), Korea, under the R&D program
supervised by the KCA (Korea Communications Agency)
(KCA 10-911-04-003)
REFERENCES
[1] IEEE Std 802.16TM-2009, “Part 16: Air interface for broadband
wireless access systems,” IEEE, May 2009.
[2] IEEE Std 802.16mTM 2011, “Part 16: Air interface for broad-
band wireless access systems,” IEEE, May 2011.
[3] T. Pollet, M. Van Bladel, and M. Moeneclaey, “Ber sensitivity
of ofdm systems to carrier frequency offset and weiner phase
noise,” IEEE Transactions on Communications, vol. 43, pp.
191–193, February 1995.
[4] Po-Sen Wang, Kai-Wei Lu, D.W.Lin, and Pangan Ting, “Quasi-
maximum likelihood initial downlink synchronization for IEEE
802.16m,” SPAWC2011, pp.521-525, June 2011.
[5] T.M.Schmidl and D.C.Cox, “Robust frequency and timing
synchronization for ofdm,” IEEE Transactions on Communi-
cations, vol. 45, pp. 1613–1621, December 1997.
[6] Y.Mostoﬁ and D.C.Cox, “Robust timing synchronization de-
sign in ofdm systems - part ii: high-mobility cases,” IEEE
Transactions on Wireless Communications, vol. 6, pp. 4340–
4348, December 2007.
379
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

[7] Dong-Uk Lee, Pansoo Kim, and Wonjin Sung, “Robust frame
synchronization for low signal-to-noise ratio channels using
energy-corrected differential correlation,” EURASIP Journal on
Wireless Communications and Networking, vol. 2009, 2009.
[8] K.Taura, M.Tsujishita, M.Takeda, H.Kato, M.Ishida, and
Y.Isida, “A digital audio broadcasting (dab) receiver,” IEEE
Transactions on Consumer Electronics, vol. 42, pp. 322–327,
Augest 1996.
[9] Chi-Min Li, Wei-Tse Sun, and Pao-Jen Wang, “An overlap s&c
method for ofdm synchronization,” IEICE Electronics Express,
vol. 7, pp. 1773–1777, November 2010.
[10] K.Vasudevan, “Digital Communications and Signal Pro-
cessing,” Universities Press 2010, 2nd ed., www. universi-
tiespress.com, 1996.
[11] ITU-R M.1225, “Guidelines for the evaluation of radio trans-
mission technologies for imt-2000,” ITU-R, 1997.
380
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

