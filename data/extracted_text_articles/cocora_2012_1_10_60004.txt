Dual-Lag Correlation-Based Feature Detection of
OFDM Signals with Cyclic Phase Compensation
Vesa Turunen, Marko Kosunen, Visa Koivunen∗ and Jussi Ryynänen
Aalto University School of Electrical Engineering
Department of Micro- and Nanosciences / ∗Department of Signal Processing and Acoustics,
SMARAD, P.0 Box 13000, 00076 AALTO, Finland
Email: {Vesa.Turunen, Marko.Kosunen, Visa.Koivunen, Jussi.Ryynanen}@aalto.ﬁ
Abstract—This paper presents cyclostationarity-based spec-
trum sensing algorithm implementation for detection of OFDM
signals. The detector utilizes two distinct autocorrelation delays
and introduces compensation of the phase difference between
the two cyclic autocorrelation functions. This improves detection
sensitivity (or alternatively reduces detection time) compared to
other similar algorithms while maintaining the constraint on false
alarm rate. The phase compensation can be performed without
requiring any new information about the signal properties.
Furthermore, incorporation of the phase compensation reduces
overall computational complexity of the algorithm and therefore
leads to simpler implementation that uses fewer logic gates and
consumes less power.
Keywords-Autocorrelation,
cognitive
radio,
detection
algo-
rithms, OFDM, spectrum sensing.
I. INTRODUCTION
The objective of spectrum sensing is to identify free
spectrum or detect the presence of communication signals
in certain frequency band quickly and reliably. In general,
detection performance is characterized by the probability of
signal detection and the probability of false alarm. The ﬁrst
determines the detection sensitivity, i.e. the received signal
power level (or SNR) where the signal can still be detected
with desired probability in given detection time. The false
alarm rate, on the other hand, has to be kept sufﬁciently low
such that the spectrum sensor is able to ﬁnd the free spectrum.
In most spectrum sensing schemes, increasing the detection
time (i.e. the number of received samples) improves the
sensitivity. However, short detection time is desirable for many
reasons and more powerful algorithms are sought to improve
the detection sensitivity without increasing the detection time.
Usually, using more complex algorithm leads to increased
computational complexity, which translates into higher number
of logic gates and increased power consumption in the actual
implementation.
Cyclostationarity-based spectrum sensing algorithms (CB-
SSA) [1] [2] [3] are a strong candidate for future spectrum
sensing implementations due to their superior detection sensi-
tivity and inherent ability to distinguish among different type
of communication signals. They are especially suitable for
detection of orthogonal frequency division multiplex (OFDM)
signals that exhibit strong periodic correlation due to insertion
of the cyclic preﬁx (CP) in front of each OFDM symbol
(Fig. 1). Well-known tests exist that utilize multiple lags
simultaneously to increase the detection sensitivity while keep-
ing the detection time constant [3]. Detector implementations
that are based on signal’s cyclostationary features have been
reported in [4] [5].
This work introduces a new dual-lag CBSSA implementa-
tion for detection of OFDM signals that is based on spatial sign
cyclic correlation estimator (SSCCE) presented by Lunden
et al. in [3]. We show that the test statistics can be written
in a simpler form by deducing and compensating the phase
difference of the two SSCCE, which are calculated using
distinct lag values. The new test statistics achieves better
detection sensitivity and also leads to a reduced computational
complexity while maintaining the desired false alarm rate.
This paper is organized as follows: Section II is a short
review on spectrum sensing algorithms that can be used to
detect OFDM signals utilizing the cyclostationary properties.
The proposed algorithm is presented in Section III and an ex-
ample implementation is given. Section IV presents simulation
results and a conclusion is given in Section V.
II. REVIEW OF CYCLOSTATIONARITY-BASED SPECTRUM
SENSING ALGORITHMS
A. Statistical Test for Presence of Cyclostationarity
The conventional statistical tests for presence of cyclosta-
tionarity [1] estimate the (conjugate) cyclic autocorrelation
funtion (CAF)
ˆRxx(∗)(α, τ) = 1
N
N−1
X
n=0
x[n]x∗[n − τ]e−j2παn,
(1)
where x[n] = xi[n] + ixq[n] is a complex input signal, α
is the cyclic frequency, and τ is the lag parameter in the
autocorrelation. N denotes the number of received samples
that are used for signal detection and therefore, together with
the signal sampling rate, determines the detection time.
In order to test for the presence of cyclostationarity a
hypothesis test is formulated as follows:
H0 :
ˆrxx(∗) =
ǫxx(∗)
(2)
H1 :
ˆrxx(∗) =
rxx(∗) + ǫxx(∗),
(3)
where
ˆrxx(∗)
=
[ℜ{ ˆRxx(∗)(α, τ1)}, . . . , ℜ{ ˆRxx(∗)(α, τK)},
ℑ{ ˆRxx(∗)(α, τ1)}, . . . , ℑ{ ˆRxx(∗)(α, τK)}] (4)
1
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

Fig. 1.
OFDM symbol consists of a data block and a cyclic preﬁx that
contain NF F T and NCP samples, respectively.
contains the estimates of conjugate cyclic autocorrelation
functions for K lags, rxx(∗) is the vector of true nonrandom
cyclic autocorrelation functions and ǫxx(∗) is the estimation
error of ˆrxx(∗). Under the null hypothesis the cyclostationarity
does not exist and (4) contains only the estimation error.
Test statistics for the generalized likelihood ratio test is then
derived [1] and is given as
T = ˆrxx(∗) ˆΣ−1ˆrT
xx(∗),
(5)
where ˆΣ−1 is the inverse covariance matrix of ˆrxx(∗) [1].
Under the null hypothesis the test statistics is chi-square
distributed with 2K degrees of freedom. Consequently, a
Neyman-Pearson test can be performed by comparing the test
statistics (5) to the threshold that is obtained from the inverse
of the chi-square cumulative distribution function (cdf). If
the observed test statistics value exceeds the pre-calculated
threshold, then it is concluded that signal is present.
To extract the cyclostationary features of that are induced by
the basic modulation schemes, such as amplitude modulation,
the received signal usually needs to be oversampled with
respect to its baseband sample rate. The lag values that are
utilized in test are then in the order of the baseband sample
period. The algorithm can be used to detect cyclostationary
features of the OFDM signal that result from insertion of the
cyclic preﬁx, but then the cyclostationary features occur at the
OFDM symbol level. Assuming that the signal is sampled at
the baseband sampling rate, the detection can be performed
using autocorrelation delay (lag) values τ = ±NF F T and
cyclic frequencies α = k/(NF F T +NCP ), k = 0, ±1, ±2 . . . ,
where NF F T denotes the size of the IFFT that is used to form
the data part of the symbol and NCP is the length of the cyclic
preﬁx as presented in Fig. 1. Extension of this algorithm that
tests also for multiple cyclic frequencies is presented in [2].
B. Spatial Sign Cyclic Correlation Estimator
Recently, it was shown in [3] that the amplitude of the
received signal samples can be normalized while preserving
the cyclostationary features. Normalization is performed in
order to improve the robustness of the employed detector in
the face of impulsive noise and interference. This is achieved
at the cost of minimal performance loss in AWGN channel.
This also leads to a simpler implementation since the noise
statistics are known a priori and therefore do not need to be
estimated from the received signal samples. The input sample
normalization is denoted in [3] as a spatial sign function
S(x[n]) =
(
x[n]
|x[n]|
if x[n] ̸= 0
0
if x[n] = 0.
(6)
The spatial sign cyclic correlation estimator (SSCCE) is
then deﬁned as [3]
ˆRS(α, τ) = 1
N
N−1
X
n=0
S(x[n])S(x∗[n − τ])e−j2παn.
(7)
Constant alarm rate test similar to what was described in
Sec. II-A is then derived in [3]. The test statistics is
TS,K = N||rS,K||2,
(8)
where
rS,K = [ ˆRS(α, τ1), ˆRS(α, τ2), . . . , ˆRS(α, τK)].
(9)
For AWGN, the test statistics TS,K is shown to be gamma
distributed with shape factor K and scale factor 1 [3] and,
therefore, the threshold for the test is obtained from inverse
of gamma cdf. By comparing Eq. (5) and (8) we see that
the application of the spatial sign function simpliﬁes the test
statistics considerably. Although it does introduce the need for
calculating the spatial sign function, the overall complexity
cost of that is much less than that of calculating the inverse
covariance matrix in (5).
III. CYCLIC PHASE COMPENSATION
Let us start by rewriting (8) for the dual-lag case (K = 2),
which is of special interest for detection of the OFDM signals
using the cyclic frequency of 1/(NF F T + NCP ). Equations
(7)-(9) can be combined to yield
TS,2 = N

ˆRS(α, τ1)
|
{z
}
C1

2
+ N

ˆRS(α, τ2)
|
{z
}
C2

2
.
(10)
where τ1 and τ2 are set to +NF F T and −NF F T , respectively.
The two SSCCE in (10), namely C1 and C2, present
two complex values that have some magnitude and phase in
complex plane. The stronger the correlation, the larger are the
magnitudes. The difference in their phase can be written as
φ = arg(C1) − arg(C2).
(11)
Fig. 2 presents the time-domain autocorrelation sequences
of C1 and C2 of the OFDM signal, showing the periodically
alternating correlating and non-correlating subsequences. It
follows from the structure of the OFDM symbol stream that
when detecting an OFDM signal with using the two lags
(±NF F T ), then for sequential OFDM symbols the phase
difference φ is constant and can be expressed as function of
τ and α as
φ = 2πτ1α.
(12)
Now if we compensate the phase difference, the two SSCCE
can be combined. We deﬁne a new test statistics as
T c
S,2 = 2N
 ˆRS(α, τ1) + ˆRφ
S(α, τ2)

2
,
(13)
2
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

Fig. 2.
The time-domain autocorrelation sequences of the OFDM signal
for lags ±NF F T . Cyclic phase offset is deducted from the structure of the
OFDM symbol stream.
where
ˆRφ
S(α, τ) = 1
N
N−1
X
n=0
S(x[n])S(x∗[n − τ])e−j2παn+φ
(14)
is the SSCCE with cyclic phase compensation.
The difference between (13) and (10) is the constant phase
shift in the second exponent term. Computationally (13) is
simpler because it does the summation of the two cyclic au-
tocorrelation functions before calculating the absolute square
value. This will halve the number of integrators and multipliers
that are needed in the hardware implementation of the test
statistics calculation. Test statistics in (13) is also gamma-
distributed, but with shape factor 1 as opposed to the shape
factor 2 in (10). Both detectors calculate the test statistics from
a vector of N received samples.
A. Implementation
Next, an implementation for calculating (13) is proposed.
Implementation is done mostly in angular domain to avoid
complex multiplications [6]. Angular domain representation
suits the algorithm well since the signal magnitude is normal-
ized to one for all non-zero samples (amount of zero samples
are assumed negligible). Next we denote the phase of each
sample as
ϕx[n] = arg(x[n])
(15)
and rewrite (13) as presented in (16). Because additions are
difﬁcult to implement in angular domain, the signal is mapped
back to Cartesian coordinates after ﬁnishing the calculation
of the exponents. The calculation of the argument and the
mapping back to the Cartesian coordinates can be effectively
implemented with the well-known CORDIC algorithm [7].
Fig. 3 presents the proposed implementation for calculating
test statistics in (16). First a CORDIC is used to calculate
argument of the input samples. A random access memory
(RAM) block is used to implement the two delays. A simple
integrator is needed to accumulate the ϕα[n] term. Five adders
are then used to ﬁnish the calculation of the two exponent
terms, including the cyclic phase offset φ. After the exponen-
tial terms are resolved, signal is mapped back to Cartesian
coordinates using two CORDICs. Finally, the calculation of
the test statistics is ﬁnished using two integrators, multipliers
for calculation of the absolute square and a ﬁnal division.
IV. SIMULATIONS
Performance of the proposed detector is compared to SS-
CCE presented by Lunden in [3] by conducting a series
of Matlab simulations. The simulations utilize OFDM signal
(NF F T = 52, NCP = 12, subcarrier modulation 16-QAM)
and N = 2048 samples per detection. Three detectors are
compared: 1) SSCCE with single lag, 2) SSCCE with two lags
and 3) the proposed SSCCE detector with two lags and the
cyclic phase compensation. The single lag detector uses delay
τ=NF F T , whereas the dual-lag detectors use τ = ±NF F T . All
detectors make the detection from the single cyclic frequency
α = 1/(NF F T + NCP ) (relative to the sampling rate) and
have the probability of false alarm set to 5%.
Fig. 4 presents probability of detection as a function of
signal-to-noise ratio (SNR) for the three detectors in an AWGN
channel. The simulation shows that the proposed detector has
the best detection sensitivity. The improvement over 2-lag
SSCCE is less than 1 dB in SNR and approximately 2 dB
when compared to the single lag SSCCE. The single lag
SSCCE, which is the simplest to implement, would achieve
the same performance than the proposed detector by doubling
the number of samples N (and thus doubling the detection
time).
Fig. 5 presents average test statistics values from the previ-
ous simulation. The difference in test statistics of the dual-
lag SSCCE and the proposed detector is due to the early
combination of the two SSCCE in (13), which leads to a
reduction in the degrees of freedom of the distribution of
the test statistics under the null hypothesis. Consequently, this
reduction in the degrees of freedom enables more efﬁcient test
which can be seen as an improvement in the sensitivity of the
detector.
Finally, Fig. 6 shows simulated receiver operating character-
istics (ROC) curves for the three detectors. In this simulation
the SNR is set to -5 dB and the other simulation parameters are
identical to the previous simulation. The introduction of the
cyclic phase compensation in the proposed detector provides
a distinctive improvement over the prior work.
V. CONCLUSION
This paper has introduced an improved dual-lag test for the
spatial sign cyclic correlation estimator that can be used for
OFDM signal detection in spectrum sensing applications. The
key idea in this work has been to deduce and compensate the
phase difference between the two SSCCE that are obtained us-
ing two distinct lag values. The proposed detection algorithm
has been shown to achieve improved probability of detection
compared to the prior work while keeping the false alarm
rate constant. Moreover, the algorithm has also been shown
to result in reductions in the computational complexity, which
makes it more suitable for practical implementations.
ACKNOWLEDGMENT
The authors would like to thank Nokia Research Center
and Finnish Funding Agency for Technology and Innovation
(TEKES) for the ﬁnancial support in this research.
3
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

T c
S,2 =
1
2N

N−1
X
n=0
(ej(ϕx[n]−ϕx[n−τ1]−ϕα[n]) + ej(ϕx[n]−ϕx[n−τ2]−ϕα[n]+φ))

2
,
(16)
Fig. 3.
Implementation of the proposed dual-lag SSCCE algorithm with cyclic phase compensation.
−20
−15
−10
−5
0
5
0
10
20
30
40
50
60
70
80
90
100
SNR (dB)
Probability of Detection (%)
 
 
SSCCE, 1 lag
SSCCE, 2 lags
ThisWork, 2 lags
Fig. 4.
Probability of detection as a function of SNR. The proposed detector
outperforms the prior work in terms of detection sensitivity while maintaining
the constant false alarm rate.
−20
−15
−10
−5
0
5
0
10
20
30
40
50
SNR (dB)
Average Test Statistics Value
 
 
SSCCE, 1 lag
SSCCE, 2 lags
ThisWork, 2 lags
Fig. 5.
Average test statistics as a function of SNR. Compared to the 2-lag
SSCCE detector, this work achieves reduction in the degrees of freedom in the
distribution of the test statistics, which enables the performance improvement.
0
10
20
30
40
50
60
70
80
90
100
0
10
20
30
40
50
60
70
80
90
100
False Alarm Rate (%)
Probability of Detection (%)
 
 
SSCCE, 1 lag
SSCCE, 2 lags
ThisWork, 2 lags
Fig. 6.
Receiver operating characteristics (SNR=-5 dB). The introduction of
the cyclic phase compensation provides a distinctive improvement over the
prior work.
REFERENCES
[1] A. Dandawate and G. Giannakis, “Statistical tests for presence of cy-
clostationarity,” IEEE Trans. Signal Processing, vol. 42, pp. 2355–2369,
Sept. 1994.
[2] J. Lunden, V. Koivunen, A. Huttunen, and H. V. Poor, “Collaborative
cyclostationary spectrum sensing for cognitive radio systems,” IEEE
Trans. Signal Processing, vol. 57, pp. 4182–4195, Nov. 2009.
[3] J. Lunden, S. A. Kassam, and V. Koivunen, “Robust nonparametric cyclic
correlation-based spectrum sensing for cognitive radio,” IEEE Trans.
Signal Processing, vol. 58, pp. 38–52, Jan. 2010.
[4] A. Tkachenko, A. Cabric, and R. Brodersen, “Cyclostationary feature
detector experiments using reconﬁgurable BEE2,” in Proc. IEEE Int.
Symp. New Frontiers in Dynamic Spectrum Access Networks, 2007, pp.
216–219.
[5] V. Turunen, M. Kosunen, A. Huttunen, S. Kallioinen, P. Ikonen, A. Pärssi-
nen, and J. Ryynänen, “Implementation of cyclostationary feature detector
for cognitive radios,” in Proc. Int. Conf. on Cognitive Radio Oriented
Wireless Networks and Communications, 2009, pp. 1–4.
[6] V. Turunen, M. Kosunen, M. Vääräkangas, and J. Ryynänen, “Correlation-
based detection of OFDM signals in the angular domain,” IEEE Trans.
Veh. Technol., vol. 61, no. 3, 2012.
[7] P. K. Meher, J. Valls, T.-B. Juang, K. Sridharan, and K. Maharatna, “50
years of CORDIC: Algorithms, architectures, and applications,” IEEE
Trans. Circuits Syst. I, vol. 56, pp. 1893–1907, Sept. 2009.
4
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

