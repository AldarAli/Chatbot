Iterative Decision Feedback Equalization for Filter Bank Multicarrier Systems
Zsolt Koll´ar and G´abor P´eceli
Department of Measurement and Information Systems
Budapest University of Technology and Economics
Budapest, Hungary
Email:{kollarzs,peceli}@mit.bme.hu
P´eter Horv´ath
Department of Broadband Infocommunications
and Electromagnetic Theory
Budapest University of Technology and Economics
Budapest, Hungary
Email: hp@mht.bme.hu
Abstract—Filter Bank Multicarrier (FBMC) systems are
a class of multicarrier modulation schemes for high speed
wireless communication. These systems are known for their
low adjacent channel leakage. In this paper we focus on the
problem of channel equalization for FBMC systems. Most
solutions in the literature use a per subcarrier equalization
suffering from an error ﬂoor at high signal-to-noise ratios
(SNR) caused by the residual inter-symbol-interference (ISI).
We investigate a simple per subcarrier channel equalization
method with ISI minimization and an averaging based ISI
cancelation technique. We also introduce an iterative decision
feedback scheme which outperforms the other known equal-
ization methods. The presented methods are validated using
simulation. The results are compared to the performance of
Orthogonal Frequency Division Multiplexing (OFDM) systems
with cyclic preﬁx (CP).
Keywords-FBMC; iterative; channel equalization; decision
feedback.
I. INTRODUCTION
The introduction of Cognitive Radio (CR) triggered a new
interest for researching alternatives of OFDM multicarrier
systems [1]. In this paper, we focus on the FBMC systems as
a major candidate competing with OFDM in CR scenarios.
OFDM is a widely adopted modulation scheme due to its
simple modulation/demodulation using IFFT/FFT block and
a channel equalization with low complexity. Despite its
many advantages it has some signiﬁcant drawbacks which
must be taken into consideration during the design.
These disadvantages include sensitivity to nonlinear dis-
tortions – due to the ﬂuctuations in the instantaneous am-
plitude of the transmitted signal – as well as sensitivity
to frequency offsets caused by local oscillator mismatch.
Another important aspect is its spectral properties, especially
the out of band radiation which is considered moderate in
case of OFDM, but in this respect FBMC has a much better
performance. The transmission data rate will be higher due
the fact that FBMC does not apply a CP. On the other
hand, the channel equalization is more complex compared
to OFDM due to the ISI caused by the multipath channel.
In this paper, we focus on channel equalization for FBMC
and OFDM systems. The basic problem of equalization for
FBMC systems is presented in [2] and [3].
IFFT
CP+
Constellation
mapping
xn
Xk
bits
sn
Figure 1.
Block diagram of the OFDM transmitter
The paper is structured as follows. In Section II the
OFDM and FBMC modulation schemes are described. In
Section III we present the baseband signal model. In Section
IV we introduce the channel equalization schemes that
we intend to analyze in four subsections: ﬁrst the basic
per subchannel Zero Forcing (ZF) and Minimum Mean
Square Error (MMSE), then the modiﬁed MMSE which
minimizes the ISI and the averaged MMSE technique. In
the last subsection, we present a new decision feedback
equalization technique. In Section V we verify the channel
equalization techniques for FBMC systems via bit error rate
simulations and we assess their performance by comparing
them to OFDM employing MMSE equalization. Finally, the
conclusion is drawn.
II. OFDM AND FBMC MODULATION SCHEME
A. OFDM
In this section, we give only a short description of the
OFDM modulation scheme. A general block diagram of
an OFDM system can be seen in Fig. 1. First the bits
are mapped to constellation symbols X. The time domain
samples of an OFDM symbol are generated using IFFT as
xn =
N−1
∑
k=0
Xke
2π
N nk,
n = 0 . . . N − 1,
(1)
where Xk is the complex modulation value for the kth
subcarrier. The CP is added to the OFDM symbol to form
the transmitted signal sn.
B. FBMC
FBMC systems are derived from the orthogonal lapped
transforms [4] and ﬁlter bank theory [5]. The block diagram
of one possible implementation of an FBMC transmitter can
be seen in Fig. 2. Similar to OFDM the bits are ﬁrst mapped
to symbols X drawn from a complex constellation. Then the
31
COCORA 2011 : The First International Conference on Advances in Cognitive Radio
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-131-1

Synthesis Filter
banks
Cosine filter
bank
Sine filter
bank
N/2
Delay
Constellation Xk
mapping
bits
sn
0
1
2
-1
-2
Cosine filter bank
Sine filter bank
Sub-band k:
-N/2
N/2
...
...
Real(Xk)
Imag(Xk)
xn
xn
c
s
Figure 2.
Block diagram of the FBMC transmitter, with the spectral
structure of the cosine and sine ﬁlterbanks
real parts are modulated by a cosine ﬁlter bank where only
the even-index subbands are used and the imaginary parts are
modulated by a sine ﬁlter bank where only the odd-index
subbands are modulated. An offset of half of the symbol
overlapping N/2 duration is applied to the output of the
sine ﬁlter bank – similarly to the offset quadrature amplitude
modulation technique. The basic structure of the ﬁlter banks
can be also seen in Fig. 3. First the frequency domain data
is spread over M subcarriers forming a subband, then it is
ﬁltered by a prototype ﬁlter of the kth subband Fk(z) which
is designed so that it fulﬁls the Nyquist criterion. In FBMC
applications these ﬁlter bank structures are implemented in
a computationally efﬁcient manner using an N-IDFT and
a polyphase network [5]. The ﬁlter bank yields symbols
that span N ∗ M samples each. In order not to lose data
rate they will overlap bya factor M – due to the Nyquist
criteria, the symbols can be separated in the receiver and a
perfect reconstruction is possible –. For example if M = 4
then 4 FBMC symbols overlap. This can be seen in Fig.
4 where the signal structure of FBMC is compared to the
signal structure of the OFDM signal. The FBMC signal is
given for an overlapping/oversampling factor of M = 4.
The resulting transmitted signal is the sum of overlapping
FBMC symbols generated by the ﬁlter banks.
III. BASEBAND TRANSCEIVER CHAIN
The applied baseband model for the transceiver chain can
be seen in Fig. 5. The discrete received signal rn can be
expressed as
rn = xn ∗ hn + wn,
(2)
where xn, hn and wn are the samples of the transmit-
ted signal, channel impulse response and AWGN noise
respectively. We will use this model when dealing with the
equalization algorithms, where the samples of the channel
M-spread
M-spread
M-spread
F0(z)
F1(z)
FN-1(z)
xn
XN-1
X2
X1
Figure 3.
Basic structure of the ﬁlter bank with an oversampling ratio of
M.
Channel
Channel filter
hn
Receiver
Transmitter
wn
sn
rn
Figure 5.
Model of the baseband transceiver chain.
impulse response are Rayleigh distributed, and the following
expression is valid
L−1
∑
n=0
|hn|2 = 1.
(3)
where L is the length of the channel impulse response. In
case of OFDM systems, if the CP is longer than the channel
impulse response (2), after removing the cyclic preﬁx we
can write for an OFDM symbol
Yk = XkHk + Wk,
k = 0 . . . N − 1,
(4)
where Yk is the N-FFT of rn, belonging to one OFDM
symbol. Xk, Hk and Wk are also an N-FFT of the signal xn,
hn and wn respectively. For FBMC systems the frequency
domain description is more complicated due to ISI from
the neighboring symbols. One of the implications of this
ISI is that FBMC systems will require different equalization
strategies.
IV. CHANNEL EQUALIZATION
A. ZF and MMSE
Zero forcing is known to be the simplest method for
channel equalization in the frequency domain. We simply
assume that the received noise is zero in equation (4), so the
transmitted complex constellation value on the kth subcarrier
can be simply calculated as
ˆXZF
k
= Yk
Hk
.
(5)
The MMSE technique gives a better result if we also take the
information about the AWNG noise also into account. The
problem of ZF occurs if Hk is small, the noise values will be
32
COCORA 2011 : The First International Conference on Advances in Cognitive Radio
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-131-1

FBMC symbol i-3 (Cosine filter bank)
FBMC symbol i-2 (Cosine filter bank)
FBMC symbol i-1 (Cosine filter bank)
FBMC symbol i (Cosine filter bank)
FBMC symbol i-3 (Sine filter bank)
FBMC symbol i-2 (Sine filter bank)
FBMC symbol i-1 (Sine filter bank)
FBMC symbol i (Sine filter bank)
N*M
N
N
N
N
N/2
N
N
N
Resulting transmittedFBMC signal
SUM
a,OFDM
b,FBMC
FBMC symbol i+1 (Cosine filter bank)
N
FBMC symbol i+1 (Sine filter bank)
N
FBMC symbol i+2 (Cosine filter bank)
N
FBMC symbol i+3 (Cosine filter bank)
N
FBMC symbol i+2 (Sine filter bank)
N
FBMC symbol i+3 (Sine filter bank)
N
OFDM
CP symbol i-3
OFDM
CP symbol i-2
OFDM
symbol i
CP
OFDM
symbol i+1
CP
P
N
P
N
P
N
P
N
OFDM
symbol i+2
CP
P
N
OFDM
symbol i+3
CP
P
N
Figure 4.
The structure of the transmitted (a) OFDM signal (with a symbol length N and a CP with a length P samples) and the (b) FBMC signal with
an overlapping radio of M = 4.
also ampliﬁed. The equalization coefﬁcient HMMSE
k
=
1
Ck
for the kth subcarrier is calculated through the minimization
the following expression:
min
Ck E
{N−1
∑
k=0
|XkHk − CkYk|2
}
,
(6)
where E{.} donates the expected value of the argument.
Using equation (4) the resulting channel compensation value
for the kth subcarrier is calculated according to [6] as
Ck =
1
HMMSE
k
=
H∗
k
|Hk|2 + N0
Es
,
(7)
where N0 is the noise power and Es is the signal power. It
can be seen that with small N0
Es values the MMSE solution
is equal to the ZF. In case of FMBC and per-subcarrier
equalization, (7) has to be modiﬁed in order to consider
the ISI stemming for adjacent symbols similar to [7][8][9]
as
1
ˆHMMSE
k
=
H∗
k
|Hk|2 + N0+I
Es−I
(8)
where I is the power of the ISI, for which we present the
following equation
I = Es
L−1
∑
n=0
n
N |hn|2.
(9)
Finally, the MMSE estimate results in
ˆXMMSE
k
=
Yk
ˆHMMSE
k
.
(10)
B. Modiﬁed MMSE I.
Observing (9) more closely, we have also concluded that
the ISI can be minimized by moving the observation window
along all possible positions of the channel impulse response
to minimize the following equation
min
∆n {I(∆n)} =
min
∆n
{
Es
L−1
∑
n=0
|n−∆n|
N
|h|n−∆n||2
}
, (11)
∆n = 0 . . . L − 1,
After ﬁnding the sample value ∆n which minimizes equa-
tion (11), the observation window – where we perform the
channel equalization – has to be moved by ∆n samples
and also the channel impulse response has to be circularly
shifted, respectively as
ˆXMIN
k
=
Yk(∆nmin)
ˆHMMSE
k
(∆nmin)
.
(12)
C. Modiﬁed MMSE II.
To further minimize the ISI we introduce the idea of
the Averaged MMSE equalizer. The averaged MMSE is
driven by the idea that the ISI can be also considered as
33
COCORA 2011 : The First International Conference on Advances in Cognitive Radio
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-131-1

a noise, which can be eliminated by averaging. So based
on the idea of moving the observation window, we perform
the demodulation and MMSE equalization for each ∆n
positions of the possible L observation windows and then
we average all complex modulation values belonging to the
same subband
ˆXAVG
k
= 1
L
L−1
∑
∆n=0
ˆXMMSE
k
(∆n) = 1
L
L−1
∑
∆n=0
Yk(∆n)
ˆHMMSE
k
(∆n)
(13)
With this calculation we can minimize the ISI.
D. Iterative decision feedback equalization
In this section we will introduce a novel iterative decision
feedback scheme where the most reliable decision values
are fed back after the decision to minimize the ISI in the
received signal. This decision feedback scheme is shown in
Fig. 6. The basic idea is to regenerate the transmitted signal,
but only the subbands which are reliable, and ﬁlter it with the
known channel ﬁlter. The idea is visualized in Fig. 4: If we
want to make a decision for the shaded ith FBMC symbol
of the cosine ﬁlter bank, then we reconstruct as much as
possible from the surrounding symbols i − 3, i − 2 . . . i + 3
which overlap with it (both sine and cosine) based on
the selection criteria. Then, during the decision on the ith
FBMC symbol the ISI of the known neighboring symbols
can be subtracted, reducing the noise stemming from the
ISI, leading to better performance. The selection criteria
is deﬁned based on the constellation diagram, we take
conﬁdence interval around each constellation point. The
complex modulation symbols which fall inside this interval
are considered as reliable. During the iteration process the
interval can be enlarged as the ISI is minimized.
V. SIMULATION RESULTS
To verify the previously described equalization schemes,
simulations were performed. The simulation parameters for
both OFDM and FBMC system are summarized in Table I.
In order to enable a proper comparison of the two different
modulation schemes the SNR is deﬁned as
SNRdB =
10 log10
(
Es
N0
)
(14)
=
10 log10
(
EbNcD
(N+P )N0
)
,
(15)
where Eb is the bit energy, N is the number of the
subcarriers/subbands available and Nc is the number of
subcarriers/subbands used. P is the length of the CP and D
is the number of bits transmitted by one subcarrier/subband.
During the simulations we have averaged the results of 10
channel realizations.
The simulated bit error rate (BER) for the proposed 3
MMSE equalization schemes can be seen in Fig. 7. For
comparison we have also plotted the results for the AWGN
channel without multipath propagation. For low SNR values
0
5
10
15
20
25
30
10
−3
10
−2
10
−1
Eb/N0 [dB]
BER
 
 
OFDM − AWGN
FBMC − AWGN
OFDM − MMSE
FBMC − MMSE
FBMC − Min. MMSE
FBMC − Avg. MMSE
Figure 7.
Bit error rate in function of SNR for the three MMSE-FBMC
equalization schemes.
Table I
SIMULATION PARAMETERS FOR OFDM AND FMBC SYSTEM
Parameter
OFDM
FBMC
CP
16
-
N
64
64
M
1
4
Modulation
16-QAM
16-QAM
(D)
(4)
(4)
Modulated subcarrier/subbands
48
48
Channel length L
16
16
the FBMC system has a very small gain over OFDM
system in the BER results. It can be observed that OFDM
outperforms FBMC at higher SNR value (SNR > 12 dB)
the FBMC system when only an MMSE equalizer is applied.
When introducing the minimized MMSE and the averaged
MMSE, a small performance gain becomes apparent for
large SNR values in favour of FBMC. This small difference
will be crucial for the iterative decision feedback technique.
These bit error rates can be considered as the starting values
for the iterative algorithm.
The BER results for the iterative decision feedback tech-
nique is depicted in Fig. 8. The BER results for the 5.
iteration step is plotted together with the initial starting
values for the inital iteration. It can be observed that the
averaged MMSE performs the best, the minimized MMSE
has a similar result and ﬁnally the original MMSE has the
worst BER.
VI. CONCLUSION
In this paper, we have investigated channel equalization
schemes for FBMC system which were compared to the
result of CP-OFDM system using MMSE equalization. First,
modiﬁcations of the MMSE equalization technique suited for
FBMC distorted by ISI were presented and the results were
veriﬁed via simulation. We have also presented a decision
34
COCORA 2011 : The First International Conference on Advances in Cognitive Radio
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-131-1

FBMC receiver
Decision feedback
Synthesis Filter
banks
Analysis Filter
banks
Sine filter
bank
N/2
Delay
Cosine filter
bank
Constellation
demapping
Selection
criteria
Cosine filter
bank
Sine filter
bank
N/2
Delay
Real(Yk)
Imag(Yk)
bits
rn
Real(X')
Imag(X')
Channel
equalization
k
k
-
Channel filter
hn
-
Figure 6.
Model of the FBMC receiver with decision feedback loop.
0
5
10
15
20
25
30
10
−3
10
−2
10
−1
Eb/N0 [dB]
BER
 
 
OFDM − AWGN
FBMC − AWGN
OFDM − MMSE
FBMC − MMSE
FBMC − Min. MMSE
FBMC − Avg. MMSE
FBMC − MMSE it. 5
FBMC − Min. MMSE it. 5
FBMC − Avg. MMSE it. 5
Figure 8.
Bit error rate in function of SNR for the three MMSE-FBMC
equalization schemes with decision feedback.
feedback scheme, which has a much better performance
compared to the simple MMSE methods. The results show
that FBMC is a very good candidate for competing with
OFDM systems over multipath channels. The criteria for
selecting the conﬁdence interval around the constellation
points requires further investigation, but the simulation pro-
vide promising results.
ACKNOWLEDGMENT
The research leading to these results was derived from
the European Community’s Seventh Framework Programme
(PF7) under Grant Agreement number 248454 (QoSMOS).
REFERENCES
[1] Zs. Koll´ar and P. Horv´ath, “Modulation schemes for cognitive
radio in white spaces,” Radioengineering, vol. 19, no. 4, pp.
511–517, Dec. 2010.
[2] M. Renfors, H. Xing, A. Viholainen, and J. Rinne, “On channel
equalization in ﬁlter bank based multicarrier wireless access
systems,” in Vehicular Technology Conference, 1999. VTC
1999 - Fall. IEEE VTS 50th, vol. 1, Sep. 1999, pp. 228–232.
[3] A. Viholainen, J. Alhava, J. Helenius, and J. Rinne, “Equal-
ization in ﬁlter bank based multicarrier systems,” IEEE Int.
Conference on Electronics, Circuits and Systems, Sep. 1999.
[4] H. S. Malvar, “Extended lapped transforms: Properties, appli-
cations, and fast algorithms,” IEEE Trans. on signal processing,
vol. 40, no. 11, pp. 2703–2714, Nov. 1992.
[5] P. P. Vaidyanathan, Multirate systems and ﬁlter banks.
Prentice-Hall Inc., 1993.
[6] J. van de Beek, . Edfors, M. Sandell, S. Wilson, and P. Borjes-
son, “On channel estimation in OFDM systems,” Proc. IEEE
Veh. Technol. Conf., vol. 2, pp. 815–819, Jul. 1995.
[7] T. Ihalainen, T. H. Stitz, and M. Renfors, “Efﬁcient per-carrier
channel equalizer for ﬁlter bank based multicarrier systems,”
in Proceedings of IEEE International Symposium on Circuits
and Systems (ISCAS ’05), May 2005, pp. 3175–3178.
[8] T. Ihalainen, T. H. Stitz, M. Rinne, and M. Renfors, “Channel
equalization in ﬁlter bank based multicarrier modulation for
wireless communications,” EURASIP Journal Appl. Signal
Process., Jan 2007.
[9] A.Ikhlef and J. Louveaux, “Per subchannel equalization for
MIMO FBMC/OQAM systems,” Proc. of the conference IEEE
PACRIM09, Aug. 2009.
35
COCORA 2011 : The First International Conference on Advances in Cognitive Radio
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-131-1

