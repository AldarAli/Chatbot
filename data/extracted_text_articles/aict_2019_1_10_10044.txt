A Novel Synchronization Algorithm for Hybrid Inter-Satellite Link Establishment 
 
Alexandru Crisan, Cristian Anghel, Remus Cacoveanu  
Telecommunications Department 
University Politehnica of Bucharest 
Bucharest, Romania 
e-mail: alexandru.crisan@ceospacetech.pub.ro; cristian.anghel@upb.ro; remus.cacoveanu@upb.ro 
 
 
Abstract—This 
paper 
presents 
a 
new 
synchronization 
algorithm proposed to establish an inter-satellite link in a 
system with two satellites flying in tandem. The complete 
system is described, including both the master and the 
companion satellite. The proposed physical layer is a 
customization of the one from Long Term Evolution (LTE) 
telecommunications systems, based 
on the 
Orthogonal 
Frequency Division Multiplexing (OFDM) technology with 
Time Division Duplexing (TDD) approach. The proposed 
synchronization algorithm uses two preamble-symbols per 
radio frame. Simulation results for different frequency 
deviations are provided. 
Keywords-synchronization; OFDM; preamble; frequency 
offset; inter-satellite link. 
I. 
 INTRODUCTION  
When it comes to data relay satellites or constellation and 
formation flying missions, the Inter-Satellite Link (ISL) is a 
topic that has been intensively discussed [1]. The ISL is 
needed not only to support the communication function, but 
also to enable the formation acquisition and formation 
control through precise relative positioning using inter-
satellite metrology consisting in ranging and Line of Sight 
(LoS) determination. Having to fulfill the complex 
requirements of both the selected communication system and 
the navigation module, the ISL is the key in finding the 
tradeoff between ensuring the data bandwidth and the data 
transfer quality on the communication path, and providing 
the accurate measurements and inputs for the navigation 
algorithms. 
The Hybrid Inter-Satellite Link (H-ISL) is the new 
terminology used for a system which shall be able to ensure 
relative navigation (range and LoS estimation) between two 
spacecraft flying in formation, and also data exchange using 
the communication link. Thus, the H-ISL system architecture 
involves two spacecraft, namely the master satellite and the 
companion satellite. Both the quality of the link, measured as 
Bit Error Rate (BER), and the accuracy of the Navigation 
(NAV) 
commends 
are 
highly 
dependent 
on 
the 
synchronization algorithm results in terms of frequency 
alignment (for the two clock references used on the two 
satellites) and time synchronization (the correct radio frame 
start shall be identified by the receiver). On the other hand, 
the total cost of the system, the power consumption and the 
physical dimensions are to be considered as well.  
Synchronization techniques for Orthogonal Frequency 
Division Multiplexing (OFDM) waveforms are based on 
either received signal autocorrelation or cross-correlation of 
a training symbol with a local replica. The autocorrelation is 
robust to large carrier frequency offsets (CFO) and exploits 
some form of redundancy built in the transmitted signal, for 
example the cyclic prefix (CP) [2] or a training symbol with 
two identical halves [3]. The main disadvantage of 
autocorrelation is that timing synchronization is only coarse 
and a fine-timing estimation stage is also required. On the 
other hand, cross-correlation techniques [4] provide accurate 
timing, but are very sensitive to large CFO values. Thus, the 
common approach is to have a coarse estimation stage for 
timing and fractional CFO, followed by a fine estimation 
stage for timing and integer frequency offset (IFO). Based on 
this approach, a two-stage synchronization algorithm is 
presented in [5]. Synchronization for downlink (DL) Long 
Term Evolution (LTE) is proposed in [6]. Coarse timing and 
fractional CFO is estimated using the CP technique, then fine 
timing consists in identifying the specific synchronization 
signals and a frequency-domain estimation of the IFO. The 
residual offset is also tracked. The method developed in [7] 
exploits the properties of 
constant amplitude zero 
autocorrelation sequences to achieve synchronization. In [8] 
a cross-correlation based joint timing and frequency 
synchronization scheme based on Zadoff-Chu (ZC) 
sequences is presented. The technique also uses a two-stage 
approach and optimizes the ZC sequence parameter selection 
based on the shift of the cross-correlation peak to allow for 
coarse timing and CFO estimation. 
In this context, a novel synchronization algorithm for H-
ISL scenario has been proposed. It is based on the one used 
in the LTE communications systems, with customizations 
specific to spatial radio link. Our approach has the advantage 
of achieving fine timing synchronization without the need for 
a coarse stage and frequency-domain IFO estimation is not 
required. 
The rest of this paper is organized as follows. Section II 
provides the system description, with both the digital part 
(including the 3 main modules MAC, PHY and NAV) and 
the analog part (RF daughter board plus additional analog 
circuits). Section III describes the proposed synchronization 
algorithm, highlighting the changes made compared with the 
one used in the LTE communication systems. Section IV 
provides the obtained results, exemplifying the time 
alignment and the frequency corrections generated by the 
1
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-727-6
AICT 2019 : The Fifteenth Advanced International Conference on Telecommunications

algorithm in real-life conditions. The acknowledgement and 
conclusions close the article. 
II. 
SYSTEM DESCRIPTION 
A. The hardware platform selection 
The NAV requirements in terms of information input and 
resolution set mainly the system architecture. The master 
satellite, the one on which the NAV algorithm runs, has 3 
antennas, placed in a square triangle pattern, with the master 
antenna corresponding to the intersection of the catetes. This 
solution with 3 antennas allows the master satellite to 
compute the LoS, i.e., the vector from the companion 
spacecraft transmitter to the master spacecraft receiver. The 
navigation module takes into account measurements coming 
from the triplet of antennas. The 3 antennas create 2 
perpendicular antenna baselines and provide path differences 
measurements on the two baselines. For navigation purposes 
H-ISL shall use two frequency bands, 100-200 MHz apart. 
The two frequencies allocated for navigation purposes are 
used as carrier frequencies for data communication as well. 
In this context, the hardware platform selection is 
restricted by these constraints and requirements. Several 
solutions were studied, the final decision being based on a 
Xilinx ZCU102 board [9] for the digital part, called 
motherboard, and Analog Devices FMComms5 [10] for the 
RF part, named daughter board.  
The digital part includes the Zynq UltraScale XCZU9EG 
[11] SoC, which contains a Quad-Core ARM Cortex A-53 
for the Application Processor Unit (APU), a Dual-Core 
ARM Cortex R5 for the Real Time Processor Unit (RTPU), 
and a Xilinx's 16nm FinFET+ programmable logic fabric 
(specific to Xilinx 7 families). 
PHY
MEM
ARM Cortex
A53
MAC
ARM Cortex
A53
NAV
PS
PL
ZCU9EG
AD-FMComms5 (2xAD9361)
FMC1 (P401)
FMC2 (P402)
J301
REF_CLK
HPC0 (J5)
HPC1 (J4)
J79
PC
ETH
Tx_F1
Tx_F2
LNA
BPF
RxA0_F1
RxA0_F2
LNA
BPF
RxA1&2_F1
RxA1&2_F2
Tx_Rx_sw
Ant_sel_sw
J112
J212
J110
J210
J111
J211
A0
A1
A2
BPF
PA
 
Figure 1.  Block scheme of the master satellite. 
Tx_F1
Tx_F2
LNA
BPF
RxA0_F1
RxA0_F2
Tx_Rx_sw
J112 J212
J110 J210
A0
BPF
PA
PHY
MEM
ARM Cortex
A53
MAC
ARM Cortex
A53
NAV
PS
PL
ZCU9EG
AD-FMComms5 (2xAD9361)
FMC1 (P401)
FMC2 (P402)
J301
CLK
HPC0 (J5)
HPC1 (J4)
J79
PC
ETH
 
Figure 2.  Block scheme of the companion satellite. 
This internal structure allows the MAC and NAV 
modules to run on Processing System (PS), while the PHY 
is implemented on (Programmable Logic) PL side. The 
connections between PS and PL is made via AXI interfaces 
[12], using shared RAMs.  
The RF part includes two AD9361 devices [13], each of 
them supporting 2 × 2 RF transceivers with integrated 12-bit 
DACs and ADCs. 
The connection between the motherboard and the 
daughter board is made via two FPGA Mezzanine Cards 
(FMCs) connectors, as depicted in Figure 1 for the master 
satellite, respectively Figure 2 for the companion satellite. 
Additionally, in the two above-mentioned figures, one can 
observe also the extra analog circuitry needed to support the 
co-existing of the two used frequencies and the duplexing 
technique. 
 
B. The PHY parameters 
In order to clearly describe the proposed synchronization 
algorithm, the PHY parameters should be first presented. 
The starting point for their values selection was the LTE 
standard. We consider a TDD duplexing, with radio frames 
of 10 ms, the DL and uplink (UL) parts being balanced 1:1. 
The OFDM technology is used, with 1024 sub-carriers 
spaced at 15 kHz for a channel of 10 MHz.  
Normal CP of 72 samples is added to each OFDM symbol 
of 1024 samples. The resulted sampling frequency is 15.36 
MHz. The maximum throughput computation can be done 
having in mind that the two OFDM symbols on each DL/UL 
sub-frame are allocated to the preambles used by the 
synchronization  algorithm. The  1096 samples-long  OFDM  
2
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-727-6
AICT 2019 : The Fifteenth Advanced International Conference on Telecommunications

UL
Rx_UL
FRAME #n
FRAME #n+1
10 ms
MASTER
COMPANION
10 ms
Tx_DL
Rx_DL
Tx_UL
Tx_DL
Rx_DL
UL
Rx_UL
FRAME #n
FRAME #n+1
10 ms
MASTER
COMPANION
10 ms
Rx_DL
Tx_DL
Tx_UL
Rx_DL
Tx_DL
 
Figure 3.  Frame structure for a) short distance between the satelites b) 
long distance between the satelites 
symbol (including the CP) lasts 71.3 us at the indicated 
sampling frequency, this leading to a targeted number of 64 
OFDM symbols per DL/UL. In conclusion, excluding the 
two symbols for synchronization, a maximum DL/UL 
throughput of around 2 Mbps can be achieved when BPSK 
modulation is used, with a channel coding rate of 1/3. The 
rest of a radio frame is split between the Transmit Time Gap 
(TTG) and the Receive Time Gap (RTG). Figure 3 depicts 
the timing expected when the two limit scenarios are 
considered, i.e, the two satellites being very close to each 
other, respectively very far. 
III. 
PROPOSED SYNCHRONIZATION ALGORITHM 
The first step in establishing the ISL consists in time and 
frequency synchronization at the companion satellite. Time 
synchronization is necessary in order to ensure that the 
receiver window encompasses the entire DL sub-frame and 
to identify the boundaries of the received OFDM symbols. 
Frequency synchronization must be performed to eliminate 
the inter-carrier interference and to prevent loss of sub-
carrier orthogonality.  
In an Additive White Gaussian Noise (AWGN) channel, 
the baseband signal received by the companion can be 
expressed as [2]: 
 
2
0
[ ]
[
]
[ ]
c
s
f
j
n F
y n
x n n e
w n





 
(1) 
 
where [ ]
x n is the transmitted DL preamble symbol, 
0n is the 
timing offset in samples, 
cf
 is the CFO, 
sF is the sampling 
frequency and [ ]
w n is the AWGN. The training symbol is 
BPSK-modulated in frequency domain and is constructed as 
an extension of the Secondary Synchronization Signal (SSS) 
in LTE.  
Firstly, the timing offset must be estimated so that the 
receiver window can be positioned correctly. To achieve 
this, the received signal is cross-correlated with a local, 
time-synchronized replica of the training symbol: 
 
 
1
*
0
[ ]
[ ] [
]
N
n
R m
x n y m n





 
(2) 
 
where N is the Fast Fourier Transform (FFT). The timing 
offset can by finding the peak of 
[ ]
R m : 
 
n0 arg max{ [ ]}
R m

 
(3) 
 
In practical systems, 
[ ]
R m is normalized with a factor 
that depends on the energy of the received signal. Although 
the cross-correlation provides very accurate timing, it is 
very sensitive to CFO. For CFO values that are close to or 
exceed the sub-carrier spacing (15 kHz for LTE signals), the 
cross-correlation peak can no longer be identified. 
In order to overcome this effect, our novel approach 
consists in performing the cross-correlation between 
[ ]
y n and a set of training symbols that incorporate certain 
CFO values untill the cross-correlation peak exceeds a 
preset threshold. More specifically, at the companion we 
store seven versions of the training symbol with the 
following CFOs: 0, ±5, ±10 and ±15 kHz. Moreover, in 
order to allow for faster computation, the received signal is 
split into batches of equal length and the cross-correlation 
theorem is exploited: the spectrum of the batch is multiplied 
with the spectrum of the complex-conjugated training 
symbol on a point-to-point basis and then the inverse FFT 
(IFFT)  is computed to obtain the time-domain values. 
Our approach ensures fine timing sychronization and 
allows for joint coarse CFO estimation. The coarse CFO is 
used to adjust the reference frequency source of the 
companion satellite. Since there are actually two training 
symbols in the preamble, the cross-correlation will yield two 
peaks at 
0n and 
1n .  
Once timing synchronization has been achieved and the 
reference frequency has been coarsely adjusted, the 
remaining, uncorrected frequency offset is estimated using 
the redundancy of the two training symbols. Let 
 cf r
be the 
uncorrected offset. The received training symbols in the 
preamble can be expressed as: 
 
 
2
[
(
1)(
)]
[ ]
[ ]
[ ]
r
c
cp
s
f
j
n
l
N N
F
l
l
y n
x n e
w n
 
 



 
(4) 
 
where 
1,2
l
is the symbol index and 
Ncp
is the CP length. 
 cf r
can be estimated as follows: 
 
 
1
*
1
2
0
[ ]
[ ]
2 (
)
N
r
s
c
n
cp
F
f
angle
y n y n
N N













 
(5) 
 
Considering 
the 
approach 
presented 
above, 
the 
synchronization steps are detailed in the following 
paragraphs. 
Since the DL preamble is transmitted every radio frame, 
at the companion 10 ms worth of samples must be 
processed. This amounts to 153600 samples. The received 
samples are split into batches of equal length with a 50% 
3
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-727-6
AICT 2019 : The Fifteenth Advanced International Conference on Telecommunications

overlap between adjacent batches. The data is processed as 
follows: 
Step 1: Set the training symbol CFO index i=0 
(corresponding to a training symbol with 0 CFO). 
Step 2: The energy of each batch is computed. Store the 
minimum energy value (corresponding to noise) in 
bmin
and 
the maximum energy value (corresponding to noise+useful 
signal) in 
bmax
. If the ratio 
max
/ min
1.5
b
b

, then the preamble 
is located in the set of the 153600 samples. Proceed to step 
3.  
If the energy threshold is not met, the current radio frame is 
discarded. A new set of 153600 samples is recorded and 
step 2 is repeated. 
Step 3: Calculate the normalization factor as a weighted 
difference between 
bmax
 and 
bmin
 : 
 
 


max
min
x
L
b
b
b



 
(6) 
 
where 
xb is the energy of the reference training symbol [ ]
x n . 
L is designed such that after normalization, the amplitude of 
the cross-correlation peak varies only with the CFO. 
Step 4:The cross-correlation between each batch and 
[ ]
ix n
is calculated (by applying the cross-correlation 
theorem). 
Step 5: Find the peak value for each batch and apply the 
normalization L. If the normalized peak exceeds the fixed 
threshold 
xc
p , then store the peak index. 
Step 6: If no peaks are identified, increment i and repeat the 
process starting with step 4. If two peaks have been 
identified, then adjust the receiver window with the 
following correction value 
rc : 
 
 
0
1
3
2
2
cp
r
n
n
N
N
c
round
  








 
(7) 
 
The correction 
rc is designed such that the receiver window 
converges towards correct positioning (
rc =0) over the 
course of a few iterations. 
Step 7: Correct the coarse CFO depending on the current 
value of i. Proceed to step 8.  
Step 8: Estimate the uncorrected CFO 
 cf r
with (5). 
By strategic selection of 
xc
p it can be ensured that: 
- 
The peaks are always identified before exhausting 
the set of stored training symbols; 
- 
No undesired peaks (not related to the training 
symbols) are obtained; 
- 
 cf r
is limited to ±5 kHz. 
Once timing synchronization and coarse CFO correction 
has been achieved, then the values of 
rc and i should be 0. 
 cf r
is estimated on every received preamble and the 
reference frequency is readjusted periodically. 
Timing resynchronization is necessary due to oscillator 
drifts and variations in distance between the satellites or if 
the ISL is lost. In normal functioning conditions, since the 
reference frequency is adjusted periodically, only the 
distance variations would cause significant loss of timing. 
Considering an inter-satellite relative speed of 1 m/s, at the 
sampling rate of 15.36 MHz a timing error of one sample 
would occur approximately every 19.53 seconds. In order to 
compensate this effect, timing resynchronization is carried 
out once every 10 seconds or immediately after the radio 
link is interrupted. 
 
 
IV. 
OBTAINED RESULTS 
Our first set of results is focused on the effect that the 
proposed normalization coefficient L has on the amplitude of 
the cross-correlation peak. To this end, the CFO is set to 0 
and the Signal to Noise Ratio (SNR) is varied from 0 to 30 
dB. The results, plotted in Figure 4, illustrate that the 
normalized amplitude of the peak is relatively constant 
across a wide range of SNR values. Therefore, the use of a 
fixed threshold
xc
p regardless of operating SNR is justified. 
The second set of results is focused on the performances of 
the synchronization algorithm. The CFO is set to 18 kHz, the 
threshold
xc
p is 0.8 and a delay of 1500 samples is added to 
the transmitted preamble. Table I shows the effect of 
adjusting the receiver window; over 3 iterations the 
correction value 
rc
converges towards 0 and timing 
synchronization is achieved. 
 
 
 
Figure 4.  Variation of the normalized peak amplitude vs. SNR 
 
Figure 5.  RMSE of CFO estimations vs. SNR in AWGN channel 
TABLE I.  
ADJUSTING THE RECEIVER WINDOW 
Iteration 
1 
2 
3 
rc  
1226 
2394 
0 
 
 
4
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-727-6
AICT 2019 : The Fifteenth Advanced International Conference on Telecommunications

Figure 5 shows the root-mean-square error (RMSE) of 
the CFO estimations against SNR in an AWGN channel. At 
0 dB, the accuracy is approximately 84 Hz. 
 
V. 
CONCLUSIONS 
This paper presented a novel synchronization algorithm 
proposed to be used in an H-ISL system. The starting point is 
the model used in the LTE communication systems. The new 
preamble structure and its positioning in the DL sub-frame, 
correlated with the new proposed method of computation, 
provide good results in terms of timing alignment and 
frequency synchronization. The presented simulation results 
demonstrate the algorithm performance.  
A real test-bench is under preparation and several real 
test-cases will be executed on the presented setup. The 
obtained results will be presented in future work. 
ACKNOWLEDGMENT 
The work has been funded by the European Space 
Agency through the contract “Hybrid - Inter Satellite Link” 
with the number 4000121222/17/NL/CBi, subcontracted by 
UPB through the contract 18/05.10.2017. 
REFERENCES 
 
[1] R. Sun, D. Maessen, J. Guo, and E. Gill, “Enabling Inter-
Satellite Communication and Ranging for Small Satellites”, 
Small Satellite Systems and Services Symposium (4S), 
Funchal, Portugal, pp 1 – 15, 31 May – 4 June 2010 
[2] J. J. van de Beek, M. Sandell and P. O. Borjesson, “ML 
estimation of time and frequency offset in OFDM systems,” 
in IEEE Transactions on Signal Processing, vol. 45, no. 7, pp. 
1800 - 1805, July 1997. 
[3] T. M. Schmidl and D. C. Cox, “Robust frequency and timing 
synchronization for OFDM,” in IEEE Transactions on 
Communications, vol. 45, no. 12, pp. 1613-1621, Dec. 1997. 
[4] C. Wang and H. Wang, “Optimized Joint Fine Timing 
Synchronization 
and 
Channel 
Estimation 
for 
MIMO 
Systems,” in IEEE Transactions on Communications, vol. 59, 
no. 4, pp. 1089-1098, April 2011. 
[5] H. Minn, V. K. Bhargava and K. B. Letaief, “A robust timing 
and frequency synchronization for OFDM systems,” in IEEE 
Transactions on Wireless Communications, vol. 2, no. 4, pp. 
822-839, July 2003. 
[6] Q. Wang, C. Mehlfuhrer, and M. Rupp, “Carrier frequency 
synchronization in the downlink of 3GPP LTE,” 21st Annual 
IEEE International Symposium on Personal, Indoor and 
Mobile Radio Communications, Instanbul, pp. 939-944, 2010. 
[7] J. Meng and G. Kang, “A novel OFDM synchronization 
algorithm based on CAZAC sequence,” 2010 International 
Conference on Computer Application and System Modeling 
(ICCASM 2010), Taiyuan, 2010, pp. V14-634-V14-637. 
[8] M. M. U. Gul, X. Ma and S. Lee, “Timing and Frequency 
Synchronization for OFDM Downlink Transmissions Using 
Zadoff-Chu Sequences,” in IEEE Transactions on Wireless 
Communications, vol. 14, no. 3, pp. 1716-1729, March 2015. 
[9] https://www.xilinx.com/products/boards-and-kits/ek-u1-
zcu102-g.html, retrieved: June, 2019 
[10] https://www.analog.com/en/design-center/evaluation-
hardware-and-software/evaluation-boards-kits/eval-ad-
fmcomms5-ebz.html, retrieved: June, 2019 
[11] https://www.xilinx.com/support/documentation/selection-
guides/zynq-ultrascale-plus-product-selection-guide.pdf, 
retrieved: June, 2019 
[12] https://www.xilinx.com/products/intellectual-
property/axi.html, retrieved: June, 2019 
[13] https://www.analog.com/en/products/ad9361.html,  
retrieved: June, 2019
 
5
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-727-6
AICT 2019 : The Fifteenth Advanced International Conference on Telecommunications

