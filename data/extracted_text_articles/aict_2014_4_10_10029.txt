A Bluetooth Network Dynamic Graph
Celio Marcio Soares Ferreira,
Ricardo Augusto R. Oliveira,
Haroldo Santos Gambini
Computer Science Department
Federal University of Ouro Preto (UFOP)
Ouro Preto, Minas Gerais, Brasil
e-mail: celio@linuxplace.com.br,
{rrabelo, haroldo.santos}@gmail.com
Alejandro C. Frery
Instituto de Computac¸˜ao
Universidade Federal de Alagoas (UFAL)
Macei´o, AL, Brasil
e-mail: acfrery@gmail.com
Saul Delabrida,
Mateus Freire Carneiro
Computer Science Department
Federal University of Ouro Preto (UFOP)
Ouro Preto, Minas Gerais, Brasil
e-mail: saul@sdelabrida.com,
mateusfreire05@hotmail.com
Abstract—Bluetooth uses a communication technique called
frequency-hopping which has some collateral effects. One of these
is a signiﬁcant delay time during the phase of discovery of nodes.
To precisely estimate this delay, we use real and simulated devices,
and we measure the elapsed time until a Piconet formation. Our
contribution is modeling the Bluetooth network as a dynamic
graph, adding the frequency-hopping procedures, Piconet limits
and network constraints. These new components render a model
which is more consistent with the Bluetooth network technology
speciﬁcation than those presented so far. Our graph can be used
as a basis for realistic optimization models.
Keywords—bluetooth; scatternet; frequency hopping; dynamic
graph.
I.
INTRODUCTION
In 2012, 1.1 billion mobile phones were shipped, almost
100 percent with Bluetooth technology [1]; but, despite this
popularity, Bluetooth network applications are not yet explored
in their full potential. The new-coming wearable devices, like
smart-watches, and smart-glasses to name a few, use Bluetooth
intensively. New popular apps, like ﬁrechat, also depend on
the ad hoc Bluetooth network formation. The possibility of
forming wider-ranging ad hoc networks enhances their most
common use: ﬁles exchange apps and mono headsets.
During communication, Bluetooth devices do not use a
ﬁxed frequency; they use frequency-hopping. Therefore, for
a link formation, a device discovery phase is ﬁrstly needed.
In the device discovery phase, one device scans for another
device, and both send and listen messages, respectively, in a
pseudo-random frequency sequence, until a frequency coinci-
dence occurs and the synchronization messages are delivered.
Even in a smallest network with two nodes, there is a delay
time as consequence of the randomness, this prohibits Blue-
tooth for latency-sensitive applications.
The frequency-hopping sequence and all data ﬂows are
coordinated centrally by a node called master, in a master-
slave point-to-multipoint network called Piconet. Each Piconet
contains only one master, and can have a maximum of seven
active slave nodes communicating to 10 m range.
To expand the limits of this communication, we prefer
Scatternets. They are collections of Piconets joined by a Bridge
node and coordinated by a protocol.
The collateral effects of frequency-hopping in Bluetooth,
such as the delay in discovery phase, show the relevance of
a Bluetooth network graph model. It is important to devise a
realistic model, having procedures and constraints consistent
with the technology speciﬁcation.
In this work, we have the following contributions:
A Bluetooth network dynamic graph, with:
•
The Piconet and Scatternet characterization and topol-
ogy constraints;
•
Master and slaves node rules;
•
The proposal, implementation and validation of two
procedures: FHS() and Disc(), which represent a
device frequency hopping sequence synchronization
and discovery of devices.
These new procedures and network constraints characterize
our Bluetooth network graph as a dynamic graph.
In Section II, we describe the initial formation process of a
Piconet. Section III discusses the related work. In Section IV
the initial connection delay time is identiﬁed by simulation
and real experiments. In Section V, we present the dynamic
Bluetooth network graph model. Finally, the conclusions are
in Section VI.
II.
PICONET - THE BASIC BLUETOOTH NETWORK
FORMATION
In a Piconet, a device assumes the role of master or slave,
and two distinct phases are required to connect: the discovery
and the link formation.
During the discovery phase, the candidate for the master
device goes into the INQUIRY state, looking for the devices
candidates for the slave in an INQUIRY SCAN state.
During the INQUIRY state, the searching device sends an
IDentiﬁer (ID) by broadcast using 32 of the 79 frequencies de-
ﬁned by Bluetooth speciﬁcation. The sequence of frequencies
that will be used to broadcast ID messages, is a pseudo-random
calculate, derived from the clock of the device. The set of this
frequencies is called Inquiry Hopping Sequence (IHS).
The candidate for slave device in INQUIRY SCAN state
listens to broadcasts ID, on the same 32 IHS frequencies,
hopping in a pseudo-random sequence derived from its clock.
76
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

In this phase, candidates for master and slaves send and
listen messages respectively in a sequence of pseudo-random
frequency hops, until a frequency coincidence occurs. A time
slot difference collaborates with the increased likelihood of the
device hearing the same channel on which a ID was listened:
the devices in INQUIRY state hop in time slots of 312.5µs
faster than the standard Bluetooth 625µs used by devices in
INQUIRY SCAN.
After receiving an ID, the candidate for slave device
assumes a state called INQUIRY RESPONSE, and responds
to the request by sending its network address and clock, in a
packet called frequency-hopping synchronization (FHS), using
the same frequencies of IHS. Then, the device waits for the
backoff a random value of time slots (0 − 639.375)µs, with
the objective of minimizing collisions of responses, and goes
to PAGE SCAN state.
When the candidate for master device receives the FHS,
it enters a state of PAGE, and uses the information received
from the FHS for synchronization and connection with the
candidates for slave device that have already been discovered
and are in the PAGE SCAN state.
During the PAGE state, the candidate for master device
selects a candidate for slave device to be connected sending
packages to the candidate for slave devices previously discov-
ered using the sequence of estimated hops.
After the PAGE process is complete, the Piconet is formed
and the devices gain a connected status and assume their
master and slaves roles.
III.
RELATED WORK
Jedda, Jourdan and Zaguia [2] analysed the impacts of
changing Bluetooth parameters on the static and dynamic
Scatternet formation protocols. These parameters are related to
the use of the frequency hop communication technique. The
Scatternet formation on static protocols happens as follows;
each node alternates randomly between the INQUIRY and
INQUIRY SCAN Bluetooth discovery states, when one device
discovers each other, a temporally Piconet is formed until being
destroyed at the end of the communication. They called this
mechanism of ALTERNATE, being examples of it: BlueStars
Petrioli, Basagni and Chlamtac [3]; BlueMIS Zaguia, Stoj-
menovic and Daadaa [4] and BlueNet Wang, Thomas and
Haas [5]. In dynamic Scatternet protocols, the discovery phase
is interlaced with the network formation, the node shares its
time between discovering new devices and communication in
the Scatternet. The examples of dynamic protocols are: Law,
Mehta and Siu [6] and Cuomo, Melodia and Akyildiz [7].
Jedda, Jourdan and Zaguia [2] using ns-2 [8] simulator, found
that changing parameters of Bluetooth 1.2 discovery phase,
produce ALTERNATE Scatternets 3.5 times faster.
In Pettarin, Pietracaprina and Pucci [9], the Bluetooth
dynamic topology was described as a sequence of graphs
G(n, ρ, r(n), c(n), ϵ) = {Gt : t ∈ N}. Each of the n agents
moves to a grid node chosen uniformly at random among
the grid nodes within euclidean distance ρ from its current
position, being t each time step, linked to the movement of de-
vices. This model describes situations in which the devices are
moving and establishing network connections. This sequence
of graphs can be modeled as a Markov chain Clementi, Monti,
Pasquale e Silvestri [10], whose transitions describe by the
model of moving nodes.
Ferraguto, Mambrini, Panconesi and Petrioli [11] proposes
a Bluetooth network graph model, where the links can be
described by n devices randomly distributed in the unit square,
the function c(n) is the neighborhood of each device and r(n)
is the range of each device. With this, the Bluetooth network
is denoted by the graph BT(r(n), c(n)).
Jedda, Jourdan and Zaguia [2] show, by ns-2 simulation,
that the parameters changes related to Bluetooth discovery
phase, are more signiﬁcant in static Scatternet protocols, that
use use the ALTERNATE strategy, than in dynamic Scatternet
protocols as in Law, Mehta and Siu [6]. This opens a discussion
about the importance of new propositions that include changes
in parameters related to the Bluetooth frequency-hopping.
The Random Geometric Graph (RGG) has been employed
for the characterization of Bluetooth network topology. Pet-
tarin, Pietracaprina and Pucci [9] discuss the expansion and
diameter of RGG subgraphs induced by device discovery
phase. Experimental evidence shows that BT(r(n), c(n)) is a
ideal model for the Bluetooth topology; see Ferraguto, Mam-
brini, Panconesi and Petrioli [11]. Unlike our proposed model,
classical graph models of Bluetooth as Gupta and Kumar [12],
Ferraguto, Mambrini, Panconesi and Petrioli [11], Crescenzi,
Nocentini and Pietracaprina [13] and Pettarin, Pietracaprina
and Pucci [9], do not explore (i) the topology of a Piconet,
(ii) the Scatternet formation, or (iii) the intrinsic inﬂuences of
frequency-hopping communication.
A correct mapping of frequency-hopping peculiarities is
essential for the suitable design of Bluetooth solutions and
applications.
IV.
IDENTIFYING THE DELAY
In order to measure the elapsed time of a Piconet con-
nection and verify the existence of a connection delay, we
generated Piconet instances, using simulation and real devices.
We used the UCBT [14], a ns-2 [8] extension that sim-
ulates Bluetooth, developed by the University of Cincinnati.
Additionally, to verify the real scenario, we used the Lego
NXT Mindstorm [15], and robots were assembled to establish
connections with each other via Bluetooth. The Bluetooth
communication interface in Lego Mindstorms NXT kits has the
channels according with the Bluetooth speciﬁcation, however
the buffer of the equipment does not allow the use of more than
three channels simultaneously. Piconets were testes limited to
three devices. The robots were assembled as vehicles, and the
Bluetooth conﬁgured for creating the the communication link
as soon as they entered the network range. Once the connection
is established, the vehicles should move in opposite directions
until losing the communication due to distance. Once the
connection between the robots stops, they must return to the
starting point to restore the Piconet. Connections were restored
even in the presence of thick walls. All the elapsed times were
collected while the robots were moving.
In the ﬁrst experiment, we generated 30 real and simulated
instances of Piconets with sizes of two (one master and one
slave) and three nodes (one master and two slaves). We
77
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

measured the amount of time until all the slave nodes were
in connected status with the master node. The box-plots in
Figure 1 and Figure 2 represent the elapsed time until total
connection of nodes in the 30 instances of each Piconet size.
We observe that the elapsed time until total Piconet connection
is, in mean, one second longer, even between one master-slave
link. This is a problem because long connection time is not
tolerated by many security and medical applications, among
others.
In a second experiment, we generated 30 ns-2 simulation
instances to each Piconet formed with one master and n neigh-
boring candidates for the role of slave device. In accordance
with Pettarin, Pietracaprina and Pucci [9], we observed that as
the value of n increases, so is the likelihood of connection. The
rationale for this is that during the discovery phase, all devices
in INQUIRY SCAN perform pseudo-random hops in slower
time slots than the master until there is a match of frequencies.
This behavior shows that, despite the increase in density
of devices within the range of the master, the frequency-
hopping technique provides greater resilience to collisions and
depletion of the spectrum. Figure 3 show the elapsed time until
ﬁrst INQUIRY RESPONSE.
Figure 4 shows the formation of a theoretically maximal
Piconet, represented by one master and seven slaves. We
observed the proportional increase value of n and the time.
This behaviour is explained by the need for matching the
channel in the discovery phase, the backoff and a scheduling
of intra-Piconet synchronization packets.
In order to create a new slave entry in an existing Piconet,
the master needs to stop the intra-Piconet communication and
a new discovery must start. The slaves that have already
entered the Piconet change to HOLD mode, waiting for new
polling from the master before re-communicating. The time
cost of this operation grows with the increase of devices due to
the new discovery and resynchronization by the intra-Piconet
Scheduling process.
The error bars in Figure 4 show the high degree of
variability and delay in the connection, represented by random
variables associated with the discovery of slaves, backoff time
and intra-Piconet scheduling processes.
V.
DYNAMIC GRAPH OF BLUETOOTH NETWORK
The Bluetooth network will be described as a graph,
following the deﬁnition by Gupta and Kumar [12] and Pettarin,
Pietracaprina and Pucci [9].
Consider the undirected graph G = {V, E′} composed by
the set of n ≥ 1 nodes V = {v1, . . . , vn} and of edges E′ ⊂
{V × V}, such that (ei, ej) ∈ E′
⇐⇒
(ej, ei) ∈ E′. A
dynamic Bluetooth graph, able to describe the formation of
Piconets and Scatternets, will be deﬁned on top of this generic
graph with the inclusion of a spatial restriction and of nodes
labels.
A common assumption for the placement of nodes is
the fully independent or binomial model Ramos, Guidoni,
Nakamura, Boukerche and Frery [16]. According to this model,
given n nodes, their coordinates (xi, yi)1≤i≤n in the [0, 1]2
square are outcomes of 2n independent identically distributed
uniform [0, 1] random variables. Nodes represent devices, and
Figure 1. Elapsed Time until complete Piconet connection using Lego NXT.
Figure 2. Elapsed Time until complete Piconet connection using ns-2
once they are deployed, the links which enable the commu-
nication are built according to the range r(i) of each device.
The geometric rule says that the edge (ei, ej) ∈ E′ may may
exist only if d(vi, vj) ≤ min{r(i), r(j)}, i.e., nodes vi and
vj may communicate only if both can talk to each other. The
distance function d: [0, 1]2 × [0, 1]2 → R+ is arbitrary and
may incorporate any prior information about the environment
as, for instance, obstacles. The choice of the unitary square
support does not impair any lack of generality on the model.
Many applications assume reciprocal communication setting
r(i) = r for every 1 ≤ i ≤ n.
The deﬁnition of protocols for the operation of Bluetooth
networks requires another ingredient: identifying masters and
slaves. Each node receives a label, either “M” or “S” for
denoting its current state.
A new graph can be now deﬁned, provided the graph G
deﬁned as above. The Bluetooth graph BT is a subset of G
78
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

Figure 3. Time until ﬁrst INQUIRY RESPONSE
Figure 4. Time until formation of the ﬁrst complete Piconet with 7 slaves
and 1 master
such that BT = {V, E} since possibly not all allowed connec-
tions are set, i.e., E ⊂ E′. The communication speciﬁcation E
has to satisfy the following requirements:
1)
There is at least one M node.
2)
All S nodes connect to one and only one M node.
3)
M nodes do not have connections among them.
4)
S nodes do not have connections among them.
A Piconet if formed if there is only one M node and all S
nodes connect to it. If there is more than one M node, we are
in the presence of a Scatternet.
Pettarin, Pietracaprina and Pucci [9] describe situations
in which the devices are moving. The BT graph is, thus,
dynamic and can be described as a function of the time
BT(t) = {V, E(t)}. The authors describe the sequence of
graphs by means of a Markov chain whose transitions express
the change of connections due to the movement of the nodes.
Figure 5. The nodes u and v are in range of each other
Figure 6. The nodes u and v initialize the discovery Disc()
Figure 7. The coincidence of frequency fi occurs
Figure 8. The v node transmit its network address and clock
Figure 9. The nodes use FHS() to generate the F ′ frequency sequence
Denote F = {fi : 0 ≤ i ≤ 79} the set of frequencies
used in FHSS, then FHS is a function FHS(CLK, MS),
where CLK is the clock of the elements involved and MS
is the address of the Piconet master. The details of FHS are
given by the Bluetooth speciﬁcation. Each master-slave link
has an unique pseudo-random sequence of frequencies F ′ =
(f ′
1, f ′
2, . . . ), so that f ′
i ∈ F.
Let u and v to nodes, as in Figure 5. We deﬁne the process
of discovery as the operation Disc(u, v, fi) which consists of
the insertion of the edge (u, v) in E.
The Disc() process has its execution distributed, while run-
ning u and v at the same time, see Figure 6. Master and slaves
begin a sequence of pseudo-random frequency hops, until a
frequency fi coincidence occurs, as illustrated in Figure 7.
After matching, the slave waits for a random time to respond
FHS() to the master, this is called Backoff interval. This is
necessary because the FHS() must be exchanged between
nodes; see Figures 8 and 9. For this purpose, after Disc()
has been applied, the slave returns FHS() and generates the
correct pseudo-random sequence F ′ for the connection; see
Figure 10. The labels “M” and “S” are given to the nodes
selected as master and slave, respectively, see Figure 11.
Changes as the ones described above in the connectivity of
the Bluetooth network make it a dynamic graph; see Frigioni
and Italiano [17].
79
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

Figure 10. Now the nodes use the frequency sequence F ′ to exchange
messages
Figure 11. After frequency synchronization, the nodes receive the labels
M-master and S-slave, and the links represented by the edges (u, v) and
(v, u) begin the message transport
VI.
CONCLUSION AND FUTURE WORK
The delay observed during the initial Bluetooth connection
process is directly related to the effects of frequency-hopping
technology use. This delay is the sum of:
1)
in Bluetooth discovery phase:
•
a random value of time until the coincidence
of frequencies between listener and sender
devices;
•
the random value of time of Backoff until
node can listen a response;
2)
in Piconet with more than two nodes, during the entry
of a new slave in a existing Piconet, a new discovery
process is needed, and a intra-Piconet scheduling for
master frequency resynchronization.
The randomness in discovery and its collateral effect, the
delay, is a crucial constraint for simple Piconet applications
that require adequate responsiveness. The Disc() and FHS()
functions in the dynamic graph, shown in Section V, are the
procedures affected.
The problem of delay and speciﬁc characteristics of a
network using frequency-hopping as Bluetooth Piconet, shows
the relevance of a model consistent with the Bluetooth speci-
ﬁcation as our dynamic graph.
New research proposing changes to the Bluetooth speci-
ﬁcation need to be leveraged. The search for techniques that
reduce the duration of discovery phase, will give rise to new
use cases for Bluetooth network.
As future works, we will add the PAGE procedures to
Bluetooh network dynamic graph, and use it as the basis of the
constraints in the Ferreira, Oliveira, Gambini and Frery [18].
ACKNOWLEDGEMENT
Thanks to Fundac¸˜ao de Amparo `a Pesquisa do Estado
de Minas Gerais (FAPEMIG), to CNPq, CAPES, UFOP
(Universidade Federal de Ouro Preto), SEVA Engenharia and
FAPEAL.
REFERENCES
[1]
bluetooth.com,
”The
bluetooth
network
effect,”
Last
Visited
in
05/30/2014.
[Online].
Available:
http://www.bluetooth.com/Pages/
network-effect.aspx/
[2]
A. Jedda, G.-V. Jourdan, and N. Zaguia, ”Some side effects of fhss
on bluetooth networks distributed algorithms,” in Proceedings of the
ACS/IEEE International Conference on Computer Systems and Appli-
cations - AICCSA 2010, ser. AICCSA 10. Washington, DC, USA: IEEE
Computer Society, 2010, pp. 1–8.
[3]
C. Petrioli, S. Basagni, and I. Chlamtac, Conﬁguring bluestars: mul-
tihop scatternet formation for bluetooth networks, Computers, IEEE
Transactions on, vol. 52, no. 6, 2003, pp. 779-790.
[4]
N. Zaguia, I. Stojmenovic, and Y. Daadaa, Simpliﬁed bluetooth scatter-
net formation using maximal independent sets, in Complex, Intelligent
and Software Intensive Systems, 2008. CISIS 2008. International Con-
ference on, 2008, pp. 443–448.
[5]
Wang, Zhifang and Thomas, Robert J. and Haas, Zygmunt J., ”Bluenet
- A New Scatternet Formation Scheme,” in HICSS , 2002, pp. 9 pp.
[6]
C. Law, A. K. Mehta, and K.-Y. Siu, ”A new bluetooth scatternet
formation protocol,” Mob. Netw. Appl., vol. 8, no. 5, Oct. 2003, pp.
485–498,
[7]
F. Cuomo, T. Melodia, and I. Akyildiz, Distributed self-healing and
variable topology optimization algorithms for qos provisioning in scat-
ternets, Selected Areas in Communications, IEEE Journal on, vol. 22,
no. 7, 2004, pp. 1220-1236.
[8]
N. S. 2, ”The network simulator - ns2,” Last Visited in 05/30/2014.
[Online]. Available: http://www.isi.edu/nsnam/ns/
[9]
A. Pettarin, A. Pietracaprina, and G. Pucci, ”On the expansion and
diameter of bluetooth-like topologies,” in Algorithms - ESA 2009,
ser. Lecture Notes in Computer Science, A. Fiat and P. Sanders, Eds.
Springer Berlin / Heidelberg, 2009, vol. 57, pp. 528–539.
[10]
A. Clementi, A. Monti, F. Pasquale, and R. Silvestri, Information
spreading in stationary markovian evolving graphs, Parallel and Dis-
tributed Systems, IEEE Transactions on, vol. 22, no. 9, 2011, pp. 1425-
1432.
[11]
F. Ferraguto, G. Mambrini, A. Panconesi, and C. Petrioli, A new
approach to device discovery and scatternet formation in bluetooth
networks. in IPDPS. IEEE Computer Society, 2004.
[12]
P. Gupta and P. Kumar, ”The capacity of wireless networks,” Informa-
tion Theory, IEEE Transactions on, vol. 46, no. 2, Mar. 2000, pp. 388–
404.
[13]
P. Crescenzi, C. Nocentini, A. Pietracaprina, and G. Pucci, On the
connectivity of bluetooth-based ad hoc networks, Concurrency and
Computation: Practice and Experience, vol. 21, no. 7, 2009, pp. 875-
887.
[14]
D. A. Q. Wang, ”Ucbt - bluetooth extension for ns2 at the university
of cincinnati,” Last Visited in 05/30/2014. [Online]. Available: http:
//www.cs.uc.edu/cdmc/ucbt/
[15]
lego.com, ”Lego - NXT - Software,” Last Visited in 05/30/2014.
[Online]. Available: http://www.lego.com/en-us/mindstorms/downloads/
nxt/nxt-software/
[16]
H. S. Ramos, D. L. Guidoni, E. F. Nakamura, A. Boukerche, A. C. Frery,
and A. A. F. Loureiro, Topology-related modeling and characterization
of wireless sensor networks, in PE-WASUN2011 ACM International
Symposium on Performance Evaluation of Wireless Ad Hoc, Sensor,
and Ubiquitous Networks. Miami, EUA: 2011ACMi, 2011.
[17]
D. Frigioni and G. F. Italiano, ”Dynamically switching vertices in planar
graphs (extended abstract),” in Proceedings of the 5th Annual European
Symposium on Algorithms. London, UK: Springer-Verlag, 1997, pp.
186–199.
[18]
C. M. Soares Ferreira, R. A. Rabelo Oliveira, H. S. Gambini, and A.
C. Frery, Static bluetooth scatternet formation models: The impact of
fhss, in AICT 2013, The Ninth Advanced International Conference on
Telecommunications, 2013, pp. 25-31.
80
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

