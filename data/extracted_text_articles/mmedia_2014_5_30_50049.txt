Tone Reproduction based on Singular Value Decomposition  
for High Dynamic Range Imaging 
 
Changwoo Ha, Wonkyun Kim, Cheonghee Kang, and Jechang Jeong 
Department of Electronics and Computer Engineering  
Hanyang University 
17 Haengdang-dong, Seongdong-gu, Seoul, Korea 
hahanara@hanyang.ac.kr, wonkyun.kim@gmail.com, cheonghee.kang@gmail.com, and jjeong@hanyang.ac.kr 
 
 
Abstract— This paper presents a tone reproduction method 
with the appropriate tone and details of high dynamic range 
images on the conventional low dynamic range display 
devices. The proposed algorithm mainly consists of image 
decomposition using singular value decomposition, a 
singular value based luminance adjustment, and an image 
composition process. In the final tone reproduction process, 
the proposed algorithm combines color and luminance 
components in order to preserve the color consistency. The 
experimental results show that the proposed method 
achieves good subjective quality while enhancing the 
contrast of the image details. 
Keywords-high 
dynamic 
range 
imaging; 
tone 
reproduction; tone mapping; singular value decomposition 
I. 
 INTRODUCTION 
The area of high dynamic range (HDR) imaging is an 
attractive method with the improved image capturing 
hardware, and it is an image processing method that 
produces a large dynamic range. There are many practical 
applications including scientific, medical visualization [1], 
satellite imagery [2], and digital camera [3]. In particular, 
the ability to capture the real world luminance in a scene 
has become a necessary function of digital camera. 
However, compared with the 108:1 range of real world 
luminance from bright sunlight to starlight, the HDR 
image display devices, such as CRT, LCD, and LED have 
a low dynamic range (LDR) of 102:1 cd/m2 [4]. 
Although HDR monitors have been existed and 
researched, they are not only rare and costly, but also 
difficult to calibrate [5]. Therefore, the tone reproduction 
(or tone mapping) method is necessary to display on the 
conventional display devices, for which the luminance 
range should be transformed to a displayable range that 
below two orders of magnitude. In tone reproduction, the 
HDR image contains details in the extremely dim and 
extremely bright regions; therefore it is difficult to 
preserve the details while compressing the HDR into the 
LDR. The discrepancy between the wide range of 
luminance captured by HDR techniques and the small 
range of luminance reproduced within displayable ranges 
from the HDR causes an inaccurate display of the images. 
Due to this discrepancy, the proper tone reproduction 
techniques are required. These techniques not only 
transform HDR images into the displayable range, but also 
preserve the details, considering the characteristics of the 
original HDR images.  
In the previous works, most tone reproduction 
techniques have focused on compression and quality 
evaluation for visualizing HDR images. The tone 
reproduction can be classified as a global operator [6]-[9] 
which is the same reproduction function is applied in all 
regions, or as a local operator [10]-[12] which is the 
different 
tone 
reproduction 
functions 
are 
applied 
throughout the modeling of spatial adaptations. 
This paper is organized as follows. Section II provides 
a basic concept that is used for the proposed algorithm. In 
Section 
III, 
the 
proposed 
method 
is 
described. 
Experimental results prove the performance of the 
proposed method in Section IV. The paper is concluded 
with an overall discussion in Section V. 
II. 
PRELIMINARY KNOWLEDGE 
The singular value decomposition (SVD) of a 
rectangular matrix A has many important properties and 
useful applications [13]-[16]. Without loss of generality, 
for every m×n (m≥n) matrix A, the SVD can be written as 
 
1
n
k
k
k
T
T
k
A
USV
u s v


 
 
 
(1) 
 
where U=[u1, u2, ..., um] ∈ Rm×m and V=[v1, v2, ..., vn] ∈ 
Rn×n are two-column orthogonal matrices, and VT denotes 
the transpose of V. S is a diagonal matrix with elements si, 
i=1,2,…,n. The diagonal elements can be sorted in a 
decreasing order, and these are the singular values of 
matrix B: 
 


1
1
, 2
,
,
.
n
n
s
S
diag s s
s
s












 
 
(2) 
 
The matrix S represents the luminance information of 
the given image. Note that increasing the magnitudes of 
the singular values of matrix S will increase the image 
luminance range, whereas lowering the magnitudes will 
decrease the image luminance range. Therefore, we can 
81
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-320-9
MMEDIA 2014 : The Sixth International Conferences on Advances in Multimedia

use a singular value instead of luminance range. For 
example, the SVD-based contrast enhancement technique 
is used while preserving the original image characteristic 
[13, 14]. In other words, SVD-based method will control 
the dynamic range maintaining the characteristic of the 
original image. 
III. 
PROPOSED METHOD 
The basic principle of the proposed algorithm is to 
perform a luminance adjustment using SVD. The objective 
of the proposed SVD-based method is to maintain the 
important features in the transformation from HDR to 
LDR. The proposed luminance adjustment method works 
on the luminance component of the image only which is 
described in the logarithmic space. From the HDR image, 
the run-length encoded input values are converted to 
floating point numbers with linear RGB values. The RGB 
values are then converted to a CIE XYZ color space [17]. 
The standard matrix in logarithmic space is obtained by 
  
log(0.2126
0.7152
0.0722
)
iL
R
G
B






 
(3) 
 
where Li is the input luminance value and R, G, and B are 
the red, green, and blue components. 
Firstly, we calculate an anchor image, which offers the 
dynamic range of displayable devices. The process of 
displaying an HDR image is composed of quantization and 
mapping as shown in Fig. 1. Since there are too many 
discrete values in the high dynamic scene, the tone 
mapping methods must reduce the number of candidate 
values by quantization. Quantization is a well-known 
clustering method [18]. Let x(k) with k = 1, 2,…, N be the 
luminance elements of the HDR image. A quantizer is 
represented by an encoder Q, which maps x(k) to an index 
n ∈ N. One of a small collection of mapping values 
(candidates) C = {cn ; n ∈ N} is used for mapping, where N 
is set to 256, which is the number of displayable levels in 
the LDR image. The quantizer is described as  
  
( ( ))
,   
( )
( )
 
.
n
i
Q x k
n
if x k
c
x k
c
i




  
(4) 
 
A pixel in the HDR image is assigned to the available 
candidate close to the original value. A set of all pixels 
assigned to the same candidates is defined as a cluster of 
pixels. In other words, all HDR pixels belong to the same 
cluster are displayed at the same LDR level. Pixels in the 
cluster of a larger candidate value are expected be brighter 
than those of a smaller candidate value. Note that the 
propose method only works in logarithmic space, treats 
each pixel individually, and uses the scalar quantization. 
The HDR log image, Li, is decomposed through the use 
of (1). Then, the proposed method controls the luminance 
adjustment by using (2). The adjustable singular value can 
be seen as a solution of a bi-criteria optimization problem. 
The object is to find the adjustable singular value s that is 
close to the singular value of the quantized image sq, while 
also reducing the size of the si. This adjustable singular 
value can then be used to obtain the composition using (5) 
below. This adjustable singular value can be formulated as 
a weighted sum of the two objectives as 
 
argmin
q
s
i
s
s
s
s
s





 
(5) 
 
where s, si, and sq are the maximum singular value, the 
maximum singular value of the original HDR image, and 
the maximum singular value of the quantized image, 
respectively. The parameter λ varies over [0, ∞], and the 
solution of (5) gives the optimal trade-off curve between 
the two objectives. When the squared sum of the 
Euclidean norm is used, the following analytical solution 
of (5) can be obtained: 
 
2
2
argmin(
)
(
) .
i
q
s
s
s
s
s
s





 
(6) 
 
The solution to this minimization problem is obtained 
by 
  
1
 (1
)
) (
.
i
q
s
s
s






 
(7) 
 
The adjustable singular value s is a weighted average 
of si and sq. If λ is zero, s  is the singular value of the input   
image. As λ approaches infinity, it approaches the singular 
value of the quantized image. Thus, various levels of 
luminance can be adjusted by simply changing the 
parameter λ. Therefore, the displayable luminance 
adjustment Ld is composed through the use of the optimal 
singular value ratio to obtain the following: 
SVD-based Image 
Composition 
Image composition 
Process
Luminance Adjustment 
Process
SVD-based Image 
Decomposition
Image Decomposition 
Process
Input 
HDR image
Output 
LDR image
 Tone 
Reproduction 
Tone Reproduction 
Process
SVD-based 
Dynamic Range 
Adjustment 
 
Figure 1.  Overall structure of the proposed algorithm. 
82
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-320-9
MMEDIA 2014 : The Sixth International Conferences on Advances in Multimedia

,   
max( )
max( ) .
 
T
d
i
s
L
w
USV
here S
S
s


 
(8) 
 
Conventional methods reproduce images by using the 
luminance information only. However, the reproduced 
luminance needs to be combined with the color 
information to produce good quality tone reproduced 
images. In the proposed algorithm, the modified color and 
luminance components are combined to obtain the final 
tone reproduced values in (9), because the color shifts will 
be minimized if the ratio among the color channels before 
and after the compression is maintained. The scale of the 
color components is determined by Ld, and the ratio among 
the color channels (C = R, G, B) is preserved by the 
fractions Ci/Li as in 
 
i
d
d
i
C
C
L
L









 
 
(9) 
 
where Cd represents the final tone reproduced R, G, and B 
values for the display, and Ci represents the input HDR 
data with Li. To control the amount of saturation in an 
image, the fraction is fitted with an exponent, γ, resulting 
in a per-channel gamma correction, which is given as a 
user parameter in the range of 0 to 1. Experimentally, γ 
was set as 0.45. 
 
 
 
(a) 
(b) 
(c) 
 
  
                                                                                (d)                      
                               (e) 
Figure 2.  The quality comparison with  Rosette (720×480): (a) Photoreceptor method, (b) Segmentation-based  method, (c) Logarithmic method,                
(d) Photographic method, and (e) Proposed method.  Image courtesy of Paul Debevec. 
 
         
 
 
       
 
 
 
 
 
 
(a) 
(b) 
(c) 
(d) 
(e) 
Figure 3.  The quality comparison with  Memorial (512×768): (a) Photoreceptor method, (b) Segmentation-based  method, (c) Logarithmic method,                
(d) Photographic method, and (e) Proposed method.  Image courtesy of Paul Debevec. 
83
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-320-9
MMEDIA 2014 : The Sixth International Conferences on Advances in Multimedia

IV. 
EXPERIMENTAL RESULTS 
The experimental results are comparable in quality and 
performance to the manually reproduced images. In this 
simulation, the parameter λ was set to 99. In Figs. 2 and 3, 
the proposed algorithm is compared to the conventional 
tone reproduction operators from a subjective quality point 
of view. With default parameter settings for each 
technique, the proposed algorithm is compared using four 
global operators: the photoreceptor method of Reinhard et 
al [7], the segmentation-based technique of Yee et al [8], 
the logarithmic method of Drago et al [9], and the 
photographic method of Reinhard et al [10], are used. 
Brief explanations of the methods used to compare against 
the performance of the proposed algorithm are described 
as follows. In the global operators, the photoreceptor 
method first mimics the photoreceptor physiology with 
some user parameters, but also applies a simple local 
operator in the spatial domain. Next, the segmentation-
based method computes the local adaptation luminance for 
a global operator that makes use of the image 
segmentation. The logarithmic method is a simple global 
tone 
reproduction 
algorithm 
that 
compresses 
the 
luminance range according to the base of the logarithm 
chosen for each pixel. The photographic method has the 
global and local operators. In this experiment, the 
photographic method uses a global operator without a 
Gaussian filter with a parameter estimation technique. 
Figs. 2 and 3 show global tone operators that produce 
good subjective results, but cannot successfully preserve 
both tone and local details in an image, particularly in the 
dim and bright regions such as the cropped regions. In 
Figs. 2(a) and 3(a), the details are enhanced but the tone is 
lost to low brightness. In Figs. 2(b) and 3(b), the tone and 
details are washed out in the whole image. The tone is not 
natural because the details are over enhanced and the tone 
is missing, as shown in Figs. 2(c)-(d) and 3(c)-(d). In Figs. 
2(e) and 3(e), the proposed technique achieves the natural 
tone and preserves the details simultaneously. 
V. 
CONCLUSION 
The most important aspect of reproducing an HDR 
image as an LDR image is to preserve the tone and details 
of the HDR image without causing undesirable artifacts, 
such as halo effects. The proposed algorithm adjusts the 
luminance values of an image in order to preserve the tone 
and details based 
on 
the 
SVD-based 
luminance 
adjustment. By combining the modified color components 
with the displayable scale, the color consistency is 
preserved. The experimental results show that the 
proposed algorithm achieves good subjective results, 
especially the balance of the details and subtle tones in 
both dark and bright regions. 
ACKNOWLEDGMENT 
"This research was supported by the MKE(The 
Ministry of Knowledge Economy), Korea, under the 
ITRC(Information Technology Research Center) support 
program supervised by the NIPA(National IT Industry 
Promotion Agency)" (NIPA-2013-H0301-13-1011). 
REFERENCES 
[1] A. A. Bell, J. Brauers, J. N. Kaftan, D. Meyer-Ebrecht, A. 
Bocking, and T. Aach, “High dynamic range microscopy 
for cytopathological cancer diagnosis,” IEEE J. Sel. Topics 
Signal Process., vol. 3, no. 1, Feb. 2009, pp. 170-184. 
[2] A. R. Varkonyi-Koczy and A. Rovid, “High-dynamic-range 
image reproduction methods,” IEEE Trans. Instrum. Meas., 
vol. 56, no. 4, Aug. 2007, pp. 1465-1472. 
[3] S. Battiato, A. Castorina, and M. Mancuso, “High dynamic 
range imaging for digital still camera: an overview,” J. of 
Elect. Imaging, vol. 12, no. 3, Jul. 2003, pp. 459-469. 
[4] E. Reinhard, G. Ward, S. Pattanaik, P. Debevec, W. 
Heidrich, and K. Myszkowski, High dynamic range 
imaging: acquisition, display, and image-based lighting, 
2nd ed., Morgan Kaufmann: San Francisco, 2010. 
[5] Y.-K. 
Cheng 
and 
H.-P. 
D. 
Shieh, 
“Colorimetric 
characterization of high dynamic range liquid crystal 
displays and its application,” J. Display Technol., vol. 5, 
no. 1, Jan. 2009, pp. 40-45. 
[6] J. Lee, G. Jeon, and J. Jeong, “Piecewise tone reproduction 
for high dynamic range imaging,” IEEE Trans. Consumer 
Electron., vol. 55, no. 2, pp. 911-18, May 2009. 
[7] E. Reinhard and K. Devlin, “Dynamic range reduction 
inspired by photoreceptor physiology,” IEEE Trans. Vis. 
Comput. Graphics, vol. 11, no. 1, Jan. 2005, pp. 13-24. 
[8] Y. H. Yee and S. Pattanaik, “Segmentation and adaptive 
assimilation for detail-preserving display of high-dynamic 
range images,” Visual Comput., vol. 19, no. 7-8, Dec. 2003, 
pp. 457-466.  
[9] F. Drago, K. Myszkowski, T. Annen, and N. Chiba, 
“Adaptive logarithmic mapping for displaying high contrast 
scenes,” Comput. Graph. Forum, vol. 22, no. 3, Sep. 2003, 
pp. 419-426.  
[10] E. Reinhard, M. Stark, P. Shirley, and J. Ferwerda, 
“Photographic tone reproduction for digital images,” ACM 
Trans. Graph., vol. 21, no. 3, Jul. 2002, pp. 267-276. 
[11] J. Lee, G. Jeon, and J. Jeong, “Chromatic adaptation-based 
tone reproduction for high-dynamic-range imaging,” 
Optical Eng., vol. 48, no. 10, Oct. 2009, pp. 107002.  
[12] G. Guarnieri, S. Marsi, and G., Rampon “High dynamic 
range image display with halo and clipping prevention,” 
IEEE Trans. Image Process., vol. 20, no. 5, May 2011, pp. 
1351-1362. 
[13] C. Ha, W. Kim, and J. Jeong, “Remote sensing image 
enhancement based on singular value decomposition,” 
Optical Eng., vol. 52, no. 08, Aug. 2013, pp. 083101. 
[14] C. Ha, G, Jeon, and J. Jeong, “Contrast enhancement and 
noise elimination using singular value decomposition for 
stereo imaging,” Optical Eng., vol. 51, no. 09, Sep. 2012, 
pp. 090504. 
[15] H. Demirel, C. Ozcinar, and G. Anbarjafari, “Satellite 
image contrast enhancement using discrete wavelet 
transform and singular value decomposition,” IEEE Geosci. 
Remote Sens. Lett., vol. 7, no. 2, Apr. 2010, pp. 333-337. 
[16] D. Kalman, “A Singularly valuable decomposition: The 
SVD of a matrix,” Coll. Math. J., vol. 27, no. 1, 1996, pp. 
2-23.  
[17] ITU, Parameter values for the HDTV standards for 
production and international program exchange, ITU-R 
recommendation BT.709, 1998. 
[18] G. Qiu, J. Duan, and G. D. Finlayson, “Learning to display 
high dynamic range images,” Pattern Recognition, vol. 40, 
2007, pp. 2641–2655. 
84
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-320-9
MMEDIA 2014 : The Sixth International Conferences on Advances in Multimedia

