Filtering of Magnetic Noise Induced in Magnetometers by Motors of Micro-Rotary 
Aerial Vehicle. 
 Nathan J. Unwin, Adam J. Postula 
School of Information Technology and Electrical Engineering 
University of Queensland 
Brisbane, Australia 
email: n.unwin@uq.edu.au, a.postula@uq.edu.au  
 
 
Abstract— Avionics systems of micro aerial vehicles (MAV) 
pose unique problems in system design, sensor signal handling 
and control. This is evident in micro-rotary aircraft as their 
whole body rotates with the sensors of the flight control. The 
precise calculation of attitude and heading from magnetometer 
readings is complex due to the body rotation. It is made even 
more difficult by noise induced in the geomagnetic signal by 
fluctuating magnetic field of the closely positioned motors. 
Filtering that noise is challenging since the rotation speed of 
motors and the vehicle can be very close. This paper presents 
analysis of motor induced noise, based on experimental data of 
brushless micro motors. A novel time domain filter is 
proposed, designed, implemented in FPGA hardware, tested 
and compared to other filters. This filter provides good 
performance even when the rotational rate of the motor and 
vehicle are close and traditional frequency domain filters 
would perform poorly.  
 
Keywords - magnetic noise, magnetometer, rotary body UAV  
I. 
INTRODUCTION 
Rotary body aircraft is unique since it is both a rotary 
wing and fixed wing aircraft, which produces lift by 
spinning like a maple seed. The Papin-Rouilly Gyroptère [1] 
built in 1915 as a manned airplane is the first example of a  
 
 
“monocoptor”, a type of rotary body aircraft. While the 
Gyroptère did not fly it is the basis for contemporary 
designs of rotary body unmanned micro-aircrafts. Figure 1 
shows some of the latest developments of such micro-
aircrafts in industry and academia [2], [3], [4],[5].  
The interesting property of the rotary body aircraft is that  
the  core  set  of  sensors  of  the flight  control  system,  the  
inertial  measurement  unit containing magnetometer,  is  
always  rotating  as  it  is affixed to the body of the aircraft. 
While this is not a problem for the sensors, it is an issue for 
calculation of the attitude and heading of the vehicle since 
this rotation must be filtered out of the geomagnetic signal. 
This is compounded by the relatively high rotation rate of 
these vehicles of up to 10Hz [6], [7].  
As the scale of a monocoptor decreases, the speed at 
which it rotates needs to increase if efficiency of flight is to 
be maintained [7], [8]. In a fast spinning and small aircraft 
the on-board magnetometer placed close to the motors is 
exposed to high level of magnetic noise generated by the 
motors which rotate with speed close to the spin. Filtering 
that noise with traditional frequency domain filters is 
difficult since frequency separation between noise and 
signal is small, necessitating a complex high order filter, and 
raising a question if a standard frequency based filter could 
be effective at all.  
This paper presents an alternative: using a recoded or 
constructed signal to null the signal generated by the motor. 
The most widely used motor for micro aerial vehicles is 
the BrushLess Direct Current (BLDC) motor. The brushless 
DC motor is a permanent magnet synchronous motor 
designed to be used with a square wave input generated by a 
DC powered speed controller [9]. The motor is comprised of 
a permanently magnetised “rotor” that rotates and the 
electro-magnetic “stator” that remains stationary. This paper 
focuses on the most popular out-runner motor type where 
the rotor is positioned around the outside of the stator as 
shown in Figure 2.  
The out-runner motor has a number of magnets arranged 
with the poles alternating on the faces of a ring outside the 
stator, the ring is then connected to a centre shaft that runs 
inside the stator (stator sandwiched between the rotor and 
shaft) [10], [11].  
 
 a  
 
 
     b  
   
 
c 
 
 
     d 
Figure 1. a. Lockheed-Martin Samarai prototype [2], b. Lockeed –
Martin  patent drawing [3], c. University of Maryland aircraft [4], d.  
University of Queensland aircraft [5]. 
17
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-430-5
CENICS 2015 : The Eighth International Conference on Advances in Circuits, Electronics and Micro-electronics

As the motor rotates, the magnets are presented to 
different parts of the stator. By energising the windings to 
pull the magnet towards the winding or inverting the power 
to winding to push the magnet away, torque is applied to the 
rotor [12]. 
The same movement of the magnets generates an 
alternating field outside the rotor. This field is used by some 
speed controllers to sense the position of the rotor to 
determine the optimum way to energise the stator at that 
instant. This field also is measured by magnetometers as 
noise superimposed on the geomagnetic measurements. 
The strength of the field is dependent on the construction of 
the magnet, size of the magnet, construction around the 
magnet and distance to the magnet.  
Permanent magnets exhibit a tendency to demagnetise 
over time. Demagnetisation exhibits relationships with 
temperature, time and subjected magnetic fields [13], [14]. 
However it has been noted that there is behaviour where 
regions of the magnet will demagnetise in preference to 
surrounding regions resulting in poles with non-uniform 
strength within the pole region.  
Localised demagnetisation is of interest for sensing 
applications as it adds higher frequency components to the 
signal generated by the rotation of the motor. Frequencies of 
these components are approximately odd multiples of the 
number of poles. As each magnet may not deteriorate 
identically, the frequency multiple may not be an integer 
value (but as it is a periodic signal, will be a waveform with 
an even number of poles). 
This paper is structured as follows: in Section 2 analysis 
of the noise generated by motors is provided, in Section 3 
we analyse options for filtering and outline the design of 
time domain inverse filter, in Section 4 filter performance is 
discussed, in Section 5 design options and limitations are 
examined, and finally in Section 6 we conclude and outline 
possible extensions to this work.  
II. EXTERNAL MAGNETIC FIELD OF PERMANENT MAGNET 
SYNCHRONOUS MOTORS 
Before a method of correction could be attempted, the 
properties of the interference due to the motors needed to be 
determined. To do this a motor was operated with a 
moderate load and the resulting magnetic interference 
recorded by a magnetometer in close proximity. The 
experiments were conducted on a number of small motors of 
different types such as  Cyclone 440,  Scanner RC 
SCM3213-1750, Turnigy C2826-1650, Turnigy C3542-
1100, and a wear ranging from brand new to a few hours of 
continuous load (typical for micro-aerial vehicles). The 
effects of the motor were measured at various speeds. 
During this test it was noted that the noise was fairly 
constant across the different speeds. The representative 
results of measurements are shown in Figure 3.  
The external magnetic field with the motor running (for 
the tested motor) is approximately 0.05 gauss. The field 
generated purely due to permanent magnetic field is also 
approximately 0.05 gauss for this motor. The above 
observation indicates that the field measurements can be 
performed with the motor rotated by an external drive e.g. a 
stepper motor. Such an arrangement allows for much better 
control and more precise measurements. 
The result of the magnetic field measurement is a 
periodic waveform presented in Figure It can be observed 
that the motor appears to have a higher and lower frequency 
components.
 
Figure 4. Example magnetic field measurement with a rotating motor 
Closer analysis using the Fast Fourier Transform 
identifies three dominate frequency components, as shown 
in Figure 5.  
The lowest frequency component f1 corresponds to the 
speed of the motor. From this it can be established that the 
Figure 3. Raw measured magnetic field of rotating motor 
 
Figure 2. 1. BLDC simplified configuration. 2: Illustration of localised 
demagnetisation (not to scale). 
18
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-430-5
CENICS 2015 : The Eighth International Conference on Advances in Circuits, Electronics and Micro-electronics

motor forms a pair of strong poles, possibly due to 
imbalances in the magnets. This pair of poles forms the 
strongest field present in the motor when considering only 
the permanent magnetic field. 
The medium frequency component f7 corresponds to the 
magnets embedded inside the rotor of the motor: The motor 
under this test was a 14 pole motor, with each poll 
corresponding to either a north or south orientation. As the 
motor is rotated the polls will result in a waveform with a 
number of peaks equal to the number of poles and a 
frequency equal to half the number of poles. 
 
       Figure 5. FFT analysis of magnetic field of rotating BLDC 
The high frequency component f35 is due to localised 
demagnetisation. Owing to the fact that the demagnetisation 
is not the same for all magnets, the spectrum had a wider 
distribution. Different motors exhibited different centre 
frequencies and distributions, but were all around the 35 
times rotation rate. 
III. 
SELECTION AND DESIGN OF FILTERS 
A. Frequency domain Filters 
Frequency domain filters are the current choice for 
filtering noise for sensors on UAVs.  
The low pass filter is almost universally used on all sensors 
(typically 2nd or 5th order) to remove high frequency noise 
from the desired signal. Low pass filters perform poorly 
when the desired signal is close to the noise and 
unfortunately, that is the case when the vehicle rotational 
speed is close to the motor speed.  
A more sophisticated method to allow the speed of the 
vehicle to approach the speed of the motor is to use a 
combination of tracking notch filter and a low pass filter. 
Assuming that the motor and vehicle rotation speed don’t 
overlap for long periods, tracking the motor speed, and 
centring a notch filter on the motor speed may provide a 
filter of superior performance. A low pass filter would 
remove high frequency noise outside the maximum vehicle 
dynamics. 
We developed and tested a novel method based on 
combination of the notch filter tracking the motor and the 
band pass filter tracking gyroscope measurements of the 
vehicle. This is based on the observation that if the 
gyroscope signal is approximately correct then the 
gyroscope data can be used to estimate the frequency of 
changes in the geomagnetic field directly related to the 
motion of the vehicle. We used a notch filter tracking motor 
speed (4th order Butterworth) and a band pass filter tracking 
gyroscope measurements (4th order Butterworth).  
B. Inverse filter in time domain  
The principle of inverse filter is that for periodic noise 
signals, such as generated by motors, a period of noise 
signal known not to contain the desired signal is recorded 
and applied as an inverse signal super-positioned with the 
measured signal in time domain. The expected result should 
be the desired signal with only residues of the noise 
components. This approach has been used in magnetic tape 
playback [15].  
In our application, this method has the potential of 
providing optimal results assuming that the noise is only 
dependent on the angular position of the motor’s rotor. The 
noise signal can be divided into position dependent elements 
that are stored in a look up table. Each element corresponds 
to a small arc of the motors motion; as the motor rotates, 
successive elements in the table are used to provide a 
correction. As this method requires accurate position of the 
rotor, an optical encoder is added to the motor. The encoder 
used for experiments generates a signal twice every 1/800th 
of a rotation (two edges, spaced apart by 1/1600th of a 
rotation). This signal is used to estimate the position of the 
rotor and to step to the next element in the look up table. 
 
 
                          Figure 6. Inverse filter structure      
The design shown in Figure 6 is the core of the filter. 
The index is the current lookup location, Din is the sensor 
input and Dout is the corrected output. The filter was 
implemented on an FPGA, and is optimised to make use of 
the available resources. The BRAM (Block RAM) acts as 
the look up table and is loaded with the correction values. 
 
19
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-430-5
CENICS 2015 : The Eighth International Conference on Advances in Circuits, Electronics and Micro-electronics

Half wave and Quarter wave symmetry were applied to 
reduce the BRAM usage. Symmetry requires that the index 
value needs to be folded into a subset of ranges and an 
offset is needed to shift the waveform. This makes the 
control part of the design more complex and taking into 
account the looming accuracy issue in case of asymmetry of 
the waveform, as shown in Figure 7, makes the approach 
less attractive.  
Figure 7. Waveform of half wave symmetric table 
Table 1 shows that the logic size doubles when 
symmetry is used, however as the filter is a very light 
design, the utilisation of FPGA resources is very small. 
TABLE 1. 
FPGA IMPLEMENTATION RESOURCES     
 
 
Used 
Spartan 3e500 
total available 
Logic Slices           
(no symmetry) 
33 
4656 
Logic Slices 
(symmetry) 
61 
4656 
Block Ram 
(1024x16bit) 
1 
20 
 
The throughput of the filter is very high, requiring only 5 
clock cycles to perform a correction. The correction time is 
as follows: 
 
1 cycle to load in the sensor data and index address 
 
1 cycle to convert the index address to LUT 
address 
 
1 cycle to fetch the correction from the LUT 
 
1 cycle to add the correction and sensor data 
 
1 cycle to output the result 
This filter is comparable to the simplest frequency 
domain filter (2 point window filter) in both speed and 
implementation size. Compared to the band stop/pass filters 
the implementation size is significantly smaller as it requires 
at most 3 addition operations rather than iterative addition 
and multiplication operations. Given a moderate 50HMz 
clock speed the latency is 100 nanoseconds, which is more 
than adequate for this application, where filtering in the 
range of kilohertz is required.   
IV. 
FILTER PERFORMANCE 
For all filter designs except the look up table approach, the 
frequency separation between signal and noise is important. 
The performance was compared for several conditions: 
1. “Traditional” separation that could be expected for 
most vehicles; vehicle rotation is significantly 
slower than the motor speed(Typically Fn/Fs > 10) 
2. Narrow separation where the vehicle rotation is still 
slower than the motor, but they are with in an order 
of magnitude. (10>Fn/Fs > 1) 
3. Reversed separation where the motor speed is 
slower than the vehicle rotational velocity. This 
would only likely be seen if the motor power was 
reduced to slow the vehicle (Fn/Fs < 1) 
The results in      Figure 8 show that the low pass filters 
perform poorly when vehicle and motor rotation speeds are 
close. Both the band pass and notch filters worked well.  
Their difference in performance, as shown in Figure 8, is 
explained by the fact that the notch filter handles motor 
rotations which have some variance while the band pass 
filters vehicle rotations which are much more stable due to 
larger inertia. Their main disadvantage is much larger cost 
of implementation than the inverse filter.  
The look up table based inverse filter has showed good 
performance and the exceptional performance was achieved 
with the addition of a low pass filter for filtering the f35 
component. 
Another advantage of the look up table based method is 
constant latency and linear phase delay, which would be 
     Figure 8. Results of filters at different noise to signal frequency factors 
20
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-430-5
CENICS 2015 : The Eighth International Conference on Advances in Circuits, Electronics and Micro-electronics

achievable with standard FIR filter but at much higher 
implementation cost.   
V. 
INVERSE FILTER CONSIDERATIONS 
As Figure 5 shows, the spectrum of magnetic noise from 
the motor contains high frequency component f35. In a 
straightforward approach the look up table of inverse filter 
would need to have sufficient number of samples/elements 
to cover that spectrum. A more efficient method is to 
augment inverse filter with a simple 2nd order low pass filter 
(LPF in Figure 8) to filter out that part of the spectrum.    
Results presented in Figure 8 were obtained with the 
highest resolution implemented for the inverse filter, 
however depending on the platform it may be desirable to 
decrease the number of elements in the look up table. Tables 
with 800, 400, 200, 100 and 50 element were tested to 
determine the impact.  
The results in Figure 9 show that for 800 to 200 look up 
elements the deterioration of performance is limited, while 
100 and 50 element table causes significant decrease in 
effectiveness. The x axis is the rotor position error measured 
in the number of elements miscounted by the rotor position 
encoder. The larger the number of samples, the lesser is the 
impact of the position error since the angle which each 
sample represents is smaller. FPGA BRAMs make 
implementation of look up tables very efficient, even if 
large number of elements is required.  
         Figure 9. Heading error due to rotor encoder miscounts 
Our experiments with a number of motors show 
significant variations in the rotating magnetic field patterns, 
even for the same type of motor. This is caused by 
manufacturing imperfections, demagnetisation and/or wear 
and tear. The magnets vary in strength (or over time loose 
strength at differing rates) resulting in the waveform being 
compressed for a portion of cycle and expanded for another 
portion, and the individual peaks having varying magnitude. 
The localised demagnetisation effect adds a high frequency 
component that is not instantaneously constant, when the 
motor starts.   
The above phenomena means that the look up table must 
be prepared for a specific motor and updated with the aging 
of the motor. This can be done automatically with help of an 
additional calibration module in the aircraft control system 
that is activated in the start when the vehicle is stationary.  
VI. 
CONCLUSIONS AND FUTURE RESEARCH 
We analysed and experimented with the motor induced 
noise in magnetometer measurements on board micro body 
rotate aircraft. Methods of filtering that noise were 
investigated and properties of various filters assessed for 
this application. An inverse filter in time domain, based on 
look up table principle, has been designed on FPGA. The 
filter was tested and proven to have superior performance in 
filtering signals and noise of very close frequencies. This 
filter demonstrates a small implementation cost while 
offering 
speed 
either 
matching 
or 
exceeding 
the 
performance of optimised frequency domain based filters.  
The research presented in this paper focused on steady 
state operation of the motor. This was justified as the motor 
speed of a rotary body vehicle does not vary significantly 
during operation. However for some applications where the 
motor speed need to change rapidly, further research is 
needed to assess applicability of our filtering method. 
A possible application of our research is also for 
assessing the health of a motor by monitoring the spectrum 
of motor induced noise in magnetometer readings. It has 
been demonstrated that as a motor ages or is subjected to 
high loads, the localised demagnetisation increases, 
changing its noise spectrum. This relationship could be 
possibly used to estimate the health of the motor. 
 
REFERENCES 
[1]  W. Pearce, “Papin-RouillyGyropter(Gyropter)”.  [Online]. Available 
from:https://oldmachinepress.wordpress.com/2012/09/06/papin-
rouilly-gyroptere-gyropter/ . [Retrieved  03/06/2015] 
[2] K. Fregene and C. L. Bolden, “Dynamics and Control of a 
Biomimetic Single-Wing Nano Air Vehicle”, 2010 American Control 
Conference Marriott Waterfront, Baltimore, MD, USA, June 30-July 
02, 2010, pp51-56. 
[3] S. M. Jameson, B. P. Boesch, and E. H. Allen, “Active maple seed 
flyer”, United States of America Patent US7766274 B1, Lockheed-
Martin, Aug3, 2010.   
[4] E. R. Ulrich, D. J. Pines, and J. S. Humbert, “From Falling to Flying: 
The Path to Powered Flight of a Robotic Samara Nano Air Vehicle,” 
Bioinspiration and Biomimetics, Vol. 5, No. 4, 2010, pp 3-16. 
[5] Pounds P. and Singh S. “Samara: Biologically inspired self-deploying 
sensor networks”, IEEE Potentials, Vol 34, No.2, 2015, pp10—14.  
[6] C. Hockley and B. Butka, “The Samareye:  A Biologically Inspired 
Autonomous Vehicle,” in Digital Avionics Systems Conference, Salt 
Lake City, Oct. 2010, pp 5.C.1-1 - 5.C.1-9.  
[7] H. Youngren, S. Jameson, and B. Satterfield “Design of the 
SAMARAI 
Monowing 
Rotorcraft 
Nano 
Air 
Vehicle,” 
[Online].Available from: http://www.atl.lmco.com/papers/1628.pdf. 
[Retrieved 14/04/2015]. 
[8] A.R.S. Bramwell, G. Done, and D. Balmford, “Bramwell's Helicopter 
Dynamics”, Butterworth-Heinemann, 2001.   
21
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-430-5
CENICS 2015 : The Eighth International Conference on Advances in Circuits, Electronics and Micro-electronics

[9] Microsemi User Guide, “Field Oriented  Control  of  Permanent  
Magnet  Synchronous  Motors”. [Online]. Available from: 
http://www.microsemi.com/document-portal/doc_view/130909-sf-
foc-pmsm-hall-ug  [Retrieved 03/06/2015 
[10] G. H. Jang, J. H. Chang, D. P. Hong, and K. S. Kim “Finite-Element 
Analysis of an Electromechanical Field  of  a  BLDC  Motor  
Considering  Speed  Control  and  Mechanical  Flexibility,”  IEEE 
Transactions On Magnetics, vol. 38, no. 2, 2002, pp. 945-948.   
[11] N. Bianchi, S. Bolofa, and F. Luise, “Analysis  and  design  of  a  
brushless  motor  for  high  speed operation,” in Electric Machines 
and Drives Conference, Madison, Wisconsin, 2003, pp-44-5.  
[12] J. Rais and M.P. Donsión, “Permanent Magnet Synchronous Motors 
(PMSM). Parameters influence on the synchronization process of a 
PMSM,” International Conference Renewable Energies and Power 
Quality (ICREPQ'8), pp.409, Santander, March 2008  
[13] M. Ooshima, S. Miyazawa, A. Chiba, F. Nakamura, and T. Fukao “A 
Rotor Design of a Permanent Magnet-Type Bearingless  Motor  
Considering  Demagnetization,”  in  Power  Conversion  Conference, 
Naqaoka, 1997, pp-655-660. 
[14]  S. Touati, R. Ibtiouen, O. Touhami, and A. Djerdir “Experimental 
investigation and optimisation of permanent magnet  motor based on 
coupling boundry element  method with permeances network,” 
Progress in Electromagnetics Research, vol. 111, no. -, pp. 71-90, 
[15] R. W. Kruppa, “Method, and apparatus and article of manufacture for 
filtering periodic noise from a magnetic read head”. United States of 
America Patent 5,887,075, 23 March 1999. 
 
22
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-430-5
CENICS 2015 : The Eighth International Conference on Advances in Circuits, Electronics and Micro-electronics

