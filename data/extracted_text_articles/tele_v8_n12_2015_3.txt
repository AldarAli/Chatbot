25
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
IQ Imbalance in Heterodyne Transceivers with
zero-second-IF for Wide-Band mmW Links
Ainhoa Rezola∗†, Juan Francisco Sevillano∗†, Martin Leyh‡, Moises Lorenzo‡, Roc Berenguer∗†,
Aharon Vargas‡ and Igone V´elez∗†
∗Electronics and Communications Department,
Centro de Estudios e Investigaciones T´ecnicas (CEIT), 20018 San Sebasti´an, SPAIN
Email: {argarciandia,jfsevillano,rberenguer,ivelez}@ceit.es
†Electrical, Electronic and Control Engineering Department,
Technology Campus of University of Navarra (TECNUN), 20018 San Sebasti´an, SPAIN
‡Fraunhofer Institute for Integrated Circuits (IIS), D-91058 Erlangen, Germany
Email: {martin.leyh,moises.lorenzo,aharon.vargas}@iis.fraunhofer.de
Abstract—Millimeter wave links are an attractive solution for
mobile network backhaul. In order to cope with the requirements
of future networks, these millimeter wave links should achieve
Gigabit data rates. These data rates can be achieved by using
wide-band and high order modulations in E-Band. Heterodyne
architectures are good candidates for integrated transceivers, but,
the design of integrated transceivers at these frequencies is a
challenging issue. An important source of degradation is I/Q
imbalance, which can signiﬁcantly reduce the performance of a
communication system with zero-second-IF transceivers if it is
not appropriately compensated. The article analyzes the source
of this IQ imbalance and proposes the use of different digital
processing techniques, including a linear adaptive equalizer
scheme. The performance of the transceiver is analyzed at system
level by means of simulations. The results presented in the article
suggest that the use of those techniques is able to mitigate the
impact of the IQ imbalance effects, in order to allow the use of
a high-order modulation such as 64QAM.
Index Terms—Mobile backhaul; millimeter-wave; transceivers;
RF impairments.
I. INTRODUCTION
The growing demand for ubiquitous broadband communi-
cation, e.g., fourth-generation (4G) wireless, has motivated the
deployment of ultra high-speed communication systems. Par-
ticularly in backhauling networks, optical ﬁber is required to
transport very high data rates. However, optical ﬁber exhibits
important drawbacks, such as high costs, long deployment
times, and low ﬂexibility. Recently, point-to-point wireless
communication systems have been proposed as an attractive
alternative to optical ﬁber. In order to achieve data rates that
are comparable to optical ﬁber, these communication systems
demand very high bandwidth in order to transport enough data.
Although the frequency spectrum is congested, the regula-
tion of the E-band, which is around 80 GHz, facilitates the
deployment of high-speed communication systems in which
a huge amount of data can be transmitted. The European
Telecommunications Standards Institute (ETSI) is carrying out
a standardization process for this frequency band [1], [2], [3].
Commercial off-the-shelf communication systems operating
in the E-band support data rates of up to 2.5 Gbit/s. However,
new applications demand even higher data rates (around 10
Gbits/s), which necessitates both wide-band and high-order
modulations to utilize the spectrum efﬁciently. High band-
widths and higher-order modulation waveforms pose special
challenges for communication systems offering reliable links
at very high data rates. The digital base-band must be able
to encode/decode and modulate/demodulate a huge amount
of information while employing high efﬁciency algorithms
to guarantee reliable communications. In addition, analog-
to-digital converters (ADCs) and digital-to-analog converters
(DACs) must work at very high sampling rates. Furthermore,
higher order modulations are desirable to boost up the data
rate, requiring higher carrier-to-interference (C/I) ratios at the
receiver. This involves carefully analyzing the degradation
effects introduced by the analog RF impairments and evaluat-
ing the corresponding compensation algorithms in the digital
baseband processing [4].
In this article we focus on the IQ imbalance impairment,
which is one of the performance-critical effects of interest
in zero-second-IF transceiver architectures. This impairment,
caused by mismatches in the amplitude and phase responses
of the I and Q signal paths, entails a degradation in the Image
Rejection Ratio (IRR), which is theoretically inﬁnite and
causes interfering images at mirror frequencies. IQ imbalance
encountered in narrow-band systems can be regarded as non-
frequency-selective (NFS), and it is mainly caused by the local
oscillators used for quadrature modulation or demodulation.
However, IQ imbalance in wide-band systems may also exhibit
frequency-dependent or frequency-selective (FS) behavior due
to mismatches between the analog ﬁltering paths of the I and
Q components caused by ﬁnite tolerances [5] [6].
The article analyzes the impact of both non-frequency-
selective and frequency-selective imbalances in the transmitted
and received signal. In addition, different options for miti-
gating the NFS and FS IQ imbalance are described. These
techniques, based on digital signal processing, are evaluated
in a 64-QAM transceiver operating with a signal bandwidth
of 2GHz.
The remainder of this article is structured as follows.
Section II provides a description of the system architecture.

26
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Section III introduces the NFS IQ imbalance issue, identifying
and modeling the source of this impairment. The mitigation
of the IQ imbalance impairment by digital signal processing
at the receiver is also described in this section. In Section IV,
a simulation model for the transceiver system, including the
proposed mechanisms for reducing NFS IQ imbalance, is pre-
sented and analyzed. In Section V, the FS IQ imbalance issue
is addressed and in Section VI the simulation results regarding
this impairment are presented. Finally, some conclusions are
drawn in Section VII.
II. SYSTEM ARCHITECTURE
In order to address new applications for the future backhaul-
ing networks, a point-to-point microwave link in the E-Band
using a 64-QAM modulation with a signal bandwidth of 2GHz
is considered. Fig. 1 shows the proposed transceiver (TRx)
architecture for a point-to-point microwave link in the E-Band.
As shown, the transmitter (Tx) front-end consists of an IQ up-
converting modulator that up-converts the baseband I and Q
channels to an intermediate frequency (IF). After combining
the I and Q channels, the IF signal is up-converted by means
of the millimeter-wave (mmW) mixer. Finally, the wideband
mmW power ampliﬁer (PA) is used to amplify and transmit
the mmW signal. The receiver (Rx) front-end consists of a
wideband Low Noise Ampliﬁer (LNA), which receives and
ampliﬁes the signal at the E-Band. After the LNA, a ﬁrst mixer
down-converts the mmW signal to the same IF as in the Tx.
This way, the same PLL can be re-used for the Tx and the
Rx. Finally, an IQ demodulator down-converts the IF signal
to 0-Hz.
This architecture presents a good balance between different
design aspects, and it enables the minimization of the sampling
frequency of the digital-to-analog (DAC) and analog-to-digital
(ADC) converters. Nowadays, we can ﬁnd commercial DACs
and ADCs able to provide sampling rates close to 3Gsps,
which is enough for practical implementation of the zero-
second-IF architecture.
Due to the high channel bandwidth (higher than 2 GHz),
the architecture depicted in Fig. 1 presents a good balance
between the DAC and the ADC requirements and complexity
on the transceiver. The use of other architectures, such as non-
zero-second-IF would require very high performance ADCs
or DACs, with sampling rates well above 4 Gsps to achieve
a practical implementation of base-band and image rejection
ﬁlters in the analog front-end. Other IF architectures, for
example [7], relax the performance of the ADCs and DACs by
using several sub-bands, but it is at the expense of increasing
the complexity of the baseband and IF sections of the front-
end of the transceiver.
However, the use of a zero-second-IF architecture presents
well-known issues that should be addressed in order not to
degrade the performance of the transceiver. This architecture is
subject to corruption due to IQ imbalances at both the transmit-
ter quadrature modulator and at the receiver demodulator . The
resulting system performance degradation can be signiﬁcant,
especially for high-order modulation schemes [8].
III. NON-FREQUENCY-SELECTIVE IQ IMBALANCE
A. Imbalance analysis
The goal of the IQ modulator in Fig. 1 is to perform a
frequency translation of the signal. That is, if the base-band
input signal to the IQ modulator is
˜s(t) = sI(t) + jsQ(t),
(1)
where sI(t) is the signal in the I-datapath and sQ(t) is the
signal in the Q-datapath, a perfect IQ modulation mixes the
base-band input signal with
ltx(t) = ejωtxt = cos(ωtxt) + j sin(ωtxt)
(2)
producing an output signal
s(t) = Re [˜s(t)ltx(t)] = sI(t) cos(ωtxt) − sQ(t) sin(ωtxt).
(3)
However, when implementing an IQ modulator with actual
electronic circuits, the signals produced by the local oscillator
(LO) will present some difference in their amplitudes and
will not have a phase difference of π/2. The effect of this
imbalance can be modeled as the mixing of the base-band
input signal with
ltx(t) = cos(ωtxt) + jgtx sin(ωtxt + φtx)
(4)
to yield the output signal
s(t) = (sI(t) − gtx sin(φtx)sQ(t)) cos(ωtxt)
(5a)
− sQ(t)gtx cos(φtx) sin(ωtxt).
(5b)
In IQ imbalance analyses, it is common to rewrite the signal
produced at the transmitter LO with the imbalance from
equation (4) in the form of [9]
ltx(t) = C1ejωtxt + C2e−jωtxt,
(6)
with
C1 = 1 + gtxejφtx
2
(7a)
C2 = 1 − gtxe−jφtx
2
(7b)
and the transmitted signal is
s(t) = Re

˜s(t)

C1ejωtxt + C2e−jωtxt
.
(8)
In (8), the desired term is the one multiplied by ejωtxt and the
term multiplied by e−jωtxt is considered an undesired image.
Equation (8) can be rewritten as
s(t) = 1
2

C1˜s(t)ejωtxt + C∗
1 ˜s∗(t)e−jωtxt
(9a)
+ 1
2

C∗
2 ˜s∗(t)ejωtxt + C2˜s(t)e−jωtxt
,
(9b)
where (·)∗ denotes the complex conjugate.
Let X(ω) denote the Fourier Transform of a signal x(t),
then from (9) we have
S(ω) = 1
2

C1 ˜S(ω − ωtx) + C∗
1 ˜S∗(ω + ωtx)
(10a)
+ C∗
2 ˜S∗(ω − ωtx) + C2 ˜S(ω + ωtx)).
(10b)
Fig. 2 illustrates the spectrum of s(t). The ﬁrst line in (10)
is the desired term and the second line is an image that is an

27
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org




	

	






	





	



(t)
s
(t)
r






	



	

(t)
sI
(t)
sQ
(t)
rQ
(t)
rI
Fig. 1. Architecture of the transceiver.
~( )
2
1
2
S f
C
f
~( )
2
1
*
2
S f
C
~( )
2
1
1
S f
C
( f )
S
( )
2
1
*
*
1
f
S
C
Fig. 2. Spectrum of s(t) with imbalance.
alias of the desired signal. A measure of performance of the
IQ modulator is the image rejection factor (IRR)
IRRtx = |C1|2
|C2|2 = 1 + g2
tx + 2gtx cos(φtx)
1 + g2
tx − 2gtx cos(φtx).
(11)
Similarly, the task of the Rx IQ demodulator in Fig. 1 is to
mix the input signal with
lrx(t) = e−jωrxt = cos(ωrxt) − j sin(ωrxt),
(12)
so that after low-pass ﬁltering, the base-band equivalent of the
signal in the frequency band of interest ˜z(t) = zI(t) + jzQ(t)
is obtained. Note that ˜z(t) is the base-band equivalent that is
referred to a carrier frequency ωrx. The current implementation
of the IQ demodulator will introduce similar imbalances to
the actual implementation of the IQ modulator, which can be
modeled as the mixing of r(t) with
lrx(t) = cos(ωrxt) − jgrx sin(ωrxt + φrx).
(13)
The signal at the output of the IQ demodulator after low-pass
ﬁltering can be written as [9]
˜r(t) = rI(t) + jrQ(t) = K1˜z(t) + K2˜z∗(t)
(14)
with
K1 = 1 + grxe−jφrx
2
(15a)
K2 = 1 − grxejφrx
2
.
(15b)
In this case, the ﬁrst term in the sum of (14) is the desired
term and the second one is the image that aliases on the desired
signal. The IRR for the IQ demodulator is deﬁned as
IRRrx = |K1|2
|K2|2 = 1 + g2
rx + 2grx cos(φrx)
1 + g2rx − 2grx cos(φrx).
(16)
Note that the above model for impairment affects to the
whole information bearing signal in the same way. Although
the model has been developed from the point of view of the
local oscillators of the IQ modulator and demodulator, it can
also be used to include the mean imbalances between the in-
phase and quadrature datapaths.
In order to gain some insight, we assume enough linearity
and proper ﬁltering in the remaining stages of the transmitter
and receiver analog chain and noise-less operation. Using (9),
it can be seen that
˜z(t) = (C1˜s(t) + C∗
2 ˜s∗(t)) ej(Δωt+θ)
(17)
where Δω and θ account for the overall carrier frequency and
phase offset between the transmitter and the receiver. Thus,
we have
˜r(t) = K1C1˜s(t)ej(Δωt+θ)
(18a)
+ K1C∗
2 ˜s∗(t)ej(Δωt+θ)
(18b)
+ K2C∗
1 ˜s∗(t)e−j(Δωt+θ)
(18c)
+ K2C2˜s(t)e−j(Δωt+θ)
(18d)
The desired term in (18) is the one in the ﬁrst line and the

28
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
terms in the second to fourth lines represent undesired images
at the receiver due to transmitter and receiver IQ imbalances.
When Δω = 0, (18) simpliﬁes to
˜r(t) = J1˜s(t) + J2˜s∗(t)
(19)
where J1 and J2 are constants given by
J1 = K1C1ejθ + K2C2e−jθ
(20a)
J2 = K1C∗
2ejθ + K2C∗
1e−jθ.
(20b)
Comparing (19) with (14), it can be concluded that when
Δω = 0, the effect observed at the output of the receiver’s IQ
demodulator due to the IQ imbalance introduced at the trans-
mitter is the same as the one due to an IQ imbalance introduced
by the IQ demodulator. In a real transmission system there will
be some carrier frequency offset between the transmitter and
the receiver. However, the former observation suggests that the
IQ imbalance introduced at the transmitter may be addressed
after carrier frequency recovery using approaches designed to
address the IQ imbalance introduced at the receiver.
B. Imbalance compensation
1) Tx IQ Imbalance Compensation: Using (1) and (3) with
˜s′(t) = s′
I(t)+js′
Q(t) denoting the equivalent baseband signal
of the Tx IQ distorted signal s(t) with respect to the transmitter
carrier frequency ωtx, we can derive the following matrix
equation for Tx IQ imbalance distortion:
s′
I(t)
s′
Q(t)

=
1
−gtx sin(φtx)
0
gtx cos(φtx)
 sI(t)
sQ(t)

.
(21)
If the matrix in (21) is invertible (gtx ̸= 0 and φtx ̸=
±π/2), which is the case in practical cases, the Tx NFS
IQ compensation can ideally be achieved by performing a
digital predistortion based on the inverse operation. In this
case, we feed the IQ modulator with the predistorted signal
ς(t) = ςI(t) + jςQ(t), which is obtained as
ςI(t)
ςQ(t)

=
1
tan(φtx)
0
1/(gtx cos(φtx))
 sI(t)
sQ(t)

.
(22)
Compensation by inverse transformation requires knowledge
of the gain and phase imbalance values, gtx and φrx.
Techniques for compensating the IQ imbalance at the trans-
mitter that have been proposed in the literature use tones
as test signals (e.g.,
[10], [11], [12], [13]) or even from
random data (e.g., [11], [14]). Compensating by using test
tones is very powerful and can be used for initial calibration.
During normal full-duplex operation of the transceiver, IQ
imbalance compensation from the random transmitted data
would be preferred. All these techniques of compensation
require additional circuitry (including an extra ADC) at the
transmitter to feed back measurements performed in the analog
front-end.
Under certain conditions the Tx IQ imbalance can also
be compensated in the receiver (see [9]). For this to be
possible, the spectral images caused by the Tx IQ imbalance
have to be emitted and a carrier frequency offset between
transmitter and receiver is required to be able to decouple
the Tx and Rx IQ imbalance effects in the receiver [15],
[16]. As these conditions are fulﬁlled in the analyzed system,
receiver-based compensation for both frequency-independent
and frequency-selective Tx IQ imbalance is the approach
investigated in this article, because it does not require any
additional circuitry in the analog front-end of the transceiver
and all the compensation can be performed by digital signal
processing.
2) Rx IQ Imbalance Compensation: The down-converted
complex-valued base-band signal ˜r(t) can be written as a
function of ˜z(t) using the following matrix equation

rI(t)
rQ(t)

=

1
0
−grx sin(φrx)
grx cos(φrx)
 
zI(t)
zQ(t)

.
(23)
In case the matrix in (23) is invertible (grx ̸= 0 and
φrx ̸= ±π/2), which is the case in practical cases, the Rx
IQ imbalance can be ideally compensated by performing the
inverse operation

αI(t)
αQ(t)

=

1
0
tan(φrx)
1/(grx cos(φrx))
 z′
I(t)
z′
Q(t)

,
(24)
where α(t) = αI(t) + jαQ(t) is the output of the Rx IQ
imbalance compensator and ideally would yield the desired
baseband signal ˜z(t). Compensation by inverse transformation
requires knowledge of the gain and phase imbalance values
grx and φrx, which can be derived by using statistics and the
correlation properties of the I and Q signals as proposed in
[17].
IV. NFS IQ IMBALANCE SIMULATION RESULTS
A. System Model
The system model depicted in Fig. 3 constitutes the basis
for the simulations of the impact of Tx and Rx IQ imbalance
impairments and their respective compensation algorithms on
the performance of the E-band transceiver.
Random data information is generated as a sequence of IQ
symbols, D, by using a 64QAM mapper. D is then ﬁltered
through an appropriate root-raised-cosine (RRC) ﬁlter to create
a pulse-shaped base-band signal, x(t). The Tx Baseband
Filtering and Mixing models the data processing as shown in
Fig. 1. There is the option of employing Tx IQ predistortion
to mitigate the NFS Tx IQ imbalance, but for the purposes of
this paper, this block will be deactivated.
Considering an additive white Gaussian noise (AWGN)
channel, the signal ˜z at the output of the channel model is
given by:
˜z(t) = ˜s(t) · ej2πft + n(t),
(25)
where ˜z(t) is the low-pass equivalent of the transmitted signal,
˜s(t) is the transmitted signal and ej2πft represents the carrier
frequency offset (CFO), with f as the frequency offset. This
CFO is produced by the difference between the oscillators
of the transmitter and receiver. Finally, n(t) corresponds to a
complex-valued white Gaussian noise process.
On the receiver side, the Rx Baseband Filtering and Mixing
models the receiver analog front-end structure shown in Fig. 1,
including Rx IQ imbalance. NFS IQ Imbalance Compensation

29
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Symbol
Generation
AWGN
D
x
NFS IQ Imbalance compensation
'¶
Tx Pulse
Shaping
(RRC)
Tx Baseband
Filtering &
Mixing
Carrier
Frequency
Offset (CFO)
Rx Baseband
Filtering &
Mixing
Rx NFS IQ
Compensation
CFO Correction
Rx-based
Tx NFS IQ
Compensation
Matched Filter
(RRC)
FS IQ
Compensation
(Equalizer)
s
n
Freq.
offset
f
C
Į
ȕ
ȕ'
~
r~
Tx IQ
Predistortion
xpre
z~
Fig. 3. System Model for IQ Imbalance Simulations.
is performed prior to matched ﬁltering by following a multi-
stage approach that compensates for both Tx and Rx IQ
Imbalance:
1) The ﬁrst stage compensates for the Rx NFS IQ imbalance
based on the algorithms in Section III-B.
2) A CFO correction stage ideally compensates the CFO in-
troduced by the difference of the transmitter and receiver,
using the relation β(t) = α(t) · e−i2πft
3) A third stage performs Tx NFS IQ imbalance compen-
sation prior to the matched ltering by re-applying the
algorithms in Section III-B .
After NFS IQ Imbalance Compensation the signal is ﬁltered
with a matched RRC ﬁlter. The equalizer used to compensate
the FS IQ imbalance is ignored in this section (i.e., D′ = C).
The received symbols D’ are compared with the transmitted
symbols D to quantify the performance of the whole system.
B. NFS IQ Imbalance results
Fig. 4(a) illustrates the effect of NFS IQ imbalance. For
illustration purposes, a noiseless transmission is considered.
Crosses correspond to the constellation where perfect trans-
mission takes places, and the dots correspond to a transmission
with IQ imbalances both at transmitter and receiver, assuming
zero carrier frequency offset. The IQ imbalances considered
were 0.5 dB and 3 degrees in gain and phase, respectively, in
the transmitter and 1 dB and 3 degrees in gain and phase,
respectively, in the receiver. The signs of the imbalances
were selected in the transmitter and the receiver so that they
combine in the worst possible distortion. Fig. 4(b) shows the
constellation at the receiver when the NFS IQ imbalance com-
pensation is active. It can be seen that the NFS IQ imbalance
compensation approach is able to remove the distortion effect
on the constellation.
Fig. 5 shows the impact of the NFS IQ imbalance in the
performance of the transceiver. The curve labeled ‘without
NFS IQ’ is the performance of the transceiver when there is no
IQ imbalance. The curve labeled ‘NFS IQ’ is the performance
of the transceiver with IQ imbalance at both transmitter
and receiver. The curve labeled ‘NFS IQ with comp’ is the
−4
−3
−2
−1
0
1
2
3
4
−4
−3
−2
−1
0
1
2
3
4
Real
Imag
(a) Without compensation
−4
−3
−2
−1
0
1
2
3
4
−4
−3
−2
−1
0
1
2
3
4
Real
Imag
(b) With compensation
Fig. 4. NFS IQ imbalance

30
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
20
21
22
23
24
25
26
27
28
29
30
31
32
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
SNR [dB]
BER
Theory
without nfsIQ
nfsIQ
nfsIQ with comp
Fig. 5. System performance in the presence of NFS IQ imbalance.
performance when the IQ imbalance compensation is active.
The NFS IQ imbalance compensation is able to reduce the
losses to a few tenths of a dB.
Fig. 6(a) illustrates the effect of NFS IQ imbalance when
there is a residual carrier frequency offset equal to Δω =
2π · 5 · 10−6/T after the CFO correction in Fig. 3, where T
is the symbol period. For proper symbol detection and Bit
Error Rate(BER) estimation, the residual carrier frequency
offset was compensated in the simulations at the input of
the receiver’s matched-ﬁlter. The ﬁgure shows the corrected
constellations after the ﬁnal residual carrier frequency offset
compensation. The transmitter’s IQ imbalance manifests itself
as rotations of the constellation around the distorted constel-
lation due to the receiver’s IQ imbalance.
Fig. 6(b) shows the constellation when the IQ compensation
algorithms are active for the same residual carrier frequency
offset. It can be seen that the distortion of the constellation has
been reduced despite some residual carrier frequency offset.
Fig. 7 shows the impact of the residual carrier frequency
offset on the performance of the NFS IQ imbalance compensa-
tion approach presented in Section III-B. The different curves
correspond to different values of the normalized residual
carrier frequency offset ΔωT/(2π). It can be seen that a
very accurate carrier frequency offset correction is needed
for proper compensation of the transmitter IQ imbalance with
residual CFO below ΔωT/(2π) = 5 · 10−6, which can be
achieved via application of state of the art coarse and ﬁne
frequency synchronization algorithms [18].
V. FREQUENCY-SELECTIVE IQ IMBALANCE
A. Imbalance analysis and models
The above analysis considers that the imbalance is constant
with frequency, and thus we talk about non-frequency-selective
IQ imbalance. Nevertheless, the elements placed in the I-
datapath and Q-datapath present dispersion in their parameters.
Therefore, there will always be a difference between the
performance of the components placed in the I-datapath and
the components placed in the Q-datapath. These dispersions
−4
−3
−2
−1
0
1
2
3
4
−4
−3
−2
−1
0
1
2
3
4
Real
Imag
(a) Without compensation
−4
−3
−2
−1
0
1
2
3
4
−4
−3
−2
−1
0
1
2
3
4
Real
Imag
(b) With compensation
Fig. 6. NFS IQ imbalance with normalized residual carrier frequency offset
ΔωT/(2π) = 5 · 10−6.
can contribute to non-frequency-selective distortion, and like-
wise to impairment due to the LOs, or to frequency-selective
distortion. For instance, Fig. 8 compares the frequency re-
sponses (magnitude and phase) of the designed passive base-
band ﬁlters by considering typical values for the fabrication
tolerances of their components. L0C0 is the nominal case.
LpCp is the corner where inductors and capacitances have
their maximum value. LmCm is the corner where inductors
and capacitors have their minimum value. Fig. 9 shows the
difference between the two extreme corners. This kind of
mismatch between the components in the I and Q datapaths
is a frequency-selective IQ imbalance.
Fig. 10 shows the BER performance of the system obtained
from the model that compensates the non-frequency-selective
IQ imbalance, but does not correct the frequency-selective
mismatch. The FS IQ imbalance is considered at both the
transmitter and the receiver sides of the transceiver. The curve
labeled ‘IbbﬁltL0C0, QbbﬁltL0C0’ represents the nominal

31
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
20
21
22
23
24
25
26
27
28
29
30
31
32
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
SNR [dB]
BER
0
1e−6
5e−6
1e−5
5e−5
Fig. 7.
Performance of NFS IQ imbalance compensation approach for
different values of ΔωT/(2π).
0
0.5
1
1.5
2
2.5
−45
−40
−35
−30
−25
−20
−15
−10
−5
0
GHz
dB
Ltt0Ctt0
LttpCttp
LttpCttm
LttmCttp
LttmCttm
(a) Magnitude variation
0
0.5
1
1.5
2
2.5
3
−350
−300
−250
−200
−150
−100
−50
0
GHz
degrees
Ltt0Ctt0
LttpCttp
LttpCttm
LttmCttp
LttmCttm
(b) Phase variation
Fig. 8. Variation of frequency response of base-band ﬁlters.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−0.06
−0.05
−0.04
−0.03
−0.02
−0.01
0
GHz
dB
(a) Magnitude variation
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−6
−5
−4
−3
−2
−1
0
GHz
degrees
(b) Phase variation
Fig. 9. Frequency response of base-band ﬁlters in extreme corners.
case, i.e., the case without FS IQ imbalance. The curve labeled
‘IbbﬁltLpCp, QbbﬁltLmCm’ is the case in which an LpCp
base-band ﬁlter has been considered in the I-datapath and an
LmCm base-band ﬁlter has been chosen for the Q-datapath in
the transmitter and the receiver. From the BER performance
it can be concluded that the loss due to FS IQ imbalance
signiﬁcantly degrades the performance of the system, since
for a BER of 10−6 in the case of uncoded 64QAM, a loss of
more than 2dB is shown.
In the literature more articles focusing on the modeling
and compensation of non-frequency-selective IQ imbalance
can be found. However, this approach has become insufﬁcient
as the use of wider bandwidth signals has become more
prevalent. Therefore, as we can conclude from Fig. 10, for
wide bandwidth signals the above technique for compensating
for the non-frequency-selective IQ imbalance is generally
insufﬁcient, as the IQ imbalance is likely to be frequency-
dependent.
The frequency-dependent imbalances of the quadrature mix-
ing front-end may include contributions from the DAC/ADC,
low-pass ﬁlters, as well as the signal paths themselves. To for-
mally analyze the detrimental effect of these IQ mismatches,

32
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
20
21
22
23
24
25
26
27
28
29
30
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
SNR [dB]
BER
Theory
IbbfiltL0C0, QbbfiltL0C0
IbbfiltLpCp, QbbfiltLmCm
Fig. 10. System performance in the presence of FS IQ imbalance..
s(t)
gtx sin(Ȧtxt +ࢥtx)
cos(Ȧtxt)
Hnom,tx
DAC
DAC
Tx
DBB
xI
xQ
Hnom,tx
sI
sQ
Fig. 11. Tx IQ Imbalance Model.
the combined effect can simply be modeled as a pair of two
imbalanced base-band ﬁlters. The models depicted in Fig. 11
and Fig. 12 have been devised as a basis for the development
of algorithms for Tx and Rx IQ imbalance compensation.
For Tx IQ imbalance in Fig. 11 the ﬁlters Hnom,tx(f) are
assumed to be ideal low-pass ﬁlters with Hnom,tx(f) = 1
for |f| ≤ Btx/2 and Hnom,tx(f) = 0 for |f| > Btx/2,
where Btx is the bandwidth of the transmitted signal of
interest. In analyzing NFS IQ imbalance, these ﬁlters are
assumed to be virtually ineffective. The ﬁlters HI,tx(f) and
HQ,tx(f) are modeling frequency-dependent or frequency-
selective mismatches between the I and Q path, as shown in
Fig. 8 and Fig. 9.
The corresponding model for Rx IQ imbalance is depicted
in Fig. 12 (see also [19], [6]). The ﬁlters Hnom,rx(f) are
assumed to be ideal low-pass ﬁlters with Hnom,rx(f) = 1
for |f| ≤ Brx/2 and Hnom,rx(f) = 0 for |f| > Brx/2,
where Brx is the bandwidth of the received signal of interest.
Similar to the TX IQ imbalance model in Fig. 11, the ﬁlters
HI,rx(f) and HQ,rx(f) are modeling frequency-dependent or
frequency-selective mismatches between the I and Q paths.
r(t)
- grx sin(Ȧrxt +ࢥrx)
cos(Ȧrxt)
Hnom,rx
ADC
ADC
Rx
DBB
zI
¶
zQ
¶
Hnom,rx
Fig. 12. Rx IQ Imbalance Model.
B. Frequency-Selective IQ Imbalance Compensation
Methods for compensating Rx FS IQ imbalance are reported
in [6], [5]. In [6], an adaptive ﬁlter is employed to perform
interference cancellation. In [5], a simpliﬁed compensation
method, based on mean values of the FS IQ imbalance, is
presented. However, this method assumes prior knowledge of
the mean values over frequency for the frequency-selective
part of the amplitude and phase imbalances.
In this article, a linear adaptive equalizer (LAE) is deployed
for the FS IQ imbalance compensation as shown in the system
model in Fig. 3. In addition to NFS IQ Imbalance compen-
sation analyzed in Section IV-B, the LAE is activated as the
ﬁnal stage in performing compensation of FS IQ imbalance
after matched ﬁltering. The LAE performs linear ﬁltering
of the Matched Filter output as deﬁned by (26). The LAE
facilitates FS IQ compensation without prior knowledge of
the frequency responses of frequency-selective amplitude and
phase imbalances. The L coefﬁcients wi in (26) are calculated
and adapted based on known symbol sequences in the data
stream using the Least Mean Square (LMS) algorithm. For
the following simulations an equalizer length of L = 15 is
used.
D′[k] =
L−1
	
i=0
wiC[k − i].
(26)
The system performance in terms of FS IQ Imbalance
distortion is evaluated in terms of residual carrier-to-distortion
ratio after the LAE is deﬁned by the relation
C
ISI =
E

|D|2
E

|D − D′|2,
(27)
where E

|D|2
is the energy of the transmitted signal
D and E

|D − D′|2
denotes the energy of the received
signal error, i.e., distortion caused by residual inter-symbol-
interference (ISI) and image interference. Simulation results
are provided in Section VI.

33
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
(a) Without equalizer
(b) With equalizer
Fig. 13. Signal Constellations (64QAM)
VI. FS IQ IMBALANCE SIMULATION RESULTS
Fig. 13 shows the constellation diagrams for 64QAM after
the RRC matched ﬁlter and the equalizer, respectively. The
circles in the diagrams correspond to the ideal constellation
points. When comparing Fig. 13(a) with Fig. 13(b) the reduc-
tion in residual distortion achieved by the equalizer can be
observed.
For a BER of 10−6 in the case of uncoded 64QAM a
C/(I+ISI) = 26.54 dB is required at the input to the demap-
per, which corresponds to the output of equalizer D’. Table I
summarizes the performance for different transmit and receive
ﬁlter pairs based on the frequency responses shown in Fig. 8
and Fig. 9. Simulations 1 to 3 have been run with identical
ﬁlters for both quadrature components in the transmitter and
receiver. The residual ISI is in the range of 38 dB. Simulations
4 to 9 have been run with imbalanced quadrature ﬁlters.
The FS IQ imbalance, i.e., the difference between frequency
responses, is most severe in simulations 4 and 5, where the
corner cases LpCp and LmCm for the tolerances concerning
the frequency responses have been used. The residual ISI after
the equalizer is reduced below levels where 64QAM can be
decoded. For less severe ﬁlter imbalances, as in simulations 6
to 9, the residual ISI is about 4 to 5 dB better.
TABLE I
FS IQ IMB. PERFORMANCE
HI,tx(f)
HQ,tx(f)
HI,rx(f)
HQ,rx(f)
C/ISI [dB]
1
L0C0
L0C0
L0C0
L0C0
38.5
2
LpCp
LpCp
LpCp
LpCp
38.4
3
LmCm
LmCm
LmCm
LmCm
37.8
4
LpCp
LmCm
LpCp
LmCm
27.1
5
LmCm
LpCp
LmCm
LpCp
29.0
6
LpCp
L0C0
LpCp
L0C0
31.9
7
L0C0
LpCp
L0C0
LpCp
34.6
8
LmCm
L0C0
LmCm
L0C0
34.7
9
L0C0
LmCm
L0C0
LmCm
34.6
VII. CONCLUSION
In this article, a theoretical analysis of the IQ imbalance
in a heterodyne transceiver with zero-second-IF has been
presented. Digital signal processing at the receiver has been
evaluated based on a multi-stage approach for the compensa-
tion of both transmitter and receiver IQ imbalance, as well as
carrier frequency offset.
Simulation results were presented for a zero-second-IF
transceiver using 64-QAM with a signal bandwidth of 2GHz.
For NFS IQ imbalance, the simulation results show that
receiver-based Tx IQ imbalance compensation can be achieved
with negligible degradation in overall system performance.
This is achieved when accurate frequency synchronization
is performed in the receiver such that the residual carrier
frequency offset is reduced below speciﬁed limits. For FS IQ
imbalance, simulation results have demonstrated that FS IQ
imbalance can be mitigated by a receiver-based compensation
concept based on linear equalization.
ACKNOWLEDGMENT
The research leading to these results has received funding
from the European Community’s FP7/2007-2013 Framework
Programme under grant agreement no. 317957. Consortium:
CEIT, Fraunhofer IIS, Alcatel-Lucent, CEA-Leti, IXYS, Sili-
con Radar, ST, Sivers IMA, OTE.
REFERENCES
[1] A. Rezola, J. Sevillano, R. Berenguer, I.Velez, M. Leyh, M. Lorenzo, and
A. Vargas, “Non-frequency-selective i/q imbalance in zero-if transceivers
for wide-band mmw links,” in The Tenth International Conference on
Wireless and Mobile Communications ICWMC, 2014, pp. 136–141.
[2] Fixed Radio Systems; Characteristics and requirements for point-
to-point equipment and antennas; Part 1: Overview and system-
independent common characteristics, ETSI EN 302 217-1, Sept. 2012.
[3] Fixed Radio Systems; Characteristics and requirements for point-to-
point equipment and antennas; Part 2-2: Digital systems operating in
frequency bands where frequency co-ordination is applied; Harmonized
EN covering the essential requirements of article 3.2 of the R&TTE
Directive, ETSI EN 302 217-2-2, Sept. 2012.
[4] G. Fettweis, M. Lohning, D. Petrovic, M. Windisch, P. Zillmann, and
W. Rave, “Dirty RF: a new paradigm,” in Personal, Indoor and Mobile
Radio Communications, 2005. PIMRC 2005. IEEE 16th International
Symposium on, vol. 4, 2005, pp. 2347–2355 Vol. 4.
[5] M. Mailand, R. Richter, and H.-J. Jentschel, “IQ-imbalance and its
compensation for non-ideal analog receivers comprising frequency-
selective components,” Advances in Radio Science, vol. 4, pp. 189–195,
Sept. 2006.

34
International Journal on Advances in Telecommunications, vol 8 no 1 & 2, year 2015, http://www.iariajournals.org/telecommunications/
2015, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
[6] M. Valkama, M. Renfors, and V. Koivunen, “Compensation of
frequency-selective i/q imbalances in wideband receivers: models and
algorithms,” in Wireless Communications, 2001. (SPAWC ’01). 2001
IEEE Third Workshop on Signal Processing Advances in, 2001, pp. 42–
45.
[7] V. Dyadyuk, J. Bunton, J. Pathikulangara, R. Kendall, O. Sevimli,
L. Stokes, and D. Abbott, “A multigigabit millimeter-wave communica-
tion system with improved spectral efﬁciency,” Microwave Theory and
Techniques, IEEE Transactions on, vol. 55, no. 12, pp. 2813–2821, Dec
2007.
[8] B. Razavi, “Design considerations for direct-conversion receivers,” Cir-
cuits and Systems II: Analog and Digital Signal Processing, IEEE
Transactions on, vol. 44, no. 6, pp. 428–435, Jun 1997.
[9] L. Antilla, “Digital Front-End Processing with Widely-Linear Signal
Models in Radio Devices,” Ph.D. dissertation, Tampere University of
Technology, 2011.
[10] J. Cavers and M. Liao, “Adaptive compensation for imbalance and offset
losses in direct conversion transceivers,” Vehicular Technology, IEEE
Transactions on, vol. 42, no. 4, pp. 581–588, Nov 1993.
[11] J. Cavers, “New methods for adaptation of quadrature modulators and
demodulators in ampliﬁer linearization circuits,” Vehicular Technology,
IEEE Transactions on, vol. 46, no. 3, pp. 707–716, Aug 1997.
[12] A. Nassery, S. Byregowda, S. Ozev, M. Verhelst, and M. Slamani,
“Built-in-self test of transmitter i/q mismatch using self-mixing envelope
detector,” in VLSI Test Symposium (VTS), 2012 IEEE 30th, 2012, pp.
56–61.
[13] S. D’souza, F. Hsiao, A. Tang, S.-W. Tam, R. Berenguer, and M.-C.
Chang, “A 10-bit 2-gs/s dac-ddfs-iq-controller baseband enabling a self-
healing 60-ghz radio-on-chip,” Circuits and Systems II: Express Briefs,
IEEE Transactions on, vol. 60, no. 8, pp. 457–461, Aug 2013.
[14] X. Huang and M. Caron, “Efﬁcient transmitter self-calibration and
ampliﬁer linearization techniques,” in Circuits and Systems, 2007. ISCAS
2007. IEEE International Symposium on, 2007, pp. 265–268.
[15] P. Rykaczewski and F. Jondral, “Blind i/q imbalance compensation in
multipath environments,” in Circuits and Systems, 2007. ISCAS 2007.
IEEE International Symposium on, May 2007, pp. 29–32.
[16] J. de Witt and G.-J. van Rooyen, “A blind i/q imbalance compensation
technique for direct-conversion digital radio transceivers,” Vehicular
Technology, IEEE Transactions on, vol. 58, no. 4, pp. 2077–2082, May
2009.
[17] H.-J. Jentschel, “Direct conversion receivers - expectations and expe-
riences,” in RF Front End Architectures, IEEE MTT-S 2000, Boston,
Workshop, June 2000.
[18] H. Meyr, M. Moeneclaey, and S. A. Fechtel, Digital Communication
Receivers.
Wiley, 1998.
[19] M. Valkama, M. Renfors, and V. Koivunen, “Advanced methods for i/q
imbalance compensation in communication receivers,” Signal Process-
ing, IEEE Transactions on, vol. 49, no. 10, pp. 2335–2344, Oct 2001.

