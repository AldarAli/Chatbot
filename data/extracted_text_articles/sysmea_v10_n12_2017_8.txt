Compatibility of Boundary Angular Velocities
in the Velocity-based 3D Beam Formulation
Eva Zupan and Dejan Zupan
Faculty of Civil and Geodetic Engineering
University of Ljubljana
Ljubljana, Slovenia
Email: eva.zupan.lj@gmail.com; dejan.zupan@fgg.uni-lj.si
Abstract‚ÄîIn this paper, a new velocity-based Ô¨Ånite element
approach for non-linear dynamics of beam-like structures is
introduced. In contrast to standard approaches we here base
the formulation on velocities and angular velocities expressed in
the most suitable basis regarding standard approximation and
interpolation techniques. The additivity of angular velocities in
local frame description brings several beneÔ¨Åts, such as trivial
discretization and update procedure for the primary unknowns
and improved stability properties of the time integrator. On the
other hand, different initial orientations of elements connected
together lead to nodal angular velocities that are expressed in
different frames and cannot be directly equalized. The compati-
bility of angular velocities over the Ô¨Ånite element boundaries thus
needs to be solved. We avoid introducing constraint equations and
additional degrees of freedom and introduce a computationally
cheap solution instead.
Keywords‚Äìnon-linear dynamics; spatial beams; Ô¨Ånite-element
method; boundary conditions; velocity-based approach; continuity
of velocities.
I.
INTRODUCTION
The total set of equations in solid mechanics consists of non-
linear equilibrium, kinematic and constitutive equations that
need to be solved for displacements, strains and stresses. Many
practical problems in solid mechanics deal with structures that
have one dimension larger than the other two, e.g., columns
and girders in civil engineering, robotic arms, rotor blades and
aircraft wings in mechanical engineering, deoxyribonucleic
acid (DNA) molecules in biology and medicine, nanotubes
in nanotechnology. Such structures are usually modelled as
beams. It is of utmost importance to consider properly the
boundary and continuity conditions when proposing a novel
Ô¨Ånite element (FE) beam model [1]. We focus in this paper
on a structure of a velocity based beam element and the
computational aspects in satisfying the continuity conditions
over the boundaries.
The paper is structured as follows. Section II presents the
oveview of the beam formultions, while Section III introduces
the governing equations of the Cosserat beam model. In
Section IV, we describe a novel numerical solution method
for Cosserat beams. The treatment of boundary conditions
is presented in Section V. In Section VI, some numerical
examples are given. The paper ends with concluding remarks.
II.
BEAM FORMULATIONS
For beam-like structures the kinematics of a body be-
comes simpliÔ¨Åed but the equations remain non-linear, see,
e.g., Antman [2], Reissner [3] and Simo [4]. Additionally, the
reduced kinematics introduces the three-dimensional rotations
of rigid cross-sections to describe the conÔ¨Åguration of a beam.
Spatial rotations are often taken to be the primary variables
in three-dimensional beam formulations, see, e.g., [4]‚Äì[15],
despite their demanding mathematical structure. In the solu-
tion algorithms for beams many authors reduce the total set
of equations in such a way that the conÔ¨Åguration variables
(displacements and rotations) become the only unknowns of
the problem. For numerical solution methods, such reduction
means that the conÔ¨Åguration variables need to be discretized
with respect to space and time. The multiplicative nature of
rotations, characterized by non-additivity, orthogonality and
non-commutativity, needs to be properly considered in the
numerical solution methods to gain a sufÔ¨Åcient performance
of calculations and accuracy of the results. Such demands
highly increase the complexity of algorithms and disable direct
applicability of the methods developed for standard Euclidean
spaces, see, e.g., [16]‚Äì[21].
Mathematically, rotations are linear transformations in three-
dimensional Euclidean space and can therefore be represented
by 3 √ó 3 matrices. However, these nine components have six
constraints, which makes a matrix representation of rotations
less convenient for numerical implementations. Widely used
are the three-parameter representations of which the often
chosen ‚Äúrotational vector‚Äù [22] is only one among many possi-
bilities. It is well known that all three-parameter descriptions of
rotations posses singularities. To avoid them a four parameter
representations were also used, e.g., [23]‚Äì[25]. Surprisingly, it
was only recently that this ideas were successfully revived, see,
e.g., [14], [15], [26]‚Äì[29]. In this paper, rotational quaternions
will be used as a suitable representation of rotations, but they
will not be taken to be the primary unknowns of the problem.
From the perspective of total mechanical energy of the system
the velocities and angular velocities seem to be more natural
quantities.
Thus, the alternative approach employed here exploits com-
putationally simpler angular velocities as the primary quan-
tities for the description of rotational degrees of freedom.
Such approach brings several advantages to non-linear beam
dynamics:
76
International Journal on Advances in Systems and Measurements, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/systems_and_measurements/
2017, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org

‚Ä¢
when expressed in local bases, the components of an-
gular velocity vector become additive, which enables
the use of standard discretization and interpolation tech-
niques;
‚Ä¢
the stability of implicit time integrators is improved by
taking the derivative of conÔ¨Åguration quantities as the
iterative unknowns, see Hosea and Shampine [30];
‚Ä¢
the time discretization, linearization of equations and
the update procedure are much simpler compared to
standard beam elements.
Besides its advantages, this new approach brings some novel
issues that need to be properly solved. The crucial idea of
the Ô¨Ånite element method (FEM) lies in subdivision of a
larger structure into smaller parts called Ô¨Ånite elements. An
important part of the solution procedure is the assembly of
equations of Ô¨Ånite elements into a larger system of equations
that describe the problem at the structural level. The simplest
assumption used in the assembly procedure is that the elements
are rigidly connected so that the displacements and rotations
are continuous over the boundaries. When the displacements
and rotations are chosen as the primary variables, a simple
Boolean identiÔ¨Åcation of degrees of freedom can be used. This
yields that velocities and angular velocities are continuous over
the Ô¨Ånite element boundaries as well, but only when expressed
with respect to a Ô¨Åxed basis.
For the sake of computational advantages at the element
level, we express the angular velocities with respect to the
moving frame. Because of this choice, the simple identiÔ¨Åcation
of degrees of freedom that belongs to the joints between ele-
ments can no longer be used due to different initial orientations
of elements. Thus, the continuity of conÔ¨Åguration quantities
in a Ô¨Åxed frame leads to a more complicated relation in the
local frame. This relation could be introduced at the structural
level using the method of Lagrange multipliers, but such an
approach would increase the number of degrees of freedom
and the computational complexity of the overall algorithm.
An elegant and computationally cheap alternative is presented
here. Excellent properties of the proposed numerical model are
demonstrated by numerical examples.
III.
COSSERAT BEAM MODEL
Among beam models, the Cosserat theory of rods, [2], is
widely used. The numerical implementation of the model is
usually attributed to Reissner [3] and Simo [4], where it is also
called the geometrically exact beam. Only a brief description
of the model is presented here.
The centroidal line
n‚áÄr (x, t) , x ‚àà [0, L] , t ‚â• 0
o
and the
family of cross-sections {A (x, t) , x ‚àà [0, L] , t ‚â• 0} of the
beam are parametrized by the arc-length parameter x and the
time t, where L is the length of the beam in its initial position,
see Figure 1. We assume that cross-sections are bounded plane
regions that preserve their shape and area during deformation.
For the description of beam equations and the quan-
tities therein, we introduce the local orthonormal basis
O
1
2
3
G
G
X
Y
Z
2
3
r
(
)
x,t
(
)
x,t
(
)
x,t
G1(
x,t)
*
*
*
*
g
g
g
*
*
*
Figure 1. A three-dimensional beam.
‚áÄ
G1 (x, t) ,
‚áÄ
G2 (x, t) ,
‚áÄ
G3 (x, t)

, which deÔ¨Ånes the orienta-
tion of each cross-section, and the global orthonormal basis
n‚áÄg 1,
‚áÄg 2,
‚áÄg 3
o
, which is Ô¨Åxed in time and space. A rotation
between the global and the local basis, deÔ¨Åned by the quater-
nion multiplication (‚ó¶) reads
‚áÄ
Gi (x, t) = bq (x, t) ‚ó¶
‚áÄg i ‚ó¶ bq ‚àó (x, t) ,
i = 1, 2, 3,
(1)
where bq denotes the rotational quaternion and bq ‚àó its conjugate.
A comprehensive presentation of the quaternion algebra can
be found, e.g., in the textbook [31]. For more details on the
application of quaternions in beam models please refer to [32]
or [15].
Note that any rotational quaternion q has a Ô¨Årm physical
meaning. It be presented as the sum of a scalar and a vector,
bq = cos œë
2 + sin œë
2
‚áÄn,

‚áÄn
 = 1,
(2)
where œë denotes the angle of rotation and
‚áÄn is the unit vector
on the axis of rotation.
In what follows abstract vectors will be replaced by com-
ponent representations. The bold-face letters will be used to
represent vector quantities in the component form. The lower
case letters will be used when a vector is expressed with
respect to the Ô¨Åxed frame and the upper case letters are used for
the local basis description. A hat over the letter denotes a four-
dimensional vector, a member of the algebra of quaternions.
The dependency of quantities on space x and time t will be
mostly omitted for better readability.
A. Kinematic compatibility
In Cosserat rod theory the resultant strain measures at the
centroid of each cross-section are directly introduced and ex-
pressed with kinematic variables by the Ô¨Årst order differential
equations
Œì = bq‚àó ‚ó¶ r‚Ä≤ ‚ó¶ bq + Œì0,
(3)
K = 2bq‚àó ‚ó¶ bq‚Ä≤,
(4)
77
International Journal on Advances in Systems and Measurements, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/systems_and_measurements/
2017, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org

where Œì and K denote the translational and rotational strain,
respectively, both expressed with respect to the local basis. The
prime (‚Ä≤) denotes the derivative with respect to x. Similarly,
when we measure the rate of change of conÔ¨Åguration variables
with time, we have
v =
¬∑r,
(5)
‚Ñ¶ = 2bq‚àó ‚ó¶
¬∑
bq,
(6)
introducing velocity v in Ô¨Åxed basis and angular velocity
‚Ñ¶ in local basis description, while the dot denotes the time
derivative. It is important to observe that strains, velocities,
and angular velocities are mutually dependent. Their direct
relation is obtained by comparing mixed partial derivatives.
After a straightforward derivation, we have
ÀôŒì = bq‚àó ‚ó¶ v‚Ä≤ ‚ó¶ bq + (bq‚àó ‚ó¶ r‚Ä≤ ‚ó¶ bq) √ó ‚Ñ¶,
(7)
¬∑
K = ‚Ñ¶‚Ä≤ + K √ó ‚Ñ¶.
(8)
Equations (7)‚Äì(8) describe the kinematic compatibility of
continuous system, [33], [34]. Its importance is obvious:
the relation between the rotational strains and the angular
velocities is described without rotational parameters. Since
the rotational degrees of freedom are usually highly non-
linear when compared to other quantities such modiÔ¨Åcation
of kinematic equations can be numerically advantageous.
B. Governing equations
The continuous balance equations of a three-dimensional
beam in quaternion notation read:
n‚Ä≤ + Àún = œÅA
¬∑v,
(9)
m‚Ä≤ + r‚Ä≤ √ó n + Àúm = q ‚ó¶

JœÅ
¬∑
‚Ñ¶ + ‚Ñ¶ √ó JœÅ‚Ñ¶

‚ó¶ bq ‚àó.
(10)
Equation (9) is a standard linear momentum balance equation,
while equation (10) represents the angular momentum balance
equation in terms of quaternion algebra as it follows from the
generalized d‚ÄôAlembert principle considering the unit norm of
rotational quaternion. Here, n and m are the resultant force and
moment vector of the cross-section expressed in Ô¨Åxed frame,
i.e.,
n (x, t) = bq (x, t) ‚ó¶ N (x, t) ‚ó¶ bq ‚àó (x, t) ,
(11)
m (x, t) = bq (x, t) ‚ó¶ M (x, t) ‚ó¶ bq ‚àó (x, t) ,
(12)
where N and M are the same vectors expressed in local
basis; œÅ is the density of the material; A is the area of the
cross-section; JœÅ is the matrix of mass moments of inertia; Àún
and Àúm are vectors of applied distributed force and moment.
Together with balance equations the following conditions at
the boundaries need to be satisÔ¨Åed:
n(0, t) + f 0 (t) = 0,
(13)
m(0, t) + h0 (t) = 0,
(14)
n(L, t) ‚àí f L (t) = 0,
(15)
m(L, t) ‚àí hL (t) = 0,
(16)
f 0, h0, f L and hL are the external time-dependent point forces
and moments at the two boundaries, x = 0 and x = L.
For constitutive equations various models could be taken,
but here we limit ourselves to the simplest case of linear elastic
material, where
N = diag [ EA
GA2
GA3 ] Œì,
(17)
M = diag [ GI1
EI2
EI3 ] K.
(18)
Here, EA/L is the axial stiffness, EI2 and EI3 denote the
bending stiffness, GI1/L is the torsional stiffness, GA2 and
GA3 are the shear stiffnesses.
IV.
NUMERICAL SOLUTION METHOD
We will solve the balance equations using the method of
weighted residuals. Equations (9) and (10) are multiplied by
test functions Ip (x), p = 1, 2, ..., N, and integrated along the
length of the beam:
L
Z
0
h
n‚Ä≤ ‚àí Àún ‚àí œÅA
¬∑¬∑r
i
Ip dx = 0,
(19)
L
Z
0
[m ‚àí (r‚Ä≤ √ó n) ‚àí Àúm ‚àí bq ‚ó¶

JœÅ
¬∑
‚Ñ¶

‚ó¶ bq ‚àóIp
+ ‚Ñ¶ √ó (bq ‚ó¶ (JœÅ‚Ñ¶) ‚ó¶ bq ‚àó)]Ip dx = 0.
(20)
The terms nIp and mIp are integrated by parts, which after
considering the boundary conditions (13)‚Äì(16) gives:
L
Z
0
h
nI‚Ä≤
p ‚àí ÀúnIp + œÅA
¬∑¬∑rIp
i
dx ‚àí Œ¥pf = 0,
(21)
L
Z
0
[mI‚Ä≤
p ‚àí (r‚Ä≤ √ó n) Ip ‚àí ÀúmIp + bq ‚ó¶

JœÅ
¬∑
‚Ñ¶

‚ó¶ bq ‚àóIp
+ œâ √ó (bq ‚ó¶ (JœÅ‚Ñ¶) ‚ó¶ bq ‚àó) Ip] dx ‚àí Œ¥ph = 0.
(22)
Here
Œ¥pf =
Ô£±
Ô£≤
Ô£≥
f 0,
p = 1
f L,
p = N
0,
otherwise
,
Œ¥ph =
Ô£±
Ô£≤
Ô£≥
h0,
p = 1
hL,
p = N
0,
otherwise
.
Equations (21)‚Äì(22) represent a system of 6N algebraic equa-
tions that is in general too demanding to be solved analytically.
In our approach, we express all the unknown quantities with
velocity and angular velocity. The approximative solution in
both time and space is then spanned on these two quantities.
for completeness the details on discretization will be brieÔ¨Çy
introduced.
78
International Journal on Advances in Systems and Measurements, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/systems_and_measurements/
2017, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org

A. Time discretization
For the time discretization, we use the approximation of
displacements at tn+1 following from the mean value theorem:
r[n+1] = r[n] + hv[n] + v[n+1]
2
,
which yields
r[n+1] = r[n] + hv,
where v denotes the average velocity
v = v[n] + v[n+1]
2
and h = tn+1 ‚àí tn is the time step of the scheme.
For accelerations we can similarly employ
a[n] + a[n+1]
2
= v[n+1] ‚àí v[n]
h
.
After some rearrangement of terms, the scheme for transla-
tional degrees of freedom reads
r[n+1] = r[n] + hv,
v[n+1] = ‚àív[n] + 2v,
(23)
a[n+1] = ‚àía[n] ‚àí 4
hv[n] + 4
hv.
This scheme can be interpreted as a modiÔ¨Åcation of the
classical implicit Newmark scheme, where the average velocity
becomes the iterative unknown, see [8] and [35].
A similar approach can be used for rotational degrees of
freedom with an important exception stemming from the non-
linear relationship between angular velocities and rotational
quaternions. The exponential mapping is used to map from
incremental angular velocities to incremental rotations. The
incremental rotation is then multiplied with the current one.
The scheme for rotational degrees of freedom reads
bq[n+1] = bq[n] ‚ó¶ exp
h
2 ‚Ñ¶

,
‚Ñ¶[n+1] = ‚àí‚Ñ¶[n] + 2‚Ñ¶,
(24)
Œ±[n+1] = ‚àíŒ±[n] ‚àí 4
h‚Ñ¶[n] + 4
h‚Ñ¶,
where exp denotes the quaternion exponential
exp (bx) = b1 + bx
1! + 1
2!bx ‚ó¶ bx + 1
3!bx ‚ó¶ bx ‚ó¶ bx + ....
(25)
The above presented time-discretization scheme describes
the assumptions taken regarding displacements, rotations and
their time derivatives. For deformable structures time dis-
cretization of strain quantities is also needed. We derive
the discrete compatibility equations analogously as for the
continuous case. This gives
Œì[n+1] = exp‚àó
h
2 ‚Ñ¶

‚ó¶

Œì[n] ‚àí Œì0

exp
h
2 ‚Ñ¶

+ hbq‚àó[n+1] ‚ó¶ v‚Ä≤ ‚ó¶ bq[n+1] + Œì0,
(26)
K[n+1] = exp‚àó
h
2 ‚Ñ¶

‚ó¶ K[n] ‚ó¶ exp
h
2 ‚Ñ¶

+ 2 exp‚àó
h
2 ‚Ñ¶

‚ó¶ exp‚Ä≤
h
2 ‚Ñ¶

.
(27)
When the governing equations of a beam are evaluated at
discrete time tn+1 and the schemes (23)‚Äì(24) are taken into
account, we obtain the system of equations dependent only on
the arch-length parameter x. In order to solve these equations
at each particular time step we need to introduce the spatial
discretization.
B. Spatial discretization
After the time discretization introduced, the average veloci-
ties v and ‚Ñ¶ are the only unknown functions along the length
of the beam for any particular discrete time. They are replaced
by a set of nodal values vp, ‚Ñ¶
p at discretization points xp,
p = 1, . . . , N, with x1 = 0 and xN = L, and interpolated by
a set of interpolation functions Ip(x) in-between:
v (x) =
N
X
p=1
Ip (x) vp,
(28)
‚Ñ¶ (x) =
N
X
p=1
Ip (x) ‚Ñ¶
p.
(29)
The same discretization procedure is performed at every Ô¨Ånite
element of the structure. Thus, boundary nodes x1 and xN
become members of the global notes important at the structural
level, while x2,... xN‚àí1 are internal points of the element, often
but not necessarily condensed at the elements level. Angular
velocities in local basis description are additive quantities and
the standard aditive-type interpolation used is in complete
accord with the properties of the conÔ¨Åguration space.
C. Newton iteration
After time and space discretization, the governing equations
(21)‚Äì(22) are replaced by a set of nonlinear algebraic equations
that need to be solved at each discrete time for all the nodal
values. The non-linear equations are solved iteratively using
the Newton-Raphson method
K[i]Œ¥y = ‚àíf [i],
(30)
where K[i] is the global Jacobian tangent matrix, f [i] the resid-
ual vector of discretized equations (21)‚Äì(22), both in iteration
i, and Œ¥y a vector of corrections of all nodal unknowns
Œ¥y =

Œ¥v1
Œ¥‚Ñ¶1
¬∑ ¬∑ ¬∑
Œ¥vM
Œ¥‚Ñ¶M
T
79
International Journal on Advances in Systems and Measurements, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/systems_and_measurements/
2017, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org

A suitable choice of nodal variables allows the kinematically
admissible additive update:
v[i+1] = v[i] + Œ¥v,
(31)
‚Ñ¶
[i+1] = ‚Ñ¶
[i] + Œ¥‚Ñ¶
(32)
at each discrete point of the structure. Further details on
linearization of equations can be found in [36].
V.
CONTINUITY OF BOUNDARY VALUES
Finite elements have equal displacements and rotations at the
rigid joints. However, the initial rotations of different elements
are not necessarily equal. When the initial orientations differ,
we need to distinguish between the initial and the relative
rotations. Let us start with two elements having different initial
orientations, described by quaternions bqI
0 and bqII
0 at the joint:
bqI
0 Ã∏= bqII
0 . When the joint is rigid the position vectors are equal,
but the total rotations differ
rI = rII
and
bqI Ã∏= bqII,
(33)
as shown in Figure 2.
element I
element II
node 1
node 2
node 3
...
...
r, qI
I
r, q
II
II
Figure 2. A rigid joint of two differently oriented elements.
The total rotations can be expressed as a composition of
initial and relative rotation
bqI = bqI
0 ‚ó¶ bkI
and
bqII = bqII
0 ‚ó¶ bkII,
(34)
where the relative rotations are equal:
bkI = bkII.
(35)
The continuity condition, which could also be called the
compatibility of rotations at the element boundaries, thus reads
bqI ‚ó¶ bqI‚àó
0 = bqII ‚ó¶ bqII‚àó
0 .
In conÔ¨Åguration based approach we usually avoid enforcing
this condition by introducing the relative rotational quaternion
bk as the nodal variable. For the velocity-based approach, we
can similarly observe that
vI = vII
and
‚Ñ¶
I Ã∏= ‚Ñ¶
II,
as the angular velocities are expressed in different local frames.
We will derive the compatibility condition for angular veloci-
ties at the joints and propose a similar strategy as for rotational
quaternions to avoid the use of Lagrange multipliers method by
the substitution of the primary unknowns of Newton‚Äôs iteration
at the structural level. The details are presented in the sequel.
A. Relation between boundary angular velocities
The angular velocity vector expressed in the local frame is
deÔ¨Åned as
‚Ñ¶ = 2bq‚àó ‚ó¶
¬∑
bq,
(36)
which yields the expressions for the nodal angular velocities
of elements I and II at the joint
‚Ñ¶
I = 2bqI‚àó ‚ó¶
¬∑
bqI
and
‚Ñ¶
II = 2bqII‚àó ‚ó¶
¬∑
bqII.
After considering (34), we have
‚Ñ¶
I = 2bqI‚àó
0 ‚ó¶ bkI‚àó ‚ó¶
¬∑
bkI ‚ó¶ bqI
0,
‚Ñ¶
II = 2bqII‚àó
0
‚ó¶ bkII‚àó ‚ó¶
¬∑
bkII ‚ó¶ bqII
0 .
Since the relative rotation bk is continuous over the boundaries
of elements, eq. (35), we are able to express the constraint
relation between the boundary angular velocities
bqI
0 ‚ó¶ ‚Ñ¶
I ‚ó¶ bqI‚àó
0 = bqII
0 ‚ó¶ ‚Ñ¶
II ‚ó¶ bqII‚àó
0 .
(37)
For the clarity of further derivation, it is convenient to express
(37) in terms of rotation matrices:
RI
0‚Ñ¶
I = RII
0 ‚Ñ¶
II,
(38)
where RI
0 and RII
0
denote the standard rotation matrices
equivalent to quaternion-based rotations expressed with bqI
0 and
bqII
0 .
B. Algorithmically enforced boundary conditions
A solution of two moment equilibrium equations (22) ex-
pressed at the same node, here formally written as
MI 
‚Ñ¶
I
= 0
and
MII 
‚Ñ¶
II
= 0,
(39)
needs to be found. The solution must also satisfy the algebraic
constraint
RI
0‚Ñ¶
I ‚àí RII
0 ‚Ñ¶
II = 0.
(40)
Following the method of Lagrange multipliers the constraint
equation is multiplied by a multiplier Œª and linearized. The
corresponding partial derivatives are then added to the initial
variational problem to obtain the weak form of Lagrange
function. For the present case it reads
MI 
‚Ñ¶
I
+ RI
0Œª = 0,
(41)
MII 
‚Ñ¶
II
‚àí RII
0 Œª = 0,
(42)
RI
0‚Ñ¶
I ‚àí RII
0 ‚Ñ¶
II = 0.
(43)
The method thus increases the size of the system and the
computational demands. It introduces three additional scalar
unknowns and three additional equations for each rigid joint
80
International Journal on Advances in Systems and Measurements, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/systems_and_measurements/
2017, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org

between two elements. To avoid this, we introduce the follow-
ing change of variables describing the nodal rotation-related
unknowns:
‚Ñ¶
I
R = RI
0‚Ñ¶
I
and
‚Ñ¶
II
R = RII
0 ‚Ñ¶
II.
(44)
Based on the substitution of unknowns (44), the method of
Lagrange multipliers gives
MI 
RIT
0 ‚Ñ¶
I
R

+ Œª = 0,
(45)
MII 
RIIT
0
‚Ñ¶
II
R

‚àí Œª = 0,
(46)
‚Ñ¶
I
R ‚àí ‚Ñ¶
II
R = 0.
(47)
The system (45)‚Äì(47) can be easily reduced since the nodal
unknowns are now identical: ‚Ñ¶R = ‚Ñ¶
I
R = ‚Ñ¶
II
R. These new
variables can be interpreted as the relative angular velocities
in a relative local frame. It is important to observe that the
equations (45)‚Äì(46) represent the moment equilibrium equa-
tions, both written with respect to the same Ô¨Åxed basis. This
fact allows us to sum the Ô¨Årst two equations which directly
leads to the reduced moment equilibrium equation at the joint:
MI 
shown in Figure 3. The mass-inertia matrix of the cross-section
is taken to be: JœÅ = diag [ 10
10
10 ] kg m.
For this particular problem, all elements have equal initial
orientations. A simple Boolean identiÔ¨Åcation of degrees of
freedom is therefore reasonable even if angular velocities in
local frame description are the primary unknowns, which is
the case in our approach. This allows us to solve the problem
in two different ways: i) with Boolean identiÔ¨Åcation and ii)
using the proposed algorithm. By doing so, we will be able to
compare the computational times and demonstrate the demands
of the presented algorithm. Note that the Boolean identiÔ¨Åcation
is not appropriate when solving problems, where elements have
different initial inclinations, which limits its applicability and
generality.
200
5.0
2.5
t¬É[s]
6 m
8 m
f
f¬É t
h
t
( )=
( )/10/m
h¬É t
h
t
( )=
( )/2
X
X
hZ
h
h¬É [Nm]
Y
Y
Y
Y
Z
X
Z
O
1
3
g
g
*
*
Figure 3. Unsupported beam that is initially straight but inclined.
To compare both methods, a dense mesh of 100 linear
elements has been used. For this problem a small number of
elements would be sufÔ¨Åcient, but by increasing their number
the complexity of the overall algorithm raises so the additional
demands of the proposed algorithm can be easier observed.
Besides that, the computational error of the results becomes
negligible with very dense mesh. The average computational
times of the same evaluation in seconds are presented in Table
I.
TABLE I. COMPUTATIONAL TIMES OF INITIALLY STRAIGHT BEAM.
Method
initial time step
ten time steps
Boolean identiÔ¨Åcation
3.415
42.820
proposed algorithm
3.508
34.011
We can observe that computational times of the proposed
method are only slightly larger after the Ô¨Årst time step. How-
ever, in the time stepping procedure the proposed algorithm be-
haves better since the newly introduced relative velocities seem
to be more suitable computational unknowns, which leads to a
lower number of total iterations needed and, therefore, lower
computational times.
B. Large deÔ¨Çections of right-angle cantilever
This classical example introduced by Simo and Vu-Quoc
[18] was studied by many authors. A right-angle cantilever
beam is subjected to a triangular pulse out-of-plane load at the
elbow, see Figure 4. Each part of the cantilever is dicretized
with two third-order elements. A dynamic response of the
cantilever involves very large magnitudes of displacements
and rotations together with Ô¨Ånite strains. After removal of
the external force, the cantilever undergoes free vibrations
and the total mechanical energy of the cantilever should
remain constant. Therefore, the stability of the algorithm
is here checked through the energy behaviour. The cen-
troidal mass-inertia matrix of the cross-section is diagonal:
JœÅ = diag [ 20
10
10 ] kg m.
Originally, the solution
was computed on the time interval [0, 30] s with Ô¨Åxed time
step 0.25 s, later the interval was extended to [0, 50] s by
Jeleni¬¥c and CrisÔ¨Åeld [37] claiming that most of the algorithms
encounter numerical stability problems between times 30 s and
2
1
50
t¬É[s]
f¬É¬É¬É[N]
f
Y
Y
X
Z
O
1
3
g
g*
*
10 m
10 m
free end
elbow
Figure 4. The right-angle cantilever subjected to out-of-plane loading.
0
20
40
60
80
100
-10
-5
0
5
10
time [s]
displacement [m]
uy(free end)
uy(elbow)
Figure 5. The out-of-plane displacements at free-end and at elbow for the
right-angle cantilever.
82
International Journal on Advances in Systems and Measurements, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/systems_and_measurements/
2017, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org

0
20
40
60
80
100
0
50
100
150
time [s]
total mechanical energy [J]
20
30
40
50
60
114.4
114.6
Figure 6. The time history of the total mechanical energy for the right-angle
cantilever.
50 s. Here on a longer time interval [0, 100] s solution was
obtained without any numerical problems noticed, see Figure
5. However, the time step used had to be reduced by half,
h = 0.125 s, otherwise the iteration could not achieve the
prescribed tolerance condition at time 51.5 s. From Figure 6
we can observe almost constant total mechanical energy after
time t = 5 s; only slight discrepancy of about 0.2% can be
observed, which indicates good stability of calculations. The
present results on the time interval [0, 30] s agree well with
the results reported by other authors.
C. Large overall motion of a Ô¨Çexible cross-like structure
The large overall motion of completely free ‚Äúcross‚Äù was Ô¨Årst
presented by Simo et al. [38] to illustrate the performance of
the algorithm when calculating the dynamics response of a
reticulated structure. The geometry and the applied external
out-of plane forces are depicted in Figure 7. The centroidal
mass-inertia matrix of the cross-section is taken to be JœÅ =
diag [ 10
10
10 ] kg m.
M t( )
M t( ) [Nm]
A
F t( )
F t( )
F t( )
F t( )
200
2.5 5.0
t [s]
F t
( )=0.1 M t
( )/m
5 m
Figure 7. The geometry and the loading of the ‚Äúcross‚Äù.
In this example, four Ô¨Ånite elements are rigidly connected
at the central point sharing the same velocities and the same
relative angular velocities. Thus, it is very suitable for the
demonstration of the appropriateness of the proposed approach.
The solution was computed on a very large time interval
[0, 1000] s with time step h = 0.1 s. We observed perfect
950
960
970
980
990
1000
-5
0
5
10
time [s]
displacements at point
[m]
A
ux
uy
uz
0
10
20
30
40
50
-5
0
5
10
time [s]
displacements at point
[m]
A
Figure 8. The displacements of the ‚Äúcross‚Äù at point A at the beginning and
at the end of calculation.
0
200
400
600
800
1000
0
200
400
600
time [s]
total mechanical energy [J]
520
540
560
580
554
555
Figure 9. The time history of the total mechanical energy for the ‚Äúcross‚Äù.
quadratic convergence of the algorithm during the whole
calculation. Because the interval of calculation is so extremely
long we present only displacements on short intervals at the
beginning and at the end of calculation, see Figure 8.
After removal of external forces at time t = 5 s the cross
vibrates freely in a periodic-like dynamic pattern and the total
83
International Journal on Advances in Systems and Measurements, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/systems_and_measurements/
2017, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org

mechanical energy is almost constant as expected, see Figure
9. The calculations remain stable even after 10 000 time steps.
More detailed results are, to author‚Äôs best knowledge, not
available in literature. However, almost the same response is
obtained by Ô¨Åner mesh and/or smaller time step indicating that
the computational errors for this problem are small.
VII.
CONCLUSION
A novel Ô¨Ånite-element approach for the beam dynamics has
been presented. The proposed method exploits the beneÔ¨Åts of
the favourable properties of angular velocity in the local frame
description. The computational advantages of the quaternion
representation of rotations are preserved, but additionally with
the replacement of the primary unknowns we gain the consider-
able increase of numerical stability and robustness of the model
without any other measures needed. The issue of the continuity
of the structural unknowns over the element boundaries has
been resolved with minimal computational cost. The classical
benchmark examples demonstrate the excellent performance of
the proposed method. Even for large number of time steps a
reliable results were obtained and almost perfect preservation
of the total mechanical energy is gained for sufÔ¨Åciently dense
meshes and sufÔ¨Åciently small time-step sizes.
ACKNOWLEDGMENT
This work was supported by the Slovenian Research Agency
through the research programme P2-0260. The support is
gratefully acknowledged.
REFERENCES
[1]
E. Zupan and D. Zupan, ‚ÄúOn the Implementation of Novel Velocity-
based 3D Beam: Compatibility of Angular Velocities Over the FEM
Boundaries,‚Äù ADVCOMP 2016, The Tenth International Conference on
Advanced Engineering Computing and Applications in Sciences, pp.
17‚Äì22.
[2]
S. S. Antman, Nonlinear Problems of Elasticity, 2nd ed.
Berlin:
Springer, 2005.
[3]
E. Reissner, ‚ÄúOn Ô¨Ånite deformations of space-curved beams,‚Äù Z. Angew.
Math. Phys., vol. 32, no. 6, pp. 734‚Äì744, 1981.
[4]
J. C. Simo, ‚ÄúA Ô¨Ånite strain beam formulation - the three-dimensional
dynamic problem. Part I.‚Äù Comput. Meth. Appl. Mech. Eng., vol. 49,
no. 1, pp. 55‚Äì70, 1985.
[5]
J. M. Battini and C. Pacoste, ‚ÄúCo-rotational beam elements with
warping effects in instability problems,‚Äù Comput. Meth. Appl. Mech.
Eng., vol. 191, no. 17-18, pp. 1755‚Äì1789, 2002.
[6]
O. A. Bauchau and N. J. Theron, ‚ÄúEnergy decaying scheme for non-
linear beam models,‚Äù Comput. Meth. Appl. Mech. Eng., vol. 134, no.
1-2, pp. 37‚Äì56, 1996.
[7]
P. Betsch and P. Steinmann, ‚ÄúFrame-indifferent beam Ô¨Ånite elements
based upon the geometrically exact beam theory,‚Äù Int. J. Numer.
Methods Eng., vol. 54, no. 12, pp. 1775‚Äì1788, 2002.
[8]
O. Br¬®uls, A. Cardona, and M. Arnold, ‚ÄúLie group generalized-alpha time
integration of constrained Ô¨Çexible multibody systems,‚Äù Mech. Mach.
Theory, vol. 48, pp. 121‚Äì137, 2012.
[9]
A. Cardona and M. G¬¥eradin, ‚ÄúA beam Ô¨Ånite-element non-linear theory
with Ô¨Ånite rotations,‚Äù Int. J. Numer. Methods Eng., vol. 26, no. 11, pp.
2403‚Äì2438, 1988.
[10]
M. A. CrisÔ¨Åeld, ‚ÄúA consistent corotational formulation for nonlinear,
3-dimensional, beam-elements,‚Äù Comput. Meth. Appl. Mech. Eng.,
vol. 81, no. 2, pp. 131‚Äì150, 1990.
[11]
L. A. Crivelli and C. A. Felippa, ‚ÄúA 3-dimensional nonlinear Timo-
shenko beam based on the core-congruential formulation,‚Äù Int. J. Numer.
Methods Eng., vol. 36, no. 21, pp. 3647‚Äì3673, 1993.
[12]
A. Ibrahimbegovic, ‚ÄúOn Ô¨Ånite-element implementation of geometrically
nonlinear Reissner beam theory - 3-dimensional curved beam elements,‚Äù
Comput. Methods Appl. Mech. Eng., vol. 122, no. 1-2, pp. 11‚Äì26, 1995.
[13]
G. Jeleni¬¥c and M. Saje, ‚ÄúA kinematically exact space Ô¨Ånite strain
beam model - Ô¨Ånite-element formulation by generalized virtual work
principle,‚Äù Comput. Methods Appl. Mech. Eng., vol. 120, no. 1-2, pp.
131‚Äì161, 1995.
[14]
H. Lang, J. Linn, and M. Arnold, ‚ÄúMulti-body dynamics simulation
of geometrically exact Cosserat rods,‚Äù Multibody Syst. Dyn., vol. 25,
no. 3, pp. 285‚Äì312, 2011.
[15]
E. Zupan, M. Saje, and D. Zupan, ‚ÄúThe quaternion-based three-
dimensional beam theory,‚Äù Comput. Meth. Appl. Mech. Eng., vol. 198,
no. 49-52, pp. 3944‚Äì3956, 2009.
[16]
P. Crouch and R. Grossman, ‚ÄúNumerical-integration of ordinary
differential-equations on manifolds,‚Äù J. Nonlinear Sci., vol. 3, no. 1,
1993, pp. 1‚Äì33.
[17]
C. Bottasso and M. Borri, ‚ÄúIntegrating Ô¨Ånite rotations,‚Äù Comput. Meth.
Appl. Mech. Eng., vol. 164, no. 3-4, 1998, pp. 307‚Äì331.
[18]
J. C. Simo and L. Vu-Quoc, ‚ÄúOn the dynamics in space of rods
undergoing large motions - a geometrically exact approach,‚Äù Comput.
Meth. Appl. Mech. Eng., vol. 66, no. 2, 1988, pp. 125‚Äì161.
[19]
H. Munthe-Kaas, ‚ÄúRunge-Kutta methods on Lie groups,‚Äù Bit, vol. 38,
no. 1, 1998, pp. 92‚Äì111.
[20]
H. Munthe-Kaas, , ‚ÄúHigh order Runge-Kutta methods on manifolds,‚Äù
Appl. Numer. Math., vol. 29, no. 1, pp. 115‚Äì127, 1999.
[21]
A. Zanna, ‚ÄúCollocation and relaxed collocation for the FER and the
Magnus expansions,‚Äù SIAM J. Numer. Anal., vol. 36, no. 4, 1999, pp.
1145‚Äì1182.
[22]
J. Argyris and V. Poterasu, ‚ÄúLarge rotations revisited application of
Lie-algebra,‚Äù Comput. Meth. Appl. Mech. Eng., vol. 103, no. 1-2, pp.
11‚Äì42, 1993.
[23]
C. Bottasso, ‚ÄúA non-linear beam space-time Ô¨Ånite element formulation
using quaternion algebra: interpolation of the Lagrange multipliers and
the appearance of spurious modes,‚Äù Comput. Mech., vol. 10, no. 5, pp.
359‚Äì368, 1992.
[24]
S. Kehrbaum and J. H. Maddocks, ‚ÄúElastic rods, rigid bodies, quater-
nions and the last quadrature,‚Äù Philos. Trans. R. Soc. A-Math. Phys.
Eng. Sci., vol. 355, no. 1732, pp. 2117‚Äì2136, 1997.
[25]
F. McRobie and J. Lasenby, ‚ÄúSimo-Vu Quoc rods using Clifford
algebra,‚Äù Int. J. Numer. Methods Eng., vol. 45, no. 4, pp. 377‚Äì398,
1999.
[26]
S. Ghosh and D. Roy, ‚ÄúConsistent quaternion interpolation for objective
Ô¨Ånite element approximation of geometrically exact beam,‚Äù Comput.
Meth. Appl. Mech. Eng., vol. 198, no. 3-4, pp. 555‚Äì571, 2008.
[27]
H. Lang and M. Arnold, ‚ÄúNumerical aspects in the dynamic simulation
of geometrically exact rods,‚Äù Appl. Numer. Math., vol. 62, no. 10, SI,
pp. 1411‚Äì1427, 2012.
[28]
E. Zupan, M. Saje, and D. Zupan, ‚ÄúQuaternion-based dynamics of
geometrically nonlinear spatial beams using the Runge-Kutta method,‚Äù
Finite Elem. Anal. Des., vol. 54, pp. 48‚Äì60, 2012.
[29]
E. Zupan, M. Saje, and D. Zupan, ‚ÄúDynamics of spatial beams in
quaternion description based on the Newmark integration scheme,‚Äù
Comput. Mech., vol. 51, no. 1, pp. 47‚Äì64, 2013.
[30]
M. E. Hosea and L. F. Shampine, ‚ÄúAnalysis and implementation of
TR-BDF2,‚Äù Appl. Numer. Math., vol. 20, no. 1-2, pp. 21‚Äì37, 1996.
[31]
J. P. Ward, Quaternions and Cayley Numbers.
Dordrecht‚ÄìBoston‚Äì
London: Kluwer Academic Publishers, 1997.
84
International Journal on Advances in Systems and Measurements, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/systems_and_measurements/
2017, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org

[32]
H. Lang and J. Linn, ‚ÄúLagrangian Ô¨Åeld theory in space-time for
geometrically exact Cosserat rods,‚Äù ITWM, Kaiserslautern, Reports of
the ITWM, no. 150, 2003.
[33]
S. S. Antman, ‚ÄúInvariant dissipative mechanisms for the spatial motion
of rods suggested by artiÔ¨Åcial viscosity,‚Äù J. Elast., vol. 70, no. 1-3, pp.
55‚Äì64, 2003.
[34]
D. Hodges, ‚ÄúGeometrically exact, intrinsic theory for dynamics of
curved and twisted anisotropic beams,‚Äù AIAA J., vol. 41, no. 6, pp.
1131‚Äì1137, 2003.
[35]
P. Cesarek and D. Zupan, ‚ÄúOn the stability of Lie group time integration
in multibody dynamics,‚Äù in The 2nd Joint Conference on Multibody
System Dynamics, May 29‚ÄìJune 1, 2012, Stuttgart, Germany. Book of
Abstracts, H. M. G¬®otz and P. Ziegler, Eds., pp. 42‚Äì43, 2012.
[36]
E. Zupan and D. Zupan, ‚ÄúVelocity-based approach in non-linear dynam-
ics of three-dimensional beams with enforced kinematic compatibility,‚Äù
Comput. Meth. Appl. Mech. Eng., vol. 310, pp. 406‚Äì428, 2016.
[37]
G. Jeleni¬¥c and M. A. CrisÔ¨Åeld, ‚ÄúGeometrically exact 3D beam theory:
implementation of a strain-invariant Ô¨Ånite element for statics and
dynamics,‚Äù Comput. Meth. Appl. Mech. Eng., vol. 171, no. 1-2, pp.
141‚Äì171, 1999.
[38]
J. C. Simo, N. Tarnow, and M. Doblare, ‚ÄúNonlinear dynamics of 3-
dimensional rods - exact energy and momentum conserving algorithms,‚Äù
Int. J. Numer. Methods Eng., vol. 38, no. 9, pp. 1431‚Äì1473, 1995.
85
International Journal on Advances in Systems and Measurements, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/systems_and_measurements/
2017, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org

