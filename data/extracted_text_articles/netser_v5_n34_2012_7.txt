248
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Interference Aware Routing Using Localized
Mobility Prediction for Multihomed Wireless
Networks
Preetha Thulasiraman
Department of Electrical and Computer Engineering
Naval Postgraduate School
Monterey, CA, USA
pthulas1@nps.edu
Abstract— In this paper, we present two novel algorithms to
deal with mobility prediction and interference aware routing for
multihomed wireless networks. First, a localized mobility pre-
diction algorithm, LMP, is developed using the Hidden Markov
Model (HMM) in which the multiple ﬁxed relay nodes in the
multihomed network architecture act as pseudo-base stations
to locally maintain and deliver mobility information collected
from surrounding mobile users. We show that the prediction
accuracy of our proposed prediction algorithm is better than
using common Markov chains to predict user location at a time
instant t. We also show that our mobility prediction algorithm
adapts better to a user node’s change in movement. Second, we
present a new interference aware routing algorithm in which
the signal to interference noise ratio (SINR) is used as the
routing metric to determine least interfering paths. The mobility
prediction algorithm is used as input to the routing algorithm
in order to accurately calculate the SINR value of a speciﬁc
link at particular time instances. This information is used to
perform route construction based on least interference. We solve
the least interference routing problem using a minimal cost ﬂow
optimization framework. We show that the integration of the
two algorithms outperforms conventional counterparts in the
literature in terms of packet delivery ratio and end-to-end-delay.
However, we also show that the tradeoff for increased network
performance lies in the ability of the algorithm to scale to very
large networks.
Keywords – Interference; hidden markov model; SINR routing;
prediction accuracy; minimum cost ﬂow optimization
I. INTRODUCTION
In recent years, services supported by mobile communi-
cations have expanded from simple voice trafﬁc to various
multimedia applications, resulting in the rise of 4G systems.
These 4G cellular systems are required to provide high and
homogeneous data rates over the complete cell coverage area
while assuring a level of quality of service (QoS). In traditional
cellular networks (in which each mobile station (MS) is di-
rectly connected to a base station (BS)), mobility management
is performed by the base station. In such networks, mobility
prediction is concerned with the user’s path when it is within
the coverage area of that base station. However, the traditional
cellular architecture has a structural weakness in providing fair
service because each user’s QoS depends on its location and
mobility within the cell. If a user is near the cell boundary,
it experiences severe path loss and poor spectral efﬁciency
compared to users near the base station. Thus, more resources
need to be allocated for cell boundary users to obtain the same
throughput.
Achieving the deﬁned 4G objectives requires installing
either a higher number of base stations, or integrating cellular
and ad-hoc networking technologies. The integration of cel-
lular and ad-hoc technologies, also referred to as Multihop
Cellular Networks (MCN), has gained signiﬁcant research
attention given its capacity to achieve the 4G objectives [1],
[2]. MCNs substitute the direct MS-BS link with multi-
hop links using intermediate nodes (relays) to retransmit the
information from source to destination. Various architectures
are available to MCNs [3], including both ﬁxed and mobile
relays. In this paper we focus on MCNs with ﬁxed relay
nodes where the base station communicates directly with ﬁxed
relay nodes which in turn cooperatively relay information in
an ad hoc fashion to other users in connectivity range. In
this architecture, each ﬁxed relay behaves as a “pseudo-base
station” or “home” for the mobile users by providing services
(i.e., routing and mobility management) that would normally
be taken care of by the base station in a centralized manner.
This is termed a multihomed MCN. The concept of multihom-
ing has been extensively discussed in the context of Mobile
IP [4] to improve network connectivity and manage mobility.
Multihomed architectures have also been predominantly used
to develop fault-tolerant routing protocols by ensuring that user
nodes have multiple connection opportunities in the event that
one home relay fails [5], [6].
A. Motivations and Related Work
Mobility management involving movement prediction relies
on the availability of prior information on the user’s mobility
behavior. Recently, prediction schemes using variations of the
Markov model, particularly the Hidden Markov Model (HMM)
have been proposed for resource management purposes in ad
hoc networks [7], [8]. These schemes use control theoretic
frameworks to dynamically allocate resources to users. Sim-
ilarly, mobility prediction in cellular networks has also been
researched in [9], [10], [11].
The cooperation between ﬁxed relays and the base station
is the cornerstone for efﬁcient communication at the network

249
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
layer. A mobile user is served by a nearby relay node that
forwards packets (potentially over multiple wireless hops) to
the base station. In addition to trafﬁc forwarding and route
decision making, the relays also have the responsibility of
managing user mobility by collecting information regarding
user movements from one home relay to another. This es-
sentially reduces the burden on the base station by localizing
mobility management.
A consequence of the increased use of ﬁxed relays is the
inherent interference that is induced. Wireless interference is
inﬂuenced by node mobility and can lead to performance
degradation. The time varying mobility patterns of the users
(i.e., speed, direction etc.) can cause new interference to be
induced at neighboring nodes [12]. Speciﬁcally, if a node n
moves from an area of low interference, A, to one of high
interference, B, then any transmission from n will contribute
to the interference of area B.
Interference can be controlled/mitigated in the network layer
i.e., with routing. In order to design an effective routing
algorithm that mitigates the interference experiences of the
wireless links, the mobility of the users must be considered.
Mobility assisted routing has been studied in the literature
for several years, more recently focusing on ad hoc and
delay tolerant networks [13], [14]. However, none of these
works discuss the direct impact of interference on the routing
protocols. More recently, in [12], mobility aware routing
using interference constraints was developed. However, the
interference is modeled using the protocol model which in-
duces binary conﬂicts (either two links interfere or they do
not despite neighboring simultaneous transmissions) which is
not true in practice. Our focus is on the use of the signal
to interference noise ratio (SINR) interference model (also
known as the physical interference model), which is based
on practical transceiver designs of communication systems
that treat interference as noise. Under the SINR model, a
transmission is successful if and only if the SINR at the
intended receiver exceeds a threshold such that the signal can
be decoded with acceptable bit error probability. Although
the SINR model has been shown to be more computationally
complex than the protocol model, it also provides a more
practical and realistic assessment of wireless interference [15].
Routing protocols using SINR to model interference have been
studied in both static networks [16], [17], [18] and mobile
networks [19]. However, although the work of [19] uses SINR
for route selection, the mobility modeling is based on the
random waypoint model, and therefore no speciﬁc mobility
prediction is introduced. In addition, [19] does not correlate
wireless interference with mobility.
Our objective in this paper is to study SINR and its rela-
tionship to interference based routing using localized mobility
management information. We extend our work given in [1]
by integrating an interference based routing structure into a
reﬁned mobility prediction algorithm.
B. Contributions and Organization
The contributions of this paper are two-fold. First, we
propose a localized (distributed) mobility prediction (LMP)
algorithm based on the HMM where the mobility information
(i.e., location) of each user at a time instant t is collected by
the corresponding home relay node for movement prediction
purposes. Second, we develop a routing protocol which uses
the location information of the mobile user to determine the
interference level on links in its surrounding neighborhood. We
use SINR as the routing metric to calculate the interference
on a speciﬁc link. The SINR represents the link cost. We
minimize the total cost of routing as a cost function of SINR
while guaranteeing that the load on each link does not exceed
its capacity, thereby determining least interfering paths from
each user to the base station. The routing protocol and the
proposed solution are solved using a combinatorial optimiza-
tion technique, known as the minimum-cost ﬂow problem in
the operations research literature.
The rest of the paper is organized as follows: Section II
describes the system model. In Section III, we discuss the
LMP algorithm used in this paper while in Section IV the
SINR based routing algorithm is developed. The performance
evaluation of the LMP and SINR routing algorithms is dis-
cussed in Section V. We conclude the paper in Section VI.
II. SYSTEM MODEL
The network topology used in this paper is based on the
MCN model used in emerging 4G broadband wireless access
networks [20]. The multihomed MCN that is the focus of this
paper is shown in Fig. 1. As shown, the network architecture
is based on three tiers of wireless devices: 1) user nodes which
are the lowest tier; 2) relay nodes that route packets between
the user and base station is the second tier; and 3) the base
station is the highest tier. Each home relay interacts with a
set of mobile users. It must be noted that a MS can directly
interact with a BS rather than a home relay if it is closer to
the BS than to the home relay. Let VN denote the number
of relay nodes and let VM denote the number of users. The
BS is connected to the wired infrastructure and behaves as
a gateway to the Internet. The LMP algorithm that is used
to predict the next location of each user node is handled
by the individual home relays. Each home relay collects and
maintains information regarding the movement of the mobile
users connected to it.
To understand the interaction between the various compo-
nents of our framework, we provide a block diagram given in
Fig. 2. The block diagram shows the LMP algorithm and its
relationship to the SINR based routing algorithm. The predic-
tion of the user’s movement is driven locally by a HMM that
is performed by each home relay. This means that the HMM
is used to represent the mobility pattern of the users. The
current mobility information and the history of the user’s past
movements is used to make predictions. This information is
maintained in the mobility database of each home relay which
keeps track of users that are connected, were connected or
will be connected (prediction) to the home relay. Speciﬁcally,
the database keeps track of which users are connected to the
relay and which users have moved away to another relay, base
station or cell. The idea of the mobility database was originally
developed in [7] and its implementation has been modiﬁed to
suit the needs of the work presented in this paper.

250
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Fig. 1.
Multihomed MCN where sets of user nodes are connected to a home relay and home relays communicate with other home relays in its transmission
range to transmit information to the base station
Fig. 2.
Block diagram that illustrates the interaction between the LMP algorithm and the interference aware routing algorithm. The home relay runs the
prediction algorithm and the SINR calculation for the routing procedure
The next predicted location of the mobile user, as deter-
mined by the home relay, is broadcast to other home relays
so that they may update their databases accordingly. This
updated information is then used to calculate the induced SINR
interference at the receiver to proactively construct paths with
least interference. The calculation of the SINR value at a time
t in a mobile setting must be computed instantaneously. To
facilitate the SINR calculation and the execution of the LMP
and routing algorithms, it is assumed that the user nodes are
quasi-mobile [21]; each user moves with a certain velocity
and for a time T stays at one location before moving to a new
random location.
III. LOCALIZED MOBILITY PREDICTION (LMP)
ALGORITHM
The prediction problem discussed in this section aims to
solve the following problem: Consider a mobile user con-
nected to relay node A. The user may move away from A to
relay node B after some time. Using the history and transition
paths, what is the likelihood that a user makes the transition
from A to B?
This problem has been dealt with using a Markov chain
model [8]. However, the drawbacks of using a simple Markov
chain model can be illustrated as follows. Referring to Fig. 3,
consider a MCN with 4 relay nodes, A,B,C and D. Initially
assume that a user connected to A moves from A to connect
to any of the other relays, B,C or D. The transition from A to
any of the other relay nodes may depend on proximity, signal
strength, etc. The Markov model given in Fig. 3 shows the
changes in direction as a sequence of probabilities based on
past states. The transition probability for the next state is based
on the most recent state. However, an external observer may
not be able to see all of these transitions. Some transitions
may be hidden from the observer by the user or the system.
For instance, if a user connects to any of the relay nodes, the
observer may only see the movement of the user from one
relay to another but may not be able to determine which relay
the user is connected to. Thus, the relay nodes are the hidden
states and the locations are the observable states. Because
there is no one-to-one mapping between these two states, the
problem is to identify the relays corresponding to the location
of the user.
A. Hidden Markov Model (HMM)
A HMM is a statistical Markov model in which the system
being modeled is assumed to be a Markov process with
unobserved (hidden) states. In a regular Markov model, the

251
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Fig. 3.
Example to show a simple Markov chain that depicts the transitions
of a mobile user to various relay nodes
state is directly visible to the observer, and therefore the
state transition probabilities are the only parameters. In a
HMM, the state is not directly visible, but output, dependent
on the state, is visible. A HMM has two kinds of stochastic
variables: state variables (hidden variable) and the output
variables (observable variable). A HMM can be deﬁned as
follows:
O : {o1o2...oN} are the values of the observed sequences
S : {s1s2...sN} are the N hidden states of the system
Π : {π} is the initial state probabilities. πi indicates the
probability of starting in state i
A = {aij} are the state transition probabilities where aij
denotes the probability of moving from state i to j
aij = P(tk = sj|tk−1 = si)
B = {bik} are the observation state probabilities where bik is
the probability of emitting symbol k at state i
bik = P(ok|tk = sj)
The 3-tuple (A, B, π) provides a complete speciﬁcation of
the HMM for the system considered in this paper.
To physically translate the HMM variables for the network
at hand, O represents the relay node that a user is connected
to presently. S represents which relay node a user will be
connected to at a future time (where N denotes the number
of relays) and Π is the set of state probabilities that indicate the
likelihood that a user node is initially connected to a relay node
i. A is the set of transition probabilities of a user node moving
from a relay node i to a relay node j. Lastly, B represents the
state probability of a user being connected to a relay node j
given that the user started at relay node k. Essentially, B is the
probability of an observed sequence. Given the parameters of
the HMM model, the task is to compute the probability of an
output sequence (i.e., which relay a user node is connected).
B. Localized Mobility Prediction Using HMM
To track the state of a mobile user we apply two approaches:
1) forward-backward algorithm and 2) re-estimation algorithm
for the HMM parameters discussed above. The main steps of
the tracking algorithm can be summarized as follows:
1) Apply HMM re-estimation algorithm to obtain initial
estimates of (A, B, π) of the HMM.
2) Apply the HMM forward-backward estimation algo-
rithm to predict at time t the next state of a user.
3) Obtain reﬁned estimates of (A, B, π) by again applying
the HMM re-estimation algorithm to the given observa-
tion sequences.
In mobile systems, up to date information regarding a user’s
movements is difﬁcult to obtain. Estimation of the mobility
model parameters must in general be made based on in-
complete data. Due to physical constraints, transmission of
location data may not take place frequently enough to allow
precise tracking of the user’s state at all times. The task
of estimation from insufﬁcient data involves two important
aspects: (a) estimation and prediction of the user’s movement
behavior and (b) re-estimation of the model parameters based
on incomplete information. These steps are performed at each
home relay node during each observation time. We deﬁne the
observation interval as the time during which observations
(mobility information is collected) occur. The observation time
is denoted as T, and is indexed by 1, 2, ..., T. Time T is
deﬁned as the time during which the mobile user remains
stationary. During this time, observations are collected for the
LMP algorithm. Thus, the time during which the node remains
stationary is the predicted state of the mobile network in the
HMM.
1) Forward-Backward Algorithm: A forward-backward al-
gorithm is an algorithm for computing the probability of
a particular observation sequence in the context of hidden
Markov models [22]. It is essentially an inference algorithm
for HMM and consists of two steps. The ﬁrst step of the
algorithm computes a set of forward probabilities which
provide the probability of observing the ﬁrst k observations
in the sequence and ending in each of the possible Markov
model states (i.e., probability of ending up in any particular
state given the ﬁrst k observations). The second step of the
algorithm computes a set of backward probabilities which pro-
vide the probability of observing the remaining observations
given an initial state (i.e., probability of observing remaining
observations given any starting point). These two sets of
probabilities can then be combined to provide the probability
of being in each state at a speciﬁc time during the observation
sequence. The forward-backward algorithm can thus be used
to ﬁnd the most likely state for a hidden Markov model at any
time.
For our model, we deﬁne the following forward and
backward variables:
Forward
variables
represent
the
probability
of
an
observation sequence {o1o2...oN} and a state si
at a
time T. The forward variables, denoted as α, are determined
as follows:
1) Initialization: αi = πbi(o1), 1 ≤ i ≤ N.
2) Induction: αt+1(j) = [PN
i=1 αt(i)aij]bj(ot+1), 1 ≤ t ≤
T − 1, 1 ≤ j ≤ N.
Backward
variables
represent
the
probability
of
an
observation sequence {o1o2...oN} from t + 1 to the end,
given state si at time t. The backward variables, denoted as

252
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
β, are determined as follows:
1) Initialization: βT (i) = 1, 1 ≤ i ≤ N.
2) Induction: βt(i) = PN
j=1 aijbj(ot+1)βt+1(j) 1 ≤ t ≤
T − 1, 1 ≤ j ≤ N.
The forward variables are computed inductively for t =
1, 2, ..., T. Similarly, the backward variables are computed
inductively for t = T, T −1, ..., 1. After computing the forward
and backward variables, a state estimate can be found. Let us
deﬁne,
γt(n) = P[ot; st = n]
as the probability that s is observed to be in state n at time t,
where s is a user node. Then the estimate of st is given by
ˆst = arg max1≤n≤N
γt(n)
P[ot] , t = T, T − 1, ..., 1
2) Re-estimation Algorithm: A simple iterative procedure
for re-estimating the HMM parameters is reported in [22].
By applying the well-known EM (Expectation/Maximization)
algorithm [23], it can be shown that this iterative procedure is
increasing in likelihood. The overall computational complexity
of the re-estimation algorithm is essentially proportional to T.
Thus, the parameters of the HMM model can be estimated
effectively within our framework.
IV. SINR BASED ROUTING USING LOCALIZED MOBILITY
PREDICTION
This section will discuss the formulation of the SINR
routing algorithm using the developed LMP algorithm.
A. Challenge of Routing with Interference and Mobility
Using the LMP algorithm based on the HMM, we are able
to track the movement of the users to determine which relay
it is connected to. Given this information, routing from the
connected relay to the base station can take place through
multiple hops. Note that knowing to which relay a user is
connected is imperative to the calculation of interference. To
route in the presence of mobility and interference using link
based metrics is a fundamental challenge. Under generic short-
est path routing, the path length (which depends on the link
metric) is the only factor that decides the best route between
any source and the base station. Various examples of link
metrics in the literature, namely Euclidean distance, depend
solely on the two nodes forming the link. They are independent
of the existence of other paths from other users and the BS or
their shortest path routes. This, in turn, has led to the notion
of link metrics and link-based routing. However, interference
depends on the existence of other sources/intermediate relays
and their spatial separation. Thus, the routing decision of a
given source-base station pair becomes coupled to the routing
decision of other source-BS pairs.
To illustrate this, assume node a is transmitting to next hop b
and node u is transmitting to next hop v as shown in Fig. 4(a).
According to the non-linear decay of power with distance,
governed by Pr(z) = Pt ∗ z−α where Pt is the transmitted
power, z is the distance between transmitter and receiver and
(a) Node a is transmitting to node b and node u is transmitting to node
v
(b) Node a transmits to node c while node u continues to transmit to node
v
Fig. 4.
Illustration of the challenge of deﬁning an interference aware routing
metric in the presence of simultaneous transmissions and mobility
α is the pathloss exponent, the amount of interference at node
v from transmitters other than u is given by Iv
u = Pab ∗ z−α
av .
If node a was transmitting to a different node (i.e., node c),
as shown in Fig. 4(b), then the amount of interference seen
at node v would be different: Iu
v = Pac ∗ z−α
av . Note that
Pab is different from Pac. Thus, the interference induced on
link (u, v) (needed to compute its link metric) depends on the
routing decision of transmitter a which, in turn, depends on
the routing decision of transmitter u. Couple this scenario with
mobility in which node a is moving, then a more reﬁned time
based routing metric is required to gauge both interference and
the location of the node at that time.
To determine appropriate routing paths from the relay to the
BS that are cognizant of interference, we use SINR as a routing
metric. The SINR is an effective and practical metric to gauge
link quality because it takes interference and noise as well
as signal strength into account. Furthermore, with user nodes
moving, poor links are unpredictable and thus SINR based
routing decisions are useful to discover more robust paths.

253
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
B. Problem Formulation
For our analysis, we model the multihomed MCN as a
graph, G(V, E), where V is the set of nodes (relays, mobile
users and base station inclusive) and E is the set of links. Let
VM be the set of mobile users and let VN be the set of home
relays, where VM, VN ∈ V . Note that the network has only
one base station. The successful reception of a packet depends
on the received signal strength, the interference caused by the
simultaneously transmitting nodes, and the ambient noise level
η. The SINR of a link (i, j) is given as follows
SINRij =
Pj(i)
η + P
k∈V ′ Pj(k) ≥ β
(1)
where Pj(i) is the received power at node j due to node i,
V ′ is the subset of nodes in the network that are transmitting
simultaneously, and β is the SINR threshold. Our proposed
routing protocol is implemented to route data using the least
interfering path out of all path possibilities. If a link has a
high SINR, it is an indication that it is experiencing low
interference.
Each link (i, j) has an associated cost which is derived
from the SINR value calculation. Each link also has an
associated capacity denoted uij. The capacity is formulated
using Shannon’s formula, given in Eq.2.
uij = log2(1 + SINRij)
(2)
In addition, the ﬂow of packets from node i to its neighbor
j over wireless link (i, j) is represented by fij.
C. SINR Based Routing
The position of each user node at time t affects the cumu-
lative SINR on each link. The SINR is also affected by the
path loss model and channel gain. The SINR at time t on link
(i, j) is given by Eq.3,
SINR(t)ij =
GijPj(i)(t)
η + P
k∈V ′ GkjPj(k)(t) ≥ β
(3)
where Gij is the channel gain on link (i, j) (in the simulations,
the channel gain of each link is calculated using a Rayleigh
fading model and an appropriate path loss factor), Pj(i)(t) is
the received power at node j due to node i at time t, and k is a
simultaneously transmitting node. The corresponding capacity
uij is then modiﬁed to be
uij(t) = log2(1 + SINRij(t))
(4)
The SINR is calculated during each observation time, t ∈
T.The cost of each link is associated with the SINR value
obtained from Eq. 3.
In order to determine the least cost (least interfering) paths,
we use the minimum cost ﬂow optimization technique. In
our case, the cost of a link is motivated by the amount of
interference on that link due to neighboring transmissions
and/or noise. As we are using SINR as the routing metric,
the higher the SINR, the better the link quality. Therefore, we
want to minimize the inverse of the SINR value.
The objective of the SINR routing problem is to deliver all
the data packets generated by the user nodes to the base station
in the most cost-effective (least interfering) manner without
exceeding the link capacities. We can ﬁnd least interfering
paths for each user to the base station using the minimum
cost (in this case minimum interference) ﬂow optimization
framework. Formally, the problem can be stated as follows.
minimize
X
(i,j)∈E
SINRij(t)−1fij(t)
(5)
subject to
X
j:(i,j)∈E
fij(t) −
X
j:(j,i)∈E
fji(t) = di(t), ∀i ∈ VM
(6)
X
k:k∈VN∪BS
(
X
j:(k,j)∈E
fkj(t)−
X
j:(j,k)∈E
fjk(t)) = −
X
i:i∈VM
di(t)
(7)
0 ≤ fij(t) ≤ uij(t)
(8)
fij(t) ∈ Z+
(9)
In the above formulation, di represents the rate at which the
data packets are generated at user node i per unit time. The
ﬁrst constraint (Eq. 6) ensures ﬂow conservation at each node.
The second constraint (Eq. 7) ensures that the base station
receives all the packets generated by all the nodes. The ﬂow
of packets on a link must not exceed its capacity and this is
ensured by the third constraint (Eq. 8). The fourth constraint
(Eq. 9) ensures that the (packet) ﬂow values are integers.
The complexity of the above minimum cost ﬂow problem
is derived from [24] and shown to be ⃝(ϵ−2E(E + V )logP)
where E is the number of links in the network, V is number of
nodes in the network (users plus relays) and P is an integer
parameter that speciﬁes the largest cost on the link (largest
SINR value).
1) Solution: The above deﬁned problem is similar to the
minimum-cost ﬂow problem, known in the operations research
literature [25]. We will convert the above problem into the
minimum-cost circulation problem as follows.
1) Add a super source x, and a super base station node y,
to the graph G(V, E).
2) Add directed links (x, i), connecting the super source x
to node i, for all i ∈ VM ∪ VN. Set costs of these links
to 0 and the capacities to di.
3) Add directed links (j, y) connecting the base station and
relay nodes to the super base station y. Set costs of these
links to 0 and the capacities to inﬁnity.
4) Add a directed link (y, x) connecting the super base
station y to the super source x. Set the cost of the link
(y, x) to −|V |β and the capacity to inﬁnity, where β is
the minimum of any link cost (lower bound of SINR).
5) The modiﬁed graph is deﬁned as G′(V ∪{x, y}, E∪E′),
where E′ = {(x, i) : i ∈ VN ∪ VM} ∪ {(j, y) : j ∈
VM ∪ BS} ∪ {(y, x)}.
The minimum-cost problem shown above is solved using
the well-known minimum-cost ﬂow algorithm given in [26].
An advantage of the minimum-cost ﬂow algorithm is the
integrality of ﬂows. If all link capacities and expected data

254
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
rates of nodes are integers, then the minimum-cost ﬂow
algorithm can ﬁnd paths with integral ﬂow values.
2) Analysis of the Solution: The minimum path cost formu-
lation given in Eqs. 5-9 determines the least interfering paths
by minimizing the inverse of the SINR values of the links in
the network. In addition, it also routes ﬂows such that the link
capacities are not violated.
Pushing more ﬂow from x to y will decrease the overall
cost of the ﬂow due to the fact that the link from y back
to x has sufﬁciently large negative cost. It is clear that the
maximum ﬂow is bounded from above by F = d1 +d2 +...+
d|VM| because F is the maximum possible ﬂow going out of
x, the super source. There are two possibilities that have to
be analyzed.
Case 1: P
i:i∈VM fxi = P
i:i∈VM di
In this case, all the links of the form (x, i), i ∈ VM are
saturated. The maximum-ﬂow is restricted by the capacities
of these links. Consider a link (x, 1) having the capacity d1.
Since all the (x, i) links are saturated, the input ﬂow at node
1 must be d1 + P
j:(j,1)∈E fj1 and the output ﬂow must be
equal to the input ﬂow (ﬂow conservation). There must be
paths from node 1 to base stations which carry the ﬂow d1 +
P
j:(j,1)∈E fj1. The same argument holds for other nodes.
Case 2: P
i:i∈VM fxi < P
i:i∈VM di
In this case, the maximum ﬂow is restricted by the capacities
on the actual links ((i, j) ∈ E) of the network. The minimum
cost ﬂow algorithm will identify the paths from the user node i
to the base stations which carry the ﬂow d′
i where 0 ≤ d′
i ≤ di,
∀i ∈ VM. The ﬂow on the links (x, i) would be d′
i, ∀i ∈ VM.
V. PERFORMANCE EVALUATION
A. Simulation Model and Performance Metrics
The LMP prediction algorithm and SINR based routing
scheme have been simulated to verify their performance. The
LMP prediction engine is ﬁrst separately tested for accuracy
in predicting the future mobility of users. For comparison,
we use a generic Markov chain and a second-order Markov
chain to gauge the prediction accuracy of the three methods.
A second-order Markov chain can be deﬁned as
P = P[Relaynext|Relaycurrent, Relayprevious]
When the users make ﬁrst contact with a relay, there is no
history of data from this user that can be utilized, so the
initial parameters of the HMM are randomly generated using
a uniform distribution (the number and locations of users
and relays, relay-user associations and the initial transition
probabilities are randomly generated). Once the users begin
to move, its movement history is tracked and stored in the
databases of each relay for prediction.
To evaluate the LMP algorithm, we look at its prediction
accuracy. The prediction accuracy is one of the most impor-
tant metrics for the veriﬁcation of any mobility prediction
algorithm. Prediction accuracy is deﬁned as the ratio of the
number of times a user moves to different relays to the ability
of the system to predict the location. For example if node
n moves to relay A and then to relay B, and our prediction
algorithm predicts correctly that it moved to A but not B, then
the prediction accuracy is 50%.
We use NS-2 to simulate our evaluations and use CPLEX
to solve the optimization formulation for the minimum cost
SINR based routing algorithm. The simulation environment is
based on a 2250m x 2250m region with 14 relay nodes, 120
user nodes and one base station. The network environment
is simulated using the NS-2 software platform, with the BS
located at the center of the environment. The locations of
the user nodes are randomly generated and then ﬁxed in
place. The propagation loss is modeled using the Rayleigh
fading model. The Rayleigh fading model allows us to capture
radio propagation signals that are not in the line of sight
(i.e., when there are many objects in the environment that
scatter the radio signal before it arrives at the receiver).
The received power, Pj(i)(t), is calculated according to the
radio propagation model at the receiver. For simplicity, the
transmission power of each relay node is set to 35dBm and
the transmission power of each user is set to 24dBm. We also
assume the radio transmission range to be 250m. The noise,
η, is calculated as additive white Gaussian noise (AWGN)
that is modeled as a Gaussian random variable. The pathloss
exponent (LOS/NLOS) is set to 2.35/3.76. The threshold β
for the SINR calculation is set to -18dB. The target SINR,
for optimal network performance is -12dB. These values are
deﬁned speciﬁcally for voice data as is discussed in [27].
The standard deviation of the SINR is 0.5dB. With a data
transmission rate of 2 Mbps, each run has been executed for
1000 seconds of simulation time. Constant bit rate (CBR)
sources transmit UDP-based trafﬁc at 4 packets per second and
the data payload of each packet is 512 bytes long. The speed
of the user nodes range from 1.5m/s to 5m/s. The simulated
networks have 256 subcarriers with a system bandwidth of
2MHz. We also use different observation times, T. All results
shown are an average of 20 different simulations.
To evaluate the SINR based routing scheme, we evaluate
the following performance metrics:
• Packet Delivery Ratio: ratio of the number of data packets
successfully delivered to the destination over the number
of data packets sent by the source.
• End-to-End Delay: the average delay for a packet to reach
from the source to the BS.
• Routing Overhead: Routing overhead is deﬁned as the
number of packet re-transmissions required because of
packet drops/losses due to interference.
As benchmarks we compare with two interference aware
routing metrics that use SINR as the routing metric, given
in [16] and [19].
B. Simulation Results: Localized Mobility Prediction (LMP)
When the user nodes make ﬁrst contact with a relay node,
the initial, randomly generated parameters of the HMM are
used. Each network that is simulated has 14 relay nodes
(randomly placed), 120 user nodes (randomly placed) and 1
BS.
We ﬁrst look at the performance of the LMP algorithm for
two random users in the network and compare against the

255
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Markov and 2nd-order Markov chains. Fig. 5 and Fig. 6 show
the prediction accuracy in percentages for the two users in the
network. From these ﬁgures we can conclude that the LMP has
an advantage in prediction accuracy compared to the Markov
and 2nd-order Markov chains. The results also show that the
HMM can better adapt to a user’s change in movement. In
other words, the LMP learns faster than the generic Markov
based approaches.
Fig. 5.
Comparison of prediction accuracy for the proposed LMP algorithm,
generic Markov chain and second-order Markov chain for User Node 1 in
networks with 120 users, 14 relay nodes and 1 base station
Fig. 6.
Comparison of prediction accuracy for the proposed LMP algorithm,
generic Markov chain and second-order Markov chain for User Node 2 in
networks with 120 users, 14 relay nodes and 1 base station
C. Simulation Results of SINR Based Routing Algorithm
The performance of the SINR routing algorithm is evaluated
compared to two SINR based routing algorithms given in [16]
and [19]. In [16], an algorithm, 2-HEAR, is developed in
which a routing metric is used such that a node calculates the
SINR to its neighboring links based on a 2-hop interference
range only. In [19], a modiﬁed version of the AODV routing
algorithm is proposed in which SINR is used to calculate the
route quality while using a random waypoint mobility model.
We denote the above approaches as 2-HEAR and AODV-
INT, respectively, in the simulation graphs. The same networks
used in the LMP simulations of Section V-B are used in the
simulations of the SINR routing algorithm. To calculate the
SINR, we take the following steps.
We ﬁrst evaluate the packet delivery ratio for our SINR
based routing algorithm and its two relevant counterparts in the
literature. In Fig. 7 and Fig. 8, the results of the packet delivery
ratio for varying node speed and observation times (T = 10ms,
T = 1ms, respectively) are shown. From the results it can
be seen that our algorithm provides better packet delivery
ratios when compared to the other approaches. We can justify
the better performance of our results as follows: In 2-HEAR
the SINR calculated by each node only includes those nodes
within a 2-hop range which means that even if interference
beyond this range occurs, it is not captured in the routing
metric. If the interference level is high beyond the 2-hop range,
packet drops may occur, requiring re-transmissions.The results
of the algorithm from AODV-INT are better than 2-HEAR,
however because AODV-INT does not use a speciﬁc mobil-
ity prediction model, it fails to capture precise interference
information as is done in our proposed routing algorithm. It
must be noted that the efﬁciency of the LMP-SINR routing
algorithm is decreasing as speed increases (see Figs. 7 and 8).
The faster the nodes move, the more likely the channels on
which they are transmitting experience greater interference and
fading. Thus, if the SINR is low, the efﬁcacy of the LMP-SINR
routing algorithm will decrease.
Fig. 7.
Packet delivery ratio versus varying node speeds for T = 10ms
In addition, we also look at the effect of varying the
observation time against the packet delivery ratio and show
that with increasing T, the packet delivery ratio increases.
The results are shown in Fig. 9, in which node speed is kept

256
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Fig. 8.
Packet delivery ratio versus varying node speeds for T = 1ms
constant at 3m/s. This intuitively makes sense because T is
essentially the amount of time used to observe the mobility of
a node. The larger the value of T, the longer the LMP has to
gather information leading to more accurate SINR calculation.
This ultimately leads to better routes (less interference) and
increases packet delivery ratios. This can also be seen in
Figs. 7 and 8 in which packet delivery ratios are higher with
T = 10ms.
Fig. 9.
Effect of varying T values on packet delivery ratio
We next evaluate the end-to-end delay of our algorithm
for varying node speeds and T
= 1ms. The results are
shown in Fig. 10. The average end-to-end delay is improved
compared to 2-HEAR and AODV-INT mainly due to more
robust routes and less route discoveries. Note that the more
reliable routes in our scheme signiﬁcantly reduce the number
of route discoveries and re-transmissions. This explanation
also holds for the routing overhead produced by our proposed
routing algorithm and that of 2-HEAR and AODV-INT. The
Fig. 10.
End-to-end delay for T = 1ms and varying node speed
routing overhead measured in this paper is that of how many
packet re-transmissions are required when a routing path
fails due to increased interference. The routing overhead is
a measure of the number of data re-transmissions required per
connection between a transmitter and receiver. Our calculation
of interference is signiﬁcantly more robust and inclusive than
that of 2-HEAR and AODV-INT. Thus, the paths determined
using our scheme are much more reliable, thereby indicating
that the transmissions will be successful more often, requiring
fewer re-transmissions of data. The results of the routing
overhead, shown in Fig. 11, illustrate that the overhead of
our scheme is less than that of the other two benchmarks.
Fig. 11.
Routing overhead for T = 1ms and varying node speed
Lastly, we look at the ability of our routing algorithm to
scale to larger networks. The simulations shown in this paper
were performed on networks with 120 user nodes and 14
relay nodes. When the algorithm is simulated on networks
with 200 nodes or more, we found that the algorithm takes an

257
International Journal on Advances in Networks and Services, vol 5 no 3 & 4, year 2012, http://www.iariajournals.org/networks_and_services/
2012, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
inordinate amount of time to converge. The primary reason
for this is the time it takes to solve the minimum cost
optimization formulation given in Eqs. 5-9. The running time
of the optimization formulation, which is a function of the
number of links and nodes in the network, does not scale to
large networks. Thus, the performance improvement we see
in terms of packet delivery ratio and end-to-end delay is a
tradeoff for scalability.
VI. CONCLUSION
Mobility and wireless interference jointly inﬂuence the per-
formance of wireless networks. In this paper we ﬁrst developed
a localized mobility prediction (LMP) algorithm using a Hid-
den Markov Model (HMM) for multihomed wireless networks.
The mobility of each user is governed locally by individual
home relays that capture and store mobility information. We
then developed an interference aware routing algorithm using
SINR as the routing metric, in which least interfering paths
between each user and base station are found. In order to take
into consideration the mobility of the user nodes within the
routing algorithm, we use the LMP as input to the routing
algorithm to predict the location of a user at time t. This
predicted location is then used to proactively determine the
SINR on each individual link. We formulated and solved the
routing algorithm using a minimum cost (in our case minimum
interference) ﬂow optimization technique such that the link
capacities are not violated. We showed that our LMP algo-
rithm provides better prediction accuracy when compared to
conventional Markov based mobility predictors. We also show
that our SINR based routing algorithm guarantees minimum
interference paths by increasing the packet delivery ratio and
reducing latency compared to established SINR based routing
approaches in the literature. In our future work, we plan to
integrate the mobility of relay nodes to analyze the impact
of SINR induced interference on routing and overall network
performance.
ACKNOWLEDGEMENT
This work was funded by the Research Initiation Program
(RIP) at the Naval Postgraduate School, Monterey, CA, USA.
REFERENCES
[1] P. Thulasiraman,
“Mobility aware routing for multihomed wireless
networks under interference constraints,” in Proceedings of International
Conference on Emerging Network Intelligence (EMERGING), 2011, pp.
57–62.
[2] Y.-D. Lin and Y.-C. Hsu, “Multihop cellular: a new architecture for
wireless communications,” in Proceedings of IEEE INFOCOM, 2000,
pp. 1273–1282.
[3] X.J. Li, B.-C. Seet, and P.H.J. Chong,
“Multihop cellular networks:
Technology and economics,” Computer Networks (Elsevier), vol. 52,
no. 9, pp. 1825–1837, June 2008.
[4] Y. Li, D.-W. Kum, W.-K. Seo, and Y.-Z Cho,
“A multihoming
support scheme with localized shim protocol in proxy mobile ipv6,”
in Proceedings of IEEE ICC, 2009, pp. 1–5.
[5] P. Thulasiraman, S. Ramasubramanian, and M. Krunz, “Disjoint multi-
path routing to two distinct drains in a multi-drain sensor network,” in
Proceedings of IEEE INFOCOM, 2007, pp. 643–651.
[6] Y. Amir, C. Danilov, R. Musaloiu-Elefteri, and N. Rivera, “An inter-
domain routing protocol for multi-homed wireless mesh networks,” in
Proceedings of IEEE WoWMoM, 2007, pp. 1–10.
[7] P.S. Prasad and P. Agrawal, “Movement prediction in wireless networks
using mobility traces,” in Proceedings of IEEE CCNC, 2010, pp. 1–5.
[8] P.S. Prasad and P. Agrawal, “Mobility prediction for wireless network
resource management,” in Proceedings of IEEE SSST, 2009, pp. 98–102.
[9] W. Cui and X. Shen,
“User movement tendency prediction and call
admission control for cellular networks,” in Proceedings of IEEE ICC,
2000, pp. 670–674.
[10] W.-S. Soh and H.S. Kim, “Dynamic bandwidth reservation in cellular
networks using road topology based mobility prediction,” in Proceedings
of IEEE INFOCOM, 2004, pp. 2766–2777.
[11] H. Si, Y. Wang, J. Yuan, and X. Shan, “Mobility prediction in cellular
network using hidden markov model,” in Proceedings of IEEE CCNC,
2010, pp. 1–5.
[12] R. Langer, N. Bouabdallah, and R. Boutaba, “Mobility-aware clustering
algorithms with interference constraints in wireless mesh networks,”
Computer Networks, vol. 53, no. 1, pp. 25–44, January 2009.
[13] L. Badia, N. Bui, M. Miozzo, M. Rossi, and M. Zorzi, “Mobility-aided
routing in multi-hop heterogeneous networks with group mobility,” in
Proceedings of IEEE GLOBECOM, 2007, pp. 4915–4919.
[14] T. Spyropoulos, K. Psounis, and C. S. Raghavendra, “Efﬁcient routing
in intermittently connected mobile networks: the multiple-copy case,”
IEEE/ACM Transactions on Networking, vol. 16, no. 1, pp. 77–90,
February 2008.
[15] A. Iyer, C. Rosenberg, and A. Karnik,
“What is the right model
for wireless channel interference?,”
IEEE Transactions on Wireless
Communications, vol. 8, no. 5, pp. 2662–2671, May 2009.
[16] R.M. Kortebi, Y. Gourhant, and N. Agoulmine, “On the use of sinr
for interference-aware routing in wireless multi-hop networks,”
in
Proceedings of ACM MSWiM, 2007, pp. 395–399.
[17] S. Kwon and N.B. Schroff,
“Energy-efﬁcient sinr-based routing for
multihop wireless networks,” IEEE Transactions on Mobile Computing,
vol. 8, no. 5, May 2009.
[18] P. Thulasiraman, J. Chen, and X. Shen, “Multipath routing and max-min
fair qos provisioning under interference constraints in wireless multihop
networks,” IEEE Transactions on Parallel and Distributed Systems, vol.
22, no. 5, pp. 716–728, March 2011.
[19] J. Park, S. Moh, and I. Chung, “A multipath aodv routing protocol in
mobile ad hoc networks with sinr-based route selection,” in Proceedings
of IEEE International Symposium on Wireless Communication Systems
(ISWCS), 2008, pp. 682–686.
[20] W. H. Park and S. Bahk, “Resource management policies for ﬁxed relays
in cellular networks,” Elsevier Computer Communications, vol. 32, no.
34, pp. 703–711, March 2009.
[21] R.C. Ramos and L.F.G. Perez, “Quasi mobile ip-based architecture for
seamless interworking between wlan and gprs networks,” in Proceedings
of IEEE Conferences on Electrical and Electronics Engineering (CIE),
2005, pp. 455–458.
[22] S.-Z. Yu and H. Kobayashi, “Practical implementation of an efﬁcient
forward-backward algorithm for an explicit-duration hidden markov
model,” IEEE Transactions on Signal Processing, vol. 54, no. 5, pp.
1947–1951, May 2006.
[23] W. Turin, Digital Transmission Systems, McGraw Hill, 1998.
[24] L.K. Fleischer, “Approximating fractional multicommodity ﬂow inde-
pendent of the number of commodities,”
SIAM Journal of Discrete
Mathematics, vol. 13, no. 4, pp. 505–520, October 2000.
[25] R. Ahuja, T. Magnanti, and J. Orlin, Network Flows, Prentice Hall,
1993.
[26] J. Orlin, “A faster strongly polynomial minimum cost ﬂow algorithm,”
Operations Research, vol. 41, no. 2, pp. 338–350, 1993.
[27] M. El-Sayes and M.H. Ahmed, “An upper bound on sinr threshold for
call admission control in multiple-class cdma systems with imperfect
power-control,” in Proceddings of IEEE VTC-Spring, 2007, pp. 2817–
2821.

