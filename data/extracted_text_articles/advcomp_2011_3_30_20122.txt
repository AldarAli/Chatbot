Image Restoration by Revised Bayesian-Based
Iterative Method
Sigeru Omatu,
Hideo Araki
Osaka Institute of Tecnology
Asahi-ku, Osaka, 535-8585, Osaka, Japan,
Hirakata, Osaka, Japan
omatu@rsh.oit.ac.jp, araki@is.oit.ac.jp
Abstract—A restoration method of the degraded images based
on Bayesian-based iterative method is proposed. An iterative
method is developed by treating images, point spread functions,
and degraded images as probability measures and by applying
Bayes’ theorem. The method functions effectively in the presence
of noise and is adaptable to computer operation.
Keywords-point spread function, image restoration, Bayesian
rule
I. INTRODUCTION
To make a clear image from degraded image, many enhance-
ment techniques have been developed until now. The main
technique is to use one of sharpness ﬁlters that are based on
derivatives of the image with respect to pixels [1]-[2]. These
methods used one or more masks to approximate a derivative
operation. Although they could enhance the image, they would
enlarge also noises.
The present method for enhancement of images is to use
the Bayesian rule. This method was ﬁrst proposed by [3].
The Bayesian rule reﬂects optimal estimation in a sense to
minimize the cost function under noisy observation and an
iterative algorithm was proposed to ﬁnd the optimal solution.
The algorithm include two parts, the ﬁrst one is to estimate
a point spread function (PSF) from the estimated image and
the second one is to estimate the original image by using the
estimated PSF. Thus, this algorithm might be optimal when
the observed image is similar to the original image, that is, in
case of a high S/N ratio. Therefore, the results will depend on
the initial guesses of PSF.
In this paper, we propose a new algorithm to speed up
the convergence and ﬁnd better restoration compared with the
results of [3]. The idea is to select the observed image as an
initial guess of the restored image and every iteration we use
the observation image instead of an estimated image when we
estimate the PSF.
First, we will show the principle of the Bayesian-based
iterative method proposed by Richardson[3]. Then we will
state the proposed method. After that the simulation results
will be illustrated to show the effectiveness of the present
method.
II. PRINCIPLE OF IMAGE RESTORATION
In image enhancement, the ultimate goal of restoration tech-
niques is to improve a given image in some sense. Restoration
is a process that attempts to recover an image that has been
Original 
image
Degraded 
image
PSF 
∗
=
∗
=
H(jω) =
x
=
x
?
H(jω)
F(jω)
=
x
=
Fig. 1.
The restoration principle.
degraded by using a priori knowledge of the degradation
phenomenon. As shown in Fig. 1, the degradation process may
be modeled as an operator H in case of noiseless situation.
It operates on an input image f(x, y) to produce a degraded
image g(x, y). For the sake of simplicity, we denote f(x, y)
by f(x) , g(x, y) by g(x), h(x, y) by h(x), etc. In equation
form, we have
g(x) = Hf(x) = h ∗ f(x) =
∞
X
y=−∞
h(x − y)f(y).
(1)
where h(x) is an impulse response and * denotes the operation
of convolution.
Based on the convolution theorem, the frequency domain
representation of Eq.(1) becomes
G(jω) = H(jω)F(jω)
(2)
where G(jω), H(jω), and F(jω) are Fourier transforms
of g(x), h(x − y), and f(y), respectively. As shown in
Fig.1,Given G(jω) and some knowledge about H(jω), the
objective of restoration techniques is to recover F(jω) which
means to recover the original image f(x) via the inverse
Fourier transform.
60
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-172-4
ADVCOMP 2011 : The Fifth International Conference on Advanced Engineering Computing and Applications in Sciences

III. RICHARDSON’S ITERATIVE METHOD
We will review the iterative method by Richardson [3] in
this section. Given the degraded image g, the point spread
function h and the original image f are estimated based on
Bayes’ theorem. It will be effective to estimate the original
image f from the observed image g. It was assumed that g ,
h , and f are discrete and are not necessarily normalized. The
numerical values of g , h , and f are considered as measures
of the frequency of the occurrence of them at those points.
h is usually in normalized form. Energy of f originating at
a point is distributed as g at points according to the energy
indicated by h. Thus, g represents the resulting sums of the
energy of f originating at all points.
In the notation of this problem the usual form of the Bayes’
theorem is stated as the conditional probability of f, given g.
It was assumed that the degraded image g was of the form
g = h ∗ f, where * denotes the operation of convolution such
that
g(x) = h ∗ f(x) =
∞
X
y=−∞
h(x − y)f(y).
(3)
Note that f and g are intensity functions of original image
and observed image, respectively and h is the weighting func-
tion depending on image measurement devices. We assume
that the input image and the weighting function which means
the restoration mechanism are unknown. The values of f, g,
and h are not limited within [0,1]. We normalize and denote
them by f ′, g′, and h′. Thus, we have
f ′(x)
=
f(x)
∞
X
x=−∞
f(x)
= f(x)
F
(4)
g′(x)
=
g(x)
∞
X
x=−∞
g(x)
= g(x)
G
(5)
h′(x)
=
h(x)
∞
X
x=−∞
h(x) == h(x)
H
(6)
where F,G, and H could be equal since the restoration
process is conservative. Note that f, g, and h are nonnegative
and the total sums are equal to one. Thus, we could regard
them as probability measures and f ′(x1) as the probability
measure of the original image f(x1) at x1. This means that
the possibility of the existing intensity of the original image
f(x1) at x1. Similarly, g′(x2) and h′(x1) mean the possibility
of the existing intensity of the observed image g′(x2) at x2 and
the possibility of the transition weight from the input image
f(x1) at x1 to the output image g(x2) at x2. Therefore, we
have
P(g(x2)|f(x1)) = P(h(x2 − x1)) = h′(x2 − x1).
(7)
The above relation can be derived by using the following
relation.
P(g(x2), f(x1))
=
P(g(x2)|f(x1))P(f(x1))
=
P(h ∗ f(x2), f(x1))
=
P(h(x2 − x1), f(x1))
=
P(h(x2 − x1))P(f(x1))
where we have used independence assumption between orig-
inal image and restoration mechanism.
Using the Bayes’ theorem we have
P(f(x)|g(x2))
=
P(g(x2)|f(x))P(f(x))
∞
X
x1=−∞
P(g(x2)|f(x1))P(f(x1))
=
f ′(x)h′(x2 − x)
∞
X
x1=−∞
f ′(x1)h′(x2 − x1)
.
(8)
If we multiply the both sides of Eq.(8) by P(g(x2)) = g′(x2)
and take the summation with respect to x2, we get
P(f(x))
=
f ′(x)
=
f ′(x)
∞
X
x2=−∞
h′(x2 − x)g′(x2)
∞
X
x1=−∞
f ′(x1)h′(x2 − x1)
.(9)
Considering F = G = H and multiplying them both sides of
the above equation, we have
f(x) = f(x)
∞
X
x2=−∞
h(x2 − x)g(x2)
∞
X
x1=−∞
f(x1)h(x2 − x1)
.
(10)
Using the above equation, Richardson[3] proposed the follow-
ing recurrence procedure to ﬁnd the original image f(x).
fn+1(x)
=
fn(x)
∞
X
x2=−∞
hn(x2 − x)g(x2)
∞
X
x1=−∞
hn(x2 − x1)fn(x1)
,(11)
n
=
0, 1, 2, . . . .
In order to derive the recursive equation of the PSF function
h(x), we will set x3 = x2 − x. Then from Eq.(8) we have
P(f(x2 − x3)|g(x2)) =
f ′(x2 − x3)h′(x3)
∞
X
x1=−∞
f ′(x1)h′(x2 − x1)
.
(12)
Multiplying both sides of the above equation by P(g(x2)) =
g′(x2), we have
P(f(x2 − x3)|g(x2))P(g(x2))
(13)
= g′(x2)
f ′(x2 − x3)h′(x3)
∞
X
x1=−∞
f ′(x1)h′(x2 − x1)
.
61
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-172-4
ADVCOMP 2011 : The Fifth International Conference on Advanced Engineering Computing and Applications in Sciences

Using the Bayes’ rule, we have
P(f(x2 − x3)|g(x2))P(g(x2))
= P(f(x2 − x3), g(x2))
= P(g(x2)|f(x2 − x3))P(f(x2 − x3))
= h′(x3)f ′(x2 − x3).
(14)
From Eqs.(14)and (14), we have
h′(x3)f ′(x2 − x3)
= g′(x2)
f ′(x2 − x3)h′(x3)
∞
X
x1=−∞
f ′(x1)h′(x2 − x1)
.
(15)
Taking the summation of both sides of Eq.(15) with respect to
x2, using the relation of Eqs.(4), (5), and (6), and noting that
∞
X
x2=−∞
f ′(x2 − x3) = 1,
(16)
we have the following relation.
h(x) = h(x)
∞
X
x2=−∞
f(x2 − x)g(x2)
∞
X
x1=−∞
f(x1)h(x2 − x1)
.
(17)
Thus, using the same recursive relation as Eq.(11), we have
hm+1(x) = hm(x)
∞
X
x2=−∞
fn(x2 − x)g(x2)
∞
X
x1=−∞
fn(x1)hm(x2 − x1)
.
(18)
In order to check the convergences of the recursive relations
given by Eqs.(11) and (18), the following relations are used.
∞
X
x2=−∞
h(x2 − x)g(x2)
∞
X
x1=−∞
h(x2 − x1)fn(x1)
= 1,
(19)
∞
X
x2=−∞
f(x2 − x)g(x2)
∞
X
x1=−∞
f(x1)h(x2 − x1)
= 1.
(20)
(21)
Thus, we use the following criteria to stop the iterations.
1 − ϵ <
∞
X
x2=−∞
hm(x2 − x)g(x2)
∞
X
x1=−∞
hm(x2 − x1)fn(x1)
< 1 − ϵ,
(22)
1 − ϵ <
∞
X
x2=−∞
fn(x2 − x)g(x2)
∞
X
x1=−∞
fn(x1)hm(x2 − x1)
< 1 − ϵ.
(23)
Using the above relations, Richardson has proposed the fol-
lowing iterative algorithm(Richardson’s Iterative Method).
Step 1. Set n = 0, m = 0, the initial guesses of h0(x), and
f0(x), and small positive number ϵ.
Step 2. Solve the following equations:
fn+1(x) = fn(x)
∞
X
x2=−∞
hm(x2 − x)g(x2)
∞
X
x1=−∞
hm(x2 − x1)fn(x1)
(24)
hm+1(x) = hm(x)
∞
X
x2=−∞
fn(x2 − x)g(x2)
∞
X
x1=−∞
fn(x1)hm(x2 − x1)
.
(25)
Step 3. If the following inequalities hold
¯¯¯¯¯
∞
X
x2=−∞
hm(x2 − x)g(x2)
∞
X
x1=−∞
hm(x2 − x1)fn(x1)
¯¯¯¯¯ < 1 − ϵ
(26)
and
¯¯¯¯¯
∞
X
x2=−∞
fn(x2 − x)g(x2)
∞
X
x1=−∞
fn(x1)hm(x2 − x1)
¯¯¯¯¯ < 1 − ϵ,
(27)
then stop, otherwise n ← n + 1, m ← m + 1 go to Step 2.
The above iteration has no proof of convergence that means
the results obtained by the above iteration may result in the
good results or may not.
IV. PROPOSED ALGORITHM
In order to get the better results compared with Richardson’s
algorithm, we consider a new method based on the property
of degraded images such that the blurred images are similar
to the original images. In the Richardson’s algorithm, if the
bad estimation of hm(x) at the beginning stage, correspond-
ing recovered images would become different images. After
obtaining the bad estimation of recovered images, worse esti-
mation of the point spread function. As a result, the iteration
will produce worse and worse estimation of the point spread
function and recovered images. Assuming the degraded images
are not so far from the original images, we use the blurred
image to estimate the point spread function hm(x) instead of
the recovered image that is the estimated image. Therefore,
we have proposed the following algorithm:
Step 1. Set n = 0, m = 0, small positive number ϵ, and
f0(x) = g(x). Set the initial guesses of h0(x).
Step 2. Solve the following equations:
fn+1(x) = fn(x)
∞
X
x2=−∞
hm(x2 − x)g(x2)
∞
X
x1=−∞
hm(x2 − x1)fn(x1)
(28)
hm+1(x) = hm(x)
∞
X
x2=−∞
g(x2 − x)g(x2)
∞
X
x1=−∞
g(x1)hm(x2 − x1)
. (29)
62
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-172-4
ADVCOMP 2011 : The Fifth International Conference on Advanced Engineering Computing and Applications in Sciences

Step 3. If the following inequalities hold
¯¯¯¯¯
∞
X
x2=−∞
hm(x2 − x)g(x2)
∞
X
x1=−∞
hm(x2 − x1)fn(x1)
¯¯¯¯¯ < 1 − ϵ
(30)
and
¯¯¯¯¯
∞
X
x2=−∞
fn(x2 − x)g(x2)
∞
X
x1=−∞
fn(x1)hm(x2 − x1)
¯¯¯¯¯ < 1 − ϵ,
(31)
then stop, otherwise n ← n + 1 and go to Step 2.
V. VARIATION USING THE REVERSE FUNCTION
We consider more simple form of the proposed algorithm.
We set the dominator of Eq.(11) by
Lnm(x2) =
∞
X
x1=−∞
hm(x2 − x1)fn(x1).
(32)
It is the convolution sum between the original image fn(x1)
and the point spread function hm(x2 − x1). Therefore, if
Lnm(x2) = g(x2), then the estimated image fn(x1) becomes
the true original image. Furthermore, we have
fn+1(x) = fn(x)
∞
X
x2=−∞
hm(x2 − x)g(x2)
Lnm(x2)
.
(33)
We deﬁne rnm(x2) by
rnm(x2) =
g(x2)
Lnm(x2)
(34)
which means the ratio between the observed degraded image
and the degraded image obtained by using the estimated point
spread function. Then Eq.(33) becomes
fn+1(x) = fn(x)
∞
X
x2=−∞
hm(x2 − x)rnm(x2).
(35)
We deﬁne the reverse function of k(x) by k(x) = h(−x).
Then Eq.(??) becomes
fn+1(x) = fn(x)
∞
X
x2=−∞
km(x − x2)rnm(x2)
.
(36)
If we represent the convolution sum by Fourier transform, we
have
fn+1(x)
=
fn(x)FT −1(FT(kn(x − x2))FT(rnm(x2)))
=
fn(x)FT −1(Kn(jω)Rnm(jω))
(37)
where FT and FT −1 denote the Fourier transform and inverse
Fourier transform. Since Km(jω) = Hm(−jω), we could save
the computational time by half.
 
 
 
 
(a) Original image           (b) Degraded image
(c) Richrdson method      (d) Proposed method
Fig. 2.
The comparison for Example 1.
VI. SIMULATION RESULTS
In order to show the effectiveness of the proposed method,
we will consider gray image (Example 1) and color im-
age(Example 2). The computer speciﬁcation used here is
shown in TABLE I. In Example 1 the gray image of 64 × 64
was made using Photoshop. The color image of512 × 512 of
Example 2 was cropped from the standard sample data of high-
resolution color images [4]. The degraded images are made
by using Gaussian ﬁlters with the standard deviation σ = 2.0.
We used the stopping parameters of m and n when maximum
iteration number k is given. In these simulations, we changed
those parameters (m, n, k) in three cases, that is, (10,100,10),
(5,100,10), and (5,5,100). TABLE II shows simulation results
for three cases with PSNR (Peak Signal-to-Noise Ratio). In
Fig. 2 shows the simulation results of the gray image with
(10,100,10). From this Fig. 2 the proposed method restored
more clear image compared with the results by Richardson’s
method [3]. In Figs.3-6 we show the simulation results of
Example 2. The original image is shown in Fig. 3 and the
degraded image is shown in Fig. 4. The restored images by
[3] and the proposed method are shown in Fig. 5and Fig. 6.
TABLE I
COMPUTING ENVIRONMENT
OS
Windows XP
CPU
AMD Athlon(tm)64 X2 Dual Core
Memory
2GB
TABLE II
PSNR BETWEEN ORIGINAL IMAGE AND RESTORED IMAGE
Threshold value(m,n,k)
Degraded image
Richardson
Authors
(10,100,10)
14.5
15.7
16.6
(5,100,10)
14.5
16.5
16.0
(5,5,100
14.5
9.2
16.2
63
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-172-4
ADVCOMP 2011 : The Fifth International Conference on Advanced Engineering Computing and Applications in Sciences

 
Original image
Fig. 3.
Original image for Example 2.
Degraded image
Fig. 4.
Degraded image for Example 2.
 
Richardson’ s  method
Fig. 5.
Richardson’s method for Example 2.
 
Proposed method
Fig. 6.
Proposed method for Example 2.
64
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-172-4
ADVCOMP 2011 : The Fifth International Conference on Advanced Engineering Computing and Applications in Sciences

VII. CONCLUSIONS
In this paper, a method of restoration of the degraded images
by using Bayesian-based iterative method. The simulation
results showed that the proposed method could restore the
degraded images more clearly compared with the Richardson’s
method while the threshold values of (n, m, k) must be deter-
mined by trial and error. Furthermore, the computation load
has been decreased by half by introducing the ratio between
the observed degraded image and the degraded image.
ACKNOWLEDGMENT
This work was supported by JSPS KAKENHI Grant-in-Aid
for Scientiﬁc Research (B) (23360175). The authors would
like to thank JSPS to support this research work.
REFERENCES
[1] T. Young and K. Fu, Handbook of Pattern Recognition and Image
ProcessingIndependent Component, Academic Press, New york, (1986)
[2] R. Duda, P. Hart, and D. stork, Pattern Classiﬁcation, John Wiley & Sions,
New York, (2001)
[3] W. Richardson, Baysian-Based Iterative Method of Image Restoration,
Journal of Optical Society of America, Vol. 62, pp.55-59, (1972)
[4] Standard Color Digital Images of High-Resolution(CMYK/SCID), JIS X
9201:2001, (2001)
65
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-172-4
ADVCOMP 2011 : The Fifth International Conference on Advanced Engineering Computing and Applications in Sciences

