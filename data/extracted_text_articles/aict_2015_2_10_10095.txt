Low Computational Design of Large Transmit Array MIMO
Using Flexible Subarray Grouping
Tetsuki Taniguchi and Yoshio Karasawa
The University of Electro-Communications (UEC)
Tokyo, 182-8585 Japan
email: taniguch@ee.uec.ac.jp, karasawa@radio3.ee.uec.ac.jp
Abstract—This paper presents an improved version of low com-
putational block diagonalization for Multiple Input Multiple
Output (MIMO) multiuser telecommunication system equipped
with a large array in transmitter side. While uniform subarray
structure simply based on antenna index is adopted in previ-
ous work, this study investigates the effective ﬂexible subarray
grouping based on channel condition between antenna elements
and receivers. In subarray grouping of large transmit array, all
antenna elements are ﬁrst sorted in the descent order of a certain
metric, and then, they are grouped into subarrays according
to a certain rule (in this paper, two metrics and two rules are
considered). Through computer simulations, it is shown that this
scheme is not effective for uniform subarray, but in nonuiform
construction, it could achieve performance improvement under
certain conditions.
Keywords–Large array antenna; massive Multiple Input Multi-
ple Output (MIMO); multiuser; subarray; zero-forcing.
I.
INTRODUCTION
Multiple Input Multiple Output (MIMO) telecommuni-
cation system which utilizes array antenna in both of the
transmitter and receiver sides has been established as a strategy
which increases the data rate and/or reliability in the wire-
less communications [1]. To cope with the further increasing
demand of the capacity, recently collecting attentions is so-
called large or massive MIMO [2] which is equipped with
large array one or both ends. It is actively studied also in
industrial sector as given in [3]-[5]. In this system, the main
topic is how to reduce the heavy computational load originated
from a large number of antenna elements. For this aim, many
approaches based on nonlinear processing [6] like suboptimal
search method (for example, the application of tabu search in
uplink for maximal likelihood detection [7], and in downlink
for vector perturbation [8]) and belief propagation [9] have
been proposed.
In the previous work [10], paying attentions to the fact that
the linear processing approach which is popular in the conven-
tional MIMO multiuser communication is not well investigated
for the large array antenna model, we have proposed low
computational version of block diagonalization for the MIMO
system with large transmit array. This system ﬁrst divide a
large array into subarrays, and then, block diagonalization is
applied to each of them: in [10], the subarrays are uniformly
grouped simply based on antenna index not considering the
state of the transmit antenna element to user connection. This
study investigates the effect of more sophisticated grouping
based on the channel condition between transmit antenna
element to user, where two types of ordering metrics and two
types of grouping rules are considered. Intuitively, subarray
grouping based on the connection strength seems to bring
performance improvement, but as shown later, this prediction
does not consist in simple case like [10]. Then, when it is
effective? How much is the improvement? The answers of
those questions and features of ﬂexible subarray grouping are
shown in this paper.
The overall organization is as follows: Section II gives the
system model of the multiuser MIMO considered in this study.
Section III describes the low computational design method of
the multiuser MIMO with large transit array utilizing the ﬂexi-
ble subarray grouping. In Section IV, evaluation of the system
performance is carried out through computer simulations based
on the comparison with the conventional methods. Finally, in
Section V, the conclusions of this study are described together
with the future works.
II.
SYSTEM MODEL
The model of MIMO multiuser system considered in this
study is depicted in Figure 1, which consists of a transmitter
Tx with Nt antennas and M receivers Rx0, · · · , RxM−1
with Nr,0, · · · , Nr,M−1 antennas, respectively. Transmitter
Tx transmits Lm data streams {sm,0(t), · · · , sm,Lm−1(t)}
to
receiver
Rxm
using
Nt-dimensional
weight
vectors
wt,m,0, · · · , wt,m,Lm−1. After passing propagation channel
represented by Nr,m-by-Nt matrix Hm, a replica ˆsm,ℓ(t)
of data stream sm,ℓ(t) is produced at Rxm using Nr,m-
dimensional weight vector wr,m,ℓ. Here, the (nr, mt)-th ele-
ment of Hm is the channel response between the nt-th element
of transmit array and the nr-th element of receive array.
Though the picture of Figure 1 shows a typical MIMO
multiuser downlink model, here, one assumption is added: the
transmitter Tx has a large number of antenna elements (namely,
Nt is a large number: in this study, Nt = 128) as shown in the
simulation section (on the other hand, Nr,m is assumed to be a
small number: in this study, Nr,m = 2). Under this condition,
generally, a heavy computational load is required for the design
of the transmit weight, and the reduction of computation is an
important topic in this kind of system. One solution is given
in [10], and the next section suggests its improved version
attempting better performance.
III.
SYSTEM DESIGN
In the previous work in [10], we have presented a low
computational design method of MIMO downlink system with
a large transmit array, based on block diagonalization [6],
which is a popular linear processing technique of multiuser
MIMO. This section describes an improved version with
ﬂexible subarray grouping taking into account the channel
condition.
First, a large transmit antenna is divided into S subarrays
Tx0, · · · , TxS−1. Subarray Txs consists of antennas with
index set N (s)
t
= {nt,s,0, · · · , nt,s,Nt,s−1}, where any
24
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-411-4
AICT 2015 : The Eleventh Advanced International Conference on Telecommunications

,0 0 ( )
t
s
,1 0 ( )
t
s
0
t − 2
N
( )
ˆ
,0 0
t
s
0
0
r 1, −1
N
1
0
r, −
N
0
1
1
,
−
r M −
N
0
H
1( )
0
0
t
s L −
1 ( )
,1
1
t
s L −
1( )
,1
1
t
s
LM
M
−
−
−
,1 0 ( )
t
sM −
1
( )
ˆ
1
0,
0
t
s
L −
ˆ 0 ( )
,1
t
s
( )
ˆ
1
,1
1
t
s L −
( )
ˆ
1
,1
1
t
s
LM
M
−
−
−
( )
ˆ
,1 0
t
sM −
1
H
M −1
H
t −1
N
Fig. 1 Model of MIMO multiuser system (downlink).
antenna element belongs to only one of S subarrays (therefore,
Nt = ∑ Ns,k consists). Here, the problem is how to construct
those subarrays. Though uniform subarrays are constructed
simply in the order antenna index regardless of the channel
state in [10], namely, N (s)
t
= sNt,0 + {0, · · · , Nt,0 − 1} (re-
mark that Nt,s = Nt,0 for any s), in this study, we consider
ﬂexible subarray grouping. The whole procedure of ﬂexible
subarray grouping is depicted in Figure 2.
In the ﬁrst step, one of the following two metrics based
on the channel condition between the nt-th transmit antenna
element and the m-th receiver end is calculated:
(M-1) Norm Metric: This metric is deﬁned by fnt = ∥hm,nt∥,
where hm,nt is a Single Input Multiple Output (SIMO) channel
deﬁned by hm,nt = [Hm,0,nt, · · · , Hm,Nr,m−1,nt]T , and
Hm,nr,nt is a scalar which shows response between the nt-th
antenna element of Tx and the nr-th antenna element of Rxm.
(M-2) Absolute Sum Metric: This metric is deﬁned by equation
fnt =
∑
nr
|Hm,nr,nt|, which does not require any multipli-
cation operation. It is more preferable choice compared with
norm metric from the viewpoint of the computational cost (re-
mark that since the calculation of metric is carried out user by
user, advantage of this simplicity becomes large).
In the following, the transmit antenna elements are renumbered
in descent order, namely, indices {nt,0 nt,1 · · · , nt,Nt−1}
such that fnt,0
≥ fnt,1
≥ · · · ≥ fnt,Nt−1 are replaced
by new indices {0, 1, · · · , Nt − 1} (after this operation,
f0 ≥ f1 ≥ · · · ≥ fNt−1 consists). The conventional approach
in [10] can be regarded as a scheme adopting random number
as metric fnt because of the i.i.d. (independent and identically
distributed) statistics of the fading.
In the second step, based on the above ordering, subarray
grouping is carried out according to one of the following two
rules:
(R-1) Even Grouping: Antenna 0, 1, 2, · · · are grouped into
N (0)
t
, N (1)
t
, N (2)
t
, · · · in the order of the antenna index
after the renumbering. If it reached to s = S − 1 (namely,
N (S−1)
t
= {S − 1}), then the subarray index return to 0,
like N (0)
t
= N (0)
t
∪ {S}, N (1)
t
= N (1)
t
∪ {S + 1}, · · · .
If the number of elements in N (s)
t
has reached to Nt,s, this
subarray is excluded from the above circulation. This operation
attempts to keep the average metric of all the subarrays equal
as possible.
(R-2) Uneven Grouping: Transmit antennas are grouped like
N (s)
t
=
s−1
∑
k=0
Nt,k + {0, · · · , Nt,s}, namely, Nt,0 antennas
with the strongest metric are grouped into the ﬁrst subarray,
and those with the next strongest Nt,1 are distributed to the
second subarray. This operation is repeated all the Nt elements
are grouped into one of subarrays.
As a consequence of the above subarray grouping, sub-
channel between subarray Txs and receiver Rxm is derived as
H(s)
m = [hm,nt,s,0, · · · , hm,nt,s,Nt,s−1].
After subarray construction, the conventional block diag-
onalization is applied to each subarray. Since the optimal re-
ceiver weight is different subarray by subarray, two methods −
Method 1 (Tx and Rx simultaneous design) and Method 2 (Rx
ﬁrst Tx second design) − are considered to determine it
uniquely (for the detail, see [10]).
(i) Method 1: Subarray weight vector w(s)
t,m
= V (s)
m v(s)
m
is
calculated
by
block
diagonalization
of
H(s)
m ,
where
the
columns
of
V (s)
m
span
the
kernel
of
H(s)
−m
=
[H(s)T
0
, · · · , H(s)T
m−1, H(s)T
m+1, · · · , H(s)T
M−1], and v(s)
m
is
the right singular value vector of H(s)
m V (s)
m
correspond-
ing
to
the
largest
singular
value.
Then,
virtual
chan-
nel Hv,m
=
[H(0)
m w(0)
t,m,
· · · ,
H(S−1)
m
w(S−1)
t,m
] is cal-
25
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-411-4
AICT 2015 : The Eleventh Advanced International Conference on Telecommunications

m 0,
h
m1,
h
2
,
m N t −
h
1
,
m N t −
h
mx
R
Tx
Tx
0
0
,tn
1,tn
1
,
N t −
tn
x
T
1
t −1
N
(0)
,
,
t m l
w
1)
(
,
,
S−
t m
l
w
0
1
0)
( −
Νt
0
S
S −1
1
2
−
S
(R-1)
Even
(R-2)
Uneven
0
Tx
1
T
−
Sx
1
,
1,
,0
−
≥
≥
≥
t Nt
t
t
n
n
n
f
f
f
L
Ordering
Renumbering
Metric
(M-1)
Norm
(M-2)
Abs. Sum
∑
−
=
Ν
1
0
)
(
s
k
s
t
−1
Ν t
Subarray Grouping
Fig. 2 Procedure of ﬂexible subarray grouping.
culated, and transmitter and receiver weights wt,m,ℓ
=
[c(0)
m,ℓw(0)T
t,m , · · · , c(S−1)
m,ℓ
w(S−1)T
t,m
]T and wr,m,ℓ are derived,
where wr,m,ℓ and cm,ℓ = [c(0)
m,ℓ, · · · , c(S−1)
m,ℓ
]T are the left
and right singular value vectors of Hv,m corresponding to the
ℓ-th largest singular value (it is deﬁned as ℓ = 0 for the largest
one).
(ii) Method 2: Receiver weight wr,m,ℓ is derived as the
left singular value vector of Hm, and then, channel ˜Hm =
[HT
mw∗
r,m,0, · · · , HT
mw∗
r,m,Lm−1]T . After the calculation of
w(s)
t,m and Hv,m is carried out in a similar manner as Method 1
but using ˜Hm instead of Hm, vector cm,ℓ = hm,ℓ is derived
from Hv,m = [hT
m,0, · · · , hT
m,Lm−1]T .
The additional computational cost introduced by the pro-
posed method is generally small. Once the metric is given,
that for the distribution to groups is almost negligible. For the
calculation of metrics, Nt
∑ Nr,m multiplications should be
performed under the use of norm metric, but if the absolute
sum metric with no multiplication suggested in this paper (the
performance degradation from the norm metric is very small)
is used, the complexity is only slightly increased, and not so
much different compared with that of BD.
IV.
COMPUTER SIMULATIONS
In this section, computer simulations are carried out to
verify the effectiveness and features of the proposed method
described in Section III. The default simulation conditions are
summarized in Table I.
The performance is evaluated using sum capacity repre-
sented by Cm =
∑
ℓ
log2(1 + SINRm,ℓ) for the m-th user,
where SINRm,ℓ is the Signal to Interference plus Noise Ra-
tio (SINR) of the output signal ˆsm,ℓ(t) of the ℓ-th stream of
the m-th user (it is calculated by using 200 samples of fading
channels). On the other hand, Signal to Noise Ratio (SNR) is
deﬁned by SNRm = Ps.m/Pn,m, where Ps,m = 1 and Pn,m
are the total energy of the transmitted signal and the receiver
noise.
The number of users is M = 4 and each of them is
equipped with Nr,m = 2 antennas, and two data streams are
send to Rxm (hence Lm = 2) using Nt = 128 antennas
from transmitter Tx based on the energy allocation by the
TABLE I.
SIMULATION CONDITIONS
Number of Receivers
(Number of Users)
M = 4
Number of Transmit Antennas
Nt = 128
Number of Receive Antennas
Nr,m = 2
Number of Streams per User
Lm = 2
Subarrays
(uniform)
S = 16
Nt,s = 8
N (s)
t
= 8s + {0, · · · , 7}
s = 0, · · · , S − 1
Subarrays
(nonuniform)
S = 12
Nt,s=0∼3 = 16
N (s=0∼3)
t
= 16s
+{0, · · · , 15}
Nt,s=4∼S−1 = 8
N (s=4∼S−1)
t
= 8(s − 4)
+{0, · · · , 7} + 64
Grouping Metric
Absolute Sum
Grouping Rule
Uneven Grouping
Energy Constraint
Pm = 1
SNR
SNRm = 20dB
Channel Statistics
i.i.d. Rayleigh Fading
with unit variance
26
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-411-4
AICT 2015 : The Eleventh Advanced International Conference on Telecommunications

16
18
20
22
24
26
28
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Capacity [bit/s/Hz]
Cumulative Probability
 
 
Conv.
Method 1
Method 2
Method 1 (FG)
Method 2 (FG)
(a) Uniform subarray grouping.
20
21
22
23
24
25
26
27
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Capacity [bit/s/Hz]
Cumulative Probability
 
 
Conv.
Method 1
Method 2
Method 1 (FG)
Method 2 (FG)
(b) Nonuniform subarray grouping.
Fig. 3 Distribution function of capacity.
water ﬁlling. Under this condition, default size and number
of subarray are Nt,s = 8 and S = 16 for uniform case, and
Nt,s=0∼3 = 16, Nt,s=4∼S−1 = 8 and S = 12 for nonuniform
case.
Figure 3 depicts the distribution functions of capac-
ity (since the curves of all users are almost same because
of the symmetry of fading statistics in channels, it is drawn
only for one user) for the case of the absolute sum metric and
uneven grouping. Five curves respectively shows the results of
the conventional block diagonalization (Conv.), Method 1 and
Method 2 in [10], and those with ﬂexible subarray grouping in
Section III (Method 1 (FG) and Method 2 (FG)). In subplot (a)
for uniform subarray grouping, the curves of Method 1 (FG)
and Method 2 (FG) are overlapped with those of Method 1
and Method 2, which means ﬂexible grouping is not effective.
On the contrary, in nonuniform subarray grouping in subplot
(b), the performance of Method 1 (FG) and Method 2 (FG)
is better than that of Method 1 and Method 2, which means
ﬂexible grouping is effective (in this subplot, the position of the
curves of Method 2 and its FG version is moved to the right
8
10
12
14
16
18
20
19
20
21
22
23
24
25
26
Size of Large Subarray NL
Capacity [bit/s/Hz]
 
 
Conv.
Method 1
Method 2
Method 1 (FG)
Method 2 (FG)
Fig. 4 Large subarray size versus capacity.
1
2
3
4
5
6
7
8
20
21
22
23
24
25
26
Number of Large Subarray SL
Capacity [bit/s/Hz]
 
 
Conv.
Method 1
Method 2
Method 1 (FG)
Method 2 (FG)
Fig. 5 Number of large subarray versus capacity.
of those of Method 1 and its FG version, since the increased
degrees of freedom in a large subarray brings advantage to
Method 2 [10]). From those results, it is considered that the
proposed ﬂexible grouping approach is a better choice when
nonuniform array is adopted and antennas with the strong
connection to the user is grouped into large subarrays. Another
important point is that the performance improvement between
Method 2 and Method 2 (FG) is larger than that of Method 1
and Method 1 (FG).
Here, though the graph is not shown, the results of the norm
and absolute sum metrics have only slight difference, hence
we adopt absolute sum metric with much smaller computation
in the rest of the simulation. We have also veriﬁed that the
even grouping does not bring the performance improvement
regardless of subarray construction. The reason is considered
as follows: because of the randomness of the fading channel,
even without antenna ordering, the average metric becomes
almost same among subarrays.
To investigate the inﬂuence of the subarray size in the
proposed approach, Figure 4 plots the large subarray size NL
27
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-411-4
AICT 2015 : The Eleventh Advanced International Conference on Telecommunications

10
15
20
25
30
14
16
18
20
22
24
26
28
30
32
Signal to Noise Ratio [dB]
Capacity [bit/s/Hz]
 
 
Conv.
Method 1
Method 2
Method 1 (FG)
Method 2 (FG)
Fig. 6 SNR versus capacity.
versus capacity relation for nonuniform subarray construction.
Among S subarrays, four subarrays Txs=0∼3 have large size
NL = Nt,s=0∼3 ∈ {8, 10, 12, 14, 16, 18, 20}, and other
S − 4 subarrays have short size NS = Nt,s=4∼S−1 = 8.
According to the uneven grouping rules, the antennas with
strong connection to the target receiver are gathered into
large subarrays. From this ﬁgure, it can be veriﬁed that the
performance improvement by the proposed method becomes
larger as the large subarray size in nonuniform scheme is
increased. In this ﬁgure, Method 2 (FG) has better performance
than the conventional methods in [10] except the uniform case
of NS = NL = 8. It is also shown that the advantage of
Method 2 (FG) against Method 1 (FG) is large under the large
subarray size.
Figure 5 depicts the number of large subarray SL versus
capacity curves. Among S subarrays, Txs=0∼SL−1 have large
size NL = Nt,s=0∼SL−1 = 16, and other SS = S − SL
subarray have short size NS = Nt,s=SL∼S−1 = 8. What
can be observed from this picture is that the performance
improvement by the proposed method compared with the
conventional approach [10] becomes small as the number
of large subarray increases. This result shows the proposed
method is advantageous when the uniformity of the subarray
construction is small.
The relation between SNR and per-user capacity is drawn
in Figure 6. From this ﬁgure, it can be seen that the relation
among ﬁve methods does not depend on SNR.
V.
CONCLUSIONS AND FUTURE WORKS
This paper has investigated on ﬂexible subarray grouping in
low computational block diagonalization for MIMO multiuser
system adopting a large array in the transmitter side. All
transmit antenna elements are ﬁrst sorted in the descent order
of one of two metrics (norm and absolute sum), and then,
they are grouped into one of subarrays according to one of
two rules (even and uneven grouping). Computer simulations
have demonstrated that the proposed approach is useless for
uniform subarray construction, but as the nonuiformity of
subarray increases, one of two rules, uneven strategy invokes
its effectiveness under certain conditions, and the performance
improvement compared with the conventional approach in [10]
becomes larger, where also shown is the simple absolute sum
metric is sufﬁcient.
A future work is the investigation on the subarray process-
ing based on Minimum Mean Square Error (MMSE) criterion.
Utilization of the subarray strategy for the signal detection in
the large array is another attractive topic of study.
ACKNOWLEDGMENT
This research was supported in part by the Grant-in-Aid for
Scientiﬁc Research (No. 25249056) from Japan Society for the
Promotion of Science (JSPS).
REFERENCES
[1]
Y.-S. Cho, J. Kim, W.-Y. Yang, and C.-G. Kang, MIMO-OFDM
Wireless Communications with MATLAB, Wiley, 2010.
[2]
E. G. Larsson, O. Edfors, F. Tufvesson, and T. L. Marzetta, “Massive
MIMO for next generation wireless systems,” IEEE Commun. Mag.,
vol. 52, no. 2, Feb. 2014, pp. 186-195.
[3]
J. Hoydis, S. ten Brink, and M. Debbah, “Massive MIMO in the UL/DL
of cellular networks: how many antennas do we need?” IEEE J. Selec.
Areas Commun., vol. 31, no. 2, Feb. 2013, pp. 160-171.
[4]
C. Kim, T. Kim, and J.-Y. Seol, “Multi-beam transmission diversity with
hybrid beamforming for MIMO-OFDM systems,” 2013 IEEE Globecom
Workshops, Dec. 2013, pp. 61-65.
[5]
S, Akoum and J. Acharya, “Full-dimensional MIMO for future cellular
networks,” 2014 IEEE Radio and Wireless Symposium (RWS 2014),
Jan. 2014, pp. 1-3.
[6]
Q. H. Spencer, C. B. Peel, A. L. Swindlehurst, and M. Haardt, “An
introduction to the multi-user MIMO downlink,” IEEE Commun. Mag.,
vol. 42, no. 10, Oct. 2004, pp. 60-67.
[7]
Y. Wu and J. McAllister, “FPGA-based Tabu search for detection in
large-scale MIMO systems,” 2014 IEEE Workshop Signal Process.
Syst. (SiPS 2014), Oct. 2014, pp. 1-6.
[8]
W. Ding, L. V. Tiejun, A. Hu, and Sixi Su, “A low-complexity vector
precoding scheme for large multiuser MIMO systems,” 2013 16th Int.
Symp. Wireless Personal Multimedia Commun. (WPMC 2013), June
2013, pp. 1-5.
[9]
S. Wu, L. Kuang, Z. Ni, J. Lu, D. D. Huang, and Q. Guo, “Low-
complexity iterative detection for large-scale multiuser MIMO-OFDM
systems using approximate message passing,” IEEE J. Selec. Topics
Signal Process, vol. 8, no. 5, Oct. 2014, pp. 902-915.
[10]
T. Taniguchi and Y. Karasawa, “A low computational design of mul-
tiuser MIMO system using large scale array antenna,” 2014 5th Int.
Conf. Network Future (NOF 2014), Dec. 2014, pp. 1-6.
28
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-411-4
AICT 2015 : The Eleventh Advanced International Conference on Telecommunications

