Tomotaka Hamada 
Dept. of Computer Science and Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: 24417582@stn.nitech.ac.jp 
Abstract— In this paper, Non-Binary Rate-Compatible 
Punctured Low Density Parity Check (NB RCP LDPC) code is 
designed over the extended Galois Field. The designed NB 
RCP LDPC code is applied to the type II Hybrid Automatic 
Repeat reQuest (HARQ) with Decode and Forward (DF) relay 
on 
Multiple 
Input 
Multiple 
Output 
(MIMO) 
Single 
Carrier-Frequency Division Multiple Access (SC-FDMA) 
up-links. The designed code enables us to decrease the coding 
rate with incremental redundancy for each retransmission in 
HARQ. The retransmission is done from the DF relay after the 
successful decoding in the relay. We have verified through 
computer simulations that the proposed type II HARQ scheme 
with DF relay greatly improves the throughput and average 
retransmission characteristics compared with the scheme 
without DF relay. Multiple relay cases are also considered. 
Keywords-NB RCP LDPC code; Hybrid-ARQ; Decode and 
Forward Relay; MIMO SC-FDMA; Symbol-LLR. 
I. INTRODUCTION 
An LDPC code which suits the flexible coding rate 
design and has the high error correcting capability through 
iterative decoding can be constructed on arbitrary extended 
Galois field. The Non-Binary (NB) LDPC code constructed 
on extended Galois field generally exhibits the better BER 
performance than the binary LDPC codes [1][2]. There also 
exist Rate-Compatible Punctured (RCP) LDPC codes with 
variable coding rate obtained by properly puncturing the 
mother LDPC code [3]. The RCP LDPC codes enable us to 
use the same decoder as the mother code and suit the ARQ 
error correcting schemes [4] with the incremental 
redundancy. By combining the NB LDPC codes with the 
RCP codes, the NB RCP LDPC codes were designed and 
the designed NB RCP LDPC codes were applied to the type 
II HARQ [5]. On the other hand, the Decode and Forward 
(DF) relay schemes [6] are useful for HARQ schemes. By 
using the DF relay, the source node can be replaced by the 
relay, once the relay correctly decodes the LDPC encoded 
packet from the source. This replacement from the source to 
the relay effectively reduces the number of retransmissions 
and improves the throughput. The NB RCP LDPC coded 
type II HARQ with DF relay is applied to the 
MIMO-OFDM modulation in [7]. The incremental 
redundancy in HARQ with DF relay is especially suited to 
the up-link transmission like in Long Term Evolution (LTE) 
or 4G. Due to the necessities of low Peak to Average Power 
Yasunori Iwanami 
Dept. of Computer Science and Engineering 
Nagoya Institute of Technology 
Nagoya, Japan 
E-mail: iwanami@nitech.ac.jp 
 
Ratio (PAPR) and the high power efficiency in the 
amplification, MIMO SC-FDMA [8] is usually adopted to 
the up-links in cellular networks. Among SC-FDMA, 
interleaved SC-FDMA is especially useful because of its 
very low PAPR nature and excellent frequency diversity 
effect [8]. In [9], NB LDPC coding with NB repletion codes 
is applied to multiple relay case for flat fading channel. 
However, the application of NB RCP LDPC codes to 
MIMO interleaved SC-FDMA with multiple DF relays has 
not been reported yet. In this paper, we have investigated 
the NB RCP LDPC coded type II HARQ with DF relays on 
MIMO interleaved SC-FDMA up-links. We have verified 
through computer simulations that the proposed up-link 
scheme greatly improves the throughput and the average 
number of retransmission characteristics compared with the 
case of no DF relay. Moreover, we considered multiple 
relay cases, i.e., serial or parallel arrangement of two relays. 
The paper is organized as follows. In Section II, RCP 
LDPC code is introduced. In Section III, NB LDPC coded 
Type II HARQ scheme is described. In Section IV, we 
propose the DF relaying scheme. In Section V, we present 
the symbol LLR generation in interleaved SC-FDMA 
demodulation. In Section VI, computer simulation results 
are shown. The paper concludes with Section VII. 
II. RCP LDPC CODE 
The encoding and decoding procedure of RCP LDPC 
code is as follows. We call the code before puncture and the 
code after puncture as the mother code and the punctured 
code, respectively. In RCP LDPC code, the encoder and 
decoder of mother code can also be applied to the punctured 
code. When the parity check matrix of mother code is given 
by 
(
)
M
M
N
n
× n
H
 and the generator matrix by 
(
)
N
K
M n
× n
G
 
with 
(
)
K
N
M
n
n
n
=
−
, the coding rate of mother code 
becomes 
(1
/
)
/
M
M
N
K
N
R
n
n
n
n
=
−
=
. The coding rate after 
the puncture of 
P
n  symbols from the mother code is given 
by 
(
)
E
K
N
P
R
n
n
n
=
−
∕
. We denote the message vector as 
1
2
(
,
,
,
nK )
m m
m
=
…
m
, the code word of mother code as 
1
2
(
,
,
,
N )
M
M
Mn
c
c
c
=
…
CM
, the index of position to be punctured 
as 
1
2
(
,
,
,
nP )
p p
p
=
…
P
 and the code word of punctured code 
as 
1
2
(
,
,
,
P )
P
P
Pn
P
c
c
c
C =

. The encoding procedure is first to 
generate the mother code by 
M =
M
C
mG
 which is 
systematic, and next, to puncture the position using P  to 
obtain
P
C . The decoding procedure is to produce the  
On Type II Hybrid-ARQ with Decode and Forward Relay using Non-Binary 
Rate-Compatible Punctured LDPC Code on MIMO SC-FDMA up-link 
112
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-347-6
ICWMC 2014 : The Tenth International Conference on Wireless and Mobile Communications

symbol LLR from the receive signal and it is fed to the 
mother code decoder as the initial value for the sum-product 
algorithm. The symbol LLR for the position P  is initially 
set to 0, because there is no available symbol LLR 
corresponding to the position P . 
III. NB RCP LDPC CODED TYPE II HARQ SCHEME 
In Fig. 1, we show the transmitter and receiver block 
diagram of NB RCP LDPC coded Type II HARQ using 2×2 
MIMO SC-FDMA. At the transmitter, the data bits are 
firstly encoded by the Cyclic Redundancy Check (CRC)-16 
error detecting code and secondly encoded by the NB 
LDPC code on GF(4) or GF(16). The encoded LDPC code 
word is divided into the transmission packets and they are 
modulated by QPSK or 16QAM depending on GF(4) or 
GF(16), respectively. Matching GF( )
Q  to the modulation 
level Q  is preferable in calculating the symbol LLR and 
reduces the complexity compared with the use of bit LLR 
calculation. The modulated QAM symbols are then N-point 
FFT transformed at each antenna stream and the subcarrier 
mapping is done to make the interleaved SC-FDMA 
spectrum as shown in Fig. 2. The interleaved spectrum is 
then M-point IFFT transformed, where M
U
N
=
×
 and U  
is the number of users. Cyclic Prefix (CP) is added to the 
time domain complex samples of an IFFT block. After the 
interpolation filtering and the up-conversion to carrier 
frequency, the RF signal is transmitted from each antenna. 
At the base station, after the down-conversion to baseband 
and the sampling, CP is removed and the M-point FFT is 
done to obtain the frequency domain signal. The frequency 
domain signal is then subcarrier-de-mapped to aggregate 
the interleaved spectrum of each user back to the N sample 
spectrum again. The Frequency Domain Equalization 
(FDE) is made to compensate the channel frequency 
response and separate the multiple spatial streams of each 
user. The FDE weight 
( )
Gu i
 in MMSE criterion is 
expressed as 
{
}
1
2
( )
( )
( )
( )
T
H
H
u
u
u
u
T
n
i
i
i
i
n σ
−
=
+
G
H
H
H
I
     (1) 
where 
( )
Hu i
 is 
T
T
n
×n
 channel matrix at subcarrier i  of 
user u , 
Tn  is the number of transmit antennas, 
2
σ  is the 
noise variance of each subcarrier and 
nI T
 is the identity 
matrix of size 
Tn . After the FDE, N-point IFFT is made to 
obtain the time domain signal of each stream in each user. 
The symbol LLR defined in section V is then calculated and 
fed to the NB LDPC decoder. Using Sum-Product 
Algorithm (SPA), the LDPC code word is decoded and the 
hard decision is made to obtain the data bits. The dada bits 
are then CRC-checked. NACK or ACK is returned to the 
transmitter of each user corresponding to the error or no 
error detection. 
In type II HARQ, like in Fig. 3, at the first transmission, 
only uncoded information symbols are transmitted, and at 
the second transmission and after, the parity check symbols 
are retransmitted at the incremental redundancy policy. 
Accordingly, when the channel condition is good, the first 
uncoded transmission is successful enough and it achieves 
high throughput. On the other hand, when the channel is 
bad, by decreasing the coding rate at each retransmission, 
the error correction capability increases gradually. The 
generation of RCP LDPC code is done only once at the 
transmitter and there is no need of regeneration of code 
word when the coding rate is decreased. Therefore there is 
no increase of complexity of RCP LDPC code compared 
with the fixed rate LDPC code. Also at the receiver side, the 
complexity of RCP LDPC decoder does not increase 
compared with the fixed rate LDPC decoder, because the 
same and only one LDPC decoder can be used for various 
coding rates of RCP LDPC code. 
 
 
 
 
Fig. 1 Transmitter and receiver structure of NB RCP LDPC coded type II 
HARQ scheme using 2×2 MIMO interleaved SC-FDMA 
 
 
Fig. 2 Sub-carrier mapping in interleaved SC-FDMA 
(Red, yellow, green and blue spectrum show the subcarriers of  
user 1, user 2, user 3 and user 4, respectively.) 
 
 
Fig. 3 Division of an LDPC code word into transmission packets 
N-point
FFT
Subcarrier
mapping
Transmitter
M-point
IFFT
N-point
FFT
Subcarrier
mapping
Input
data
M-point
IFFT
User 1
User U
・・・
NB LDPC  enc.
Transmit packet selection
QPSK or QAM  mod.
CRC  enc.
+CP
+CP
User 2
‐CP
M-point
FFT
‐CP
M-point
FFT
Subcarrier de-mapping
・・・
User 1
Output
data
Receiver
Sym. LLR  cal.
Sym. LLR  cal.
NB LDPC  dec.
NB LDPC  dec.
User U
Output
data
FDE
FDE
N-point
IFFT
N-point
IFFT
N-point
IFFT
N-point
IFFT
・・・
CRC  check
CRC  check
M
Total number of subcarriers
N subcarriers for each user
f
1 2 3 4 …
M
…
1 LDPC Block length (Rate=1/2) 
Data symbols 
Parity symbols 
 
Antenna1 
Antenna2 
1st 
transmission 
Division into packets 
2nd 
transmission 
3rd 
transmission 
113
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-347-6
ICWMC 2014 : The Tenth International Conference on Wireless and Mobile Communications

IV. DECODE AND FORWARD RELAYING SCHEME 
The Decode and Forward relay model is shown in Fig. 4. 
We consider the relay arrangement where the relay locates 
at the middle point between the source (transmitter at each 
user) and the destination (receiver at base station). 
 
Fig. 4 DF (Decode and Forward) relaying model 
 
At the first transmission, the source broadcasts the 
uncoded information packet to the relay and destination 
simultaneously. The relay and destination independently 
detect the transmission errors using CRC-16 code. The 
relay and destination independently return (broadcast) ACK 
or NACK to the source. This ACK or NACK is shared 
among source, relay and destination. If the destination 
returns ACK, the transmission finishes at the first 
transmission and this condition is equivalent to no relay. 
Otherwise, retransmission is made. The source sends parity 
check packets with incremental redundancy. The relay and 
destination receive the parity check packet and combine it 
with already received packet. The LDPC decoding and 
CRC error detection is done both at relay and destination. 
ACK or NACK is returned and shared among source, relay 
and destination. At this point, if destination returns NACK 
but relay does ACK, then the relay sends the parity check 
packet hereafter instead of source, i.e., the source is 
replaced by the relay which locates closer to destination. 
The transmission from relay to destination is more 
successful than source to destination due to the near 
distance between relay and destination. Also, as the source 
and relay do not simultaneously retransmit the parity check 
packet, the total transmission power is the same between 
with and without relay. This saves the total transmit energy 
in the case where the same power as source is allocated to 
the relay. 
Next, we consider the two relay cases where two relays 
are allocated in a serial or parallel manner as shown in Fig. 
5(b) or (c), respectively. Fig. 5 (a) is the arrangement of 
single relay already discussed. In Fig. 5 (b), two relays are 
allocated in the middle point between source and 
destination in parallel. In Fig. 5(c), relay 1 and relay 2 are 
allocated serially with equal distance interval between 
source and destination. When the power attenuation 
exponent is given by α  and the distance between source 
and destination is defined as 1, the relay at the middle point 
between source and destination in Fig. 5 (a) and (b) receives 
2α  times more power than the direct link between source 
and destination. Similarly, the relay 1 and relay 2 in Fig. 5 
(c) receives 3α  times more power than the direct link. 
 
Fig. 5 DF relay arrangement in case of multiple relays 
 
V. SYMBOL LLR GENERATION IN MIMO INTERLEAVED 
SC-FDMA DEMODULATION 
The received signal in time domain after N-point IFFT 
in Fig. 1 is expressed as 
2
2
,
1,
,
(1/ 2)
{
}
k
k
k
k
k
y
h x
n
k
N
E n
x
=
+
=
=
⋅

     (2) 
where 
kh  is the complex gain for the symbol 
kx  after the 
equalization and spatial de-multiplexing, and 
2
x  is the 
variance of receive noise. When the modulation level of 
QAM is given by Q  and the probability of occurrence of 
Q  symbols are all equal, i.e., 
1
( )
(
)
1/
Q
p s
p s
Q
=
=
=

, the 
symbol LLR is defined and calculated as 
(
)
(
)
(
)
(
)
(
)
(
)
1
1
1
1
2
1
2
2
2
2
1
2
2
1
2
2
1
2
2
|
(
|
) (
)
(
)
log
log
|
(
|
) ( )
(
)
exp
|
log
log
|
exp
k
k
k
k
a
k
k
a
a
k
a
k
k
k
k
a
k
k
k
a
k
k
a
y
h s
y
h s
p s
y
p y
s
p s
p y
p s
y
p y
s p s
p y
p y
s
p y
s
y
h s
y
h s
x
pσ
x
pσ
l
−
−








=
=




















−











=
=














−










−
−
+
−
=
2
2
,
1,
,
2
a
Q
x
= 
     (3) 
VI. COMPUTER SIMULATION RESULTS 
The BER characteristics of NB RCP LDPC code for 
each coding rate on GF(4) or GF(16) are examined. The 
simulation conditions are listed in the shaded area in Table I 
and the simulation results are shown in Fig. 6 and Fig. 7. 
C++ language is utilized for programming. We can see that 
each punctured code having different coding rate is 
obtained from the mother code with rate 1/2. Each 
punctured 
code 
shows 
the 
BER 
characteristics 
corresponding to its coding rate. 
Next, from Fig. 8~Fig. 15, we show the throughput and 
the average number of retransmission characteristics of NB 
RCP LDPC coded type II HARQ on 2 × 2 MIMO 
interleaved SC-FDMA. We have shown the simulation 
results for the single relay case of Fig. 5 (a) in Figs. 16 and 
17 and the serial two relay case of Fig. 5 (c) in Figs.9, 11, 
13, 15, 16 and 17. The simulation conditions are also listed 
in Table I. 
When QPSK modulation is employed, one GF(4) LDPC 
mother code word is divided into 16 packets. As the coding 
Source
Relay
Destination
Source
Relay1
Relay2
Source
Relay2
Relay1
(a) Single relay
(b) Parallel arrangement of 2 relays
(c) Serial arrangement of 2 relays
Destination
Destination
Source 
node 
Relay 
node 
Destination 
node 
𝐇𝑆𝑆 
𝐇𝑆𝑆 
𝐇𝑆𝑆 
Source 
node 
Relay 
node 
Destination 
node 
𝐇𝑆𝑆 
𝐇𝑆𝑆 
𝐇𝑆𝑆 
When error is detected at destination but not relay 
When error is detected at both destination and relay: 
Transmit 
 node 
Receive node 
114
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-347-6
ICWMC 2014 : The Tenth International Conference on Wireless and Mobile Communications

rate of mother LDPC code is 1/2, the former 8 packets 
contain only information symbols and the latter 8 packets 
consist of parity check symbols. For the 1st transmission, 8 
information packets are transmitted from two antennas. For 
the 2nd retransmission and after, two parity check packets 
are retransmitted at each retransmission resulting in 
lowering the coding rate at receiver from 4/5 to 4/6, 4/7, 4/8. 
After all the parity check packets are retransmitted and the 
coding rate at destination reaches 1/2, if error is still 
detected at destination, the same RCP LDPC code 
transmission is repeated two times and each time the 
symbol LLR’s are summed up at destination by symbol 
LLR addition. Thus, the total 3 transmissions of RCP LDPC 
code word are done before the final discard of RCP LDPC 
code in case of failure of error correction at destination. 
As a comparative scheme, we also considered the LDPC 
coded type I HARQ scheme where the coding rate is fixed 
for each retransmission. The maximum number of 
retransmissions is limited to 15 and the symbol LLR 
addition is employed at the destination. For QPSK and 
GF(4), the throughput characteristics and the average 
number of retransmission characteristics are shown in Fig. 8 
and Fig. 9 and in Fig. 12 and Fig. 13 respectively. 
When 16QAM modulation is employed, one GF(16) 
LDPC mother code word is divided into 8 packets. The 
former 4 packets contain only information symbols and the 
latter 4 packets consist of parity check symbols. The coding 
rate decreases from 2/3 to 2/4 at each retransmission. After 
all the packets are retransmitted and the coding rate at 
destination reaches 1/2, if error is still detected at 
destination, the same RCP LDPC transmission is repeated 3 
times in total, which is the same as the case of QPSK 
modulation as mentioned in the above. For 16QAM and 
GF(16), the throughput characteristics and the average 
number of retransmission characteristics are shown in Fig. 
10 and Fig. 11 and in Fig. 14 and Fig. 15, respectively. 
For the two serial relay case, we also show the 
throughput and the average number of retransmission 
characteristics in Fig. 16 and Fig. 17, respectively. 
Regarding the simulation results, we first compare the 
type I HARQ with the type II HARQ. The throughput 
characteristic of type I HARQ saturates in the high average 
0
Eb /
N  region, because the coding rate is fixed. As the 
coding rate of type I HARQ increases, the throughput also 
increases in the high average 
0
Eb /
N  region. On the other 
hand, the throughput of type II HARQ approaches to 4 
(bps/Hz) and 8 (bps/Hz) in case of QPSK and 16QAM, 
respectively, in the high 
0
Eb /
N  region. This is because 
type II HARQ can change the coding rate adaptively and it 
can use the coding rate of 1 for high SNR region. The slight 
decrease of throughput in type II HARQ is due to the use of 
CRC-16 error detection code. We also observe that for 
entire 
0
Eb /
N  region, the throughput of type II HARQ is 
optimized and is superior to type I HARQ. However, the 
average number of retransmission of type II HARQ is 
worse than type I HARQ. This is because parity check 
packets are sent sequentially with several time slots in type 
II HARQ, while the parity check packet is sent at a time in 
type I HARQ. 
Next, we compare the case with relay and without relay. 
When the average 
0
Eb /
N  is high, the throughput with 
relay is the same as without relay. This is because, both in 
the case with relay and without relay, the average number of 
retransmission is almost 0 for the high average 
0
Eb /
N  
region, and there makes no difference between the two. On 
the other hand, when the average 
0
Eb /
N  is low, we see 
that the throughput and the average number of  
TABLE I.  
SIMULATION CONDITIONS OF NB RCP LDPC CODED TYPE 
II HARQ WITH DF RELAY ON 2×2 MIMO INTERLEAVED SC-FDMA 
NB 
LDPC 
mother 
code 
Size of Galois field 
GF(4) 
GF(16) 
Size of parity check 
matrix 
(512,1024) 
(256,512) 
Average weight 
(2.66,5.32) 
(2.41,4.82) 
Coding rate 
4/8 
2/4 
Punctured 
code 
Information bit length 
1024 
Coding rate 
4/4,4/5,4/6, 
4/7,4/8 
2/2,2/3,2/4 
Max SPA iteration 
20 
Number of users U 
4 
Transmit and receive antennas 
2×2 
modulation 
QPSK 
16QAM 
Number of subcarriers / user 
N = 64 
Number of total subcarriers 
M = 256 
CP length (
sT :QAM symbol length) 
16 (
/ 4)
4
s
s
T
T
×
=
 
Channel model between each 
transmit and receive antenna 
Quasi-static Rayleigh fading 
with 16 delay paths having 
equal average power 
Interval of delay paths 
sT / 4
 
Channel State Information 
Known at receiver 
Error detecting code 
CRC-16 
Power attenuation exponent 
𝛼= 3 
 
 
Fig. 6 BER characteristics of NB RCP LDPC GF(4) code using 2
× 2
 
MIMO interleaved SC-FDMA (QPSK) 
 
 
Fig. 7 BER characteristics of NB RCP LDPC GF(16) code using 2
× 2
 
MIMO interleaved SC-FDMA (16QAM) 
1.00E-05
1.00E-04
1.00E-03
1.00E-02
1.00E-01
1.00E+00
-10
0
10
20
30
Average BER
Average Eb/N0[dB] at S-D link per receive antenna
Rate=4/8
Rate=4/7
Rate=4/6
Rate=4/5
Rate=4/4 
(Uncoded)
1.00E-05
1.00E-04
1.00E-03
1.00E-02
1.00E-01
1.00E+00
-10
0
10
20
30
Average BER
Average Eb/N0[dB] at S-D link per receive antenna
Rate=2/4
Rate=2/3
Rate=2/2 
(Uncoded)
115
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-347-6
ICWMC 2014 : The Tenth International Conference on Wireless and Mobile Communications

Fig. 8 Throughput characteristics of NB GF(4) RCP LDPC coded type II  
HARQ scheme with incremental redundancy and type I HARQ with fixed 
coding rate (without relay, 2
× 2
, QPSK) 
 
Fig. 9 Throughput characteristics of NB GF(4) RCP LDPC coded type II  
HARQ scheme with incremental redundancy and type I HARQ with fixed 
coding rate (with 2 serial relays, 2
× 2
, QPSK) 
 
 
Fig. 10 Throughput characteristics of NB GF(16) RCP LDPC coded type II 
HARQ scheme with incremental redundancy and type I HARQ with fixed 
coding rate (without relay, 2
× 2
, 16QAM) 
 
 
Fig. 11 Throughput characteristics of NB GF(16) RCP LDPC coded type II 
HARQ scheme with incremental redundancy and type I HARQ with fixed 
coding rate (with 2 serial relays, 2
× 2
, 16QAM) 
 
Fig. 12 Average number of retransmission of NB GF(4) RCP LDPC coded 
type II HARQ scheme with incremental redundancy and type I HARQ 
with fixed coding rate (without relay, 2
× 2
, QPSK) 
 
 
Fig. 13 Average number of retransmission of NB GF(4) RCP LDPC coded 
type II HARQ scheme with incremental redundancy and type I HARQ 
with fixed coding rate (with 2 serial relays, 2
× 2
, QPSK) 
 
 
Fig. 14 Average number of retransmission of NB GF(16) RCP LDPC 
coded type II HARQ scheme with incremental redundancy and type I 
HARQ with fixed coding rate (without relay, 2
× 2
, 16QAM) 
 
 
Fig. 15 Average number of retransmission of NB GF(16) RCP LDPC 
coded type II HARQ scheme with incremental redundancy and type I 
HARQ with fixed coding rate (with 2 serial relays, 2
× 2
, 16QAM) 
0
1
2
3
4
-20
-10
0
10
20
30
Throughput [bps/Hz]
Average Eb/N0[dB] at S-D link per receive antenna
Type II  
Rate=4/8,4/7, 
4/6,4/5,4/4
Type I Rate=4/8
Type I Rate=4/7
Type I Rate=4/6
Type I Rate=4/5
Type I Rate=4/4 
(Uncoded)
0
1
2
3
4
-20
-10
0
10
20
30
Throughput [bps/Hz]
Average Eb/N0[dB] at S-D link per receive antenna
Type II  
Rate=4/8,4/7, 
4/6,4/5,4/4
Type I Rate=4/8
Type I Rate=4/7
Type I Rate=4/6
Type I Rate=4/5
Type I Rate=4/4 
(Uncoded)
0
2
4
6
8
-20
-10
0
10
20
30
Throughput [bps/Hz]
Average Eb/N0[dB] at S-D link per receive antenna
Type II  
Rate=2/4,2/3, 
2/4
Type I 
Rate=2/4
Type I 
Rate=2/3
Type I 
Rate=2/2 
(Uncoded)
0
2
4
6
8
-20
-10
0
10
20
30
Throughput [bps/Hz]
Average Eb/N0[dB] at S-D link per receive antenna
Type II  
Rate=2/4,2/3, 
2/4
Type I 
Rate=2/4
Type I 
Rate=2/3
Type I 
Rate=2/2 
(Uncoded)
0
1
2
3
4
5
6
7
8
9
10
-20
-10
0
10
20
30
Average number of retransmission
Average Eb/N0[dB] at S-D link per receive antenna
Type II  
Rate=4/8,4/7, 
4/6,4/5,4/4
Type I Rate=4/8
Type I Rate=4/7
Type I Rate=4/6
Type I Rate=4/5
Type I Rate=4/4 
(Uncoded)
0
1
2
3
4
5
6
7
8
9
10
-20
-10
0
10
20
30
Average number of retransmission
Average Eb/N0[dB] at S-D link per receive antenna
Type II  
Rate=4/8,4/7, 
4/6,4/5,4/4
Type I Rate=4/8
Type I Rate=4/7
Type I Rate=4/6
Type I Rate=4/5
Type I Rate=4/4 
(Uncoded)
0
1
2
3
4
5
6
7
8
9
10
-20
-10
0
10
20
30
Average number of retransmission
Average Eb/N0[dB] at S-D link per receive antenna
Type II  
Rate=2/4,2/3, 
2/4
Type I 
Rate=2/4
Type I 
Rate=2/3
Type I 
Rate=2/2 
(Uncoded)
0
1
2
3
4
5
6
7
8
9
10
-20
-10
0
10
20
30
Average number of retransmission
Average Eb/N0[dB] at S-D link per receive antenna
Type II  
Rate=2/4,2/3, 
2/4
Type I 
Rate=2/4
Type I 
Rate=2/3
Type I 
Rate=2/2 
(Uncoded)
116
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-347-6
ICWMC 2014 : The Tenth International Conference on Wireless and Mobile Communications

 
Fig. 16 Comparison of throughput characteristics of NB GF(16) RCP 
LDPC coded type II HARQ scheme with incremental redundancy for three 
relay arrangements ( 2
× 2
, 16QAM) 
 
Fig. 17 Comparison of average number of retransmission of NB GF(16)  
RCP LDPC coded type II HARQ scheme with incremental redundancy for 
three relay arrangements ( 2
× 2
, 16QAM) 
 
retransmission characteristics with relay are much better 
than the ones without relay. This is because for low average 
0
Eb /
N  region, although the destination frequently fails to 
decode the code word correctly, the relay succeeds in 
decoding with high probability. Accordingly, as the 
retransmission is executed from the relay to the destination 
instead of the source to the destination, the probability of 
successful decoding at destination is increased. We also 
observe that when the number of average retransmission is 
greater than 0, i.e., the retransmission is done and the total 
number of transmission is more than 2, the throughput with 
relay is largely improved compared with the one without 
relay. This improvement happens below 
0
/
20 (dB)
Eb
N ≈
 
for GF(4) and QPSK in Figs. 8,9,12 and 13, and below 
0
/
25 (dB)
Eb
N ≈
 for GF(16) and 16QAM in Figs. 10,11,14 
and 15. 
As for the relay arrangements in Fig. 5, from Fig. 16 
and Fig. 17, we see that the throughput and the average 
number of retransmission characteristics for the serial 
arrangement in Fig. 5 (c) show the best. The parallel 
arrangement in Fig. 5 (b) exhibits almost the same 
performance as the one relay case in Fig. 5 (a). This 
observation comes from the fact that the receive power at 
relay or destination in the serial arrangement becomes 
larger than the parallel arrangement. 
VII. CONCLUSIONS AND FUTURE WORKS 
In this paper, assuming the up-link transmission in cellar 
wireless networks, we have investigated the throughput and 
the average number of retransmission characteristics of the 
proposed NB RCP LDPC coded type II HARQ with DF 
relays using MIMO interleaved SC-FDMA. We have 
verified the effectiveness of the proposed scheme through 
computer simulation. In the proposed scheme, for the first 
transmission, 
only 
uncoded 
information 
packet 
is 
broadcasted to both for relay and destination. If error is 
detected 
at 
destination, 
parity 
check 
packets 
are 
retransmitted for the 2nd and the subsequent retransmission. 
The error correction decoding is done both at relay and 
destination. When the destination fails in decoding, but the 
relay succeeds, the relay replaces the source hereafter. The 
relay retransmits the remaining packets instead of source. 
The destination receives the parity check packets with 
incremental redundancy till the coding rate reaches 1/2. We 
made clear that by using DF relay the throughput and the 
average number of retransmission characteristics are 
improved for low receive SNR region. We also clarified that 
two DF relays serially arranged between source and 
destination improve the characteristics further. MIMO 
interleaved SC-FDMA seems to be a promising candidate 
for up-link transmission in 4G and after 4G, because of its 
low PAPR and frequency diversity effect. Considerations on 
other channel models among nodes, the improvement of 
BER characteristic of MMSE nulling receiver in SC-FDMA, 
etc., will be future studies. 
ACKNOWLEDGEMENT 
This study is partially supported by the Grants-in-Aid 
for Scientific Research 24560454 of Japan and the Sharp 
Corporation. 
REFERENCES 
[1] D. Declercq and M. Fossorier, “Decoding algorithm for nonbinary 
LDPC codes over GF(q),” IEEE transactions on Communications, 
vol. 55, pp. 633-643, April 2007. 
[2] D. Kimura, F. Guilloud, and R. Pyndiah, “Application of non-binary 
LDPC 
codes 
for 
small 
packet 
transmission 
in 
vehicle 
communications,” The 5th International Conference on ITS 
Telecommunications, pp. 109-112, Brest France, June 2005. 
[3] J. Ha, J. Kim, D. Klinc, and S. W. McLaughlin, “Rate-compatible 
punctured low-density parity-check codes with short block lengths,” 
IEEE transactions on Information Theory, vol. 52, no. 2, pp. 728-738, 
Feb. 2006. 
[4] Y. Tsuruta, Y. Iwanami, and E. Okamoto, “A Study on LDPC Coded 
Hybrid-ARQ Using Spatially Multiplexed MIMO-OFDM,” S36-1, 6 
pages, WPMC2009, CD-ROM 5 pages, Sept. 2009. 
[5] T. Kozawa, Y. Iwanami, and E. Okamoto, R. Yamada, and N. 
Okamoto, “An evaluation on throughput performance for Type II 
Hybrid-ARQ using non-binary Rate-Compatible-Punctured LDPC 
codes,” IEICE transactions on fundamentals, vol. E93, no.11, pp. 
2089-2091, November 2010. 
[6] J. Laneman, D. Tse, and G. Wornell, “Cooperative diversity in 
wireless networks: efficient protocols and outage behaviour,” IEEE 
transactions on Information Theory, vol. 50, no. 12, pp. 3062-3080, 
Dec. 2004. 
[7] H. Tanaka and Y. Iwanami, “On Throughput Characteristics of Type 
II Hybrid-ARQ with Decode and Forward Relay using Non-Binary 
Rate-Compatible Punctured LDPC Codes,” ICWMC 2012, pp. 
272-277, June 2012. 
[8] H. G. Myung, J. Lim, and D. J. Goodman, “Single Carrier FDMA for 
Uplink Wireless Transmission,” IEEE Vehicular Technology 
Magazine, pp. 30-38, Sept. 2006. 
[9] D. Declercq, V. Savin, and S. Pfletschinger, “Multi-Relay 
Cooperative NB-LDPC Coding with Non-Binary Repetition Codes,” 
ICN 2012, pp. 205-214, March 2012. 
0
1
2
3
4
-20
-10
0
10
20
30
Throughput [bps/Hz]
Average Eb/N0[dB] at S-D link per receive antenna
No relay
Relay Num.1
d=1/2
Relay Num.2
Paralell
d=1/2,1/2
Relay Num.2
Serial
d=1/3,2/3
0
1
2
3
4
5
6
7
8
9
10
-20
-10
0
10
20
30
Average number of retransmission
Average Eb/N0[dB] at S-D link per receive antenna
No relay
Relay Num.1
d=1/2
Relay Num.2
Paralell
d=1/2,1/2
Relay Num.2
Serial
d=1/3,2/3
117
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-347-6
ICWMC 2014 : The Tenth International Conference on Wireless and Mobile Communications

