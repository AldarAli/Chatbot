An Agent-based Model to Support Measuring Drug Choice and Switch Between 
Drug Types in Rural Populations 
 
Georgiy Bobashev 
RTI International 
Research Triangle Park, NC 
Bobashev@rti.org 
Eric Solano 
RTI International 
Research Triangle Park, NC 
Solano@rti.org 
Lee Hoffer 
Case Western Reserve University 
Cleveland, OH 
lee.hoffer@case.edu
 
 
Abstract‚ÄîIn rural areas availability, price, and legal 
consequences can force some drug users to switch between 
primary drugs of choice. For example, as a consequence of 
stricter law enforcement policy in rural Ohio we observed a 
shift from methamphetamine use to heroin and prescription 
opiate use. We propose a polydrug agent-based model that 
describes drug users interconnected in a network. Behavior 
rules are based on our ethnographic research. The drug 
selection mechanisms are dictated by drug liking, drug 
availability, drug cost, perception of health and other life 
consequences, perception of potential punishment and pressure 
from the peers. The model produces time series of users‚Äô 
choices 
of 
one 
or 
concurrent 
drugs. 
Modeling 
and 
ethnographic data collection are interlinked i.e. model results 
lead to the improvements in quantitative measurements, which 
in turn improve the model. Polydrug trends are of particular 
interest to policy makers because short-term interventions can 
lead to long-term adaptation. 
Keywords- decision making, drug use modeling, drug switch, 
agent-based model, model-based survey 
I. 
 INTRODUCTION 
National and regional drug use patterns have been 
changing, reflecting changes in individual choices of drugs, 
for example, marijuana in the late 1960s and 1990s, heroin 
epidemic waves of the early 1950s and 1970s (1971‚Äì1977), 
the 
crack 
epidemic 
in 
the 
late 
1980s, 
and 
the 
methamphetamine epidemic in late 2000s [1]. These trends 
are difficult to predict because they reflect several adaptive 
factors including individual choices, public policy, public 
acceptance, and the adaptation of the supply side of the 
market. Despite the ‚Äúwar on drugs,‚Äù drug use patterns and 
trends surprisingly persist [2]. Individual choices and drug 
trajectories have been extensively described by a number of 
researchers [3,4,5]. On the other hand, market adaptation has 
been extensively studied from a cost-effectiveness point of 
view [6]. However, these two components are seldom put 
together with a few exceptions [7,8]. Understanding is a 
critical component in policy and decision making. By 
‚Äúunderstanding,‚Äù here, we mean the identification of causal 
patterns and feedbacks that could predict qualitatively or 
quantitatively the response resulting from the actions taken. 
Such understanding is complicated by a lack of available 
data and a lack of experience in collecting the right data. In 
this sense, to develop the right understanding, modeling and 
data collection should complement each other in an iterative 
manner. Data collection about illegal and adaptive behavior 
could benefit from model-based suggestions about which 
aspects of behavior to include as data items, and conversely, 
the collected data should educate the model about 
unexplained events and possible adaptations. In our NIDA-
funded study we employ this approach. Based on initial 
ethnographic information we have developed a behavioral 
model which is now providing suggestions about specific 
aspects of ethnographic information that needs to be 
collected to further develop the model. The model is 
theoretical, meaning that the goal is to formally reflect our 
qualitative ‚Äúunderstanding‚Äù of rural drug use patterns. The 
model is not supposed to reproduce numerically the observed 
data but rather identify qualitative trajectories of individual 
and collective response to external interventions. 
Our agent-based model describes individual drug choices 
under the conditions of drug availability, perceived risk of 
drug use, impact of social network, and drug use ‚Äúburnout.‚Äù 
Although there are a few models that describe the process of 
drug use and operation of drug markets [4,6,10,12], there 
was little focus on modeling the switch between drug use. 
We considered two models: a simplified model focused on 
the 
specific 
phenomenon 
of 
switching 
between 
methamphetamine and opiates and an extended model that 
considers a greater variety of drug choices as well as the 
evolution of the supply side of the market. In this paper we 
focus on the simplified model because it serves the specific 
purpose of the study and provides a basis for the extended 
model under development. In the next section we describe 
the model‚Äôs assumptions and the basic rules that are followed 
by drug using and market agents. Then we present our 
preliminary results and discuss the implication for data 
collection, policy analysis, and future work. 
281
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

II. 
METHODS 
To provide suggestions about specific aspects of 
ethnographic information that needs to be collected for 
understanding switches between markets we developed a 
theoretical 
agent-based 
model 
that 
describes 
our 
understanding of market functioning. The model is built 
using the Overview Design concepts and Details (ODD) 
protocol that was introduced and standardized by Railsback 
and Grimm [9]. The ODD is designed to demystify ABMs 
and provide the reader with a clear description of the logic, 
structure, and components of the model. The rest of the 
section is structured according to this protocol. 
A. Purpose  
The purpose of this model is to describe the manifold 
drug use patterns leading to community response to drug use 
interventions. The model will help to understand how drug 
preference, 
drug-acquiring 
effort 
levels, 
drug 
use 
consequences, and drug-sticking factors in a networked 
population affect the decision to switch the use of one drug 
for another. Drug preference identifies how much an 
individual likes a specific drug at a specific time.  
The model translates ethnographic observations and 
narratives into formal causal rules and parameter values. The 
model can then be used to generate simpler aggregate system 
dynamics and statistical models that in turn could be 
calibrated and validated to ‚Äúhard‚Äù survey data.  
B. Entities, State Variables, and Scales 
The model includes individuals who are drug users. 
There is a constant population of drug users during the entire 
simulation.  
The simpler model contains only three reinforcers: 
Heroin, Opiates, and Other. Note that ‚ÄúOther‚Äù could include 
other drugs such as alcohol and marijuana, but also non-drug 
reinforcers such as sporting activities. For simplicity we 
separate methamphetamine and opiates from the other 
reinforcers.  
The agents in the model use one, two, or all three 
reinforcers. We do not distinguish between occasional and 
regular use; however, we distinguish between never use, first 
use, and use of the reinforcer. The reason for such distinction 
is that the effect of the drug on individual perception of 
liking can change after first use and then after consequent 
use. Thus, in relation to each of the drugs an agent could be 
in one of the following non-overlapping states: Never used, 
tried it, use it, and used in the past. The extended version of 
the model also considers occasional and regular use (Figure 
1).  
Each individual can 
be in the 
community 
or 
institutionalized (incarcerated or in treatment). Each drug 
state is characterized by attitudes toward the drug (i.e., drug 
liking) and a number of external factors. The transition 
between the stages is additionally governed by external 
factors such as peer pressure. 
 
 
Figure 1. State chart for an agent in the multiple drug user model 
 
The population of drug users is interconnected. Drug 
users are linked to a number of other drug users during the 
simulation. The linkage between two drug users is 
maintained during the entire simulation.  
C. Process Overview and Scheduling 
This model proceeds in monthly time steps. Within each 
month or time step, four phases are processed in the 
following order: drug selection probability calculations, 
selected drugs identification, drug use state update, and drug 
preference update.  
At each time step an individual considers a number of 
competing priorities, and evaluates them according a 
combination of six drug factors: 
‚Ä¢ 
Drug liking 
‚Ä¢ 
Drug availability 
‚Ä¢ 
Drug cost 
‚Ä¢ 
Perception of health and other life consequences 
‚Ä¢ 
Perception of potential punishment 
‚Ä¢ 
Pressure from peers 
These factors can change in time according to external or 
internal factors. For example, external influences can be 
related to drug availability, activities of drug cartels, or the 
perception of punishment, which could increase due to 
formation of a police task force to fight a specific drug. 
Internal influences are associated with the increase of ‚Äúdrug 
liking‚Äù after prolonged use. We also consider that in time 
some drugs could lead to ‚Äúburnout‚Äù and decrease in liking. 
Although we use the term ‚Äúdrug liking‚Äù for the description of 
both positive and negative reinforcement, we implicitly 
distinguish between them by assuming that occasional use is 
a result of positive reinforcement and dependence is a result 
of negative reinforcement. The resource can be stable over 
time or get reduced because of loss of a job caused by 
addiction. Thus, a number of complex feedback loops impact 
the formation and development of individual and community 
drug use patterns in the drug market environment.  
Agents can get institutionalized depending on perceived 
punishment. Although the punishment perception should 
follow the severity of the punishment we assume that these 
factors are immediately correlated and controlled externally 
by an observer or external input. 
Timeline. We are more focused on long-term changes 
rather on daily behavior. The time horizon in the simulation 
is 10 years. The time steps are of 1-month duration.  
282
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

Scheduling. At each timestep each agent first evaluates 
the external and internal factors and then makes a decision 
about which drugs to use for the next timestep. Among 
external factors we consider the prevalence of drug use 
among agents‚Äô peers. In a simplest implementation we 
assume that the community is closed and everyone is 
connected to everyone, so rather than considering a complex 
social network we average the drug use in the community to 
create the ‚Äúpeer pressure‚Äù factor. In a more realistic setting 
we consider two overlapping networks: heroin and 
methamphetamine. The assessment of the network is done 
before any individual state changes. 
D. Design Concepts 
The model design assumes that each person is 
interconnected with a number of people in the population. 
The model hypotheses are that changes of use from one type 
of drug to another depends on drug preference, drug-
acquiring efforts levels, drug use consequences, and drug-
sticking factors.  
The model design assumes that drug supply is a 
commodity that is always available. Drug suppliers are 
different for different drugs. Drug preference changes over 
time for each type of drug. If a person has null preference for 
a drug, the only way to change it to a positive preference is 
through social pressure exerted by the person‚Äôs network.  
Emergence. We do not consider explicit emergent 
behavior, but rather expect that emergent behavior could 
form on its own from existing rules. We might expect to see 
that the impact in one limiting parameter such as increase in 
punishment for a single drug without providing alternative 
reinforcement option for ‚Äúno use‚Äù could lead to the increase 
in other drugs becoming dominating depending on the 
punishment and availability of the new drug. Thus, with the 
delay in response we might expect long-term waves in drug 
use that have been historically observed in the United States 
and worldwide.  
Agent objectives. Agents have their resources and are 
willing to spend them depending on the current assessment 
of the situation. They do not have any long-term objectives, 
but rather make a choice according to the criteria based on a 
combination of expected effect and risks.  
In real life individuals have resources such as time and 
funds that they spend on their priorities. The resources act as 
limiting factors that control the mix of drugs an individual 
can use. By considering other reinforcers we cover the entire 
space of choice possibilities that compete for these resources. 
Rather than have an explicit set of resources we consider a 
relative score which is defined as a scaled absolute score and 
the agent makes choices based on the values of that relative 
score. For each choice we define an absolute score Xi as 
follows: 
 =
‚àó	
‚àó
()()(), 
(1) 
where each of the components is defined on a scale from 
0 to 100. The relative score is defined as   =
!"
‚àë !"
"
. We also 
provide the rule for making the choice to try and to use the 
drug. If for a specific drug the score Si>T1, where T1 is an 
upper threshold, then the individual will become a user of 
that choice. If the relative score is between T1 and T2, where 
T2 is a lower threshold, then the user will try the reinforcer, 
and if the score is less than T2 then the user will not be using 
that drug. The natural low limit for T2 is 1/3 given that we 
have 3 choices of reinforcers. This will guarantee that at least 
one choice will be made. The example of the relative score is 
presented in Figure 2.  
Adaptation. Agents assess their social network and 
include the assessment in the objective function. 
Learning. Agents‚Äô learning ability is represented in the 
form of drug-liking dynamics. The more an agent uses the 
drug the more it ‚Äúlikes‚Äù the drug. We use the term ‚Äúliking‚Äù as 
a surrogate of the actual liking and dependence. Although 
one of the characteristics of drug addiction is negative 
reinforcement (i.e., an individual uses a drug to reduce 
discomfort) we consider that limited to the dynamics of the 
drug-liking function (i.e., they can move from occasional to 
regular users). Future model versions will have the affinity to 
their drug using group as a part of generating ‚Äúcomfort‚Äù as 
an additional factor impacting the choice of drug. 
 
Figure 2. Example of the relative score diagram. ‚ÄúOther‚Äù 
reinforcement shows the highest score thus this agent will choose 
the ‚ÄúOther‚Äù reinforcement.  
 
We distinguish growth in drug use liking after first use 
and tempering out with time reflecting the ‚Äúburn out‚Äù in drug 
use. This is done by multiplying the liking by the burnout 
function which has a logistic shape with characteristic time. 
The functional form for the growth and burnout in liking is 
represented with a function with interpretable coefficients: 
$ =
%
(%)

(&'()*)+,-) 
, 
 
 
(2) 
where t is the time since the first try, a, b, c, d and t‚Äô are 
scaling parameters with a corresponding to the speed of 
initial growth and is used to distinguish between occasional 
and regular use. Parameter b is characteristic of different 
drugs, parameter c corresponds to the end point for the 
liking, d corresponds to the speed at which the liking is 
reduced, and t‚Äô to the timing of the decline in liking. The 
largest possible liking corresponds to the value of 100.  
 
283
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

 
Figure 3. Liking function for heroin. 
 
In Figure 3 we present the shapes of the liking function 
for a drug such as heroin as it progresses in time. It takes a 
short period of use to get addicted but after a long period of 
use the liking is lowered because of the detraining health and 
lifestyle effects. The characteristic times of the liking 
dynamics could be defined as times when the liking reaches 
70 of the maximum value. In Figure 3 these times will 
correspond to points where the liking function crosses the 
horizontal (green) line. 
Prediction. The agents do not make any prediction. All 
prediction is described by an immediate assessment of health 
and punishment risks. 
Sensing. Agents sense the state of the members of their 
network (currently everyone). 
Interaction. Agents do not directly interact with each 
other, they only sense the state of network members. 
Stochasticity. In the current version agents are 
deterministic by choosing the ‚Äúbest‚Äù combination of drugs; 
however, there is an option to randomly make the stochastic 
choice with probability of choosing being proportional to the 
relative score of the drug choice. The stochastic component 
is introduced at the level of creating connections in a social 
network. The potential usage of a drug is a binary variable 
that depends on the individual‚Äôs social index. The social 
index is computed as a function of the individual‚Äôs previous 
drug use and the previous drug use of the individual‚Äôs peers. 
The potential use is then computed using a Bernoulli 
distribution with social index as the parameter. Initial drug 
preference values and initial drug use states are randomly 
selected from a set of four possible states, each with a given 
probability.  
Collectives. Collectives are defined according to the type 
of reinforcer they use. Thus, an individual could be in more 
than one collective at a time.  
Observation. The observer has options to impact drug 
availability and perceived drug punishment. At each step we 
record the individual‚Äôs drugs of use which are recorded in the 
output file and then can be analyzed.  
Initialization. A randomly linked network is initially 
created and used for each simulation. Each drug user is 
initialized by assigning a random number of linked people 
and the values of drug preferences and drug characteristics.  
A number of other structured networks has been considered, 
e.g. scale-free and a small world, but actual validation of the 
network structure is not feasible at this point, thus we use the 
simplest random arrangement.  
III. 
MODEL APPLICATIONS 
The model was developed as a standalone  Java 
application as well as a NetLogo model. The models were 
verified through a system of sequential tests: (1) a collection 
of individual users, no market agent (drug characteristics do 
not change), no networks; (2) addition of networks, no 
market agent; and (3) network and agents. Althought the 
direct validation of the model has not been feasible becase 
of the lack of direct measurements in the real world setting, 
the face validity of the resutls were discussed with the 
ethmographers and law enforcement respresentatives.  
The main application of this model resulted in the design 
of a set of six questions aimed to calibrate the model. These 
questions corresponded to the items in the score and were 
defined at a 10-scale level. This questionnaire was included 
into a longer ongoing ethnographic survey of drug users. 
Upon the completion of the study the data will be used for 
model calibration and validation on historic data.  
Here we present the results of a hypothetical scenario. 
After the market locally stabilizes, the action of law 
enforcement leads to the increase in consequences of the 
local methamphetamine market, which in turn leads to the 
reduction in meth use and increase in other reinforcements 
available in the social network. Because heroin has a higher 
addictive potential than ‚Äúother‚Äù reinforces it eventually wins 
over the community with a temporary dominance of other 
reinforcements. Figure 4 shows the results of running the 
simulation for 2 years.  
 
 
Figure 4. Drug use trends corresponding to the scenario where 
law enforcement activities led to the reduction in methamphetamine 
use and the increase in heroin use.  
 
After users try heroin they get quickly addicted and by 
the time methamphetamine is reintroduced to the 
community many former meth users are on heroin. Addition 
of methamphetamine increases the chance of using both. 
IV. 
DISCUSSION 
We present a model that describes individual priorities in 
the choice of drug and the relationship between the 
individual choices, drug supply adaptation and the impact of 
community and law enforcement which sometimes leads to 
284
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

short time success followed by long-term resistance and 
opposite results. Our model provides a possible explanation 
on why law enforcement strategies often fail. When the law 
enforcement attempts don‚Äôt consider long-term market 
adaptation and with limited resources the success is quickly 
diminished by the adaptation in a different dimension. These 
adaptations sometimes make drug markets more efficient as 
in [10] or dominated by a more addicted drug as in the case 
of Summit County considered in this paper. Historical 
precedents support the need for a systems approach. For 
example, the increase in border control between the United 
States and Mexico in 1969 (Operation Intercept) led to an 
increase in the use of other drugs (76% of students and 84% 
percent of patients reported that they increased their 
consumption of one or more other drugs (including alcohol) 
because 
of 
the 
unavailability 
of 
marijuana) 
[11]. 
Additionally, smugglers have found more efficient ways to 
smuggle the drug into the United States and domestic 
marijuana growth has increased, which made the illegal 
market more efficient [11].  
Although our paper presents a simple theoretical model, 
ethnographic research can play a key role in a realistic 
understanding of feedback processes and consequences of 
interventions. Ethnographic research allows one to collect 
data on the actual reasoning and causal relationships that are 
often hidden from standardized surveys. Although limited to 
a smaller number of individuals, ethnographic data provide 
the basis for the development of theoretical mental models. 
The process of building ABMs allows one to convert these 
mental models into formal rules and parameters. By 
simulating trajectories from these ABMs one can obtain 
understanding of the main consequences and adaptations one 
can expect from the interventions. Although more difficult to 
calibrate and validate microsimulation have an advantage of 
capturing non-linearities that occur due to complex decision 
making and networks structures. As shown in [13] a 
simplification of an ABM by aggregating over the 
population agents and time requires careful analysis, 
otherwise a simplified aggregated model will not adequately 
represent the dynamics of the full model. After selecting the 
best theoretical scenarios ABMs can provide the basis for 
population-based data collection through more reliable 
means such as representative surveys. The advantage of such 
an approach is that now the surveys are grounded in realistic 
causal pathways and thus their predictive validity becomes 
much more prominent. 
ACKNOWLEDGMENT 
This research was funded by a grant from the National 
Institutes of Health, National Institute on Drug Abuse 
(DA025163) 
REFERENCES 
[1] Hunt, D., S. Kuck, and L. Truitt, (2006) Methamphetamine 
Use: Lessons Learned, final report to the National Institute of 
Justice, 
(NCJ 
209730), 
available 
at 
www.ncjrs.gov/pdffiles1/nij/grants/209730.pdf.  
[2] Global commission on War on drugs National report June 02 
2011. 
Available 
online 
at: 
http://www.scribd.com/doc/56924096/Global-Commission-
Report 
[3] Anglin, M.D., et al., (2001). Drug treatment careers: 
Conceptual overview and clinical, research, and policy 
applications. In: F. Tims, C. Leukefeld, and J. Platt (Eds.), 
Relapse and Recovery in Addictions. New Haven, CT: Yale 
University Press, pp. 18-39. 
[4] Agar M. (2005) Agents in Living Color: Towards Emic 
Agent-Based Models. Journal of Artificial Societies and 
Social Simulation vol. 8, no. 1 
[5] Anderson T. (1998) A cultural-identity theory of drug abuse. 
Sociology of Crime, Law, and Deviance, Volume 1, pp 233-
262.  
[6] Caulkins, J P. and MacCoun R. (2005), Analyzing Illicit Drug 
Markets When Dealers Act with Limited Rationality. In 
Francesco Parisi and Vernon L. Smith (eds.) The Law and 
Economics of Irrational Behavior, Standard University Press, 
Stanford, CA, pp.315-338. 
[7] Perez P., Dray A., Moore D., Dietze P., Bammer G., 
Jenkinson R., Siokou C., Green R, Hudson S.L., Maher L., 
(2011) SimAmph: an agent-based simulation model for 
exploring the use of psychostimulants and related harm 
amongst young Australians. The International journal on drug 
policy. 06/2011; 23(1):62-71 
[8] Hoffer, L. (2006) Junkie Business: The Evolution and 
Operation of a Heroin Dealing Network, Belmont, CA: 
Thompson Wadsworth.  
[9] Steven F. Railsback & Volker Grimm (2012) Agent-Based 
and Individual-Based Modeling: A Practical Introduction  
Princton University Press. 
[10] Hoffer, L. D., Bobashev, G. V., & Morris, R. J. (2011). 
Simulating patterns of heroin addiction within the social 
context of a local heroin market. In Computational 
neuroscience of drug addiction (pp. 313‚Äì331). New York: 
Springer. 
[11] McGlothlin W., K. Jamison, and S. Rosenblatt, (1970) 
Marijuana and the Use of Other Drugs, Nature 228: 1227-
1229 
[12] Lamy F., Bossomaier T., PerezP., SimUse: modeling 
recreational polydrug use through an agent-based model 
Proceedings of the 12th International Conference on 
Modeling and Applied Simulation, Athens, Greece 2013: 61-
69 
[13] Heard D., Morris J., Bobashev G.V., (2014) Reducing the 
Complexity of an Agent-Based Local Heroin Market Model, 
PLoS One.  DOI: 10.1371/journal.pone.0102263 
 
 
285
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-371-1
SIMUL 2014 : The Sixth International Conference on Advances in System Simulation

