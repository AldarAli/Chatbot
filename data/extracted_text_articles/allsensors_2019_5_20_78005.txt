Distributed Sensing System for an Old Vineyard in the
Douro Demarcated Region - North Portugal
S´ergio Silva∗†∗∗, Salviano Soares∗¶, Filipe Cabral Pinto§
∗Engineering Department School of Sciences and
Technology, UTAD, Vila Real, Portugal
∗∗Globaltronic, Aveiro, Portugal
†INESC TEC -INESC Technology and Science
Porto, Portugal
Email: sergio.s.silva@ inescporto.pt
Diogo Duarte‡, Jo˜ao Barroso∗† and Justino Soares∥
‡Department of Electronics, Telecommunications
and Informatics, UA, Aveiro, Portugal
§Altice Labs, Aveiro, Portugal
¶IEETA - UA, Aveiro, Portugal
∥Quinta do Crasto, Vila Real, Portugal
Abstract—Two-thirds of the world’s population currently lives
in areas that experience water scarcity for at least one month
every year. And like humans, plants, and especially grapes in
vineyards, need the correct amount of water in order to grow
healthy. Therefore, to assist the irrigation process, we do not
only need to use reliable measuring systems to gauge the water
amount per plant, but also to estimate the kg of chemical agents
per hectare, like fertilisers, that contribute to the growing of the
plants, as well as the pollution of rivers and water supplies. The
implemented monitoring station is part of a Distributed Sensing
System Model (DSS) that allows continuous measurements over
time, and is based on an autonomous wireless sensor network
capable of measuring the parameters of interest and storing all
this information. The implemented station is fully autonomous,
receiving energy from a solar panel that charges the two main
batteries, even if there is no direct sunlight available. The station
communicates to the remote sensors by RF and can be remotely
accessed using 3G and Narrow Band IoT (NB-IoT). Besides the
RF sensors, the station allows multiple interfaces to connect
other sensors, as is the case of the developed sensor board that
measures different gases like Nitrogen Dioxide (NO2) and Carbon
Monoxide (CO) using I2C calibrated sensors for easy replacement
and station adaptation. Traditional wind and rain sensors are
supported, allowing new sensor value comparison and validation.
Keywords–Weather Station; Sensors: Humidity, Temperature,
CO, NO, CO2, O3, Dust, Pressure, Light, Anemometer; RF; LoRa;
NB-IoT; GatewayFE; Old Vineyards; Quinta do Crasto.
I.
INTRODUCTION
Agriculture is one of the most ancient activities of man,
and a place where it is difﬁcult to introduce innovation and
technology due to the lack of investment and the difﬁculty
to show the beneﬁts of this introduction into productivity and
proﬁtability while minimizing unintended impacts on wildlife
and the environment. Nevertheless, the use of information from
the environment, especially when we speak about precision
agriculture, has demonstrated that it is possible to maximize
crop production while minimizing watering and fertilization
schemes [1].
One of the biggest issues, when installing monitoring
weather systems is the need of maintenance and station cost.
An unattended wireless sensors network able to measure the
parameters of interest like the amount of water in the soils, the
Electrical Conductivity (EC - as a measure of total nutrients),
soil thermal properties (temperature, thermal conductivity, heat
capacity, and thermal diffusivity – as a measure of how energy
is partitioned in the soil proﬁle), water ﬂux, and environmental
temperature at the surface is one of the most promising
technics developed by Valente in 2018 [2].
The developed sensor uses RF to connect to a main station
that is fully energy autonomous, gathering energy from a solar
panel that is stored into two main batteries, even if no direct
Sun is available. Figure 1 shows the implementation of the
data acquisition network.
Figure 1. In-ﬁeld data acquisition network.
This work presents a precision viticulture environment of
“Quinta do Crasto”, located in a prime spot in the Douro
Demarcated Region in Northern Portugal. This region is char-
acterized by the extreme weather condition and its own pecu-
liar combination of topography, geology and water resources,
all of which come together to form the unparalleled theatre
of global winemaking. Quinta do Crasto soils are composed
of schist complex types, and have been worked into steep
slopes near the river in a remarkably awe-inspiring work of
human ingenuity. The traditional “socalcos” (terraces with
stone retaining walls) house the oldest vines, some dating more
than one hundread years. An average of 5,000 plants/hectare of
younger vines are planted vertically on slopes of less than 35%.
On the slopes greater than 40%, “patamares” (more recent
terraces) carry either one or two rows of vine, with a density
of between 3,000 to 3,500 plants/hectare.
The excellent sun exposure with primarily eastern and
southern aspects, in conjunction with the dry conditions of the
Cima Corgo sub-region and the ability of schist soils to absorb
and retain heat, come together to force the roots of these vines
to grow dozens of meters deep in search of water. This also
provides competition between the plants and contributes to the
complexity and intensity of the wines produced.
43
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-691-0
ALLSENSORS 2019 : The Fourth International Conference on Advances in Sensors, Actuators, Metering and Sensing

The quality of these wines and this terroir also requires
closely monitoring every step in the grape growing and wine-
making process from pruning to harvest. Safeguarding the
identity of vineyards is a fundamental prerequisite for the
preservation of a unique genetic heritage and the only way to
ensure the continuity of the old Douro vineyard, Vinha Maria
Teresa, that give rise to internationally recognized wines [3].
In this complex scenario, a Distributed Sensing System can
gather information that can help in understanding vineyard
variability and therefore how it might be managed, thus
improving the quantity and quality of the wines, not to mention
ensuring the consistent production of the highest quality wines,
year after year, in a matchless wine in their character and
uniqueness.
Figure 2 shows the terroir of Quinta do Crasto.
Figure 2. Vinha Maria Teresa, Quinta do Crasto
In Section II, the objectives of the system are described,
from the hardware and software perspective, to costs. The com-
munication systems that were used are presented in Section
III. In Section IV, the hardware implementation is exposed.
In contrast, Section V presents the software implementation
and the system web interface. Finally, Section VI presents the
main conclusions and future work.
II.
OBJECTIVE
The primary objective of this work is to implement the
hardware and ﬁrmware that will allow the Distributed Sensing
System Model described in [4]. As stated, the system must be
able to implement a Wireless Aboveground Sensor Network
(WASN) capable of sensing and transporting data towards the
central monitoring station [4], but with capacity to use different
bands like 433 MHz and 868 MHz. The system should also
be fully energetically autonomous, i.e., capable of harvesting
energy from the nature.
The DSS platform must incorporate information from re-
mote sensing, as well as in situ weather conditions, such as
water source levels and soil history, and was stated that needed
to be cost-effective, as less intrusive as possible, and include a
reliable data communication system that allows data collection
from sensors monitoring the crops, land, and environment.
Towards these goals, a primary Gateway was developed using
the latest technology available for communication and sensing.
The hardware used for this implementation will be described
in detail in the next chapter.
III.
COMUNICATION SYSTEMS
IoT services require connectivity to link objects to the
Internet. Sensors and actuators require communication paths to
allow exchanging information with cloud-based services, mak-
ing possible the extraction of useful insights and also enabling
the control of different connected infrastructures. Depending
on the scenario, several options may be taken, from ﬁxed to
mobile, from ad-hoc to more structured networks. The “best”
solution is always the one that ﬁts to the customer needs and
constrains. The application of IoT technology to an agricultural
use case presupposes the existence of some requirements. It
will be necessary to ensure wireless communications, at great
distance and without waste of energy. These requirements
map directly to the characteristics of Low Power Wide Area
Networks (LPWAN).
There are already several commercial offers that make
available similar solutions, that are able to cope with the
diversity of applications requiring long range communications
and reduced power consumption at lower costs. This variety of
LPWAN systems can be roughly grouped in two major distinct
sets: solutions using unlicensed radio bands and standardized
systems operating under licensed spectrum.
The LoRa Alliance is an open association of companies
targeting the speciﬁcation of LPWAN for IoT applications. The
members have detailed the open standard LoRaWan protocol
in order to allow long range wireless IoT services for battery
constrained devices [5] . It provides a secure bi-directional
channel for communication between devices and applications
supporting bit rates ranging from 0.3 kbps to 50 kbps, being the
rate deeply dependent on the distance and the type of data to
be sent. LoRaWan is built on top of the proprietary LoRa radio
modulation technology from Semtech Corporation, which,
however, relies on shared spectrum for radio communication.
3GPP has also developed efforts in the network speciﬁ-
cation for IoT, but operating under licensed spectrum. The
systems were particularly simpliﬁed and new mechanisms were
created to meet the speciﬁc needs of constrained devices. These
efforts were particularly noticeable in the NB-IoT technology,
which does not operate in the Long-Term Evolution (LTE)
construct. NB-IoT was the main 4G solution to support ultra-
low bit rate applications for limited devices communicating
in large geographical areas. It is a cellular-based low power
technology developed to support the link of low-cost devices
to web-based applications [6]. It intends to reduce terminal
costs and support extended coverage, while ensuring a long
battery life. It supports communications up to 250 kbps on both
directions with half-duplex operation using 180 kHz bands.
The usage of licensed spectrum enables the full control of
the communication channel making easier the availability of
quality of service for IoT communications.
IV.
HARDWARE
The sensors hardware is based on the Multi-Functional
Probe (MFP), which is schematically represented in Figure
3. The MFP consists of one central heater needle and four
surrounding thermistors, as reported by Mori et al. [8]. The
needles are made from stainless steel tubing, 0.912 m min
diameter, protruding 40 mm beyond the edge of the PVC
mounting. Spacing between the heater and temperature sen-
sors is about 8.5 mm. The heater was made from enameled
Stablohm 800 A wire (0.062 mm in diameter and 440.8 Ω m−1
44
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-691-0
ALLSENSORS 2019 : The Fourth International Conference on Advances in Sensors, Actuators, Metering and Sensing

Figure 3. Multi-functional probe [7]
of resistivity) [9], which was inserted in the heater needle. The
heater resistance was 100 Ω (heater resistivity of 2010 Ω m−1).
The needle is then ﬁlled with high thermal-conductivity epoxy
glue, making it water-resistant, thus causing the heater to be
electrically insulated.
The Wenner array is formed by four aluminum ring elec-
trodes equally spaced with 3 mm separation [10]. The outer
electrodes (denoted as A and B in Figure 3) provide for
an alternated current source (1 mA peak-to-peak and 100 Hz
frequency), whereas the potential difference is measured across
the two inner electrodes (M and N). The overall system,
including battery, ﬁts in a cylinder with 21.4 mm in diameter
and approximately 50 mm long [4].
The developed Gateway, Figure 4, is based on WIIPIIDO,
a powerful high-performance single-board computer equipped
with a Quad-core ARM Cortex-A53 Processor@1.2 GHz and
2GB DDR3 memory RAM. The system offers four 16 Bit
Analog to Digital Converter (ADC), an internal 8 GB INAND
eMMC Flash Drive and four USB ports for expansion. The
Real Time Clock Calendar (RTCC) and GPS provide the users
with off the grid time and location keeping.
Figure 4. Gateway FE Plus
For connectivity, the Gateway offers several communica-
tion possibilities like Wi-Fi, Bluetooth, RF, GPRS and NB-
IoT. The two RF Serial Peripherical Interface (SPI) modules
implemented allow the Gateway to communicate on multiple
bands and different protocols. A solar panel and the battery
system allow energy harvesting with up to 3 days autonomy.
The RTCC and Linux based system provide the database
collection and system sensor monitoring.
There are also two relay Outputs and four digital inputs
available. Figure 5 shows the schematics of the relay Outputs.
The LED D9 is used to monitor the state of the output and
it connects showing the user the relay activity. The output is
used to automatically control the irrigation.
Figure 5. Schematic of the relay output
As for the inputs, they all are optically isolated as can been
seen in Figure 6. For simplicity sake, only one of the Outputs
and one of the Inputs were presented in the schematics. The
inputs are used to allow manual control of the irrigation, as
well as the detection of the pump activation, and the full level
of the water tank.
Figure 6. Schematic of the digital input
Due to the Douro Valley location, communication tends to
be very difﬁcult, so the Gateway allows remote communication
through multiple backup systems like GPRS and Narrow
Band IoT, with the latest being developed to enable efﬁcient
communication for wide geographical footprints. This module
is based on the Sara N2.
Figure 7. Schematic of RF module
The system communicates with the sensors using RF,
and the schematic in Figure 7 shows one of the several RF
modules implemented and supported by the Gateway. Up to
two different modules can be used at the same time in the
Gateway, allowing us to test different RF modules and their
performance under the hillside vineyards in the Douro Region
45
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-691-0
ALLSENSORS 2019 : The Fourth International Conference on Advances in Sensors, Actuators, Metering and Sensing

that is strongly conditioned by the original slope and relief of
the parcels of vines.
To
achieve
maximum
ﬂexibility,
the
system
should
recharge its batteries using energy harvested from the sur-
rounding environment, avoiding maintenance and human in-
terference. Therefore, a solar panel and battery system were
chosen for the task and they must be managed. The solar
charger board was implemented using a PIC16F1938, as can
be seen in the schematic represented in Figure 8. This board
presents features such as battery charging, temperature control,
battery discharging, light sensor, among others.
Figure 8. Schematic of Solar Charger
Besides the Gateway, the system also as a sensor board
that allows the user to connect different sensors, from gas
to the traditional weather station sensors like wind, rain,
temperature and humidity. The board responsible to control
the sensors communicates using RS-485 with the Gateway,
and was implemented using the schematic in Figure 9.
Figure 9. Schematic of RS-485
The ISO3082 transceiver was used since we need a good
isolation, because it is expected that the I/O can be subjected
to electrical noise transients from various sources, especially
on the hillside where thunder storms tend to be more intense.
Figure 10. Schematic of the rain sensor
On the sensor board several traditional sensors can be con-
nected, allowing the user to compare its values with the ones
obtained from the new implemented sensors. The schematic
Figure 11. Schematic of the wind sensor
in Figure 10 shows the rain sensor connection. In the case
of the wind sensor, the board implements the connection to
an anemometer wind vane. Figure 11 shows this schematic
implementation, which allows the user to detect not only the
wind speed but also the wind direction.
Figure 12. Schematic of the light and UV connector
The board allows light and UV measurements by using an
Inter-Integrated Circuit (I2C) sensor. The connector schematic
is showed in Figure 12. The sensor used is the Si1133, with a
high accuracy UV Index Sensor and Ambient Light Sensor. In
the schematic represented in Figure 13 we can see the sensor
itself. The presence of the light diffuser allows the sensor to
be inside a weather protection cover.
Figure 13. Schematic of the light and UV sensor
46
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-691-0
ALLSENSORS 2019 : The Fourth International Conference on Advances in Sensors, Actuators, Metering and Sensing

Besides the traditional sensors, the sensor board allows the
connection of the following sensors, through I2C.
•
CO
-
Carbon
Monoxide:
2112B0052400
+
212B019900;
•
NO - Nitric Oxide: 2112B0522400 + 212B019900;
•
CO2 - Carbon Dioxide : MG-811;
•
O3 - Ozone: MiCS-2614;
•
DUST - Particulate Matter level : PPD42NS;
•
PRESSURE - absolute pressure : LPS25HB;
•
TEMP HUM - Relative Humidity and temperature:
Si7021-A20.
After connecting the sensors, the ﬁrmware automatically
detects the type of sensor that was connected and starts sending
the correspondent sensor data to the Gateway, which can be
access using the available Wi-Fi connection. All data received
from the sensors is stored in a database.
Figure 14. Main Pole conﬁguration
Figure 14 shows the pole layout for the Gateway, Sensor
Board, Solar Panel and traditional wind and rain sensors.
V.
SOFTWARE
The software platform install was developed in JavaScript,
under the NodeJS application platform over the Linux operat-
ing system. This makes the software platform independent, i.e.,
able to run under any device with a web browser install, thus
highly scalable since the NodeJS is an asynchronous event
driven JavaScript meaning that every network call creates a
parallel process that handles the call without blocking the
event-loop. This also implies that every callback function will
work in parallel, but in a single thread.
Although at a ﬁrst glanced the above does not seems impor-
tant, the fact that there can be several users, and even sensors
that will require access to the system and to the database at the
same time can, on a networking environment, be problematic.
The selected environment provides asynchronous operations
avoiding blocking operation.
Figure 15 shows the opening page of the developed plat-
form. On its left side, the sensors that have alarms, (for
example battery below 50%) and on the right side the last
time a sensor has communicated with the platform, along side
Figure 15. Main page of the developed platform
some meta-data, as well as the soil humidity % at the time
of the message. All sensor data can be seen by pressing the
correspondent sensor line. Figure 16 shows the sensor screen.
Figure 16. Sensor screen
The sensor has two additional screens: one for proﬁle Perﬁs
and the Data screen. The ﬁrst allows sensor conﬁguration,
activation time and the amount of times the sensor activates
during each day. The last shows all sensor data besides the one
present on the system screen like thermal conductivity, heat
capacity, and thermal diffusivity. In this phase, the system is
mainly collecting data that will be analyzed and transformed
into useful data. Besides sensor analysis and conﬁguration,
we can also conﬁgure users and their level of permissions or
access, as seen in Figure 17.
Figure 17. User conﬁguration page
In page Rega, or Watering, the user can activate the
watering system and control up to 18 different watering pumps,
as well as conﬁgure the running and starting time for one or
more pumps at the same time. Figure 18 illustrates this screen.
Finally, Figure 19 depicts the RF conﬁguration, where
it is possible to conﬁgure up to two different RF modules
working simultaneously, allowing the user to test different
bands, distances and protocols.
Another interesting screen refer is the Macro, since it grants
users’ the possibility to deﬁne sets of conditions that when
realized, trigger an custom action. For example, if a sensor
is below a certain Humidity %, then the correspondent pump
47
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-691-0
ALLSENSORS 2019 : The Fourth International Conference on Advances in Sensors, Actuators, Metering and Sensing

Figure 18. Watering conﬁguration page
Figure 19. RF conﬁguration page
will be triggered during a certain amount of time, or an email
can be sent to the Farmer.
VI.
CONCLUSION AND FUTURE WORK
In this paper we have described the DSS system imple-
mented at Quinta do Crasto. The described hardware and soft-
ware provide the means to accomplish the objectives proposed
by the author on his paper [4]. A state of art Gateway was
implemented and described in detail, being fully autonomous
and able to harvest energy from the nature.
The system can connect to the network using several
methods, from Ethernet, 3G/4G, NB-IoT and Wi-Fi. On the
other hand, users can connect to it using direct access point or
through Bluetooth. Regarding sensors connectivity, besides the
newly developed sensors, there is also the possibility to con-
nect several traditional weather sensors, permitting comparison
of values between both.
The DSS also implements several RF modules at the same
time, allowing band comparison and protocol comparison in
terms of reliability and message lost. Furthermore, through
the implemented software and hardware, it is possible to use
internal and external relays to control watering pumps. So,
from the above, it is concluded that the system fully supports
the deﬁned requirements, with the next phase being real time,
in-ﬁeld testing.
Future works will pass through the implementation of the
new sensors for wind, using ultrasounds, and rain, using sound.
The data collected using the existing sensors will be analyzed
and used for the DSS model implementation.
ACKNOWLEDGMENT
This work is ﬁnanced by the ERDF
European Re-
gional Development Fund through the COMPETE Programme
(operational programme for competitiveness) within project
ref. POCI-01-0145-FEDER-006961 and by National Funds
through the FCT
Fundac¸˜ao para a Ciˆencia e a Tecnologia
(Portuguese Foundation for Science and Technology) within
project ref. UID/EEA/50014/2013.
REFERENCES
[1]
R. R. Shamshiri, C. Weltzien, I. A. Hameed, I. J. Yule, T. E. Grift,
S. K. Balasundram, L. Pitonakova, D. Ahmad, and G. Chowdhary,
“Research and development in agricultural robotics: A perspective of
digital farming,” International Journal of Agricultural and Biological
Engineering, vol. 11, no. 4, 2018, pp. 1–14.
[2]
A. Valente, A. Saraiva, N. Ferreira, and S. Soares, “On the Design and
Construction of Dual-Probe Heat-Pulse Soil Moisture Sensor: Towards
an Industrial Solution,” in ALLSENSORS, At Rome, Italy, 4 2018.
[3]
Quinta do Crasto - Uma Hist´oria que vem de longe (1615-2018), Dec.
2018, ISBN: 978-989-20-8980-5.
[4]
S. Silva, S. Soares, A. Valente, and A. Moreira, “Distributed Sensing
System Model for Future Internet Agricultural Application,” in Pro-
ceedings PEECC 2015 - Doctoral Consortium, 2 2015.
[5]
“Long Range Wide Area Network,” 2019, URL: https://www.lora-
alliance.org/ [accessed: 2019-01-16].
[6]
M. Lauridsen, I. Z. Kov´acs, P. Mogensen, M. Sorensen, and S. Holst,
“Coverage and Capacity Analysis of LTE-M and NB-IoT in a Rural
Area,” in Vehicular Technology Conference (VTC-Fall), 2016 IEEE
84th.
IEEE, 2016, pp. 1–5.
[7]
A. Valente, R. Morais, A. Tuli, J. W. Hopmans, and G. J. Kluitenberg,
“Multi-functional probe for small-scale simultaneous measurements
of soil thermal properties,water content, and electrical conductivity,”
Sensors and Actuators, A: Physical, 2006, pp. 70–77.
[8]
Y. Mori, J. Hopmans, A. Mortensen, and G. Kluitenberg, “Multi-
Functional Heat Pulse Probe for the Simultaneous Measurement of Soil
Water Content, Solute Concentration, and Heat Transport Parameters,”
Vadoze Zone, vol. 2, 2003, pp. 561–571.
[9]
N. Zhang, G. Fan, K. Lee, G. Kluitenberg, and T. Loughin, “Simultane-
ous measurement of soil water content and salinity using a frequency-
response method,” Soil Science Society of America, vol. 68, 2004, pp.
1515–1525.
[10]
C. Donfack, “Caract´erisation de contacts ´electrodes-tissus pour les
stimulateurs neuro-musculaires implantables,” M´emoire de maˆıtrise,
´Ecole polytechnique de Montr´eal, Canada, 2000.
48
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-691-0
ALLSENSORS 2019 : The Fourth International Conference on Advances in Sensors, Actuators, Metering and Sensing

