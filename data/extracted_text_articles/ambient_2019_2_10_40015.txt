Multivariate Event Detection for Non-Intrusive Load Monitoring
Alexander Gerka and Benjamin Cauchi
OFFIS e.V.
Institute for Information Technology
Oldenburg, Germany
Email: gerka@ofﬁs.de
benjamin.cauchi@ofﬁs.de
Andreas Hein
Carl von Ossietzky University,
Oldenburg, Germany
Email:andreas.hein@uol.de
Abstract—Due to the growing interest for in-home activity
monitoring, the tracking of appliances use, usually referred to
as Non-Intrusive Load Monitoring (NILM), has to address new
challenges. Indeed, as NILM has long been motivated by potential
energy savings, most event detectors for NILM have focused on
the detection of on- or off-switches of high power devices. On the
contrary, in-home monitoring typically relies on the detection of
events related to low-power devices from potentially noisy signals.
Additionally, approaches that apply expert heuristics to a single-
variate input, often favored for their low complexity and real-time
applicability, can be overly sensitive to the choice of an arbitrary
deﬁned detection threshold. This paper aims at decreasing the
sensitivity of a detector based on expert heuristic by applying
it to the Hotelling-T2 statistic of a multivariate input, computed
online from the current and voltage inputs. Focusing on realistic
scenarios, the approach is evaluated on a dataset recorded in a
real apartment using a commercially available smart-meter. The
results, expressed in terms of precision, recall and F-score, show
that the proposed approach can both yield higher performance
and be less sensitive to the choice of the detection threshold.
Keywords—NILM; Event Detection; Hotelling-T2 statistic
I. INTRODUCTION
Non-intrusive load monitoring (NILM), introduced by
George Hart in the 1980s [1], denotes the tracking of ap-
pliances use through analysis of their power consumption.
The growing presence of smart meters in homes, encouraged,
e.g., by a directive of the European Union in 2009 [2], has
led to renewed research efforts in NILM. These efforts have
been mostly motivated by the potential for energy savings and,
therefore, focussed on the monitoring of high power devices.
However, due to the ageing population [3], applications such
as activity monitoring for disease prevention [4][5] or the
surveillance of life-critical devices present in homes, e.g., for
respiration support [6], have become of crucial importance.
The main advantage of NILM-based monitoring system is their
unobtrusiveness, as they do not require an additional installa-
tion. Additionally, a NILM-system could prevent other, more
obtrusive, installations such as power plugs. Consequently,
NILM approaches able to reliably monitor the use of low
power devices in realistic settings are urgently needed.
Many
approaches
extract
multiple
features
from
the
recorded power consumption signal in order to determine
the active appliances during a given time sequence. It has
been proposed in [1] to use both reactive and real power.
However, due to the high correlation between real and re-
active power consumption, these features are not sufﬁcient
for the classiﬁcation of low power devices [7]. As a result,
numerous features for NILM have been introduced in recent
years such as the current’s harmonic [8], the shape of the
so-called VI-trajectory [9] or the poles and residues of the
power signal’s impulse response [10]. The extraction of these
complex features require to record the current and voltage of
the power supply at a sampling frequency much higher than
50 Hz. Additionally, the applied classiﬁer typically relies on
an event based method rather than a state-based method and
necessitate to segment the recorded signal into sequences of
interest. This segmentation requires an event detector, i.e., the
detection of on- and off-switches of appliances. This paper
focuses on event detection for NILM in realistic scenarios.
Approaches aiming at event detection for NILM can be
broadly split between three categories, namely, based on expert
heuristics, matched ﬁltering, or probabilistic methods [11].
Though promising, probabilistic methods based on, e.g., gener-
alized likelihood ratio (GLR) [12], goodness-of-ﬁt (GOF) [13]
or cumulative sum control (CuSuM) [14] can be compu-
tationaly costly and often rely on long sequences of input
signal, making them impractical in many realistic settings.
Approaches based on matched ﬁltering, e.g., using Cepstrum
smoothing [15] or Hilbert transformation [16] can be sensitive
to mismatch between the dataset used to tune the approach and
the environment in which it is tested. Though promising, the
approach presented in [15] showed largely lower performance
when tested on data containing low-power devices [17].
Approaches based on expert heuristics rely on the choice
of a somewhat arbitrarily deﬁned threshold or rule-based
approach [1][18], on which their performance can be greatly
sensitive. However, relying on features whose extraction is
typically computationally inexpensive, e.g., standard deviation
of the current signal envelope [19]. Approaches based on
expert heuristics are easily implemented. Therefore, reducing
their sensitivity on an arbitrary deﬁned threshold could be of
great interest. Contrary to most expert heuristic approaches
that use a single-parameter as input, the approach proposed in
25
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-739-9
AMBIENT 2019 : The Ninth International Conference on Ambient Computing, Applications, Services and Technologies

this paper aims at decreasing the sensitivity of a detector based
on a expert heuristic by applying the Hotelling-T2 statistic to
a multivariate input.
In order to evaluate the beneﬁt of the proposed approach,
a dataset recorded in realistic conditions has to be used.
Indeed, most datasets from the literature only considered low
frequency systems [1][12][20], speciﬁc devices [18] or sets
of (mostly) high-power devices [13][14][16][21]. Additionally,
those studies were often performed under laboratory condi-
tions [1][14], i.e., in absence of capacitive effects of the long
supply line and other environmental noise factors present in
a real apartment. Such signal disturbances can have a large
impact. Consequently, the evaluation conducted in this paper
is done using a dataset recorded in a real apartment using a
commercially available smart-meter.
The remainder of this paper is structured as follows. First,
the proposed approach and the expert heuristic approach
that is used as benchmark is described in Section II. The
recorded dataset and experimental framework are described in
Section III and the results in Section IV. Section V concludes
the paper.
II. PROPOSED APPROACH
In this section the proposed approach is described.
A. Threshold based NILM event detection
The signal recorded from a monitoring device, e.g., a smart
meter, typically consists of M = 2 channels representing the
current in Ampere and the voltage in Volts. In the remainder
of this paper, we use xm(n) to denote the signal recorded at a
sampling frequency fs, at sample index n, in the m-th channel.
We arbitrary set m = 0 as the index of the current channel and
m = 1 as the index of the voltage channel. Event detection
methods for NILM based on experts heuristics, such as the
one proposed in [19], typically rely on segmenting the input
signal into overlapping frames of length L with an hop size of
H samples and assigning a label d(ℓ) ∈ [0, 1] equal to 1 if an
event is detected in the ℓ-th frame and equal to 0 otherwise.
The methods considered in this paper rely on computing a
change quantifying value v(ℓ) ∈ R≥0, whose computation is
the focus of the next subsection, for each frame, and applying
d(ℓ) =
(
1 if v(ℓ) ≥ τ(ℓ),
0 otherwise,
(1)
where τ(ℓ) denotes a decision threshold. It can be noted
that contrary to methods in which the decision threshold is
computed from a complete signal utterance, e.g., [13][21], this
paper considers event detection for real-time application and
uses a frame dependant threshold computed as
τ(ℓ) = α · σv(ℓ − δ),
(2)
where δ denotes a decision delay and where
σv(ℓ) =
v
u
u
u
t
1
∆ − 1
∆−1
X
i=0

v(ℓ − i) − 1
∆
∆−1
X
j=0
v(ℓ − j)

2
(3)
denotes the standard deviation of v(ℓ) computed over ∆
buffered values. In practical applications, the values of δ and
∆ are often hardware dependant. However, the choice of value
assigned to the constant α in (2), though of critical importance
for the detection performance, is typically arbitrarily deﬁned.
The sensitivity of the detection performance to the choice of α
can be limited if the value v(ℓ) suitably quantiﬁes the potential
changes in the signal at a given time frame, i.e. v(ℓ) ≈ 0 when
no change is present.
B. Change quantiﬁcation
As most similar detectors, the approach proposed in [19]
that we chose as benchmark (cf. Section IV) due to its low
computational complexity and promising performance only
uses the recorded current to quantiﬁes the change in the input
signal, i.e., computes v(ℓ) from x0(n) only. This computation
relies on extracting for each frame, the envelope eℓ(n) of
length Le = H · (E − 1) + L, where E denotes the number of
frames used in the envelope extraction. The envelope eℓ(n) is
computed as the interpolation, e.g., linear or cubic, between
the maximums of |x0(n)| in each of the E considered frames
and, assuming that E {eℓ(n)} is constant in absence of event,
the change quantifying value v(ℓ) can be computed as the
Change of Mean Amplitude Envelope (CMAE)
v(ℓ) = 1
Le

Le−1
X
i=0
eℓ−1(i) − eℓ(i)
 .
(4)
Unfortunately computing v(ℓ) as in (4) can, as stated in [19],
result in an unreliable detector in presence of noisy signals.
We aim at improving the reliability of the threshold based
detector from (2) by improving the computation of v(ℓ).
Preliminary works showed that using multiple features can
be extracted from a NILM-signal. In general those features
can be separated into different domains:
1) power related features in time domain
2) power related features in frequency domain
3) features related to the phase difference between current
an voltage
Therefore, we propose to use a feature from each feature
domain as the information about the NILM-signal contained
by a feature is different for every domain. More speciﬁcally,
we have shown in [22] that the variance of the current, taking
advantage of both input channels, the phase of the input
signal and, the current’s frequency ratio were beneﬁcial. In
our proposed approach, we extract for each frame a Lv = 3
elements feature vector
v(ℓ) =
h
σ2
x(ℓ) , φ(ℓ) , ω(ℓ)
iT
,
(5)
where ·T denotes the transpose operator and where σ2
x(ℓ), φ(ℓ)
and ω(ℓ) denote the current variance, the phase and the current
26
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-739-9
AMBIENT 2019 : The Ninth International Conference on Ambient Computing, Applications, Services and Technologies

frequency ratio computed as
σ2
x(ℓ) =
1
L − 1
L−1
X
i=0

x0(ℓH + i) − 1
L
L−1
X
j=0
x0(ℓH + j)

2
(6)
φ(ℓ) = cos−1
PL−1
i=0 x0(ℓH + i) · x1(ℓH + i)
qPL−1
i=0 x0(ℓH + i)2 ·
qPL−1
i=0 x1(ℓH + i)2
(7)
ω(ℓ) =
PL−1
i=0
˜xf(ℓH + i) − 1
L
PL−1
j=0 ˜xf(ℓH + j)

2
PL−1
i=0
xf(ℓH + i) − 1
L
PL−1
j=0 xf(ℓH + j)

2 , (8)
where ˜xf(n) denotes the output of a bandpass ﬁlter applied to
x0(n) and centred around the carrier frequency f of the input
signal (cf. Section III-B) and xf(n) = x0(n) − ˜xf(n).
We consider each vector v(ℓ) to be a single independent
realisation of a random process with an Lv-dimensional F-
distribution and deﬁne the sequences of vectors V0(ℓ) and
V1(ℓ) of length L0 and L1, respectively, as
V0(ℓ) = {v(ℓ − L0) , · · · , v(ℓ − 2) , v(ℓ − 1)},
(9)
V1(ℓ) = {v(ℓ) , v(ℓ + 1) , · · · , v(ℓ + L1 − 1)}.
(10)
An event is considered to occur at frame ℓ if the V0() and V1()
are composed of realisations of signiﬁcantly distinct distribu-
tions. This signiﬁcance of can be expressed by the Hotelling-
T2 statistic [23]. The computation of the Hotelling-T2 statistic
depends on the homogeneity of the partial covariance matrices
(Γ0(ℓ) and Γ1(ℓ)) computed separately from the vectors V0(ℓ)
and V1(ℓ). If, using the box test [24], these matrices are
determined to be homogeneous, the Hotelling-T2 statistic is
computed as
T 2(ℓ) = L0 · L1
L0 + L1
·

0
5
10
15
20
Lamp
Radio
Oven
Television
Air cleaner
Bed
Bread maker
Computer
Exhaust duct
Resp. support
Stove
Thermomix
Water kettle
Number of devices
Bathroom
Bedroom
Hall
Kitchen
Living Room
Storeroom
Working Room
Figure 1. Distribution of the appliances used to record the evaluation dataset.
values α ∈ {1 · · · 30}. It can be noted that the exact values of
∆ and δ seemed to have a limited impact on the performance
of the considered approaches. The box test and computation
of T 2(ℓ), cf. (11) and (12), were based on the implementation
provided in [25] and according to its recommendation we used
L0 = L1 = 100.
The performance of the considered approaches was deter-
mined using the Precision, Recall and F-score deﬁned as [26]
Precision =
True positives
True positives + False positives,
(13)
Recall =
True positives
True positives + False negatives,
(14)
F-score = 2 · Precision · Recall
Precision + Recall,
(15)
where the number of true positives and false negatives were
determined as follows. First, events detected within the same
8 s window were considered as a single-event. The same
tolerance was used to determine if a detected event should
be assigned to an annotated event, i.e., true positive, or to
none, i.e., false positive. Annotated events with no assigned
detection were considered false negatives.
IV. RESULTS
An example of the extracted features from the smart meter
input signal and the resulting Hotelling value that represents
the combination of these features is shown in Figure 2. This
ﬁgure shows that relatively small changes in the variance
(i.e., at the 15th second) are accompanied by relatively big
changes in the phase. As a result, the Hotelling value shows a
clear peak around the 15th second which should be easier to
detect by the event detection algorithm than the pure variance.
Therefore, this observation suits the intuition that the usage of
multiple non-related features may improve the detection of
events in a NILM-signal.
The observed precision and recall as function of α are
depicted in Figure 3. It appears that in the case of both CMAE
and Hotelling-T2, the precision increases with the value α,
until it reaches a plateau, which in both cases corresponds
to a precision of about 0.6. This behaviour is to be expected
as increasing the value of α reduces the likelihood of false
positives.
On the other hand, high values of α would increase the
likelihood of false negative. This behavior can be noticed
by observing the recall (Figure 3), for which the proposed
approach exhibits a large advantage compared to the use of
CMAE. Using CMAE, the recall decrease sharply for values
of α ranging from 3 to 7 and ultimately reaches a plateau with
a recall of 0.2. On the contrary, using Hotelling-T2 statistic,
recall decreases slowly with increasing values of α with a
plateau corresponding to a recall of 0.8. This shows that the
proposed approach is less likely to introduce false negative,
even for overly large values of α.
The advantage of the proposed method over the use of
CMAE is best noticed by observing the F-score depicted in
Figure 4. As a logical consequence of the behaviour observed
in terms of precision and recall, using CMAE requires an
accurate setting of α in order to yield the optimal F-score.
Indeed, F-score obtained using CMAE decreases sharply for
α values different than 3 or 4. On the other hand, not only
does the use of Hotelling-T2 statistic yields a higher maximum
F-score with a value of 0.7, but its performance is much less
sensitive to the setting of α value.
Further improvement of the presented approach could be
achieved by using the multivariate approach with other event
detectors or by improving the multivariate statistic itself, i.e.
using multivariate likelihood detectors [27].
V. CONCLUSION
This paper proposes to use Hotelling-T2 statistic, computed
from a multivariate input, in order to reduce the sensitivity
of an event detector for NILM based on expert heuristics
to the value of an arbitrary deﬁned detection threshold. The
multivariate input is computed online from a recorded signal
of current and voltage. The proposed approach is compared to
the use of CMAE, which, as many similar approaches, does
not take advantage of the available voltage input or frequency-
related features.
A dataset recorded in real environment, i.e., containing
appliances relevant to activities monitoring and noisy signal,
was used to evaluate the proposed approach. The results,
expressed in terms of precision, recall and F-score, show that
not only does the proposed approach yield better performance
than the considered benchmark, this performance is much less
sensitive to the setting of the detection threshold.
Even if using multiple features for event detection is compu-
tationally more expensive, we think this approach improves the
event detection in NILM systems in future implementations,
epecially for the detection of low-power devices in high-
frequency load signals. In future work, we will evaluate the
28
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-739-9
AMBIENT 2019 : The Ninth International Conference on Ambient Computing, Applications, Services and Technologies

0
0.2
0.4
0.6
0.8
1
Variance
0
0.2
0.4
0.6
0.8
1
Phase
0
10
20
30
40
50
60
0
0.2
0.4
0.6
0.8
1
Time [s]
Frequency Ratio
0
10
20
30
40
50
60
0
0.2
0.4
0.6
0.8
1
Time [s]
Hotelling Value
Figure 2. Extracted features and resulting Hotelling value from one phase. Values are normalized between 0 and 1 for readability.
0
0.2
0.4
0.6
0.8
1
Precision
CMAE
Hotelling-T2
1
5
10
15
20
25
30
0
0.2
0.4
0.6
0.8
1
α
Recall
Figure 3. Precision and recall as function of applied threshold.
presented approach with other high-frequency datasets and
event detection algorithms.
ACKNOWLEDGMENT
This work is partially funded by the Central Federal As-
sociation of the Health Insurance Funds of Germany (GKV-
1
5
10
15
20
25
30
0
0.2
0.4
0.6
0.8
1
α
F-score
CMAE
Hotelling-T2
Figure 4. F-score as function of applied threshold.
Spitzen-verband) in the context of the QuoVadis research
project and by the German Ministry for Education and Re-
search (BMBF) within the joint research projects MeSiB (grant
16SV7723) and Audio-PSS (grant 02K16C201).
29
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-739-9
AMBIENT 2019 : The Ninth International Conference on Ambient Computing, Applications, Services and Technologies

REFERENCES
[1] G. W. Hart, “Nonintrusive appliance load monitoring,” Proceedings of
the IEEE, vol. 80, no. 12, pp. 1870–1891, 1992.
[2] Union, European, “Directive 2009/28/ec of the european parliament
and of the council of 23 april 2009 on the promotion of the use
of energy from renewable sources and amending and subsequently
repealing directives 2001/77/ec and 2003/30/ec,” Ofﬁcial Journal of the
European Union, vol. 5, p. 2009, 2009.
[3] World Health Organization, “World report on ageing and health,” 2015.
[4] C. Chalmers, W. Hurst, M. Mackay, and P. Fergus, “Smart health moni-
toring using the advance metering infrastructure,” in International Con-
ference on Computer and Information Technology; Ubiquitous Comput-
ing and Communications; Dependable, Autonomic and Secure Comput-
ing; Pervasive Intelligence and Computing (CIT/IUCC/DASC/PICOM).
IEEE, 2015, pp. 2297–2302.
[5] J. M. Alcal´a, J. Ure˜na, ´A. Hern´andez, and D. Gualda, “Assessing human
activity in elderly people using non-intrusive load monitoring,” Sensors,
vol. 17, no. 2, p. 351, 2017.
[6] A. Gerka, C. Lins, C. L¨upkes, and A. Hein, “Zustandserkennung von
Beatmungsger¨aten durch zentrale Messung des Stromverbrauchs,” in
German Medical Science GMS Publishing House, 09 2017.
[7] A. Zoha, A. Gluhak, M. A. Imran, and S. Rajasegarar, “Non-intrusive
load monitoring approaches for disaggregated energy sensing: A survey,”
Sensors, vol. 12, no. 12, pp. 16 838–16 866, 2012.
[8] T. Onoda, Y. Nakano, and K. Yoshimoto, “System and method for
estimating power consumption of electric apparatus, and abnormality
alarm system utilizing the same,” Nov. 9 2004, uS Patent 6,816,078.
[9] H. Y. Lam, G. Fung, and W. Lee, “A novel method to construct taxonomy
electrical appliances based on load signatures,” IEEE Transactions on
Consumer Electronics, vol. 53, no. 2, pp. 653–660, 2007.
[10] A. Diop, T. Jouannet, K. E. K. Drissi, and H. Najmeddine, “Method
and device for the non-intrusive determination of the electrical power
consumed by an installation, by analysing load transients,” Oct. 8 2013,
uS Patent 8,554,501.
[11] K. D. Anderson, M. E. Berg´es, A. Ocneanu, D. Benitez, and J. M.
Moura, “Event detection for non intrusive load monitoring,” in IECON
38th Annual Conference on Industrial Electronics Society. IEEE, 2012,
pp. 3312–3317.
[12] L. Norford, S. Leeb, D. Luo, and S. Shaw, “Advanced electrical
load monitoring: A wealth of information at low cost,” Diagnostics
for Commercial Buildings: from Research to Practice, Paciﬁc Energy
Institute, San Francisco, CA, 1999.
[13] A. R. Rababaah and E. Tebekaemi, “Electric load monitoring of
residential buildings using goodness of ﬁt and multi-layer perceptron
neural networks,” in International Conference on Computer Science and
Automation Engineering (CSAE), vol. 2.
IEEE, 2012, pp. 733–737.
[14] Z. Zhu, S. Zhang, Z. Wei, B. Yin, and X. Huang, “A novel cusum-based
approach for event detection in smart metering,” in IOP Conference
Series: Materials Science and Engineering, vol. 322, no. 7.
IOP
Publishing, 2018, p. 072014.
[15] L. De Baets, J. Ruyssinck, D. Deschrijver, and T. Dhaene, “Event
detection in nilm using cepstrum smoothing,” in 3rd International
Workshop on Non-Intrusive Load Monitoring, 2016, pp. 1–4.
[16] J. M. Alcal´a, J. Ure˜na, and ´A. Hern´andez, “Event-based detector for non-
intrusive load monitoring based on the hilbert transform,” in Emerging
Technology and Factory Automation (ETFA).
IEEE, 2014, pp. 1–4.
[17] K. Anderson et al., “Blued: A fully labeled public dataset for event-
based non-intrusive load monitoring research,” in Proceedings of the 2nd
KDD workshop on data mining applications in sustainability (SustKDD),
2012, pp. 1–5.
[18] L. Farinaccio and R. Zmeureanu, “Using a pattern recognition approach
to disaggregate the total electricity consumption in a house into the
major end-uses,” Energy and Buildings, vol. 30, no. 3, pp. 245–259,
1999.
[19] M. N. Meziane, P. Ravier, G. Lamarque, J.-C. Le Bunetel, and
Y. Raingeaud, “High accuracy event detection for non-intrusive load
monitoring,” in International Conference on Acoustics, Speech and
Signal Processing (ICASSP).
IEEE, 2017, pp. 2452–2456.
[20] A. U. Rehman, T. T. Lie, B. Vall`es, and S. R. Tito, “Event-detection
algorithms for low sampling nonintrusive load monitoring systems
based on low complexity statistical features,” IEEE Transactions on
Instrumentation and Measurement, 2019.
[21] L. Jiang, S. Luo, and J. Li, “Automatic power load event detection and
appliance classiﬁcation based on power harmonic features in nonintru-
sive appliance load monitoring,” in 8th IEEE Conference on Industrial
Electronics and Applications (ICIEA).
IEEE, 2013, pp. 1083–1088.
[22] A. Gerka, F. L¨ubeck, M. Eichelberg, and A. Hein, “Electricity metering
for dementia care,” in VDE-Kongress – Internet der Dinge. Technologien
/ Anwendungen / Perspektiven., V. e. V., Ed.
VDE Verlag, 11 2016,
inproceedings, p. Paper 54.
[23] H. Hotelling, “The generalization of student’s ratio,” in Breakthroughs
in statistics.
Springer, 1992, pp. 54–65.
[24] J. P. Stevens, Applied Multivariate Statistics for the Social Sciences.
Routledge Member of the Taylor and Francis Group, 2009, vol. 5.
[25] A. Trujillo-Ortiz and R. Hernandez-Walls, “Hotellingt2: Hotelling t-
squared testing procedures for multivariate tests. a matlab ﬁle,” 2002.
[26] S. Makonin and F. Popowich, “Nonintrusive load monitoring (nilm)
performance evaluation,” Energy Efﬁciency, vol. 8, no. 4, pp. 809–814,
2015.
[27] L. I. Kuncheva, “Change detection in streaming multivariate data us-
ing likelihood detectors,” IEEE Transactions on Knowledge and Data
Engineering, vol. 25, no. 5, pp. 1175–1180, 2013.
30
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-739-9
AMBIENT 2019 : The Ninth International Conference on Ambient Computing, Applications, Services and Technologies

