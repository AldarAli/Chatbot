Adaptive Active Contours for the 3D Segmentation
of Computed Tomography Images
Miguel Alem´an-Flores and Luis Alvarez
Departamento de Inform´atica y Sistemas
Universidad de Las Palmas de Gran Canaria
Las Palmas, Spain
Email: {maleman, lalvarez}@dis.ulpgc.es
Abstract—Computed Tomography is one of the most valuable
modalities of medical imaging and is used in the diagnosis of a
wide range of pathologies. In many cases, it is necessary to obtain
a precise segmentation and a 3D visualization of certain organs,
tissues, nodules or regions in the tomography. However, manual
delimitation is a very time-consuming process and advanced
applications are needed to perform this process automatically.
Active contours intend to ﬁt an initial approximation to the most
relevant edges around the starting contour. Most approaches of
active contours assume that all points in the initial approximation
are close to the ﬁnal solution and that similar conditions can
be set to all the sections of the contour, which is frequently
a false assumption. For that reason, we have developed a
new approach, in which different terms are used and adapted
according to the evolution of the contour. Balloon, regularizing
and attraction terms are combined and extended to 3D, avoiding
the need for a close initial approximation and reducing human
intervention. Furthermore, a multiscale framework is added to
tackle the heterogeneity of the images and the variability of the
approximations. The combination of these terms allows obtaining
a more precise segmentation of the tomography.
Keywords—segmentation; computed tomography; active con-
tours.
I.
INTRODUCTION
Computed tomography (CT) is a medical imaging tech-
nique which generates tomographic images or slices from
computer-processed X-rays. The cross-sectional images which
are obtained can be used for diagnostic and therapeutic pur-
poses. For an appropriate assessment of a radiological study,
or for the extraction of certain measurements, the segmentation
of the corresponding organs, tissues, or regions is frequently
needed.
Different approaches have been proposed to perform this
kind of segmentations, from graph-based algorithms [1] to
atlas-based systems [2] and region-growing schemes [3]. Some
methods are fully automated [4], some others require human
intervention [5].
Active contours are a very useful tool for adjusting a
contour to the edges in an image [6][7][8]. The basic idea
underlying active contours consists in making a contour evolve
locally according to certain features of the neighborhood of
each contour point. Several problems arise when applying this
technique to computed tomography. First, an initial approxi-
mation is required, but manual initialization is an extremely
time-consuming task, since each 3D image consists of a large
amount of 2D images. Second, these images present noise,
heterogeneities and blurred edges, which makes it necessary
to include additional terms to separate regions without clearly
deﬁned edges. Finally, local minima may stop the evolution
on wrong edges.
Some variations have been proposed to tackle these prob-
lems in different types of images, but handling all of them
is still a challenging task. Among these works, we can ﬁnd
some approaches applied to textured regions and areas without
clearly deﬁned edges, using region descriptors or statistical in-
formation [9][10][11][12][13]. If we focus on medical images,
similar approaches using texture descriptors and statistical
information have been applied in [14][15]. Active contours
have also been used to deal with other kinds of problems,
such as object tracking and motion estimation [16] or tensor
images [17].
In this work, we propose a multistage approach in which
human intervention has been considerably reduced. First, we
ﬁlter the images by means of a 3D anisotropic ﬁlter. We
adapt the ideas of the classical Perona-Malik equation [18] to
the diffusion of computed tomographies. Afterward, an initial
approximation is obtained from a single inner point of the
region we want to segment by combining some terms in the
active contours approach. These terms include balloon forces
to expand the region, regularizing terms to smooth the contour
and include small holes, and attraction terms to ﬁt the contour
to the edges. Finally, we introduce a multiscale framework
to reﬁne the segmentation and adapt it to the edges in the
image. To tackle the problem of irregular edges and variable
distance from the initial segmentation to the actual contour,
this framework includes different scales in the attraction term,
so that the diffusion depends on the magnitude of the gradient
in the region. These multiscale active contours allow a better
adaptation to the particular features of each area.
This paper is organized as follows: Section II introduces the
underlying ideas of active contours and the classical approach
used in their application. In Section III, the 3D anisotropic
ﬁltering is presented. The three types of morphological active
contours (balloon, regularizing and attraction terms) which are
combined in this work are presented in Section IV, whereas
the multiscale approach used to improve the segmentation
is explained in Section V. Section VI explains the post-
processing of the 3D contour points to obtain the ﬁnal volume
and Section VII summarizes our main conclusions and future
work.
66
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-310-0
INFOCOMP 2013 : The Third International Conference on Advanced Communications and Computation

II.
GEODESIC ACTIVE CONTOURS
Geodesic active contours, also known as snakes, are based
on the minimization of the following energy with respect to
the contour C:
Egac(C) =
Z
C
gσ(C(s)) ds,
(1)
where C : [0, L] → R2, L > 0, is a rectiﬁable curve parame-
terized by arc-length s, and ds denotes the arc-length element.
The function gσ(x, y) is used to stop the evolution of the
snake when it approaches the edges. It is a smooth decreasing
function of the modulus of the gradient of a regularized version
of the image I(x, y) on which the segmentation is performed,
and acts as an edge detector. As in [7], we can use:
gσ (I) =
1
q
1 + α ∥∇Iσ∥2 ,
(2)
where Iσ represents the convolution of the original image
I with a Gaussian kernel with standard deviation σ. The
parameter α controls how contrasted the edges must be to stop
the evolution. On the other hand, σ determines how much I
is smoothed, so that increasing its value will blur the image,
reducing noise but also details. To minimize the energy in (1),
we can use a gradient descent curve evolution written as:
Ct = −δEgac(C)
δC
,
(3)
where
δEgac(C)
δC
represents the ﬁrst variation of Egac. Com-
puting the ﬁrst variation of E, we obtain (see [7]) the curve
evolution equation:
Ct = (κgσ − ⟨∇gσ, n⟩)n,
(4)
where κ denotes the curvature of C. To write the level set
formulation of (4), we introduce a function u(t, x, y) as an
implicit representation of C(t). Usually, to construct the initial
snake u(0, x, y), a set of points determining a parameterization
of a polygon P0(˜s) = (x0(˜s), y0(˜s)) are manually selected.
Afterward, u(0, x, y) is deﬁned in such a way that P0(˜s)
corresponds to the zero level set of u(0, x, y). In our case,
instead of manually deﬁning P0(˜s) by means of several points
outlining the contour, we apply the morphological snakes
described in Section IV from a single inner point (manually
selected by the user) and consider the curve Pi(˜s) obtained
when ﬁnishing the process. This way, we can deﬁne u(0, x, y)
as the signed distance function to Pi(˜s) (positive inside,
negative outside), or simply consider two different values for
the inner and outer regions.
With this approach, the level set formulation of the geo-
metric curve evolution in (4) is given by:
∂u
∂t = ∥∇u∥ div

gσ (I) ∇u
∥∇u∥

.
(5)
If we expand this equation, we obtain the following ex-
pression, in which the ﬁrst term controls the smoothness of the
contour and the second one makes the contour evolve toward
the highest gradients:
∂u
∂t = gσ (I) ∥∇u∥ div
 ∇u
∥∇u∥

+ λ∇u∇gσ (I) .
(6)
The parameter λ > 0 has been introduced to balance the
contribution of both terms. If we increase the value of λ,
the attraction term will have a higher contribution and the
contour will try to ﬁt to the highest gradients in the current
conﬁguration. On the other hand, decreasing its value will
round the contour, making it tend to a more regular outline.
When an initial approximation is available, geodesic active
contours permit to improve the pre-segmentation, since the
contour adapts to the minimum of the energy in (1). As
mentioned above, this pre-segmentation must be relatively
close to the real contour of the region to segment. Otherwise,
the effect of the second term in (6) will not be enough to
overcome the regularizing effect of the ﬁrst term and, instead
of approaching the real edges, the snake will be rounded and
will tend to reduce.
From this general scheme of active contours, we propose
a three-stage process to segment the computed tomography
images. First, the tomography is ﬁltered using an anisotropic
3D ﬁlter. Second, three types of morphological operations are
combined to obtain an initial approximation of the contours.
Finally, a multiscale scheme for active contours is introduced
to reﬁne the approximation and improve its accuracy.
III.
THREE-DIMENSIONAL ANISOTROPIC FILTERING
Balloon forces allow obtaining an initial approximation
from a seed point, but they need a relatively homogeneous
region to expand, in which irrelevant or spurious edges have
been removed or reduced. With the aim of reducing noise,
but preserving the edges, we ﬁrst apply a 3D adaptation of
Perona-Malik ﬁltering [18]:
ut = div (k (∥∇u∥) ∇u) ,
(7)
where we use:
k (x) = e−βx.
(8)
This kind of approaches, which diffuse the image but
preserve the most important edges, are usually applied to single
2D images. However, as we deal with a series of uniformly
spaced images, we can apply them in three dimensions, so
that the noise reduction process also takes into account the
neighbors in the previous and next images in the CT, i.e.,
the values at the same position in the neighboring images.
Since the distance between two consecutive images may not
be the same as the distance between the pixels within an
image, different weights can be assigned to the neighbors in
the different coordinates. This way, we ﬁlter the 3D image as
a whole, and not each slice separately.
Depending on the similarity of the various elements in the
3D image, their contrast and texture, the value of β in (8) can
be adapted, as well as the number of iterations in the following
discrete approach:
67
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-310-0
INFOCOMP 2013 : The Third International Conference on Advanced Communications and Computation

un+1
i,j,k = un
i,j,k +
dt
2 (dh)2 M

ﬁlling the holes of the segmentation, avoiding an extremely
irregular contour. This is obtained by controlling the curvature
of the contour as follows:
∂u
∂t = g (I) ∥▽u∥

div
 ▽u
∥▽u∥

.
(14)
In order to implement this kind of regularization, we
consider the SId and ISd operators:
(SIdu) (x) = sup
S∈B

inf
y∈x+hSu (y)

(ISdu) (x) = inf
S∈B
 
sup
y∈x+hS
u (y)
!
(15)
where sup is the supremum or least upper bound and inf is the
inﬁmum or greatest lower bound (h is a scale factor). The base
B is a set of 9 planes (since we work with a 3D image, we
deal with 9 planes instead of the 4 lines used in [19] and [20]),
which cover all the possible planes within the neighborhood of
the point which is being considered. The combination of both
operators generates a smoother contour by performing erosion
and dilation processes as follows:
un+1 (x) =

(SId ◦ ISdun) (x)
if g (I) (x) ≥ t
un (x)
otherwise
(16)
Finally, the third term is an attraction term, similar to that
described in Section II (second term in (6)), although, in this
case, the levels are only two, i.e., inside and outside the contour
(1 or 0), and the condition to expand, contract, or remain
constant depends on the product of the gradient of the current
snake and that of the stopping function g:
∂u
∂t = ▽g (I) ▽ u,
(17)
which is discretized as follows:
un+1 (x) =















1
if ▽ un (x) ▽ g (I) (x) > 0
and g (I) (x) ≥ t
0
if ▽ un (x) ▽ g (I) (x) < 0
and g (I) (x) ≥ t
un (x)
otherwise
(18)
Since the ﬁrst iterations are supposed to be quite far away
from the ﬁnal result, we start by applying only the balloon
term to speed up the process, and then introduce the other two
terms and combine all of them.
Figure 2 illustrates the result of applying these three types
of snakes from a single point for the segmentation of the liver.
Although it is a 3D segmentation, we show a single image
as a sample. As observed, the segmentation is not completely
satisfactory, since the balloon force has been stopped by the
proximity of the edges, the smoothing term has rounded the
Figure 2.
Final contour obtained for the liver using the morphological snakes
in an image belonging to a computed tomography.
contour and the attraction term has not been strong enough to
ﬁt the contour to the edges in all its segments. For this reason,
the multiscale approach described in the next section has been
introduced to reﬁne the results.
V.
MULTISCALE ACTIVE CONTOURS
As explained in Section II, the value of σ determines how
far the edges can be from the approximation to be reached. If
the initial segmentation is too coarse, we need to use a high
value of σ, but, as we approach the edges, it should be lower to
prevent the contour from being too rounded and poorly deﬁned.
Using higher values in the ﬁrst iterations and lower ones in
the last steps works properly if the distance from the current
approximation to the actual contour is homogeneous along the
snake.
Since it is usual that some segments of the snake are far
away from the actual contour, while others are already close
to it, we use a multiscale implementation, considering higher
values of σ in the most homogeneous regions and reducing it
when the edges are nearby. This way, the scale varies not only
across the iterations, but also from one region to another in
the same iteration. However, it is computationally expensive
to work simultaneously with a large number of different scales.
Therefore, we use a combination of a reduced set of them in
a single stopping/attraction term:
g (I) =
1
s
1 + α
nP
i=0

wn ∥∇Iσn∥2,
(19)
where the weights wn depend on the magnitude of the gradient
computed on the smoothed image.
In fact, we use four scales and four blending functions
which determine their weights, with the constraint that the
sum of all of them is 1 for every gradient value. In the
most homogeneous regions, large scales have a higher weight.
Therefore, further edges can be reached and the probability
of being stopped by a local minimum is reduced. When the
magnitude of the gradient increases, the weight of the small
scales is also increased. As a consequence, the contour can be
reﬁned according to the more detailed information.
Figure 3 shows how this approach improves the result of
the segmentation of the liver, the spleen, the liquid in the
stomach and a vertebra. Although the images which are shown
69
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-310-0
INFOCOMP 2013 : The Third International Conference on Advanced Communications and Computation

(a)
(b)
(c)
(d)
Figure 3.
Final contours for: (a) the liver, (b) the spleen, (c) the liquid in
the stomach, and (d) a vertebra, obtained after using the multiscale approach.
correspond to a single slice, the process is carried out in the
whole tomography, adapting the snake according to the edges
in all the slices. As observed, the combination of different
scales, which simultaneously contribute to adjust the contour,
allows adapting the evolution of the snake to the particular
features of each region, instead of trying to ﬁnd global values
for the entire 3D image.
VI.
THREE-DIMENSIONAL PROCESSING AND CONTOUR
COMBINATION
The case of computed tomographies is a special one, since
the 3D images are a combination of 2D images and, not only
may the distance between the slices be different to the distance
between the pixels in each 2D image, but it may also vary from
one scan to another.
As mentioned above, we try to minimize human interven-
tion and, at the same time, accelerate the process as much
as possible. To this aim, when the seed point is selected to
apply the morphological snakes, it is advisable to choose it in
one of the central slices, in order to reduce the distance to the
furthest edges in the volume. However, the thresholds for these
morphological snakes must be chosen carefully to prevent the
expansion from ﬂooding other regions.
The ﬁnal segmentation is given by a set of 3D points,
which belong to the planes determined by the slices in the
tomography. Figure 4 illustrates some slices of the 3D segmen-
tation of the liver obtained from a single point in a computed
tomography. Since the active contours are applied in the 3D
image, a single point allows reaching the edges in the whole
tomography. The balloon forces provide an initial volume,
which is later reﬁned by using the attraction, smoothing and
multiscale terms.
Figure 4. Final contours obtained for the liver in different slices of a computed
tomography.
In order to represent the ﬁnal segmentation in a more
intuitive way, a triangulation process is applied by joining the
3D contour points. This allows building a 3D reconstruction of
the region of interest and performing a further analysis when
it is needed (e.g., measurements or shape analysis). Figure 5
illustrates the triangulation for a section of the liver. Figure 6
shows a 3D volume representation of the spleen.
Figure 5.
Triangulation of a section of the liver obtained from the 3D contour
points.
70
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-310-0
INFOCOMP 2013 : The Third International Conference on Advanced Communications and Computation

Figure 6.
3D representation of the spleen generated from the triangulation
of the 3D segmentation.
As observed, introducing several scales in the active con-
tours allows adapting the snake to the edges according to
the rough and detailed information simultaneously, instead of
predeﬁning a single scale to work with.
VII.
CONCLUSION AND FUTURE WORK
In this paper, we have presented a method for obtaining
a 3D segmentation of a region in a computed tomography
by using an adaptive combination of different approaches for
the active contours technique. Trying to tackle this problem
with a single scheme would be very difﬁcult, but adapting
the contribution of the different terms to the needs of each
stage and area allows obtaining quite satisfactory results. A
combination of morphological operators, including balloon
forces, regularizing ﬁlters and attraction terms, is used to
extract a segmentation of the region of interest in a 3D image
from a single seed point.
Furthermore, the use of different scales makes it possible
to cope with those situations in which the contour is not
uniformly close to the edges, accelerating the expansion in
the most homogeneous regions and reﬁning the contour when
the ﬁnal result is nearby. These multiscale active contours
provide a framework to adapt the conditions of the snake to
the particular area on which it is being computed. In this way,
it is easier to deal with irregular edges and heterogeneous
regions, since we make use of both, the coarse and the detailed
information.
The results which have been obtained prove the efﬁciency
of this approach and encourage its use for the semi-automatic
analysis of medical images. The fact that the slices in the
tomography are ﬁltered and processed as a whole 3D image
provides more consistent results and allows a further analysis
for feature extraction, measurement or any other task which is
required.
Future work includes accelerating the process and introduc-
ing some anatomical information which can help identify and
distinguish the organs or tissues, as well as the application of
this framework to the analysis of certain particular pathologies.
ACKNOWLEDGMENT
The authors would like to thank Dr. Patricia Alem´an-Flores
and Dr. Rafael Fuentes-Pav´on from the Insular University Hos-
pital of Gran Canaria for their collaboration in this research.
REFERENCES
[1]
L. Grady, “Random Walks for Image Segmentation,” IEEE Transactions
on Pattern Analysis and Machine Intelligence, vol. 28, no. 11, 2006,
pp. 1768-1783.
[2]
T. Okada, K. Yokota, M. Hori, et al., “Construction of Hierarchical
Multi-Organ Statistical Atlases and their Application to Multi-Organ
Segmentation from CT Images,” Proc. MICCAI (1), 2008, pp. 502-509.
[3]
C. Couprie, L. J. Grady, L. Najman, and H. Talbot, “Power watersheds:
A new image segmentation framework extending graph cuts, random
walker and optimal spanning forest,” Proc. ICCV, 2009, pp. 731-738.
[4]
D. Kainmueller, T. Lange, and H. Lamecker, “Shape Constrained
Automatic Segmentation of the Liver based on a Heuristic Intensity
Model,” Proc. MICCAI Workshop on 3D Segmentation in the Clinic:
A Grand Challenge, 2007, pp. 109-116.
[5]
A. Beck and V. Aurich, “HepaTux–A Semiautomatic Liver Segmen-
tation System,” Proc. MICCAI Workshop on 3D Segmentation in the
Clinic: A Grand Challenge, 2007, pp. 225-233.
[6]
V. Caselles, F. Catt´e, T. Coll, and F. Dibos, “A geometric model for
active contours in image processing,” Numerische Mathematik, vol. 66,
1993, pp. 1-31.
[7]
V. Caselles, R. Kimmel, and G. Sapiro, “Geodesic Active Contours,
International Journal of Computer Vision,” vol. 22, no. 1, 1997, pp.
61-79.
[8]
M. Kass, A. Witkin, and D. Terzopoulos, “Active Contour Models,”
Proc. 1st International Conference on Computer Vision, 1987, pp. 259-
268.
[9]
T. Brox and J. Weickert, “Level set based image segmentation with
multiple regions,” Pattern Recognition, Lecture Notes in Computer
Science, vol. 3175, 2004, pp. 415-423.
[10]
T. F. Chan, B. Y. Sandberg, and L. A. Vese, “Active contours without
edges for vector-valued images,” J. Visual Communication and Image
Representation, vol. 11, no. 2, 2000, pp. 130-141.
[11]
D. Cremers, F. Tischh¨auser, J. Weickert, and C. Schn¨orr, “Diffusion
Snakes: Introducing Statistical Shape Knowledge into the Mumford-
Shah Functional,” International Journal of Computer Vision, vol. 50,
no. 3, 2002, pp. 295-313.
[12]
N. Paragios and R. Deriche, “Geodesic active regions for supervised
texture segmentation,” Proc. Internationl Conference on Computer Vi-
sion, 1999.
[13]
C. Sagiv, N. A. Sochen, and Y. Y. Zeevi, “Integrated active contours
for texture segmentation,” IEEE Transactions on Image Processing, vol.
15, no. 6, 2006, pp. 1633-1646.
[14]
M. Alem´an-Flores, L. ´Alvarez-Le´on, and V. Caselles, “Texture-Oriented
Anisotropic Filtering and Geodesic Active Contours in Breast Tumor
Ultrasound Segmentation,” Journal of Mathematical Imaging and Vi-
sion, vol. 28, no. 1, 2007, pp. 81-97.
[15]
M. Hern´andez and A. F. Frangi, “Geodesic active regions using nonpara-
metric statistical regional description and their application to aneurysm
segmentation from cta,” LNCS, vol. 3150, 2004, pp. 94-102.
[16]
N. Paragios and R. Deriche, “Geodesic active contours and level
sets for motion estimation and tracking,” Computer Vision and Image
Understanding, vol. 97, no. 3, 2005, pp. 259-282.
[17]
C. Lenglet, J. Campbell, M. Descoteaux, et al., “Mathematical Methods
for diffusion MRI processing,” Neuroimage, vol. 45, no. 1, 2009, pp.
111-122.
[18]
P. Perona and J. Malik, “Scale space and edge detection using
anisotropic diffusion,” IEEE Transactions on Pattern Analysis and
Machine Intelligence, vol. 12, 1990, pp. 629-639.
[19]
L. Alvarez, L. Baumela, P. M´arquez-Neila, and P. Henr´ıquez, “A Real
Time Morphological Snakes Algorithm,” Image Processing On Line,
2012.
[20]
L. Alvarez, L. Baumela, P. Henr´ıquez, and P. M´arquez-Neila, “Morpho-
logical snakes,” Proc. CVPR, 2010, pp. 2197-2202.
71
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-310-0
INFOCOMP 2013 : The Third International Conference on Advanced Communications and Computation

