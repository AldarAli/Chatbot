Modeling the Evolution of Terrestrial and Water-rich Planets and Moons
Lena Noack, Attilio Rivoldini, Tim Van Hoolst
Department of Reference Systems and Planetology
Royal Observatory of Belgium (ROB)
Brussels, Belgium
Email: lena.noack@oma.be, attilio.rivoldini@oma.be, tim.vanhoolst@oma.be
Abstract—We completed the numerical code CHIC (short for
Coupling Habitability, Interior, and Crust) for thermo-chemical
simulations of the evolution of both terrestrial and water-rich
planets and moons. The study focusses on the numerical aspects
of the code implementations and their validation. The thermal
evolution of the mantle is calculated either by solving the energy
conservation equation supplemented by boundary-layer theory
(1D parameterized thermal evolution model) or by solving the
energy, mass, and momentum conservation equations (2D/3D con-
vective thermal evolution). For the latter setting, the equations can
be solved in both incompressible and compressible formulations
and can include chemical buoyancy effects for an inhomogeneous
mantle by applying a particles-in-cell method. The code provides
a user updatable library of thermodynamic properties of core,
mantle and water/ice materials derived from the associated
equations of state. CHIC has been benchmarked with different
convection codes, and has been compared to published interior-
structure models and 1D parameterized models. CHIC is an
advanced simulation code that can be applied to a diverse range
of geodynamic problems and questions.
Keywords–ﬂuid dynamics; convection; numerical modeling; ther-
mal evolution; planetology.
I.
INTRODUCTION
To understand geophysical processes in a planet like Earth
including convection, surface processes as plate tectonics or
volcanism, and the evolution of mantle and atmosphere, nu-
merical models are essential tools [1] and have been applied in
the past decades to investigate various planets and moons. Nu-
merical simulations are especially needed for the investigation
of feedback cycles between the interior and the surface, as, for
example, the CO2-cycle (where subduction of carbonates helps
to regulate surface temperatures over geophysical timescales),
the subduction cycle (delivering volatiles to the mantle and
releasing volatiles by volcanic outgassing), the evolution of
continents (stabilizing plate tectonics) and the possible main-
tenance of a magnetic ﬁeld by strong cooling of the core. These
processes are likely important for the habitability of Earth, i.e.,
for the ability to host life, and may also play an important role
for other planets [2], [3].
Different numerical models have been applied to study the
evolution of terrestrial planets or moons in the literature,
either focussing on the mantle convection pattern in 2D or
3D geometries, or investigating the general thermal evolution
with 1D parameterized models.
In this study, we couple both methods in one simulation code
CHIC together with a library of thermodynamic properties
that can be applied to self-consistently determine the interior
structure of a planet and its later evolution depending on key
factors as, for example, the planet mass, composition, and
initial temperature proﬁle.
The paper is organized as follows: Section II gives an
overview of the state of the art and the progress in numerical
modelling via the CHIC code. In Section III, we describe the
different modules of CHIC, followed by the validation of the
correctness of the models in Section IV. Finally, in Section V,
we summarize the possibilities of a coupled 1D - 2D/3D code
and the planned future work.
II.
STATE OF THE ART
Several 2D and 3D convection codes have been developed
over the past decades to investigate Earth-like planets. They
typically concentrate solely on either the thermal evolution
or do steady-state snapshots of the mantle and crust. Some
models include the simpliﬁed evolution of the core [4] or of
the atmosphere [5], [6] as boundary conditions to the mantle
convection simulation. In such a convection model, lateral
variations in the mantle can be investigated, including mantle
plumes, local melt regions, and plate motions.
On the other hand, a 1D model assumes a laterally averaged
proﬁle for temperature and material properties. As a result,
simulations of, for example, the volcanic history of a terrestrial
planet may differ between 1D and 2D/3D models.
1D thermal evolution models also have several advantages
over 2D/3D convection models. Parameterization models [7]
are applicable over a large parameter space (applicable also
at high convection velocities, where convection models suffer
from numerical problems), and include the simulation of both
liquid and solid materials. Especially, strongly convecting
systems (e.g., liquid core or ocean) can be simulated, which
is generally infeasible for planetary convection codes, as
they will either produce numerical instabilities or require an
unacceptably large amount of computational power. 1D models
are very fast compared to convection models. Depending on
the speciﬁc application, a 1D thermal evolution model runs in
the order of seconds or minutes, whereas 2D/3D models (that
typically need a high resolution to avoid numerical errors) may
run for days or weeks.
To understand different geophysical processes and feedback
cycles on Earth-like or water-rich planets, a coupled model
66
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 1. Possible conﬁgurations that are investigated with CHIC: a) mantle with variable CMB temperature, b) mantle with core evolution and inner core
freezing, c) mantle and core with an atmosphere, d) mantle and core with a deep ocean on top (we neglect here a possible atmosphere).
is needed that can combine 1D parameterized models (for
example for the treatment of the water-layer or the core) with
2D mantle convection models.
We therefore developed a new code CHIC at the Royal
Observatory of Belgium, that combines different numerical
models in one toolbox. The code is written in Fortran, which
allows for fast simulations (either running on one processor or
in parallel) on standard high-performance clusters.
The CHIC code is able to treat both 1D parameterized
models (using the thermal boundary layer theory to determine
the temperature evolution in a terrestrial planet [7], [8] or
ocean planet [9]) and 2D/3D models to investigate the detailed
convection pattern in a silicate mantle or ice layer over time.
In our implementation, the planets are assumed to consist of
several different spherical layers (shells). The lowermost shell
represents the core and is overlain by a silicate shell (mantle
and crust) and a potential water-ice layer. The uppermost shell
represents the planets atmosphere. All shells are thermally
coupled, i.e., the heat ﬂux and temperature are continuous
at each interface between the different layers. The surface
temperature is allowed to vary with time depending on the
greenhouse gases in the atmosphere, or is taken constant if
changes in the atmosphere are neglected.
CHIC allows the user to apply different 1D or 2D/3D
modules as needed: for the core, either only changes in the
core-mantle boundary (CMB) temperature are investigated, or
a 1D parameterized model of the iron core including inner
core freezing is applied (Figures 1(a) and 1(b)); the thermal
state of the mantle and high-pressure ice layers are investigated
either via a convection model or a 1D parameterized model; the
atmosphere and a potential water ocean (Figures 1(c) and 1(d))
are investigated with a 1D module, whereas ice layers could be
investigated also with the 2D/3D convection module. CHIC is
therefore a powerful tool for the investigation of the evolution
of terrestrial or ocean planets - from interior to atmosphere -
and their possible habitability.
III.
MODELS
CHIC uses various modules for modelling different shells
of a terrestrial or ocean planet. The basic modules provided
by CHIC are listed below. The density of the material and
other physical properties are determined as described in Sec-
tion III-A, and can be applied to both 1D and 2D/3D modules.
The input ﬁle used for the simulations is similar for all
modules, which simpliﬁes comparison of the 1D model with
the 2D mantle model.
A. Interior structure model and material properties
Within CHIC, simple interior structure models can be gener-
ated to assess the radius of a terrestrial planet for given mass,
composition, and temperature proﬁle. Those models assume a
spherical planet that is differentiated into an iron core, a silicate
shell, and an optional ocean layer. For the silicate mantle we
assume an Mg-end member olivine system. We neglect high
pressure olivine polymorphs but allow for the disassociation
of olivine to perovskite and Mg-wstite and the occurrence
of post-perovskite at high pressure and temperature. Material
properties (density ϱ, thermal expansion coefﬁcient α and heat
capacity cp) are computed from equations of state for variable
pressure and temperature [10], [11].
The gravitational acceleration g(r) as a function of radius
r is determined from the Poisson equation, it depends on the
gravity value at the surface of the planet,
dg/dr = 4πGϱ − 2g/r
(1)
where G is the gravitational constant.
The pressure as a function of depth is calculated by assum-
ing hydrostatic equilibrium and depends on the atmospheric
pressure at the surface:
dp/dr = −gϱ
(2)
The mass m(r) is
dm/dr = 4ϖr2ϱ
(3)
B. Core evolution model
The 1D core evolution module determines the variation of
upper core temperature with time via the energy conservation
equation
ρccp,cVcεcdTc/dt = −qcAc
(4)
67
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

where the index c denotes core values, Vc is the core volume
and Ac the core surface area, εc is a constant relating the
average core temperature to the CMB temperature, t is the
time and qc is the heat ﬂux from the core into the mantle
(deﬁned via the heat ﬂux that the mantle can take up, e.g.,
[8]),
qc = −kmdT/dr|r=Rc
(5)
where km is the mantle thermal conductivity. We neglect
radioactive heat sources in the core, as well as tidal heating
effects. If the freezing of an inner core is considered, additional
terms for latent heat and gravitational energy release have
to be added in Eq. (4) [12]. For 2D/3D convection models,
temperature is calculated at pre-deﬁned grid points, and the
average temperature gradient at the CMB is calculated over the
two bottom shells of the mantle grid; in the 1D parameterized
model, the heat ﬂux is computed from the boundary-layer
theory.
For the thermal evolution, either a pure iron core or an iron-
rich core containing lighter elements like sulfur is considered.
In the latter case, core freezing can be modelled if the core
temperature falls below the melting temperature. This model,
however, only works if the freezing of the core starts at the
core center (leading to a solid inner core as on Earth). This
may not be the case for Mercury or Ganymede, where iron
may solidify in the upper part of the core and sink down as
(so-called) iron snow.
We only model planets without the iron snow regime and
adopt the model of [4], which determines latent heat released
by iron solidiﬁcation and gravitational energy produced by
differentiation of the core into an inner and outer core. Both
mechanisms have an inﬂuence on the thermal evolution of the
mantle. For super-Earths (i.e., planets up to 10 Earth masses),
we neglect lighter elements in the core, as material properties
for those are only known for a limited pressure range.
C. Mantle: 1D parameterized model
The 1D module assesses the thermal evolution of the mantle
based on [7], [8], [9]. We refer to these references for full
details. The model determines the evolution of the upper
mantle temperature Tm over time by considering that the loss
of energy due to mantle cooling and heat ﬂux out of the mantle
is balanced by the heat ﬂux from the core into the mantle and
the radioactive heat production in the mantle (we neglect heat
produced by tidal friction):
ϱmcp,mVlεmdTm/dt = −qlAl + qcAc + QmVl
(6)
The index m denotes mantle values. Vl is the volume of the
mantle from core to the base of the lithosphere, and Al is
the area at the boundary between mantle and lithosphere. The
constant εm relates the average mantle temperature with Tm.
The mantle temperature decreases due to heat ﬂux out of the
mantle into the lithosphere ql, increases due to inﬂowing heat
ﬂux from the core qc and increases with heat released by
radioactive heat sources Qm.
CHIC also allows to model possible melting events and crust
formation over time. This leads to additional terms in (6). For
details on the crustal evolution, as well as the deﬁnition of the
thermal boundary layers and calculation of the temperature in
the lithosphere, we refer to [8]. Note that the 1D parameterized
model only considers the evolution of the temperature over
time, and assumes effective convection. To understand the
convection mechanism and its strength depending on mantle
parameters and planet size (possibly triggering plate tectonics
at the surface), a more sophisticated 2D/3D convection model
is needed.
D. Mantle: 2D / 3D convection model
The CHIC code uses a ﬁnite volume (FV) ﬁeld approach
to solve the conservation equations of mass, momentum and
energy. A ﬁnite grid is placed in the mantle, with shells from
the CMB to the planet surface, and a predeﬁned number of
grid points per shell. We then deﬁne Voronoi cell volumes
around each grid point and solve the system of equations on
each cell volume considering the ﬂux in and out of the cell and
the energy production in the cell. We employ a staggered grid,
see Figure 2, where the scalar values like temperature (T) and
pressure (p) are deﬁned at the cell center (i,k), whereas the
lateral and radial velocities u, w are deﬁned at the cell faces.
The viscosity η is calculated at the cell centers (CV) and is
interpolated at the cell nodes (N) and cell faces (A,B,C in x-,y-
and z-direction) with a geometric averaging scheme.
The grid is either deﬁned in Cartesian coordinates in a
2D or 3D box or in polar coordinates for a 2D cylindrical
sphere (a cut through the planet at the equator representing
the temperature proﬁle of a cylinder with the 2D plane as a
basis) or a 2D spherical annulus (an equatorial cut or polar
section that approximates the temperature proﬁle of a sphere
in 3D, [13]), see Figure 3. For the 2D models with spherical
or cylindrical geometry, it is often useful to employ a regional
sector of the 2D spherical model (as shown in Figure 6). In
addition to the grid, randomly distributed particles (also called
tracers) are used to transport local information as for example
density variations or water content, see Section III-D3.
In CHIC, the thermal (or thermochemical, see Section
III-D3) evolution can be modelled either for an incompress-
ible medium with the Boussinesq approximation (BA) or the
Extended-Boussinesq approximation (EBA), or for a com-
pressible medium with the (truncated) anelastic liquid approx-
imation (TALA/ALA).
1) (Extended) Boussinesq approximation:
We solve the
equation system for an incompressible medium either with the
Boussinesq approximation (BA), which neglects the inﬂuence
of compressibility on the mantle, or we apply the Extended-
Boussinesq approximation (EBA), which yields an adiabatic
temperature increase with depth depending on the dissipation
number Di = αgD/Cp, where D is the mantle thickness (see
[7] for details on the model). For a dissipation number Di of
zero, the formulation reduces to the Boussinesq approximation
(BA). We therefore concentrate on the EBA model below.
68
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 2. The staggered grid enforces different local solver meshes for the
energy, mass and momentum conservation equations. The center of each
local mesh is highlighted with a red box.
Figure 3. Geometries implemented in CHIC. Top: 2D Cartesian box and 3D
Cartesian box. Bottom: 2D cylinder and 2D spherical annulus.
In the EBA approximation, the non-dimensional conser-
vation equations of energy, mass and momentum can be
expressed as (e.g., [14]):
∂T
∂t + ⃗v · ∇T + Di(T + T0)⃗vr = ∇2T + Di
RaΦ + H
(7)
∇ · ⃗v = 0
(8)
−∇p + ∇ · σ = RaTer
(9)
σ = η

∇⃗v + ∇⃗vT
(10)
Here, T is temperature, T0 surface temperature, t time, and
Di the dissipation number. The convective pressure is denoted
by p; ⃗v is the velocity and ⃗vr the radial velocity, whereas er
is the radial unit vector. H is the heat source (e.g., radioactive
heat source). σ the convective stress tensor, η is the viscosity,
and T indicates a transposed matrix. The Rayleigh number Ra
is a measure for the convective vigour
Ra = ρgαD3∆T
κηref
(11)
where ∆T is the mantle temperature contrast, κ = k/(ρCp) the
thermal diffusivity and ηref a reference viscosity deﬁned at a
reference temperature, pressure and stress (for non-Newtonian
viscosity), see Section III-D5. Φ is the viscous dissipation [7],
[13], [14]
Φ = 1
2σ : ˙ε = η ˙ε : ˙ε
(12)
with strain rate tensor ˙ε = ∂vi/∂xj.
Equations (7)-(9) are written in a non-dimensional form
[15]. The non-dimensionalization is obtained by dividing the
dimensional value of each variable by a reference value as
given in [15]. The quantities given in Section IV are also non-
dimensional values.
69
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

2) Anelastic liquid approximation: While the (Extended)
Boussinesq approximation models a constant density in the
mantle, in reality the density increases with depth due to
pressure-induced compression. In Mars’ and Mercury’s mantle
the compressiblity effect is small and is typically neglected.
For Earth-size and larger planets the density increases sig-
niﬁcantly within the mantle and is typically addressed in
mantle convection codes via the (truncated) anelastic liquid
approximation (short TALA or ALA), see [7] and [14].
Reference proﬁles are employed for the pressure, density
and temperature (¯p, ¯ρ, ¯T), as well as lateral variation ﬁelds
due to convection (p′, ρ′, T ′):
T
=
¯T + T ′
p
=
¯p + p′
ρ
=
¯ρ + ρ′
In addition, we apply reference proﬁles for the gravitational
acceleration, thermal expansion coefﬁcient, heat capacity at
constant volume or pressure, bulk modulus and Gr¨uneisen
parameter (¯g,¯α, ¯
Cv, ¯
Cp, ¯
KT ,¯γ).
The conservation equations of mass and momentum for the
ALA formulation are solved together in a coupled system and
read in non-dimensional quantities [7]
∇ · (¯ρ⃗v) = 0
(13)
−∇p′ + ∇ · σ + Di ¯ρ¯gp′Cp
¯γ ¯
KT Cv
⃗er = Ra¯ρ¯g¯α(T − ¯T)⃗er
(14)
σ = η

∇⃗v + ∇⃗vT − 2
3∇ · ⃗vI

(15)
I is the identity tensor. Cp and Cv are the speciﬁc heat
at constant pressure and volume, KT is the isothermal bulk
modulus.
In the truncated anelastic liquid approximation (TALA), the
third term in equation (14) is neglected
−∇p′ + ∇ · σ = Ra¯ρ¯g¯α(T − ¯T)⃗er
(16)
The TALA formulation is a simpliﬁed compressible formu-
lation that is favoured by several codes to avoid numerical
problems due to the additional ALA term (third term in Eq.
(14)). Furthermore, this term is often neglected as it requires
knowledge of several material properties (as Gruneisen param-
eter or isothermal bulk modulus) depending on pressure, which
requires the usage of an equation of state.
The energy conservation equation for the composite temper-
ature ﬁeld (T = ¯T + T ′) can be expressed as
¯ρ ¯
Cp
∂T
∂t + ⃗v · ∇T

=
∇ ·

of the strain-rate, whereas dislocation creep does not depend
on the grain size. In CHIC, the user can choose between a
dislocation viscosity, a diffusion viscosity and a mix of both
formulations. The smaller viscosity is the dominant viscosity
for material motion.
The general equation used in CHIC for the viscosity follows
an Arrhenius law [19], [20]
η = A ˙ε
1−n
n
II
d
p
n C
−r
n
OH exp
E + pV
nRT

(21)
A is a material-dependent constant, n is the stress exponent,
d is the grain size, COH is the concentration of water (for dry
materials r=0), r is the water exponent, E the activation energy
and V the activation volume. p is the pressure and R the gas
constant. Note that the pressure p is the hydrostatic pressure
and not the convective pressure as in (9). The parameters for
both diffusion and dislocation creep are taken from [19], [20]
for both wet and dry materials. The concentration of water
COH is traced via particles and does not only inﬂuence the
viscosity, but also the local melt temperature, which is smaller
in the presence of water than for dry materials [21].
Even though the Arrhenius viscosity (21) is preferentially
used for simulations of terrestrial planets, for benchmarks and
basic convection simulations typically an approximated vis-
cosity is used, the so-called Frank-Kamenetskii approximation
(FKA), given by
η = A exp (−θT T + θpz)
(22)
Here, θT and θp are either the logarithm of a pre-deﬁned
viscosity contrast with respect to temperature or pressure,
respectively, or they are derived from the parameters in (21)
[22]. z is the non-dimensional depth (0 at the surface and 1
at the CMB). Note that for the application to plate tectonics
simulations, the FKA (22) may not be suitable as shown in
[22] and the Arrhenius viscosity (21) should be applied.
E. OpenMP and MPI parallelisation
The Pardiso solver [18], that can be used to solve the
linear equations for the mass-momentum and energy equa-
tions (see Section III-D4), can employ an automatic OpenMP
parallelization. In addition, we implemented an MPI domain
decomposition for the mesh. The domain is separated into
several subdomains, on which the conservation equations of
mass, momentum and energy are solved individually. However,
the solution on each subdomain depends on the neighbouring
domains. For this reason, additional boundary cells (ghost
cells) are added at the boundary between subdomains, which
contain the corresponding values (for example, temperature or
velocity) from the neighbour domain and serve as boundary
cells for their respective MPI domain. After the equation
system is solved, ghost cells are updated with the new values
from their neighbour domain and the conservation equations
are re-solved. This iteration continues until convergence occurs
for the root-mean-square velocity.
Figure 4 shows the domain decomposition for four CPUs
using either non-periodic or periodic boundary conditions
Figure 4. Schematic mesh decomposition for a 2D Cartesian box using four
CPUs. Additional cells at the domain boundaries are highlighted in the
respective domain color. The upper plot uses a free-slip, reﬂective side
boundary condition, the lower plot applies a periodic boundary condition.
at the left and right side of the box. The bottom and top
boundaries are free-slip boundaries (the temperature values
are either pre-set boundary values or evolve over time at the
1D model interface for core or ocean/atmosphere). Grey stars
denote boundary cells, boxes with coloured boundaries are
ghost cells, and black dots denote the cells, for which the
mass, momentum and energy equations are solved.
The MPI speed-up factor and simulation times are plotted
in Fig. 5 for different grid sizes (shells) and amounts of CPU
for a 2D Cartesian box and aspect ratio 1 (i.e., same number
of grid points in lateral directions as number of shells) for
the ﬁrst 10 time steps, where the simulation parameters are
taken from the ﬁrst benchmark case in Blankenbach et al. [23].
Here, the Pardiso solver is applied (see Section III-D4). The
high-performance SGI cluster, on which the simulations were
executed, contains nodes with 24 CPU cores and two Xeon
E5-2680V3 processors per node.
The speed-up factor is based on simulations with two CPUs
instead of one. The update of the ghost cells (boxes with
coloured boundary in Fig. 4) demands at least two iterations
to solve the coupled mass-momentum equation system. When
using only one CPU, no update of ghost cells and thus
no additional iteration is needed. The parallel version can
therefore never show a perfect speed-up behaviour when using
one CPU as reference. The effect of parallelization on the
simulation time can also be observed in the right plot in Fig.
5.
For small grid sizes with 20, 40 or 80 shells, the speed-up
71
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 5. Left: scaling factor for MPI parallelization using different grid sizes (20sh stands for 20x20 grid points plus boundary cells) based on a reference
time obtained for 2CPUs. Right: simulation time in seconds for different amounts of CPU for the same simulations.
factor decreases to non-optimal behaviour (i.e., curve drops
below the black dotted line) when using more than 2, 4 and
8 CPUs, respectively. For larger grids the simulations show
an optimal speed-up behaviour up to approximately 24 CPUs,
which is the number of CPUs per node on the used HPC
architecture. The simulation time is still steadily reduced with
increasing number of CPUs.
When employing a larger 2D grid size with doubled resolu-
tion, the number of grid points is four times larger. The right
plot in Fig. 5 shows that the simulation time also increases by
a factor ∼4 for doubled resolution.
IV.
CODE VALIDATION RESULTS
In this section, we present several benchmark tests that have
been applied to validate the code.
A. Incompressible model
To validate our 2D Cartesian box implementation of the ther-
mal convection simulation in the incompressible approxima-
tion we compare it to the standard benchmark by Blankenbach
[23]. The benchmark assumes either isoviscous convection or
temperature- and pressure-dependent viscosity in the Boussi-
nesq approximation. A free-slip boundary condition is applied
to the walls of the box. The non-dimensional temperature at
the surface of the box is set to 0 and at the bottom to 1. The
simulations are run until steady-state is reached (i.e., variations
of the non-dimensional temperature drop below a tolerance
value of 10−10).
In Table I, we compare our results (for a ﬁxed resolution
of 80(200)x80 cells for aspect ratio 1 or 2.5) to the published
TABLE I. BENCHMARK COMPARISON OF CHIC (CH) TO [23] (BL).
RMS velocity
Max temperature
Nusselt number
CH
BL
CH
BL
CH
BL
1a
42.92
42.74-42.87
0.425
0.421-0.427
4.920
4.864-4.896
1b
194.3
192.4-198.0
0.432
0.415-0.437
10.60
10.42-10.69
1c
835.1
823.7-842.5
0.440
0.431-0.446
21.81
21.08-22.07
2a
496.6
458.3-503.3
0.725
0.716-0.741
10.43
10.04-10.07
2b
183.1
166.7-193.1
0.390
0.385-0.403
7.271
6.806-7.409
Case 1: isoviscous material, ℓ=1, a) Ra=1e4, b) Ra=1e5, c) Ra=1e6.
Case 2: FKA (11), a) Rasurf=1e4, θT =ln(1000), θp=0, ℓ=1,
b) Rasurf=1e4, θT =ln(16384), θp=ln(64), ℓ=2.5.
results. Note that in [23] different resolutions have been used,
therefore we give the min and max values for resolutions of
at least 33x33 cells. Here, we provide only the three most
important quantities: the root-mean-square (RMS) velocity, the
maximum of the upper mantle temperature proﬁle at the middle
of the box (0.5ℓ, where ℓ is the length divided by height,
i.e., the aspect ratio) and the surface Nusselt number, which
is a measure of the ratio of convective to conductive heat
transport at the surface of the box. For more information on
the benchmark setup we refer the reader to [23]. CHIC yields
results that are in good agreement with all cases published in
[23], see Table I. They are either within the range of published
results or differ by less than 4 %.
A comparison between different geometries (Cartesian box
in two or three dimensions, 2D cylindrical shell and 3D
sphere) for the Boussinesq approximation has been published
by Noack and Tosi [24] using the convection code GAIA [25].
To verify our implementation of the different geometries, we
compare the CHIC code to the published results with respect
to RMS velocity, average mantle temperature and surface
Nusselt number. For the 2D box, we apply a resolution of
72
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

TABLE II. BENCHMARK COMPARISON OF CHIC (CH) TO [24] (NT)
Case
RMS velocity
Average temperature
Surface Nusselt number
CH
NT
CH
NT
CH
NT
2D box, ℓ=1, RBC a
54.59
53.81
0.689
0.6872
1.987
1.956
2D box, ℓ=2, RBC a
54.59
53.79
0.689
0.6871
1.987
1.956
2D box, ℓ=1, PBC b
55.61
54.62
0.7016
0.6993
2.047
2.014
3D box, ℓ=1, RBC
61.91
57.21
0.7092
0.6927
2.259
2.363
2D full cylinder c
35.93
35.25
0.5734
0.5711
1.444
1.439
2D half cylinder
35.30
34.84
0.574
0.5725
1.439
1.440
2D quarter cylinder
35.31
34.87
0.574
0.5725
1.439
1.440
2D cylinder, CV d
17.39
17.11
0.4394
0.4377
0.993
0.995
2D cylinder, CR e
14.62
14.51
0.4046
0.4039
0.909
0.914
3D sphere / 2D spherical annulus f
15.5
16.19
0.3635
0.3374
0.796
0.744
We apply a surface Rayleigh number of Ra=10 and a FKA (22) viscosity contrast of 1e5.
a RBC stands for reﬂective boundary condition at the side wall with free-slip boundary.
b PBC stands for periodic boundary conditions.
c The sphere uses a radius ratio of 2, i.e., the core radius is half the planet radius.
d CV means corr. volume: ratio of core area divided by mantle volume is as in 3D.
e CR means corr. radius: ratio of core area divided by surface area is as in 3D.
f We use a 2D spherical annulus for CHIC with 4 initial plumes; a 3D sphere was used for GAIA.
80(160 for ℓ=2)x80 cells, for the 3D box 40x40x40 cells and
for the 2D shells we use 80 shells in radial direction with
754, 377, 189, 440, 419 and 754 points per shell for the six
considered cylindrical/spherical cases. Note that we compare
the 2D spherical annulus of CHIC to the case of 3D sphere of
GAIA.
The results obtained with CHIC are in good agreement with
those obtained with GAIA, with deviations below 2 % apart
from the 3D box (7.6 % deviation for the velocity) and the
spherical annulus (7.2 % deviation for the temperature), where
we compare to the 3D sphere in [24], see Table II. The plots
in Figure 6 show the steady-state for all cases.
Figure 6. Convection patterns obtained with CHIC for different available
geometries. See text and Table II for more details.
We do a further validation of our 2D spherical annulus
implementation for isoviscous material by comparing it to
the results in [13] for bottom-heated (i.e., constant bottom
temperature) and internally heated convection (i.e., zero heat
ﬂux at bottom and internal heat sources), see Figure 7.
The non-dimensional radius of the core is 1.2222 and the
planet radius is 2.2222. We use a resolution of 32 shells
with 256 points on each shell. The CHIC results are in good
agreement with the published results. The differences are less
than 5 %, see Table III.
The largest deviations appear for time-dependent simula-
tions (indicated by ∼). For these cases averaged values depend
Figure 7. Temperature ﬁelds obtained for the isoviscous spherical annulus
models from [13].
TABLE III. BENCHMARK COMPARISON OF CHIC (CH) TO [13] (HT)
Ra
Average RMS velocity
Nusselt number
CH
HT
CH
HT
1e4
38.22
37.7
4.13
4.18
1e5
157.2
∼160
7.06
∼7.39
1e6
∼622
∼640
∼14.1
∼14.4
Ra/H
Average RMS velocity
Average mantle temperature
1e4 / 3.4
24.3
23.5
0.3
0.308
1e5 / 6.6
∼76.6
∼78.5
∼0.36
∼0.349
1e6 / 14
∼252.4
∼265
∼0.35
∼0.35
Isoviscous material, case 1: bottom-heated convection,
case 2: internally-heated convection.
on the size of the averaging time domain (in this study an
interval of up to ∼0.2 diffusion times is applied). For this
reason, typically only steady-state simulations are used in
community benchmarks. Recently, an increasing attention has
been drawn to benchmarks for time-dependent simulations, for
example for plastic deformation and episodic overturn [26].
73
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

B. 2D compressible model
The 2D compressible implementations TALA and ALA
(see Section III-D1) are compared to a benchmark published
by King et al. [14]. The benchmark includes compressible
simulations in a 2D Cartesian box using different dissipation
numbers and Rayleigh numbers. For the comparison we apply
a resolution of 80x80 cells and a dissipation number of Di = 1.
No viscosity variation is considered. The Rayleigh number is
varied between 104 and the maximal value that still leads to a
steady-state solution.
TABLE IV. BENCHMARK COMPARISON OF CHIC (CH) TO [14] (KI)
RMS velocity
Average temperature
Nusselt number
CH
KI
CH
KI
CH
KI
EBA, Ra=1e4
24.2
23.9-24.2
0.47
0.47-0.47
2.19
2.15-2.19
EBA, Ra=2e4
39.4
39.1-39.5
0.47
0.47-0.47
2.65
2.60-2.65
EBA, Ra=5e4
71.5
70.8-71.7
0.47
0.47-0.47
3.36
3.30-3.36
EBA, Ra=1e5
107.9
107.1-108.2
0.48
0.48-0.48
3.95
3.89-3.97
EBA, Ra=2e5
146.7
147.0-148.0
0.49
0.49-0.49
4.42
4.40-4.44
TALA, Ra=1e4
26.0
26.0-26.1
0.51
0.51-0.51
2.56
2.51-2.57
TALA, Ra=2e4
40.2
40.2-40.5
0.51
0.51-0.52
3.01
2.96-3.02
TALA, Ra=5e4
66.9
66.8-68.7
0.52
0.52-0.52
3.63
3.61-3.64
TALA, Ra=1e5
84.6
84.9-91.1
0.53
0.52-0.53
3.91
3.89-3.98
ALA, Ra=1e4
24.3
24.7-25.0
0.51
0.51-0.51
2.42
2.44-2.47
ALA, Ra=2e4
37.9
38.5-39.0
0.52
0.52-0.52
2.86
2.88-2.92
ALA, Ra=5e4
64.1
64.9-65.9
0.52
0.52-0.52
3.50
3.51-3.55
ALA, Ra=1e5
84.0
84.6-85.6
0.53
0.53-0.53
3.86
3.86-3.88
We validate the accuracy of the simulations by comparing
the RMS velocity, the average mantle temperature and the
Nusselt number in Table IV to the value range listed in [14].
CHIC compares well with the published results with deviations
below two percent. Note that these small deviations appear
only for some of the TALA and ALA cases, where less codes
contributed to the original study, leading to a narrower value
range in [14].
C. Chemical buoyancy
Density variations in the mantle occur due to temperature
inﬂuences (the thermal buoyancy term in the momentum equa-
tion), chemical inﬂuences (inhomogeneous mantle due to crust
subduction, local melt depletion, etc.), and compressibility
effects. CHIC traces chemical density variations either via
particles or with a ﬁeld approach, see Section III-D3.
We compare our implementation of the chemical advection
(i.e., buoyancy forces driven by chemical density variations)
to the benchmark by van Keken et al. [27]. Three cases
for chemical advection have been investigated in the study
modelling a light layer at the bottom of a Cartesian box below
a dense layer. In addition, a viscosity contrast between the two
layers of 1 (case a), 10 (b) and 100 (c) is applied. The density
ﬁeld of all three cases is shown in Fig. 8 at a non-dimensional
time of 500. For the simulations we use a spatial resolution
of 200x200 grid points and 50 tracer per cell for the particle
approach and a Lewis number of 1010 for the ﬁeld approach.
The benchmark study [27] calculates the following control
parameters: the growth rate of the interface at the beginning of
the simulation, the maximal rms velocity and the time when the
Figure 8. Chemical convection initiated by the chemical buoyancy of light
material (black) below a layer of dense material (red) from benchmark [27]
at non-dimensional time 500 for the particle approach (top) and the ﬁeld
approach (bottom).
maximal value is reached. The growth rate is calculated from
the initial rms velocity increase via the following formula (we
use t=100):
Γ = ln (vrms(t)/vrms(0)) /∆t
(23)
Table V lists the growth rate, maximal rms velocity and time
for both the particle (P) and the ﬁeld (F) approach for the
three cases. Our results reproduce the benchmark case almost
exactly.
TABLE V. BENCHMARK COMPARISON OF CHIC (CH) TO [27] (VK)
Growth rate Γ
Max RMS velocity
Time (Max RMS v.)
CH
VK
CH
VK
CH
VK
a
0.0117 (P)
0.011-
0.00303 (P)
0.00289-
213.3 (P)
206.4-
0.0115 (F)
0.0125
0.00308 (F)
0.0031
208.3 (F)
215.7
b
0.0472 (P)
0.0392-
0.00944 (P)
0.00908-
72.7 (P)
71.9-
0.0429 (F)
0.0482
0.00917 (F)
0.00959
72.6 (F)
77.1
c
0.1058 (P)
0.096-
0.01457 (P)
0.01385-
50.2 (P)
48.8-
0.099 (F)
0.1052
0.01371 (F)
0.01506
49.4 (F)
51.3
D. 1D parameterized model
To our knowledge, unlike for the mantle convection calcula-
tion, benchmark results for the 1D parameterized model have
not been published. Therefore, we have validated our code by
reproducing results of [8]. The results are very similar [28], but
differ in detail because not all parameters used in the studies
are known. The module has been integrated into the CHIC
code and has been extended to include a regolith layer and
compared to [29], yielding again comparable results.
We do a further validation of our 1D parameterized thermal
evolution implementation by comparing it to a 2D convection
calculation in a spherical annulus. The simulations are done
for a Mars-like planet. We assume a Newtonian viscosity law
and apply the Boussinesq approximation. The initial mantle
temperature is 2000 K and the CMB temperature is 2300
74
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 9. Upper temperature, CMB temperature and lid thickness for a thermal evolution of Mars applying either the 2D spherical annulus (black curve) or the
1D parameterized model (red).
K, the surface temperature is set to 220 K. Heat sources are
homogeneously distributed in the mantle and are taken Earth-
like [7]. For the 2D model, we use a quarter sphere with a
radial resolution of 80 shells.
In the convection model, we deﬁne the lid over the depth
where the conductive heat transport is more efﬁcient than the
convective heat transport. The lid thickness is then ﬁtted by a
third-order polynomial since the lid is strongly time-dependent
and oscillations occur. The lid thickness is in the beginning
larger than that of the 1D model (where we plot the total
conductive layer thickness including both the lid and the upper
thermal boundary layer), but shows a similar increase with time
after 2 Gyr (see Figure 9). The different lid thicknesses at the
beginning of the evolution can be explained by a delayed on-set
of convection in the 2D model, which also leads to a slightly
weaker mantle cooling at the beginning and hence a shift in
the upper mantle temperature compared to the 1D model, see
see Figure 9.
Our results show that the 1D parameterized model leads to
a thermal evolution comparable to the results obtained with
convection models.
V.
CONCLUSION
We developed a new, advanced numerical code that couples
different models that are needed for the investigation of
habitability-relevant processes and feedback mechanisms for
Earth-like or water-rich planets or moons. The code can be
used with 1D and 2D/3D geometries for the silicate mantle
or ice shells. The thermal state of the core, the ocean and
atmosphere layer are simulated with a parameterized approach.
We have extended our earlier study [1] by a compressible
formulation, which is especially of interest for planets of
Earth size or larger. Chemical convection has been included
to investigate buoyancy effects from density variations due
to for example partial melting or subducted crust. Particles
have been implemented to transport local information like the
water content through the mantle. Both OpenMP and MPI
parallelisation are available to allow the usage of CHIC on
standard high-performance clusters.
We have validated our implementations for the parame-
terized model and 2D/3D convection model by comparing
CHIC to published results and by running a set of standard
benchmarks. For all benchmarks, CHIC is in good agreement
with literature values.
The code can be applied to investigate the possible habitabil-
ity of terrestrial or water-rich planets [9] and moons, including
the simulation of feedbacks between the interior and surface
for stagnant-lid and plate tectonics planets.
ACKNOWLEDGMENT
L. Noack has been funded by the Interuniversity Attraction
Poles Programme initiated by the Belgian Science Policy
Ofﬁce through the Planet Topers alliance. A. Rivoldini was
supported by the PRODEX program managed by the European
Space Agency in collaboration with the Belgian Federal Sci-
ence Policy Ofﬁce. This work results within the collaboration
of the COST Action TD 1308. We thank Clemens Heistracher,
Nastasia Zimov, Franc¸ois Labb´e, and Thomas Boiveau for their
contributions to the project.
REFERENCES
[1]
L. Noack, A. Rivoldini, and T. Van Hoolst, “CHIC - Coupling Habit-
ability, Interior and Crust,” INFOCOMP 2015, Brussels, Belgium, vol.
ISBN: 978-1-61208-416-9, 2015, pp. 84–90.
[2]
P. van Thienen et al., “Water, life, and planetary geodynamical
evolution,” Space Sci. Rev., vol. 129, 2007, pp. 167–203, doi:
10.1007/s11214-007-9149-7.
[3]
L. Noack and D. Breuer, “Interior and surface dynamics of terrestrial
bodies and their implications for the habitability,” in Habitability on
other planets and satellites: The quest for extraterrestrial life, J.-P.
de Vera and F. Seckbach, Eds. Springer, Dordrecht, 2013, pp. 203–233,
doi: 10.1007/978-94-007-6546-7 12.
75
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

[4]
G. Schubert, M. N. Ross, D. J. Stevenson, and T. Spohn, “Mercurys
thermal history and the generation of its magnetic ﬁeld,” Mercury, 1998,
pp. 429–460, iSBN 9780816510856.
[5]
L. Noack, D. Breuer, and T. Spohn, “Coupling the atmosphere with
interior dynamics: Implications for the resurfacing of venus,” Icarus,
vol. 217, 2012, pp. 484–498, doi:10.1016/j.icarus.2011.08.026.
[6]
C. Gillmann and P. Tackley, “Atmosphere/mantle coupling and feed-
backs on venus,” J. Geophys. Res. Plan., vol. 119, 2014, pp. 1189–1217,
doi:10.1002/2013JE004505.
[7]
G. Schubert, D. L. Turcotte, and P. Olson, Mantle convection in the
Earth and planets. Cambridge University Press, Cambridge, UK, 2001,
doi:10.1017/CBO9780511612879.
[8]
A. Morschhauser, M. Grott, and D. Breuer, “Crustal recycling, mantle
dehydration, and the thermal evolution of Mars,” Icarus, vol. 212, no. 2,
2011, pp. 541–558, doi:10.1016/j.icarus.2010.12.028.
[9]
L.
Noack
et
al.,
“Water-rich
planets:
how
habitable
is
a
water
layer
deeper
than
on
Earth?”
Icarus,
in
press,
doi:10.1016/j.icarus.2016.05.009.
[10]
L. Stixrude and C. Lithgow-Bertelloni, “Thermodynamics of mantle
minerals–i. physical properties,” Geophys. J. Int., vol. 162, no. 2, 2005,
pp. 610–632, doi:10.1111/j.1365-246X.2005.02642.x.
[11]
J. Bouchet, S. Mazevet, G. Morard, F. Guyot, and R. Musella, “Ab
initio equation of state of iron up to 1500 GPa,” Physical Review B,
vol. 87, no. 094102, 2013, pp. 1–8, doi:10.1103/PhysRevB.87.094102.
[12]
D. J. Stevenson, T. Spohn, and G. Schubert, “Magnetism and thermal
evolution of the terrestrial planets,” Icarus, vol. 54, 1983, pp. 466–489,
doi:10.1016/0019-1035(83)90241-5.
[13]
J. W. Hernlund and P. J. Tackley, “Modeling mantle convection in the
spherical annulus,” Physics of the Earth and Planetary Interiors, vol.
171, no. 1, 2008, pp. 48–54, doi:10.1016/j.pepi.2008.07.037.
[14]
S. D. King et al., “A community benchmark for 2-d cartesian compress-
ible convection in the earth’s mantle,” Geophys. J. Int., vol. 180, no. 1,
2010, pp. 73–87, doi:10.1111/j.1365-246X.2009.04413.x.
[15]
U. R. Christensen, “Convection with pressure- and temperature-
dependent non-newtonian rheology,” Geophys. J. R. astr. Soc., vol. 77,
1984, pp. 343–384, doi:10.1111/j.1365-246X.1984.tb01939.x.
[16]
S. Zhong, D. A. Yuen, and L. N. Moresi, “Numerical methods in
mantle convection,” Treatise on Geophysics, vol. 7, 2007, pp. 227–252,
doi:10.1016/B978-044452748-6.00118-8.
[17]
S. V. Patanker, “A calculation procedure for two-dimensional el-
liptic situations,” Numerical Heat Transfer V, 1981, pp. 409–425,
doi:10.1080/01495728108961801.
[18]
O. Schenk and K. G¨artner, “On fast factorization pivoting methods for
symmetric indeﬁnite systems,” Elec. Trans. Numer. Anal., vol. 23, 2006,
pp. 158–179, iSSN 1068-9613.
[19]
S. Karato and P. Wu, “Rheology of the upper mantle: A synthesis,” Sci-
ence, vol. 260, 1993, pp. 771–778, doi:10.1126/science.260.5109.771.
[20]
G. Hirth and D. Kohlstedt, “Rheology of the upper mantle and the
mantle wedge: A view from the experimentalists,” Inside the subduction
Factory, 2003, pp. 83–105, doi:10.1029/138GM06.
[21]
R. Katz, M. Spiegelman, and C. Langmuir, “A new parameterization of
hydrous mantle melting,” Geochem. Geophys. Geosyst., vol. 4, no. 9 -
1073, 2003, pp. 1–19, doi:10.1029/2002GC000433.
[22]
L. Noack and D. Breuer, “First- and second-order Frank-Kamenetskii
approximation
applied
to
temperature-,
pressure-
and
stress-
dependent rheology,” Geophys. J. Int., vol. 195, 2013, pp. 27–46,
doi:10.1093/gji/ggt248.
[23]
B. Blankenbach et al., “A benchmark comparison for mantle convection
codes,” Geophys. J. Int., vol. 98, 1989, pp. 23–38, doi:10.1111/j.1365-
246X.1989.tb05511.x.
[24]
L. Noack and N. Tosi, “High-performance modelling in geodynamics,”
in Integrated Information and Computing Systems for Natural, Spatial,
and Social Sciences, C.-P. R¨uckemann, Ed.
IGI Global, 2013, pp.
324–352, doi:10.4018/978-1-4666-2190-9.ch016.
[25]
C. H¨uttig and K. Stemmer, “Finite volume discretization for dynamic
viscosities on voronoi grids,” Physics of the Earth and Planetary
Interiors, vol. 171, 2008, pp. 137–146, doi:10.1016/j.pepi.2008.07.007.
[26]
N. Tosi et al., “A community benchmark for viscoplastic thermal
convection in a 2-d square box,” Geochem. Geophys. Geosyst., vol. 16,
2015, pp. 2175–2196, doi:10.1002/2015GC005807.
[27]
P. E. van Keken et al., “A comparison of methods for the modeling of
thermochemical convection,” J. Geophys. Res.: Solid Earth, vol. 102,
no. B10, 1997, pp. 22 477–22 495, doi:10.1029/97JB01353.
[28]
T. Boiveau, “Convection mantellique dans les plantes telluriques,”
Rapport de stage, unpublished.
[29]
N. Tosi, M. Grott, A.-C. Plesa, and D. Breuer, “Thermochemical
evolution of mercurys interior,” J. Geophys. Res. Plan., vol. 118, 2013,
pp. 1–14, doi:10.1002/jgre.20168.
76
International Journal on Advances in Systems and Measurements, vol 9 no 1 & 2, year 2016, http://www.iariajournals.org/systems_and_measurements/
2016, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

