Analysis of the Least-Squares Adaptive Algorithms in Interference Cancellation 
Configuration 
 
Silviu Ciochină, Constantin Paleologu, and Andrei Alexandru Enescu 
Department of Telecommunications 
University Politehnica of Bucharest 
1-3 Iuliu Maniu Blvd., Bucharest, Romania 
{silviu, pale, aenescu}@comm.pub.ro 
 
 
Abstract— An analysis of the interference cancellation 
configuration working based on the least-squares (LS) 
adaptive algorithms is presented in this paper. The existence of 
a “residual leakage” phenomenon of the useful signal, to the 
output of the adaptive filter, through the error signal is 
demonstrated. As a consequence, the useful signal can be 
attenuated, up to complete cancellation. This process is 
important for low values of the weighting parameter λ and is 
practically absent for λ close to unit. The simulations 
performed in an echo cancellation configuration support the 
theoretical findings. 
Keywords-adaptive filters, least-squares (LS) algorithms, 
interference cancellation, echo cancellation 
I. 
 INTRODUCTION 
A lot of applications in the telecommunications field 
require cancelling an unknown interference that corrupts a 
useful signal. Such a problem can be solved using an 
adaptive filter working in an interference cancellation 
configuration. The goal of this system is to produce an 
estimate of the interference that will be subtracted from the 
received signal [1], [2]. One of the most common 
applications of this configuration type is echo cancellation 
[3], [4]. In this case, the principle is to synthesize a replica 
of the echo and to subtract it from the returned signal. 
Besides convergence rate, an important aspect of an 
echo canceller is its performance during “double-talk” (i.e., 
near-end speech) [3], [4]. In the case of the normalized 
least-mean-square (NLMS) algorithm [1], the presence of 
near-end signal considerably disturbs the adaptive process. 
To eliminate the divergence of echo cancellers the standard 
procedure is to inhibit the weight updating during the 
double-talk. The presence of double-talk is detected by a 
double-talk detector (DTD). The DTD acts with a delay 
since it requires a number of samples to detect the double-
talk presence. However, this very small delay can be enough 
to generate a considerable perturbation of the echo estimate. 
Therefore, it will be desirable to implement fast 
converging and double-talk robust adaptive algorithms [5] 
in 
future 
echo 
cancellers. 
Based 
on 
convergence 
performance alone, a least-squares (LS) algorithm [1] is 
clearly the algorithm of choice. 
 
u(n) 
 
 
 
 
Adaptive 
filter 
 
 
ˆ
( )
( )
y n
= v n
 
 
−
 
 
+ 
ˆ
( )
( )
e n
= x n
x(n)+v(n) 
 
 
Figure 1.  Interference cancellation configuration. 
In this paper we will prove the existence of an 
interesting phenomenon that appears when an LS adaptive 
algorithm 
is 
used 
in 
an 
interference 
cancellation 
configuration. The phenomenon consists of a “residual 
leakage” of the useful signal, through the error signal into 
the output of the adaptive filter, even if it is uncorrelated 
with the input signal of the adaptive filter. The process 
depends on the algorithm weighting parameter λ. As a 
consequence, not only the perturbation (i.e., the echo), but 
also the useful signal can be severely attenuated, up to 
complete cancellation. Controlling this phenomenon in case 
of an echo canceller could solve the “double-talk” problem 
without any DTD system. 
The paper is organized as follows. In Section II we 
briefly review the adaptive interference cancellation 
configuration, working in ideal conditions. In Section III, the 
real behavior of the configuration is considered, working 
based on an LS algorithm. Replacing the statistical averages 
by temporal estimators proves to lead to the “residual 
leakage” phenomenon, in the case of the low memory 
algorithms (i.e., using small λ). Simulations performed in the 
context of echo cancellation are presented in Section IV. 
Finally, Section V concludes this work. 
II. 
IDEAL BEHAVIOR OF THE ADAPTIVE INTERFERENCE 
CANCELLATION CONFIGURATION  
In the case of the interference cancellation applications 
(Fig. 1), an adaptive filter is used to cancel an unknown 
interference, v(n), that corrupts a useful signal, x(n). 
 
36
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

 
 
 
 
 
 
 
 
 
 
Figure 2.  Echo cancellation configuration. 
This scheme needs two inputs. A so-called primary signal 
consists of the corrupted signal, x(n) + v(n), and plays the 
role of the “desired signal” in the adaptive configuration. The 
second one, u(n), is correlated with the perturbation v(n) and 
uncorrelated with x(n). It is applied to the input of the 
adaptive filter. In addition, x(n) and v(n) are mutually 
uncorrelated. The output of the adaptive filter y(n) is 
expected to be an estimate of v(n) and, consequently, the 
error signal e(n) should be an estimate of x(n). 
A specific application of this configuration is echo 
cancellation [3], [4]. In this case (Fig. 2), v(n) is the echo 
generated by a system characterized by the impulse 
response 
 
 
,                            (1) 
0
1
1
[
,
,
,
]H
N
h h
h −
h =
…
 
where the superscript H denotes Hermitian transposition 
(transposition and complex conjugation) and W is an 
adaptive filter, having the coefficients 
 
 
.                          (2) 
0
1
1
[
,
,
,
]H
N
w
w
w −
w =
…
 
The sequence 
 is the far-end signal and x(n) is the 
near-end. We suppose that 
(n)
u
( )
x n  and 
 are uncorrelated, 
i.e., 
( )
u n
 
 
,
,                    (3) 
{
}
E
( )
(
)
0
u n x
n
k
∗
−
=
∀ k
∈ Ζ
 
where E is the expectation operator and superscript * 
denotes the complex conjugation. 
Defining the vector: 
 
 
,              (4) 
( )
[ ( ), (
1),
, (
1)]T
n
u n u n
u n
N
=
−
−
+
u
…
 
where superscript T denotes the transposition operation, we 
have: 
 
 
,                                  (5) 
( )
H ( )
v n
n
= h u
and 
 
.                          (6) 
( )
( )
( )
( )
e n
v n
y n
x n
=
−
+
 
In case of the Wiener filter the optimal coefficients are given 
by normal equation [1]: 
u(n) 
 
 
Rwopt =
p ,                                     (7) 
W 
H 
with 
 
{
}
( )
H ( )
E
n
n
R =
u
u
                              (8) 
y(n) 
+ v(n) 
− 
and 
x(n)
 
{
}
( ) *
( )
E
n d
n
p =
u
.                               (9) 
+ 
+ d(n) 
e(n) 
 
Taking into account the relations (3) and (6) we obtain: 
 
 
{
}
(
)
{
}
{
}
{
}
{
}
{
}
*
*
*
*
*
*
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
H
E
n d
n
E
n
x
n
v
n
E
n x
n
E
n v
n
E
n v
n
E
n
n
=
=
+
=
+
=
=
=
=
p
u
u
u
u
u
u
u
h
=
Rh
h
      (10) 
 
so that, according to (7) and (10), the value of optimal 
coefficients results as 
 
 
.                                    (11) 
opt =
w
 
In this case, 
   
,  (12) 
( )
( )
( )
( )
( )
( )
H
H
opt
y n
n
n
v n
e n
x n
=
=
=
⇒
=
w
u
h
u
 
so that the separation of signals x(n) and v(n) is correctly 
performed. 
III. 
THE RESIDUAL LEAKAGE PHENOMENON 
Let us consider the real case of the classical recursive 
least-squares (RLS) adaptive algorithm [1]. In this situation, 
the statistical expectation is replaced by a weighted sum as 
follows: 
 
 
{ }
{ }
1
n
n i
i
E
λ −
=
• → ∑
• ,                           (13) 
 
where  λ  is the exponential weighting factor (also known as 
the “forgetting factor”) of the RLS algorithm. Consequently, 
the normal equation from (7) becomes 
 
1
1
1
1
( )
( )
( )(
( )
( ))
( )
( )
( )
( ).
n
n
n i
H
n i
opt
i
i
n
n
n i
n i
i
i
i
i
i v i
x i
i v i
i x i
λ
λ
λ
λ
−
−
∗
∗
=
=
−
∗
−
∗
=
=
=
+
=
=
+
∑
∑
∑
∑
u
u
w
u
u
u
(14) 
For values of the exponential weighting factor λ very 
close to unit and for a value of n high enough we may write 
37
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

{
}
1
1
1
1
lim 1
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
(15)
n
n i
n
i
n
n
n
n i
H
n i
n i
H
opt
i
i
i
opt
i x
i
E
n x
n
n
i
i
i v
i
i
i h
λ
λ
λ
λ
−
∗
∗
→∞
=
−
−
∗
−
=
=
=
≅
=
⇒
≅
=
⇒
≅
∑
∑
∑
∑
u
u
0
u
u
w
u
u
u
w
h
λ −
0
N
<
 
 
 
 
so that e(n) = x(n) like in the ideal case. 
 
On the other hand, for a value of the exponential 
weighting factor small enough, so that 
 for 
, 
we may use the following approximation: 
1
λk

0
k
n
>
 
 
.                   (16) 
{ }
{ }
0
1
1
n
n
n i
n i
i
i n n
λ −
=
= −
+
• ≅
•
∑
∑
 
According to the orthogonally principle, the normal equation 
becomes 
 
 
.                       (17) 
0
*
1
( )
( )
n
n i
i n n
i e i
λ −
= −
+
=
∑
u
 
This is a homogeneous set of N equations with 
 unknown 
parameters, e(i). If n
 then the set of equations has the 
unique solution 
0
n
0
 
 
                 (18) 
0
( )
0
for
1,
,
e i
i
n
n
n
=
=
−
+ …
 
leading to 
 
 
.                 (19) 
( )
( ) ( )
( )
( )
H
y n
n
n
x n
v n
=
=
+
w
u
 
Consequently, there is a “residual leakage” of x(n), through 
the error signal into the output of the adaptive filter. In this 
situation the useful signal, x(n) is suppressed together with the 
perturbation v(n). A small value of λ or a high value of N 
intensifies this phenomenon. 
Concluding, in the real case of any LS adaptive 
algorithm used in an interference cancellation configuration 
two effects appear: 
- 
w differs from h in a certain extent and this may be 
viewed as a divergence of the algorithm; 
- 
y(n)
 will contain a component proportional to 
x(n)
, 
that will be subtracted from the total received signal; 
this phenomenon is in fact a leakage of the 
x(n)
 in 
y(n)
, through the error signal e(n); the result consists 
of an unwanted attenuation of the desired signal. 
If we consider an echo cancellation application where the 
echo path is significantly long, leading to a high value for the 
length of the adaptive filter, we have to use a value of λ very 
close to unit in order to reduce unwanted attenuation of the 
near-end signal. 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 3.  The filter length is N = 32 and different values of λ are used. 
However, the requirements of an echo canceller are both 
rapid convergence and a low computational cost. Thus, a 
highly desirable algorithm is a “low cost” LS algorithm (in 
terms of the computational complexity), i.e., the fast LS 
algorithms [1]. 
λ = 
 0.99999 
 
 
 
 
 
 
λ = 0.99 
 
 
 
 
 
 
λ = 0.9 
e(n) 
y(n) – v(n) 
samples 
samples 
IV. 
SIMULATION RESULTS 
For the first set of simulations we analyze a simple 
interference 
cancellation 
application. 
Using 
the 
configuration from Fig. 2 we choose u(n) uniformly 
distributed in [–1;1] and x(n) as a low frequency sine wave 
(
0
0.01
ω
π
=
). The adaptive filter has N coefficients. In the 
first experiment we fixed 
N = 32
 and we take different 
values for the exponential weighting factor λ (Fig. 3). 
e adaptive filter has N coefficients. In the 
first experiment we fixed 
N = 32
 and we take different 
values for the exponential weighting factor λ (Fig. 3). 
In a second case we used a fixed weighting factor λ = 
0.99 and different values for the length of the adaptive filter 
N (Fig. 4). In order to outline the “residual leakage” 
phenomenon we plot the signals e(n) (the recovered sine 
wave) and the difference 
 [the component from 
x(n) leaked into the output of the adaptive filter]. 
In a second case we used a fixed weighting factor λ = 
0.99 and different values for the length of the adaptive filter 
N (Fig. 4). In order to outline the “residual leakage” 
phenomenon we plot the signals e(n) (the recovered sine 
wave) and the difference 
 [the component from 
x(n) leaked into the output of the adaptive filter]. 
( )
( )
y n
v n
−
We can notice that similar effects appear when the value 
of the exponential weighting factor λ decreases or the length 
of the adaptive filter N increases. The desired signal x(n) 
leaks into the output of the adaptive filter, leading to an 
unwanted attenuation of the recovered signal e(n). 
We can notice that similar effects appear when the value 
of the exponential weighting factor λ decreases or the length 
of the adaptive filter N increases. The desired signal x(n) 
leaks into the output of the adaptive filter, leading to an 
unwanted attenuation of the recovered signal e(n). 
In order to observe the phenomenon in the spectral 
domain we repeat the previous experiments using a higher 
frequency sine wave (
In order to observe the phenomenon in the spectral 
domain we repeat the previous experiments using a higher 
frequency sine wave (
0
0.5
( )
( )
y n
v n
−
0
0.5
ω
π
=
) as desired signal. The 
corresponding spectral results are given in Fig. 5 and Fig. 6. 
The conclusions are practically the same. The recovered sine 
wave is strongly attenuated when the value of λ decreases. A 
similar effect appears when the length of the adaptive filter N 
increases. 
In order to approach the context of echo cancellation, a 
second set of simulations was performed using speech 
sequences for both u(n) and x(n) signals. 
 
38
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 4.  The exponential weighting factor is λ = 0.99 and different 
values of N are used. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 5.  Power spectra [dB]; the filter length is N = 32 and different 
values of λ are used. 
Moreover, the H filter is a particular echo path according 
with ITU-T G.168 Recommendation for digital echo 
cancellers [6]. It is convenient to subtract out the direct 
near-end component from the error signal e(n) [7]. The 
residual error r(n) = e(n) – x(n) cumulates the undesired 
attenuation of the near-end signal x(n) and the imperfect 
rejection of the echo path response v(n). In a real application 
such a subtraction can never be done because the signal x(n) 
is not available. 
In the first experiment we choose a value of the 
exponential weighting factor very close to unit (λ = 0.99999) 
and a 32 msec. echo path (corresponding to N = 256). One 
can see that the near-end signal x(n) is recovered in e(n) with 
slight distortions (Fig. 7). Next, in order to point out the 
leakage process, we decrease the value of λ (Fig. 8). Because 
of the lower value of λ  the “residual leakage” phenomenon 
is significant. The adaptive filter rejects not only the far-end 
signal but also the near-end signal. The transmitted signal 
remains in the absence of the far-end signal (where there is 
no input signal for the adaptive filter). 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
e(n) 
y(n) – v(n) 
N = 16 
 
 
 
 
 
 
 
 
N = 64 
 
 
 
 
 
 
 
N = 256 
samples 
samples 
PSD{e(n)} 
PSD{y(n) – v(n)} 
Normalized frequency 
Normalized frequency 
 
N = 16 
 
 
 
 
 
 
 
N = 64 
 
 
 
 
 
 
 
 
N = 256 
Figure 6.  Power spectra [dB]; the exponential weighting factor is λ = 0.99 
and different values of N are used. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
PSD{e(n)} 
PSD{y(n) – v(n)} 
λ = 
 0.99999 
 
 
 
 
 
λ = 0.99 
 
 
 
 
 
 
 
λ = 0.9 
Normalized frequency 
Normalized frequency 
u(n) 
 
 
 
x(n) 
 
 
 
e(n) 
 
 
 
r(n) 
 
Time [seconds] 
Figure 7.  Double-talk situation.  The exponential weighting factor is λ = 
0.99999 and the filter length is N = 256. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
u(n) 
 
 
 
 
x(n) 
 
 
 
 
e(n) 
 
 
 
 
r(n) 
 
Time [seconds] 
Figure 8.  Double-talk situation.  The exponential weighting factor is λ = 
0.99 and the filter length is N = 256. 
39
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

V. 
CONCLUSIONS 
ACKNOWLEDGMENT 
This work was supported by the UEFISCSU Romania 
under Grant PN-II-RU-TE no. 7 / 05.08.2010 and Grant PN-
II-RU-PD no. 39 / 12.08.2010. 
In this paper we have demonstrated the existence of a 
phenomenon that appears when a LS adaptive algorithm is 
used in an interference cancellation configuration. It 
consists of a “residual leakage” of the useful signal, through 
the error signal into the output of the adaptive filter that 
leads to an unwanted attenuation of the useful signal. This 
process strongly depends on the algorithm weighting 
parameter λ (it is important for low λ and is practically 
absent for 
λ ≅ 1
) and it is influenced by the length of the 
adaptive filter N (it is amplified by a high value of N). 
Both the theoretical and experimental developments lead 
to the conclusion that the “residual leakage” phenomenon 
can be avoided for a memory of the algorithm significantly 
higher than the adaptive filter length. 
Controlling this phenomenon in case of an echo canceller 
we can solve the “double-talk” problem without any DTD 
system. Taking into account that the length of an echo path is 
in general high enough, we have to use a value of λ very 
close to unit in order to reduce unwanted attenuation of the 
near-end signal. 
REFERENCES 
[1] 
S. Haykin, Adaptive Filter Theory, Fourth Edition, Prentice Hall 
International, Inc., Upper Saddle River, New Jersey, 2002. 
[2] 
J. Benesty and Y Huang, Eds., Adaptive Signal Processing–
Applications to Real-World Problems.   Berlin, Germany: Springer-
Verlag, 2003. 
[3] 
S. L. Gay and J. Benesty, Eds., Acoustic Signal Processing for 
Telecommunication.  Boston, MA: Kluwer Academic Publisher, 
2000. 
[4] 
J. Benesty, T. Gaensler, D. R. Morgan, M. M. Sondhi, and S. L. Gay, 
Advances in Network and Acoustic Echo Cancellation.  Berlin, 
Germany: Springer-Verlag, 2001. 
[5] 
T. Gänsler, St. L. Gay, M. M. Sondhi, J. Benesty, “Double-Talk 
Robust Fast Converging Algorithms for Network Echo Cancellation”, 
IEEE Trans. Speech and Audio Processing, vol. 8, no. 6, pp. 656-663, 
Nov. 2000. 
[6] 
Digital Network Echo Cancellers, ITU-T Rec. G.168, 2002. 
[7] 
D.L. Duttweiler, “Proportionate Normalized Least-Mean-Squares 
Adaptation in Echo Cancelers,” IEEE Trans. Speech and Audio 
Processing, vol. 8, no. 5, pp. 508-518, Sept. 2000. 
 
 
 
40
ICDT 2011 : The Sixth International Conference on Digital Telecommunications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-127-4

