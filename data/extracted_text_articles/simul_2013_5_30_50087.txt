Simulating Tree Plasticity with a Functional-Structural Plant Model: Being 
Realistic in Behavior 
Haoyu Wang2, Jing Hua1, Mengzhen Kang1, Xiujuan Wang1, Philippe de Reffye3, Baogang Hu2 
1 State Key Laboratory of Management and Control for Complex Systems, mengzhen.kang@ia.ac.cn 
2 National Laboratory for Pattern Recognition 
Institute of Automation, Chinese Academy of Sciences, Beijing, China 
3 CIRAD, UMR AMAP, Montpellier, France 
 
Abstract—Plant plasticity refers the ability of a plant to change 
its observable characteristics, in response to the environmental 
changes in its lifespan. We present a method of simulating 
structural plasticity in trees reacting to different light 
intensities, pruning policies, competition, and obstacles. The 
method is based on a functional-structural plant model (FSPM) 
that simulates two basic underlying processes of plants: 
development/organogenesis (the formation of plant structure) 
and growth (expansion of organs biomass production and 
partitioning). Bi-directional feedback is constructed between 
these two processes by linking both bud break and biomass 
partitioning with the internal source-sink ratio of biomass. A 
secondary mechanism controlling bud break is its local light 
intensity, by imposing a light distribution in tree canopy, the 
computational 
efficiency 
for 
which 
is 
assured 
by 
implementation on GPU. Based on these mechanisms, the 
virtual trees produce naturally less branches at lower light 
intensities. In reaction to pruning, the same tree give different 
shapes as pruning changes the source-sink balance and triggers 
new branches. Neighboring trees compete for light and lead to 
different crowns, and the same mechanism can be used to 
simulate trees grown near buildings. The results show that by 
constructing the dynamic model describing the underlying 
development and growth process of trees in cyberspace, the 
simulated trees can adapt to their virtual environment without 
need of modifying their geometrical traits. Such property is 
interesting for simulating landscape, education and interactive 
training. 
Keywords-Tree competition; Plasticity; GreenLab; Light 
environment;  Bud break; FSPM; Emergent property. 
I. 
 INTRODUCTION 
As plant is a ubiquitous component in nature, the realistic 
presentation of a plant in cyber-space is an ever-existing aim 
in computer science. Differing from other physical objects 
such as fluids, plant is a living organism that exhibits 
phenotypic plasticity, which is the ability of changing its 
phenotypes (observable characteristics) in response to 
changes in the environment [1]. Such a feature has brought 
tremendous challenges to plant modelers, especially for those 
who desire not just visually plausible virtual plants. 
Since 1970's, there has been endeavor toward generating 
virtual plants according to the underlying algorithms [2] [3] 
[4]. Combined with techniques of computer graphics, 
visually realistic 3D plants can be generated with reaction to 
environment or obstacle [5] [6]. However, the very important 
aspect of plant growth, biomass production and partitioning, 
is missing in such pure geometrical or structural plant 
models. This means, the size of each part of plants, such as 
stem diameter, leaf length, need to be set delicately in order 
to obtain proper ratio. The wish of having 'live' virtual plant 
has brought the concept of Functional-Structural Plant Model 
(FSPM) [7], which simulates two basic underlying processes 
of plants: development/organogenesis (the formation of plant 
structure) and growth (expansion of organs biomass 
production and partitioning). 
In this paper, we aim at simulating tree plasticity with a 
member of FSPM family, GreenLab. Bi-directional feedback 
is constructed between these two processes by linking both 
bud break and biomass partitioning with the internal source-
sink ratio of biomass. A secondary mechanism controlling 
bud break is its local light intensity, by imposing a light 
distribution in tree canopy. The computational efficiency of 
computing light inception is assured by implementation on 
GPU. We show in this paper that the virtual trees from this 
model can respond automatically to different environmental 
settings, including different light intensities, pruning policies 
and competition, without the need of manipulating 
geometrical parameters. 
The paper is organized as follows. Related biological 
concepts are presented in Section 2. Previous works linked to 
this paper are reviewed in Section 3. We present an overview 
of our algorithm and the related models in Section 4, while 
Section 5 presents several simulation results. Conclusion and 
discussion of the approach are given in the last section. 
II. 
RELATED BIOLOGICAL CONCEPTS 
There are two basic common processes in all plants: 
development 
and 
growth. 
Plant 
development, 
or 
organogenesis, deals with the creation of branches and plant 
organs (leaves, flowers, etc.), while growth refers to the 
complex process of biomass production by photosynthesis 
and biomass allocation among individual organs. One of the 
main hypothesis on biomass allocation is source-sink balance. 
For tree development, botanists classified 23 types of 
architectural models [8], according to the organization 
patterns of botanical units in trees. Each architectural model 
describes common features of many trees, e.g, the simplest 
structure is Corner model with a single stem structure. The 
formation of tree architectures is described as a dynamic 
process which is “the expression of equilibrium between 
endogenous growth processes and exogenous constraints 
exerted by the environment” [9]. In this paper, we present 
trees of Leeuwenberg model, Rauh model and Roux model. 
122
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-308-7
SIMUL 2013 : The Fifth International Conference on Advances in System Simulation

Leeuwenberg model consists of a sympodial succession of 
equivalent sympodial units. Pinus tree follows Rauh model 
with rhythmic growth, orthotropic axis with monopodial 
branching. Roux model are plants with vertical orthotropic 
trunks and plagiotropic branches that are always horizontal 
without righting at the end [9]. 
For biomass production, light interception can be 
computed as plant level or organ (leaf) level. Beer-Lambert 
Law assumes that light attenuates in a canopy as if it is a 
semi-transparent object [10]. It holds for closed tree stand, 
and the thickness of the canopy can be quantified by leaf 
area index (LAI, ratio of total leaf area to its projection 
ground area). With 3D description of tree structure, another 
approach is to apply photosynthesis model at leaf level, but it 
needs simulation of light distribution inside tree canopy. In 
this work, we test both kinds of photosynthetic models. 
For biomass partitioning inside a plant structure, the 
mechanism is less known than the overall biomass 
production [11]. Hypotheses on partitioning include 
functional equilibria [12], source-sink regulation [13] and 
allometric relationships [14]. A special feature differing trees 
from crops is their ring growths. One well-accepted theory is 
Pipe Model [15], indicating that the diameter at a certain 
position of a stem is proportional to the number of leaves 
above it. In this work, ring growth is based on pipe model, 
and organ size is the result of source-sink regulation. 
Mechanism on bud activity regulation is multiple: light, 
auxin, source-sink ratio of assimilates, etc. [16]. Buds are 
origin of branches, and their activities affect strongly the tree 
shape. They can stay dormant, die or give birth to branches. 
Buds are of different physiological ages, representing the 
vigor of branch that it can bear [9]. For example, in Gingko 
tree, some buds bear twigs, while others give birth to long 
branches. Axillary buds are generally physiologically older 
than their parent branches. Reiteration is an exception, 
referring to such a phenomenon that a branch inherits the 
same features of its mother branch [8][9]. This is often 
considered as 'self-similarity' property in trees and has led to 
application of fractal method in tree construction. Breakout 
of bud is highly dependent on plant age and environment. 
Bud behavior can explain many of tree plasticity in reacting 
to their environment, i.e., changes of size, amount, 
orientation or color to fit better during their life time. In this 
paper, we test two mechanisms controlling bud break: 
external light condition and internal source-sink regulation. 
III. 
RELATED WORK 
A. Simulation of Virtual Plants 
Generating 3D tree structures started not long after the 
birth of personal computers [3]. Recursive generative 
algorithms have been applied by viewing a tree as an 
explicitly-defined recursive structure [17]. Started by field 
investigation 
and 
mathematical 
modeling, 
AMAP 
methodology integrates knowledge like physiological age, 
architectural model and bud activities [4][18]. Botanical tree 
library has been set up for hundreds of trees. Although tree 
animation can be achieved by above methods, the size of 
compartments is directly defined by rules but not from 
photosynthesis and biomass partitioning. 
Another approach is to use images or point clouds to 
reconstruct the 3D-tree by registering their input images or 
using loosely arranged images [19]. To infer the hidden 
internal branches, iteration rules such as a particle flow 
system can be imposed to link the main stem with external 
twigs [20], which link the rule-based and data-based 
approach. Diameter of trees can be inferred from data but 
again there is no 'growth'. 
B. Simulating Environmental Effect 
Because of its importance, light is often taken as the 
principle environmental condition. Greene [21] simulated 
climbing plants on obstacles using voxel automata and light 
rays. Derived from a standard L-system, Měch et al. [22] 
developed open L-systems that have been used for 
simulating tree competition, based on communication 
between the plant and its environment. Soler et al. [23] 
simulated light environment in trees with an efficient method. 
Van Haevre [24] proposed a ray density estimation of the 
environmental 
illumination 
to 
guide 
phototropism 
morphology. In above works, light casts effects on branch 
removal or bending, but they have no contribution to 
photosynthetic production of plants, which plays a principle 
role in tree growth. 
C. Functional-Structural Plant Model (FSPM) 
LIGNUM [25] is a FSPM dedicated to trees and shrubs 
that couples L-systems for tree development with an eco-
physiological model. L-peach [26] is another FSPM for 
young peach trees, and it allows the simulation of pruning 
with empirical description on number of new shoots. 
AMAPHydro [27] is a branch of AMAP [4], which 
introduced a hydraulic model for computing biomass 
production. The computational efficiency of early FSPMs 
was low, and implementation was usually prone to bugs [7]. 
GreenLab [28] [29] inherited many concepts from both 
AMAPHydro and AMAPSim, but the computational 
efficiency was greatly improved by applying sub-structure 
method [30], so that it is affordable for complex trees.  It is 
one of few FSPMs that has been calibrated on both crops and 
trees, by fitting it to multiple biomass data, such as for pine 
trees [31] and beech trees [29]. 
D. Control on Bud Break 
According to different hypotheses on bud activity control, 
various methods have been proposed and tested. The first 
type is based on hormone regulation, which is interpreted as 
a signaling mechanism [22]. It is often implemented in pure 
developmental plant model. The second is based on source-
sink 
regulation, 
with 
source 
being 
provided 
by 
photosynthesis and sinks being the demand of organs for 
resources. By setting that the number of bud break is 
dependent on the dynamic source-sink ratio, rhythmic 
branching pattern could be generated [32]; Eschenbach [33] 
simulated tree structures with gradient according to 
environmental conditions. Such mechanism can be built only 
123
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-308-7
SIMUL 2013 : The Fifth International Conference on Advances in System Simulation

with functional-structural plant model as there is issue of 
biomass production (source) and allocation (sink). 
The third method is to link directly bud formation to its 
local light condition. In [34], it was linked to the far red 
spectrum while [35] supposed that bud fate is decided by 
light availability. In [22], the branch apices are associated 
with the radii of interest for collision detection, and a bud 
will stop growing when there is not enough space available. 
Such method is commonly used in simulating plant 
communities where plants compete for resources [35]. 
In this work, the bud break is controlled by two factors: 
local light condition and source-sink ratio. Therefore, light 
can affect bud fate both directly by deciding bud breakout, 
and indirectly by contributing to the overall source-sink ratio. 
E. Controlling Tree Form by Interaction 
A challenge of rule-based model is that one may lose the 
control over the final tree shape. A pure interactive example 
is Speedtree, but dynamic growth sequence of trees is not 
easy to construct. Chiba and Ohkawa [36] simulated 
interactive pruning of tree for designing Pensai trees. Pirk et 
al. [6] simulated the removal of branches when a tree meets 
an obstacle or other trees. In the context of tree pruning, 
intermediate storage of tree structure can be necessary, using 
format such as multi-scale tree graph [37]. 
 Although it will be nice to introduce procedural brush as 
in [5] and [38], we focus on the pruning exercise as done on 
real trees in final shape control. The tree shape is controlled 
by interactive pruning on trees, which will break the internal 
source-sink balance and stimulate the breakout of buds, 
including the dormant buds. 
IV. 
SYSTEM OVERVIEW 
As described by Měch and Prusinkiewicz [22], the 
interaction of a plant with the surrounding environment can 
be conceptualized as two concurrent processes that 
communicate with each other, forming a feedback loop of 
information flow. In our case, besides the external one, there 
is an internal information flow between plant structure and 
function; therefore, both light (that affects both the structure 
by controlling bud formation and function by photosynthetic 
production) and pruning (that affects the structure) have 
effect on the plant structure. External modification of 
environment will naturally trigger the response of plant. The 
double feedback loops are shown in Fig. 1. 
 
Figure 1.  External interaction between plant and environment and internal 
interaction between plant development and growth. 
V. 
A FUNCTIONAL-STRUCTURAL MODEL FOR TREES 
A. Development model 
The description of organogenesis in GreenLab is based 
on the definition of the potential bud production. A simple 
illustration can be seen in Fig. 2, where each circle presents a 
bud of a certain Physiological Age (PA) [9]. PA of the main 
stem (blue) is 1. Each rectangle represents a metamer, a 
minimal botanical unit that is composed by a node, an 
internode and its axillary leaves and fruits. Branching 
structure can be formed by the parallel bud development into 
growth units (from successive appearance of metamers). 
 
Figure 2.  Diagram of plant development model in GreenLab, a 
deterministic case. Each circle presents a bud. 
The parameters that describe the development are 
expressed as a matrix. For the branching structures of Fig. 2, 
the number of metamers in a growth unit and PA of the 
axillary buds are written as follows: 
0
2
1
0
1
1
0
0
2 ,
0
0
1
0
0
1
0
0
0
I
B
M
N






















       
 
       (1) 
where MI[1,2]=2 means that in a growth unit of PA 1, there 
are potentially two metamers that bear buds of PA 2. 
NB[1,2]=1 means for such a metamer, the amount of potential 
buds it carries is 1. Recall that PA of axillary buds is 
generally higher than its parent stem, except for the case of 
reiteration. The corresponding structure at iteration cycle 5 is 
shown in Fig. 3a. 
A main feature of the above model is that the botanical 
axis are organized using the concept of PA. Branches of the 
same PA share the same parametric settings for development, 
growth and geometry. Numeric values instead of rewriting 
rules are needed in designing the topological structure.  
B. Reiteration 
In this functional-structural plant model, reiteration is 
simulated by setting the PA of an axillary bud equal to the 
age of its mother axis.  An example in Fig. 3 illustrates this 
mechanism. Instead of bearing two buds of PA 2, the growth 
unit of PA 1 contains one metamer with a reiteration bud 
(MI[1,1]=1), one metamer with a axillary bud of PA 2 
(MI[1,2]=1), and one metamer with a bud of PA 3 
(MI[1,3]=1). All metamers carry at most one bud 
(NB[1,i]=1,1
3
i
  ). 
1
1
1
1
1
1
0
1
1 ,
0
1
1
0
0
1
0
0
0
I
B
M
N
   
 
       (2) 
124
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-308-7
SIMUL 2013 : The Fifth International Conference on Advances in System Simulation

 
(a) 
             (b)  
 
  (c) 
Figure 3.  Topological structures at cycle 5. (a) no reiteration, parameters 
in (1); (b),(c) reiteration of PA 1 and PA 2,  parameters in (2), maximal 
reiteration order being 1 (b) and 2 (c) respectively. 
A parameter called maximal reiteration order Rm limits 
the level of reiteration, which can be understood as the 
maximal branching order of reiteration. If there is no control, 
fractal structure will be born. Fig. 3 shows the resulting 
structure at cycle 5, with RM=1 (Fig.3b) and RM=2 (Fig.3c) 
for stem of PA 1 (blue) and PA 2 (green). No reiteration in 
PA 3 (red). 
C. Bud Break 
Bud control is based on two kinds of hypotheses: source-
sink balance [32] and light condition [35]. We keep the  light 
distribution model as optional in case that fast simulation is 
needed. The diagram on bud control can be seen in Fig. 4. 
To reach the above goal, when the local light condition 
allows, the number of axillary buds of PA q in a growth unit 
of PA p,  Np,q, is a function of simulated source-sink ratio; 
see (3). Q(n) is computed using plant or leaf level 
photosynthesis model; see (8) and (9). DV(n) is potential 
plant demand if all candidate buds break. αq is a coefficient 
indicating the dependency of the bud break on source-sink 
ratio. 
,
( )
min
,
,
,
( )
p q
q
I
B
V
Q n
N
M
p q
N
p q
D
n
      
       (3) 
 
Figure 4.  Approach of controlling bud break. Actual bud production is 
dependent on plant source-sink ratio. The bud production is possible when 
its local light intensity is above a threshold. 
D. Biomass Partitioning 
This model is based on the hypothesis of source-sink 
regulation. All produced assimilates are distributed among 
the growing organs according to their sink strengths. For 
trees, it is further hypothesized that the sink for ring growth 
DL(n) is dependent on source-sink ratio [29]; therefore, the 
thickening rate of stems is dependent on tree age and 
external conditions. The total demand of plant D(n) at cycle 
n is the sum of all sink strengths, see (4).  
( )
( )
p
O
O
L
O
p
D n
P
N
D
n   
 
       (4) 
where 
p
NO
 is the number of organ O at PA p, whose sink 
strength is PO. The parameters of sink strength can be 
estimated by inverse method from data [29] [31]. 
In order to decide the fate of bud, at each cycle, a virtual 
demand DV(n) is firstly computed by summing up all sink 
strength from potential buds. A sink strength of a bud is 
defined as the total sink strength of its potential organs. 
( )
( )
p
V
O
Bud
L
p
D
n
P
N
D
n  
 
 
       (5) 
The actual plant demand is computed when the bud 
behavior is fixed according to Q(n)/DV(n). The produced 
biomass is then shared for creation of new metamers and 
thickening of old stems. For the latter, distribution of 
biomass is in relation to the number of functioning leaves 
above each metamer [29]. 
E. Interactive Pruning 
At each cycle, through a GUI, users are allowed to select 
and remove some leaves, flowers or internodes interactively 
from the virtual plant. This information is fed back to the 
simulator before moving forward to next cycle (Fig.1). As 
there is underlying data structure indicating the topological 
link between all parts, if an internode is removed, all 
branches above it are removed. Updating of structure 
changes both source and potential sink, and consequently the 
source-sink ratio for next cycle. According to the mechanism 
of bud control, this can trigger different behaviors of buds. 
As bud extension takes several cycles to be visibly evident, 
the effect of pruning is not immediate.  
F. Light Interception 
In this work, the light intensity around a leaf plays double 
roles: determining the fate of adjacent bud and the total plant 
production. To simulate light environment, we emit light 
rays evenly from a sky hemisphere covering the plant canopy, 
as in [21]. Each sample ray collides, reflects and decays in 
the tree canopy. Photon map [39], which is originally used 
for rendering of a scene, records the information of collision 
between rays and objects. 
The light intensity around a leaf, denoted as EL, can be 
estimated from photons in its neighborhood. As in trees, 
leaves are generally densely distributed inside the canopy, 
more photons found in the neighborhood of a leaf means 
more light interception by surrounding leaves, and hence less 
intercepted light by the leaf. This is an inverse situation to 
the original photon mapping algorithm [39]. The absolute 
light intensity EB is computed as in (6): 
max
min
min
max
(1
) (
)
L
B
L
E
E
E
 
 
       (6) 
where 
max
EL
 is the maximal value of EL of all blades. τmax and 
τmin denote the maximal and minimal light intensity above 
canopy an inside canopy, respectively, both of which can be 
measurable by canopy analyzers. 
G. Photosynthesis Model 
This model concerns on the relationship between 
Photosynthetic Active Radiation (PAR) intercepted by leaves 
125
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-308-7
SIMUL 2013 : The Fifth International Conference on Advances in System Simulation

and biomass production. We test two kinds of photosynthesis 
models computed at leaf and plant level, with or without 
using geometrical information of tree.  
1) Leaf level: In this case, the photosynthesis model is 
applied at organ (leaf) level, according to light intensity 
computed for each leaf.  A generalized light-response curve 
is used to compute instantaneous assimilation rate of an 
individual leaf (I, μmol CO2 • m-2 • s-1, using a non-
rectangular hyperbola [42]: 
2
4
(I
R )
2
B
m
d
d
b
b
E
I
R  
 
       (7) 
where  b = αEBβ + Im + Rd. The physical meaning and 
empirical values of variables α, β, Im and Rd are from [40]. 
Total biomass production of the whole plant is summed 
from those of individual leaves, as in (8). 
( )
1
( )
( )s ( )
NB
n
L
t
i
i
i
Q
n
I n
n  
 
 
       (8) 
where γ is a conversion coefficient from assimilate to dry 
mass, δt  is the duration of a growth cycle (s), NB(n) denotes 
the total number of leaves in the plant. Ii(n) and si(n) are 
assimilation rate and the area of ith individual leaf, 
respectively, the latter being computed iteratively by the 
model. This metho has the advantage of taking into account 
the geometrical shape of trees and obstacles, but it is more 
time-consuming. 
2) Plant level: The plant-level photosynthesis model is 
based on Beer-Lambert law [10]. The thickness of the 
canopy is quantified by LAI, an important value in 
evaluating light interception. To estimate LAI for individual 
trees, in GreenLab, each tree has a characteristic projection 
area (SP), which can increase with plant age in the beginning 
and finally stabilize when the tree canopy closes, see (9). 
( )
( )
E(n)S (1
exp(
))
(0)
B
P
P
B
seed
S n
Q
n
k
S
Q
Q
 
 
       (9) 
where E(n) is a variable representing the plant local 
environment at growth cycle n; k is a light extinction 
coefficient to quantify attenuation process of light 
penetrating into the canopy; S(n) is the total green leaf 
surface area at growth cycle n; Qseed is the initial biomass. 
Under certain parameter values, the results from both 
methods (QL and QB) fit each other. This method has high 
computational efficiency as it is not dependent on tree 
geometrical structure. 
H. GPU+CPU implementation 
In case of implementing leaf-level photosynthesis model, 
there are two performance bottlenecks: ray tracing and light 
intensity estimation. In ray tracing, bounding volume 
hierarchies (BVH) and k-d tree are widely used to accelerate 
intersection computation, collision detection and k nearest 
neighbor search (KNN). In recent years, these algorithms are 
implemented successfully on GPU [41][42]. To improve 
system performance, this part is implemented on GPU. The 
GPU is Nvidia GeForce GTX560Ti with a 1023MB of 
dedicated memory. 
Simulation of tree development and growth, as well as 
the interactive pruning, are all implemented in QingYuan 
software programmed in C++. This kernel of model is still 
implemented in CPU. Rendering is made in Pov-Ray. All 
examples in this paper were generated on a desktop 
computer 
equipped 
with 
Intel(R) Core(TM)2 Quad 
CPU@2.66GHz with 8GB of memory. 
VI. 
RESULTS 
A. Tree structure dependent on source-sink ratio 
 
(a)  
 
(b) 
Figure 5.  Effect of α ((3)) on bud break. (a) less dependency on source-
sink ratio; (b) more dependency on source-sink ratio. 
As the visual output is based on a biophysical model, 
simply by playing on certain parameters, such as the α ((3)) 
that controls bud break, one can obtain trees of different 
complexities, as in Fig. 5. Fewer branches appear at lower α 
value, and the plant automatically becomes taller. This 
emergent result is in line with a common practise that people 
remove side shoots to obtain a tall trunk. This parameter can 
be used to obtain trees of different cultivars. Different colors 
in Fig. 5 represent different PAs. 
B. Simulating tree plasticity with different light intensities 
Using leaf photosynthesis model, tree plasticity under 
different light intensities above canopy are simulated (Fig. 6). 
Colors from red to green are used to visually distinguish light 
intensities inside canopy. Higher light intensity in the right 
gives positive feedback to bud break out and hence more 
dense crown, which is visually obvious in Fig. 6b. Notice 
that excessive light does not mean endlessly branching as 
this is controlled by potential buds defined in development 
model. Moreover, the photosynthetic response curve will 
saturate with the increase of light intensity. 
 
(a)   
                                (b) 
Figure 6.  Trees simulated with low (a) and high (b) light intensities. 
Colors represent relative light intensity inside canopy, with red and green 
for high and low light intensity respectively. 
126
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-308-7
SIMUL 2013 : The Fifth International Conference on Advances in System Simulation

C. Simulating tree response to pruning 
Realistic tree behavior in reaction to pruning is shown in 
Fig. 7. The age of displayed trees is 15 cycles, and they were 
pruned at cycle 9. From left to right, policy of pruning is no 
pruning, removal of terminal bud of main stem, removal of 
terminal buds of all stems, and cutting top of main stem, 
respectively. As less buds are presented after pruning, the 
sequence, more pruning leads to more branches near the 
bottom. Trees are taller or shorter, dependent on the time and 
position of pruning. There is no forced rule indicating 
number of new shoots after pruning. 
 
Figure 7.  Response of trees to  pruning. From left to right, policies of 
pruning are no pruning, removal of terminal bud of PA 1, removal of 
terminal buds of all branches, and cutting top of main stem, respectively. 
D. Simulating tree competition 
As 
plant-level 
photosynthesis 
model 
has 
high 
computational efficiency, we first test tree plasticity with the 
single control of bud break with source-sink regulation. 
From a predefined seed (a given set of source and sink 
parameters), the same tree exhibits plastic behaviors in 
response to different SP values as in (9); see Fig. 8. Higher 
density gives smaller, thinner and slightly shorter trees. 
 
Figure 8. Trees simulated under different population densities, from left to 
right: SP = 64 m2, SP = 16 m2, SP = 4 m2, SP = 1 m2. 
 
 
Figure 9. Trees of different crown size in response to their local area (SP). 
The trees with same color have the same SP value. 
This way, given the location of each individual tree in a 
stand, the local occupied area of each tree can be computed 
and this will automatically limit the size of tree crown from 
invading other trees. Fig. 9 shows a tree stand where 
individual trees are distributed randomly. Here no branch 
collision detection is applied.  
Without consideration of local light control on bud break, 
the simulated tree crown is isotropic. Taking into the 
secondary mechanism of bud control with light, we 
simulated two neighboring trees grown up in parallel (Fig. 
10).  The competition for light started at a certain age of 
plants. The asymmetrical tree shapes are caused by low light 
intensity at neighboring area where less buds break out. 
There are self-pruning in the trees in that old branches fall 
down automatically. 
E. Simulating tree response to obstacle 
 
Figure 11. Effect of pagoda on tree shape. 
With simulation of light distribution in canopy, we 
simulated a tree grown near a pagoda whose buds sense the 
local light level (Fig. 11). While the standard-alone tree (left) 
shows full canopy, the tree in the right loses part of branches. 
This is also visible for the same tree at younger stage 
(middle). 
Fig. 12 shows a nice example on how bud behavior is 
controlled jointly by light intensity and source-sink ratio. 
There is no more control on bud break when the tree grows 
over the roof, its crown recovered by reiteration structure 
(the top branches are the same). 
 
Figure 12. A tree grows over a roof, with fate of bud controlled by 
light intensity and source-sink ratio. 
F. Performance 
To evaluate the performance, we compare the time used 
for computing the tree using plant-level photosynthesis 
model, leaf-level photosynthesis model on CPU, and leaf-
level photosynthesis model on CPU + GPU (Table I). The 
other modules of biomass allocation and organogenesis 
remain the same. The computation time for light intensity at 
each cycle (light model) is very costly for CPU 
implementation, but the CPU + GPU method improved 
greatly the efficiency of light calculation, being more 
obvious for complex trees (177 times for age 25). Total 
simulation time for tree development and growth reduced 
greatly accordingly. The computational efficiency is much  
127
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-308-7
SIMUL 2013 : The Fifth International Conference on Advances in System Simulation

 
Figure 10. Response of trees to  pruning. From left to right, policies of pruning are no pruning, removal of terminal bud of PA 1, removal of terminal buds of 
all branches, and cutting top of main stem, respectively. 
higher when plant-level model is applied (<1s), independent 
on plant age or tree complexity. This means response to 
planting density or pruning of trees can be achieved in real-
time. 
TABLE I.  
PERFORMANCE  FOR COMPUTING TREES AT DIFFERENT 
AGES.  TIME FOR LIGHT INTENSITY AT EACH CYCLE (LIGHT MODEL) IS 
REDUCED BY CPU+GPU (C+G) IMPLEMENTATION.  
Tree age 
Organs 
Plant-level 
Organ-level 
Simulation 
Times (s) 
Simulation  
Times (s) 
Light Model (s) 
CPU 
C+G 
CPU 
C+G 
10 years 
3,860 
0.11 
31.08 
10.6 
8.42 
1.06 
20 years 
55,466 
0.28 
631.37 
32.3 
257.62 
2.52 
25 years 
547,832 
0.49 
4,181.00 
99.71 
931.74 
5.26 
VII. CONCLUSION 
We presented a dynamic biophysical tree model, 
GreenLab, which simulates tree structure and its plasticity in 
response to environment (obstacle, density, light) and 
management (pruning). The adaption of trees is automatic by 
deciding bud fates from internal and external conditions, 
without applying deformation or collision detection. The 
same tree (defined by a set of parameters) can display vastly 
different structures, because of the power of underlying 
mathematical model. Our method is affordable to create 
dynamic tree library for various circumstances. Depending 
on needs, different combinations of photosynthesis models 
and treatments can be chosen, with corresponding tree shape 
and cost. By using GPU programming, computational 
efficiency is high even when leaf-level light interception and 
photosynthesis model are conducted. 
A limit of our work is that to design a tree based on 
GreenLab, users should possess some knowledge of botany 
and eco-physiology. Once the parameters are given for a tree, 
user can modify environment and interact with the virtual 
tree, as if it were a living organism, without caring for the 
internal mechanism of tree growth. It is interesting for scene 
designer, since putting a virtual tree is similar to putting a 
seed, and then one can see the interaction and dynamic 
evolution of the trees. The potential of our work also lies in 
the possibility of simulating effects of other environmental 
conditions, such as temperature and CO2. Users can even 
have optimal solution of treatment if applying optimal 
control on the virtual plant. 
Our work is similar to some previous works as it also 
simulates the light environment and plant response. The 
major difference is that we simulate not only tree 
development, but also tree growth with an internal feedback 
mechanism between both processes. Light stimulates not 
only bud break but also photosynthetic production. 
Furthermore, we can simulate more complex botanical plant 
architecture and modify the meristem activities (depending 
of Q/D). Growth Units are very flexible, which makes the 
interaction between growth and environment very efficient 
and faithful. 
By means of these simulation methods and models, it 
could be easily used on education of botany, landscape 
design, games and so on. What a potential and more valuable 
aspect is the application on agroforestry. By combining light 
model and pruning management into one organic whole, we 
could evidently ameliorate light environment in canopy 
under different pruning strategy, which reduces pests and 
thus play a role in improving fruit quality. These virtual 
experiments provide quantitative standards for fruit 
cultivation and management. This is the future direction of 
our research. 
Based on current hypothesis chosen in the model, tree 
plasticity from the potential development pattern, regarding 
to bud breakout, organ sizes and final tree shape become 
emergent properties of the model. However, the model is still 
open to other mechanisms, such as hormone regulation by 
signal propagation. 
REFERENCES 
[1] 
T. D. Price, A. Qvarnström, and D. E. Irwin, “The role of phenotypic 
plasticity in driving genetic evolution,” Proceedings of the Royal 
Society of London. Series B: Biological Sciences, vol. 270, no. 1523, 
2003, pp. 1433–1440. 
[2] 
A. Lindenmayer, “Mathematical models for cellular interactions in 
development. part i and ii,” Journal  of Theoretical Biology, vol. 18, 
1968, pp. 280–99,300–15. 
[3] 
H. Honda, “Description of the form of trees by the parameters of the 
tree-like body: Effects of the branching angle and the branch length 
128
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-308-7
SIMUL 2013 : The Fifth International Conference on Advances in System Simulation

on the shape of the tree-like body,” Journal of Theoretical Biology, 
vol. 31, 1971, pp. 331–338. 
[4] 
P. de Reffye, C. Edelin, J. Francon, M. Jaeger, and C. Puech, “Plant 
models faithful to botanical structure and development,” Computer 
Graphics, vol. 22, no. 4, 1988, pp. 151–158. 
[5] 
W. Palubicki, K. Horel, S. Longay, A. Runions, B. Lane, R. Meˇch, 
and P. Prusinkiewicz, “Self-organizing tree models for image 
synthesis,” in ACM Transactions on Graphics (TOG), vol. 28, no. 3.    
ACM, 2009, p. 58. 
[6] 
S. Pirk, O. Stava, J. Kratt, M. Said, B. Neubert, R. Měch, B. Benes, 
and O. Deussen, “Plastic trees: interactive self-adapting botanical tree 
models,” ACM Transactions on Graphics (TOG), vol. 31, no. 4,2012, 
p. 50. 
[7] 
R. Sievänen, E. Nikinmaa, P. Nygren, H. Ozier-Lafontaine, J. 
Perttunen, and  H.  Hakulai, “Components of  functional-structural 
tree models,” Annals of Forest Science, vol. 57, 2000, pp. 399–412. 
[8] 
F Hallé, R. Oldeman, and P. B. Tomlinson, “Tropical trees and  
forests: an architectural analysis,”  New York: Springer-Verlag, 1978. 
[9] 
D. Barthélémy and Y. Caraglio, “Plant architecture: a dynamic, 
multilevel and comprehensive approach to plant form, structure and 
ontogeny,” Annals of Botany, vol. 99, no. 3, 2007, pp. 375–407.  
[10] M. Monsi and T. 
Saeki, “Uber den lichtfaktor in 
den 
pflanzengellschaften und seine bedeutung fur die stoffproduktion,” 
Japanese Journal of Botany, vol. 14, 1953, pp. 22--52. 
[11] I. Grechi, P. Vivin, G. Hilbert, S. Milin, T. Robert, and J.-P. 
Gaudillère, “Effect of light and nitrogen supply on internal c:n 
balance and control of root-to-shoot biomass allocation in grapevine,” 
Mathematics and Computers in Simulation, vol. 59, no. 2, 2007, pp. 
139--149. 
[12] H.-L. White, “The interaction of factors in the growth of lemna- xii. 
the interaction of nitrogen and light intensity in relation to root 
length,” Annals of Botany, vol. 1, 1937, pp. 649--654. 
[13] I.-F. Wardlaw, “The control of carbon partitioning in plants,” New 
Phytologist, vol. 116, 1990, pp. 341--381. 
[14] G.-B. West, J.-H. Brown, and B.-J. Enquist, “A general model for the 
origin of allometric scaling laws in biology,” Science, vol. 276, 1997, 
pp. 122--126. 
[15] K. Shinozaki, K. Yoda, K. Hozumi, and T. A. Kira, “A quantitative 
analysis of plant form -the pipe model theory. parts i and ii,” Japanese 
Journal of Ecology 1968, vol. 14, pp. 97--105, 1964, 133--139. 
[16] S. Shimizu-Sato and H. Mori, “Control of outgrowth and dormancy in 
axillary buds,” Plant Physiology, vol. 127, no. 4, 2001, pp. 1405--
1413. 
[17] P. Prusinkiewicz, L. Muvndermann, R. Karwowski, and B. Lane, 
“The use of positional information in the modeling of plants,” in 
ACM SIGRAPH 2001, Los Angeles, CA, USA, 2001, pp. 289--300. 
[18] P. de Reffye, “Modélisation de l'architecture des arbres par des pro- 
cessus stochastiques. simulation spatiale des modèles tropicaux sous 
l’effet de la pesanteur. application au coffea robusta,” Ph.D. 
dissertation, Université de Paris-Sud centre d'Orsay, 1979. 
[19] A. Reche, I. Martin, and G. Drettakis, “Volumetric reconstruction and 
interactive rendering of trees from photographs,” ACM Transactions 
on Graphics (SIGGRAPH Conference Proceedings), vol. 23, no. 3, 
July 2004. 
[20] X. Chen, B. Neubert, Y.-Q. Xu, O. Deussen, and S. B. Kang, 
“Sketch-based tree modeling using markov random field,” in ACM 
SIGGRAPH Asia 2008 papers, ser. SIGGRAPH Asia '08. 
[21] N. Greene, “Voxel space automaton: modeling with stochastic growth 
processes in voxel space,” Computer Graphics, vol. 23, no. 3, 1989, 
pp. 175--184. 
[22] R. Měch and P. Prusinkiewicz, “Visual models of plants interacting 
with their environment,” Computer Graphics, vol. 30, no. 3,1996, pp. 
397–410. 
[23] C. Soler, F.X. Sillion, F. Blaise, and P. de Reffye, “An efficient   
instanciation algorithm for simulating radiant energy transfer in plant 
models,” ACM Transactions on Graphics, vol. 22, no. 2, 2003, pp. 
204--233. 
[24] W. Van Haevre, F. Fiore, P. Bekaert, and F. Van Reeth, “A ray 
density estimation approach to take into account environment 
illumination in plant growth simulation,” in Proceedings of the 20th 
spring conference on Computer graphics. ACM, 2004, pp. 121--131. 
[25] A. Lacointe, “Carbon allocation among tree organs: A review of basic 
processes and representation in functional-structural tree models,” 
Annals of Forest Science, vol. 57, no. 5/6, 2000, pp. 521--533. 
[26] M. Allen, P. Prusinkiewicz, and T. M. DeJong, “Using L-systems for 
modeling source-sink interactions, architecture and physiology of 
growing trees: the L-PEACH model,” New Phytologist, vol. 166, no. 
3, 2005, pp. 869--880. 
[27] F. de Reffye, P.and Blaise, S. Chemouny, S. Jaffuel, T. Fourcaud, and 
F. Houllier, “Calibration of hydraulic growth model on the 
architecture of cotton plants,” Agronomie, vol. 19, 1999, pp. 265--280. 
[28] H. Yan, M. Kang, P. de Reffye, and M. Dingkuhn, “A dynamic, 
architectural plant model simulating resource-dependent growth,” 
Annals of Botany, vol. 93, no. 5, 2004, pp. 591--602. 
[29] V. Letort, P. H. Cournède, A. Mathieu, P. de Reffye, and T. Constant, 
“Parametric identification of a functional-structural tree growth model 
and application to beech trees (fagus sylvatica),” Functional Plant 
Biology, vol. 35, no. 10, 2008, pp. 951--963. 
[30] P.-H. Cournède, M.-Z. Kang, A. Mathieu, H.-P. Yan, B.-G. Hu, and P. 
de Reffye, “Structural factorization of plants to compute their 
functional and architectural growth,” Simulation.  Transactions of the 
Society for Modelling and Simulation International, vol. 82, no. 7, 
2006, pp. 427--438. 
[31] F. Wang, M.-Z. Kang, Q. Lu, V. Letort, H. Han, Y. Guo, P. de Reffye, 
and B.-G. Li, “A stochastic model of tree architecture and biomass 
partitioning: application to mongolian scots pines,” Annals of Botany, 
vol. 107, no. 5, 2011, pp. 781--792. 
[32] A. Mathieu, P.-H. Cournède, V. Letort, D. Barthe`le`my, and P. de 
Reffye, “A dynamic model of plant growth with interactions between 
devel- opment and functional mechanisms to study plant structural 
plasticity related to trophic competition,” Annals of Botany, vol. 103, 
2009, pp. 1173–1186. 
[33] C. Eschenbach, “Emergent properties modelled with the functional 
structural tree growth model almis: Computer experiments on 
resource gain and use,” Ecological Modelling, vol. 186, no. 4, 2005, 
pp. 470--488. 
[34] J. Evers, J. Vos, X. Yin, P. Romero, P. van der Putten, and P. Struik, 
“Simulation of wheat growth and development based on organ-level 
photosynthesis and assimilate allocation,” Journal of Experimental 
Botany, vol. 61, no. 8, 2010, pp. 2203--2216. 
[35] J. Hua and M. Kang, “Functional tree models reacting to the environ- 
ment,” in ACM SIGGRAPH 2011 Posters. ACM, 2011, p. 60. 
[36] N. Chiba and S. Ohkawa, “Visual simulation of botanical trees based 
on virtual heliotropism and dormancy break,” The Journal of 
Visualization and Computer Animation, vol. 5, 1994, pp. 3--15. 
[37] C. Godin, E. Costes, and H. Sinoquet, “A method for describing plant 
architecture which integrates topology and geometry,” Annals of 
Botany, vol. 84, 1999, pp. 343--357. 
[38] B. Lintermann and O. Deussen, “Interactive structural and 
geometrical modeling of plants,” IEEE Computer Graphics & 
Applications, vol. 19, no. 1, 1999, pp. 2--11. 
[39] H. Jensen, Realistic image synthesis using photon mapping.  AK 
Peters, Ltd., 2001. 
[40] T. Givnish, “Adaptation to sun and shadea whole-plant perspective” 
Functional Plant Biology, vol. 15, no. 2, 1988, pp. 63–92. 
[41] C. Lauterbach, M. Garland, S. Sengupta, D. Luebke, and D. 
Manocha, “Fast bvh construction on gpus,” in Computer Graphics 
Forum, vol. 28, no. 2.   Wiley Online Library, 2009, pp. 375–384. 
[42] K. Zhou, Q. Hou, R. Wang, and B. Guo, “Real-time kd-tree 
construction on  graphics  hardware,”  in  ACM Transactions  on  
Graphics  (TOG), vol. 27, no. 5.  ACM, 2008, p. 126. 
129
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-308-7
SIMUL 2013 : The Fifth International Conference on Advances in System Simulation

