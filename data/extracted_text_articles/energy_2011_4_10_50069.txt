Consumer Energy Management System:
Contract Optimization using Forecasted Demand
Chi-Cheng Chuang, Jimi Y. C. Wen
Networks and Multimedia Institute
Institute for Information Industry
Taipei, TAIWAN
polon@nmi.iii.org.tw, jimi@nmi.iii.org.tw
Ray-I Chang
Dept of Eng. Science and Ocean Eng.
National Taiwan University
Taipei, TAIWAN
rayichang@ntu.edu.tw
Abstract—Smart grid initiative is gaining traction around
the world, enabling more complexity in the utility contracts
designed to revolutionize our society towards more energy
efﬁcient and effective. Consumer energy management system
(EMS) is important in assisting how consumers participate
in the smart grid with the increasing complexity of utility
contracts. A web-based EMS was presented in this paper
with two novel design features: i) a maximum demand load
forecasting ii) maximum contracted demand (MCD) contract
optimization. A maximum demand load forecasting based on
space-speciﬁc regression models of simple latent variables, tem-
perature, number of workdays and employees, was proposed.
These regression models were accurate with a mean average
percentage error of 4∼8% and robust to different space size
of similar nature. The use of simple latent variables enables
consumers to input parameters easily through the proposed
EMS web-based interface. The Particle Swarm Optimization
(PSO) algorithm is especially suitable in dealing with utility
contract’s interdependent and discontinuous structure. A MCD
contract optimization based on the PSO algorithm was then
proposed and showed signiﬁcant savings in the studied cases
of 10∼30% improvement over the current MCD contracts and
a 5∼12.5% improvement over using the average maximum
demand load. The results showed promising potential of the
two proposed features in future consumer EMS.
Keywords-Energy Management System, Load Forecasting,
Contract Optimization, Particle Swarm Optimization.
I. INTRODUCTION
The world is gradually marching towards a severe energy
crisis, what with an ever-increasing demand of energy over-
stepping its supply. The total installed electricity generating
capacity of a system is typically 20 to 30% greater than
the predicted peak load in order to provide reserves for
maintenance and contingencies [1]. This surplus capacity
can be used to pump and store water in elevated reservoirs
to be released through hydraulic turbine generators during
peak periods. There is loss with any mechanical systems’
transfer of energy, so the ideal case is to facilitate the
equilibrium in consumption and generations via economical
approaches rather than pure physical/mechanical approaches,
i.e., effectiveness vs efﬁciency. Information communication
technology (ICT) plays a necessity in the realization of many
different programs that aid more effective use of energy [2],
[3], e.g., demand response, time of use, peak leveling, etc.
Most industrial and commercial electricity consumers sign
a maximum contracted demand (MCD) contract with the
electric utilities company, Taiwan Power Company (TPC),
in Taiwan. A MCD contract is an agreement between the
consumers and the utilities on the maximum demand load
that the consumer plans to use for a given time period,
if the consumers use more than the agreement load, they
are charged a high penalty. The detail of such a contract
is described in Section IV and [4]. This type of contract
is advantageous in two ways: i) Knowledge of these MCD
contracts allow the utilities a better estimate on demand,
therefore the utilities can plan more effective electricity gen-
eration and transmission infrastructure. ii) The consumers
reduce their electricity cost if they use their electricity
more effectively under the agreed maximum demand load
while not necessarily decreasing their overall electricity
consumption, i.e., equivalent production.
Energy management systems (EMS) 1 play a important
role for the consumer to manage either energy consumption
or cost. An EMS should give recommendations or control
energy consumption given the data it collects via sensors,
interface or the internet. In this paper, an EMS is proposed
with two main contributions: i) an accurate, robust maximum
load forecasting and ii) a ﬂexible and scalable MDC contract
optimization feature. The proposed EMS has other features
such as appliance monitoring, short term load forecasting.
These features are out of the scope of this paper, due the
length limitation.
This paper is structured as follows: Section II discusses
the background, and the implementation for the proposed
EMS. In Section III, a proposed maximum demand load
forecasting module is formulated and discussed. The output
of the forecasted value is then used as a input to the
optimization module. Section IV discusses the methodol-
1In this paper, the term EMS is referring to consumer side energy
management and not utility side EMS. This term is also used as home
energy management system (HEMS) or building energy management sys-
tem (BEMS).
58
ENERGY 2011 : The First International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-136-6

Convenience Store
Office Building
iMeter
iGateway
CServer
DataBase
Platform 
Interface
Load Forecasting
Contract Optimization
Interface
iMeter
Figure 1: Overview of the proposed energy management system in this paper.
ogy, implementation and experimental analysis for a MCD
contract optimization using the particle swarm optimization
method. Section V concludes the paper.
II. WEB-BASED ENERGY MANAGEMENT SYSTEM
There has been an increase in interest in the research of
EMS. An EMS is applied to many different applications,
e.g., residential [5], [6], commercial [7], [8] or industrial [9].
An EMS may have one or more of the following features
[10]:
• Data Collection: to collect real-time interval data from
interval meters, sensors, directly from utilities, or other
sources from the internet.
• Reporting and Monitoring: to automate energy and
emissions auditing, to track and display real-time and
historical data, includes various benchmarking tools,
seeing exactly when and how energy is used, combined
with anomaly recognition that can identify savings
opportunities.
• Engagement: to connect consumers’ daily choices with
energy consumption, that can be used to offer advice
to the occupants, or provide a forum for feedback on
sustainability initiatives.
The proposed EMS in this paper presents consumers a way
to optimize their MCD contract. System implementation is
shown in Fig. 1 and described brieﬂy in the following:
• Deployment: The EMS is deployed in 6 convenient
stores, a 5000 m2 ofﬁce, a 500 m2 ofﬁce and 1
university lab. A total of nine spaces.
• iMeter: Meters that can measure 4 three-phase power
or 12 single-phase power, and the data can transfered
via RS-485 ModBus or Zigbee 1.0.
• iGateway: A gateway that converts the protocol stack
of the iMeter to that of the server and database.
• Server & DataBase: Each running on an ASUS
RS300-E6 Series servers featuring the Intel 3420 PCH
chipset, Intel Xeon 3400 Series Processors, and 4GB
memory.
• Interface: Web-based user interface. Initial page uses
googlemap API to mark each of the deployment loca-
tions. Input interface for historical data for forecasting
and contractual parameters for optimization.
The EMS features, maximum demand load forecasting and
MCD contract optimization presented are shown in the
following sections.
III. MAXIMUM DEMAND LOAD FORECASTING
Accurate models for maximum demand load forecasting
are essential to MCD contract optimization. Load forecasts
can be divided into three categories: short-term forecasts,
which are usually from one hour to one week, medium term
forecasts, which are usually from a week to a year, and
long-term forecasts, which are longer than a year [11]. The
problem deﬁnition in this paper is more suited using medium
term forecasting. Load forecasting methods can be divide
into [12]: i) Causal and econometric forecasting methods,
identifying the underlying factors that might inﬂuence the
variable, which is being forecast. ii) Time-series methods
that uses historical data as the basis of estimating future
outcomes. iii) Artiﬁcial intelligence methods such as artiﬁ-
cial neural networks, support vector machines, etc.
A. Implementation
Due to the MCD contract structure, the maximum demand
load is needed for MCD contract optimization and was
forecasted in this paper as an example. For other types of
contract optimization, different type of demand can be fore-
casted using similar method. A causal forecasting method
is chosen for this implementation. The proposed maximum
demand load model was formulated as follows:
Di = αKi + βLi + γMi + ϵ
(1)
where the following variables are deﬁned:
59
ENERGY 2011 : The First International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-136-6

• Di maximum load: The maximum demand load in a
non-overlapping 15 minute period starting on the hour.
The maximum load can be collected from past bills or
utility database.
• Ki temperature: Apart from time factors, weather con-
ditions are the most inﬂuential variables. Temperature is
the most important weather factor with humidity second
[13]. The historic or forecasted temperature data can be
collected from the Central Weather Bureau database.
• Li workdays: The number of workdays can affect a
commercial site of their demand and can be provided
by the consumer.
• Mi employees: The number of employees can affect
the demand, i.e., more employees more demand, and
can be provided by the consumer.
• α, β, γ: the regression coefﬁcient for average monthly
temperature, number of workdays in a month and
numbers of employees respectively.
• ϵ: a constant.
The regression coefﬁcients and constant can be estimated
using historical data. The maximum demand, Di can then
be forecasted from latent variables, Pi, Li and Mi. Pre-
conﬁgured global and space-speciﬁc maximum demand load
models were estimate by the EMS and are suitable for
any similar type of commercial space and can be used
by the consumer. Speciﬁc site training is then optional
for the consumer, therefore making easier to use for the
consumers. Although model coefﬁcients may be needed to
be re-estimated speciﬁcally for different types type, i.e.,
convenient stores with the use of fridge and freezers should
have a different model than an ofﬁce that composes of
mainly PCs or an industrial space with heavy machinery.
B. Analysis
Both the global and space-speciﬁc regression models
were tested for their accuracy and robustness. The accuracy
(monthly error over one year) is tested with Mean Absolute
Percentage Error (MAPE) deﬁned as:
MAPE =
∑12
i=1 |( ˆEi − Ei)/Ei|
12
.
(2)
The robustness was tested with a leave one out method,
where the partitioning of the estimation data and forecasting
data can be seen in Table I. Table I also includes the MAPE
of forecasting of the three models. It can be seen that a
global regression model performs poorly in forecasting with
a MAPE=55%, while space-speciﬁc models for ofﬁce and
convenient stores have a MAPE of 4% and 8% respectively.
A closer look of the forecasted maximum demand load
of for both the global and the space-speciﬁc regression
models can be seen in Fig. 2(a) and (b) for an ofﬁce and a
convenient store respectively. It can be seen that the maxi-
mum demand load is underestimated using global regression
model for convenient stores and overestimated for ofﬁces.
Table I: FORECASTING PERFORMANCE OF DIFFERENT MODELS
FOR DIFFERENT SPACES.
Regression model
Estimation
Forecasting
MAPE
Global
8
1
0.55
Ofﬁce
Space-speciﬁc
2
1
0.04
Convenient store
Space-speciﬁc
5
1
0.08
0
5
10
0
50
100
150
200
250
Month
kW
(a) Office
 
 
Real Data
Global Model
Space Specific Model
0
5
10
0
10
20
30
40
kW
Month
(b) Convenient Store
Figure 2: Detail of forecasted maximum demand load values of
different models for different spaces.
This is because the latent variables deﬁned in (1) cannot
account for different type of appliances used in the space.
However forecasting using space-speciﬁc regression model,
the proposed latent variables can sufﬁciently forecast the
maximum demand load. The forecasted maximum demand
load is then used in the contract capacity optimization,
describe in Section IV.
IV. MCD CONTRACT OPTIMIZATION
The deregulation and privatization of utility companies has
led to dramatic changes in business models, an increased
focus on efﬁciency of operations, and increased focus on
reliability of service [14]. Contract optimization of tariff
selection was as early as 1992 by Birch et al. [15]. Contracts
are becoming more complex [2], therefore requiring more
intelligent approaches to contracts from the point of view
for all parties: generation [16] , distribution [17], consumer
[18].
For problems over real-valued search-spaces, where the
classic way of optimization is to derive the gradient of the
function to be optimized and then employ gradient descent
or a quasi-Newton method. However most utility contracts
are not continuous as can be seen in Section IV-A. Another
approach towards optimization problems use evolutionary
algorithms. These methods do not use the gradient or
Hessian matrix so their advantage is that the function to
be optimized need not be continuous or differentiable and it
can also have constraints [19]. In such cases, algorithmic
procedures that take full advantage of modern computer
60
ENERGY 2011 : The First International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-136-6

Maximum Demand Load Forecasting
Particle Initialization 
MCD Contract
Initialize Particle Position and Velocity
Update Particle Position and Velocity
Fitness Function
Termination Criteria is meet
Figure 3: Procedure of MCD contract optimization
systems can be implemented to solve the underlying op-
timization problems numerically [20]. Popular evolutionary
algorithms optimizers for real-valued search-spaces include
particle swarm optimization (PSO), differential evolution
and evolution strategies . Particle Swarm Optimization was
used by Chen et al. to effective optimal demand contract in
Taiwan for following advantages [21]: i) fewer parameters
to adjust and easier implementation compared to GA, ii)
more effective memory capability compare to GA iii) more
efﬁcient in maintaining the diversity. The implementation of
PSO as illustrated in Fig. 3 on the MCD contract is discussed
in the next section.
A. Implementation
Many different type of contracts or programs are offered
by utilities, the proposed approach can be implemented for
many type contract in a form that can be expressed as the
ﬁtness function of the PSO. Here an optimization of TPC’s
bi-period MCD contract is illustrated. Some notation are
deﬁne as below:
• T periods
i
(kW): The consumers’ MCD, a threshold for the i−th
month determined according to the agreement between the
consumers and the utilities for different periods: peak, non-
summer and off-peak period.2
• Rseason
period ($TWD/kW): The rate charged by TPC for summer
and non-summer seasons and different maximum contracted
demand: peak, non-summer and off-peak.
• Dperiod
i
(kW): Consumers’ maximum demand load during
peak or off-peak periods for the i−th month.
• Eperiod
i
: Excess in consumer MCD during peak or off-peak
periods for the i−th month.
• P period
i
: Penalty paid by consumer corresponding to the given
Eperiod
i
peak or off-peak periods for the i−th month.
2In typical scenarios, only the peak period MCD is selected. MCDs
for other periods are only needed in atypical scenarios when these period
demands are expected to be greater than the peak MCD.
The ﬁtness function of the PSO is deﬁned as the total cost
for the MCD contract:
ctotal
i
=
12
∑
i=1
cadjust
i
+ cbasic
i
+ cpenalty
i
,
(3)
where the adjustment charge for changing the MCD thresh-
old is
cadjust
i
= 1670 max{(T peak
i
− T peak
i−1 ), 0},
(4)
i.e a penalty is only charged for an increase in the MCD.
For summer seasons June to September (i=6:9), the basic
charge is:
cbasic
i
=
Rsum
peakT peak
i
+ Rsum
off Γi
(5)
where
Γi = max{[(T off
i ) − T peak
i
+ T sum
i
2
], 0}
(6)
and for other months (i=1:5,10:12), the basic charge is
cbasic
i
=
Rnon
peakT peak
i
+ Rnon
nonT non
i
+ Rnon
off Γi.
(7)
The penalty for excess demand is the sum of two the penalty
for the peak-period and off-peak period, i.e.,
cpenalty
i
=
P peak
i
+ P off
i .
(8)
The excess in MCD is deﬁned for the peak period:
Epeak
i
=
{
Dpeak
i
− T peak
i
if i = 6 : 9
Dpeak
i
− T peak
i
− T non
i
otherwise
(9)
and the off-peak period:
Eoff
i
=
Doff
i
− (T peak
i
+ T non
i
+ T off
i ).
(10)
The penalty for peak time excess demand can then be found
for summer period i = 6 : 9 and if Epeak
i
/T peak
i
≤ 0.1:
P peak
i
= 2Rsum
peakEpeak
i
(11)
otherwise, if Epeak
i
/T peak
i
> 0.1:
P peak
i
= Rsum
peak[0.2T peak
i
+ 3(Epeak
i
− 0.1T peak
i
)].
(12)
For the non-summer period i = 1 : 5, 10 : 12 and
if Epeak
i
/T peak
i
≤ 0.1
P peak
i
= 2Rnon
peakEpeak
i
(13)
otherwise if Epeak
i
/T peak
i
> 0.1:
P peak
i
= Rnon
peak[0.2T reg
i
+ 3(Epeak
i
− 0.1T peak
i
)].
(14)
An additional penalty is charged when off-peak period
excess is greater than peak period excess, i.e., Eoff
i
−
Epeak
i
> 0, and is deﬁned for summer period i = 6 : 9
and if (Eoff
i
− Epeak
i
)/(T peak
i
+ T non
i
+ T off
i
) ≤ 0.1
P off
i
= 2Rsum
off (Eoff
i
− Epeak
i
)
(15)
61
ENERGY 2011 : The First International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-136-6

Table II: PRICE OF MCD CONTRACTS IN $TWD
Savings from
Savings from
Scenario
Current
Average Load
PSO
current
average load
Ofﬁce
$ 401
$ 290
$ 288
28 %
6 %
School
$ 482
$ 449
$ 444
10 %
5 %
Building
$ 3,790
$ 2,978
$ 2,800
26 %
6 %
Store
$ 500
$ 400
$ 350
30 %
12.5 %
otherwise
P off
i
=
Rsum
off [−0.1(T peak
i
+ T non
i
+ T off
i
) +
+3(Epeak
i
− 0.1(T peak
i
+ T non
i
))]
(16)
and non-summer period i
=
1
:
5, 10
:
12 and
if (Eoff
i
− Epeak
i
)/(T regular
i
+ T non
i
+ T off
i
) ≤ 0.1
P off
i
= 2Rnon
off (Eoff
i
− Epeak
i
),
(17)
otherwise
P off
i
=
Rnon
off [−0.1(T peak
i
+ T non
i
+ T off
i
)
+3(Epeak
i
− 0.1 ∗ (T peak
i
+ T non
i
))].
(18)
It can be seen from (3)-(18) that the parameters to be
optimized are interdependent and discontinuous. Therefore
using a PSO approach is advantageous compare to classic
gradient-based optimization methods.
B. Analysis
Using a the above deﬁned ﬁtness function a PSO was car-
ried out. It can be seen that in Table. II, current peak MCD
contracts are usually set too high without the computation
of maximum demand load forecasting and MCD contract
optimization modules. It can also be seen that, using the a
‘naive’ optimization using the average forecasted maximum
demand load is setting the MCD too low. The proposed
optimization gives a 10∼30% improvement over the the
current MCD contracts and a 5∼12.5% improvement over
MCD contracts using the average maximum demand load.
It is also noted that under the current contract strucutre, the
penalty is really high for adjustment of the MCD as seen
by the constant 1690 TWD per every kW increase. This
is due to the cost of increasing the limit of the physical
infrastructure of current power system being too high and
inﬂexible. However as the smart grid infrastructures advance
[3], intermittent and adaptive power systems may lower the
cost of varying this limit, thus allowing a more dynamic
MCD structure, which can be easily adapted to by the
proposed MCD contract optimization module.
V. CONCLUSIONS AND FUTURE WORK
A web-based EMS was presented in this paper with two
novel design features: i) maximum demand load forecasting
and ii) MCD contract optimization. A maximum demand
load forecasting based on space-speciﬁc regression models
of simple latent variables, temperature, number of workdays
and employees, was presented. These space-speciﬁc regres-
sion models were accurate and robust to different space
size of similar nature. The simple latent variables allow
consumers to input their parameters easily through the web-
based interface. A MCD contract optimization based on
PSO was then proposed and showed signiﬁcant savings.
PSO is especially suited and ﬂexible in dealing with utility
contract’s interdependent and discontinuous structure, and
has the potential to be implemented in a distributed com-
puting approach naturally [20]. This allows the scalability
of web-based EMS to become a platform based service in
the future assisting many people in the time of increasing
utility contract complexity as smart grid advances. The next
step in our research is to improve the robustness of contract
optimization given load forecasting errors.
REFERENCES
[1] P. Kiameh, Power Generation Handbook: Selection, Applica-
tions, Operation, Maintenance.
McGraw-Hill Professional,
2002.
[2] I. E. A. IEA, The Power to Choose: Demand Response in
Liberalised Electricity Markets.
OECD Publishing, 2003.
[3] C. W. Gellings, The Smart Grid: Enabling Energy Efﬁciency
and Demand Response.
CRC Press, 2009.
[4] Taipower, “Tariff book,” Taiwan Power Company, Tech. Rep.,
2008.
[5] D. M. Han and J. H. Lim, “Design and implementation of
smart home energy management systems based on zigbee,”
Consumer Electronics, IEEE Transactions on, vol. 56, no. 3,
pp. 1417 –1425, 2010.
[6] V. Sundramoorthy, G. Cooper, N. Linge, and Q. Liu, “The
challenges and design concerns for the domestication of
energy monitoring systems,” Pervasive Computing, IEEE,
vol. 10, no. 1, pp. 20–27, 2011.
[7] J. Van Gorp, “Enterprising energy management,” Power and
Energy Magazine, IEEE, vol. 2, no. 1, pp. 59 – 63, 2004.
[8] R. Brewer and P. Johnson, “Wattdepot: An open source soft-
ware ecosystem for enterprise-scale energy data collection,
storage, analysis, and visualization,” in IEEE Int. Conf. on
Smart Grid Communications, 2010, pp. 91 –95.
[9] T. Y. Wu, S. S. Shieh, S. S. Jang, and C. Liu, “Optimal
energy management integration for a petrochemical plant
under considerations of uncertain power supplies,” Power
Systems, IEEE Transactions on, vol. 20, no. 3, pp. 1431 –
1439, 2005.
62
ENERGY 2011 : The First International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-136-6

[10] R. Aldrich and J. Parello, IP-Enabled Energy Management:
A Proven Strategy for Administering Energy as a Service.
Sybex, 2010.
[11] E. A. Feinberg and D. Genethliou, Applied Mathematics for
Restructured Electric Power Systems: Optimization, Control,
and Computational Intelligence.
Springer, 2005, ch. 12, pp.
269–286.
[12] A. K. Palit and D. Popovic, Computational Intelligence in
Time Series Forecasting: Theory and Engineering Applica-
tions, M. J. Grimble and M. A. Johnson, Eds.
Springer,
2005.
[13] R. Weron, Modeling and Forecasting Electricity Loads and
Prices: A Statistical Approach, R. Weron, Ed.
Wiley, 2006.
[14] J. Momoh, Economic Market Design and Planning for Elec-
tric Power Systems.
Wiley-IEEE Press, 2009, ch. 10, pp.
237–273.
[15] A. Birch and C. Ozveren, “An adaptive classiﬁcation for tariff
selection,” in Proc. Int. Conf. Metering Apparatus and Tariffs
for Electricity Supply, Nov. 1992, pp. 53 –57.
[16] Y. Ma, C. Jiang, Z. Hou, and C. Wang, “The formulation of
the optimal strategies for the electricity producers based on
the particle swarm optimization algorithm,” Power Systems,
IEEE Transactions on, vol. 21, no. 4, pp. 1663 –1671, 2006.
[17] P. Bajpai, S. Punna, and S. Singh, “Swarm intelligence-
based strategic bidding in competitive electricity markets,”
Generation, Transmission Distribution, IET, vol. 2, no. 2, pp.
175 –184, 2008.
[18] T. Y. Lee and C. L. Chen, “Wind-photovoltaic capacity
coordination for a time-of-use rate industrial user,” Renewable
Power Generation, IET, vol. 3, no. 2, pp. 152 –167, 2009.
[19] X. Yu and M. Gen, Introduction to Evolutionary Algorithms.
Springer, 2010.
[20] E. Konstantinos, Particle Swarm Optimization and Intelli-
gence: Advances and Applications.
Information Science
Publishing, 2010, ch. 2, pp. 25–41.
[21] J. C. Chen, J. C. Hwang, J. S. Pan, and Y. C. Huang, “PSO
algorithm applications in optimal demand decision,” in proc.
IEEE Int. Power Electronics and Motion Control Conf., May
2009, pp. 2561 –2565.
63
ENERGY 2011 : The First International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-136-6

