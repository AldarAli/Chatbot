Modeling and Sensitivity Analysis of
Compressor Stations in Gas Transport Simulations
Anton Baldin
Fraunhofer Institute for Algorithms
and Scientiﬁc Computing
Sankt Augustin, Germany
email: Anton.Baldin@scai.fraunhofer.de
Kläre Cassirer
Fraunhofer Institute for Algorithms
and Scientiﬁc Computing
Sankt Augustin, Germany
email: Klaere.Cassirer@scai.fraunhofer.de
Tanja Clees
University of Applied Sciences
Bonn-Rhein-Sieg and Fraunhofer Institute
for Algorithms and Scientiﬁc Computing
Sankt Augustin, Germany
email: Tanja.Clees@scai.fraunhofer.de
Bernhard Klaassen
Fraunhofer Institute for Algorithms
and Scientiﬁc Computing
Sankt Augustin, Germany
email: Bernhard.Klaassen@scai.fraunhofer.de
Igor Nikitin
Fraunhofer Institute for Algorithms
and Scientiﬁc Computing
Sankt Augustin, Germany
email: Igor.Nikitin@scai.fraunhofer.de
Lialia Nikitina
Fraunhofer Institute for Algorithms
and Scientiﬁc Computing
Sankt Augustin, Germany
email: Lialia.Nikitina@scai.fraunhofer.de
Sabine Pott
Fraunhofer Institute for Algorithms
and Scientiﬁc Computing
Sankt Augustin, Germany
email: Sabine.Pott@scai.fraunhofer.de
Abstract—This paper describes the mathematical modeling of
compressors used in gas transport networks. Compressors of
various types (piston, generic, turbo), different levels of modeling
(free, advanced), as well as their combinations into compressor
stations (serial, parallel) are considered. Particular attention is
paid to the questions of global convergence and stability of the
result to the variations of starting point and other parameters
of the solution procedure. Sensitivity Analysis and Principal
Component Analysis for stationary gas transport problems are
considered. A number of numerical experiments on realistic
scenarios conﬁrm the conclusions of the theoretical analysis.
Index Terms—simulation and modeling; mathematical and
numerical algorithms and methods; advanced applications; gas
transport networks; sensitivity analysis; principal component
analysis
I. INTRODUCTION
This work is an extension of our conference paper [1],
where gas compressors of piston and generic type have been
considered. For the sake of completeness, we have added a
review of the main results of the paper [2] on turbine com-
pressors. Also, we present a detailed review of [3] results on
Sensitivity Analysis (SA) and Principal Component Analysis
(PCA) of gas transport simulations and supplement it with new
numerical experiments.
In this paper, we will continue the study of globally con-
verging methods for solving stationary network problems on
the example of gas transport networks. In our earlier work
[4], we introduced the concept of generalized resistivity of
network elements and formulated stability conditions for the
algorithm solving the corresponding network problems. Under
these conditions, for arbitrary variation of the starting point,
the solution procedure converges to the same or numerically
close result. The approach is universal and can be applied also,
e.g., for water transport and electric power networks [5]. In the
works [2], [6], [7] we have considered in detail the modeling
of gas compressors of the turbine type. For these compressors,
individually calibrated characteristics and data resampling on
a regular grid were used. In the present paper, we consider
compressors of piston and generic type, which are character-
ized by the existence of analytical solutions and a simpler
representation of control equations. This simulation extends
our system MYNTS (Multi-phYsics NeTwork Simulator).
Globally convergent method of solution of stationary net-
work problems in applications to electric networks was formu-
lated in [8]. The method has been designed for piecewise linear
systems of equations. The space of variables was subdivided
to polyhedral cells, where the system has been represented by
a non-degenerate linear mapping, with continuous connection
on the boundary. The method converges from an arbitrary
starting point to a unique solution, in a ﬁnite number of
steps. Further, in [9], the method has been extended to the
linear mappings that can be degenerate in ﬁnite cells. In
[10], these systems have been represented in min-max or
equivalent abs-normal form and several methods for their
solution have been discussed. In application to smooth non-
linear systems, the piecewise linear mappings can be used
as an approximation. However, the methods above increase
the number of steps when the cells become smaller and will
93
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

perform slowly in practice. The general methods for solution
of non-linear systems are described in [11]. In particular, there
is a mathematically strict but little-known result, that Newton
method equipped with Armijo line search stabilizer provides
the global convergence for solution of smooth non-degenerate
systems. No methods are known well working for general
smooth non-linear systems in the presence of degeneracy.
Modeling of gas transport networks is described in detail
in [12], [13]. The real gas networks consist mainly of pipes,
and their modeling is based on the nonlinear friction law,
simplest by Nikuradse [14], more advanced by Colebrook-
White [15] and Hofer [16]. The other parts of the modeling
are empirical approximations for the equation of state of a real
gas, the simplest by Papay [17], more complex AGA8-DC92
[18] and GERG2008 [19] standards. However, neither pipe nor
state equations generally present an obstacle for solving gas
transport problems. Rare exceptions are cycles of short pipes
where unstable circulations can be excited and regions of phase
transitions where jumps and folds of state equation can appear.
Otherwise, the pipe and state equations are very smooth and
typically solved with several iterations of stabilized Newton
method. The problem is presented by compressors and reg-
ulators, the elements increasing and decreasing pressure in
the network to the desired values. The corresponding element
equations make the system piecewise degenerate [4], requiring
a development of special methods for its solution. Possible
ways for construction of such methods will be discussed in
this paper.
In Section II, we recall the general concepts of element
resistivity and describe their physical meaning in more detail.
In Section III, we will look at compressors of piston, generic
and turbine type. In Section IV, we describe Sensitivity
Analysis and Principal Component Analysis of gas transport
simulations. Section V presents the methods for solving nearly
degenerate nonlinear systems. In Section VI, we will carry
out a numerical solution of several realistic network problems,
presenting the application of the above described methods.
II. TRANSPORT VARIABLES IN STATIONARY NETWORK
PROBLEMS
Network problems of a stationary type are described by a
system of equations that includes linear Kirchhoff equations
of the form P Qi = 0, which describe the conservation of
ﬂows in network nodes, and equations of elements of the form
f(Pin, Pout, Q) = 0, in the general case, nonlinear, introduced
on each edge of the network graph. Here the transport variables
Pin/out are used – nodal variables for the input and output of
the element, for gas networks – pressure values, Q – the ﬂow
through the element. In gas problems, ﬂows are considered in
different normalizations, which is indicated by the index: Qm
– mass ﬂow, Qν – molar ﬂow, QN – volumetric ﬂow under
normal conditions, Qvol,in/out – volumetric ﬂow in input or
output conditions (by default, input conditions are taken), etc.
An element is called generalized resistive if its equation has
derivatives of the following signature:
∂f/∂Pin > 0, ∂f/∂Pout < 0, ∂f/∂Q < 0.
(1)
Fig. 1. On the top: a serial connection of compressor (circle) and resistor (rect-
angle); in the center: decreasing compressor Pout(Q) characteristics (thick
line) and increasing resistor Pout(Q) characteristics (thin line) have a single
intersection (stable case); at the bottom: increasing compressor Pout(Q)
characteristics (thick line) and increasing resistor Pout(Q) characteristics
(thin lines) can have multiple intersections or no intersection (unstable case).
Image from [1].
The work [4] shows that stationary network problems in which
all elements have a given signature have a unique solution
that can be found by the standard stabilized Newton algorithm
with an arbitrary choice of starting point. Technically, it also
requires a supply with a set pressure Pset in each disconnected
component of the graph, as well as a proper condition for the
behavior of functions at inﬁnity, which can be satisﬁed if there
are linear continuations of the equations of elements outside
the working region that have the signature (1). Also, the
completely opposite signature is formally admissible, since the
sign change of f → −f is admissible for stationary problems.
To eliminate this trivial ambiguity, one can choose the sign of
f, postulating the fulﬁllment of one of the conditions (1), for
example, the ﬁrst one.
The physical meaning of these conditions is illustrated in
Figure 1. It shows the serial connection of the tested element
(in this case the compressor, a circle) and a linear resistor
(a rectangle). Pressure Pset1,2 is set at the free ends. The
intermediate node must satisfy the equation
Pout(Pset1, Q) = Pset2 + RQ,
(2)
graphically depicted in the central and lower parts of the ﬁgure.
Here R > 0 is the resistance value, the corresponding line on
the ﬁgure increases monotonically. If the tested element has
the signature (1), then the function Pout(Pset1, Q) decreases
monotonically in Q, which corresponds to the central part of
the ﬁgure. In this case, the intersection of lines exists and is
unique. It can also occur outside this graph, when the above
condition is met at inﬁnity (continuation of the element’s
94
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

characteristic by a linearly strictly decreasing function outside
the working region). In the case, if the signature (1) would
be violated and the function Pout(Pset1, Q) would increase in
Q, then by choosing the parameters Pset2 and R it is possible
to achieve that the lines will have several intersections or no
intersection. Even if the function Pout(Pset1, Q) increases in
Q only locally, a linear resistor can be ﬁtted to it, which will
give several solutions to the problem under consideration. It
is also clear that a nonlinear resistor can also be used for this
purpose, as long as its characteristic increases and has enough
parameters for tuning.
Similarly, by connecting elements in reverse order, as well
as considering their parallel connection, it can be shown that
any violation of the condition (1) leads to a violation of the
uniqueness of solution. If the signature is violated, then the
tested element can be connected to an elementary resistive
element in such a way that the equation will have several
solutions or none. The case when the signature is satisﬁed for
all elements and the system has a unique solution is, of course,
more preferable in practical applications.
Compressors are the most complex elements in gas prob-
lems; several levels of modeling are used to represent them.
The main purpose of introduction of these levels is the gradual
sophistication of modeling, where the solution of a simple
model is used as a starting point for the more complex one.
Also, it allows to separate effects dependent on individual
calibration of compressors from their basic representation.
Free model: is the simplest, formulated only in terms
of transport variables, and is described by a piecewise linear
formula of the form
max(min( Pin − PL, −Pout + PH, −Q + QH),
(3)
Pin − Pout, −Q) + ϵ(Pin − Pout − Q) = 0,
where parameters PL, PH, QH deﬁne target values, for
example, PH = SPO for speciﬁed output pressure, or upper
and lower limits for other controlled values. This formula
deﬁnes a polyhedral surface in the space of transport variables
in the so-called maxmin representation [10]. Typical surface is
shown below on Figure 2 left. The last term, controlled by
small positive parameter ϵ, serves regularization and will be
explained below.
Advanced model: introduces additional internal variables
for compressors: revolution number rev, adiabatic enthalpy
increase Had, performance Perf , efﬁciency η, torque Mt, and
additional equations:
P = ρRTz/µ, Qm = Qvolρin,
(4)
Had = Pin/(ρinα) · ((Pout/Pin)α − 1),
(5)
Perf = QmHad/η, Mt = Perf /(2π · rev),
(6)
α = (κ − 1)/κ, 0 < α < 1, 0 < η < 1,
(7)
where the equation of state is written ﬁrst with its parameters:
density ρ, universal gas constant R, absolute temperature T,
compressibility factor z, molar mass µ; the second is the
relationship between the mass ﬂow and the volumetric ﬂow in
the input conditions; the following are deﬁnitions of internal
variables in terms of transport variables; κ > 1 is the adiabatic
exponent.
The advanced model also introduces additional patches,
inserted into the free formula (3) as follows:
max(min( Pin − PL, −Pout + PH, −Q + QH,
f1, ..., fn ),
(8)
Pin − Pout, −Q) + ϵ(Pin − Pout − Q) = 0.
The additional patches for various types of compressors are
described below. The general strategy is to resolve all internal
variables from the corresponding equations, obtain a formula
in terms of transport variables, check its signature, and use it
in the standard solution algorithm.
III. GAS COMPRESSORS
Three different types of compressors are considered.
A. Piston compressors
Compressors of piston types are modeled by direct propor-
tionality
Qvol = V · rev
(9)
with given constants η and V – compressor chamber volume.
The control equation has the following patches:
f1 = revmax − rev ≥ 0,
(10)
f2 = Mt,max − Mt ≥ 0,
(11)
f3 = Perf max − Perf ≥ 0,
(12)
f4 = relmax − Pout/Pin ≥ 0,
(13)
f5 = ∆Pmax − (Pout − Pin) ≥ 0,
(14)
with given constants revmax, Mt,max, relmax, ∆Pmax and
the function Perf max(rev) determined by the characteristics
of the compressor drive.
Stability analysis: calculating the derivatives of fi with
respect to (Pin, Pout, Qm) in the working region 0 < Pin ≤
Pout, Qm > 0, rev > 0, we get the signatures given in
Table I. In this case, the above formulas are used, as well
as the stability of the equation of state: ρ > 0, ∂ρ/∂P > 0.
In particular, rev = Qm/(ρinV ) has signature (−0+), which
implies the signature of f1 in the table. Mt = HadρinV/(2πη)
has signature (∗ + 0), where ∗ = ∂(Hadρin)/∂Pin < 0 for
Pout/Pin < (1 − α)(−1/α) = β. Thus, the signature f2 is
correct only if the compressor raises the pressure by no more
than the factor β, with the value κ = 1.29 typical for natural
gas, we get β = 3.10408. To eliminate the fold in the equation,
f2 should be replaced with Hadρin|Pin → max(Pin, Pout/β).
It is convenient to divide the expression f3 by (2π rev) and
consider the signature ˜f3 = Mt,drv(rev) − Mt. As noted in
[2], for drive equations to be stable it is necessary that Mt,drv
decrease with rev. Therefore, the ﬁrst term in ˜f3 has the
signature (+0−), and the second already calculated (+−0) in
the region Pout/Pin < β, which gives the complete signature
(+ − −). Calculation of other derivatives is trivial. We also
note that the presence of zeros in the signatures means that the
95
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

TABLE I
PATCH SIGNATURES OF PISTON COMPRESSOR [1]
patch
sgn
condition
f1
(+ 0 −)
f2
(+ − 0)
Pout/Pin < β
f3
(+ − −)
Pout/Pin < β, ∂Mt,drv/∂ rev < 0
f4
(+ − 0)
f5
(+ − 0)
TABLE II
PATCH SIGNATURES OF GENERIC COMPRESSOR [1]
patch
sgn
condition
f1
(+ 0 −)
f2
(+ − 0)
∂zin/∂Pin < 0 or small
f3
(+ − −)
∂zin/∂Pin < 0 or small
rule (1) is satisﬁed marginally, which is corrected by adding
a regularizing ϵ-term to the element equation. Also, for the
practical implementation of these formulas, it is necessary to
introduce clamps, which force all variables to the working
region: Qm → max(Qm, 0), Pout/Pin → max(Pout/Pin, 1),
etc.
B. Generic compressors
Compressors of generic type can also be considered as an
intermediate level of modeling (generic model). In this model,
the variable rev is not introduced, and restrictions are imposed
on other variables
f1 = Qvol,max − Qvol ≥ 0,
(15)
f2 = Had,max − Had ≥ 0,
(16)
f3 = Perf max − Perf ≥ 0,
(17)
with constant Qvol,max, Had,max and Perf max.
Stability analysis: calculating derivatives similarly, for
Qvol = Qm/ρin we have signature (−0+), hence (+0−) for
f1, see Table II. For Had = RTinzin/(µinα)((Pout/Pin)α −
1) we get (∗+0), where ∗ = ∂(zin((Pout/Pin)α−1))/∂Pin <
0. For an ideal gas z = 1, hence, obviously, ∗ = −. For natural
gas z is a decreasing function of P, in this case also ∗ = −.
For some gases, such as hydrogen, z may increase with P, but
it remains close to 1 and changes so slowly that the remaining
decreasing dependence of Had on Pin dominates. Under these
conditions, f2 has signature (+ − 0). For Perf = QmHad/η
the signature (− + +) under the same conditions on zin, thus
f3 has the signature (+ − −).
C. Turbocompressors
Detailed modeling of turbocompressors was done in [2], [6],
[7]. For the sake of completeness, here we review the main
results.
Fig. 2. Compressor modeling: ‘free’ model on the left; ‘advanced’ model for
typical turbocompressor on the right. Images from [4], [7].
The equation of advanced patch has the form
f1 = −Pout + P adv
out ( ˆPin, ˆQ)
(18)
+ min(Pin − P adv
in,min, 0) + max(Pin − P adv
in,max, 0) (19)
+ min(−Q + Qadv
max, 0) + max(−Q + Qadv
min, 0)),
(20)
ˆPin = min(max(Pin, P adv
in,min), P adv
in,max),
(21)
ˆQ = min(max(Q, Qadv
min), Qadv
max).
(22)
The main part (18) is the equation −Pout + P adv
out (Pin, Q) =
0, deﬁned in rectangular region Pin ∈ [P adv
in,min, P adv
in,max],
Q ∈ [Qadv
min, Qadv
max], with derivatives ∂P adv
out /dPin
> 0,
∂P adv
out /dQ < 0. Additional terms (19,20) carry out a con-
tinuous extension of this equation outside the region, with the
same signs of derivatives. The resulting function P adv
out (Pin, Q)
in typical case is shown in Figure 2 on the right. This surface
represents the union of rev ≤ revmax and Perf ≤ Perf max
patches converted into the space of transport variables. This
conversion is done in the following way.
Step 1: calibration of the compressors and their drives with
(bi-)quadratic functions:
Had =
X
ij
Aijvr
i vq
j, η =
X
ij
Bijvr
i vq
j,
(23)
Qvol,min =
X
i
Civr
i , Perf max =
X
i
Divr
i , (24)
vr = (1, rev, rev2), vq = (1, Qvol, Q2
vol),
(25)
with constant coefﬁcient matrices A, B, C, D.
Step 2: deﬁnitions (4-6) are partially resolved until formulas
in the (Qm, ρin, Had) coordinate system are obtained, inde-
pendent of temperature and gas composition:
Qm = Perf maxη/Had, ρin = Qm/Qvol,
(26)
Step 3: deﬁnitions (4-6) are ﬁnally resolved until formulas
in the (Qm, Pin, Pout) coordinate system are obtained, taking
into account temperature and gas composition:
Pin = EOS inv(ρin), zin = Pin/(γρin),
(27)
Pout = Pin(Hadα/(γzin) + 1)1/α.
Here γ = RTin/µ and the equation of state ρ = EOS(P) is
inverted to determine Pin.
Step 1 is performed once in the calibration procedure using
ﬁtting methods. Step 2 is also performed once, while the
96
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

domain of deﬁnition of functions on the (Qvol, rev) plane
is triangulated, the corresponding formulas are applied at the
nodes, and linear interpolation in triangles is used for the
continuous representation. Only step 3 is performed during
simulations, as part of the procedure that determines the
temperature and gas composition.
Stability analysis: consists in checking that the normals
to the triangles used to represent the functions point to the oc-
tant corresponding to the correct signature. It sufﬁces to carry
out such a check in the coordinate system corresponding to
step 2, while step 3 consists in a monotonic reparametrization
of the axes that preserves the signature of the normal.
Further details: in order for the compressor to work
properly, the ﬂow through it must satisfy certain restrictions.
On the Qvol = Qvol,min line, the bypass regulator (rbp1,2
on Figure 4 bottom) is activated at the compressor, through
which the ﬂow can circulate, thereby ensuring the minimum
required ﬂow through the compressor (surge line). Since
in this case the total ﬂow through the compressor and the
regulator may be less than this minimum value, this boundary
is modeled by continuing the surface shown in Figure 2 on
the right side along the Q axis towards small values. On the
other side, there is a line η = ηmin (choke line), which is
modeled by the continuation of the surface along the Q axis
towards larger values. Since the compressor does not work
efﬁciently on this part of the surface, the working point in
this region is accompanied by a warning, and getting there
should be avoided by adjusting the parameters. In addition,
the continuation of the biquadratic functions into this region
would lead to the formation of folds, and their replacement by
the ruled continuation solves this problem. Switches similar
to the surge line also occur on the rev = revmin line. At the
same time, the location of the working point on this line and
simultaneously on Perf = Perf max patch also leads to the
formation of folds, which for typical compressors are outside
the physical area and are eliminated by cutting.
The characteristics of the compressor drive can also depend
on the ambient temperature Tamb, which can be modeled
by constructing the biquadratic formula Perf max(rev, Tamb).
In this case, the resulting dependence in step 2 is linear in
Perf max, which leads to the possibility of precomputing the
surface for three values of Tamb and then taking into account
the dependence on Tamb using linear weighting with weights
quadratically dependent on Tamb.
Compressor stations: are formed, in the simplest case,
when individual compressor units are connected in parallel
or in series. Examples of such combinations are shown in
Figure 3a,b and in more detail in Figure 4 bottom. In this case,
the type and controlled values of each compressor may be the
same, they may also be different. The station also includes
other elements, some of which (valves, shortcuts) have trivial
functions. To ensure the stability of the solution algorithm (in
particular, no cycles from shortcuts, indeﬁnite pressure in the
sequence of closed valves, etc.), such elements are eliminated
in the preprocessing procedure. There are also other elements:
coolers that affect temperature distributions inside and outside
of stations and bypass-regulators providing a non-zero ﬂow
through the compressor. Parallel and serial connections of
compressors can also create solution ambiguities, detailed
below.
IV. SENSITIVITY AND PRINCIPAL COMPONENT ANALYSIS
Below, Sensitivity Analysis and Principal Component Anal-
ysis of gas transport simulations will be considered.
A. Sensitivity Analysis
Determining the sensitivity of a model to changing param-
eters is a standard tool for in-depth analysis of simulation
results. Usually it consists in the computation of sensitivity
matrix Sx
ij = ∂xi/∂pj, deﬁned in terms of partial derivatives,
along with the Jacobi matrix Jij = ∂yi/∂xj and the sensitivity
of the equations in terms of the parameters Sy
ij = ∂yi/∂pj.
Here x are model variables that also represent the simulation
result, p are model parameters, y are equations in terms of
which the model is formulated. With a small number of
parameters, the derivatives can be found using the numerical
differentiation algorithm:
init: simulate p → x
for j=1,num(p) do
variate parameter ˜pj = pj + dpj
simulate ˜p → ˜x
differentiate Sx
ij = (˜xi − xi)/dpj
done
or a similar algorithm with the choice of the central differ-
ence scheme. The differentiation step dpj must be chosen
reasonably, it must be small enough that the variation of dxi
can be considered linear, and large enough that this variation
exceeds the numerical error of the simulation result. It is
usually sufﬁcient to perform several variations of different
orders and verify that these properties are satisﬁed, using 1D
plots ˜xi(dpj) for several key variables. The ‘for’ loop in this
algorithm can be parallelized on several processors, providing
a signiﬁcant speedup for the analysis procedure. Alternatively,
if there is an access to derivatives of equations with respect to
variables and parameters, the sensitivity matrix can be found
by solving the linear system
X
j
(∂yi/∂xj)(∂xj/∂pk) + ∂yi/∂pk = 0,
(28)
X
j
JijSx
jk + Sy
ik = 0,
(29)
which does not require additional simulations. However, often
the simulation algorithm is encapsulated inside a software
module where information about derivatives is not available.
Also, sometimes the simulation algorithm is not a classical
solution of a uniﬁed system of equations, but includes external
iterations, relaxation procedures and/or calls to external ‘black
box’ software modules. In this case, only the numerical
differentiation algorithm described above remains for SA.
97
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

B. Principal Component Analysis
In the case of a large number of variables, equations and/or
parameters, it makes sense to use PCA. In this approach,
several components can be calculated, represented as linear
combinations of variables that make the main contribution to
the relations of the considered model. Technically, Singular
Value Decomposition (SVD) of the respective matrices is
performed for this purpose. Here we illustrate the application
of PCA/SVD to the Jacobi matrix: J
= uλvT , with a
diagonal matrix λ and orthogonal matrices u and v. The largest
eigenvalues λ correspond to the strongest dependencies. In
this case, the corresponding left eigenvectors, columns of the
u matrix, correspond to most rapidly changing combinations
of y equations, and the right eigenvectors, columns of the v
matrix, correspond to combinations of x variables with the
strongest dependencies. To study the stability of numerical
solution algorithms, it is also useful to know the smallest
eigenvalues λ, which correspond to the weakest dependencies.
In this case, the left eigenvectors represent linear combinations
of equations that change little at a normalized change of all
variables, and the right eigenvectors represent combinations of
variables on which all equations weakly depend.
In the presence of small eigenvalues, algorithms for solving
nonlinear systems, such as Newton’s method, lose their conver-
gence [11]. Mathematically, at a zero eigenvalue, the solutions
of a linearized problem lose their uniqueness – the solutions
either disappear or a continuous set of equivalent solutions
appears. In practice, the solution of nonlinear systems is
made with some given accuracy, which deﬁnes the ball of
admissible solutions in the y-space, |y| < toly, using the
l2-norm. The preimage of this ball in x-space is the error
ellipsoid, dx = J−1y. The SVD of J-matrix determines
the sizes of the semiaxes of the ellipsoid |δxi| = toly/λi,
while the right eigenvectors determine the orientation of the
ellipsoid. For small eigenvalues, a strongly prolate ellipsoid
arises corresponding to large x-errors, and in the λ → 0 limit,
to indifferent directions in the x-space.
Note that the error ellipsoid with large semiaxes is an indica-
tor of instability in the solution of the problem. With variations
in the problem statement, such as the choice of a starting
point, parameters of iterative procedures, as well as with small
variations in the free parameters of the modeling, the number
of performed iterations may change. In this case, the end point
makes jumps inside the y-ball, in practice can be considered
random. As a result, the solution of the problem randomly
changes within the x-ellipsoid. Large random variations of the
solution indicate the ambiguity, which manifests both at the
modeling level and in the physical system itself.
Application of PCA/SVD methods in gas transport problems
was carried out in our recent work [3]. Here we will review
the main results, now including the implementation details and
modes of usage of these methods.
Implementation of PCA for large scale problems: large
problems are usually represented by sparse matrices. The
technical difﬁculty of SVD for large sparse matrices is that the
result is generally a dense matrix, which makes computation
time and memory requirements problematic. In special cases,
when it is required to calculate not all, but only a few largest
or smallest eigenvalues and the corresponding eigenvectors,
there are algorithms that can keep the problem in a sparse
class and represent the result in an economical form.
We use Mathematica V12 for the described calculations,
where
the
standard
SingularValueDecomposition
method is available. For full decomposition this method con-
verts sparse matrices to dense by default. In a special case,
if not all eigenvalues are required, but a small number of the
highest ones, the method works in the sparse class. However,
our analysis does not require the highest, but the lowest values,
with which, according to the description, the method does not
work.
This problem can be resolved as follows. Computing the
product JT J, we get a sparse symmetric positively semi-
deﬁnite matrix. Its eigenvectors coincide with the columns of
the v-matrix, and its eigenvalues coincide with the squares of
the SVD eigenvalues. For this matrix, in Mathematica V12
one can use the Eigensystem method, which works for
the sparse case and allows one to restrict the computation
to several lowest eigenvalues and corresponding eigenvectors.
The same method, Arnoldi iterations, is used in Arpack system.
To ﬁnd u-vectors, one can ﬁnd the product JJT and repeat
the decomposition.
Note that for nonlinear systems, the linearization-based error
estimate gives only an approximate result, more accurate for
small δx and less accurate for large ones. For piecewise linear
systems, this estimate is valid up to the cell boundary, where
exact linearity is maintained.
Usage of PCA: according to the analysis, the result of
simulation turns out to be not just a point in the space of
variables, but a point with an error ellipsoid. This makes
it possible to classify variables into more / less accurately
deﬁned and possibly completely inaccurately deﬁned due to
degenerations in the system. Other types of analysis should
also take into account this information. For example, in the
above considered SA, it may turn out that some variables
undergo strong changes, jumps with a continuous change in
parameters. This may not mean that these variables are highly
sensitive to parameters, but that they change randomly within
the error ellipsoid.
Another example of using PCA is the comparison of simu-
lation vs experiment. The measurements have their own error
ellipsoid, simulation and experiment results are compatible if
these ellipsoids intersect. In practice, it is necessary to check
the correspondence also at the 2-3-σ level and increase the
ellipsoids by the appropriate factor.
Likewise, when comparing simulation results from two
different solvers, one must check the intersection of their
error ellipsoids. In the case if it is known in advance that
the modeling used in the two solvers is the same, then it is
enough to check that the |y| < toly condition is satisﬁed for
both of them, then both solutions will automatically belong
to the common error ellipsoid. If it is not known whether
98
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Fig. 3.
Instabilities in gas transport problems: (a) undeﬁned intermediate
pressure in serial connection of SM-compressors; (b) undeﬁned ﬂow balance
in parallel connection of SPO-compressors; (c,d) extended versions of the
instabilities. Images from [3].
the modeling is the same, then cross-validation should ﬁrst
be carried out, substituting the answer of one solver into the
evaluation function of another. If the |y| < toly condition is
violated, then it is possible to ﬁnd out which y-components
have large deviations, thus, which aspects of modeling differ
between the solvers.
V. SOLVING NEARLY DEGENERATE SYSTEMS
As shown by the theoretical analysis and the numerical
experiments below, stationary gas transport problems can
possess instabilities. They are associated with the modeling of
control elements, such as the compressors. While the advanced
modeling is usually stable, the source of instabilities is the free
model.
The simplest types of instabilities were discussed in [3] and
shown here in Figure 3. In case (a), two serially connected
SM compressors are considered. For such compressors, the
control equation (3) is set to the value of speciﬁed mass ﬂow,
QH = SM. Since the ﬂow through the compressors is the
same, the equation Q = SM is applied twice, which leads
to the degeneration of the system. Because one equation is
actually wasted, one continuous degree of freedom appears in
the solution of the system. This degree of freedom corresponds
to an undeﬁned value of pressure between the compressors,
which is not constrained by any equations. In case (b) there
are two parallel SPO compressors. For such compressors, the
equation for output pressure is doubled, Pout = SPO, the ﬂow
balance dQ through the compressors is undeﬁned. In these two
cases, the instability is localized within the compressor station.
Instability can also go beyond the station. In case (c) there is
a resistive subsystem between the two SM compressors, in
which the pressure values appear to be undetermined. In case
(d), two SPO compressors with a common output produce ﬂow
imbalance over wide areas of the network.
The situation is complicated by the following factors.
The compressors do not have to be of the predeﬁned type
SPO/SPI/SM. They may formally belong to another type, but
be on one of the faces of the surface for free model Figure 2, a
face that actually corresponds to the conﬂicting type. Thus, the
conﬂict may include faces corresponding to PH = POMAX
and PL = PIMIN; QH = QMAX and QL = QMIN = 0,
etc. The presence of the advanced part of the modeling does
not solve the problem, since the advanced model (8) contains
all the faces of the free model (3), which continue to generate
conﬂicts on solutions. Other control elements that have similar
modeling (regulators, ﬂaptraps, etc.), as well as nodes with
a ﬁxed pressure or ﬂow (Pset, Qset) can also participate in
the conﬂicts. It is clear that it is impossible to foresee all
conﬂicting combinations of faces in the control equations, due
to combinatorial reasons. We have to look for special methods
for solving degenerate systems that could be applied to this
case. The potentially useful methods have been brieﬂy listed
in [3], now we consider them in full detail.
Regularization: is performed by the ϵ-term in free model
equation (3). The reason for its introduction is that the equation
at ϵ = 0 satisﬁes the signature condition (1) only marginally,
some derivatives vanish. The geometric interpretation of this
is that the normals to the faces of the polyhedron shown on
Figure 2 left are directed strictly along the axes, although
they should be directed inside the octant described by the
condition (1). Such marginality leads to degeneracy of the
Jacobi matrix, ambiguity of solutions, bad condition numbers,
and other troubles for the numerical solution procedure. The
introduction of a regularizing ϵ term formally eliminates this
problem by making the condition (1) strictly satisﬁed. At the
same time, adjusting this parameter represents a compromise
between the physical accuracy and the numerical stability of
the solution procedure. In practice, the values ϵ = 10−6...10−3
are tolerable, meaning the relative violation of, e.g., SPO-
condition, up to 0.1%, simultaneously keeping the convergence
rate near 100%.
Relaxed Armijo rule: it is clear that part of the problem
is related to the line search algorithm [11]. According to this
algorithm, in the process of system solving, a step is taken
along the Newtonian direction dxN = −J−1y, not completely,
but so that the residual of equations |y| made a sufﬁcient
reduction. In [7], it was proposed to relax this requirement,
allowing a controlled small increase of residual in nearly
degenerate cases. Indeed, in practice this leads to a drastic
improvement in the stability of the algorithm and a decrease
in the number of iterations. The drawback is that, in rare cases,
Newtonian iterations go in cycle. Theoretically, the conditions
for the convergence of Newtonian iterations [11] require the
exact fulﬁllment of the Armijo rule. Thus, the rule relaxation
99
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

is an empirical method that often improves convergence in
degenerate problems, but does not work in 100% of cases.
Topological reduction: the method described in [7] makes
it possible to contract parallel and serial stations, eliminating
the degenerate degrees of freedom contained in them, which
leads to an increase in the stability of the solution algorithm.
However, this method only works for local conﬂicts and cannot
resolve the extended ones.
Dynamical problems: algorithms for integrating dynam-
ical systems used to obtain stationary states can be more
stable than the straightforward solution of stationary problems.
Indeed, Pundef-conﬂicts can be resolved, since the intermedi-
ate pressure values are determined by the starting point and
the integration process. These values are still arbitrary, but
this arbitrariness does not complicate the process of ﬁnding
a solution. Qundef-conﬂicts can be resolved similarly by
including the corresponding kinetic terms in the equations.
Homotopic methods: this class of methods [20] considers
the deformation of equations from some simple solvable form
to the required form, in which the trajectory of the solution
is continuously tracked. For example, the linear deformation
y = y0(1 − α) + y1α can be used, with α ∈ [0, 1]. The
problem with such methods is the possible appearance of a
fold in the equations, leading to a loss of the solution. In
our particular case, when using regularization, the required
equations are guaranteed to have a unique solution. As an
auxiliary form, one can use a linear non-degenerate system,
which also has a unique solution. However, this does not mean
that the mixed system will also have a unique solution. It is
easy to construct examples of matrices that have a determinant
of one sign, for which a linear combination with positive
coefﬁcients has a determinant of another sign, or equal to
zero. In this case, it makes sense to use the structure of the
system, for example, do not touch the Kirchhoff equations and
deform only the equations of the elements. It is clear that only
singular equations need to be deformed, since the rest keep the
Jacobi matrix nondegenerate and present no problems. Then
this method becomes equivalent to our ϵ-regularization with a
gradual decrease in the ϵ parameter. Theoretically, this method
in its last stage is unstable, since an increasingly degenerate
system is being solved. Our numerical experiments presented
below show that the described homotopy method works as a
stabilizer, although not in 100% of cases.
Note also that the linear deformation of equations described
above is only the simplest version of the homotopic method.
The work [20] offers tools to overcome rank J = n − 1
degeneracy by extending J from n × n to n × (n + 1) full-
rank matrix. However, our system typically have multiple zero
eigenvalues. The described methods do not seem to work
immediately for this case, at higher order degeneracy requiring
an increasingly complex parameterization.
Piecewise linear systems: for such systems, the space
of variables is divided into polyhedral cells, in each the
system is linear, with continuous connection at the boundaries.
For such systems, there are methods that allow ﬁnding a
solution in a ﬁnite number of steps, see [8]–[10] and also
[20] Chap. 12-15. It is noteworthy that some of these methods
work even if the system is piecewise degenerate. In algorithm
[9], it is proposed to follow the Newtonian direction in non-
degenerate cells, or opposite one, dependently on the sign
of Jacobian. In degenerate cells, it is proposed to follow the
right annulator of the system matrix. Each time, the movement
should stop at the border of the next cell. Such algorithm has
theoretically guaranteed convergence [9]. For our applications,
this algorithm should be extended to nonlinear systems. The
annulators can be found using fast procedures (Mathematica,
Arpack).
Pseudo-inverse: a related SVD-based algorithm is the
procedure for ﬁnding the Newtonian step dxN = −J−1y
with elimination of zero eigenvalues, see Chap. 2.6 in [21].
In practice, to ﬁnd the pseudo-inverse J−1, after SVD, all
non-zero eigenvalues are replaced by inverse λ → λ−1,
and zero ones remain unchanged: 0 → 0. If the problem
would be globally degenerate, this procedure would provide
sliding along a trajectory orthogonal to the annulators, ignoring
degenerate combinations of equations and unstable variables,
concentrating only on changing the essential variables in the
system. It is not known whether there is a generalization of
this algorithm to the nonlinear piecewise degenerate case, that
is of interest for our applications.
Among the described methods, the empirical approach with
ϵ-regularization, relaxed Armijo rule and optional error calcu-
lation by PCA method works satisfactorily in practice. Among
the most promising approaches, we consider the extension of
the described methods to dynamic problems.
VI. NUMERICAL EXPERIMENTS
A number of numerical experiments have been performed
to test the performance of above described methods.
A. Test networks
We use the stabilized Newton algorithm described in [4] to
solve the gas transport problems on the following networks. A
small network N1 has been created by us to test functionality
of various elements, shown in Figure 4 on the top. A medium
size network ME, created in frames of the project MathEnergy,
containing all features of realistic networks, shown in Figure 4
on the center. A set of large scale realistic networks N85,
given to us by our industrial partner for benchmarking of
the methods. The main parameters of all test networks are
contained in the Table III.
B. Test of piston and generic compressors
Since their implementation is a main contribution of the
paper, we have tested the stability and performance of the
solver for the networks containing such elements. In particular,
the network N1 has 100 nodes and 111 edges, of which 4
compressors are organized into two compressor stations c1|2
and c3|4 with individual compressors connected in parallel, as
shown in Figure 4 at the bottom. Compressors in station c1|2
are conﬁgured as piston ones, in station c3|4 as generic ones.
100
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

TABLE III
PARAMETERS OF TEST NETWORKS [2]
network
tot.num.
nodes
edges
pipes
compressors
regulators
Psets
Qsets
N1
1
100
111
34
4
4
2
3
ME
1
437
482
370
20
24
3
164
N85/L
23
3232-3886
3305-3974
2406-2835
1-7
59-77
6-7
625-843
N85/H
62
2914-3818
2989-3952
1498-1937
16-42
59-107
5-9
328-505
Values PH, QH are set to unreachable high values, thereby
activating the fi patches described above.
The procedure consists of several phases with a gradual
increase in the modeling level. At ﬁrst, the compressors are
set to fulﬁll the main target values, e.g., P = PH, then
the modeling level (3) is used, taking into account additional
conditions, then the modeling level (8) is taken. The solution
procedure described in [5] consists of the translation phase
of the system from the network description language to the
language understood by the numerical solver, and the actual
numerical solution phase. In this test, approximately the same
results are obtained if turbocompressors are used instead
of piston/generic ones. These numerical experiments show
that the inclusion of piston and generic compressors in the
system does not lead to any divergences or slowdown of
the solution procedure, which is a direct consequence of the
implementation of the stability criteria described above.
We also performed numerical experiments with test net-
works from N85 set. This set contains 85 networks with com-
plexity up to four thousand nodes and up to 42 compressors.
Among them are multiple piston and generic compressors,
in parallel and series connections. We have found that the
presence and placement of such compressors does not affect
performance in any way, and this is consistent with the
convergence conditions we developed.
C. Test of ϵ-homotopy
The dependence of the convergence of network problems
on the ϵ-parameter was investigated in [3] on N85 networks
for free compressor setting. In the present work, we have
carried out such a study for advanced compressors. In addition,
we have included an external iterative loop in the solution
algorithm, the so-called mix-iteration, in which the gas com-
position, temperature, parameters of the reﬁned equation of
state, etc. are calculated. Here we have taken the opportunity
to explore a simple homotopy algorithm by inserting parameter
division into the mix-iteration: ϵ → ϵ/q, q > 1. The simulation
results are shown in Tables IV and V. In accordance with
the above considerations, as the ϵ-parameter decreases, the
problem becomes more and more degenerate. In total across
all N85 networks, the number of divergent scenarios and the
computation time increase with decreasing ϵ-parameter. For
the homotopy algorithm, we performed two numerical exper-
iments. Both started at ϵ = 10−3 and ran 10 mix-iterations.
In one experiment, q = 2 was chosen and the homotopy was
carried out up to the value ϵ ∼ 10−6. The algorithm is slightly
more stable, leaving divergent 2 scenarios out of 85, compared
to simply ﬁxing ϵ to a ﬁnal value, which makes divergent 3
scenarios. In the second experiment, q = 4 was chosen and the
division was carried out up to the deeper value ϵ ∼ 10−9. Here,
the homotopy algorithm turns out to be much more stable,
although it still leaves divergent 10 scenarios out of 85. Since
the value of ϵ = 10−6 is sufﬁcient for practical purposes, we
conclude that the described homotopy algorithm stabilizes the
solution of the problem, with moderate success.
D. Sensitivity Analysis of N1 network
It is carried out by us in order to test the algorithm described
above and the software module based on it. For this test,
in each of the two compressor stations c1|2 and c3|4, one
compressor was conﬁgured as speciﬁed output pressure (SPO),
the other as speciﬁed mass ﬂow (SM). The results are shown
in Figure 5. In case (a), input pressure in n99 supply is
changed for 1 bar. The resulting variation of pressure does
not propagate beyond the nearest compressor station c3|4. In
case (b), SPO in c1 compressor is changed for 1 bar. The
change propagates further to the network. The maximum dP
is reached in the consumer n76. The increase of dP is due
to nonlinearity of pipe friction law. In case (c), SM in c4
compressor is changed for 2%. The result corresponds to a
different balance of ﬂows in the network, while the pressure
is changed insigniﬁcantly.
Thus, the application of SA to the N1 network shows that
of the three parameter variations considered, the resulting
pressure in the network is sensitive to only one parameter,
SPO in c1 compressor.
E. Principal Component Analysis of ME network
It is carried out to test the performance of the method on
a larger network than in our earlier study [3]. This early
study looked at N1 network with compressors in free SPO
mode. There, PCA revealed two small eigenvalues that varied
proportionally to the ϵ parameter and corresponded to conﬂicts
within the stations. A larger small eigenvalue was also found,
corresponding to an extended conﬂict between compressor
stations. In the current work, for the ME network, we obtain
101
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Fig. 4. On the top: test network N1; in the center: test network ME; at the bottom: the structure of parallel compressor station. Images from [2], [4].
102
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Fig. 5. Sensitivity Analysis, for N1 network.
103
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

TABLE IV
CONVERGENCE FOR FIXED ϵ, N85 NETWORKS
ϵ
total div.
total time*
10−3
1
84
10−6
3
117
10−9
40
533
* in minutes, for Intel i7 / CPU 2.6 GHz / RAM 16 GB computer.
TABLE V
CONVERGENCE FOR ϵ-HOMOTOPY, N85 NETWORKS
q
total div.
total time*
2
2
87
4
10
98
ϵ = 10−3/qn, n = 0...10
* in minutes, for Intel i7 / CPU 2.6 GHz / RAM 16 GB computer.
the results presented in Tables VI-VIII. Initially, the value of
the parameter ϵ = 10−3 was selected, all compressors were
set to free SPO mode.
The results obtained indicate another type of conﬂict, that
is related to pipes. The lowest eigenvalue corresponds to a
cycle of two pipes with lengths and diameters Lp0618 = 118m,
Dp0618 = 0.6m, Lp0643 = 120m, Dp0643 = 0.9m, possessing
a zero ﬂow. The next largest eigenvalue corresponds to a cycle
of three pipes with lengths Lp0110 = 136m, Lp0765 = 1917m,
Lp0766 = 1967m, common diameter D = 0.8m and a small
ﬂow m ∼ 0.1 kg/s. The left eigenvectors correspond to an
indeﬁnite ﬂow circulating in cycles. The right eigenvectors
for a given associated with pipes conﬂict are the same as
the left ones. They correspond to the sum of equations taken
over the cycle, which in leading order have the form [4]:
P1|P1| − P2|P2| = RqQ|Q|. When such a sum is taken,
the P-terms disappear, leaving only the sum of the Q-terms
(Kirchhoff’s second law). The reason for the degeneracy is
the low resistance Rq for short and thick pipes. Also, due to
the quadratic dependence on Q, additional suppression occurs
for small ﬂows. Note that the complete expression for the
friction equation in pipe also contains a laminar term. This
term is linear in Q, but its value is insufﬁcient to stabilize
the system at low ﬂows. Possible ways to solve this problem
can be: artiﬁcial increase of the laminar term, similar to ϵ-
regularization; replacing short pipes with shortcuts followed
by contraction [6]; topological reduction of serial and parallel
connections of pipes [7].
At higher eigenvalues, there are similar pipe-conﬂicts, while
the conﬂicts associated with compressors and regulators also
begin to occur. As the regularizing parameter decreases to
ϵ = 10−6, one of these conﬂicts descends from the high
eigenvalues λ = 4.29 · 10−4 → 4.29 · 10−7, proportionally
following the change in ϵ by three orders of magnitude. At
the same time, the eigenvalues and vectors of pipe-conﬂicts
change little. This new conﬂict corresponds to the compressor
and regulator connected by a series of 4 pipes with a total
length of 35 km. On the solution, the compressor and regulator
are closed, have zero ﬂow. In this case, the pressure in the
intermediate segment is undeﬁned. Thus, the described conﬂict
belongs to the extended type (c), shown on Figure 3.
In the simulations under consideration, the accuracy pa-
rameter toly = 10−5 is used. The found eigenvalues corre-
spond to the error in the x-space according to the formula
|δxi| = toly/λi. In our simulations, the range of operating
values of pressures and ﬂows is in the order of P = 0−100 bar,
Qm = 0 − 100 kg/s. Now it is clear that the ﬁrst eigenvalue
gives an error exceeding this range, and the corresponding
degree of freedom is completely undeﬁned. For the next
eigenvalue, the error is about 4% and further decreases to
< 1%. Note also that for higher eigenvalues, the eigenvectors
are distributed over a large number of elements, and the error
in each element is even smaller.
Thus, an application of PCA to the ME network appears to
be useful, bringing additional knowledge about the new type
of conﬂicts, conﬁrming the conclusions about the ϵ-regulated
instabilities, and making a differentiated estimation of the
simulation error for different degrees of freedom present in
the solution.
104
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

TABLE VI
THE LOWEST EIGENVALUE AND RELATED PRINCIPAL COMPONENTS, FOR ME NETWORK
λ1
|δx1|
δQm,p0618
δQm,p0643
eqp0618
eqp0643
2.56 · 10−8
390
-0.707
-0.707
-0.707
-0.707
TABLE VII
THE SECOND LOWEST EIGENVALUE AND RELATED PRINCIPAL COMPONENTS, FOR ME NETWORK
λ2
|δx2|
δQm,p0110
δQm,p0765
δQm,p0766
eqp0110
eqp0765
eqp0766
2.46 · 10−6
4.06
0.589
0.571
0.571
0.589
0.571
0.571
TABLE VIII
THE NEXT LOWEST EIGENVALUES, FOR ME NETWORK
λ3
|δx3|
λ4
|δx4|
λ5
|δx5|
λ6
|δx6|
1.38 · 10−5
0.725
2.10 · 10−5
0.477
2.59 · 10−5
0.386
2.63 · 10−5
0.380
VII. CONCLUSION
In this work, modeling of piston and generic type gas
compressors was carried out. The signatures of the derivatives
of the control equation are analyzed, the ranges of parameter
values are identiﬁed, under which the conditions for the stable
operation of the algorithm for solving stationary network
problems are satisﬁed. After the practical implementation
of the modeling, in numerical experiments on realistic gas
networks, the convergence of the solution algorithm is shown.
In addition, an extended review was made of results on
turbine type compressors, methods of Sensitivity and Principal
Component Analysis applied to gas transport networks, meth-
ods for solving nearly degenerate nonlinear systems. A number
of new numerical experiments were carried out on realistic
scenarios of a stationary type, representing the application of
these methods. In particular, it is shown that regularization
methods, relaxed line search and ϵ-homotopy have a stabilizing
effect on the solution procedure. Sensitivity and Principal
Component Analysis show areas of increased system respon-
siveness to parameter variations and solution procedure setups.
In addition to the already known conﬂicts associated with the
compressor stations, there are ﬂow ambiguities in cycles of
short pipes. All the effects observed in numerical experiments
are in agreement with the theoretical analysis.
Our future plans include extending the described methods
to dynamic problems.
ACKNOWLEDGMENT
The work has been supported by the project TransHyDE-
Sys, grant 03HY201M.
REFERENCES
[1] A. Baldin et al., “Solving Stationary Gas Transport Problems with
Compressors of Piston and Generic Type”, in Proc. of INFOCOMP
2022, International Conference on Advanced Communications and Com-
putation, pp. 1-5, IARIA, 2022.
[2] A. Baldin et al., “AdvWarp: a transformation algorithm for advanced
modeling of gas compressors and drives”, in Proc. of SIMULTECH
2021, International Conference on Simulation and Modeling Method-
ologies, Technologies and Applications, pp. 231-238, SciTePress, 2021.
[3] A. Baldin et al., “Principal component analysis in gas transport simula-
tion”, in Proc. of SIMULTECH 2022, International Conference on Sim-
ulation and Modeling Methodologies, Technologies and Applications,
pp. 178-185, SciTePress, 2022.
[4] T. Clees, I. Nikitin, and L. Nikitina, “Making network solvers globally
convergent”, Advances in Intelligent Systems and Computing, vol. 676,
2018, pp. 140-153.
[5] T. Clees et al., “MYNTS: Multi-phYsics NeTwork Simulator”, in Proc.
of SIMULTECH 2016, International Conference on Simulation and
Modeling Methodologies, Technologies and Applications, pp. 179-186,
SciTePress, 2016.
[6] T. Clees, I. Nikitin, L. Nikitina, and L. Segiet, “Modeling of gas com-
pressors and hierarchical reduction for globally convergent stationary
network solvers”, International Journal On Advances in Systems and
Measurements, vol. 11, 2018, pp. 61-71.
[7] A. Baldin, T. Clees, B. Klaassen, I. Nikitin, and L. Nikitina, “Topological
reduction of stationary network problems: example of gas transport”,
International Journal On Advances in Systems and Measurements, vol.
13, 2020, pp. 83-93.
[8] J. Katzenelson, “An algorithm for solving nonlinear resistor networks”,
Bell System Technical Journal, vol. 44, 1965, pp. 1605-1620.
[9] M. J. Chien and E. S. Kuh, “Solving piecewise-linear equations for resis-
tive networks”, International Journal of Circuit Theory and Applications,
vol. 4, 1976, pp. 1-24.
[10] A. Griewank, J.-U. Bernt, M. Radons, and T. Streubel, “Solving
piecewise linear systems in abs-normal form”, Linear Algebra and its
Applications, vol. 471, 2015, pp. 500-530.
[11] C. T. Kelley, Iterative Methods for Linear and Nonlinear Equations,
SIAM, Philadelphia, 1995.
[12] J. Mischner, H. G. Fasold, and K. Kadner, System-Planning Basics of
Gas Supply, Oldenbourg Industrieverlag GmbH, 2011 (in German).
105
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

[13] M. Schmidt, M. C. Steinbach, and B. M. Willert, “High detail stationary
optimization models for gas networks”, Optimization and Engineering,
vol. 16, 2015, pp. 131-164.
[14] J. Nikuradse, “Laws of ﬂow in rough pipes”, NACA Technical Memo-
randum 1292, Washington, 1950.
[15] C. F. Colebrook and C. M. White, “Experiments with ﬂuid friction in
roughened pipes”, in Proc. of the Royal Society of London, Series A,
Mathematical and Physical Sciences, vol. 161, num. 906, 1937, pp. 367-
381.
[16] P.
Hofer,
“Error
evaluation
in
calculation
of
pipelines”,
GWF-
Gas/Erdgas, vol. 114, num. 3, 1973, pp. 113-119 (in German).
[17] J. Saleh, Fluid Flow Handbook, McGraw-Hill 2002.
[18] DIN EN ISO 12213-2: Natural Gas - Calculation of Compression Factor,
European Committee for Standardization, 2010.
[19] O. Kunz and W. Wagner, “The GERG-2008 wide-range equation of state
for natural gases and other mixtures: an expansion of GERG-2004”, J.
Chem. Eng. Data, vol. 57, 2012, pp. 3032-3091.
[20] E. L. Allgower and K. Georg, Introduction to Numerical Continuation
Methods, SIAM, Philadelphia, 2003.
[21] W. H. Press, B. P. Flannery, S. A. Teukolsky, and W. T. Vetterling,
Numerical Recipes in C, Cambridge University Press 1992.
106
International Journal on Advances in Systems and Measurements, vol 15 no 3 & 4, year 2022, http://www.iariajournals.org/systems_and_measurements/
2022, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

