Automatic Mesh Size Estimation in DVC for Images of Isotropic Materials
Zaira Manigrasso∗, Jan Aelterman∗, and Wilfried Philips∗
∗Department Telecommunications and Information Processing
Ghent University, Ghent 900, Belgium
Emails: {Zaira.Manigrasso, Jan.Aelterman, Wilfried.Philips}@UGent.be
Abstract—When non-rigid Digital Image Correlation or Digital
Volume Correlation (DIC/DVC) is performed, it is critical to
correctly set the parameter that determines the control point
spacing for the grid on which deformation is deﬁned. In this
paper, we present a method to automatically estimate the best
performing grid spacing parameter for DIC/DVC registration.
The operating principle is that the optimal grid spacing parame-
ter is a function of the image content; it may be estimated through
determining the dominant feature/object size. In order to extract
the information about the objects size, ﬁrst, the image volume has
been segmented, then the disconnected objects inside the image
have been detected (using a labeling technique) and, lastly, a
classiﬁcation of the objects has been made based on the number
of the voxels of each object. The reason for this study arises from
the practical necessity of ﬁnding the best performing parameter
for registration in materials sciences research. We show how an
erroneous setting of the density of the control points leads to
inaccurate registration. Furthermore, we demonstrate how the
parameter predicted by our algorithm is indeed optimal, both in
a quantitative sense, using Normalized Cross Correlation (NCC)
as a measure, as well as qualitatively.
Keywords–DIC/DVC; B-spline transformation; Grid size estima-
tion.
I.
INTRODUCTION
Digital Image Correlation (DIC) and Digital Volume Corre-
lation (DVC) are measurement techniques that make it possible
to track 2D and 3D deformations in images. These methods
are typically used to obtain the full deformation and strain ﬁeld
[1]. In this paper, we use a DVC global approach, based on
B-splines, to estimate non rigid deformations between micro
Computer Tomography (micro-CT) 3D images. The deforma-
tion is calculated on a regular grid of control points deﬁned
by the spacing between the grid nodes. An incorrect choice of
grid size negatively impacts not only the ﬁnal deformation and
strain computation [2], but also the computational time, which
is linearly related to the number of the grid control points [3].
The displacement between images is characterized by
global and local deformation. The global deformation is the
perceived direction of the dynamic of the objects. Such direc-
tion is the result of a combination of many individual local
deformations, and, in the case of non rigid motion, the local
deformations have different magnitudes and directions [3][4].
With a coarse grid (large space between the grid nodes), it
is only possible to describe global and smooth deformations,
however, with a ﬁne grid spacing, it is also possible to describe
local and less smooth deformations [3][5]. The use of a coarse
grid size is beneﬁcial as it allows to avoid converging to
overly non-smooth (and usually incorrect) solutions. By using
a ﬁner grid size, the potential to converge to a local optimum
increases. The choice of the grid size is usually user dependent,
however, self adapting methods have been proposed in order
to reduce the dependency of the results on the user’s input
and in order to improve the deformation and strain accuracy
TABLE I. THE BEST PERFORMING GRID SIZE FOR EACH DATASET
WITH THE RELATIVE NCC VALUE RESULTED FROM DVC
Aluminum foam
Leavening dough
Lede stone
Optimal grid size [voxels]
37
22
40
NCC
0.992
0.995
0.991
[3][6][7]. These works introduce iterative methods for mesh
reﬁning. In [6], the iterative reﬁnement is based on the concept
of residual error, instead, in [3] the authors introduce a multi-
level approach. For each level, they introduce a control point
status associated with each control point, marking it either
active or passive. The state is associated with the value of
a similarity metric. In [7], the self-adapting algorithm affects
the order of the elements of the grid and not their dimensions.
In this paper, we investigate the idea that, for isotropic
materials, the optimal grid size is a function of the image
content in a way that the motion of small objects inside the
images is better tracked using a ﬁne grid and, vice versa, a
coarse mesh can better deﬁne the motion of larger objects.
Since the B-spline transformation is based on a uniform grid
of control points, we tried to link the distance between control
points with the most dominant material structure dimension.
Our hypothesis is that the most frequently occurring material
structure dimension is a good predictor for the optimal grid
size in the non rigid DIC/DVC approach. In our study, we
applied DVC on six different datasets using a range of different
grid size parameters. What has emerged is not only that the
estimated deformation ﬁeld signiﬁcantly depends on the size
parameter, but also that the same grid size is not suitable for
all the datasets (Table I).
The rest of the paper is structured as follows. Section II
aims to describe the workﬂow to obtain the optimal grid size
spacing for non rigid DIC/DVC. In the Sections III and IV,
the details of the DVC experiment and the datasets used are
covered, respectively. Results, discussions and conclusion are
given in Sections V and VI.
II.
PROPOSED METHOD
This method operates from the principle that the optimal
grid spacing is a function of the image content. It assumes the
characteristic size of the most frequently occurring material
structure is indicative of the easiest tracking, as well as the
resolution at which deformation can be reliably tracked, and
it is, therefore, a good predictor for the optimal grid size in
DIC/DVC.
The method consists of 3 steps that are summarized
in Figure 1. The purpose of the ﬁrst step is to segment
the objects present in the images in order to measure the
size of each of them (Figure 1A). Once the segmentation
has been done and the histogram of the objects size
1
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-791-7
SIGNAL 2020 : The Fifth International Conference on Advances in Signal, Image and Video Processing

TABLE II. STONE SCANNING SETTINGS
Lede stone
Acquisition time
48 min
Voxel size
0.02 mm
Volume dimension
1014x1014x752
TABLE III. ALUMINUM FOAM AND LEAVENING DOUGH
SCANNING SETTINGS
Aluminum foam
Leavening dough
Acquisition time
14 min
30 min
Number of gantry rotation
60
75
Number of projection per rotation
700
800
Total compression per rotation
±133µm
-
Total compression
±8mm
-
Voxel size
0.02 mm
0.02 mm
Volume dimension
512x512x512
640x640x640
distribution has been created (Figure 1B), the grid size for the
image registration is set (Figure 1C). A detailed explanation
of each of the 3 steps is provided in the following subsections.
Figure 1. Flowchart of the method.
A. Connected-component labeling
Through labeling techniques, we start by distinguishing
different disconnected parts of a phase in the image. In micro-
CT, these parts represent characteristic small ”objects” (e.g.,
pores, bubbles, nodules). The input of the labeling algorithm
is the segmented dataset (binary image), where the voxels
belonging to the objects which we want to label are part of
the foreground voxels (label = 1) and all other voxels are
part of the background (label = 0). The labeling detects each
component of foreground voxels and assigns a unique label to
all voxels of each object. The labeling algorithm used [8] is
based on iterative recursion. The algorithm starts from (0,0,0)
voxels and ﬁnds the ﬁrst unlabelled voxel (label = 1) v1. A
cuboid sub-volume is created starting from v1 and all the
voxels inside the volume with label 1 are changed into the
label l if they are 26-connected to v1. For the border voxels of
the sub-volume, the procedure done to v1 is repeated until all
the voxels 26-connected to v1 are marked with l. At the end of
the ﬁrst iteration, the value of the label, l, is incremented by 1
and the algorithm ﬁnds the next unlabelled object voxel v2 and
repeats the same procedure done to v1. The resulted objects
are color labeled (different colors for different objects). For
each object, its size (in number of voxel) is calculated. Lastly,
a histogram that summarizes the number of objects of each
size is created.
B. Study of the object size distribution
Once the histogram has been created, the dominant object
size is taken as a good predictor of the grid spacing: the region
Figure 2. Plot of the registration performance expressed using NCC metric
as function of the grid size spacing. On the same graph, the distribution of
the objects size inside the image is shown.
2
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-791-7
SIGNAL 2020 : The Fifth International Conference on Advances in Signal, Image and Video Processing

around the peak of the histogram is the predicted value for the
grid spacing.
C. Grid spacing setting
Since in each dataset there are different structures/objects
with different dimensions, it is not possible to match all
the structures with an uniform grid, typical of B-spline
based DVC. The cells of the grid can be both cubic or
rectangular cuboid. For this experiment, cubic cells have
been used with the edge length given by the cubic root of
the most occurring object size (most numerous class) in voxels.
III.
EXPERIMENTAL SETUP
The experiment has the dual purpose of investigating the
inﬂuence of the different grid size settings on the deformation
estimate and of testing our hypothesis, which is that the
optimal grid size setting is related to the most frequently
occurring material structure size. The experiment evaluates
four different grid sizes, with the length of the edge of the
cubic cell given by the powers of 2 (23, 24, 25, 26). The
registration has also been performed with a cubic cell grid with
the edge length equal to the cubic root of the most occurring
object dimension inside the dataset. For each registration, the
NCC value was calculated in order to compare the results
quantitatively.
The chosen transformation is the B-spline. Among the
splines functions (e.g., Hermite, plate), B-splines is a popular
choice because of its properties of locality, continuity and
afﬁne-invariance [9][10]. Because the CT attenuation images
are based on the constancy of brightness, NCC is a suitable reg-
istration cost function. For minimising it, Adaptative Stochastic
Gradient Descent (ASGD) was used [11].
IV.
EXPERIMENTAL DATA
Six different micro-CT 3D datasets were used in this
experiment. Three of them are from different materials, ex-
hibiting different dynamics: compression of aluminum foam
(Table III), leavening of bread dough (Table III) and water
absorption of stone (Lede type) (Table II). To evaluate our
claims further, three additional datasets have been created
artiﬁcially, decreasing the resolution of the previous dataset
by a factor of 2 in the 3 dimensions.
The aluminum foam and the leavening dough dataset have
been acquired using the Environmental Micro-CT (EMCT)
scanner of the Ghent University Centre of X-ray Tomography
(UGCT). The Lede stone has been acquired using Tescan
CoreTOM. The ﬁrst two datasets have been acquired during
the deformation processes (dynamic scan), whereas the last
dataset has been acquired before and after the deformation
process (static scan).
V.
RESULTS
From the classiﬁed data and from their representation by
using the histogram, the most dominant object size for each
dataset has been extracted. In the case of aluminum foam, the
most numerous class, indicating the dimension of the objects
inside the image volume, corresponds to 373 voxels. To this
class belong 18 out of 76 objects (23.68%). Setting the cubic
grid size for DVC with the edge length of 37 pixels, the
NCC value reaches the peak of 0.992. It is clearly visible
Figure 3. Results of DVC with different grid size settings. (a)-(b): z-y slice
of the difference between transformed and reference image of the aluminum
foam at full resolution (512x512x512); (c)-(d): z-y slice of the difference
between transformed and reference image of the leavening dough at full
resolution (640x640x640); (d)-(e): z-y slice of the difference between
transformed and reference image of the Lede stone at full resolution
(1014x1014x752). The computational time is meant for one DVC iteration.
in Figure 2: the peak of the metric value coincides with the
peak of the classiﬁed data. From the histogram, it is visible
a range going from 163 − 403 where most of the objects
belong. The NCC value in this interval is high and decreases
signiﬁcantly for those grid size values for which the number
of objects inside the image with the same dimension is low
or even null. For the aluminum foam, the worst NCC value
corresponds to 83 (Figures 2 and 3(a)). In Figure 3, there is a
qualitative comparison between the registration with different
grid sizes. The most numerous class indicating the dimension
3
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-791-7
SIGNAL 2020 : The Fifth International Conference on Advances in Signal, Image and Video Processing

of the objects for leavening dough and Lede stone are 223 and
403, respectively. For the leavening dough, most of the objects
(73.33%) belong to the interval 153 − 303. At the extremes of
the range, NCC reaches the vales of 0.983 and 0.985, with a
peak of 0.995 in correspondence of the peak of the histogram.
For the Lede stone, the most likely interval is 243 − 483 with
73.33% , with NCC values at the extremes of the interval
of 0.989 and 0.954 and a peak of 0.991 corresponding to the
value of grid size of 403. As in the case of the aluminum foam,
the NCC value decreases considerably if there are no objects
which match the grid size. In the case of the leavening dough,
the worst registration result has been obtained with the grid
cell dimension of 643 (NCC = 0.965) (Figure 3(c)), followed
by the result obtained with the grid size of 83 (NCC = 0.975)
(Figure 2). The Lede stone dataset has low NCC value for grid
sizes of 83 (NCC=0.912) and 163 (NCC=0.913) (Figure 2 and
3).
To have more evidence about the validity of the proposed
method, the same experiment has been repeated on the same
datasets at lower resolution. The resolution has been decreased
by a factor of 2 along the three dimensions. According to
our hypothesis, the optimal value of the grid size should be
different from the previous value on the full resolution dataset.
Since the resolution has been decreased by a factor of 2, the
dimensions of the objects/structures inside the image are also
smaller and, therefore, the optimal distances between the nodes
of the grid are reduced by a factor of 2. The results of the
experiment are reported in Figure 4.
VI.
CONCLUSION
The study carried out in this paper conﬁrms our initial
hypothesis: the best performing value for the grid spacing
parameter is linked to the most occurring material structure
size. The advantage of this method compared with other
techniques present in literature [3][6][7] is that it is able to
give to the user prior information about the optimal grid size
ready to be used in many of the open source libraries and
commercial software for DVC.
With this research, we are not suggesting that this pa-
rameter optimization method is globally optimal, instead, we
suggest that it may be a practically useful heuristic to automate
DVC/DIC algorithms. Indeed, in a purely theoretical sense,
the optimal grid size decision should additionally depend on
the kinematics of the material sample, not just its structural
makeup. In this study, the nature of the deformation is not
taken in consideration, as it could be argued that it is unrealistic
anyhow to expect software to track motion ﬁelds that are erratic
on a ﬁner resolution scale than the ﬁnest resolution of the
visible structures.
With this study, we are able to give some guidelines for
the setting of the optimal grid spacing parameter for DVC/DIC
in order to be less user dependent. Furthermore, being an
automated method, it is possible to integrate it in a future
software for DVC.
ACKNOWLEDGMENT
This work was funded by the Research Foundation —
Flanders in the Strategic Basic Research Programme (FWO-
SBO), ﬁle number S003418N. The authors thank UGCT
(UGent, Centre for X-ray Tomography) for the aluminum foam
and leavening dough dataset, Dr. Tim De Kock (FWO post
Figure 4. Results of DVC with different grid size settings. (a)-(b): z-y slice
of the difference between transformed and reference image of the aluminum
foam at half resolution (256x256x256); (c)-(d): z-y slice of the difference
between transformed and reference image of the leavening dough at half
resolution (320x320x320); (d)-(e): z-y slice of the difference between
transformed and reference image of the Lede stone at half resolution
(507x507x376).The computational time is meant for one DVC iteration.
doctoral research fellow at the time of the acquisition) and
TESCAN-XRE for the dataset of Lede stone.
REFERENCES
[1]
B. Bay, T. Smith, D. Fyhrie, and M. Saad, “Digital Volume Correla-
tion: Three-dimensional Strain Mapping Using X-ray Tomography ,”
Experimental Mechanics, vol. 39, 1999, pp. 217–226.
[2]
F. Mortazavi, “Development of a global digital image correlation
approach for a fast high-resolution displacement measurements,” PhD
thesis, ´Ecole Polytechnique de Montr´eal., 2013.
[3]
J. Schnabel, “A generic Framework for Non-Rigid Registration Based
on Non-uniform Multi-level free-Form Deformations,” Medical Image
Computing and Computer-Assisted Intervention – MICCAI, 2001, pp.
573–581.
4
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-791-7
SIGNAL 2020 : The Fifth International Conference on Advances in Signal, Image and Video Processing

[4]
S. Klein, M. Staring, K. Murphy, M. Viergever, and J. Pluim, “elastix:
a toolbox for intensity based medical image registration,” IEEE Trans-
actions on Medical Imaging, vol. 29, 2010, pp. 196–205.
[5]
L. Zhang, M. Li, and F. P. Hou, W., “Registration of Lung CT Images
Using B-spline Based Free-Form Deformation,” IEEE International
Conference on Progress in Informatics and Computing (PIC), 2018.
[6]
X. Wang and S. Ma, “Mesh-Based Digital Image Correlation Method
Using Non-Uniform Elements for Measuring Displacement Fields with
High Gradient,” Experimental Mechanics, vol. 54, 2014, pp. 1545 –
1554.
[7]
L. Wittevrongel, S. Lava, P. Lomov, and D. Debruyne, “A Self Adaptive
Global Digital Image Correlation Algorithm,” Experimental Mechanics,
vol. 55, 2014, pp. 361–378.
[8]
Q. Hu, G. Qian, and W. Nowinski, “Fast connected-component labelling
in three-dimensional binary images based on iterative recursion,” Com-
puter Vision and Image Understanding, vol. 99, 2005, pp. 414–434.
[9]
L. Piegl and W. Tiller, The NURBS book.
Springer Science Business
Media, 1996.
[10]
Y. Yin, E. Hoffman, and C. Lin, “Mass preserving nonrigid registration
of CT lung images using cubic B-spline,” Medical Physics, vol. 36,
2009, pp. 4213–4222.
[11]
S. Klein, J. Pluim, M. Staring, and M. Viergever, “Adaptive stochastic
gradient descent optimisation for image registration ,” International
journal of Computer Vision, vol. 81, 2009, pp. 227–239.
5
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-791-7
SIGNAL 2020 : The Fifth International Conference on Advances in Signal, Image and Video Processing

