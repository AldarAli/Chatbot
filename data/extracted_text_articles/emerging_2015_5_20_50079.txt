The Transmission Protocol of Sensor Ad Hoc Networks 
 
Andrzej Marczak 
Gdansk University of Technology, 
Faculty of Electronics, Telecommunications and Informatics 
Gdansk, Poland 
e-mail: amarczak@eti.pg.gda.pl 
 
 
Abstract— This paper presents a secure protocol for a radio 
Ad Hoc sensor network. This network uses the TDMA multiple 
access method. The transmission rate on the radio channel is 
57.6 kbps. The paper presents the construction of frames, types 
of packets and procedures for the authentication, assignment 
of time slots available to the node, releasing assigned slots and 
slots assignment conflict detection. 
Keywords-Ad Hoc; TDMA; ASAP; OFB Mode. 
I. 
 INTRODUCTION  
Wireless sensor networks are appealing to researchers 
due to their wide range of application. The sensor networks 
can be used for various application areas (e.g., home, health, 
military). The Medium Access Control (MAC) protocol in 
the wireless sensor network must achieve two goals. The first 
is the creation of the network infrastructure. The second 
objective is to fairly and efficiently share communication 
resources between wireless sensor nodes [1]. The MAC 
protocols can use the Self-Organizing Medium Access 
Control for Sensor Networks (SMACS) protocol, the 
Eavesdrop-And-Register (EAR) protocol, the Carrier Sense 
Multiple Access (CSMA) method or the Time Division 
Multiple Access (TDMA) method [1] [2]. The TDMA 
method is often used in Ad Hoc sensor networks because of 
its ability to ensure collision-free transmission of packets 
regardless of the amount of traffic on the network. Many 
types of transmission scheduling protocols are used in 
TDMA Ad Hoc networks. Some of them do not support 
autonomous behaviors of mobile nodes. They cannot update 
the slot assignment of each node due to arrival or exit of 
mobile node [5]. Unifying the Slot Assignment Protocol 
(USAP) [7] and USAP-MA [8] Protocol, allows the 
operation of networks whose topology dynamically changes. 
However, they are characterized by poor channel utilization 
because of the existence of many conflicting or unassigned 
slots. The Traffic Adaptive MAC Protocol (TRAMA) is the 
algorithm proposed to increase the utilization of classical 
TDMA in an energy-efficient manner [3]. 
The sensor Ad Hoc network protocol, presented in this 
paper, uses the TDMA method and the Adaptive Slot 
Assignment Protocol (ASAP) protocol [4]. The ASAP 
protocol was chosen because of its ease of implementation 
in hardware and good properties [4]. This protocol is 
enhanced with authentication and encryption procedures.  
Reference
Node
 Level 0
Reference
Node 
Level1
Server
PIM
Wired
connection
PIM
Wireless
connections
PIM
PIM
Wireless
connections
 
Figure 1.  Sensor network. 
The remainder of the paper is organized as follows. In 
Section II, we present the structure of the TDMA frames. In 
Section III, we describe the formats of the packets. Section 
IV presents the cipher method used in the protocol. In 
Section V, we introduce the authentication procedure and, in 
Section VI, we present the slot assignment procedure. 
Section VII describes the detection of conflicts in the time 
slot assignment. Section VIII presents the releasing of time 
slot assignment. Finally, conclusions are presented in Section 
IX.  
II. 
TDMA FRAMES STRUCTURE 
A sensor network consists of Server, Personal 
Identification Module nodes (PIM) and Reference Node 
nodes (RN) (see Figure 1). The hierarchy level of RN 
indicates the number of radio hops to the server. Hierarchy 
level 0 means that the RN is connected via a wired 
connection to the server. 
Network nodes transmit seven types of packets: 
 
Data packet – DATA; 
 
Request packet – REQ; 
 
Information packet – INF; 
 
Hierarchy level packet – LEVEL; 
 
Suggestion packet – SUG; 
 
Reply packet – REP; 
 
Authentication packet – AUTH. 
Superframe
CONTROL
1
2
3
ts
tsr
Preamble
4 bytes
Synchron.
4 bytes
Kind 
of 
frame
1 byte
Sender 
addr. 
2 bytes
Receiv. 
Addr.
2 bytes
Timestamp
3 bytes
Data
12 bytes
CRC
2 
bytes
Frame
tr
Frame 
length
1 byte
Max. 
frame 
length
1 byte
Slot 
number
1 byte
Number 
of slots
4 bits
Type 
of 
frame 
4 bits
 
Figure 2.  Frame and superframe in sensor network. 
79
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-422-0
EMERGING 2015 : The Seventh International Conference on Emerging Networks and Systems Intelligence

Packets are transmitted in the frames. The frames are 
organized into superframes. The primary (shortest length) 
superframe has 4 time slots. The duration of the superframe 
is 20 ms. The ASAP protocol allows the use of long 
superframes. The lengths of such superframes are multiples 
of the primary superframe. The length of the long 
superframe is set as a power of two. The superframes can be 
composed of 8, 16, 32 and 64 time slots, respectively. Such 
superframe durations will be then of 40 ms, 80 ms, 160 ms 
and 320 ms. 
The transmission rate at the radio interface is 57.6 kbps, 
so the duration of the 1 bit is tb = 17.36 s, and the duration 
of 1 byte is tB = 8 × tb = 138.88 s. The duration of the 33-
byte data packet (DATA) tr = 4.583 ms. The duration of the 
time slot ts = 5 ms, so guard intervals have 2 × 208.48 ms 
(416.96 s), or duration of 3 bytes. In the case of packet 
types with fewer bytes, we used the addition of appropriate 
number of zero bytes (0x00) to align the packet length.  
Figure 2 shows the frame and the superframe in a sensor 
network. The first slot in the superframe (CONTROL) has 
been reserved for the new node to transmit control Request 
packets (REQ) or authentication packet (AUTH). This way, 
no data packets (DATA) are transmitted in this time slot. The 
data packets can be transmitted over the remaining three time 
slots (for the superframe with length L = 4). The same is true 
in the case of superframes with a greater number of time 
slots. The first time slot is always CONTROL, used for the 
REQ or AUTH packets to be transmitted, and the remaining 
slots are used for data transmission.  
Each packet type has a fixed part, depending on the 
structure of the packets sent by used the radio modems. This 
fixed part has a 4 byte preamble, 4-byte synchronization and 
1 byte the kind of frame information. The PIM node 
addresses will have values between 0 (0x00) to 127 (0x7F), 
while RN will have address values from 128 (0x80) to 254 
(0xFE). Address with a value 255 (0xFF) is for a broadcast 
transmission. In the case of transmission towards the server 
in packet address fields will be the source address (PIM or 
RN) and the address of the next RN node (the destination 
node). The RN node receiving the packet containing its 
address as the target, it checks its routing table to the next 
RN node address in the direction of the server and forwards 
the received packet in a different time slot. In the case of 
transmission from the server, the source address is the 
address of the RN node sending the packet and the 
destination address is the address PIM or RN node (if the 
packet is sent to the RN node).  
Timestamp
Block cipher
Plaintext
Ciphertext
Session 
key K
Ciphering OFB
Timestamp
Block cipher
Ciphertext
Plaintext
Session 
key K
Deciphering OFB
IV
IV
O
O
P
C
C
P
 
Figure 3.  Ciphering and deciphering in sensor network.  
III. 
PACKET FORMATS 
 
The data packet (DATA) (0x0D) is the first type of 
packet. It contains information on the frame length 
and time slots assigned to the sender, and the 
maximum frame length of the sender and its 
neighbors [4]. This packet also contains the 
encrypted data sent by a node. 
 
Request packet (REQ) (0x0C) is transmitted only by 
a new node. By sending this packet to neighbors, a 
new node requests the information on the frame 
length and assigned time slots of all nodes in 
contention area [4]. 
 
Information packet (INF) (0x0B) contains the 
information on the frame length of the sender and 
time slot assigned to the sender and its neighbors [4]. 
 
Hierarchy level packet (LEVEL) (0x6) is transmitted 
periodically by a RN node in the CONTROL time 
slot. The RN node is sending the packet to its 
neighbors, informing all nodes about its network 
hierarchy level. 
 
Suggestion packet (SUG) (0x0A) is transmitted only 
by a new node. By sending this packet to the 
neighbors, the new node announces the frame length 
and its assigned slot [4]. 
 
Reply packet (REP) (0x05) is transmitted for the 
confirmation of receiving SUG packet [4].  
 
Authentication packet (AUTH) (0x01) is used in the 
authentication procedure. This packet sends an 
encrypted node address and the encrypted session 
key (in 2 consecutive packets). 
IV. 
DATA SECURITY 
The security of the transmission is ensured by the use of 
the block cipher algorithm (e.g. Advanced Encryption 
Standard - AES, Data Encryption Standard - DES) working 
in Output Feedback (OFB) mode (see Figure 3). The OFB 
mode has the structure of a typical stream cipher, because it 
generates a stream of bits (O) as a function of the 
initialization vector IV and session key [6]. In this solution, 
the IV vector is a timestamp. Its uniqueness is critical. The 
ciphertext is obtained by the modulo 2 addition of the 
plaintext bits (P) and block cipher output bits (O). One 
advantage of the OFB mode is low sensitivity to 
transmission errors, and more specifically the lack of error 
propagation [6]. Using the OFB mode we can encrypt data 
blocks of any length, even shorter than the length of the data 
block used in encryption algorithm (e.g. 128 bits for AES 
algorithm). 
V. 
AUTHENTICATION PROCEDURE 
The OFB mode is used in the procedure of authentication 
nodes (PIM, RN), and to encrypt data transmitted in the 
DATA frames. The authentication procedure takes place 
after the new node determines the first time slot 
(CONTROL) in the superframe. All network nodes keep in 
the memory a pair of numbers (8-bit address) and the master 
key (128 bits)). The same pair of numbers are stored in the 
server, which acts as a Key Distribution Center (KDC). Only 
80
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-422-0
EMERGING 2015 : The Seventh International Conference on Emerging Networks and Systems Intelligence

the nodes whose data (address and master key) are stored in 
the 
memory 
server 
can 
connect 
to 
the 
network. 
Authentication is performed after the connection to the KDC 
server. The transmission associated with the authentication is 
performed in the CONTROL time slot. The slot assignment 
procedure to the new node occurs only after successful 
authentication. The result of authentication procedure is to 
provide the RN or PIM the session key K, which is necessary 
for the exchange of information with the server. The session 
key is the same for all nodes in the network. Its validity can 
range from a few to several hours. The length of the session 
key depends on the encryption algorithm. For the AES 
algorithm, the key length is equal 128 bits. The 
authentication procedure consists of four steps: 
 
The node that wants to connect to the network 
transmits in CONTROL time slot, authentication 
packet (AUTH) containing his encrypted address. 
The address is encrypted using a master key. 
 
The server, based on the node address, searches in its 
memory the master key and decrypts the encrypted 
address. Then, it compares the two addresses (the 
decrypted address and the address sent without 
encryption in the address field of the frame). 
 
If the comparison result is positive, the server 
encrypts 128-bit session key K using the master key 
and sends it to the authenticated node also in the 
CONTROL time slot. A negative comparison result 
ends the authentication procedure. The server sends 
one AUTH packet containing zero. 
 
The node receives the encrypted session key K and 
decrypts it. Since then, all transmitted data is 
secured. From that moment, the entire transmission 
is secure. In the case of a negative authentication, 
after receiving the AUTH packet with the content 
zero, the node, after a few superframes, may initiate 
a re-authentication procedure. 
VI. 
TIME SLOT ASSIGNMENT PROCEDURE 
The time slot assignment procedure is performed after 
successful authentication of the new node. All RN nodes, 
passing AUTH packet with a message about the negative 
authentication (1 packet containing zeros - 8 bytes of 0x00) 
know that the node is unauthenticated and cannot compete 
for access to the channel. After successful authentication the 
new node selects a time slot assigned to itself in four steps. 
A. Requesting the information on time slot assignment in 
the contention area. 
When a new node joins the network, it does not know the 
information on network topology or the time slots assigned 
to other nodes in its contention area.  
(0)
(1)
(1)
(2) b
(2) b
(3)
(3)
4 time slots
4 time slots
(0)
(1)
(1)
(2) b
(3)
(3)
(4)
(4)
(5)
(5)
(6) b
(7)
(7)
 
Figure 4.  Copying information about node b. 
(0)
(1) a
(2) b
(3)
(3)
(4) c
(5) b
(6) a
(7)
(7)
Unassigned  time slots
 
Figure 5.  Getting unassigned time slots. 
To get this information, the new node listens to the channel 
and checks packets transmitted from the neighbors. DATA 
packets from neighbors contain the information on their 
assigned time slots, superframe length, and maximum 
superframe length. From these pieces of information, the 
new node knows the position of the first time slot in a 
superframe and maximum superframe length among all 
nodes in its contention area. Then, the new node sends a 
REQ packet (0x0C) in the first time slot of the next 
superframe. Neighbors, that have received the REQ packet 
transmitted from the new node, transit to the control mode. 
Each neighbor of the new node gives information in its 
superframe length and time slot assigned to itself and its 
neighbors by transmitting an INF packet (0x0B) in its 
assigned time slot. After all neighbors of the new node have 
transmitted INF packets, all nodes in the contention area of 
the new node can know its structure [4]. 
B. Setting the superframe length and time slot assignment. 
After receiving INF packets from all neighbors, the new 
node sets its superframe length. If all nodes in its contention 
area have the same superframe length, the new node sets its 
own superframe length to this length.  
Otherwise, the new node uses the maximum superframe 
length among all nodes in the contention area. Then, from 
the received INF packets, the new node knows the 
information on slot assignment in this contention area. The 
new node creates its own time slot assignment information of 
superframe length, S0, where S0 denotes the frame length that 
is set to the new node. If the superframe length of a neighbor 
is the same as S0, the time slot assignment information of the 
neighbor is copied to that of the new node. Otherwise, if 
S0 = aSi, the time slot assignment information of the 
neighbor is copied repeatedly to every S0/a slots. Si is the 
superframe length of the neighbor and a is an integer of a 
power of two. The new node merges the information from all 
neighbors and creates its own time slot assignment 
information [4]. 
For example, when the new node sets its superframe 
length as 8, the time slot assignment information in the INF 
packet received from node b whose superframe length is 4 
and assigned slot is 2 is copied repeatedly to every 4 time 
slots in that of the new node (see Figure 4) [4]. 
(0)
(1) a
(2) b
(3) c
(4) d
(5) e
(6) a
(7) c
Node
Node
Time slot
Time slot
aa
1, 6
1, 6
bb
22
cc
3, 7
3, 7
dd
44
ee
55
Multiple time slots
 
Figure 6.  Releasing multiple assigned time slots. 
81
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-422-0
EMERGING 2015 : The Seventh International Conference on Emerging Networks and Systems Intelligence

(0)
(1) a
(2) b
(3) d
(4) c
(5) f
(6) g
(7) e
Unassigned time slot
(0)
(1) a
(2) b
(3) d
(4) c
(5) f
(6) g
(7) e
(8)
(9) a
(10) b (11) d (12) c (13) f (14) g (15) e
 
Figure 7.  Doubling the superframe. 
C. Selecting an assigned time slot. 
Based on the time slot assignment information, the new 
node selects a time slot assigned to itself by three 
procedures. 
1) Getting an unassigned time slot. 
If some unassigned time slots are found in the time slot 
assignment information, the new node assigns one of them to 
itself. For example, as shown in Figure 5, when unassigned 
time slots 3 and 7 are found, the new node can assign a time 
slot either 3 or 7 to itself [4]. 
2) Releasing multiple assigned time slots. 
If no unassigned time slot is found, the new node checks 
whether some nodes in the contention area are assigned 
multiple time slots. If such node is found, the new node 
releases one of these time slots and assigns it to itself. If 
there are more than one node to which multiple time slots are 
assigned, the node with the largest number of assigned time 
slots among them is chosen to release a time slot [5]. For 
example, as shown in Figure 6, when node a and c are 
assigned multiple time slots, the new node selects a time slot 
from time slots 1,3,6, and 7 which are assigned to nodes a 
and c, and assigns the selected time slot to itself [4].  
3) Doubling the superframe. 
If no unassigned time slot is found and no node has 
multiple assigned slots which are able to be assigned to the 
new node, the new node doubles the superframe length of the 
slot assignment information and copies the assignment 
information to both the former half and the latter half of 
doubled superframe. The first time slot in the superframe is 
not assigned to any nodes. Therefore, after doubling the 
superframe length, the first time slot in the latter half 
becomes unassigned slot. The new node assigns this time 
slot to itself [5]. For example, when the new node doubles 
the superframe length, time slot 8 can be assigned to itself 
(see Figure 7) [4].  
dd
cc
aa
3
ee
ff
bb
gg
1
5
2
5
3
4
New node
 
Figure 8.  Example of conflict an assigned time slot. 
aa
bb
4, 12
4, 12
aa
bb
4
12
Divide time 
slots
 
Figure 9.  Dividing the assignment of time slots. 
D. Announcement of updating the time slot assignment 
information  
After selecting a time slot assignment, the new node in 
network sends a SUG packet to its neighbors. The SUG 
packet contains information on the superframe length and the 
assigned time slot.  
When the neighboring nodes receive this packet, they 
update their time slot assignment information. After updating 
the information based on the received SUG packet, each 
neighboring node sends a REP packet to its neighboring 
nodes. Sending this packet implies the confirmation of the 
SUG packet for the new node and announcement of updating 
the time slot assignment information and exiting from the 
control mode. The sender and receivers of the REP packet 
adopt the new time slot assignment and can restart data 
transmission from the next superframe. The new node, after 
receiving the REP packets from all neighboring nodes, 
transits to the transmit mode [4].  
VII. DETECTION OF CONFLICT 
In the protocol, a conflict of slot assignment occurs when 
a new node connects to two or more nodes to which the same 
slots are assigned. In the example shown in Figure 8, a 
conflict occurs at a new node between node c and node f in 
time slot 5. When a new node detects the conflict, it solves 
this conflict using the following procedure [4]: 
A. Dividing the assignment  
If multiple time slots are conflicting at the new node, 
these time slots are divided to the nodes which have caused 
the conflict. Figure 9 shows the example when conflicting 
slot 4 and 12 are divided to nodes a and b [5]. 
B. Deleting a conflicting slot 
If in the network are some un-conflicting time slots 
assigned to nodes causing the conflict, the conflicting time 
slot is released from all the nodes except for that with the 
smallest number of assigned slots as shown in Figure 10 [5]. 
C. Doubling the superframe and dividing the assignment. 
If the conflict occurs among nodes to which only one 
time slot is assigned, this conflict cannot be solved with the 
current superframe length. 
 
aa
bb
4, 8, 16
4, 12
aa
bb
 8, 16
4, 12
Delete time 
slot 4 from 
node a
 
Figure 10.  Deleting the conflicting time slot 
82
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-422-0
EMERGING 2015 : The Seventh International Conference on Emerging Networks and Systems Intelligence

aa
bb
2, 6
2, 6
aa
bb
2
6
Divide time 
slots
aa
bb
2
2
Superframe 
length 4
Double 
superframe 
length
Superframe 
length 8
Superframe 
length 8
 
Figure 11.  Doubling the superframe and dividing the assignment. 
In this case, the superframe length of these nodes is doubled 
and the time slot assignment is divided in the doubled 
superframe. In the example in Figure 11, the space for 
conflicting time slot is doubled by doubling the superframe 
length. The space can be divided to nodes a and b (see Figure 
11) [5]. 
After reconfiguring the time slot assignment, the new 
node sends SUG packet with the information on the 
reconfigured time slot assignment and the selected time slot. 
Neighboring nodes which have received this SUG packet 
also reconfigure their time slot assignment and send REP 
packets with reconfigured information. The new node may 
fail to collect the information on the time slot assignment 
correctly due to the collisions of INF packets. Then, the new 
node sends the information on the time slot in which 
collisions have occurred to all neighboring nodes instead of 
the SUG packet. Neighboring nodes of the new node, which 
have sent the INF packets in the conflicting time slot, 
retransmit the INF packets after waiting for certain 
superframes determined at random [4].  
VIII. RELEASING TIME SLOT ASSIGNMENT 
When a node exits from the network, it stops transmitting 
DATA packets and releases time slots assigned to itself. 
Neighboring nodes detect the exit of the node when no 
packets from exited node have been received during the time 
of the superframe length of the exited node. Then, they 
release the time slot assigned to the exited node from their 
time slot assignment information. They also release the time 
slots assigned to nodes that have gone out of their contention 
area due to exit of the node.  
After reconfiguring the time slot assignment, neighboring 
nodes of the exited node send the updated information to 
their neighboring nodes. The nodes which have received this 
information reconfigure the time slot assignment by 
releasing the time slots assigned to the exited node [4]. 
IX. 
CONCLUSION AND FUTURE WORK 
The paper presents the construction of the Ad Hoc sensor 
network protocol. The operation of this protocol is based on 
the ASAP protocol, whose efficiency measured in terms of 
the radio channel utilization is much larger than the USAP 
protocol [4]. The protocol described in this paper has been 
extended with additional functions related to data security 
(authentication of new nodes and encryption of data 
transmission), and the determination of the network 
hierarchy level of the reference nodes. Two new types of 
packets have been proposed: the authentication packet 
(AUTH) and the hierarchy level packet (LEVEL). The 
authentication packet is used during the authentication 
procedure, before the time slot assignment procedure. It 
increases network security and prevents connection of 
unauthorized nodes. Applying the LEVEL packet, that 
informs about hierarchy of the RN, allows the assignment of 
a smaller number of time slots to the PIM nodes and 
improves the network performance. This protocol has been 
selected for hardware implementation because of the 
relatively simple structure and principles of operation.  
The future tasks of research are as follows.  
 
Software simulation of this protocol. 
 
Comparison properties of this protocol with other 
protocols used in TDMA Ad Hoc networks.  
 
Implementation of this protocol in hardware.  
 
Measurement of hardware network in real indoor 
environment.  
ACKNOWLEDGMENT 
This work was supported in part by the Project 
DOBRBIO4/058/13045/2013. 
REFERENCES 
[1] I.F. Akyildiz, W. Su, Y. Sankarasubramaniam, and E. Cayirci, 
„Wireless sensor networks: a survey,” Computer Networks 38, 
(2002), pp. 393-422. 
[2] I.F. Akyildiz, W. Su, Y. Sankarasubramaniam, and E. Cayirci, „A 
Survey on Sensor Networks,” IEEE Communications Magazine, 
August 2002, pp. 102-114. 
[3] I. Demirkol, C.Ersoy, and F Alagöz, “MAC Protocols for Wireless 
Sensor Networks: A Survey,” IEEE Communications Magazine, 
April 2006, pp. 115-121. 
[4] A. Kanzaki, T. Uemukai, T. Hara, and S. Nishio, ”Dynamic TDMA 
Slot Assignment in Ad Hoc Networks,” Proceedings of the 17 th 
International Conference on Advanced Information Networking and 
Applications (AINA’03), March 2003, pp. 330 - 335. 
[5] A. Kanzaki, T. Hara, and S. Nishio, ”An Adaptive TDMA Slot 
Assignment in Ad Hoc Sensor Networks,” Proceedings of the 2005 
ACM symposium on Applied computing (SAC '05), pp. 1160–1165. 
[6] W. Stallings, “Cryptography and Network Security Principles and 
Practice Fifth Edition,” Pearson Education Inc., publish as Prentice 
Hall, 2011. 
[7] C. D. Young, “USAP: a unifying dynamic distributed multichannel 
TDMA slot assignment protocol,” in Proc. IEEE MILCOM ’96, 
vol. 1, October 1996, pp. 235-239. 
[8] C.D. Young, “USAP multiple access: dynamic resource allocation for 
mobile multihop multichannel wireless networking,” in Proc. IEEE 
MILCOM ’99, vol. 1, November 1999,  pp. 271-275. 
 
83
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-422-0
EMERGING 2015 : The Seventh International Conference on Emerging Networks and Systems Intelligence

