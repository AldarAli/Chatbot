Application of a New Optimal Factorization of the SDRE Method in the Satellite
Attitude and Orbit Control System Design with Nonlinear Dynamics
Alessandro Gerling Romero
Department of Orbital Mechanics and Control - DMC
National Institute for Space Research - INPE
Sao Jose dos Campos, Brazil
e-mail: romgerale@yahoo.com.br
Luiz Carlos Gadelha de Souza
Department of Aerospace
Federal University of ABC - FUABC
Sao Bernardo do Campo, Brazil
e-mail: luiz.gadelha@ufanc.edu.br
Abstract—The satellite Attitude and Orbit Control System
(AOCS) can be designed with success by linear control theory
if the satellite has slow angular motions and small attitude
maneuver.
However,
for large and fast
maneuvers,
the
linearized
models
are
not
able
to
represent
all
the
perturbations due to the effects of the nonlinear terms present
in the dynamics and in the actuators. Therefore, in such cases,
it is expected that nonlinear control techniques yield better
performance than the linear control techniques. One candidate
technique for the design of AOCS control law under a large
maneuver is the State-Dependent Riccati Equation (SDRE).
SDRE entails factorization (that is, parameterization) of the
nonlinear dynamics into the state vector and the product of a
matrix-valued function that depends on the state itself. In
doing so, SDRE brings the nonlinear system to a (not unique)
linear structure having State-Dependent Coefficient (SDC)
matrices and then it minimizes a nonlinear performance index
having a quadratic-like structure. The non uniqueness of the
SDC matrices creates extra degrees of freedom, which can be
used to enhance controller performance; however, it poses
challenges since not all SDC matrices fulfill the SDRE
requirements. Moreover, regarding the satellite's kinematics,
there is a plethora of options, e.g., Euler angles, Gibbs vector,
Modified Rodrigues Parameters (MRPs), quaternions, etc.
Once again, some kinematics formulations of the AOCS do not
fulfill the SDRE requirements. In this paper, we evaluate the
factorization options of SDC matrices for the AOCS exploring
the requirements of the SDRE technique. Considering a
Brazilian National Institute for Space Research (INPE) typical
mission, in which the AOCS must stabilize a satellite in three-
axis, the application of the SDRE technique equipped with the
optimal SDC matrices can yield gains in the missions.
The
initial results show that MRPs for kinematics provides an
optimal SDC matrix.
Keywords-nonlinear control; SDRE method; satellite control.
I.
INTRODUCTION
The design of an AOCS that involves plant uncertainties,
large angle maneuvers and fast attitude control following a
stringent pointing, requires nonlinear control methods to
satisfy performance and robustness requirements.
An example is a typical mission of the INPE in which the
AOCS must stabilize a satellite in three-axes so that the
optical payload can point to the desired target with few
arcsecs of pointing accuracy.
One candidate method for a nonlinear AOCS control law
is the State-Dependent Riccati Equation SDRE method,
originally proposed by Pearson [11] and then explored in
detail by [1]-[3]. SDRE provides an effective algorithm for
synthesizing
nonlinear
feedback
control
by
allowing
nonlinearities in the system states while offering great
design
flexibility
through
state-dependent
weighting
matrices.
SDRE
entails
factorization
(that
is,
parameterization) of the nonlinear dynamics into the state
vector and the product of a matrix-valued function that
depends on the state itself. In doing so, SDRE brings the
nonlinear system to a (not unique) linear structure having
the SDC matrices and then it minimizes a nonlinear
performance index having a quadratic-like structure.
Accordingly, a suboptimal control law is carried out by a
real-time solution of an Algebraic Riccati Equation (ARE)
using the SDC matrices by means of a numerical algorithm.
Therefore,
SDRE
linearizes
the
plant
about
the
instantaneous point of operation and produces a constant
state-space model of the system. The process is repeated in
the next sampling steps, producing and controlling several
state dependent linear models out of a nonlinear one.
In this paper, we evaluate the factorization options the
SDC matrices for the AOCS exploring the requirements of
the SDRE technique. In particular, the non uniqueness of the
SDC matrices creates extra degrees of freedom, which can
be used to enhance controller performance; however, it
poses challenges since not all SDC matrices fulfill the
SDRE requirements. Moreover, regarding the satellite's
kinematics, there is a plethora of options, e.g., Euler angles,
Gibbs vector, MRPs (modified Rodrigues parameters),
quaternions, etc. Once again, some kinematics formulations
of the AOCS do not fulfill the SDRE requirements.
A good survey of the SDRE method can be found in [1]
and its systematic application to deal with a nonlinear plant
in [2]. The SDRE method was applied by [4][8]-[10][14] for
controlling a nonlinear system similar to the six-degree of
freedom satellite model considered in this paper. In [4], a
simulator using Euler angles based on commercial software
27
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-694-1
SPACOMM 2019 : The Eleventh International Conference on Advances in Satellite and Space Communications

is
defined,
whereas
[8][9]
applied
quaternions
on
commercial software. The application of SDRE method,
and, consequently, the ARE problem that arises, have
already been studied in the available literature, e.g., [10]
investigated the approaches for the ARE solving as well as
the resource requirements for such online solving. Finally,
[7][12] used SDRE method as a building block for high-
level control definition, the former one using sliding model
technique and the last using pursuit-evasion game. Recently,
[8] proposed the usage of differential algebra to reduce the
resource requirements for the real-time implementation of
SDRE
controllers.
In
fact,
the
intensive
resource
requirements for the online ARE solving is the major
drawback of SDRE. Nonetheless, the SDRE method has
three
major advantages: (a) simplicity, (b) numerical
tractability and (c) flexibility for the designer, being
comparable to the flexibility in the Linear Quadratic
Regulator (LQR) [9]. To the best of our knowledge, since
SDC matrices are not unique, there is no work focused on
the optimal arrangement of the SDC for the satellite attitude
control stabilization. Such optimal arrangement has the
potential to increase performance and enhance robustness.
Therefore, the first contribution of the present paper is the
explicit modeling of the state-space model for three-axes
stabilized attitude-maneuvering satellite using quaternions,
Gibbs vector and MRPs. The second, and the most
important contribution, is the optimal factorization of the
SDRE technique in an AOCS with nonlinear dynamics for a
given set of parameters, initial condition and references for
the controller. The models are evaluated for an attitude
maneuver called the upside-down in the Launch and Early
Orbit Phase (LEOP). In LEOP, the AOCS must dump the
residual angular velocity and point the satellite solar panels
towards the Sun. The results show that the MRPs provide
better performance in the set of scenarios considered.
This paper is organized as follows. In Section II, the
problem is described. In Section III, the satellite is
modelled, and the basic equations are shared. In Section IV,
the state-space
models are presented
and
the SDRE
controller is designed. In Section V, the controllability of
such models is explored as well as parametrization are
evaluated. In Section VI, we investigate the MRPs. In
Section VII, some simulations are performed using the
optimal factorization. In Section VIII, the conclusions are
presented.
II.
SDRE METHOD
The
SDRE
technique
entails
factorization
(that
is,
parametrization) of the nonlinear dynamics into the state
vector and the product of a matrix-valued function that
depends on the state itself. In doing so, SDRE brings the
nonlinear system to a (not unique) linear structure having
SDC matrices given by (1).
(1)
where x is the state vector and u is the control vector. Notice
that the SDC form has the same structure as a linear system,
but with the system matrices, A and B, being functions of
the state vector. The non uniqueness of the SDC matrices
creates extra degrees of freedom, which can be used to
enhance
controller
performance,
however,
it
poses
challenges since not all SDC matrices fulfill the SDRE
requirements, e.g., the pair (A,B) must be pointwise
stabilizable.
The system (1) is subject of the cost functional as in (2).
(2)
where Q and R are the state-dependent weighting matrices.
In order to ensure local stability, Q is required to be positive
semi-definite for all x and R is required to be positive for all
x [10]. The SDRE controller linearizes the plant about the
current operating point and creates constant state space
matrices so that the LQR method can be used. This process
is repeated in all samplings steps, resulting in a pointwise
linear model from a non-linear model, so that an ARE is
solved and a control law is computed also in each step.
Therefore, according to LQR theory and (1) and (2), the
state-feedback control law in each sampling step is u=-
K(x)x and the state-dependent gain K is obtained by (3) [2].
(3)
where P(x) is the unique, symmetric, positive-definite
solution of the algebraic state-dependent Riccati equation
(SDRE) given by (4).
(4)
III.
SATTELITE EQUATIOS OF MOTIONS
The satellite model is designed based on a typical mission
developed by INPE, in which the AOCS must stabilize the
satellite in three-axis so that the optical payload can point to
the desired target. Therefore, the satellite model is defined
to be a three-axis stabilized, attitude-maneuvering satellite, a
zero-bias-momentum system. A major control requirement
is to remove the unwanted accumulated angular momentum,
which would drive the satellite pointing away from the
desired target. Thus, an active control system is needed to
dump the residual body angular velocity that is created by
perturbation torques from the space environment [6][13].
The satellite model available, which is based on the
Amazonia-1
[16],
uses
reaction
wheels
(momentum
exchange actuators) to provide fine attitude control and to
maneuver the satellite [13]. The simulator models have two
types of sensors to compute and propagate the attitude: (1) a
set of Sun sensors, and (2) a gyro, which provide all the
necessary information for the LEOP attitude maneuver to
acquire the Sun pointing.
The
satellite
attitude
is
represented
by
means
of
quaternions in the model. Hence, the dynamic equation of
28
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-694-1
SPACOMM 2019 : The Eleventh International Conference on Advances in Satellite and Space Communications

the quaternion Q that rotates the ECI reference frame into
alignment with the satellite body reference frame is as in (5)
[6].
(5)
Notice that (5) can be written as in (6), using the vector g
(Gibbs vector or Rodrigues parameter) as
[6].
(6)
Notice that (5) can be written as in (7) [6], using the
vector p as
.
(7)
The model of the rotational dynamics of the satellite is
based on the Euler-Newton formulation and considers that
the satellite has a set of 3 reaction wheels, aligned with its
principal axes of inertia. One can define the inertia moment
of the satellite coupled with the 3 reaction wheels by (8).
(8)
where Ib, I and In,s
are the total, the satellite and the
inertia moment of the reaction wheels in their symmetry
axis an.
Assuming that there is no net external torque and using
(8), the rotational dynamics of the satellite is given by (9).
(9)
where, ω is the angular velocity, gn is the torque 
generated by the n reaction wheel and hw,n is the angular
momentum of the n reaction wheel about its center of mass.
IV.
DESIGN OF THE SDRE CONTROLLER
The SDRE controller has to deal with two dynamics: (a)
the attitude described by unit quaternions Q and (b) the
angular velocity, ω, of the satellite. In (a), the attitude must 
be stabilized and must follow the Sun according to a given
Sun vector in the satellite and in (b), the angular velocity
read by the gyroscope must be as close as possible to 0. The
state and the control vectors are defined by (10).
(10)
Taking into account the control vector defined in (10), the
state space model can be defined using (5), (9) and it is
given by (11) and (12).
(11)
(12)
However, such state-space models, in (11) and (12), do
not fulfill the SDRE requirements, in particular, the pair
(A,B)
is
not
pointwise
stabilizable.
Therefore,
it
is
impossible to use such models with SDRE technique.
An alternative option for the definition of the state-space
model is to use (6), which leads to (13).
(13)
(13) has been shown to satisfy SDRE conditions,
moreover, in it only A is a function of the state vector,
consequently, that is A (x).
29
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-694-1
SPACOMM 2019 : The Eleventh International Conference on Advances in Satellite and Space Communications

Another alternative option for the definition of the state-
space model is to use (7), which leads to (14).
(14)
V.
INVESTIGATION OF THE CONTROLABILITY
According to [2], an effective approach for selecting the
optimal state-space model for the SDRE is to attempt to
maximize the pointwise stabilizability of the possible
models, since pointwise control effort can be directly linked
to controllability. The controllability criterion requires the
value of determinant of the controllability matrix to be
different from zero, therefore, a graphical comparison of the
absolute value of the determinant of controllability matrix
can be used to reveal when pointwise controllability is
maximized. For multi-input systems, as the one studied in
the present paper, the controllability matrix is not square,
and
then
the
controllability
matrix
multiplied
by its
transpose is used to evaluate the determinant.
TABLE 1. SATELLITE DATA.
Satellite characteristics
Inertia tensor (kg.m2)
Reaction Wheels characteristics
Inertia
0.01911
inertia tensor of 3 reaction wheels
(kg.m2)
Maximum torque (N.m)
0.075
Maximum angular velocity (RPM)
6000
Initial Conditions
Attitude (degrees, XYZ)
[0 0 180]T
Angular velocity (radians/second,
XYZ)
[0 0 0.024]T
References for the controller
Solar vector in the body (XYZ)
[1 0 0]T
Angular velocity (radians/second,
XYZ)
[0 0 0]T
Numerical simulations were performed to determine
which of the (13) or (14) maximizes the controllability of
the system for the satellite used which data are shown in
Table 1. Figure 1 shows the controllability of the state-space
model (SSM) defined by (13) using quaternions and the
Gibbs vector, whereas Figure 2 shows the controllability of
the same state-space model defined by (14).
From Figures 1 and 2, MRPs maximize the controllability
through
the
simulation.
Once
MRPs
provide
better
controllability, the next step is to further parametrize such
state-model using different SDCs, which is explored in the
next section below.
VI.
PARAMETRIZATION OF MRP
For multivariable state-space models, as the one studied
here, there are two distinct SDC matrices A1(x) and A2(x),
once there is an infinite number of SDC parametrizations.
Such infinite parametrizations can be constructed using
(15).
(15)
where α is a real number and 0 ≤ α ≤ 1. 
Figure 1. Controllability using quaternions and Gibbs vector.
Figure 2. Controllability using MRPs.
30
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-694-1
SPACOMM 2019 : The Eleventh International Conference on Advances in Satellite and Space Communications

Focusing on MRPs, which provide better controllability,
and taking into account the rule of thumb that the selection
of the state-dependent factorization should place a nonzero
entry in the {i,j}-element of the A(x,α) matrix if the ith state 
derivative depends on the jth state, the state-space model is
defined in (16), which is based on algebraic manipulations
of (7).
(16)
Figure 3 shows the controllability of the state-space
model defined by (16) based on MRPs, which is better than
the one shown in Figure 1 so MRPs still have better
controllability than quaternions and the Gibbs vector.
Nevertheless, this second option based on MRPs (16) has
worse controllability than the first one defined by (14).
Figure 3. Controllability of MRPs of (16).
The two distinct parametrizations of (14) and (16) for the
same system suggest the possibility of using (15) to evaluate
a
new
combination
of
these
two
provides
better
controllability, that new parametrizations using A is given
by (17).
(17)
Applying the new parametrizations (17) into (15) and to
compare the performance of resulting parametrization with
different α, a simulation test was conducted with the full 
Monte Carlo perturbation model, in which α was randomly 
selected in the interval 0 ≤ α ≤ 1. The Monte Carlo model 
ran 90 times. Each time, the simulation used a different α 
with the data of Table 1. Figure 4 shows the resulting
controllability of each run. It is possible to conclude that the
parametrization defined by (14) is optimal since the
controllability is the highest through the entire simulation.
Therefore, the state-space model defined by (14), resulting
in the controllability shown in Figure 2, is the optimal
factorization to design the SDRE controller with nonlinear
dynamics. Such conclusion is based on the characteristics of
the satellite, the initial conditions and the references for the
controller in Table 1. So, this is not valid for the general
case and it is not valid for a different initial condition.
Moreover, as (14) is defined using MRPs, which have
singularity for 360o, it is neither unique nor global, whereas
(13) based on quaternions and Gibbs vector is global but not
unique.
VII.
SIMULATION USING OPTIMAL
FACTORIZATION
The satellite control using the SDRE controller designed
with the optimal factorization is shown in Figures 5 and 6.
Figure 4. Controllability of MRPs using state-space model (14) and (16).
31
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-694-1
SPACOMM 2019 : The Eleventh International Conference on Advances in Satellite and Space Communications

Figure 5. Control of satellite angular velocity with the optimal
factorization.
Figure 6. Control of satellite attitude with the optimal factorization.
Figure 7. Reaction wheels torque with the optimal factorization.
Focusing on the actuators, Figure 7 shows that the
reaction wheels torque is stabilized at about 420s.
VIII.
CONCLUSION
This is a contribution for the optimal arrangement of the
SDC for a three-axis stabilized satellite model. The results
shown that different SDCs can produce extremely different
results
ranging
from
non-applicability
of
the
SDRE
technique to huge differences in the controllability and,
consequently, in the performance and robustness of the
system. Unfortunately, the optimal factorization found is
neither valid for the general case nor even for a different
initial condition due to the underlining nonlinear dynamics.
However, the procedure applied can provide guidance for
engineers. A secondary contribution is the kinematical part
of the state-space models in (13), (14) and (16), since they
can be used in any system that exhibits rotational motion,
e.g., airplanes.
The simulations shown in the figures were performed
using a portable simulator developed at INPE [5,15]; such
simulator has capabilities for the unloading of the angular
momentum
of
the
reaction
wheels
(based
on
a
magnetometer and a set of magnetorquers) not explored in
the current paper.
One aspect discussed in this paper was whether the SDC
factorization of SDRE technique in AOCS design can yield
gains
in
the
missions
developed
by
INPE.
Since
performance in the LEOP is critical to the success of a
mission
and
the
simulation
results
show
that
the
performance and robustness of SDRE controllers can be
enhanced by optimal factorizations (in particular, with
kinematics based on MRPs), then we can say that SDRE can
yield
gains
in
the
missions
developed
by
INPE.
Nonetheless, its implementation requires more computing
resources and tends to exhibit difficulties for verification.
Therefore, it is too early to draw a definitive conclusion
about the applicability of SDRE in missions at INPE.
However, we can conclude that once SDRE technique is
used, the optimal factorization of SDC is of utmost
importance for performance and robustness of nonlinear
systems controlled by such technique.
REFERENCES
[1] T. Cimen, “State-Dependent Riccati Equation (SDRE) Control:
A Survey”, IFAC Proceedings Volumes, Vol. 17, pp. 3761-
3775, 2008.
[2] T. Cimen, “Systematic and effective design of nonlinear
feedback controllers via the state-dependent Riccati equation
(SDRE) method”, Annual Reviews in Control, Vol. 34, pp.
32-51, 2010.
[3] J. R. Cloutier, C. N. D’Souza, and C. P. Mracek, “Nonlinear
regulation and nonlinear H-infinity control via the state-
dependent Riccati equation technique”, Proceedings of the
First International Conference on Nonlinear Problems in
Aviation and Aerospace, pp. 117-141, 1996.
[4] R. G. Gonzales and L.C. G. Souza, ”Application of the SDRE
Method to Design an Attitude Control System Simulator”,
32
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-694-1
SPACOMM 2019 : The Eleventh International Conference on Advances in Satellite and Space Communications

Advances in the Astronautical Sciences, Vol. 134, p. 2251-
2258, 2009.
[5]
Hipparchus.org, “Hypparchus 1.3-SNAPSHOT”,
https://github.com/Hipparchus-Math/hipparchus, Access date:
March.2019.
[6] P. C. Hughes, “Spacecraft Attitude Dynamics”, NY, 1986.
[7] A. Jagat and A. J. Sinclair, “Nonlinear Control for Spacecraft
Pursuit-Evasion
Game
Using
SDRE
Method”,
IEEE
Transactions on Aerospace and Electronic Systems, Vol. 53,
pp. 3032-3042, 2017.
[8] G. D. Mauro, M. Schlotterer, S. Theil, and M. Lavagna,
“Nonlinear Control for Proximity Operations Based on
Differential Algebra”, Journal of Guidance, Control, and
Dynamics, Vol. 38, pp. 2173-2187, 2015.
[9] G. D. Mauro, P. D. Lizia, and M. Lavagna, “Control of
Relative
motion
via
State-Dependent
Riccati
Equation
Technique”, Proceedings of the AAS/AIAA Astrodynamics
Specialist Conference in Advances in Astronautical Sciences,
Vol. 142, pp. 909-928, 2012.
[10] P. K. Menon, T. Lam, L. S. Crawford, and V. H. L. Cheng,
“Real-time computational
methods for
SDRE
nonlinear
control of missiles”, Proceedings of the 2002 American
Control Conference, Vol. 1, pp. 232-237, 2002.
[11] J. D. Pearson, “Approximation Methods in Optimal Control”,
Journal of Electronics and Control, Vol. 13, pp. 453-469,
1962.
[12] C. Pukdeboon, “Optimal Sliding Mode Controllers for
Attitude Stabilization of Flexible Spacecraft,” Mathematical
Problems in Engineering, Vol. 2011, Article ID 863092, 20
pages, 2011.
[13] M. J. Sidi, “Spacecraft Dynamics and Control - A Practical
Engineering Approach”, Cambridge Univ. Press, 2006.
[14] D. T. Stansbery and J. R. Cloutier, "Position and attitude
control of a spacecraft using the state-dependent Riccati
equation technique," Proceedings of the 2000 American
Control Conference, Vol. 3., pp. 1867-1871, 2000.
[15] A. G. Romero and L. C. G. Souza, “Satellite Controller
System Based on Reaction Wheels Using the State-Dependent
Riccati Equation (SDRE) on Java”, Proceedings of the 10th
International Conference on Rotor Dynamics – IFToMM,
Vol. 1, pp. 547-561, 2018.
[16]
Inpe.br,
“Missão
Amazônia
1”,
http://www3.inpe.br/amazonia-1/, Access date: March, 2019.
33
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-694-1
SPACOMM 2019 : The Eleventh International Conference on Advances in Satellite and Space Communications

