92
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Estimation of Floor Reaction Force During Walking Using Frequency Analysis 
 
Shohei Hontama, Kyoko Shibata, Yoshio Inoue 
Kochi University of Technology 
Miyanokuchi 185, Tosayamada, Kami, Kochi, Japan 
e-mail: hontama.kut@gmail.com 
e-mail: shibata.kyoko@kochi-tech.ac.jp 
e-mail: inoue.yoshio@kochi-tech.ac.jp 
Hironobu Satoh 
National Institute of Information and Communications 
Technology 
Nukui-kitamachi, Koganei, Tokyo, 187-8795, Japan 
e-mail: satoh.hironobu@nict.go.jp 
 
 
Abstract - This research group aims to develop a gait analysis 
system that can be easily used by individuals with little user 
burden. This research group has proposed a method to 
estimate the floor reaction force, which is an important 
parameter in analyzing walking, from the force balance 
equation using the acceleration measured by wearable sensors, 
thus obtaining its usefulness. Previously, we reduced the 
number of sensors from 15 for the whole body part to 5 
selected for user burden, but the estimation accuracy 
decreased. Therefore, we consider how to reduce the number 
of sensors without sacrificing accuracy. In the proposed 
method, the acceleration of each part is discrete Fourier 
transformed and expressed in the frequency domain, a 
function representing the relationship of acceleration between 
each part is derived. This function is called the motion mode 
function, which is used to derive the acceleration in the 
frequency domain from the measured part to the unmeasured 
part. The inverse discrete Fourier transform was used to 
derive the acceleration in the time domain. As a result, the 
acceleration was estimated with high accuracy. In addition, in 
order to make the system more versatile, the acceleration of 
the unmeasured part is estimated using the average motion 
mode function, which is the average of the motion mode 
functions obtained from the acceleration of multiple trials by 
multiple persons and averaged for each order. The estimated 
acceleration was then used to estimate the composite floor 
reaction force in two directions. Correlation coefficients were 
used to check the accuracy of the estimates and demonstrate 
the usefulness of the proposed method. 
Keywords- Discrete Fourier transform; Gait analysis; 
Average motion mode function; Floor reaction force. 
I. 
 INTRODUCTION 
Walking is one of the most familiar activities performed 
by most people. Gait analysis data are important information 
in clinical medicine and sports for evaluating the 
effectiveness of rehabilitation therapy and for teaching 
athletes to improve their normal function. Gait analysis is 
performed using the widely known optical motion capture 
(MC) and installed force plate [2]. These systems are capable 
of deriving floor reaction forces and joint moments, which 
allow for detailed and accurate analysis of walking [3]. 
However, these systems are very expensive and have a 
limited measurement range, so they are limited to use in 
facilities such as research institutes and hospitals. In addition, 
electromyography can be used to determine muscle tension, 
but surface electromyography can only measure a limited 
number of muscles, while needle electrodes can only be used 
in specialized institutions. One method for estimating 
exertional capacity during walking is to perform simulation 
analysis using a musculoskeletal model [4]. Joint moment 
and muscle tension can be calculated as the load on the 
intervertebral discs from the balance of forces, but it involves 
many assumptions and constraints due to the setting of 
unclear individual parameters. To address these problems, 
gait analysis systems using wearable sensors have been 
proposed. Lei Wang et al. [5] attached four wearable sensors 
to the lower limbs to estimate step length and left-right 
asymmetry. Shaghayegh Zihajehzadeh et al. [6] used a 
wearable sensor attached to the wrist to estimate the walking 
speed in the walking direction. However, these systems only 
estimate the most common walking parameters for gait 
analysis. Also, our research group has developed a wearable 
motion capture system that combines a sandal-type force 
plate, which is a wearable version of an installed force plate 
and embedded with a 3-axis force sensor with motion 
sensors in six parts throughout the body [7]. However, this 
system was still expensive, burdensome to the user, causing 
problems with walking. Moreover, to develop an inexpensive 
and user-friendly gait analysis system that can be used easily 
by individuals, this research group proposed a method that 
can easily estimate the left and right composite floor reaction 
forces (ground reaction forces), which are important 
parameters for analyzing walking, using a wearable inertial 
sensor. This method has no limitations on the measurement 
range and is inexpensive to use [8]. This method uses the 
balanced relationship between three kinds of forces acting on 
a human while walking: inertia, gravity, and floor reaction 
force. The inertial force of the whole body was derived from 
the acceleration of the 15 parts and the mass of each part, 
based on the idea that the whole body can be treated as 15 
rigid bodies since the human body can be composed of 14 
rigid bodies and the trunk can be divided into the upper and 
lower trunk at the lower end of the ribs, as described by Ae 
et al. [9]. The estimated floor reaction force derived from the 
proposed method showed waveforms comparable to those 
measured by the force plates. Therefore, to accurately 
estimate the floor reaction force, each inertial force can be 
derived from the acceleration measured from 15 parts of the 
body. In the previous paper [10], we thought that by reducing 

93
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
the number of sensors used, it would be possible to realize a 
system with less user burden. we tried to derive the floor 
reaction force by substituting the acceleration of the 
unmeasured part with the acceleration of the other measured 
part, but the estimation accuracy decreased with the 
reduction of the number of sensors. Therefore, we consider 
how to reduce the number of sensors without sacrificing 
accuracy. As one method, we can reduce the number of 
sensors and the resulting loss of accuracy by selecting 
measured parts with a limited number of sensors and 
estimating the acceleration of unmeasured parts from the 
measured parts. In order to estimate with less accuracy 
degradation, the relationship between the motion of the 
measured and unmeasured parts must be understood. 
However, the quantitative description of the motion 
relationship in terms of time waveforms is not easy. Because 
of this, we considered the frequency domain because the 
waveform can be broken down into its components and 
analyzed quantitatively [11]. By considering walking as a 
periodic motion and expressing the acceleration in the 
frequency domain through a discrete Fourier transform of the 
acceleration of each part, the characteristics of each 
component were extracted when the acceleration was 
decomposed into its constituent components. From the 
results, the characteristics of the motion of each part were 
clarified. For the left and right limbs such as the thigh and 
upper arm, we used the average of the left and right 
accelerations to align the walking frequencies and make it 
easier to grasp the characteristics. Based on the results of the 
discrete Fourier transform, a function was derived by 
dividing the unmeasured part by the measured part for each 
order component in order to quantitatively express the 
relationship between the two parts. This function is called the 
motion mode function in this study, which quantitatively 
shows the relationship of acceleration between two parts of 
the target. By using the obtained motion mode function, the 
acceleration of the unmeasured part could be estimated from 
the measured part in the frequency domain. The acceleration 
in the frequency domain can be derived by multiplying the 
motion mode function by the acceleration in the frequency 
domain of the measured part. The acceleration data in the 
time domain can be obtained by inverse discrete Fourier 
transforming the acceleration expressed in the frequency 
domain. In the previous paper [1], we compared the 
estimated acceleration of the unmeasured part with the 
measured value of MC, using the correlation coefficient as a 
measure of the estimation accuracy to show the usefulness of 
the method in two directions.  
In the aforementioned previous report, the motion mode 
function, which represents the relationship between the 
accelerations of two parts, was created for each subject. In 
the method using the motion mode function of one subject, if 
the walking does not change significantly from trial to trial, 
the deviation of the motion mode function becomes small, 
allowing the acceleration of the unmeasured part to be 
estimated accurately. In this paper, we propose an average 
motion mode function to enhance the versatility of the 
system. The average motion mode function is a function that 
is derived from the motion mode function for each trial of 
multiple subjects and averaged for each order. The purpose 
of this paper is to accurately estimate the composite floor 
reaction force in two directions with a minimum number of 
measured parts by using this average motion mode function. 
First, the accelerations at each site for multiple trials of 
multiple subjects are obtained from the MC to derive the 
average motion mode function. These are discrete Fourier 
transformed to extract the features that are important for 
acceleration estimation. The average motion mode function 
is derived using the result of the discrete Fourier transform. 
The next step is to estimate the acceleration of the 
unmeasured part using the average motion mode function. 
To estimate the acceleration of the unmeasured part, the 
acceleration of the unmeasured part in the frequency domain 
is obtained by multiplying the average motion mode function 
by the acceleration of the measured part in the frequency 
domain of the trial that was not used in deriving the average 
motion mode function. The acceleration in the time domain 
is estimated by inverse discrete Fourier transforming the 
acceleration of the unmeasured part in the frequency domain. 
The accuracy of acceleration estimation for unmeasured 
parts depends largely on where the measured part is selected. 
Therefore, the selection of the measured part is discussed. 
There are two methods for selecting the optimal part. The 
first method is to derive the correlation coefficient between 
the actual measured value of the unmeasured part and the 
value estimated using the average motion mode function to 
determine the optimal part based on the estimation accuracy. 
The second selection criterion is the ability to accurately 
estimate the acceleration of a large mass part, which is 
important for accurately estimating the floor reaction force. 
Taking these two points into consideration, we select the 
optimal site for the acceleration estimation method of the 
unmeasured part. Finally, the composite floor reaction force 
in two directions is derived using the acceleration of the 
unmeasured part estimated using the average motion mode 
function. Correlation coefficients are again used to examine 
the accuracy of acceleration and floor reaction force 
estimates. 
This research group aims to develop a system using 
wearable sensors that can be easily used in daily life. 
However, compared to MC, current wearable inertial sensors 
are susceptible to noise and it is difficult to measure motion 
accurately. Therefore, in this paper, the acceleration data 
used in the analysis will be obtained using MC to examine 
the validity of the methodology. In this paper, the vertical 
direction and the walking direction are focused on because 
the floor reaction force in the left-right direction is small. 
The floor reaction force is derived as a composite of the floor 
reaction forces applied to the left and right feet, because it is 
derived from the balance between the inertia of the whole 
body and the sum of gravity. 
II. 
METHOD 
A. Method for obtaining acceleration data used in Fourier 
analysis 
The acceleration data used in the analysis is for two steps 
of one walking cycle, which is a steady-state walk from the 

94
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
fifth and sixth steps after the beginning of the walk, and the 
walk is accompanied by a metronome in order to unify the 
steps. Subjects practice walking to the rhythm of a 
metronome sufficiently before taking measurements. 
The recursive marker is attached at the center of gravity 
of each segment of the whole body, which is divided into 15 
parts as shown in Figure 1.  
 
 
Figure 1.  Attaching position of recursive marker for MC 
 
The division of the whole body is based on the idea that 
the human body can be composed of 14 rigid bodies and that 
the trunk can be divided into two parts at the lower end of 
the ribs, the upper trunk and the lower trunk, so that the 
whole body can be treated as 15 rigid bodies, as described by 
Ae et al. [9]. In this study, we use the average of the left and 
right accelerations for the left and right limbs, such as the 
thigh and the upper arm, referring to them as the average 
thigh and the average upper arm, respectively. As a result, 9 
parts will be considered instead of 15 parts in the whole body. 
The acceleration data used in the analysis need to have equal 
values at both ends to improve the accuracy of the Discrete 
Fourier Transform results. This time, we will measure 15 
trials for each subject and obtain acceleration data for each 
part. 
 
B. Estimation of acceleration at the unmeasured part 
The method of estimating the acceleration of an 
unmeasured part using the acceleration information of a 
measured part is described. 
First, by performing a discrete Fourier transform of the 
acceleration data at each part and obtaining the magnitude 
and phase for each order, the magnitude of the acceleration 
at each part can be quantitatively evaluated for each order, 
and the dominant frequency and its band can be determined 
when estimating the acceleration. In this paper, we focus on 
the magnitude at which the motion characteristics of each 
part become prominent in the discrete Fourier transform 
results of each part. Next, the motion mode function used to 
estimate the acceleration of the unmeasured part from the 
measured part is obtained. The motion mode function can be 
derived by dividing the unmeasured part by the measured 
part for each order using the result of the discrete Fourier 
transform of each part. For example, when the upper trunk is 
the measured part and the foot is the unmeasured part, by 
dividing the foot by the upper trunk, the motion mode 
function that can estimate the acceleration of the foot from 
the upper trunk can be derived. In the previous report, we 
acquired walking data for 15 trials for each subject and used 
the motion mode function that averaged the motion mode 
functions of the data for 14 trials. The reason why one trial is 
omitted is that it is to be used for verification to evaluate the 
usefulness of the motion mode function. In this paper, we 
derive the motion mode function for each trial of multiple 
subjects and average them for each order to derive the 
average motion mode function. The number of motion mode 
functions is 8 for the remaining parts for each measured part 
and 9 for the possible measured parts, so a total of 72 
functions per direction are derived for each subject. The 
average motion mode function, which is the average of the 
motion mode functions for each of these parts for each order, 
is derived as a function that reflects the acceleration 
relationship between the parts for all subjects. The 
acceleration of the unmeasured part is estimated in the 
frequency domain by multiplying the obtained average 
motion mode function by the result of the discrete Fourier 
transform of the measured part for the remaining one trial of 
the subject. For example, when the upper trunk is the 
measured part and the foot is the unmeasured part, the 
acceleration in the frequency domain of the foot can be 
derived by multiplying the average motion mode function of 
the upper trunk and foot by the acceleration in the frequency 
domain of the upper trunk. Finally, the acceleration in the 
time domain is obtained by inverse discrete Fourier 
transforming the acceleration of the unmeasured part in the 
frequency domain derived using the average motion mode 
function. 
In this study, we used the average of the left and right 
acceleration values for the left and right limbs, such as the 
thighs and upper arms, so that the walking frequency of each 
part of the body can be aligned. Therefore, it is easier to 
understand the dominant frequencies and their bands when 
estimating the acceleration of unmeasured parts as well as 
the relationship between the head, trunk, and limb 
movements. 
III. 
EXPERIMENTAL DESIGN 
In the experiment, MC with 12 cameras (manufactured 
by Motion Analysis Co., Ltd., MAC 3D System), force plate 
3 units (manufactured by Tec Gihan Co., Ltd., TF-6090-C 1 
unit, TF-4060-D 2 units), and a metronome were used. The 
force plates are a strain gauge type transducer that can 
measure force, moment, pressure center, etc. The MC and 
the force plate are synchronized to accurately measure the 
ground contact timing in walking. 
Five healthy subjects (male: age 21±2, height 1.70±0.10 
[m], weight 65±5 [kg]) were explained the purpose and 
contents of this study and gave oral and written consent. In 
addition, this study was approved by the Ethical Review 
Committee.  
10 steps are measured from the beginning of walking, 
and the force plates are placed at the 5th to 7th step from the 
beginning of walking. To measure the ground contact timing 
required by the discrete Fourier transform, three force plates 
are set up so that one foot contacts one force plate. The 
sampling frequency is set to 100 Hz, and low-pass 
processing with a cutoff frequency of 9 Hz is used for 
smoothing. 

95
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
IV. 
RESULT&DISCUSSION 
A. Estimate the acceleration of the unmeasured part from 
the measured part 
In this section, we showed whether the acceleration of 
the non-measured part can be estimated accurately from the 
measured part using the average motion mode function 
derived from the five subjects who participated in this 
experiment. 
The number of motion mode functions is 8 for the 
remaining parts for each measured part and 9 for the possible 
measured parts, so a total of 72 functions per direction are 
derived for each subject. However, due to the limitation of 
space, the acceleration estimation results for the case where 
the measured part is the upper trunk and the unmeasured 
parts are the average thigh and the average upper arm are 
shown as an example. In this paper, the subjects walked to a 
metronome at a pace of 100 BPM (one walking cycle is 0.6 
seconds), and the acceleration of each part was taken out for 
two steps (1.2 seconds). 
First, the measured accelerations in the time domain of 
the upper trunk, average thigh, and average upper arm of one 
subject obtained from the experiment were shown. Figure 2 
shows the acceleration of the upper trunk, the average thigh, 
and the average upper arm in the vertical direction, and 
Figure 3 shows the acceleration of the upper trunk, the 
average thigh, and the average upper arm in the walking 
direction. Figure 2 shows that in the vertical direction, the 
upper trunk and average upper arm move similarly, but the 
average thigh moves with more high-frequency waves than 
the upper trunk and average upper arm. Figure 3 shows that 
even in the walking direction, the average thigh moves with 
more high-frequency waves than the upper trunk and average 
upper arm. The acceleration waveforms in the time domain 
shown in Figure 2 and Figure 3 indicated that it is difficult to 
quantitatively show the relationship of motion between each 
part of the body in both the vertical and walking directions 
and to estimate the acceleration of the average thigh and the 
average upper arm from the upper trunk simply by making 
corrections such as the constant correction. In addition, we 
found that it was difficult to estimate the acceleration of 
other parts of the body from one part, not only the upper 
trunk. 
Next, 
the 
acceleration 
data 
is 
discrete 
Fourier 
transformed and decomposed into frequency components, 
and the magnitude and phase are determined for each 
direction. From the results, the dominant frequencies and 
their bands in estimating the acceleration of the unmeasured 
part were identified. The important components are the 
walking frequency (The walking frequency is 1.667 Hz, and 
the order of the graph is an integer.) and it's integer multiples 
while 0.5 times the walking frequency (The frequency of the 
0. 5 times component is 0.833 Hz, and the order of the graph 
is the value of the half component of the integer.) and its 
integer multiples are not focused on in this report because 
they are indicators of the degree of left-right balance. Figure 
4 shows the magnitude and phase in the vertical direction of 
the upper trunk, Figure 5 shows the average thigh, and 
Figure 6 shows the average upper arm. Figure 7 shows the 
magnitude and phase in the walking direction of the upper 
trunk, Figure 8 shows the average thigh, and Figure 9 shows 
the average upper arm. The magnitude and phase were 
shown as the average and standard deviation calculated from 
the walking data of five subjects of 15 trials each (for a total 
of 75 trials). The result of the discrete Fourier transform has 
a magnitude in the components up to 9 Hz because of the 
low-pass processing with a cutoff frequency of 9 Hz. 
From Figure 4 to Figure 9, the amplitudes of the walking 
frequency and its integer multiple components (The order of 
the graph is an integer value) were large in both the vertical 
and traveling directions. Since the walking was controlled to 
some extent, except for the higher-order components of the 
average thigh, it can be seen that the movements of each part 
were similar from trial to trial and the standard deviation was 
small. In the vertical direction, the motion of the upper trunk 
was highly dependent on the walking frequency component, 
while the average thigh and the average upper arm contain 
not only the walking frequency component but also many 
higher-order components. For the average thigh shown in 
Figure 5, the reason for the large standard deviation in the 
third order or higher of the walking frequency component 
was that the walking of one subject differed greatly from trial 
to trial. In the direction of travel, the upper trunk and average 
upper arm were highly dependent on the walking frequency 
component, while the average thigh not only has a relatively 
large walking frequency component but also moves with 
many higher-order components. Therefore, the walking 
frequency and its integer multiple components are important 
for the acceleration estimation of the unmeasured part, and 
higher-order components are also necessary. 
 
 
Figure 2.  Acceleration data of upper trunk, average thigh, and average 
upper arm in the vertical direction. The blue line is the upper trunk 
acceleration, the orange line is the average thigh acceleration, and the gray 
line is the average upper arm acceleration. Acceleration data were 
measured by MC. 
 
 
Figure 3.  Acceleration data of upper trunk, average thigh, and average 
upper arm in the walking direction. The blue line is the upper trunk 
acceleration, the orange line is the average thigh acceleration, and the gray 
line is the average upper arm acceleration. Acceleration data was measured 
by MC. 

96
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 4.  Result of the discrete Fourier transform of the upper trunk 
acceleration in the vertical direction. The magnitude and phase are shown 
as the average and standard deviation calculated from 75 walking data(5 
subjects, 15 trials each). The upper trunk acceleration in the vertical 
direction is highly dependent on the walking frequency component. 
 
 
Figure 5.  Result of the discrete Fourier transform of the average thigh 
acceleration in the vertical direction. The magnitude and phase are shown 
as the average and standard deviation calculated from 75 walking data(5 
subjects, 15 trials each). The average thigh acceleration in the vertical 
direction contains not only the walking frequency component but also 
many higher-order components. 
 
 
Figure 6.  Result of the discrete Fourier transform of the average upper 
arm acceleration in the vertical direction. The magnitude and phase are 
shown as the average and standard deviation calculated from 75 walking 
data(5 subjects, 15 trials each). The average upper arm acceleration in the 
vertical direction contains not only the walking frequency component but 
also many higher-order components. 
 
Figure 7.  Result of the discrete Fourier transform of the upper trunk 
acceleration in the walking direction. The magnitude and phase are shown 
as the average and standard deviation calculated from 75 walking data(5 
subjects, 15 trials each). The upper trunk acceleration in the walkingl 
direction is highly dependent on the walking frequency component. 
 
 
Figure 8.  Result of the discrete Fourier transform of the average thigh 
acceleration in the walking direction. The magnitude and phase are shown 
as the average and standard deviation calculated from 75 walking data(5 
subjects, 15 trials each). The average thigh acceleration in the walking 
direction contains not only the walking frequency component but also 
many higher-order components. 
 
 
Figure 9.  Result of the discrete Fourier transform of the average upper 
arm acceleration in the walking direction. The magnitude and phase are 
shown as the average and standard deviation calculated from 75 walking 
data(5 subjects, 15 trials each). The average upper arm acceleration in the 
walking direction is highly dependent on the walking frequency component. 

97
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Next, the average motion mode function is shown. As an 
example, the average motion mode function was derived 
with the upper trunk as the measured part and the average 
thigh and upper arm as the unmeasured parts. A motion 
mode function was derived for each of the 14 trials for each 
subject, and the average motion mode function was averaged 
for each order of the motion mode function for each trial for 
five subjects (Average of motion mode functions for 70 
trials). Figure 10 shows the results for the average thigh with 
the upper trunk as the measured part, and Figure 11 shows 
the results for the average upper arm with the upper trunk as 
the measured part in the vertical direction. Figure 12 shows 
the results for the average thigh with the upper trunk as the 
measured part, and Figure 13 shows the results for the 
average upper arm with the upper trunk as the measured part 
in the walking direction. The gain and phase difference of 
the results were shown as the average and standard deviation 
calculated from the walking data of 70 trials. 
In this paper, we focused on the walking frequency and 
its integer multiple components, which are important for 
estimating the acceleration of unmeasured parts. In the 
vertical direction, Figure 10 and Figure 11 show that the 
most important walking frequency component has a gain of 
near 1 and a phase difference near 0, indicating that the 
motion is similar in the vertical direction. For the integer 
multiple components larger than the quadratic component, 
the gain was larger than 1, and the average thigh and the 
average upper arm moved more than the upper trunk. In the 
walking direction, Figure 12 shows that the average thigh 
moves more than the upper trunk because the gain of the 
walking frequency component is near 2. Figure 13 shows 
that the upper trunk and average upper arm move similarly 
because the gain of the most important walking frequency 
component is near 1 and the phase difference is near 0. For 
the integer multiple components larger than the quadratic 
component, the gain was larger than 1 except for the 
quadratic components of the upper trunk and average upper 
arm, indicating that the average thigh and average upper arm 
moved more than the upper trunk. As for the quadratic 
components of the upper trunk and the average upper arm, 
Figure 9 shows that the gain of the average upper arm is 
smaller than 1 due to its smaller magnitude in the integer 
multiple components of the walking frequency component.  
From Figure 10 to Figure 13, we consider that the reason for 
the large standard deviation in the integer components of the 
walking frequency is that the magnitude of each part is small 
in the integer components above the second-order 
component of the upper trunk. The large standard deviation 
in the integer multiple components of the walking frequency 
may affect the error between the measured and estimated 
values in high-frequency waves when the acceleration at the 
unmeasured part is estimated. 
Next, the acceleration in the time domain of the 
unmeasured part is shown. As an example, the average thigh 
and upper arm accelerations were estimated from the upper 
trunk acceleration of trial 15 for one subject using the 
average motion mode function obtained from 70 trials of 
walking data shown in Figure 10 to Figure 13. The 
acceleration of the average thigh and the average upper arm 
was estimated in the frequency domain using a total of five 
points of the walking frequency and its integer multiple 
components of the average kinematic mode function and an 
inverse discrete Fourier transform is performed to obtain the 
acceleration data in the time domain. 
 
 
Figure 10.  The average motion mode function in the vertical direction with 
the input as upper trunk and the output as average thigh. The magnitude 
and phase difference are shown as the average and standard deviation 
calculated from 70 walking data(5 subjects, 14 trials each). 
 
 
Figure 11.  The average motion mode function in the vertical direction with 
the input as upper trunk and the output as average upper arm. The 
magnitude and phase difference are shown as the average and standard 
deviation calculated from 70 walking data(5 subjects, 14 trials each). 
 
 
Figure 12.  The average motion mode function in the walking direction with 
the input as upper trunk and the output as average thigh. The magnitude 
and phase difference are shown as the average and standard deviation 
calculated from 70 walking data(5 subjects, 14 trials each). 

98
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
 
Figure 13.  The average motion mode function in the walking direction with 
the input as upper trunk and the output as average upper arm. The 
magnitude and phase difference are shown as the average and standard 
deviation calculated from 70 walking data(5 subjects, 14 trials each). 
 
The results of the comparison between the measured 
values of MC, the acceleration estimated using the average 
motion mode function, and the acceleration estimated from 
the motion mode function derived from 14 trials of one 
subject were shown in Figure 14 and Figure 15 for the 
vertical direction of the average thigh and the average upper 
arm, respectively, and in Figure 16 and Figure 17 for the 
walking direction of the average thigh and the average upper 
arm, respectively. In the method using the average motion 
mode function, the acceleration of the average thigh and the 
average upper arm can be estimated, using the measured part 
as the upper trunk, similar to the method using the motion 
mode function of one subject. The respective correlation 
coefficients between the measured values of MC and the 
acceleration estimated using the average motion mode 
function, and between the measured values of MC and the 
acceleration estimated from the motion mode function of one 
subject are shown in Table 1. Compare the correlation 
coefficients when using the average motion mode function 
and when using the motion mode function of one subject. In 
the vertical direction and the walking direction, the motion 
mode function of one subject is more accurately estimated in 
both cases where the unmeasured part is the average thigh 
and the average upper arm. This is because the deviation of 
the motion mode function becomes small in the method 
using the motion mode function of one subject, if the 
walking does not change significantly from trial to trial, and 
the acceleration can be estimated accurately. However, in the 
vertical direction, the correlation coefficients were high even 
when the average operating mode function was used, and 
accuracy was ensured. Figure 16 and Figure 17 show that in 
the walking direction, the average thigh captures the 
characteristics of the waveform, while the average upper arm 
cannot reproduce the higher-order components, but can 
estimate the phase and amplitude of the lower-order 
components. 
The results on the accuracy of the acceleration estimation 
of the unmeasured part when the measured part is the other 
part are described in the next section. 
 
Figure 14.  Comparison of acceleration estimated using measured value of 
MC and the average motion mode function, and acceleration estimated 
from the motion mode function derived from 14 trials of one subject, using 
the upper trunk as the measured part and the average thigh as the 
unmeasured part in the vertical direction. 
 
 
Figure 15.  Comparison of acceleration estimated using measured value of 
MC and the average motion mode function, and acceleration estimated 
from the motion mode function derived from 14 trials of one subject, using 
the upper trunk as the measured part and the average upper arm as the 
unmeasured part in the vertical direction. 
 
 
Figure 16.  Comparison of acceleration estimated using measured value of 
MC and the average motion mode function, and acceleration estimated 
from the motion mode function derived from 14 trials of one subject, using 
the upper trunk as the measurement part and the average thigh as the 
unmeasured part in the walking direction. 
 
 
Figure 17.  Comparison of acceleration estimated using measured value of 
MC and the average motion mode function, and acceleration estimated 
from the motion mode function derived from 14 trials of one subject, using 
the upper trunk as the measurement part and the average upper arm as the 
unmeasured part in the walking direction. 

99
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
TABLE I.  
CORRELATION COEFFICIENTS OF THE ESTIMATED 
ACCELERATION OF THE UNMEASURED PART WITH MEASURED VALUES OF 
MC. CORRELATION COEFFICIENTS WITH MEASURED VALUE OF MC ARE 
SHOWN FOR THE CASE WHERE THE AVERAGE MOTION MODE FUNCTION OF 
FIVE PEOPLE IS USED AND THE CASE WHERE THE MOTION MODE FUNCTION 
OF ONE SUBJECT IS USED. 
Function
Average thigh
Average upper arm
Average motion mode function
0.825
0.816
Motion mode function of one subject
0.962
0.959
Function
Average thigh
Average upper arm
Average motion mode function
0.693
0.642
Motion mode function of one subject
0.848
0.926
Vertical direction
Walking direction
 
 
B. Selection of the optimal part for estimation of 
acceleration 
In this section, we consider which part of the body can be 
selected as the measured part to estimate the acceleration of 
the unmeasured part with good accuracy. 
In the past, the research group has considered that 
accurate estimation of the acceleration at the part with large 
mass is important for accurate estimation of the floor 
reaction force because the higher the accuracy of the part 
with large mass, the higher the accuracy of the floor reaction 
force. Considering these factors, the optimal site was 
selected. First, the correlation coefficient between the 
measured values of MC and the values estimated from each 
measured part was derived. Next, the optimal part was 
selected from the derived correlation coefficients, focusing 
on the measured part that can accurately estimate the 
acceleration of the part with a large mass. 
In this paper, the whole body was divided into three 
groups as a large block (A: head, upper trunk, lower trunk B: 
upper limbs C: lower limbs) and the part with the largest 
mass in each group is used as the measured part to estimate 
the acceleration of the unmeasured part. The mass of each 
body part was derived by multiplying the total body mass 
measured with a scale by the body part coefficients of 
Japanese athletes shown in Table 2, which were calculated 
by Ae et al. using the method of Yokoi et al. [12], who 
applied the model of Jensen et al. [13]. Body part 
coefficients for upper and lower limbs were shown as 
composite values for left and right. 
The measurement sites were the upper trunk, the average 
upper arm, and the average thigh from each of the three 
groups, and the non-measurement sites were the upper trunk, 
the average thigh, the lower trunk, the average lower leg, and 
the head, which are the sites with large mass, respectively. 
As an example, when the unmeasured part is the lower 
trunk, the estimated results from each measured part are 
shown in Figure 18 for the vertical direction and Figure 19 
for the walking direction. In this paper, the average values of 
the correlation coefficients for each measured part were 
obtained for each of the two subjects, and are shown in Table 
3 for the vertical direction and Table 4 for the walking 
direction. 
TABLE II.  
BODY PART COEFFICIENTS OF JAPANESE ATHLETES(UPPER 
AND LOWER LIMBS ARE COMPOSITE VALUES OF LEFT AND RIGHT) 
Group
Body part
Mass ration [%]
Head
6.9
Upper tunk
30.2
Lower trunk
18.7
Upper arm
5.4
Forearm
3.2
Hand
1.2
Thigh
22.0
Lower thigh
10.2
Foot
2.2
A
B
C
 
 
 
Figure 18.  In the vertical direction, the unmeasured part is the lower trunk, 
and the measured value of MC are compared with the acceleration 
estimated with the upper trunk as the measured part, the acceleration 
estimated with the average upper arm as the measured part, and the 
acceleration estimated with the average thigh as the measured part. 
 
 
Figure 19.  In the walking direction, the unmeasured part is the lower trunk, 
and the measured value of MC are compared with the acceleration 
estimated with the upper trunk as the measured part, the acceleration 
estimated with the average upper arm as the measured part, and the 
acceleration estimated with the average thigh as the measured part. 
 
In Figure 18 and Figure 19, the characteristics of the 
measured waveforms in both the vertical and walking 
directions can be captured in terms of their magnitude and 
phase. To evaluate the results, the correlation coefficient was 
again used to quantitatively show the estimation accuracy. 
Table 3 shows that in the vertical direction, the average 
values of the correlation coefficients were the highest when 
the measured part was the upper trunk for subject A and the 

100
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
average thigh for subject B, and the values were comparable. 
Considering that the higher accuracy of the estimation of the 
large mass part is more accurate when estimating the floor 
reaction force, we decided to select the upper trunk as the 
measured part, which shows a relatively high correlation 
coefficient when the unmeasured parts are the upper trunk, 
average thigh, and lower trunk in the vertical direction. 
Table 4 shows that in the walking direction, the average 
values of the correlation coefficients were the highest when 
the measured part was the average thigh for subject A and 
the upper trunk for subject B, and the values were 
comparable. In the walking direction, the correlation 
coefficients were similar when the measured parts were the 
upper trunk, average thigh, and average upper arm. However, 
for the upper and lower limbs, the average acceleration of the 
left and right limbs is used, requiring measurements at two 
parts each. Therefore, the upper trunk was selected as the 
measured part in order to reduce the number of sensors and 
to improve the estimation accuracy. 
 
TABLE III.  
CORRELATION COEFFICIENT BETWEEN THE MEASURED 
VALUES OF MC AND THE ESTIMATED VALUES FROM EACH MEASURED PART 
IN THE VERTICAL DIRECTION. IN CASE THE MEASURED AND UNMEASURED 
PARTS ARE THE SAME, THE CORRELATION COEFFICIENT IS EXPRESSED AS 1. 
　　　     Unmeasured
                        part
Measured
     part
Uppert
trunk
Average
thigh
Lower
trunk
Average
lower
thigh
Head
Average
Upper trunk
1
0.825
0.929
0.843
0.927
0.905
Average thigh
0.853
1
0.824
0.901
0.846
0.885
Average upper arm
0.900
0.668
0.828
0.545
0.949
0.778
Upper trunk
1
0.661
0.812
0.723
0.867
0.813
Average thigh
0.954
1
0.792
0.651
0.833
0.846
Average upper arm
0.919
0.627
0.880
0.498
0.961
0.777
Subject A
Subject B
 
 
TABLE IV.  
CORRELATION COEFFICIENT BETWEEN THE MEASURED 
VALUES OF MC AND THE ESTIMATED VALUES FROM EACH MEASURED PART 
IN THE WALKING DIRECTION. IN CASE THE MEASURED AND UNMEASURED 
PARTS ARE THE SAME, THE CORRELATION COEFFICIENT IS EXPRESSED AS 1. 
　　　     Unmeasured
                        part
Measured
     part
Uppert
trunk
Average
thigh
Lower
trunk
Average
lower
thigh
Head
Average
Upper trunk
1
0.693
0.781
0.260
0.170
0.581
Average thigh
0.676
1
0.600
0.214
0.552
0.608
Average upper arm
0.721
0.648
0.538
0.173
0.308
0.478
Upper trunk
1
0.736
0.942
0.376
0.188
0.648
Average thigh
0.740
1
0.655
0.430
0.250
0.615
Average upper arm
0.733
0.780
0.707
0.0650
0.100
0.477
Subject A
Subject B
 
V. 
APPLICATION TO ESTIMATION OF FLOOR REACTION 
FORCE 
A. Floor reaction force estimation method using 
acceleration of each part 
We use the fact that the sum of the inertia force derived 
from the acceleration measured from 15 parts of the body 
and the mass of each part, and the gravity force is balanced 
by the floor reaction force [8]. Equation (1) is an equation for 
estimating floor reaction forces in the vertical direction. 
Where Fz is the vertical floor reaction force, m is the mass of 
each body part, az is the vertical acceleration of each body 
part, i is the number of body parts, M is the total body mass, 
and g is the acceleration of gravity. 
 
.
z
i
zi
i
F
m a
Mg
=
+

 
(1) 
 
Equation (2) is an equation for estimating the floor 
reaction force in the walking direction. The floor reaction 
force in the walking direction can be derived by removing 
the gravity term from (1) and using the acceleration in the 
walking direction for the acceleration at each site. Where Fy 
is the floor reaction force in the walking direction and ay is 
the acceleration in the walking direction. 
 
.
y
i
yi
i
F
=m a
 
(2) 
 
In this paper, the number of parts i is nine because the 
average of the acceleration of the left and right limbs, such as 
the thigh and upper arm, is used. The mass of each body part 
is derived by multiplying the total body mass measured by a 
scale by the body part coefficients in Table 2. 
B. Estimation Result 
The floor reaction force was derived using the 
acceleration derived from the acceleration estimation method 
for the unmeasured part shown in Section Ⅳ.A. The floor 
reaction force in two directions was derived by estimating 
the acceleration of the remaining eight parts, using the trunk 
as the measured part, which was selected as the optimal part 
in the acceleration estimation method for unmeasured parts 
described in Section Ⅳ.B. The correlation coefficient was 
used to judge the accuracy of the estimation. 
The results of the comparison of the floor reaction force 
derived from the force plate measurements and the average 
motion mode function, the floor reaction force derived from 
the motion mode function of one subject, and the floor 
reaction force derived using nine measured parts were shown 
in Figure 20 for the vertical direction and Figure 21 for the 
walking direction. The measured values from the force plates 
were smoothed by low-pass processing with a cutoff 
frequency of 9 Hz as well as the acceleration obtained from 
the sensor. From Figure 20 and Figure 21, one cycle of 
walking was shown, but one foot was grounded outside of 
the force plate until time 0.13[s], so the measurement of the 

101
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
force plates indicated by the solid blue line did not measure 
the composite floor reaction force until time 0.13[s]. Table 5 
showed the correlation coefficients between the measured 
values of the force plates and the floor reaction force derived 
using the average motion mode function, the floor reaction 
force derived using the motion mode function of one subject, 
and the floor reaction force derived using nine measured 
parts, respectively. Each correlation coefficient was derived 
using the data after 0.13[s]. 
 
TABLE V.  
CORRELATION COEFFICIENTS BETWEEN THE FLOOR 
REACTION FORCE MEASURED BY THE FORCE PLATE AND THE FLOOR 
REACTION FORCE DERIVED USING THE AVERAGE MOTION MODE FUNCTION, 
THE FLOOR REACTION FORCE DERIVED USING THE MOTION MODE FUNCTION 
OF ONE SUBJECT, AND THE FLOOR REACTION FORCE DERIVED USING NINE 
MEASUREMED PARTS IN THE VERTICAL DIRECTION AND THE WALKING 
DIRECTION. 
Function
Vertical
direction
Walking
direction
Average motion mode
function
0.934
0.887
Motion mode function
of one subject
0.924
0.952
Nine measured parts
0.952
0.933
 
 
 
Figure 20.  Comparison of the floor reaction force derived from the force 
plate measurements and the average motion mode function, the floor 
reaction force derived from the motion mode function of one subject, and 
the floor reaction force derived from nine measuremed parts in the vertical 
direction. The time up to 0.13 seconds is not included in the comparison 
because it is the point where the composite floor reaction force cannot be 
measured because one foot is grounded outside the force plate. 
 
 
Figure 21.  Comparison of the floor reaction force derived from the force 
plate measurements and the average motion mode function, the floor 
reaction force derived from the motion mode function of one subject, and 
the floor reaction force derived from nine measuremed parts in the walking 
direction. The time up to 0.13 seconds is not included in the comparison 
because it is the point where the composite floor reaction force cannot be 
measured because one foot is grounded outside the force plate. 
Table 5 showed that in the vertical direction, the 
correlation coefficients of the method using the average 
motion mode function were almost equal to those of the 
method using the motion mode function of one subject and 
the method using nine measured parts, indicating that the 
method using the average motion mode function also 
ensured accuracy. Also, from Figure 20, the bimodal feature 
[14] that appears in the vertical floor reaction forces of one 
foot on each side in healthy walking appears as a trimodal 
feature in the composite vertical floor reaction forces 
presented. This result can be attributed to the fact that the 
acceleration of each unmeasured part was estimated 
accurately. 
Table 5 showed that in the direction of travel, the 
correlation coefficients of the method using the average 
motion mode function and the method using nine measured 
parts were slightly lower than those of the method using the 
motion mode function of one subject. The method using the 
averaged motion mode function, shown by the solid orange 
line in Figure 21, included high-frequency waves, resulting 
in error from the target value measured by the force plates. 
This factor is thought to have been caused by a decrease in 
the estimation accuracy of the upper and lower limbs in the 
acceleration estimation of the unmeasured parts. However, 
the walking direction, which did not show good accuracy in 
the acceleration estimation, showed a much higher 
correlation coefficient and improved accuracy in the floor 
reaction force than in the acceleration. This can be attributed 
to the fact that the accuracy of acceleration estimation for the 
large mass part was high, which reduced the influence of the 
small mass part whose acceleration estimation accuracy was 
low. In this paper, the acceleration of the unmeasured part 
was estimated using a common order. However, since the 
magnitude of the higher-order components differs depending 
on the part, there is a limit to the accuracy of the estimation 
using a common order, but it is thought that the amplitude 
and phase are aligned by using a common order to the 
higher-order components. 
VI. 
CONCLUSION AND FUTURE WORK 
In this paper, in order to reduce the number of sensors 
used for estimating the floor reaction force, we proposed a 
method to estimate the acceleration of the unmeasured part 
from the measured part using the average motion mode 
function derived from the trials of multiple subjects, and to 
estimate the composite floor reaction force in two directions 
from these results. The average motion mode function can be 
derived by dividing the unmeasured part by the measured 
part for each order, and is a function that shows the 
relationship between the motion of the measured part and the 
unmeasured part. In this paper, we improved the versatility 
of the system by using the average motion mode function, 
which is the average of the motion mode functions of five 
subjects for each order. 
In this paper, we first showed the correlation coefficients 
between the measured values of MC and the acceleration 
estimated using the average motion mode function and the 
acceleration estimated from the motion mode function of one 
subject, respectively, and indicated the usefulness of the 

102
International Journal on Advances in Systems and Measurements, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/systems_and_measurements/
2021, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
method for estimating the acceleration of the unmeasured 
part shown in Section Ⅳ.A using the average motion mode 
function. Next, the correlation coefficients were used to 
examine which part of the body is suitable to be selected as 
the measured part when estimating the acceleration of the 
unmeasured part. In this paper, the measured and 
unmeasured parts were selected by focusing on the parts with 
a large mass, which is important in estimating the floor 
reaction force. The optimal part where the acceleration of the 
unmeasured part was estimated with high accuracy differed 
depending on the subject and direction. However, when the 
measured part was the upper trunk, the acceleration of the 
upper trunk, average thigh, and lower trunk, where the mass 
of the whole body is particularly large, was estimated 
accurately. To reduce the number of sensors, we thought it 
appropriate to select the upper trunk as the measured part. In 
the future, we will investigate whether it is possible to 
estimate the floor reaction force more accurately by changing 
the measured part according to the estimated direction. 
Finally, the floor reaction forces in the vertical and walking 
directions were derived by estimating the accelerations of the 
remaining 8 parts using the average motion mode function 
with the upper trunk as the measured part. The correlation 
coefficient between the floor reaction force measured by the 
force plates and the floor reaction force derived using the 
average motion mode function was 0.934 in the vertical 
direction and 0.887 in the walking direction. The walking 
direction, which did not show good accuracy in the 
acceleration estimation, showed a much higher correlation 
coefficient and improved accuracy in the floor reaction force. 
In addition, the bimodal characteristics that appear in the 
vertical floor reaction forces of one foot on each side in 
healthy walking were trimodal in the composite vertical floor 
reaction forces shown in this study, which well captured the 
characteristics of healthy walking. Therefore, the usefulness 
of the proposed method for estimating the floor reaction 
force using the average motion mode function was 
confirmed. 
In the future, we will aim to further improve the 
versatility of the system using the average motion mode 
function, and propose a system that can accurately estimate 
the floor reaction force even for unknown subjects with 
different paces. 
ACKNOWLEDGMENT 
This work was supported by JSPS KAKENHI Grant 
Number JP18K11106. 
 
 
REFERENCES 
[1] S. Hontama, K. Shibata, Y. Inoue, and H. Satoh,” Estimation 
of Body Part Acceleration While Walking Using Frequency 
Analysis: Estimating head acceleration from movement of 
upper trunk,” CENTRIC 2020. 
[2] V. L. Chester, E. N. Biden, and M. Tingley, “Gait Analysis,” 
Biomed Instrum Techno, vol. 39, pp. 64–74, January 2005 
[3] W. R. Johnson, A. Mian, C. J. Donnelly, D. Lloyd, and J. 
Alderson, “Predicting athlete ground reaction forces and 
moments from motion capture,” Medical & Biological 
Engineering & Computing, vol. 56, pp. 1781–1792, 2018. 
[4] A. Rajagopal, C. L. Dembia, M. S. DeMers, and D. D. Delp, 
“Full-Body Musculoskeletal Model for Muscle-Driven 
Simulation of Human Gait,” IEEE Transactions on 
Biomedical Engineering, vol. 63, pp. 2068–2079, October 
2016. 
[5] L. Wang, Y. Sun, Q. Li, and T. Liu, “Estimation of Step 
Length and Gait Asymmetry Using Wearable Inertial 
Sensors,” IEEE Sensors Journal, vol. 18, pp. 3844–3851, May 
2018. 
[6] S. Zihajehzadeh and E. J. Park, “Regression Model-Based 
Walking Speed Estimation Using Wrist-Worn Inertial 
Sensor,” PLoS ONE, October 2016. Available from: 
https://doi.org/10.1371/journal.pone.0165211 
[7] T. Liu, Y. Inoue, K. Shibata, and K. Shiojima, “A Mobile 
Force Plate and Three-Dimensional Motion Analysis System 
for Three-Dimensional Gait Assessment,” IEEE Sensors 
Journal, vol. 12, pp. 1461–1467, May 2012. 
[8] A. Isshiki, Y. Inoue, K. Shibata, and M. Sonobe, “Estimation 
of Floor Reaction Force During Walking Using Physical 
Inertial Force by Wireless Motion Sensor,” HCI Int’l, vol. 714, 
pp. 249-254, May 2017, DOI: 10.1007/978-3-319-58753-
0_37, 2017, pp.22-33, ISSN:1348-711 
[9] M. Ae, H. Tang, and T. Yokoi, ”Estimation of Inertia 
properties of the Body Segments in Japanese Athletes,” Soc. 
Biomechanisms Jpn., vol. 11, 1992, pp. 22-33 (in Japanese). 
[10] A. Isshiki, Y. Inoue, K. Shibata, M. Sonobe, and A. 
Hashiguchi, “Estimation of Floor Reaction Forces during 
Walking Using a Small Number of Wearable Inertial 
Sensors,” The 47th Student Graduation Research Presentation 
Lecture, No.312, 2017 (in Japanese) 
[11] S. Hontama, Y. Inoue, and K. Shibata,” Characteristics of 
walking motion by using Frequency analysis: Transfer 
function for Upper body,” The Japan Society of Mechanical 
Engineers Chugoku-Shikoku Bracch , The 50th Student 
Graduation Research Presentation Lecture, No.06b3, 2020 (in 
Japanese) 
[12] T. Yokoi, K. Shibukawa, and A. Michiyoshi, ” Body segment 
parameters of Japanese children,” Physical Education 
Research., 31 (1)，53−66，1986 
[13] R. K. Jensen, “Estimation of the biomechanical properties of 
three body types using a photogrammetric method,” Journal 
of Biomechanics, vol. 11, pp. 349–358, 1978. 
[14] M. Masatoshi and K. Fukui, ” Research on walking of healthy 
people using force plate,” Rehabilitation Medicine, vol. 24, pp. 
93–101, 
1987. 
Available 
from: 
https://doi.org/10.2490/jjrm1963.24.93
 

