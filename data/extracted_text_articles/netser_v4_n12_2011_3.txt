A Trafﬁc Monitoring and Queue Detection System Based on an Acoustic Sensor
Network
Barbara Barbagli, Luca Bencini, Iacopo Magrini and Gianfranco Manes
Dept. of Electronics and Telecommunications
University of Florence
Via di Santa Marta 3, 50139 Florence, Italy,
Email: barbara.barbagli@uniﬁ.it, luca.bencini@uniﬁ.it,
iacopo.magrini@uniﬁ.it, gianfranco.manes@uniﬁ.it
Antonio Manes
Netsens S.r.l.
Via Tevere 70, 50019 Florence, Italy
Email: antonio.manes@netsens.it
Abstract—Wireless Sensor Networks for real time trafﬁc
monitoring in Intelligent Transportation Systems is currently
considered one of the challenging application area for this
emerging technology. The promise of an unmanaged infras-
tructure, with a continuously decreasing cost per unit, attracts
the attention of both ﬁnal users and system integrator, opening
new business opportunities. This paper describes a Trafﬁc
Monitoring Wireless Sensor Network system, based on acoustic
arrays and powered by an effective post-processing detection.
A practical case study is presented starting from a real problem
and reaching the best architectural solution with particular fo-
cus on hardware implementation and communication protocol
design. Finally, real experience results are shown to highlight
the reliability of the developed system.
Keywords-wireless sensor network; acoustic sensors; trafﬁc
monitoring; cross-layer routing protocol.
I. INTRODUCTION
Real-time trafﬁc monitoring and early queue detection
is of paramount importance in Intelligent Transportation
Systems (ITS). Distributed trafﬁc monitoring on a large
scale based on non intrusive/obtrusive solutions are highly
desirable for trafﬁc monitoring.
Conventional trafﬁc surveillance systems make use of
intrusive sensors such as inductive loop detectors or pressure
sensors, for high accuracy in vehicle detection. However,
these sensors disrupt trafﬁc during installation and repair,
and therefore have high installation and maintenance costs.
These limitations have pushed towards the development of
non-intrusive trafﬁc monitoring technologies, including laser
radars, passive infrareds, ultrasonics, passive acoustic arrays
and video cameras. These systems have high equipment
costs and their accuracy depends on environmental con-
ditions. Moreover video cameras have involved huge data
volume demands for a dedicated wired connection in order
to communicate with the central server. As a result these
solutions are not suitable for large-scale deployment and
hence are restricted to small scale applications, where iso-
lated monitoring points are located many kilometers apart.
Passive acoustic transducer-based surveillance systems
have also been developed, featuring vehicle classiﬁcation
and multi-lane resolution capability; this is based on pro-
cessing the characteristic sounds emitted by vehicles [3] [4].
Acoustic sensors are attractive especially for their low cost
and simple and non-intrusive installation, however they
require a sophisticated post-processing algorithm for extract-
ing useful information.
Another relevant requirement pushing towards the design
of an effective trafﬁc monitoring system is to provide high
spatial density measurements. A viable solution for achiev-
ing that purpose is a system based on a Wireless Sensor
Network (WSN) infrastructure offering advantages in terms
of ﬂexibility and a signiﬁcant reduction of installation costs;
therefore making large scale deployment possible.
Several solutions based on wireless sensors have been
investigated, including wireless magnetic sensors [5] [6], and
coherent cross-correlated acoustic transducer [8]. Ding et
al. [5] demonstrated wireless magnetic sensors embedded
in the road sampling the magnetic ﬁeld at its front and
back ends, and internally processing this data in order to
count vehicles for computing the average speed of passing
vehicles.
The requirements that adopting a WSN are expected
to satisfy in effective trafﬁc monitoring monitoring con-
cern both system level issues (i.e., unattended operation,
maximum network life time, adaptability or even self-
reconﬁgurability of functionalities and protocols) and ﬁnal
user needs (i.e., communication reliability and robustness,
user friendly, versatile and powerful graphical user inter-
faces). The most relevant mainly concerns the supply of
stand-alone operations. To this end, the system must be able
to run unattended for a long period also in the absence of
electricity. This calls for an optimal energy management
ensuring that the energy spent is directly related to the
amount of trafﬁc handled and not to the overall working
time.
An additional requirement is robust operative conditions,
which needs fault management, since a node may fail for
several reasons. Other important properties are scalability
and adaptability of the network’s topology, in terms of the
27
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

number of nodes and their density in unexpected events
with a higher degree of responsiveness and reconﬁgurability.
Finally, several user-oriented attributes, including fairness,
latency, throughput and enhanced data querying schemes
[10] need to be taken into account even if they could
be considered secondary with respect to our application
purposes because the WSN’s cost/performance trade-off.
In this paper, a WSN based on an array of acoustic sensors
that detect and process the sound waves generated by the
trafﬁc ﬂow using a low-cost microprocessor is proposed.
The paper is organized as follows: Section II provides
an outlook on the system’s composition and operation.
Section III and Section IV describe the hardware and the
basic operation of each constitutive element. Section V
discusses the communication protocol. Finally, Section VI
gives the experimental results of a continuous long-term
operation.
II. TM-WSN DESCRIPTION
This paper describes a novel trafﬁc monitoring (TM)
system based on a Wireless Sensor Network (WSN) in-
frastructure; the TM-WSN system allows trafﬁc monitoring
and queue detection to be performed in real-time at an
unprecedented space scale with an extremely low investment
in installation and maintenance costs.
A signiﬁcant characteristic of the system is the WSN
infrastructure that combines, in its basic module, two kinds
of nodes which are both based on acoustic sensors, yet
they employ different operation techniques and hence, have
different hardware characteristics.
The basic module of the system is composed of a Master
Node (MN), which has superior computational and energy
resources and is connected to a remote database via TCP/IP
over UMTS. The MN is wirelessly connected to a number
of regularly spaced Sensor Nodes (SNs) operating on a
low duty-cycle and woken-up on demand. A basic module
infrastructure deployed along the motorway is shown in
Figure 1 . This module can be spatially replicated on both
sides of the motorway to cover a wide area.
The sound signal is detected and processed by the em-
bedded resource of the MN using an original algorithm that
allow to automatically extract trafﬁc parameters on site.
The information is transmitted to a central server and made
available to a remote user.
When a queue or trafﬁc jam is detected at the MN
location the SNs are activated by the MN in order to locate
the position of the queue or trafﬁc jam, thus providing a
real-time picture of the trafﬁc ﬂow sampled at the same
space interval as the SN deployed on the motorway. The
communication between the devices is performed by a cross-
layer MAC Routing protocol which will be described in
Section V.
2
LWSN
MN3
SN7
SN6
SN10
SN9
8
SN
UMTS
Server
SN1
2
SN
2
MN
SN3
SN5
4
SN
1
MN
LWSN-segment
1
LWSN
Figure 1.
Basic system infrastucture.
III. MN DESIGN AND OPERATION
In this section is ﬁrst illustrated the MN hardware so-
lution adopted and then, the procedure allowing automatic
extraction on-site of trafﬁc parameters.
A. MN Hardware Design
The MN block diagram is shown in Figure 2. It is
composed of a Sensor Unit which detects the audio signal
coming from the road and a Computational Unit which
performs the signal processing and vehicle detection while
it simultaneously supports communication with both the
associated SNs by the RF Unit and with the central server
by the UMTS modem.
MIC 1
PROCESSING AND 
CONTROL UNIT
UMTS MODEM
RF UNIT
MIC 2
Sensor Unit
Figure 2.
MN hardware block diagrams.
The computational unit consists of a commercial computer
on module GUMSTIX VERDEX PRO XM-4 with a Marvell
PXA270 400 MHz processor equipped with 64 MB RAM
and 16 MB ﬂash memory, and operating with a Linux
OS. The audio signals detected by the acoustic sensors
are sampled at 16 KHz and quantized at 16 bit, then
processed with a real-time algorithm based on FFT routines
for estimating the time delay via a coherent cross-correlation
method.
A TCP-IP over UMTS Modem provides a bidirectional
connectivity to the central server thus enabling a remote
28
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

control of the MN operative parameters and creating an
upgrade of the systems. The RF unit is based on Texas
Instrument CC1000 low power transceiver operating in the
UHF ISM band, implementing an FSK Manchester coding.
The setup of the MN is packaged into a compact
lightweight panel which can be easy installed on the mo-
torway’s guardrail.
B. MN Operation and Parameters Extraction Procedure
All vehicles emit characteristic sounds when moving on
the road. The sound signal is connected to the source’s
position therefore, in reference to [4] [8] trafﬁc sensing and
vehicle detection can be achieved by processing the signal
detected by the acoustic sensor.
The sensor unit consists in a pair of microphones (MIC1
and MIC2) arranged in a characteristic setup and deployed
along the roadside, with the baseline parallel to the moving
direction of the source, as shown in Figure 3.
MIC1
MIC1
V
x-direction
O
X1
X2
L
Figure 3.
MN sensor unit setup.
The sound wave generated by a passing vehicle reaches
the two microphones at slightly different times due to the
difference in the air path; on the two signals a cross-
correlation method is applied to estimate the time delay
according to [4] [7].
The signal detected by the MIC1 and the MIC2 are
respectively:
s1(t) = s(t)
(1)
and
s2(t) = s(t − ∆t)
(2)
where s(t) is the sound wave generated by the source
(vehicle) and ∆t represents the time delay between the two
signals arriving at the two microphones.
The cross-correlation function of the two signals, R12(τ)
is formulated by:
R12(τ) = s1 ∗ s2(τ) = s ∗ s(τ − ∆t) = R(τ − ∆t)
(3)
where ∗ denotes the convolution and R(τ) the auto-
correlation function of s(t).
According to [9], the signal produced by vehicles is
a broad band, random-noise signal providing a cross-
correlation function with a distinct peak at |t − ∆t|.
In the cross-correlation domain, the position of the peak
represents the source’s time delay and changes with its
position. Mapping the position of the peak in a time interval
results in a digital Sound Map, which represents the source
motion along a predeﬁned track. A typical sound map is
shown in Figure 4(a); the x-axis represents the observation
time and the y-axis represents the time delay τ.
If further traveling speed is assumed as constant, the
detected sound trace could be described by an analytic
solution, accordingly with [], and could derive from the
sound path difference in the air and expressed by:
τ(t) =
1
Vs
q
45
50
55
60
65
70
75
−2
−1
0
1
2
x 10
−3
Time [s]
Delay Time [s]
(a) Sound Map.
45
50
55
60
65
70
75
−2
−1
0
1
2
x 10
−3
Time [s]
Delay Time [s]
(b) Sound Map after the post-processing.
Figure 4.
Sound Map before and after the post-processing.
109  
110  
111  
112  
113  
−1
−0.5
0
0.5
1
1.5
x 10
−3
Time [s]
Delay time [s]
τ1
τ2
t1
t2
Figure 5.
Vehicle detection.
As demonstrated in [8], the trace slope in this point is
proportional to the vehicle speed.
As mentioned before, multiple sound sources could appear
in the sound map. As in a vehicle the main acoustic source
is represented by vehicle tyres; each sound map for a
single vehicle, would consist of a two or more traces, each
corresponding to a vehicle axle. This phenomenon can be
observed in Figure 5.
To detect a vehicle transit, two symmetrical points cor-
responding to the positive time delay τ1 and the negative
time delay τ2 = −τ1 are positioned on the y-axis of the
Sound Map (see Figure 5). Those time delays correspond to
two symmetrical position, X1 and X2, of the vehicle along
the traveling path, whose spacing is L (see Figure 3 for
reference). A vehicle transit is detected if the sound trace
intercepts the values τ1 and τ2 in a sequence that occurs
when a vehicle pass through the two virtual positions X1
and X2. Therefore as τ1 and τ2 are selected in the linear
portion of the trace, the vehicle traveling speed, Vv, can be
easy calculated, according to the following expression:
Vv = L ∗ k
t2 − t1
(5)
where k is a scale factor taking into account the vehicle
axle tracks, Daxle, and t2 − t1 is the time interval taken by
the vehicle to cover the distance L, as shown in Figure 5.
The scale factor k is used to compensate the asymmetri-
cal behavior of a generic vehicle trace, due to the above
mentioned fact that there are two sound sources in the
vehicle’s front and back axle. Accordingly k is expressed
by L + Daxle/L and was estimated on a statistical basis.
The resulting approximation in estimating vehicle traveling
speed is consistent in our case, however, the system aims
at evaluating the average trafﬁc parameters, rather than the
vehicle parameters. Square and circle markers in Figure 5,
thus, represent the sequence associated with the transit of
a vehicle, while the vehicle speed is evaluated according
to (5).
10
20
30
40
50
60
70
80
90
100
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2 x 10
−3
Time [s]
Delay Time [s]
Figure 6.
Multiple detection transit.
In Figure 6, a Sound Map is reported, showing the
sequence of square and circle markers associated to multiple
vehicle detection obtained from the previously described
30
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

automatic procedure. As it can be observed all the passing
vehicles are successfully detected in this case.
The output of the trafﬁc parameters extraction routines is
represented by some trafﬁc parameters which indicate the
trafﬁc conditions at the MN location. These parameters are
included in a summary report and sent to the central server.
The previously described method for trafﬁc parameter
extraction was extensively tested during a long period of
continuous operation. In Section VI, we present the results
of the long-term system operation.
IV. SN DESIGN AND OPERATION
In this section is illustrated the hardware design of the SN
along with the SN operation.
A. SN Hardware Design
According to the proposed architecture, the sensor net-
work also includes SN with limited computational capability,
only relying on autonomous energy resources. The block
diagram of the SNs is represented in Figure 7.
MIC 1
PROCESSING AND 
CONTROL UNIT
RF UNIT
Sensor Unit
Figure 7.
SN hardware block.
The main components of a SN are: the Sensor Unit, which
consists of a single microphone, the Processing Unit ARM
CORTEX M3 72 MHz, the RF Unit which has a Texas
Instrument CC1000 low power transceiver operating in the
UHF ISM band, implementing an FSK Manchester code.
The SN primary energy source consists of a 3 V Li-Ion
rechargeable battery assisted by a 5 W solar panel as a
secondary source. To preserve the battery life, the SNs are
duty-cycled at an appropriate low rate.
B. SN Operation and Queue Detection Algorithm
As previously mentioned, the main job of the SNs is to
produce trafﬁc reports on-demand for dynamically locating
the position of a queue or trafﬁc jam. When a trafﬁc queue or
jam is detected at the MN location, the SNs associated with
the MN are switched to operative mode, the detection of
trafﬁc conditions (ﬂuid ﬂow or queue) is performed through
an analysis of the energy distribution features. As long as
the SNs stay in the operative mode, they regularly produce
a trafﬁc report containing trafﬁc conditions information
that is passed to the MN according to a scheduling time
interval. Communication between the devices is performed
by a cross-layer MAC Routing protocol as described in
Section V.
The MN reports the information to the central server
about the trafﬁc conditions at each individual SN; as a
consequence, the trafﬁc ﬂow distribution is sampled at the
same spacing interval as the SNs deployed on the motorway,
thus a complete real-time picture of trafﬁc ﬂow is provided
to the user/customer.
The SNs are able to estimate the acoustic energy generated
by the trafﬁc. The acoustic signal sensed by the microphone
is ﬁrst high-pass ﬁltered at 1 KHz to cut-off background
and wind noise components present in the environment.
High-pass ﬁltering is also useful to remove unwanted low-
frequency contributions generated by vehicles traveling in
the opposite carriageway, for instance, the sound generated
by the air-stream of trucks; high frequency (above 1 KHz)
energy components, mainly generated by the tyre noise of
vehicles traveling in the opposite carriageway, are greatly
attenuated by propagation effects. The energy detected by
the SN is dominated by the sound sources in the nearer car-
riageway result in a well deﬁned and space-limited acoustic
footprint.
In Figure 8, an energy distribution associated with a
trafﬁc ﬂow is presented. In the left side is a distinct peak
corresponding to a passing vehicle; in the center of the trace
a smoother energy distribution can be observed, representing
the standing vehicles.
0
20
40
60
80
100
120
140
0
0.05
0.1
0.15
0.2
0.25
Time [s]
Energy
Passing Vehicle 
Standing Vehicle
Figure 8.
Energy distribution.
In fact, at vehicle speed in excess to some 30 Km/h,
the dominant acoustic energy source is represented by tyres,
featuring well deﬁned energy peaks in the time domain;
for standing vehicles, however, the dominant acoustic en-
ergy source is represented by motor noise, featuring a
smoother energy distribution, with a much lower associated
energy average. The conditions of regular trafﬁc ﬂow and
queues/trafﬁc jams in the nearer carriageway can be classi-
ﬁed accordingly.
In fact, a ﬂuid trafﬁc condition is associated to the
presence of isolated energy peaks, whereas a queue or trafﬁc
jam condition is associated to an energy ﬂoor, with a much
31
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

lower associated energy average.
The processing unit computes the energy distribution in
the time domain and an algorithm based on a state machine
detects the passing vehicle. An adaptive threshold estimated
on the energy value’s moving average is on the basis of the
state machine. A block diagram of the processing is shown
in Figure 9.
HP Filter
Energy 
Distribution
Adaptive 
Threshold
State Machine
Decison
s(n)
 vehicle
state 
Figure 9.
Block diagram of SN operation.
Figure 10 shows the result of this process compared with
the sound map generated by the MN. It can be seen that in
this case the implemented algorithm is capable of detecting
all the peaks in the energy’s distribution, as the vehicles are
spaced a good distance apart. In heavier trafﬁc conditions,
however, the vehicle counting could be underestimated but,
in any case, the energy distribution represents a useful
indicator for estimating the trafﬁc ﬂow in the carriageway.
10
20
30
40
50
60
70
80
90
0
0.1
0.2
0.3
Time [s]
Energy
10
20
30
40
50
60
70
80
90
100
−2
−1
0
1
2 x 10
−3
Time [s]
Delay time [s]
Figure 10.
Correlation between energy distribution and sound map.
V. PROTOCOL DESIGN
The most relevant system requirements, which lead in
the design of an efﬁcient Medium Access Control (MAC)
and Routing protocol for WSNs, mainly concern power
consumption issues and the possibility of a quick set-up
and end-to-end communication infrastructure. This calls for
optimal energy management since a limited resources and
node failure may compromise WSN connectivity. Therefore,
the MAC and the network layer must be perfected ensuring
that the energy used is directly related to the amount of
handled trafﬁc and not to the overall working time.
Other important properties are the scalability and adapt-
ability of network topology, in terms of number of nodes and
their density. As a matter of fact, some nodes may either be
turned off or may join the network afterward.
Taking these requirements into account, a MAC protocol
and a multi-hop routing protocol were implemented. A
multi-hop approach was preferred as opposed to a star
topology because it also helps to realize an end-to-end
communication in the presence of obstacles (i.e., ﬂyovers,
trees, curves) that would otherwise prevent the establishment
of a direct link between the SNs and the MNs.
Let us start our analysis by considering the wireless net-
work architecture shown in Figure 1. It is comprised of two
opposite Line Wireless Sensor Networks (LWSNs) deployed
opposite each other (i.e., along the opposite carriageway of
a motorway). Each LWSN is composed by at least one MN
and a variable number of SNs. Let a segment be an array
of regularly spaced adjacent SNs of the same LWSN. Each
segment is associated with one or at most two MNs, the
right and the left one.
The proposed MAC and routing protocol are described
and the performance are presented in the following sections.
A. MAC Layer Protocol
The proposed MAC protocol is characterized by the state
diagram shown in Figure 11(a).
According to it, each node (master/sensor node) wakes
up independently, entering an initial idle state (init state) in
which it remains for the time interval necessary for perform-
ing the elementary CPU operations and to be completely
switched on (Tinit). Moreover, before entering the set-up
state, each node starts to organize the time into frames whose
durations are Tf.
In the set-up state each node tries to identify its neighbors
and to establish a time synchronization with them. To this
purpose it remains in a listening mode for a time interval
equal to Tset−up ≥ 2Tf and begins to periodically broadcast
a HELLO message sending its ID and its phase. The phase
is the time interval after which the sender exits from the set-
up state and enters the regime state. A node that receives a
HELLO message adds the source node to the list of its own
active neighbors and transmits an acknowledgement.
Once the set-up state has expired, each node enters the
regime state. Within this state the operation mode is duty
cycled with a periodic alternation of listening and sleeping
sub-periods whose time intervals are Tl and Ts respectively.
The duty cycle function is given by the following formula:
d = Tl
Tf
=
Tl
Tl + Ts
(6)
In the regime state each node is updated and tries to
preserve the synchronization with its neighbors. To this
purpose, as Figure 11(b) shows, it sends a frame-by-frame
HELLO message in a unicast way to the active nodes in its
list according to the phase transmitted by them in previous
HELLO messages. As in the set-up state, the HELLO
32
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

init
set-up
regime
off
battery<battery_low
battery<battery_low
num_neighbors
2
≥
num_neighbors
2
<
init
T
Tset up
−
(a) Finite state machine description of the proposed MAC
protocol, involving the transitions occurring among init, set-
up, regime and off states.
NODE 1
t
t
t
l
T
l
T
l
T
l
T
T l
l
T
s
T
s
T
s
T
f
T
f
T
f
T
NODE 2
NODE 3
HELLO MESSAGE
(b) MAC protocol HELLO messages exchange.
Figure 11.
MAC protocol description
message contains the ID and the phase that, in this case, is
the time interval after which the sender claims to be again
in the listening status waiting for the HELLO message. The
phase φ is evaluated according to the following rule:
φ1 = τ − Tl
(7)
if the node is in the sleeping mode, where τ is the time
remaining to the beginning of the next frame. Conversely, if
the node is in the listening status, φ is computed as:
φ2 = τ + Ts
(8)
The channel access is managed using the Carrier Sense
Multiple Access with the Collision Avoidance (CSMA/CA)
scheme, as speciﬁed in [11]. This mechanism is very ef-
fective in reducing collisions, while the problem of hidden
nodes [12] is still partially unsolved.
Each node remains in the regime state until there are at
least two neighbors, otherwise it reenters the set-up state in
search of connectivity.
To complete the protocol characterization, whenever a
node battery is depleted, this node turns off entering the
off state.
In order to fully characterize the proposed MAC approach,
the energy cost per frame interval of a single node (mas-
ter/sensor node) can be evaluated as follows:
C = crxdTf + csleep[Tf(1 − d) − NTpkt] + NCtx
[mAs]
(9)
where csleep and crx represent the sleeping and the receiving
costs [mA] and Ctx is the single packet transmission costs
[mAs], Tpkt is the HELLO packet time length [s] and ﬁnally
N is the number of neighbors.
In Figure 12, the energy cost per frame interval is shown
of each single node as a function of the number of its neigh-
bors. The considered parameters, summarized in Table I, are
those relative to the real hardware platform. Moreover, in
Figure 12 the accuracy of (9) is highlighted: the analytical
results are similar to those obtained with the simulation
Table I
DATA SHEET PARAMETERS OF THE CONSIDERED HARDWARE PLATFORM
Parameter
Symbol
Value
Frame interval
Tf
30 s
Listening interval
Tl
500 ms
Duty cycle
d
1.6 %
Sleeping cost
csleep
100 µA
Receiving cost
crx
25 mA
Packet transmission cost
Ctx
0.148 mAs
model developed through the network protocol simulator
NePSing [14].
2
443
16,600
)
4
6,042
16,190
969
16,242
16,443
16 200
16,400
16,600
rval (mAs)
Analytical results
Simulation results
5,746
15,894
16,042
16,190
15,850
15,969
16,242
16,443
16,000
16,200
16,400
16,600
me interval (mAs)
Analytical results
Simulation results
15,746
15,894
16,042
16,190
15,850
15,969
16,242
16,443
15,600
15,800
16,000
16,200
16,400
16,600
t per frame interval (mAs)
Analytical results
Simulation results
15,746
15,894
16,042
16,190
15,850
15,969
16,242
16,443
15,200
15,400
15,600
15,800
16,000
16,200
16,400
16,600
nergy cost per frame interval (mAs)
Analytical results
Simulation results
15,746
15,894
16,042
16,190
15,850
15,969
16,242
16,443
15,200
15,400
15,600
15,800
16,000
16,200
16,400
16,600
2
3
4
5
Energy cost per frame interval (mAs)
Number of neighbors
Analytical results
Simulation results
15,746
15,894
16,042
16,190
15,850
15,969
16,242
16,443
15,200
15,400
15,600
15,800
16,000
16,200
16,400
16,600
2
3
4
5
Energy cost per frame interval (mAs)
Number of neighbors
Analytical results
Simulation results
15,746
15,894
16,042
16,190
15,850
15,969
16,242
16,443
15,200
15,400
15,600
15,800
16,000
16,200
16,400
16,600
2
3
4
5
Energy cost per frame interval (mAs)
Number of neighbors
Analytical results
Simulation results
Figure 12.
Single node energy cost per frame interval
Finally the protocol is compared with S-MAC and Wise
MAC in terms of current consumption as the number of
neighbour nodes changes. The Figure 13 highlights the
computed performance.
B. Routing Layer Protocol
In order to evaluate the capability of the proposed MAC
scheme in establishing effective end-to-end communications
within each LWSN, a routing protocol was introduced and
integrated according to the cross layer design principle [13].
Periodical information is sent which is needed for building
and maintaining the local routing tables depicted in Table II.
It resorts to the signaling introduced by the MAC layer
with the aim of minimizing the overhead and making the
system more adaptable in a cross layer fashion. In particular,
33
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

2
3
4
5
6
500
505
510
515
520
525
530
535
Neighbour Nodes
Current Consumption [uA]
 
 
S−MAC
Wise MAC
Proposed Protocol
Figure 13.
Current Consumption vs. Neighbour Nodes
Table II
ROUTING TABLE GENERAL STRUCTURE
Master Node
Next Hop
Hop Count
Loop Flag
MN1
SN1
ηA
false
MN1
SN2
ηB
true
MN2
SN3
ηC
true
the parameters transmitted along a MAC HELLO message,
with period Tf, are the following:
• ID destination. If the sender node is in the set-up state,
the ID destination will be the broadcast one; otherwise,
it will be the ID of the receiver node.
• ID source. The ID source is the ID of the sender node.
• phase. If the sender node is in the set-up state, the phase
will be the time interval after which the sender node
exits from the set-up state and enters the regime state;
otherwise, it will be the schedule time at which the
sender node enters in listening mode according to (7)
and (8).
• ID MN1. If the sender node is a SN, the ID MN1 will
be the ID of the ﬁrst MN which the SN is associated
with; otherwise if the sender node is a MN, it will be
set at 0.
• Next Hop 1 (NH1). If the sender node is a SN, the
NH1 will be the ID of the next hop neighbor used by
the SN to reach the MN1 with the minimum number
of hops; otherwise if the sender node is a MN, it will
be set at 0.
• Hop Count 1 (HC1). If the sender is a SN, the
HC1 will be the distance from the MN1 in terms
of minimum number of needed hop; otherwise if the
sender node is a MN, it will be set at 0.
• ID MN2. If the sender node is a SN, the ID MN2
will be the ID of second MN which the SN is associated
with; otherwise if the sender node is a MN, it will be
set at 0.
• Next Hop 2 (NH2). If the sender node is a SN, the
NH2 will be the ID of the next hop neighbor used by
the SN to reach the MN2 with the minimum number
of hops; otherwise if the sender node is a MN, it will
be set at 0.
• Hop Count 2 (HC2). If the sender is a SN, the
HC2 will be the distance from the MN2 in terms
of minimum number of needed hop; otherwise if the
sender node is a MN, it will be set at 0.
In the init state, each SN sets NH1 and NH2 at 0 and
HC1 and HC2 at a high value chosen a priori.
In the set-up state, each LWNS begins to self-organize.
Starting from the MNs, the routing information is ﬂooded
through the network by each SN.
The routing table is ﬁlled up or updated by each node
according to the following rules.
As an SN receives a HELLO message from an MN it
is associated with, it inserts a row in its routing table (or
updates an existing one) assigning the ID source to the
”Master Node” and the ”Next Hop” ﬁelds, a value equal
to 1 to the ”Hop Count” ﬁeld and the false value to the
”Loop Flag” ﬁeld.
As an SN receives a HELLO message from an SN
belonging to the same segment.
1) it inserts a row in its routing table (or updates an
existing one) assigning ID MN1 to the ”Master
Node” ﬁeld, the ID source to the ”Next Hop” ﬁeld
and HC1 to the ”Count Hop” ﬁeld;
2) if NH1 parameter contains its own ID, it will assign
the true value to the ”Loop Flag” ﬁeld; otherwise it
increments by 1 the ”Hop Count” ﬁeld and assigns the
false value to the ”Loop Flag” ﬁeld.
The same procedure is ran for the ID MN2, NH2 and
HC2 parameters.
As an SN receives a HELLO message from an SN be-
longing to an adjacent segment, it discards the information.
As an MN receives a HELLO message from an SN
belonging to the left or the right segment, it discards the
information concerning itself and stores the other ones in its
routing table.
As a node receives a HELLO message from a node
belonging to the opposite LWSN, it stores the information
in its routing table without any control or preprocessing.
Finally, in the regime state each node updates its routing
table frame by frame thanks to the reception of HELLO
messages from its neighbors. A node deletes an active
neighbor from its routing table if it does not receive any
acknowledgment for three consecutive frames after the trans-
mission of HELLO messages.
Figure 14 graphically shows the procedure described
above for a simple LWSN composed by one segment. In
this example it is suppose that each node communicates
only with the two adjacent nodes. Let us consider the node
34
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

labeled SN1. During the ﬁrst frame it receives two HELLO
messages, one from MN1 and the other from SN2 (see
Figure 15). Then it updates its routing table. Only the ﬁrst
row contains useful information. According to the network
topology taken into the account, SN1 has to wait the second
frame to complete its routing table and know the next hop
to reach the MN2. During the third frame a loop is veriﬁed.
0
MN1
ID dest
ID source
phase
ID MN1
NH1
HC1
5
0
0
0
ID MN2
NH2
HC2
0
0
0
From MN1
0
SN2
ID dest
ID source
phase
ID MN1
NH1
HC1
2
MN1
SN2
infty
ID MN2
NH2
HC2
MN2
SN2
infty
From SN2
Figure 15.
HELLO messages sent by MN1 and SN2 during the ﬁrst
frame
Once the routing table has been ﬁlled, each node may
derive the proper metric depending on the type of the
application message that it has to manage. The application
messages are subdivided into two categories: query mes-
sages, sent by the MNs to query the SNs, and response
messages, sent by the SNs in response to a query message.
If an SN has to send a response message, it will select from
its routing table the next hop neighbor that has the ”Master
Node” ﬁeld equal to the ID of the destination MN, the
minimum ”Hop Count” value and the ”Loop Flag” ﬁeld set
at false. Then it forwards the message to it. This procedure
is performed by every SN received. If an SN receives a
query message sent by an MN it is associated with, it will
send the message to every neighbor that belongs to the same
segment and has the ”Master Node” ﬁeld equal to the ID of
the sender MN, the ”Loop Flag” set to true and the ”Hop
Count” value higher than its own MN distance value.
A recovery state is introduced to provide a fault-tolerant
communication. If an SN does not ﬁnd any neighbor of the
same segment for establishing an end-to-end communication
with one of the MNs it is associated with, it will send a
HELP message to all the active neighbors of the opposite
LWSN. Therefore they look for an alternative path to reach
the involved MN, trying to establish a link with a node
located in the same segment of the calling-for-help node.
VI. EXPERIMENTAL RESULTS
A prototype, composed of a basic unit of the system
has been deployed near Florence, along the A11 highway
operated by Autostrade per l’Italia SpA (ASPI) in order
to obtain on-ﬁeld testing and evaluation (Figure 16). The
system has been placed closely to a loop detector to test the
MN functionality.
The MN unit was ﬁrst deployed on May 2009; since then
it has undergone extensive operation, regularly collecting
Figure 16.
Prototype system photograph.
and transmitting trafﬁc ﬂow reports for the central server
at a 60 second rate. Various data typologies were collected
by the system to monitor the trafﬁc ﬂow, jams or queues.
Some results are provided in the following ﬁgures.
In Figure 17, a weekly data collection of vehicle transit
and average speeds is shown, highlighting the periodicity
of the trafﬁc ﬂow with different behavior depending on the
day and hours. The MN yield is validated by the comparison
with the loop detector (Figure 18). As it is shown, the two
systems have collected the same results in terms of shape
and vehicle transit; only slightly differences can be evaluated
comparing the two graph. During the night, in fact, there is
an overestimation of the vehicle transit due to a preliminary
setup of the system related to the noise ﬂoor site.
17
18
19
20
21
22
23
0
10
20
30
40
Vehicle Number
17
18
19
20
21
22
23
0
50
100
150
200
Speed Vehicle
Figure 17.
Vehicle transit and average speed for a weekly observation
slot.
As a consequence, the MN information is now fully
integrated into the ASPI information system; Figure VI
35
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

SN1 ROUTING TABLE
SN2 ROUTING TABLE
Master Node
Next Hop
Hop Count
Loop Flag
MN1
MN1
1
false
MN1
SN2
infty
false
MN2
SN2
infty
false
Master Node
Next Hop
Hop Count
Loop Flag
MN2
MN2
1
false
MN2
SN1
infty
false
MN1
SN1
infty
false
MN1
SN1
SN2
2
MN
MN1 ROUTING TABLE
MN2 ROUTING TABLE
Master Node
Next Hop
Hop Count
Loop Flag
MN2
SN1
infty
false
Master Node
Next Hop
Hop Count
Loop Flag
MN1
SN2
infty
false
1st frame
SN1 ROUTING TABLE
SN2 ROUTING TABLE
Master Node
Next Hop
Hop Count
Loop Flag
MN1
MN1
1
false
MN1
SN2
infty
false
MN2
SN2
2
false
Master Node
Next Hop
Hop Count
Loop Flag
MN2
MN2
1
false
MN2
SN1
infty
false
MN1
SN1
2
false
MN1 ROUTING TABLE
MN2 ROUTING TABLE
Master Node
Next Hop
Hop Count
Loop Flag
MN2
SN1
infty
false
Master Node
Next Hop
Hop Count
Loop Flag
MN1
SN2
infty
false
2nd frame
SN1 ROUTING TABLE
SN2 ROUTING TABLE
Master Node
Next Hop
Hop Count
Loop Flag
MN1
MN1
1
false
MN1
SN2
2
true
MN2
SN2
2
false
Master Node
Next Hop
Hop Count
Loop Flag
MN2
MN2
1
false
MN2
SN1
2
true
MN1
SN1
2
false
MN1 ROUTING TABLE
MN2 ROUTING TABLE
Master Node
Next Hop
Hop Count
Loop Flag
MN2
SN1
3
false
Master Node
Next Hop
Hop Count
Loop Flag
MN1
SN2
3
false
3rd frame
Figure 14.
Example of Routing Tables
(a) Loop Detector.
1 2 3 4 5 6 7 8 9 1011121314151617181920212223
10
15
20
25
30
35
40
45
15/09/2010 Vehicle transit
Hour
Transit / Minute
(b) Audio System.
Figure 18.
Comparison between audio sensor and loop detector results.
shows the ASPI public user interface where information
from various sensors typologies are available. In particular, a
summary report obtained by the MN is presented. Currently
the ASPI interface is not able to present SN reports in
graphic format; this work is still in progress.
Extensive tests during the period of operation have pro-
vided the motorway practitioners with a complete report on
trafﬁc trends. Due to the yield and easy deployment of the
system, a 50 km, dual carriageway complete installation is
planned by ASPI to fully exploit the potential of the system
in the A1 motorway, between Florence and Arezzo.
VII. CONCLUSION
In this paper, a novel sensor network architecture and
communication protocol for trafﬁc surveillance has been
proposed, exhibiting the unique feature of providing a com-
plete and immediate trafﬁc ﬂow status in real-time at an
unprecedented scale. The main features are low installation
36
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

Figure 19.
ASPI user interface.
Figure 20.
Daily report.
and maintenance costs due to the sensing elements based on
the use of passive acoustic transducers. Experimental results,
coming from long-term testing performed on a motorway,
have demonstrated the effectiveness and yielding of the
approach for providing trafﬁc authorities with detailed in-
formation about trafﬁc parameters. Thanks to the promising
results obtained by the pilot site, ASPI has approved an
extensive system installation along the A1 motorway.
REFERENCES
[1] Barbagli, B.; Magrini, I.; Manes, G.; Manes, A.; Langer,
G.; Bacchi, M.; , ”A Distributed Sensor Network for
Real-Time Acoustic Trafﬁc Monitoring and Early Queue
Detection,” Sensor Technologies and Applications (SEN-
SORCOMM), 2010 Fourth International Conference on ,
vol., no., pp.173-178, 18-25 July 2010 doi: 10.1109/SEN-
SORCOMM.2010.102
[2] Klausner, A.; Rinner, B.; Teng, A.; , ”I-SENSE: Intel-
ligent Embedded Multi-Sensor Fusion,” Intelligent Solu-
tions in Embedded Systems, 2006 International Work-
shop on , vol., no., pp.1-12, 30-30 June 2006 doi:
10.1109/WISES.2006.329120
[3] Klausner, A.,Erb, S.,Tengg, A.,Rinner, B.:DSP Based
Acoustic Vehicle Classiﬁcation for Multi-Sensor Real-
Time Trafﬁc. Graz University of Technology, Graz, Aus-
tria.
[4] Forren, J.F.; Jaarsma, D.; , ”Trafﬁc monitoring by tire
noise,” Intelligent Transportation System, 1997. ITSC
’97., IEEE Conference on , vol., no., pp.177-182, 9-12
Nov 1997 doi: 10.1109/ITSC.1997.660471
[5] Ding, J.; Cheung, S.-Y.; Tan, C.-W.; Varaiya, P.; , ”Signal
processing of sensor node data for vehicle detection,”
Intelligent Transportation Systems, 2004. Proceedings.
The 7th International IEEE Conference on , vol., no., pp.
70- 75, 3-6 Oct. 2004 doi: 10.1109/ITSC.2004.1398874
[6] Cheung, S. ,Coleri, S. ,Varaiya, P.:Trafﬁc Surveillance
with Wireless Magnetic Sensors. University of California,
Berkley. USA
[7] Knapp, C.; Carter, G.; , ”The generalized correla-
tion method for estimation of time delay,” Acous-
tics, Speech and Signal Processing, IEEE Transac-
tions on , vol.24, no.4, pp. 320- 327, Aug 1976 doi:
10.1109/TASSP.1976.1162830
[8] Shiping Chen; Ziping Sun; Bridge, B.; , ”Trafﬁc monitor-
ing using digital sound ﬁeld mapping,” Vehicular Tech-
nology, IEEE Transactions on , vol.50, no.6, pp.1582-
1589, Nov 2001 doi: 10.1109/25.966587
[9] Brockmann, E.M.; Kwan, B.W.; Tung, L.J.; , ”Audio
detection of moving vehicles,” Systems, Man, and Cy-
bernetics, 1997. ’Computational Cybernetics and Simu-
lation’., 1997 IEEE International Conference on , vol.4,
no., pp.3817-3821 vol.4, 12-15 Oct 1997 doi: 10.1109/IC-
SMC.1997.633265
[10] Al-Karaki, J.N.; Kamal, A.E.; , ”Routing techniques in
wireless sensor networks: a survey,” Wireless Communi-
cations, IEEE , vol.11, no.6, pp. 6- 28, Dec. 2004 doi:
10.1109/MWC.2004.1368893
[11] 802.15.4-2003: part 15.4: Wireless Medium Access Con-
trol (MAC) and Physical Layer (PHY) Speciﬁcations
for Low-Rate Wireless Personal Area Networks (LR-
WPANs). IEEE Std., October 2003. [Online]. Available:
www.ieee.org.
[12] Mohapatra, P., Krishnamurthy, S.V.: Ad Hoc Networks-
Technologies and Protocols. Springer Science & Business
Media Inc., 2005.
[13] Shakkottai, S.; Rappaport, T.S.; Karlsson, P.C.; , ”Cross-
layer design for wireless networks,” Communications
Magazine, IEEE , vol.41, no.10, pp. 74- 80, Oct 2003
doi: 10.1109/MCOM.2003.1235598
[14] Pecorella, T.: NePSing - Network Protocol Simulator ng.
[Online] Available: http://nepsing.sourceforge.net/.
37
International Journal on Advances in Networks and Services, vol 4 no 1 & 2, year 2011, http://www.iariajournals.org/networks_and_services/
2011, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

