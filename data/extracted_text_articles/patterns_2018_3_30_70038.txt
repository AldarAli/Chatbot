Improved Gas Detection Algorithm for FTIR-Based Hyperspectral Imaging 
System Using Normalized Matched Filter  
 
Hyeong-Geun Yu, Jae-Hoon Lee, Dong-Jo Park 
School of Electrical Engineering 
Korea Advanced Institute Science and Technology 
291 Daehak-Ro, Yuseung-Gu, Daejeon, Republic of Korea 
elloss@kaist.ac.kr, ljhinlove@kaist.ac.kr, 
djpark@kaist.ac.kr 
Hyeon-Woo Nam, Byeong-Hwang Park 
CRB Defense Technology Directorate, 
Agency for Defense Development, 
P. O. Box 35, Yuseung-Gu, Daejeon, Republic of Korea 
hyunwoonam@add.re.kr, pbh1348@add.re.kr  
 
 
Abstract— A Hyperspectral Imaging System (HIS) can be used 
to detect a harmful gaseous plume from a long distance. Each 
pixel in the HIS can obtain a radiance spectrum. The 
hazardous gaseous plume has a unique pattern expressed in 
the radiance spectrum. A Normalized Matched Filter (NMF) is 
an algorithm extracting the absorption pattern from the 
radiance spectrum. We propose to apply a NMF algorithm into 
the brightness temperature spectrum in order to detect 
chemical 
warfare 
agents 
(CWAs). 
Simulation 
results 
demonstrate 
that the 
proposed 
algorithm significantly 
improves the detection performance. 
Keywords- Gas detection, Hyperspectral Image. 
I. 
 INTRODUCTION 
Passive remote sensing using a Hyperspectral Imaging 
System (HIS) based on Fourier Transform InfraRed (FTIR) 
spectrometers is known as a key technology to detect 
hazardous gases in the atmosphere. The HIS, which consists 
of an FTIR spectrometer and a focal plane array detector, can 
provide not only spectral information but also spatial 
information. Each pixel in the HIS can obtain the radiance 
spectrum for the corresponding field of view (FOV) from a 
standoff distance.  
Generally, the hazardous gaseous plume present in the 
atmosphere has a specific radiance spectrum pattern. The 
spectrum measured by the HIS is a combined spectrum of 
the gaseous plume and the background. The presence of the 
gaseous plume can be determined by extracting the 
absorption pattern of the target gas from the radiance 
spectrum measured by the HIS instrument [1]. A Normalized 
Matched Filter (NMF) can be used to extract the absorption 
pattern from the measured radiance spectrum and detecting 
the gaseous plume [2]. 
In this paper, we propose an algorithm that transforms 
the measured radiance spectrum into brightness temperature 
and adapts the NMF to the brightness temperature spectrum. 
Since in the brightness temperature domain, the background 
spectrum is constant, it is easier to extract the target pattern. 
The rest of this paper is organized as follows. Section II 
describes transforming a radiance spectrum into a brightness 
temperature spectrum. Section III addresses the proposed 
normalized matched filter. Section IV presents the 
experimental results. The acknowledgement and conclusions 
close the article. 
II. 
BRIGHTNESS TEMPERATURE SPECTRUM 
The measured spectrum for each pixel obtained from the 
HIS equipment is the radiance spectrum. The envelopes of 
radiance spectra are different according to the temperature of 
the gaseous plume and the background. The radiance 
spectrum generally does not have constant baseline. It is 
difficult to extract the pattern of gases from the radiance 
spectrum by these reasons. On the other hand, the brightness 
temperature spectrum of the background is nearly constant in 
the range of 925 – 1440 
1
cm where most Chemical Warfare 
Agents absorb [1]. For these reasons, we transform the 
radiance spectrum into the brightness temperature spectrum 
Tmeas ( )
v   using Plank’s function, as follows: 


 
 
2
3
,
2
ln
1
meas
meas
hcv
T
v
hc v
k
L
v


 








where h  is Plank’s constant, c  is the speed of light, k  is 
Boltzmann’s constant, v  is the wavenumber, and 
Lmeas ( )
v  is 
the measured spectral radiance for the wavenumber. 
III. 
NORMALIZED MATCHED FILTER 
Let 
0
H  and 
1
H  denote the absence and presence of a 
target 
gas, 
respectively. 
The 
measured 
brightness 
temperature spectrum x  is described as the following two 
hypotheses:  


0
1
 ,               
,
 
,        
,
H
g
H

 


v
x
s
v


where s  is the target gaseous absorption spectrum, v  is the 
background clutter, i.e., 


~
b ,
b
N
v
m C
and g  is the 
amount of a gas. 
b
m  and 
b
C are denoted as mean and 
covariance of background clutter. Using the Generalized 
37
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-612-5
PATTERNS 2018 : The Tenth International Conference on Pervasive Patterns and Applications

Likelihood Ratio Test (GLRT) approach [2], we obtain the 
NMF detector  







0
1
2
  
  
T
H
NMF
T
T
H
T




s x
s s
x x


where 
1/2(
)
b
b



s
C
s
m
and 


1/2
.
b
b



x
C
x
m
 If 
TNMF
 is 
larger than a detection threshold 
,
  the decision is 
H1,
 
otherwise it is 
H0.
 
IV. 
SIMULATION RESULT 
The data used for the experiments were obtained with a 
FTIR passive remote-sensing equipment, HI-90 by Bruker 
Optics. It can provide a datacube with a spectral resolution of 
4 
1
cm  in the spectral range of 900 ~ 1260 
1
cm  and a spatial 
resolution of 128 128

 pixels at a high frame rate. 
Figure 1 shows radiance spectra (a) and the brightness 
temperature spectra (b) of each pixel of the hyperspectral 
image at the background and a sulfur hexafluoride (
6
SF ) 
gaseous plume filled in a gas cell. The figure shows that a 
particular absorption pattern of 
6
SF  at a spectral range near 
950 
1
cm . the absorption pattern appears more prominently 
in the brightness temperature spectrum than in the radiance 
spectrum. 
We 
compare 
our 
proposed algorithm 
with the 
conventional gas detection algorithm, which uses the NMF 
to the radiance spectrum. Figure 2 depicts the Receiver 
Operating Characteristic (ROC) curve, which presents the 
detection performance of the algorithm. The proposed 
algorithm has better performance than the conventional 
algorithm because the brightness temperature spectrum is 
better than the radiance spectrum for finding the absorption 
pattern of a gas by applying the NMF.  
Figure 3 shows the detection results of the proposed 
algorithm and the conventional algorithm. We set the 
detection thresholds   of two algorithms so that the 
probability of false alarm 
fa
P  is 0.005.  
 
Figure 1.  Radiance spectra (a) and brightness temperature spectra (b)  
of a gas plume and the background 
 
Figure 2.  ROC curve of proposed algorithm and conventional algorithm 
In case that the proposed algorithm detects gas at the pixel, 
the green color is mapped. In case that the both algorithms 
detect gas at the pixel, it is expressed in red color. We can 
see that the NMF in the brightness temperature spectrum is 
better than the NMF in the radiance spectrum. 
V. 
CONCLUSIONS 
We proposed a hazardous-gaseous plume detection 
algorithm for the FTIR-based HIS. First, the measured 
radiance spectra are transformed into the brightness 
temperature spectrum using Plank’s function. Gas detection 
is performed by applying the NMF to the brightness 
temperature spectrum. The proposed algorithm outperforms 
the existing algorithm which applies the NMF to the radiance 
spectrum. 
ACKNOWLEDGMENT 
This work was supported by the Agency for Defense 
Development of the Republic of Korea. 
REFERENCES 
[1] R. Harig and G. Matz, “Toxic Cloud Imaging by Infrared 
Spectrometry: A Scanning FTIR System for Identification and 
Visualization,” Field Anal. Chem. Technol., vol. 5, no. 1–2, 
pp. 75–90, 2001. 
[2] D. G. Manolakis, S. E. Golowich, and R. S. DiPietro, “Long-
Wave Infrared Hyperspectral Remote Sensing of Chemical 
Clouds: A Focus on Signal Processing Approaches,” IEEE 
Signal Process. Mag., vol. 31, no. 4, pp. 120–141, Jul. 2014. 
 
 
Figure 3.  Detection results of the proposed algorithm 
38
Copyright (c) IARIA, 2018.     ISBN:  978-1-61208-612-5
PATTERNS 2018 : The Tenth International Conference on Pervasive Patterns and Applications

