An Effective transmit Weight Design for DPC with Maximum Beam in Multi-user 
MIMO Downlink 
Cong Li,   Yasunori Iwanami 
Department of Computer Science and Engineering, Graduate School of Engineering 
Nagoya Institute of Technology, Nagoya, Japan 
E-mail:  chx17515@stn.nitech.ac.jp, iwanami@nitech.ac.jp 
 
Abstract—A novel transmit scheme is proposed for the 
cancelation 
of 
Inter-User 
Interference 
(IUI) 
and 
the 
improvement of achievable sum-rate of system in Multi-User 
Multiple-Input Multiple Output (MU-MIMO) downlinks. 
Particle Swarm Optimization (PSO) algorithm is employed to 
solve the constrained nonlinear optimization problem for 
obtaining the optimal transmit weights. Compared with the 
conventional Dirty Paper Coding (DPC) having single receive 
antenna, the proposed scheme applies the principle of DPC to 
cancel the IUI in MU-MIMO downlinks, where the Mobile 
Station (MS) users are equipped with multiple receive 
antennas. With the Channel State Information (CSI) known at 
the Base Station (BS) and the MS, the eigenvalues for all user 
channels are calculated first and then the user with the 
maximum eigenvalue is selected as the 1-st user. For the 
remaining users, the users are sequentially processed and the 
transmit weights are generated from the previously selected 
users by using the Particle Swarm Optimization (PSO) 
algorithm, which makes the transmit gain for each user as 
large as possible. The analysis of computa-tional load and 
simulation results verify the effectiveness of the proposed 
scheme. 
Keywords-Multi-user MIMO downlink, Capacity, Dirty Paper 
Coding (DPC), Particle Swarm Optimization (PSO). 
I. 
 INTRODUCTION 
Recently, MU-MIMO schemes have attracted consider-
able interests toward the next generation wireless 
communication systems MU-MIMO because of its potential 
for increasing capacity [1]-[5]. In scenario of MU-MIMO 
downlink, the base station transmits spatially multiplexed 
signals to multiple users simultaneously, and attempts to 
transmit independent signal streams to all users over the 
same frequency. However, it suffers from the Inter-User 
Interference (IUI) in the received signal at each user. To 
mitigate the IUI, many linear precoding techniques have 
been employed to eliminate the IUI, such as the channel 
inversion [4] and Block Diagonalization (BD) schemes [5]. 
The Channel Inversion (CI) method pre-processes the 
transmit signals with the channel pseudo-inverse to suppress 
the IUI. In the case of highly independent channels, Zero 
Forcing (ZF) transmit weight can completely remove the 
IUI, but it leads to the noise enhancement at the receiver and 
reduces of achievable rate. Though the transmit weight with 
Minimum Mean-Squared Error (MMSE) criterion, can 
achieve the throughput increase, however it results in 
vestigial level of IUI. BD scheme is a well-known linear 
precoding technique, which decomposes MU-MIMO 
channels into multiple parallel SU-MIMO channels to 
completely cancel the IUI by using orthogonal space. 
However, these schemes impose a restriction on the system 
configuration in respect of the number of receive antennas, 
that is, only the number of transmit antennas at BS is larger 
than the sum of receive antennas of all users, BS can 
provided enough degrees of freedom to force the IUI to zero 
at each MS. In addition, the correlation among users also 
degrades the system performance. Thus we should take care 
to avoid the spatial multiplexed users with highly correlated 
channel. 
DPC technique not only approaches the capacity more 
closely, but also suppresses the IUI completely [6]-[8]. 
However, 
the 
conventional 
DPC 
based 
on 
QR 
decomposition is restricted to the case of single receive 
antenna at each MS. The Maximum Beam (MB) transmit 
scheme in [9] utilizes the eigenvector corresponding to the 
maximum eigenvalue of desired user channel as the transmit 
weight, but the IUI among users is the serious problem. To 
assure the independence among users, especially in the case 
of many users, the author gave an imperfect block 
diagonalization method to reduce the IUI by employing 
Gram-Schmidt orthonormalization on transmit weights. But 
this method needs to keep the balance between IUI and 
transmit gain. In [10] a jointly design of a transmit scheme 
is proposed, where the near-orthogonal effective channels 
are success-sively obtained from 1-th user to the last user by 
subtracting the interference components from the preceding 
users. However, the interference among users cannot be 
cancelled completely because of near orthogonality.  
Particle Swarm Optimization (PSO), first proposed by 
Kennedy and Eberhart in 1995 [11], is developed from the 
swarm intelligence and based on the research of flock 
movement behaviour of birds flock finding foods [12]-[15]. 
PSO is employed in many optimization problems, especially, 
in the optimization of continue space, it shows the better 
computational efficiency than the other algorithm, such as 
Genetic Algorithm (GA). Recently, the optimal algorithms 
PSO have been considerable interest in Multi-user MIMO.  
A PSO aided optimal Multi-user MIMO linear precoding 
scheme is proposed in [14], where PSO is used to search the 
optimal transmit weight which make SINR maximum at 
each MS. Though the IUI can be completely moved by 
multiplying decoder matrix, it leads noise enhancement and 
large computational load. In this paper, we proposed a novel 
MU-MIMO downlinks transmit scheme not only to obtain 
the optimal transmit weights for each user but also to 
eliminate the IUI completely. We first select the user with 
the maximum eigenvalue as the 1-st user by calculating 
eigenvalues of all users. Then we obtain the possible 
transmit weight for the next user by using the PSO 
algorithm, which makes sure that the selected user has an 
24
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

optimal accessible SNR. The remaining transmit weights are 
generated by the same method as the previous users. In the 
proposed scheme, we introduced the DPC principle to 
remove the IUI at the BS.  
This paper is organized as follows. In Section II, we will 
present the system model of MU-MIMO. In Section III, we 
propose the optimal transmit weight based on the PSO 
algorithm for each user. The simulation results are given in 
Section IV, in which the proposed scheme shows the 
excellent BER performance compared with the conventional 
schemes. Finally the conclusions will be made in Section V. 
We illustrate some of the notations as follows; vectors and 
matrixes are expressed by bold letters, we use
[ ]
E  , [ ]T

 and 
[ ]H

as the expectation, transpose and conjugate transpose of 
matrix, respectively. 
II. 
SYSTEM MODEL 
We consider the downlink multi-user MIMO system with 
T
N  transmit antennas and 
( )
nRk
 receive antennas at the k -th 
user, as shown in Fig. 1, where 
Nu
 is the number of 
multiple antenna users. In this paper, we focus on the flat 
Rayleigh (i.i.d.) fading channel model, because the 
wideband 
scheme, 
such 
as 
the 
OFDM, 
can 
be 
accommodated at each frequency index. We assume that the 
MIMO channel matrix 
( )
(
1,2,
,
)
k
T
nR
N
k
u
k
N



H
C
 is 
available at BS and MS. 
Precoding
1
2
T
N
User 1
1
 
R1
n
User k
1
 
Rk
n
User Nu
1

RN 
n
Hk
User selection  Scheme
BS
Channel feedback
 
Fig. 1 Downlinks of multi-user MIMO 
 
The 
1
k
R
n   received signal at the k -th user is written as 
1,
u
N
k
k
k
k
k
j
j
k
k
j k






y
H M x
H M x
n                (1) 
where
kx
 and 
kn
are transmit signal vector additive 
Gaussian noise and 
k
M  is transmit weight at the k -th user. 
In this paper, we only focus on one transmit stream for each 
user and assume that 
(
)
H
k
k
E

x x
I ,
2
(
)
H
k
k
E

n
n n
I ,
(
)
H
k
k
E

x n
0      (2) 
III. 
PPROPOSED OPTIMAL TRANSMIT WEIGHTS BASED ON 
PARTICLE SWARM OPTIMIZATION 
The principle of conventional DPC based on QR 
decomposition indicates that the sufficient condition of the 
feasibility of DPC is the existence of lower or upper 
triangular matrix derived from the channel matrix. Since the 
IUI cannot be removed at the receiver in the case of MB, we 
carefully design the transmit weight for each user to 
transform the effective channels to the lower or upper 
triangular matrices. Then we can use DPC to remove the IUI 
completely. However, how to obtain the optimal transmit 
weight becomes a problem, referred to as the problem of 
optimal transmit weight design. 
A. Transmit scheme for eliminating IUI 
We design the transmit weights for each user as the 
following steps. First, we employ Singular Value 
Decomposition (SVD) for on user channels. 
1
2
[
,
,
,
] ,(
1,2,
,
)
NT
H
k
k
k
k
k
k
u
k
N


H
U Λ v v
v
       (3) 
To achieve the optimal transmit weight for the 1-st user, 
we perform the following algorithm. 


1
1
,
argmax(
),
1,
k
k
k
k
k
u
k
N


H
H v
H v
                    (4) 
Then, the transmit weight for the 1-st user is given by 
1
1
,
(1)
k
k



M
v
                                     (5) 
where (1)

 denotes the number of the selected user in (4). 
Then the channel matrix of the selected user is arranged on 
the first layer of the system channel matrix. 
(1)
2
u
T
T
T
T
N



 

H
H
H
H
                             (6) 
In this way, we ensure that the 1-st user uses the MB. For 
the 2-nd user, in order to use the DPC for eliminating the 
IUI, we have to transform the effective channel matrix to 
triangular matrix, and the following operation is performed. 


SVD
1
2
(1)
1
(1)
Null space
[ ,
,
,
T ]
H
N
H



H
M
H
UΛ v v
v
               (7) 
We can obtain the transmit weight for the 2-nd user from 
the null space in (7). However, we have to notice that all of 
these vectors in null space can meet the condition of the 
availability of DPC. The optimal transmit weight for the 2-
nd user can be expressed as follows. 
1
1
1
1
2
1
1
/
u
u
N
N
l
l
l
i
l
l








 

M
v
v
                                 (8) 
where 
(
1,2,
)
l
u
l
N


 is real coefficient. Then we 
estimate the channel of the 2-nd user corresponding to 
2
M  
in (8). It can be obtained by the following algorithm. 


2
arg max(
);
1,
,
(1)
k
k
k
u
k
N
k




H
H
H M
              (9) 
by letting (2)
k


, the 2-nd user is determined. Similarly, 
the channel matrix corresponding to the selected user in (9) 
is arranged on the second layer of channel matrix in (6). 
We consider the k -th user and its transmit weight, the 
same operations as the above are performed to the matrix 
corresponding to these 
1
k  selected users. 






(1)
1
(1)
SVD
1
1
(2)
2
(2)
Null space
(
1)
1
(
1)
[
,
,
,
,
]
u
H
H
N
k
k
H
H
k
k
k

















 








H
M
H
H
M
H
UΛ v
v
v
v
H
M
H
  (10) 
25
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

from the null space in (10), the transmit weight for k -th 
user can be given by 
1
1
1
1
1
1
/
u
u
N
k
N
k
k l
k l
k
l
l
l
l


 
 
 
 


 

M
v
v
                         (11) 


arg max(
);
1,
,
(1), (2),
(
1)
k
k
k
k
u
k
N
k
k







H
H
H M
    (12) 
Similarly, the user channel obtained in (12) is arranged on 
the k -th layer of the system channel. 
Consequently, we obtain the transmit weights for all users, 
and the transmit signal vector can be rewritten as 
1
1
2
2
1
1
2
2
2
2
1
1
u
u
u
u
u
u
j
N
N
N
j
j
j
N
N
N
s
x
s
x
x
x
s
x










































H M
H M
X
H
M
H
M
               (13) 
where 
ks  is the transmitted information for the k -th user. 
To avoid the power enhancement problem, the same modulo 
device as in [8] is used in this paper. 
Then we discuss the Signal to Noise Ratio (SNR) at each 
user terminal. If the Maximum Radio Combining (MRC) is 
used to detect the receive signal, the SNR at each MS is 
given by 
2
2 /
k
k
k
k
SNR k
s
N
 H M
                      (14) 
where 
k
H Mk
 can be considered as the transmit gain of 
the k -th user. If 
max
1
k
k 
v
M
, 
k
M  is considered as the 
ideal transmit weight which enables the k -th user to get the 
largest transmit gain 
kmax2
, and 
kvmax
 is the vector 
corresponding to the maximum eigenvalue of 
k
H . However, 
in fact, 
max
k
k
v
M
 lies in between 0 and 1, and it depends on 
the coefficients 
i
  for combining
k
M , where 
i
  R
 lies in 
a certain lattice. In order to obtain the optimal transmit gain, 
it is crucial to search the optimal combination coefficients 
which makes 
k
M  parallel to 
kvmax
. We solve the nonlinear 
optimization problem by employing PSO algorithm to 
obtain the optimal transmit weights. In this case, if we use 
the DPC principle to cancel the IUI, the achievable rate can 
reach optimal. The capacity of proposed scheme can be 
expressed as  
2
,
0,
2
0,
1
1
max
log
1
max
log
k
k
j
u
k
j
H
H
k
j
n
N
H
H
k
k
k
k
k
j k
n
C












　
M
H M
H M
I
HMM H
I
H M M H
        (15) 
The water filling can be used to distribute transmit power. 
We define the achievable sum-rate of system with users 
equipped with single receive antenna as 
2
2
1
log
u
N
k
k
k
C









H M
      
and   solves 
2
1
1/
u
N
k
k
T
k
P










H M
                          (16) 
where
TP is the total transmitting power. 
B. Particle Swarm Optimization aided optimal transmit 
weights 
The PSO algorithm, based on the research of flock 
movement behaviour of birds flock finding foods, where the 
random flying bird flock are referred to as particles, which 
represent potential solutions initialized over the whole 
search space randomly. An objective function is used to 
evaluate the goodness of positions of particles. Each particle 
has a fitness value which is evaluated by the objective 
function to be optimized, and the fitness value is evaluated 
at each iteration search. 
For k -th user, we assume that the size of swarm and the 
dimension of search space are 
k
  and 
k
D , respectively. 
The position and velocity of particle 
(
1,2,
k )
i i



　
 are 
denoted as
,
1
2
[
]
k
T
i k
i
i
iD





 
χ
 and 
,
1
2
[
i k
i
i





ζ
 
]
k
T
 iD
. In the course of searching optimal solution, the 
particle i  knows its best position
,
1
2
[
]
k
T
i k
i
i
iD
p
p
p


 
P
, 
which provides the best information, and the best position 
so far among the entire particles, is denoted as 
,
1
2
[
]
k
T
g k
g
g
gD
p
p
p


 
P
, which provides the global best 
location. 
,i k
P  and 
,
Pg k
are updated at each iteration by the 
objective function. Each particle has its own velocity to 
direct its flying, which relies on its previous speed 
(
1,2,
,
)
idk
k
k
d
D



 as well as its 
pidk
 and 
pidk
 
information. At each iteration, the velocity and position of 
particle i  are updated based on the following equations. 
1
1
1
2
2
(
)
(
)
k
k
k
k
k
k
t
t
t
t
t
t
id
id
id
id
gd
id
w
c
p
c
p






 




 
1
1
k
k
k
t
t
t
id
id
id







                              (17) 
where t  is the current iteration number, 
k
t
id
 and 
k
t
id
 
denote the velocity and location of the particle i  in 
k
d dimensional space, respectively. 
k
t
pid
 is the individual 
best location that the particle i  has achieved so far, and 
k
t
pgd
is the global best location that all particles have 
achieved so far at the i -th iteration. w  is the inertia weight 
which determines to what extent the particle remains along 
its original course unaffected by the influence of 
k
t
pid
 
and
k
t
pgd
, it is usually set between 0 and 1. 
1c  and 
2c  are 
acceleration constants which are set to 2. 
1
  and 
2
  are 
uniformly distributed random number in [0,1] . This 
iterative search process will be repeated up to the maximal 
iteration number or till the termination criterion is satisfied. 
Then we have to consider two important issues, one is the 
particle modelling, and the other is the selection of objective 
function. Considering the SNR in equation (14), we search 
the optimal transmit weight 
k
M , which infinitely close to 
the ideal transmit weight 
kvmax
 for the k -th user, 
kvmax
 where  
kvmax
 denotes the desired point lying in the best location.  So 
26
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

we define the angle between 
kvmax
 and 
k
M  as 
max ,
k
k
v
M  and 
consider the sine function as the objective function for k -th 
user at the t -th iteration.  


max
max
1
1
1
1
1
1
max
,
2
,
,
2
max
(
,
)
sin(
)
1 cos (
)
1
u
u
k
k
k
k
t
l
il
N
k
N
k
k l
k l
k
l
l
l
l
t
i k
k
k
H
k
k
f
function






 
 
 
 

























v
M
v
M
M
v
v
v
M
v
M
   (18) 
Here, we use the sine value of angle between the ideal 
weight 
kvmax
 and the tentative weight 
k
M to measure the 
degree of approach. During the process of search, the sine 
value becomes small when the tentative weight gets close to 
the desired weight, and the search speed and accuracy are 
conditioned on the size of swarm, iteration number and 
search dimension. In this paper, the proposed optimal 
transmit weights based on PSO algorithm is obtained by the 
following steps. 
(a). BS obtains the information of the channels by the 
feedback from MS and computes the maximum eigenvalues 
kmax
 of each user and determines the order of user. By eq. 
(10), the dimension of search space of PSO is determined 
for the next user, and then the swarm size 
k
  and the 
maximum iteration number 
kImax
 are set for each user. 
(b). PSO algorithm is employed to search the optimal 
transmit weight for each user. For the k -th user in 
k
 , we 
initialize the velocity and location for each particle as 
1
1
1
1
,
,1
,
,
[
,
,
,
]
k
T
i k
i
i l
i D




ζ
and 
1
1
1
1
,
,1
,2
,
[
,
,
]
k
T
i k
i
i
i D




χ
, 
where the initial velocity 
1
ζ ,i k
 can be set as a random vector, 
such as 
1
 ,i l
  [ 10,10]

, and the initial location is set as 
1
χ ,i k 
[1,1,
,1]/
Nu
k
.  
(c).Taking 
1
ζ ,i k
and 
1
χ ,i k
as starting point, PSO is 
implemented to search the optimal transmit weights. In each 
iteration, the temporary best locations will be measured and 
updated by the objective function in (18) and all the 
particles achieve the next optimal directions for the search. 
For example, in the t -th iteration, all particles use the given 
best global locations to update the velocity and location by 
using (17), then compare the location obtained in (17) with 
the last best location 
1
k
t
id
p   and obtain the 
k
t
pid
,and then the 
k
t
pid
 of each particle will be exchanged to get the global 
beat location  
k
t
pgd
. Ultimately, all of the particles update 
their location by the  
k
t
pgd
. In this paper, 
,
t
χi k
 is normalized 
after the update in each iteration. 
(d). PSO algorithm is repeated till the maximum iteration 
number of 
kImax
.  
The above operations are separately implemented at all 
users and the different user has the different search 
dimension. In other words, from the 1-st to the 
u
N -th user, 
the search dimension becomes small, which leads to low 
SNR at each MS. Thus for those “bad” users, we can enlarge 
the swarm size or increase the iteration number to obtain the 
optimal weights. Certainly, the solution of the above is 
usually achieved by the water filling. 
C. Computational load analysis 
Under the same simulation conditions we compare the 
computational complexity between the proposed scheme 
and other schemes in [10] and [14]. The comparison is 
limited in searching the transmit weights for all user. 
Generally, a SVD has a complexity with order of max  
2
2
3
(
,
,
p q pq q )
in the case of k -th user, where 
T
p
 N
 and 
1
q
 k
  [16]. We assume a complex multiplication equal 
to 4 real multiplications and 2 real additions. In the 
proposed scheme in this paper and the scheme in [14], 
10
k
 
 and 
max
20
kI

 are set. If the particles denote real 
number, PSO algorithm has at least a real computation of 

10
k
f



 

  

max
1
k
k
I
 

, where 
 f
 denotes the 
computation of objective function. The total numbers of real 
products and additions required for detecting one transmit 
symbol are derived as follows. 
TABLE 1.  COMPUTATIONAL COMPLEXITY/SYMBOL 
 
4
T
N 
,
4
u
N 
,
 
1
nRk
  
4
T
N 
,
4
u
N 
,
 
2
nRk

 
L
  
8126 
11648 
OW
L

 
52400 
52400 
OW
DPC

 
15688 
16288 
L
 : Computational complexity of linear scheme in [10]. 
OW
 L
 :Computational complexity of linear scheme with PSO in [14]. 
OW
DPC

: Computational complexity of the proposed scheme in this paper. 
 
Table 1. shows the PSO algorithm consume the largest 
computational work in [14] because of continuous complex 
vector space. However, in this paper, we search the optimal 
coefficient in real vector space to greatly reduce 
computational load. Though the scheme in [10] has the least 
computational load, when the number of receive antennas at 
MS is increased, the quantity difference becomes small 
between 
OW
DPC

 and 
OW
L

. Moreover, the demerits of 
increment of noise in [14] and residual IUI in [10] lead to 
loss of achievable rate to a certain degree. Taken together, 
the proposed scheme in this paper is feasible. 
IV. 
COMPUTER SIMULATION 
In 
this 
Section, 
we 
present 
simulation 
results 
demonstrating the performance of the proposed scheme. To 
verify the performance of it, first, we compare the 
achievable sum-rate between the proposed scheme and the 
other schemes, such as, conventional DPC, Channel 
Inversion (CI) and BD, with the water filling algorithm. 
Then we compare the average BER performance of each 
user and demonstrate the feasibility of the proposed scheme. 
We consider the case of 4×(1,1,1,1) in MU-MIMO, where 
the average achievable rate of system is determined for the 
total 1000 realizations of H . The particle number of 
27
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

10
k
 
 and the iteration number of 
max
20
kI

are set for 
the PSO algorithm. Fig. 2 shows that the channel inversion 
scheme obtains a close average capacity to BD scheme by 
employing the water filling, but both of those two methods 
are inferior to the conventional DPC, which approaches the 
multiuser capacity more closely. The simulations results 
show that the proposed scheme obtains the best capacity 
because of the optimal transmit weights and user order with 
PSO. In the conventional DPC, the transmit weight for each 
user in the precoding matrix Q  is obtained by Gram-
Schmidt orthogonalization without sorting. 
 
0
5
10
15
20
25
-10
-5
0
5
10
15
20
Capacity[bits/s/Hz]
Average SNR per user[dB]
Optimal weights with PSO
Block Diagonalization
Conventional QR DPC
Channel Inveration
 
Fig. 2 Capacity comparison among the proposed PSO-DPC with optimal 
weights DPC and the BD, Channel inversion, Conventional DPC 
 
Next we show the BER performance of proposed transmit 
scheme and compare it with the BD, channel inversion and 
conventional DPC schemes. Here we only consider the 
uniform assignment of transmit power to all users. 
Fig. 3 shows the case of 4 (1,1,1,1)

 in MU-MIMO 
downlink. The particle number of 
10
k
 
 and the iteration 
number of 
max
20
kI

are set in the PSO algorithm and QPSK 
is used to modulate the transmit signal. Without regard to 
the power distribution on each user, both BD and Channel 
Inversion with ZF can completely eliminate the IUI on i.i.d 
Rayleigh fading channels and these two methods show the 
same performance as SISO in i.i.d Rayleigh fading channel.      
As shown in Fig. 3, though the channel inversion with 
MMSE can not exactly cancel the IUI caused by the 
spatially multiplexed channel and results in some vestigial 
IUI, it can reduce the effect of noise enhancement between 0 
and 12dB. The DPC, referred to as the interference 
dependent nonlinear precoding, can obtain the better 
performance compared with the linear BD and channel 
inversion schemes. In the case of conventional DPC, the QR 
decomposition only aims to cancel the IUI, but does not 
involve the optimality of transmit weights in the matrix Q. 
Our proposed transmit scheme with optimal weights by PSO, 
not only suppresses the IUI completely, but also searches 
the optimal transmit weights achieving the SNR as large as 
possible at each MS. Fig. 3 shows the proposed scheme has 
obtained the better BER performance by about 4 dB  than 
the conventional DPC at BER=10-3. 
 
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
4
8
12
16
20
Average BER among users
Average Eb/No [dB] / receive antenna
Block Diagonalization   
Channel inversion_MMSE
Conventional QR DPC
Optimal weights with PSO
 
Fig. 3 Comparison of BER characteristics among proposed PSO-DPC with 
optimal weights, BD, Channel inversion (ZF&MMSE) and 
Conventional DPC. 
 
Fig. 4 shows the BER performance of proposed scheme 
with multiple receives antennas and it is compared with the 
conventional DPC. Similarly, the values of 
10
k
 
 and 
max
20
kI

 are set in the PSO algorithm and QPSK is 
employed. 
The 
conventional 
DPC 
based 
on 
QR 
decomposition is restricted to the users with single receive 
antenna, because in the case of users with multiple receive 
antennas, if we use the QR decomposition on H , some of 
the users have no throughput. However, the proposed 
scheme can ensures the throughput for each user and 
improves the receive SNR by increasing the number of 
receive antennas. In addition, based on the channel 
condition and the Qos requirement of users, the PSO search 
algorithm works with different swarm size of 
k
 and the 
iteration number of 
kImax
 to improve the transmit gains. As 
shown in Fig. 4, with the increase of receive antenna 
number, the system performance can be greatly improved. 
 
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
0
4
8
12
16
20
Average BER among users
Average  Eb/No [dB] / receive antenna
Conventional  QR DPC 
Optimal weights with PSO, nR=1
Optimal weights with PSO, nR=2
Optimal weights with PSO, nR=4
 
Fig. 4 Comparison of BER characteristics among the proposed PSO-DPC 
with optimal weights with multiple receives antennas and the 
conventional DPC 
28
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

Fig. 5 shows the improvement of BER versus the iteration 
number. If the iteration number or swarm size is set too 
small, we cannot obtain the convergence values of transmit 
weight of users. Thus increasing the number of iteration is 
required to achieve the better performance, which cannot 
lead to large calculation if we control the swarm size to 
likely quantity. From Fig. 5 it is clearly visible that when 
the value of 
kImax
 is set greater than 20, the BER 
performance cannot be improved any more. So the selection 
of value of 
kImax
 also seems the key design element. The 
computational load has been discussed in Section IV, from 
which it is clear that the proposed scheme is feasible when 
the iteration number is set to 
max
20
kI

. 
 
1.E-05
1.E-04
1.E-03
1.E-02
1.E-01
1.E+00
0
4
8
12
16
20
Average BER among users
Average Eb/No [dB] / receive antenna
Iteration number=5
Iteration number=10
Iteration number=20
Iteration number=30
 
Fig. 5 BER improvement vs. iteration number 
V. 
CONCLUSIONS 
A novel scheme with optimal transmit weights for the 
downlinks of MU-MIMO has been proposed, in which we 
employed the PSO algorithm to search the optimal transmit 
weights and achieved the significantly better performance 
than the conventional DPC, BD and the channel inversion 
schemes. With the CSI known at both of BS and MS, BS 
determine the user order and corresponding transmit weights 
with as large transmit gain as possible to each user. DPC has 
been used not only to suppress the IUI, but also maintain the 
system capacity. In the case of single receive antenna, 
because of the optimal transmit weight design with the DPC 
principle and PSO, the proposed scheme approached more 
closely to the capacity of MU-MIMO than other 
conventional schemes. In addition, the proposed scheme can 
employ the multiple receive antennas, whereas the 
conventional DPC based on QR decomposition is equipped 
with only one receive antenna at the MS. Accordingly, 
multiple receive antennas enables the user to obtain better 
BER performance, especially for the users with weak 
receive SNR’s. For the PSO algorithm, the swarm size and 
iteration number determine the search accuracy and required 
computation time, so we can make the optimal search for 
each user independently, according to the requirement of 
each user.  
ACKNOWLEDGMENT 
This study has been supported by the Scientific Research 
Grant-in-aid 
of 
Japan 
No. 
21560396, 
the 
Telecommunication Advancement Foundation (TAF), the 
KDDI Foundation and Sharp Corporation. The authors also 
acknowledge the helps by Dr. Eiji Okamato. 
REFERENCES 
[1] Q. H. Spencer, C. B. Peel, A. L. Swindlehurst, and M. Haardt, “An 
introduction 
to 
the 
multi-user 
MIMO 
downlink,” 
IEEE 
Communications Magazine, vol. 42, Issue 10, pp. 60-67, Oct. 2004. 
[2] I. E. Telatar, “Capacity of multi-antenna Gaussian channels,” 
European Trans. Tel.,vol. 10, no. 6, pp. 585-595, Nov./Dec. 1999. 
[3] D. Aftas, M. Bacha, J. Evans, and S. Hanly, “On the sum capacity of 
multi-user MIMO channels,” in Proceedings of Intl. Symp. on Inform. 
Theory and its Applications, pp. 1013-1018, Oct. 2004. 
[4] T. Haustein, C. von Helmolt, and E. Jorswieck, “Performance of 
MIMO systems with channel inversion,” IEEE 55th VTC, vol. 1, pp. 
35-39 ,May 2002. 
[5] Q. H. Spencer, A. L. Swindlehurst, and M. Haardt, “Zero-forcing 
methods for downlink spatial multiplexing in multiuser MIMO 
channels,” IEEE Trans. Signal Process., vol. 52, no. 2, pp. 461-471, 
Feb.2004. 
[6] N. Jindal, and A. Goldsmith, “Dirty-paper coding versus TDMA for 
MIMO Broadcast channels,” IEEE Transactions on Information 
Theory, vol. 29, no. 5, pp. 1783-1794, 2005. 
[7] R. F. H. Fischer, Precoding and Signal Shaping for Digital 
Transmission, New York, pp. 127-151, Wiley, 2002. 
[8] C. Li, Y. Iwanami, and E.Okamoto “Comparative study for 
Tomlinson-Harashima Precoding based on MMSE criteria in Multi-
user MIMO downlink system,” pp. 1-5, IEEE TENCON 2009, Nov. 
2009. 
[9] H. Nishimoto, S. Kato, Y. Ogawa, T. Ohgane, and T. Nishimura, 
“Imperfect block diagonalization for multiuser MIMO downlink,” 
IEEE PIMRC 2008.  pp. 1-5, Sept. 2008. 
[10] J. S. Kim, and S. H. Moon, “Linear Beamforming for Multi-user 
MIMO Downlink Systems with Channel Orthogo-nalization,” Global 
Telecommunications Conference, 2009. pp. 1-6, GLOBECOM 2009. 
[11] J. Kennedy, and R. Eberhart, “Particle swarm optimization,” IEEE Int. 
Conf. Neural Networks, vol. 4, pp. 1942-1948, Nov. 27 - Dec., 1995. 
[12] Y. Zhao, and J. Zheng, “Multi-user detection employing particle 
swarm optimization in space-time CDMA systems,” IEEE Int. Symp. 
Communications and Information Technology, vol. 2, pp. 940-942, 
Oct.12-14, 2005. 
[13] K. K. Soo, Y. M. Siu, W. S. Chan, L. Yang, and R. S. Chen, 
“Particleswarm-optimization-based multiuser detector for CDMA 
communications,” IEEE Trans. Vehicular Technology, vol. 56, pp. 
3006-3013, September 2007. 
[14] S. Fang, and L. H. Li, “Optimal Multi-User MIMO Linear Precoding 
Based on Particle Swarm Optimization,” ICC 2008, pp. 3355-3359, 
May 2008. 
[15] S. M. Guru, S. K. Halgamuge, and S. Fernando, “Particle swarm 
optimisers for cluster formation in wireless sensor networks,” Proc. 
2005 Int. Conf. Intelligent Sensors, Sensor Networks and Information 
Processing, pp. 319-324, Dec. 2005. 
[16] G. H. Golub, and C. F. Van Loan, Matrix Computation, John Hopkins 
Univ. Press, pp. 253-254, 3rd edition, 1996.
 
29
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

