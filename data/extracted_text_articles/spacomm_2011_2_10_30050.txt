Multi-port Power Ampliﬁer Calibration Estimation Technique Based on ICA
Algorithm
Zhiwen Zhu and Xinping Huang
Communications Research Centre Canada
Ottawa, Ontario, K2S 8H2 Canada
Emails:{zhiwen.zhu, xinping.huang}@crc.gc.ca
Abstract—A multi-port power ampliﬁer (MPA) is a multi-
input and multi-output system that is capable of amplifying sev-
eral input signals simultaneously by a set of shared ampliﬁers
without mutual interference. In a practical MPA, the compo-
nent imperfections reduce the port isolation, which introduces
leakage or cross-port interference among the output ports. In
this paper, an independent component analysis (ICA) based
technique is developed to estimate a calibration matrix that
minimizes the effects of the imperfections. The MPA output
signals are used in the estimation of the calibration matrix.
Simulation studies show that the proposed calibration matrix
estimation technique can lead to a signiﬁcant improvement in
the MPA output port isolation.
Keywords-Multi-port power ampliﬁer; Calibration; Indepen-
dent component analysis; JADE;
I. INTRODUCTION
Multi-beam satellite communication systems can achieve
a high antenna gain and thus improve their effective isotrop-
ically radiated power and gain/noise temperature. In such
a system, users may move from one geographic area to
another serviced by different beams. As a result, trafﬁc
may not be distributed uniformly among the beams and it
ﬂuctuates over time. A multi-port power ampliﬁer (MPA)
based architecture [1]-[3] is an effective approach to en-
able ﬂexible power allocation in multiple beam systems to
address capacity variations among the beams during the
lifespan of the satellite.
An MPA is a multi-input and multi-output system that is
capable of amplifying multiple input signals simultaneously
using shared ampliﬁers. Ideally, the MPA ampliﬁes the mul-
tiple input signals and outputs them separately via different
output ports without any mutual interference. In practice,
component imperfections in the MPA reduce the port iso-
lation, which introduces leakage or cross-port interference
among the output ports.
The component imperfections can be reasonably well
controlled over temperature and time at low frequencies
[4], but it is difﬁcult and costly at microwave frequencies
and above. Some methods have been presented to linearize
the nonlinearity of the PAs in the MPA [5], [6]. Assuming
that the PAs are linear, a type-based calibration technique,
which exploits the uniqueness of the statistics for a given
communication signal, has been presented [7] to compensate
for the imperfections in other MPA components. In this
paper, we develop a technique based on the independent
component analysis (ICA) algorithm [8], [9] to estimate a
calibration matrix to compensate for MPA imperfections.
This technique does not require any prior information about
the MPA input signals except that they are independent.
The ICA is a statistical and computational approach with
many applications, including source separation and biomed-
ical signal processing. Here, the proposed technique uses
a conventional ICA algorithm, i.e., the joint approximate
diagonalization of eigenmatrices (JADE) [8], to estimate the
input-output transfer function of the MPA from its output
signals. A calibration matrix, i.e. the inverse of the MPA
transfer function, is applied to the input signals before
feeding them to the MPA to compensate for the impairments
in the MPA. Computer simulations are used to demonstrate
the performance of the proposed technique.
The paper is organized as follows: Section II describes the
MPA model. Section III presents the ICA based calibration
matrix estimation technique. Simulation results are given in
Section IV. Section V concludes the paper.
II. MULTI-PORT POWER AMPLIFIER MODEL
An N-port MPA system has N input ports and N output
ports. It is composed of an input hybrid matrix (IHM), a set
of N shared power ampliﬁers (PA), and an output hybrid
matrix (OHM). The IHM is made up of 3dB, 90◦ hybrid
couplers, and has N input ports and N output ports. The
PAs operate in their linear region, and each of the PA inputs
is connected to one output port of the IHM. The PA outputs
are connected to the inputs of the OHM that is identical
in structure to the IHM. Fig. 1 shows a functional block
diagram of a 4-port MPA.
Ideally, the MPA’s input signals are summed together
by the IHM with different phase relations to generate N
summed signals. Each summed signal is ampliﬁed by one
PA, and then fed to one input port of the OHM. The
OHM combines its input signals coherently to generate the
ampliﬁed original input signals. If there are no component
mismatches/imperfections, the transfer function of the MPA,
20
SPACOMM 2011 : The Third International Conference on Advances in Satellite and Space Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-128-1

PA
3dB 90o 
Hybrid
PA
PA
PA
x1
y1
x2
y2
x3
x4
y3
y4
Input Hybrid Matrix
Output Hybrid Matrix
3dB 90o 
Hybrid
3dB 90o 
Hybrid
3dB 90o 
Hybrid
3dB 90o 
Hybrid
3dB 90o 
Hybrid
3dB 90o 
Hybrid
3dB 90o 
Hybrid
Figure 1.
Functional block diagram of a 4-port MPA.
denoted by an N × N square matrix A, is an anti-diagonal
matrix. In this paper we reverse the output port order such
that A is represented by a diagonal matrix GI, where
G represents a complex gain of the MPA, and I is an
N×N identity matrix. Without loss of generality, we assume
G = 1.
The input and output relationship of the MPA can be
expressed by
y = Ax
(1)
where x = [x1, x2, · · · , xN]T denotes the input signal
vector, y = [y1, y2, · · · , yN]T denotes the output signal
vector, and the superscript “T” denotes the vector transpose.
It should be noted that y and x are functions of time with
the time index t being implied for ease of presentation.
In the ideal MPA, each input signal is co-ampliﬁed by
the shared PAs and then combined coherently for output
via individual output ports without mutual interference due
to the diagonal transfer function. However, in reality, the
component mismatches/imperfections destroy the diagonal
property of the MPA transfer function, yielding a transfer
function represented by a full square matrix with non-zero
complex-valued elements
A =


a1,1
a1,2
· · ·
a1,N
a2,1
a2,2
· · ·
a2,N
...
...
...
aN,1
aN,2
· · ·
aN,N


ak,l (k, l = 1, 2, · · · , N), which represents the transfer
characteristics from the lth input port to the kth output port.
Normally, |ak,k| ≈ 1 for k = 1, 2, · · · , N, while |ak,l| << 1
for k ̸= l, where | · | denotes the complex norm operator.
Therefore, the inverse of A always exists.
III. ICA BASED ESTIMATION TECHNIQUE OF THE
CALIBRATION MATRIX
The objective of the MPA calibration is to eliminate the
leakage among different ports by restoring the diagonal
property of its transfer function. Figure 2 illustrates a sim-
pliﬁed functional block diagram of an N-port MPA with the
calibration function. The MPA output signals are sampled in
parallel, and used in the digital signal processor (DSP) to
estimate the calibration matrix.
The output of the MPA with calibration can be expressed
by
y = ACx
(2)
where C denotes the calibration matrix. If AC = I, the
MPA is perfectly calibrated, which occurs when C = A−1.
x1
MPA
Calibration 
Matrix
x2
xN
...
DSP
...
yN
yN-1
y1
Figure 2.
Simpliﬁed functional block diagram of the MPA with calibration
function.
To determine C, let’s assume that xns are independent
non-Gaussian signals with zero mean and unit variance. That
is, E[xxH] = I, where E[·] is the mathematical expectation
operator and the superscript “H” denotes Hermite transpose.
At the MPA output, yn’s become correlated due to the signal
leakage.
The ICA-based estimation technique consists of three
steps. In the ﬁrst step, we pre-whiten yn’s by multiplying
a full ranked matrix M, yielding a new vector z = My,
where z = [z1, z2, · · · , zN]T, such that zn’s are mutually
uncorrelated and all have unit variance, i.e., z becomes
E[zzH] = I. This transformation is always possible and can
be accomplished by classic principal component analysis or
singular value decomposition. M is constructed from the
eigenvalues and eigenvectors of the covariance matrix of y
[9]. After transformation, we have
z = My = MAx = Bx
(3)
where B = MA is an orthogonal matrix due to the
assumptions on x: it holds E[zzH] = BE[xxH]BH = I.
According to Eq. (3), e = B−1z = BHz will be the estimate
of x, where e = [e1, e2, · · · , eN]T.
In the second step, the orthogonal matrix B is determined
by the JADE algorithm as a unitary maximizer of the cost
function
ζ(B) =
N
X
i,k,l=1
|cum(ei, e∗
i , ek, e∗
l )|2
21
SPACOMM 2011 : The Third International Conference on Advances in Satellite and Space Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-128-1

where cum(ei, e∗
i , ek, e∗
l ) denotes the 4th-order cumulants
of e [8]. Thus B can be obtained as
B = arg
B
max ζ(B)
(4)
Eq. (4) is equivalent to minimize the sum of all the squared
cross-cumulants, i.e. distinct indices in the ﬁrst and second
terms as cum(ei, e∗
j, ek, e∗
l ).
For the complex N-dimensional random vector e, its
4th-order cumulants are associated with a quadricovariance
denoted by Q, deﬁned as a linear matrix-to-matrix mapping
R → S = Q(R) by
sij =
N
X
k,l=1
cum(ei, e∗
j, ek, e∗
l )rkl
(5)
where R and S are N × N matrices with entries rij and
sij, respectively. There exist N 2 real numbers λn and N 2
orthogonal matrices Rn, satisfying Q(Rn) = λnRn, n =
1, 2, · · · , N 2. Note that Q is actually a 4th-order tensor and
Rn’s are the eigenmatrices of Q associated to its eigenvalues
λn. It has been proved [8] that the quadricovariance Q has
exactly rank N so that only N out of all λns are non-zero.
The cost function in Eq. (4) becomes
ζ(B) =
N
X
n=1
λn∥diag(BRnBH)∥2
(6)
where ∥diag(·)∥ is the norm of the vector built from the
diagonal elements of the matrix argument. According to
Eq. (6), the unitary matrix B can be obtained by a joint
diagonalization of the N eigenmatrices Rn.
However, it is well known that the JADE algorithm has
two inherent ambiguities: permutation ambiguity and scaling
ambiguity. That is, A can be estimated as
A = M−1BDP
(7)
where D is an N×N nonsingular diagonal matrix that stands
for the scaling ambiguity, and P is an N × N permutation
matrix that is simply obtained from an identity matrix with
its rows and columns being re-ordered.
In the third step, we will solve the ambiguity issue. From
the assumption that A has much larger diagonal elements
than off-diagonal elements, we can obtain P that re-orders
M−1B so that the larger elements are on its diagonal
position. The scaling factor in D can be estimated from
the eigenvalues of the ﬁrst step as the diagonal elements in
an ideal A are 1. Having determined the estimate of A of
Eq. (7), the calibration matrix can be derived as C = A−1.
To achieve a better estimation performance and to track
variations of the MPA characteristics, the above 3-step
procedure can be repeated as follows:
(i) Set k = 0 and Ck = I;
(ii) Estimate a new C from the MPA output signals using
the above 3-step procedure;
(iii) Update the calibration circuit according to Ck+1 =
CkC;
(iv) Increment k = k + 1 and go to (ii).
IV. COMPUTER SIMULATIONS
To validate the ICA based MPA calibration technique,
computer simulations using Matlab have been performed for
a 4-port MPA. It is assumed that the hybrids in the IHM
and the OHM have a gain error within ±1dB and a phase
error within ±10◦, and the PAs have a gain variation within
±1dB and a phase variation within ±10◦. The actual errors
are generated from a uniform random number generator. The
amplitude and phase in the resulting MPA transfer function
used in our simulations is listed below, respectively:


1.04
0.13
0.13
0.18
0.07
0.96
0.16
0.09
0.18
0.11
1.11
0.06
0.12
0.16
0.05
1


and


1.3◦
−122.4◦
−9.1◦
−149.8◦
−112.6◦
−13.6◦
25.0◦
−16.1◦
173.2◦
−62.5◦
11.3◦
−174.2◦
95.7◦
167.1◦
−87.3◦
0◦


Without loss of generality, one element is normalized
to 1 in order to have a unique solution. The four input
signals are QPSK, 16QAM, 8PSK, and 16QAM modulated
with variances of 1, 2.25, 1, and 2.25, respectively. These
signals are square root raised cosine pulse-shaping ﬁltered
with rolloff factors of 0.25, 0.35, 0.35, and 0.25. The
simulation uses 8 samples per symbol. 105 samples, i.e.
12,500 symbols, are used in the simulation to calculate the
cumulants. The 3-step procedure is repeated 10 times.
The error vector magnitude (EVM) is used to measure the
quality of the MPA output signals. It is deﬁned as
EVM =
v
u
u
t
PL
l=1 |Dideal,l − Dmeas,l|2
PL
l=1 |Dideal,l|2
× 100%
(8)
where Dmeas,l is the value of the lth received symbol,
Dideal,l is the ideal value of the lth symbol, and L is the
total number of symbols used in the calculation. The EVM
is essentially a measure of the interference to signal ratio.
Figure 3 illustrates the constellation of the MPA output
signals without calibration. It clearly shows that the signal
constellation scatters widely due to the cross port interfer-
ence caused by the MPA imperfections. Figure 4 shows
the constellations of the MPA output signals after calibra-
tion. We observe that the proposed ICA-based technique
signiﬁcantly reduces the cross-port interference and restores
22
SPACOMM 2011 : The Third International Conference on Advances in Satellite and Space Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-128-1

the signal constellations. The EVM values before and after
calibration are summarized in Table I, which shows that they
are reduced from 24% to 0.6% for QPSK, from 28% to 0.7%
for 8PSK, and from 26% to 2% for 16QAM, respectively.
−1.5
0
1.5
−1.5
0
1.5
Q Signal
Port 1
−2
0
2
−2
0
2
Q Signal
Port 2
−1.5
0
1.5
−1.5
0
1.5
I Signal
Q Signal
Port 3
−2
0
2
−2
0
2
I Signal
Q Signal
Port 4
Figure 3.
Signal constellations before calibration.
−1.5
0
1.5
−1.5
0
1.5
Q Signal
Port 1
−1.5
0
1.5
−1.5
0
1.5
Q Signal
Port 2
−1.5
0
1.5
−1.5
0
1.5
I Signal
Q Signal
Port 3
−1.5
0
1.5
−1.5
0
1.5
I Signal
Q Signal
Port 4
Figure 4.
Constellations after calibration.
V. CONCLUSIONS
An MPA calibration technique based on the independent
component analysis algorithm has been proposed in this pa-
per. It applies a calibration matrix to the MPA input signals
TABLE I
EVM VALUES BEFORE AND AFTER CALIBRATION.
Port#
Before (%)
After %)
1 (QPSK)
24.10
0.63
2 (16QAM)
25.65
2.12
3 (8PSK)
28.26
0.74
4 (16QAM)
27.11
1.94
before feeding them to the MPA in order to precompensate
for the impairments in the MPA. The calibration matrix
is estimated using the JADE algorithm. Simulation results
show that the proposed technique can signiﬁcantly reduce
the cross-port interference in the MPA output ports, which
in turn greatly improves the system performance.
REFERENCES
[1] S. Egami and M. Kawai, “An adaptive multiple beam system
concept”, IEEE JSA in Communications, vol. 5, no. 4,
pp. 630-636, May 1987.
[2] M. Kanaka and S. Egami, “Reconﬁgurable multiport am-
pliﬁers for in-orbit use”, IEEE Trans. on Aerosp. Electron.
Syst., vol. 42, no. 1, pp. 228-236, Jan. 2006.
[3] A. Mallet, A. Anakabe, J. Sombrin, and R. Rodriguez,
“Multiport-ampliﬁer-based architecture versus classical ar-
chitecture for space telecommunication payloads”, IEEE
Trans. on Microwave Theory Tech., vol. 54, no. 12, pp. 4353-
4361, Dec. 2006.
[4] L. Dayaratna, L. Walshak, and T. Mahdawi, “TACeS Com-
munication Payload System Overview,” 18th AIAA Int. Satel-
lite Commun. Sys. Conf. and Exhibit, pp.246-250, 2000.
[5] T. Kaho, Y. Yamaguchi, T. Nakagawa, K. Araki, and
K. Araki, “A novel adaptive linearization technique for
a balanced-ampliﬁer array,” IEICE Trans. on Electronics,
vol. E89-C, no. 10, pp. 1448-1453, Oct. 2006.
[6] X. Huang and M. Caron, “Beneﬁt of linearizing power
ampliﬁers in multi-port ampliﬁer subsystems,” IEEE Int.
Symp. on Circuits and Systems, pp. 1260-1263, May 2008.
[7] Z. Zhu, X. Huang, and M. Caron, “Ka-band Multi-port
Power Ampliﬁer Calibration Experiment and Results.” The
2nd Int. Conf. on Advances in Satellite and Space Commu-
nications, pp.11-14, 2010.
[8] J. F. Cardoso and A. Souloumiac, “An efﬁcient technique
for the blind separation of complex sources,” IEEE Signal
Processing Workshop on Higher-Order Statistics, pp. 275-
279, 1993.
[9] P. Comon, “Independent component analysis - a new con-
cept?” Signal Processing, vol. 36, no. 3, pp. 287-314, Apr.
1994.
23
SPACOMM 2011 : The Third International Conference on Advances in Satellite and Space Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-128-1

