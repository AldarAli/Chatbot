 
Cramer-Rao Lower Bound on RF Pattern Matching Method with Velocity in 
LTE System 
Dengkun Xiao                                        Jie Cui 
Beijing Institute, Huawei, Technologies Co., Ltd.          Beijing Institute, Huawei, Technologies Co., Ltd. 
             Beijing, China                                       Beijing, China 
xiaodengkun@huawei.com                               cuijie@huawei.com 
 
Jiangbo Zhu                                       Xinlong Luo 
Beijing University of Posts and Telecommunications        Beijing University of Posts and Telecommunications 
Beijing, China                                       Beijing, China 
zjb349168311@gmail.com                             luoxinlong@gmail.com
 
Abstract-The Radio Frequency Pattern Matching (RFPM) 
method is an useful solution for UE positioning, and it is not 
sensitive to the channel states and multipath impact compared 
with the time-of-arrival schemes. With the help of drive test or 
other estimation algorithms, the RF pattern database can be 
constructed efficiently. The positioning accuracy of RFPM is 
tightly related with the member of measurement elements for 
pattern matching. In this paper, the UE velocity is adopted in 
the RFPM positioning to improve the positioning accuracy, 
and the Cramer-Rao lower bound is used for accuracy 
evaluation and comparison. From the simulation results the 
positioning accuracy can be improved remarkably when the 
UE velocity is considered in addtion to the reference signal 
received power (RSRP), timing advance (TA) and reference 
signal time difference (RSTD) in the pattern matching. 
Keywords - Cramer-Rao Lower Bound; RFPM 
I. 
INTRODUCTION 
Location estimation has received great deal of attention 
over the last two decades due to the requirements set forced 
by the US Federal Communications Commission (FCC) for 
Enhanced-911 (E-911) safety services [1]. RF Pattern 
Matching is a positioning method proposed in 3GPP RAN4 
meetings. This method can locate the target UE in an area by 
comparing its RF measurement against a detailed model of 
the RF environment for that area. The RF parameters 
measured by the UE could be serving cell identity, reference 
signal strengths for serving and neighboring cells, timing 
advance, etc. The RF environment model could be stored in 
the form of a database of signal strengths vectors indexed by 
location coordinates of an area, and which could be 
constructed in advance or real time using a combination of 
RF propagating modeling and possibly test measurements 
[2]. 
In [5], a novel method about finger print positioning 
based on spatial correlation of collected signal samples and 
spatial diversity is proposed which can improve positioning 
accuracy and reduce time consumption of constructing a 
metropolitan-scale radio map, however only the received 
signal strength (RSS) have been considered in the algorithms 
which limit the peak performance. In [6], position 
estimations got from the so-called Neural Network 
localization are further processed through a Kalman 
filtering-based tracking algorithm and thereafter, the 
processed position is matched to the road according to the 
map-matching technique applied. However, it cannot work 
without the existing GPS. In [7], a novel positioning system 
is proposed, which consist of three sub-systems, and the first 
sub-system solves the problems related to fingerprint 
localization and involves neural network as key element of 
the positioning algorithm. It also ignores the distance and 
velocity information for improving positioning accuracy. 
In this paper, we propose to introduce velocity into the 
existing RF Pattern Matching schemes for performance 
improvement. If the velocity estimation can be achieved at 
UE side with specific measurement errors, it can be adopted 
for RF Pattern Matching to improve the positioning accuracy 
using the RF database.  
This paper is structured as follows. In Section 2, we will 
introduce RF Pattern Matching positioning method and 
diversified measurements with Cramer-Rao lower bound 
error model. In Section 3, based on the analysis, a RFPM 
method with velocity is presented, and mathematic 
expression can be provided as a new positioning error model. 
Section 4 shows simulation results of proposed method 
compared with traditional RFPM, and the analysis of 
simulation results show advantages of proposed method. 
Finally, conclusions are drawn in Section 5. 
II. 
ERROR MODEL ANALYSIS 
The general error model is proposed as shown in the 
paper [2]. It assumes a model where measurements are 
non-linearly related to the parameter of interest (location, i.e., 
coordinate of the UE) and are corrupted by Gaussian Noise. 
More specifically, let y be a length N vector of 
measurements as below: 
(
HS )
y
h x
n


  
 
      (2.1) 
where


1
2
HS
HS
x
x
x

is the coordinate of the UE, 










1
2
...
HS
HS
HS
N
HS
h x
h
x
h
x
h
x

is the N vector 
of measurements which are the function of UE’ coordinate. 


1
2
...
N
n
n
n
n

is the corresponding noise with the 
variance. 
In estimation theory and statistics, the Cramer-Rao lower 
94
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

 
bound (CRLB) expresses a lower bound on the variance of 
estimators of a deterministic parameter. A location error 
function of Cramer-Rao lower bound can be calculated as 
below: 
1
(
)
LOC
i
i
trace
I




 
       (2.2) 
2
(
)
(
)
1
T
i
HS
i
HS
i
HS
HS
i
h
x
h
x
I
x
x






  
  (2.3) 
(2.3) is the ith measurement function’s fisher information 
matrix. Error of positioning method can be calculated by 
accumulating all the measurement’s information matrix as 
indicated in [2]. 
In mobile communication system, many measurement 
elements including RSRP (reference signal received power), 
RSTD (reference signal time difference) and TA (timing 
advance) can be used for RFPM. 
The measurement element of RSRP is the estimated 
value at UE side which can be derived from transmit power 
and propagation loss. Hata models can be used to represent 
the RSRP signature models as below: 
10
10
log
(
/
)
REF
REF
RSRP
RSRP
d
d
a






    (2.4) 
where  is the pathloss exponent and d is the distance 
between UE and serving eNodeB, 
RSRPREF
is the reference 
RSRP calculated from reference distance 
dREF
and 
0.5
(1
cos(
))
HS
CELL
a
FBR







 
where FBR is the front-to-back ratio, 
HS
is the angle of UE 
measured positive counter-clockwise from the X-axis, 
CELL
is the angle of the antenna boresight measured positive 
counter-clockwise 
from 
the 
X-axis. 
So 
differential 
coefficient of RSRP can be get as below: 


1
2
2
1
HS
RSRP
pa
qa
pa
qa
x





 
       (2.5) 
Where 
 
1
1
1
2
2
1
1
2
2
(
)
(
)
HS
CELL
HS
CELL
HS
CELL
x
x
a
x
x
x
x





  
 
 
2
2
2
2
2
1
1
2
2
(
)
(
)
HS
CELL
HS
CELL
HS
CELL
x
x
a
x
x
x
x





  
 
 
10
*
10
p
In
d

 
 


1
0.5 *
* sin
*
HS
CELL
q
FBR
d


 

 
1
2
(
,
)
CELL
CELL
x
x
 is the coordinate of the eNB of serving 
cell. RSRP’s fisher information matrix can be calculated by 
using (2.3) and (2.5) as below [3]: 
2
1
2
2
1
1
2
2
2
2
1
1
2
2
1
(
)
(
)(
)
1
(
)(
)
(
)
RSRP
RSRP
pa
qa
pa
qa
pa
qa
I
pa
qa
pa
qa
pa
qa














  
 
 
 
 
 
 
 
 
 
  (2.6) 
 RSRP
is the RMS of RSRP measurement error.  
RSTD is time difference between positioning signal 
arrival timing of reference cell and of neighboring cell, 
which means that it is also the function of coordinate of the 
target UE. According to RSTD definition, it can be 
expressed as below [3]:  
1
(
) /
i
i
RSTD
d
d
c


  
       (2.7) 
where
id is distance between the UE and i-th eNodeB and c 
is light speed. 
2
1
1
1
2
1
1
1
2
1
*
( *
(cos
cos
)
(cos
cos
)(sin
sin
)
(cos
cos
)(sin
sin
)
(sin
sin
)
)
i
RSTD
RSTD
i
i
i
i
i
i
I
c


























 
 
 
 
 
 
 
 
 
 
  (2.8) 
i
 is the angle of the line between UE and ith cell 
positive counter-clockwise from the X-axis. 
 RSTD
is the 
RMS of RSTD measurement error. The detailed formula for 
RSTD is shown in [3]. 
TA can be used to estimate the distance from the UE to 
serving eNodeB. Information matrix of TA can be calculated 
by using the same principles as RSTD [3]: 
2
2
2
cos
cos
sin
1
( *
)
cos
sin
sin
HS
HS
HS
TA
TA
HS
HS
HS
I
c














     (2.9) 
 TA
is the RMS of TA measurement error. The detailed 
formula for TA is shown in [2]. 
The variance of RSRP, RSTD and TA can be assumed to 
as 
2
 RSRP
, 
2
 RSTD
, 
2
 TA
 , respectively.  
III. PROPOSED POSITIONING METHOD 
Velocity can be obtained by assuming UE move from 
one point to another point during the certain time and it is 
expressed as a function of UE’s coordinates information. It is 
useful to distinguish UE status if the velocity can be used 
appropriately, so the UE can be located well and truly. Based 
on current Cramer-Rao lower bound in section Ⅱ, the 
positioning performance can be re-evaluated considering the 
UE velocity in formula deducing. It can be expected that 
positioning error lower bound of new RFPM with velocity is 
smaller than traditional RFPM method. 
Velocity can be calculated by the UE moving distance 
divided the corresponding time. It is assumed that UE move 
95
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

 
from


1
1
1
1
2
dp
dp
dp
x
x

 to 


2
2
2
1
2
dp
dp
dp
x
x

during the 
time of 
t
 . So Velocity can be expressed as below: 




1
1
2
2
1
2
1
2
2
2
dp
dp
dp
dp
x
x
x
x
v
t





 
  (3.1) 
So, differential coefficient of velocity can be obtained: 




2
1
cos(
)
sin
v
v
v
dp
t






 
 
 
where  






1
1
1
1
2
1
2
2
1
2
1
2
2
2
cos(
)
dp
dp
v
dp
dp
dp
dp
x
x
x
x
x
x






 






1
1
2
1
2
2
2
2
1
2
1
2
2
2
sin(
)
dp
dp
v
dp
dp
dp
dp
x
x
x
x
x
x






 
The information can be calculated as below: 
2
2
2
2
cos (
)
cos(
) * sin(
)
1
*
cos(
) * sin(
)
sin (
)
v
v
v
v
v
v
v
v
I
t















   (3.2) 
v
 is the angle of the line between UE last position and 
current position positive counter-clockwise from the X-axis. 
v
 is the RMS of velocity measurement error. We can 
calculate information matrix of this new positioning method 
by using (2.6), (2.8),(2.9), (3.2): 
v
RSRP
RSTD
TA
I
I
I
I
I




 
 
  (3.3) 
So, error can be calculated by using (2.2) and (3.3): 
1
trace(
)
LOC
M
I
N




  
  (3.4) 
where  
2
2
2
2
2
2
2
1
1
( *
)
( *
)
*
RSRP
TA
RSTD
v
p
q
r
M
c
c
t










 
where 
2
2
1
1
[ 2,
]
[ 2,
]
(cos
cos
)
(sin
sin
)
RSTD
RSTD
i
i
i
N
i
N
r












 
NRSTD is the number of cells participating the OTDOA 
positioning. 
3
1
2
2
2
2
2
2
2
2
2
2
4
5
6
4
2
2
2
2
2
2
2
2
2
2
7
4
*
*
*
*
*
*
*
*
*
*
*
*
*
*
( *
)
RSRP
RSTD
TA
v
TA
RSTD
v
RSTD
RSRP
TA
RSRP
v
RSTD
N
N
N
N
c
c
t
c
N
N
N
t
c
c
t
N
c























  The related parameters used in above formulas can be 
summarized as follows: 
2
2
2
2
1
1
2
2
1
[ 2,
]
[ 2,
]
2
1
1
2
[ 2,
]
(
)
(
)
(
)
(
)
2 * (
)(
)
(
)
RSTD
RSTD
RSTD
i
i
i
N
i
N
i
i
i
N
N
pa
qa
pa
qa
pa
qa
pa
qa


 













　 　 　
   


2
2
sin(
)
HS
v
N




 
2
2
2
2
3
[ 2,
]
[ 2,
]
[ 2,
]
cos
*
(
)
sin
*
(
)
2 * cos
sin
(
)
RSTD
RSTD
RSTD
HS
i
HS
i
i
N
i
N
HS
HS
i
i
i
N
N






 









　 　 　
 
2
2
2
2
4
[ 2,
]
[ 2,
]
[ 2,
]
cos
*
(
)
sin
*
(
)
2 * cos
sin
(
)
RSTD
RSTD
RSTD
v
i
v
i
i
N
i
N
v
v
i
i
i
N
N






 









　 　 　
 




2
5
1
2
2
1
(
* sin
* cos
)
HS
HS
N
pa
qa
pa
qa






 




2
6
1
2
2
1
(
* sin
* cos
)
v
v
N
pa
qa
pa
qa






 
2
2
2
7
[ 2,
]
[ 2,
]
[ 2,
]
=
(
) *
(
)
(
)
RSTD
RSTD
RSTD
i
i
i
i
i
N
i
N
i
N
N


 







 
where
cos 1
cos
i
i





 and 
sin 1
sin
i
i





. 
IV. SIMULATION RESULTS ANALYSIS 
To verify the proposed scheme, we simulated both 
traditional RFPM and our strategy in Urban environment 
scenario. In this section, the simulator of RFPM with 
Velocity is described in detail.  
The 19 (sites) * 3 (sectors) topology is used in the Fig. 1, 
and the evaluation area is covered by the 3 center green 
sectors where UEs are uniformly dropped in our simulator. 
The site indexes are illustrated, and the bound of sectors is 
denoted by the dash line [3].  
Inter-site distance (ISD) is 500 meter. Pathloss exponent 
is 0.5 and FBR equals to 30dB. Reference distance can be set 
100 meter so that reference power can be calculated as -80.5 
dBm according to hata model. Minimum Distance between 
target UE and eNodeB is 35m. The RSRP measurement 
error is defined in the RSRP, RSTD and TA accuracy 
requirement of [4]. 
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
Inter-Site 
Distance
Evaluation area
 
Figure 1.  Network topology 
96
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

 
For our simulation, the 8 dB measurement error is 
assumed, while the RSTD and TA measurement error is 
assumed to be 5Ts, 10Ts respectively. Ts is the minimum 
time resolution of LTE systems, which equals to 
1/(2048*15000)(s). 
Velocity 
variance 
is 
equipment 
implementation specific, and according to existing data, 
both1m/s and 0.5m/s are reasonable error value for this 
simulation. 
t
 can be calculated by using the equation as 
below: 
ISD
t
v


                     (4.1) 
In our simulation, we make a comparison between our 
strategy and traditional RFPM, in which Velocity is assumed 
to be 3km/h and 120km/h respectively. All the detailed 
simulation parameters are listed in Table I. 
TABLE I. SIMULATION ASSUMPTIONS 
Parameters 
Value 
Inter-site distance 
512 m 
Reference distance 
100 m 
FBR 
30 dB 
Reference power 
-80.5 dBm 
RSRP measurement errors 
10 dB 
TA measurement errors 
10Ts 
RSTD measurement errors 
5Ts 
Velocity variance 
1m/s, 0.5m/s 
Minimum distance between target 
UE and eNodeB 
35 m 
Pathloss exponent 
0.5 
NRSTD 
4 
UE velocity 
3/120 km/h 
RFPM is related with the number of measurement 
elements. It means that if velocity is used for mapping the 
existing RFPM performance can be enhanced from theory 
aspect. 
Based on the assumptions and Cramer-Rao lower Bound 
deducing, the simulation results can be obtained as shown in 
Figure 2 and Figure 3, improvement is quite obvious. 
According to the simulation results figures, the following 
table can be achieved. Comparison of two positioning 
methods performance is given in Table II. 
TABLE II.  COMPARISON RESULTS SUMMARY 
Velocity Variance  
1m/s 
0.5m/s 
Positioning error 
RFPM with 3km/h 
49.6m 
47.2m 
RFPM with 120km/h 
46.6m 
45.7m 
RFPM without velocity 
66.9m 
66.9m 
 
Figure 2.  Comparison of methods (0.5m/s) 
 
Figure 3.  Comparison of methods (1m/s) 
V. CONCLUSION AND FUTURE WORKS 
In this paper, several positioning error models are 
provided based on the current 3GPP RAN4 protocols and the 
Cramer-Rao lower bound is used for positioning accuracy 
performance evaluation. As a novel update to the 
conventional schemes, the UE velocity is adopted to improve 
the RF pattern matching efficiency, and this novel RFPM 
scheme can remarkably enhance the UE positioning 
accuracy with 25.8%~32.2% gain compared with the 
traditional RFPM from Cramer-Rao lower bound deducing 
and related simulations. Besides the velocity information, 
other signature information can also improve the RFPM 
performance, such as temperature information, and these 
signature information for RFPM can be included in future 
works. 
ACKNOWLEDGMENT 
This work derived from cooperation project of Huawei 
Technologies Co., Ltd and Beijing University of Posts and 
Telecommunications. 
REFERENCES 
[1] FCC, “Revision of the Commission’s Rules to Ensure Compatibility 
with Enhanced 911 Emergency Calling Systems,” CC Docket 94-102, Jul. 
1996. 
[2] 3GPP TSG-RAN WG4, “Content for TR 36.809 (Study on the inclusion 
of RF Pattern Matching Technologies as a location method in the 
E-UTRAN)”, R4e-110006, Polaris wireless, Apr. 2011. 
[3] 3GPP TSG-RAN WG4, “Discussion on RF pattern matching for 
positioning”, R4-114510, Huawei, HiSilicon, Aug. 2011. 
[4] 3GPP, TS36.133 v10.6.0, “Requirements for support of radio resource 
management”, Mar. 2012. 
[5] Xingchuan Liu, Sheng Zhang, Qingyuan Zhao, and Xiaokang Lin, "A 
novel approach for fingerprint positioning based on spatial diversity," 
Advanced Computer Theory and Engineering (ICACTE), 2010 3rd 
International Conference on , vol. 6, no., pp. V6-441-V6-445, 20-22 Aug. 
2010. 
[6] Takenga, C., Tao Peng, and Kyamakya, K., "Post-processing of 
Fingerprint Localization using Kalman Filter and Map-matching 
Techniques," Advanced Communication Technology, The 9th International 
Conference on , vol. 3, no., pp. 2029-2034, 12-14 Feb. 2007 
[7] Takenga, C. and Kyamakya, K., "A Low-cost Fingerprint Positioning 
System in Cellular Networks," Communications and Networking in China, 
2007. CHINACOM '07. Second International Conference on, vol., no., 
pp.915-920, 22-24 Aug. 2007 
97
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

