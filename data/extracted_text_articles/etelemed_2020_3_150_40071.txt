Electrocardiography Signal Decomposition Using a Novel Modulated Ensemble
Empirical Mode Decomposition Method
Chun-Hsiang Huang
Institute of Biomedical Engineering, College of Electrical
and Computer Engineering
National Chiao Tung University
Hsinchu, Taiwan R.O.C.
e-mail: s09930720@gmail.com
Po-Hsun Huang
Institute of Computer Science and Engineering, College of
Computer Science
National Chiao Tung University
Hsinchu, Taiwan R.O.C.
e-mail: sdk58927@gmail.com
Tzu-Chien Hsiao
Department of Computer Science, Institute of Biomedical
National Chiao Tung University
Hsinchu, Taiwan R.O.C.
e-mail: labview@cs.nctu.edu.tw
Abstract—Electrocardiography (ECG) is an important test in
the diagnosis of heart disease. The analysis of T waves in the
ECG is an essential clinical tool, however, it is often difficult to
extract
the
T
waves
from
the
ECG.
Empirical
Mode
Decomposition
(EMD)
can
decompose
nonlinear
and
nonstationary signals, but this method suffers from the
problem
of
mode
mixing.
Ensemble
Empirical
Mode
Decomposition (EEMD) can solve the mode mixing problem
but
generates
a
new
problem,
namely,
that
of
the
reconstruction error. Moreover, noise may remain in the
decomposed signals and pollute the waveforms. Therefore, we
propose a new method based on EEMD to solve these problems
and to decompose the T wave from ECG. The results show that
the T waves’ waveforms can be successfully decomposed in the
fourth Intrinsic Mode Functions (IMFs) in all 3 cases studied,
namely, no noise, power line noise, and Gaussian white noise.
Keywords-
Electrocardiography;
Empirical
Mode
Decomposition;
Ensemble
Empirical
Mode
Decomposition;
Reconstruction error.
I.
INTRODUCTION
Electrocardiography (ECG) is an important biomedical
signal which can help to diagnose heart diseases [1]. ECG
usually consists of several waveforms. These waveforms are
labeled as P wave, QRS-complex, and T wave. Figure 1
shows the ECG and the waveforms. The P wave represents
the depolarization of the atria. The QRS-complex is caused
by the depolarization of the right and left ventricles. Because
the ventricle muscles are bigger than the atria, the QRS-
complex’s amplitude is usually larger than the P wave. The T
wave is generated by the ventricular repolarization, so the T
wave is after the QRS-complex. The times or segments
between these waveforms are also important features of
ECG. The PR-interval is the time cost of the impulse from
the sinus node to the atrioventricular node. The PR-interval
can help to evaluate the function of the atrioventricular node.
The
ST-segment
represents
the
period
of
ventricles
depolarization and usually isoelectric. The depression or
elevation
of
ST-segment
may
represent
a
cardiac
abnormality. The QT-interval is from the beginning of the
QRS complex to the end of the T wave and varies with the
heart rate. The corrected QT-interval is the QT-interval
divided by the square root of the RR-interval. Prolonged
Corrected QT-interval is a risk factor for ventricular
tachyarrhythmia
and
sudden
death.
Therefore,
feature
extraction and detection of ECG are critical.
For ECG feature extraction and detection, the R wave is
important for its timing. Most common feature extraction
methods mark QRS-complex firstly and then search the P
wave forwardly and the T wave backwardly [2][3]. Unlike
the R wave, T wave’s amplitude and shape are also as
important as its timing. But, the noise like power line noise
and Gaussian white noise will affect ECG [4]. The T wave
will be influenced, too. Getting ECG features without noise
is very important [5]. Many diseases are diagnosed by T
wave’s feature. For example, T-wave inversion, biphasic T-
wave, T-wave alternans, etc.
However, most judgments
need a long time signal analysis and, moreover, these
judgments always depend on doctors and professionals.
Therefore, extracting the T wave is necessary and helpful for
judging the performance of the heart system [6].
Mahmoodabadi et al. use a multiresolution wavelet to
decompose ECG and extract features of ECG [7]. However,
the wavelet is not adaptively [8]. The selection of the mother
wavelet will limit the performance of the wavelet analysis.
Pal and Mitra use Empirical Mode Decomposition (EMD)
[9] to detect the QRS-complex of ECG [10]. EMD is a
decomposition method that can decompose nonlinear and
nonstationary signals into Intrinsic Mode Functions (IMFs)
adaptively. However, it has several problems like boundary
effect and mode mixing problem. The boundary effect is
caused by that extrema value is hard to define at boundary,
and will cause IMFs are distorted at the boundary. The mode
mixing
problem
usually
occurs
when
patterns
appear
intermittently and will cause two issues. The first issue is the
109
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

IMFs of EMD will have different scale patterns mixed in.
The second issue is the same scale pattern may be separated
in different IMFs. So, the ECG, which is one of the signals
with intermittent pattern, will hardly to decompose well by
EMD. Ensemble Empirical Mode Decomposition (EEMD) is
a method which solves the aforementioned problem of the
EMD [11]. Unfortunately, EEMD adds noise into signal and
will remain noise in it [12]. Because the noise remains in,
EEMD is not a good choice to decompose ECG.
In this study, we propose a new method based on EMD
and EEMD. The new method will not add noise to the
original signal. The Gaussian white noise will only assist to
get the reference points which are treated as the extrema
points. The modified part will solve the mode mixing
problem and avoid adding external noise into the ECG
signal. Furthermore, we use this new method to decompose
the T wave from ECG. This new method is temporarily
named
as
modulated
ensemble
empirical
mode
decomposition.
In Section 2, we will introduce the proposed method and
the testing data. In Section 3, we will decompose ECG and
simulated ECG by the proposed method. Otherwise, we will
add some external noise to test whether the new method is
influenced by noises. In Section 4, we will discuss the result
and the main IMF of the T wave. In Section 5, the
conclusion and further work will be proposed.
Figure 1. ECG
II.
MATERIAL AND METHODS
A.
Data
In this study, we verify our method by simulated data and
PhysioNet QT database ECG. Simulated data is generated by
LabVIEW “Simulate ECG”. The database ECG will take
one-minute data and test (A) original signal, (B) signal with
60 Hz power line and (C) signal with Gaussian white noise.
The sampling rate is 250 Hz for all signals.
B.
Methods
Our method is modified from EMD and EEMD. The
detailed processes of EMD and EEMD are shown in Figure 2
and Figure 3.
SD(.) means standard deviation. SDinput is the setting of
stop criteria. M(t) is the mean envelope. ri(t) is IMF or
residue. Compared to EMD, EEMD adds white noise and
averages each IMF to reduce the influence of noise adding.
Figure 2. EMD algorithm procedure
Figure 3. EEMD algorithm procedure
Adding local extrema by adding controlled noise is the
main idea of the noise-assisted variations of EMD [13].
Adding noise is a method to solve the mode mixing problem.
However, the main idea is gaining local extrema to assist in
getting local means. Therefore, we find other points and treat
these points as local extrema. Using these upper and lower
envelopes’ reference points can also find the local mean of
different time scales. To find the upper and lower envelopes’
reference points, we use Gaussian white noise to assist.
Different from other methods, our method only picks up the
timing of the extrema after adding Gaussian white noise.
Then, we use these timings to get the reference points of
upper and lower envelopes. Figure 4 illustrates the proposed
method.
III.
RESULT
A.
Simulated ECG
Figure 5(a) is the simulated ECG which is generated by
LabVIEW “Simulate ECG”. Figure 5(b) shows IMF1 to
110
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

IMF4 which are decomposed by the proposed method. The
QRS-complex timing can be found easily in IMF1. The T
wave might be decomposed in IMF4.
Figure 4. Modulated EMD algorithm procedure
(a)
(b)
Figure 5. Simulated ECG decomposition result: (a)Simulated ECG
which is generated by LabVIEW “Simulate ECG” and (b) decomposition
results.
B.
QT Database ECG
Because the main purpose is extracting T waves,
comparing T wave and IMFs is necessary. T wave timing is
obtained by PhysioNet QT database annotation. Figure 6(a)
shows the ECG signal sel30 and the T wave is marked by a
thick line.
Figure 6(b) shows the results of decomposition and the
same periods of T wave are marked by a thick line. IMF1
might make QRS-Timing obviously. IMF4 can clearly show
the T wave.
C.
QT Database ECG with Power Line Noise
The power line is a common noise of the ECG signal and
might influence the T wave’s waveform. To test whether
decomposition can remove the power line noise, the power
line is added into signals. The adding power line’s amplitude
is 1/10 of the ECG signal and the frequency is 60 Hz.
The ECG signal sel30 with power line noise is shown in
Figure 7(a) and the T wave period is also marked. Figure 7(b)
shows that power line noise is almost dissembled in IMF1.
Therefore, IMF4 can still find clear T waves. The QRS-
complex timing can be checked in IMF2.
(a)
(b)
Figure 6. QT database ECG decomposition demonstration: (a) ECG
signal sel30 and (b) decomposition results. The thick line marks the T wave
period.
111
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

D.
QT Database ECG with Gaussian White Noise
Gaussian white noise is also a common noise in the ECG
signal. To test the decomposition method, Gaussian white
noise is added to the ECG signal. The added Gaussian white
noise’s standard deviation is 1/10 of ECG’s standard
deviation. Figure 8(a) shows the ECG signal sel30 with
Gaussian white noise. Figure 8(b) shows the decomposition
results. The T wave can still be seen in IMF4 clearly. The R-
wave timing can be easily marked from IMF2.
IV.
DISCUSSION
Comparing Figure 6, Figure 7, and Figure 8, adding white
noise will increase the difficulty of the QRS-complex timing
extracting. Moreover, if adding noise in ECG, the IMF
number of judgment QRS-complex timing will be changed.
Otherwise, the T wave seems to be decomposed in IMF4. No
matter if adding power line noise, Gaussian white noise, or
none, the T wave’s waveform remains good. Noise seems to
be decomposed to other IMFs except for IMF4. The T wave
is always decomposed in IMF4. It has an advantage of
automatically finding IMF with T wave. However, it still
needs some judgment indicator to confirm the result.
(a)
(b)
Figure 7. QT database ECG with power line noise decomposition
demonstration : (a) ECG signal sel30 with power line noise and (b)
decomposition results. The thick line marks the T wave period.
To judge whether decomposition results can extract the T
wave, calculating the Correlation Coefficient (r) and the
Root Mean Square Error (RMSE) between decomposition
results in the T wave period is helpful. These two judgment
indicators can check whether the T wave’s phase and
amplitude are retained.
Figure 9 shows the result of 105 records in the QT
database. T waves are decomposed in IMF4. Most of IMF4’s
correlation coefficients are more than 0.9 and most of RMSE
are less than 0.1. The result shows that T waves remain good
in IMF4.
Figure 10 and Figure 11 show the results of 105 records
with power line noise and 105 records with Gaussian white
noise. The results are as good as the results of the clear ECG
signals.
(a)
(b)
Figure 8. QT database ECG with Gaussian white noise decomposition
demonstration : (a) ECG signal sel30 with Gaussian white noise and (b)
decomposition results. The thick line marks the T wave period.
Table 1 shows the result of all records with treatments.
The IMF4’s correlation coefficients are all over 0.95 and
RMSE are all less than 0.04. The proposed method seems to
extract the T wave in the IMF4 and retains the waveform and
phase well. Moreover, with the method we proposed, adding
slight noise will not influence the T wave extracting. The
results show that our method is useful for decomposing T
waves. This might be helpful for several heart diseases
112
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

diagnosing like T-wave inversion, biphasic T-wave, T-wave
alternans, etc.
Figure 9. Correlation coefficient and RMSE between ECG signal
decomposition results in T wave periods
Figure 10. Correlation coefficient and RMSE between decomposition
results of ECG signal with power line noise in T wave periods.
Figure 11. Correlation coefficient and RMSE between decomposition
results of ECG signal with Gaussian white noise in T wave periods.
V.
CONCLUSION
The results of ECG signal decomposition show that the
proposed method extracts T wave well and is helpful for
detecting
QRS-complex
timing.
Furthermore,
the
new
decomposition method has less influence on power line noise
and Gaussian white noise. The proposed method might help
ECG feature extraction and detection.
Although the new method can help to decompose ECG
signals, how to automatically mark ECG’s features is the
next important research.
TABLE I.
CORRELATION COEFFICIENT AND RMSE
Judgment
indicator
Signal treatments
Original
signal
Add power line
noise
Add Gaussian
white noise
r
0.97±0.03
0.98±0.02
0.98±0.02
RMSE
0.04±0.04
0.03±0.03
0.04±0.03
correlation coefficient and RMSE between IMF4 and T wave in T wave period
VI.
ACKNOWLEDGMENT
This work was fully supported by Taiwan Ministry of
Science and Technology under grant numbers MOST 108-
2221-E-009-087.
REFERENCES
[1]
T. M. Nazmy, H. EL-Messiry, and B. Al-Bokhity, "Adaptive
Neuro-Fuzzy inference system for classification of ECG
signals", The 7th International Conference on Informatics and
Systems (INFOS), pp. 1-6, 2010
[2]
A. Espiritu-Santo-Rincon and C. Carbajal-Fernandez, "ECG
feature
extraction
via
waveform
segmentation",
IEEE
International
Conference
on
Electrical
Engineering
Computing Science and Automatic Control (CCE), pp. 250-
255, September 2010.
[3]
T. Khan, N. Sultana, R. Reza, and R. Mostafa, "ECG feature
extraction in temporal domain and detection of various heart
conditions",
2015
InternationalConference
on
Electrical
Engineering and Information Communication Technology
(ICEEICT), pp. 1-6, May 2015.
[4]
S. Jain, V. Bajaj, and A. Kumar, "Riemann Liouville
fractional integral based empirical mode decomposition for
ECG denoising", IEEE J. Biomed. Health Inform., vol. 22, no.
4, pp. 1133-1139, 2018.
[5]
V. Seena and J. Yomas, "A review on feature extraction and
denoising of ECG signal using wavelet transform", Devices
Circuits and Systems, pp. 1-6, March 2014.
[6]
D. Zavantis, E. Mastora, and G. Manis, "Robust automatic
detection of P wave and T wave in electrocardiogram", 2017
Computing in Cardiology (CinC), pp. 1-4, 2017.
[7]
S. Z. Mahmoodabadi, A. Ahmadian, M. D. Abolhasani, M.
Eslami, and J.H. Bidgoli, "ECG feature extraction based on
multiresolution
wavelet
transform",
Proc.
27th
Annual
International
Conference
of
the
IEEE
Engineering
in
Medicine and Biology Society, pp. 3902-3905, January 2005.
[8]
T. Liu, Z. Luo, J. Huang, and S. Yan, "A comparative study
of four kinds of adaptive decomposition algorithms and their
113
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

applications", Sensors, vol. 18, no. 7, pp. 2120-2170, July
2018.
[9]
N. E. Huang, et al., "The empirical mode decomposition and
the Hilbert spectrum for nonlinear and non-stationary time
series analysis," Proc. R. Soc. Lond. A, vol. 454, pp. 903-995,
1998.
[10] S. Pal and M. Mitra, "Empirical mode decomposition based
ECG enhancement and QRS detection", Comput. Biol. Med.,
vol. 42, no. 1, pp. 83-92, January 2012.
[11] Z. Wu and N. E. Huang, "Ensemble empirical mode
decomposition:
A noise-assisted
data analysis
method",
Advances in Adaptive Data Analysis, vol. 1, no. 1, pp. 1-41,
2009.
[12] M. E. Torres, M. A. Colominas, G. Schlotthauer, and P.
Flandrin,
"A
complete
ensemble
empirical
mode
decomposition with adaptive noise", Proc. IEEE Int. Conf.
Acoust. Speech Signal Process., pp. 4144-4147, May 2011.
[13] M. A. Colominas, G. Schlotthauer, and M. E. Torres,
"Improved complete ensemble EMD: A suitable tool for
biomedical
signal
processing",
Biomed. Signal
Process.
Control, vol. 14, pp. 19-29, November 2014
114
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

