Actual Brain Midline Detection using  
Level Set Segmentation and Window Selection 
 
Xuguang Qi, Ashwin Belle, Sharad Shandilya, 
Kayvan Najarian 
Department of Computer Science, School of Engineering, 
Virginia Commonwealth University, 
Richmond, VA 
E-mail: qix2@vcu.edu, bellea@vcu.edu, 
shandilyas2@vcu.edu, knajarian@vcu.edu  
Charles Cockrell, Yang Tang 
Department of Radiology, School of Medicine, 
Virginia Commonwealth University, 
Richmond, VA  
E-mail: chcockrell@vcu.edu, ytang2@vcu.edu  
Rosalyn S. Hobson Hargraves  
Department of Electrical and Computer Engineering, 
Virginia Commonwealth University, 
Richmond, VA 
E-mail: rhobson@vcu.edu  
 
Kevin R. Ward 
Department of Emergency Medicine, 
Michigan Center for Integrative Research in Critical Care 
University of Michigan, 
Ann Arbor, MI  
E-mail: keward@med.umich.edu 
 
 
Abstract—Detection of actual brain midline is essential for 
accurate estimation of midline shift due to traumatic brain 
injury. An effective method to estimate the actual midline is to 
use the positions of the identified ventricles. In this work, a 
level set algorithm combined with Ventricle Window Selection 
Algorithm and Ventricle Identification Algorithm is proposed 
to detect the ventricular system in computed tomography (CT) 
images. The system automatically selects appropriate slices 
from numerous raw slices and confines the focus to the region 
of interest prior to segmentation. The variational level set 
method 
performs 
ventricle 
segmentation 
without 
any 
requirement of re-initialization or intensity-homogeneity of CT 
images. Combined with ventricle identification, the level set 
segmentation successfully extracts ventricle contours and 
estimates actual midline. Experimental results assessed on 391 
CT slices of 40 patients support that the proposed system is 
accurate (90%) and useful for clinical practice. 
Keywords-actual midline; ventricle; CT slice; window 
selection; level set segmentation 
I. 
 INTRODUCTION 
Automated actual midline detection precedes accurate 
midline shift estimation, which is a key clinical index to 
assess the severity of Traumatic Brain Injury. Midline Shift 
is known to be highly correlated with elevated Intracranial 
Pressure levels (ICP) [1]. Computer-aided estimation of the 
actual brain midline using medical images has attracted a 
great deal of attention [2-4]. Using quadratic Bezier curve [5] 
in CT image segmentation, the model introduced by Liao et 
al., is simple and effective, but it suffers from low accuracy 
when CT slices show spontaneous intracranial hemorrhage 
[5]. Chen et al. proposed a method based on Gaussian 
Mixture Model and template matching to detect the ventricle 
system on brain CT image. This method has high-accuracy 
but is time-consuming during the computation of brain 
midline estimation [6, 7]. Variational level set method 
overcomes the intrinsic limitation of re-initialization and 
high sensitivity on intensity-homogeneity [8]. It has been 
widely used in medical image processing [9, 10].  
In this work, a system based on variational level set 
segmentation combined with Ventricle Window Selection 
Algorithm (VWSA) and Ventricle Identification Algorithm 
(VIA) has been proposed, for ventricle detection and midline 
estimation. The system achieves higher accuracy with less 
time consumption on midline estimation as compared to 
other proposed methods.  
The rest of this paper is organized as follows: the 
methodology is introduced in Section II, results are 
presented and discussed in Section III, and the conclusion of 
this work is given in Section IV. 
II. 
METHODOLOGY 
A flowchart of the four-step algorithm for actual midline 
estimation is shown in Figure 1. 
 
 
Figure 1.  Flowchart of actual midline estimation 
122
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-283-7
ICCGI 2013 : The Eighth International Multi-Conference on Computing in the Global Information Technology

First, Ventricle Window Selection Algorithm is run with 
all raw CT slices to select appropriate ones. Second, 
utilization of the level set segmentation effectively extracts 
candidate contours. Subsequently, the right and left lateral 
ventricles are determined in ventricle identification. Lastly, 
the brain midline is estimated using the position of the 
ventricles.  
 
2.1     Ventricle Window Selection Algorithm (VWSA) 
In clinical practice, even though dozens of CT images 
can be acquired from the head CT scans of each patient, only 
a few of these slices contain clear ventricle information 
owing to appropriate scan position. Hence, Ventricle 
Window Selection Algorithm (VWSA) is designed to narrow 
down the selection of relevant CT slices and confine the 
region of focus. 
  
 
Figure 2.  Flowchart of Ventricle Window Selection Algorithm (VWSA) 
Raw CT slices may contain too much noise and other 
irrelevant tissue information, which affects the visibility of 
ventricles. Moreover, since the speed of contour evolution in 
subsequent level set segmentation largely depends on size of 
image, narrowing down the region of interest can accelerate 
the algorithms throughput. Therefore, as the flowchart shows 
in Figure 2, the first step of VWSA is confining the focus of 
operation to a window within a fixed area in the upper center 
of the brain. We set a window with size of 140*200 pixels. 
Because of anatomical characteristics and observations 
during the algorithm development process, this region 
contains ventricles and is hardly affected by skull or by the 
presence of other tissues. Using K-means clustering on the 
gray scale of every pixel, the pixels belonging to the 
ventricle class are distinguished from all other pixels within 
the window. In order to evaluate the visibility of ventricles in 
slices, a new measure, called Ventricle Fidelity Measure (Fv), 
has been introduced in this study.  Fv  is a proportion defined 
by the number of pixels labeled as the ventricle class over 
the total number of pixels in the window. The larger the 
Ventricle Fidelity Measure is, the more visible the ventricle 
should be within the image. Three slices with the largest Fv 
values are selected as the candidate slices for the following 
detection. 
2.2    Ventricle segmentation based on level set method 
Region-based 
geometric 
active 
contour 
model 
implemented by variation level set method [9] is used in 
ventricle contour detection. 
Here, we consider a two-dimensional gray level image 
I   :  →
, where 
  2
 is the image domain and I is the 
image intensity [9]. C represents closed contour in the 2-D 
image domain (
C  
) and segments the image into two 
regions: 
1  outside(C )
 and 
2  inside(C )
. Contour C 
can be expressed by the zero level set of a Lipschitz function 
   :  →
, which is a level set function. The energy function 
F(φ, f1, f2), which is subject to minimization is defined as; 
 
)
P(
)
vC(
( x ), f ( x ))
f,
(
( x ), f ( x ))
f,
F(
f









2
1
2
1
  (1) 
 
where the fitting energy εf minimizes the gray value variance 
in separated phases, the contour length |C(φ)| smoothes the 
curve, and the internal energy μP(φ) helps stabilize curve 
evolution. f1(x) and f2(x) reflect the intensity in the region 
with center x. With a fixed f1 and f2, the energy function F(φ, 
f1, f2)  in (1) can be minimized by solving the gradient flow 
equation as follows: 
f ( y ) dy
y ) (I x )
K ( x
)(
(
t
2
1
1


 








  
f ( y ) dy
y ) (I x )
( x
K
2
2
2





                         (2) 
))
div(
(
)
)div(
(
v






 








2
 
with  
 
f ( y ) dy
y ) (I x )
K ( x
f ( y ) dy
y ) (I x )
K ( x
)(
(
2
2
2
2
1
1














being the data fitting term; 
 
)
)div(
(
v


 


 represents the arc length term; and 
 
)
div(
(







2
 is the level set regularization term. 
The segmentation used in this work is based on the level 
set evolution equation (2). Further details can be found in [9]. 
Level set regularization term effectively eliminates time 
consumption due to re-initialization, which is one of the 
main purposes of using this method in segmentation. 
Using the variational level set method in segmentation, 
candidate contours are extracted from the candidate CT slice. 
Generally, two ventricle contours is expected to be found 
corresponding to the right and left lateral ventricles. 
However, due to the complexity of CT images, in practice, 
more (or less) than two contours are possibly found. 
Therefore, we need the following ventricle identification 
process to identify the actual ventricles. 
 
2.3    Ventricle identification and actual midline estimation 
As the flowchart shows in Figure 3, the first step of the 
VIA is to identify the right and left lateral ventricle contours 
from a set of contours obtained from level set segmentation. 
We remove the unclosed contours using the Connected 
Component Algorithm (CCA) [11]. Assume that n-candidate 
123
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-283-7
ICCGI 2013 : The Eighth International Multi-Conference on Computing in the Global Information Technology

contours are retained in the VWSA window. If n equals 0 or 
1, it means that either no ventricle or a mangled ventricle 
image is displayed in the CT slice. The algorithm 
automatically skips this slice and moves back to VWSA to 
compute on the next candidate slice. In the case where two or 
more candidate contours are found, the two contours with the 
largest length are chosen as the right and left lateral 
ventricles. 
 
 
Figure 3.  Flowchart of ventricle identification 
In order to determine the mass center of a contour, the 
moment mpq [12] with the order of p+q of the digital image   
is defined as below, 
,      (p = 0,1;q= 0,1)
j
i
=
m
n
1
j
m
1
i
ij
q
p
pq 




              (3) 
where ij is the image intensity of the element at the ith row 
and the jth column in the matrix . This means that ij 
equals 1 when the element is on the contour, else equals 0. 
Then, the coordinate of the mass center (x, y) [12] of the 
object contour is given by 








00
01
00
10
m
m
y
m
m
x
                                         (4) 
 
Finally, the step of estimating the actual midline can be 
performed. Assuming that the right and left lateral ventricles 
have the mass center positions of (x1, y1) and (x2, y2), 
respectively, the actual midline is believed to be at the 
middle of the two ventricles and have the slope K as shown 
below; 
 
y )
y
(
x )
tan ( x
K
1
2
1
2


 
                                (5) 
III. 
RESULTS AND DISCUSSION 
3.1   Data 
The dataset in this study contains 391 axial CT scan 
slices acquired across 40 patients with cases of both mild and 
severe Traumatic Brain Injuries.  
3.2.    Results of Ventricle Window Selection Algorithm 
Ventricle Window Selection Algorithm (VWSA) is 
aimed at selecting the most appropriate slices and confining 
the window of focus. Figure 4 shows that three CT slices 
with the largest Fv values are selected as candidate slices 
from a patient’s CT scans. As can be seen, the first candidate 
slice Figure 4-(a) with the largest Fv, shows ventricles more 
clearly than the other two. In our experiment, 30 out of 36 
cases, in which ventricle boundaries were correctly extracted 
with segmentation, obtained their actual midline using the 
VWSA slice with the top Fv. 
 
 
Figure 4.  Results for Ventricle Window Selection Algorithm: three 
candidate slices are selected from one patient’s CT images.  
With the focus region confined from whole image to only 
the VWSA window, the time-cost associated with level set 
segmentation is greatly reduced. Additionally, the contour 
evolution becomes much easier due to the avoidance of the 
artifacts present outside the windowed region.  
3.3    Level Set Segmentation 
The algorithm has been implemented in Matlab on a PC 
with Intel core I7 3.40 GHz processor with 8GB RAM. The 
initial level set function φ assigns the value 2 for all the 
pixels within the VWSA window. The parameters of the 
level set function are set as follows, 1=1, 2=1, =3.0, time 
step t=0.1, μ=1, and v=0.001×255×255. 
Figure 5 depicts the results of the level set method at 
various iterations. It demonstrates how the algorithm evolves 
from the initial stage 0 iteration to the final stable contour at 
iteration 200. The images from the left to right shows 0, 50, 
100, and 200 iterations in level set evolution, respectively. 
The evolution becomes stable after 200 iterations. From the 
above results, it can be seen that the level set segmentation 
124
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-283-7
ICCGI 2013 : The Eighth International Multi-Conference on Computing in the Global Information Technology

successfully extracts the final contours that match the 
ventricles boundary well. It provides a good foundation for 
the 
subsequent 
ventricle 
identification 
and 
midline 
estimation. 
 
   
 
0th iteration                           50th iteration 
   
 
100th iteration                           200th iteration 
Figure 5.  Contour evolution using the level set algorithm. From left to 
right images show different levels of iterations. 
In this work, the average CPU time used on the level set 
evolution on one candidate CT slice is 129.2 seconds. In 
order to test the computational cost of the algorithm, we 
compare the experimental results of the level set 
segmentation and the Gaussian Mixture Model (GMM) 
method [7] on the same database under the same hardware 
configuration. It is found that the level set segmentation 
takes 17% lesser computational time as compared to the 
GMM method. 
3.4   Ventricle identification and actual midline estimation 
in post-processing  
The ventricle identification and midline estimation 
process is shown in Figure 6. Three candidate contours are 
extracted by level set segmentation (Figure 6-a). VIA selects 
the largest two to represent the left and right lateral ventricles. 
Then, their mass centers, calculated by (11), are labeled in 
Figure 6-b. According to the positions of the ventricle mass 
centers, the actual midline is estimated and shown in Figure 
6-c.  
The collaborating physicians manually labeled the actual 
midline for every patient in the database. With a strict  
 
  
  
 
(a)                          (b)                        (c) 
Figure 6.  Ventricle identification and midline estimation. (a) The 
candidate contours extracted by level set segmentation, (b) ventricle 
contour identification and mass ceters determination, (c) midline estimation.  
definition of accuracy, which is an allowed error of three
 pixels in the horizontal direction and two degrees of the 
rotation angle, the accuracy of the midline estimation of our 
system is 90%, which is much higher than 87.5% using 
GMM method in [7]. 
IV. 
CONCLUSION 
In this work, an actual midline detection system based on 
the level set segmentation and window selection has been 
proposed. The Ventricle Window Selection Algorithm not 
only selects appropriate CT slices containing clear ventricle 
information but also confines the focus of operation. It 
greatly enhances the efficiency of the whole system by 
reducing processing time for the level set segmentation. The 
variational level set segmentation model, combined with the 
ventricle 
identification 
process, 
successfully 
extracts 
ventricle contours. Actual midline is estimated by the 
positions of the ventricle contours. With physician’s 
validation, the results show a high accuracy of 90% for 
midline estimation. This makes the new system viable in 
clinical settings. 
REFERENCES 
[1] J. S. Broder, “Head computed tomography interpretation in 
trauma: a primer,” The Psychiatric Clinics of North America, 
vol. 33, 2010,  pp. 821–854. 
[2] S. Prima, S. Ourselin, and N. Ayache, “Computation of the 
Mid-Sagittal Plane in 3-D Brain Images,” IEEE Transactions 
on medical imaging, vol. 21, no. 2, 2002, pp. 122-138. 
[3] Q. Hu and W. L. Nowinski, "A rapid algorithm for robust and 
automatic extraction of the midsagittal plane of the human 
cerebrum from neuroimages based on local symmetry and 
outlier removal", NeuroImage, vol. 20, no. 4, 2003, pp. 2154-
2166. 
[4] A. V. Tuzikov, O. Colliot, and I. Bloch, “Brain symmetry 
plane computation in MR images using inertia axes and 
optimization”, Proceedings of the International Conference on 
Pattern Recognition on 1 (ICPR1), 2012, pp. 516-519. 
[5] C. C. Liao, I. J. Chiang, F. Xiao, and J. M. Wong, “Tracing 
the deformed midline on brain CT,” Biomedical Engineering 
Application, Basis and Communications, vol. 18, December 
2006, pp. 305-311. 
[6] W. Chen, R. Smith, S.Y. Ji, K. Ward, and K. Najarian, 
“Automated ventricular systems segmentation in brain CT 
images by combining low-level segmentation and high-level 
125
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-283-7
ICCGI 2013 : The Eighth International Multi-Conference on Computing in the Global Information Technology

template matching,” BMC Medical Informatics and Decision 
Making, vol. 9, no. Suppl 1, 2009, pp. S4. 
[7] W. Chen, K. Najarian, “Segmentation of ventricles in brain 
CT images using Gaussian mixture model method,” 
Proceedings of IEEE International Conference on Complex 
Medical Engineering (CME), April 2009, pp. 1-6.  
[8] C. Li, C. Xu, C. Gui, and M. D. Fox, "Level Set Evolution 
Without Re-initialization: A New Variational Formulation", 
Computer Vision and Pattern Recognition, vol. 1, June 2005, 
pp. 430– 436 
[9] C. Li, C. Kao, J. C. Gore, and Z. Ding, "Minimization of 
Region-Scalable Fitting Energy for Image Segmentation", 
IEEE Transactions on Image Processing, vol. 17, no. 10, 
October 2008, pp. 1940-1949. 
[10] C. Li, R. Huang, Z. Ding, C. Gatenby, D. N. Metaxas, and J. 
C. Gore, "A Level Set Method for Image Segmentation in the 
Presence of Intensity Inhomogeneities with Application to 
MRI", IEEE Transactions on Image Processing, vol. 20, no. 7, 
July 2011, pp. 2007-2016.  
[11] R. M. Haralick and L. G. Shapiro, “Computer and Robot 
Vision,” Volume I, Addison-Wesley, 1992, pp. 28-48. 
[12] R. Mukundan and K. R. Ramakrishnan, “Moment Functions 
in Image Analysis: Theory and Applications,” Chapter 2, 
World Scientific, 1998, pp. 9-38.   
 
 
126
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-283-7
ICCGI 2013 : The Eighth International Multi-Conference on Computing in the Global Information Technology

