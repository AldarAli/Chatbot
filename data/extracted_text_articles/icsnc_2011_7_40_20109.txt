New Block-Relationships Based Stereo Image Watermarking Algorithm  
Mei Yu1,2, Aihong Wu1, Ting Luo1 
1. Faculty of Information Science and Engineering 
Ningbo University 
Ningbo, China 
{yumei2, wuaihong}@126.com, luoting@nbu.edu.cn  
Gangyi Jiang1,2, Fucui Li1, Songyin Fu1 
2. National Key Lab of Software New Technology 
Nanjing University 
Nanjing, China 
jianggangyi@126.com, {lifucui,fusongyin}@nbu.edu.cn
 
 
Abstract—A 
new 
relationship 
based 
stereo 
image 
watermarking algorithm for three dimensional video system on 
the concept of intra-blocks and inter-blocks relationships is 
given. Corresponding coefficients of discrete cosine transform 
and discrete wavelet transform  in the same position blocks are 
employed for defining intra-block relationship. Direct current 
coefficients for stereo pair in the same position blocks are used 
to describe inter-block relationship. Both of relationships are 
used to embed digital watermarks into stereo image pair; 
moreover, parity quantization is designed for watermark 
embedding 
when 
relationships 
can 
not 
work 
well. 
Experimental results show that the proposed algorithm can 
embed a watermark into images invisibly and the watermark 
can be detected blindly. At same time, the proposed algorithm 
is robust to attacks, such as JPEG compression, noise, filter, 
cropping, and so on. 
Keywords- Three dimensional video system; Stereo image 
watermark; Intra- and inter-block relationships. 
I. 
 INTRODUCTION 
Three dimensional video (3DTV) systems [1] have been 
recently developed which significantly improve visualization. 
Many people believe that 3DTV will be next important 
development step towards a more natural and life-like home 
entertainment experience. Meanwhile, as computer network 
and multimedia-related technologies are in its rapid 
developing period, it is inevitable to transmit 3D media 
through communication channels in great quantity.  A great 
chance of developing the copyright protection technologies 
of 3DTV will be produced as well. Watermarking [2] is one 
of technologies, which is the process of embedding the 
particular information inside the 3D digital contents as a 
solution to prove the ownerships. 
In the past, many kinds of watermarking algorithms are 
designed for text, audio, digital still images, and video 
sequences, very few algorithms have been proposed for 
watermarking of stereo images. Patrizio described an object-
oriented method for watermarking stereo images [3], and the 
watermark embedding is performed in the wavelet domain 
using quantization index modulations method, and the 
proposed algorithm is fragile against attacks. Hwang et al. 
proposed stereo image watermarking schemes based on 
discrete cosine transform (DCT) or discrete wavelet 
transform (DWT) [4][5]. The watermark is embedded into 
the right image of a stereo image pair in the frequency 
domain in [4], and is embedded into the left image of a 
stereo image pair by using DWT [5].  
A stereo image includes left and right images which are 
composing the same scene are taken by two cameras 
corresponding to the right and left eye-views. Differences 
between left and right images are called the “disparity” 
between them. Stereo image pair must have some relations 
which can be used to embed digital watermarks. However 
few algorithms based on pair relationships are depicted in the 
literature. In the past years a lot of digital watermarking 
algorithms based on relationships are proposed for mono- 
images and videos. Langelaar used energy differences 
between DCT blocks [6] for watermarking. Ling et al. 
addressed the real time requirement of video watermarking 
based on energy difference. Chen et al. designed the 
watermark embedding based on the relationships between 
wavelet coefficients [8].  Kim et al. presented watermark 
algorithm based on relationship between blocks in DCT 
transform [9]. However, those above relationships are used 
in mono-image watermarking, and new relationships will be 
designed for stereo images in this paper. 
Most of above algorithms employ transformations to 
embed watermark such as DCT and DWT. Haj presented 
combined DWT-DCT digital image watermarking [10] 
because of the advantages of DCT domain and DWT domain. 
Thus, DCT will be used in the proposed algorithm as well.  
In this paper, a new relationships based stereo image 
watermarking algorithm is presented. The proposed 
algorithm is linked to the nature of the stereo pair and the 
watermark is embedded into both of left and right images 
partly, not only into one image for transparency. The 
experiments show the transparency and robustness against 
attacks such as noise, JPEG compression, filtering and 
cropping. The rest of paper is organized as follows: the 
proposed algorithm is described in section Ⅱ; section Ⅲ 
demonstrates some experimental results of the proposed 
algorithm; finally, Section Ⅳ gives the conclusions. 
II. 
THE PROPOSED ALGORITHM 
In this work, the left and right images are divided into 
non-overlapping n×n blocks. Let binary watermark denote W 
with m×m size, and m×m≤(M×N)/(n×n), where M×N is the 
size of original images,. In the domain of the information 
security, the scrambling image is a usual way for image 
processing. Thus the 2-dimensional Arnold transformation is 
employed for watermarks and Ŵ={w1,w2,…wi; 0<i≤m×m } is 
achieved. The watermark will be embedded into the intra-
block, inter-block relationships or quantization as depicted in 
Fig.1. Either of three choices will be designed for watermark 
171
ICSNC 2011 : The Sixth International Conference on Systems and Networks Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-166-3

embedding according to the preferences. Each component 
will be introduced in the following sections. 
 
 
Figure 1.  The main processes for embedding 
A. Intra-block and Inter-block Relationships 
The stereo image includes left image and right image 
with same size, which are divided into blocks with n×n. DCT 
and DWT are applied in all blocks respectively. The direct 
current (DC) coefficient of the DCT domain and low 
frequency coefficient of two-level DWT domain have the 
similar transformation trend when images are on the attack. 
Thus the intra-block relationship is between DC coefficient 
in DCT domain and the second value (LL2i2) of low 
frequency matrix in DWT domain, which are applied in the 
same blocks of images. Let the intra-block value denote IABi 
which is defined as  
⎩
⎨
⎧
≤
>
=
2
2
2
0
2
1
i
i
i
i
i
LL
DC
LL
DC
IAB
                       (1) 
where DCi is the DC coefficient of DCT domain for block i. 
For left image and right image are high similarities, 
especially in the background area. DC strands for the basic 
energy of image block, therefore DC for both same position 
blocks of stereo pair have similar trends when attacks are on 
pair.  The inter-block relationship is built on DCL,i, and DCR,i. 
DCL,i, is DC coefficient of left image block i and DCR,i is DC 
coefficient of right image block i. If DCL,i, is greater than 
DCR,i, the value of inter-block IRBi is  “1”, and otherwise, 
IRBi is “0”.  
Each wi of the binary watermark only has one value “0” 
or “1”. For relationship embedding, if  IABi for left and right 
image are same as wi, any coefficient of the blocks i is not to 
be modified. When three values are not the same, IRBi will 
be compared with wi. If they are same, any coefficient of the 
blocks is still unchanged, and otherwise, the DC coefficient 
of either left or right image needs to be changed and 
quantization step is required.  
B. Parity Quantization 
In this step, parity quantization is employed for the 
algorithm. DCL,i, and DCR,i  are quantized by the quantization 
step value S, and QL,i and QR,i are calculated as 
⎣
DC S⎦
Q
/
=
                              (2) 
The processes for the quantization are described as follows. 
 If wi =1 and QL,i mod 2 =QR,i mod 2, neither of DCs 
will be update. Otherwise, either DCL,i, or DCR,i will be 
modified for same parity of QL,i and QR,I. The modification 
rule is that the range of DC modification is least. 
mod2}
mod2
|,
min{|
'
,
,
'
R i
L i
Q
x Q
x
=
=
       (3) 
mod2}
mod2
|,
min{|
'
,
,
'
L i
R i
Q
y Q
y
=
=
       (4) 
where Q’
L,i=floor((DCL,i,+x)/S), Q’
R,i=floor((DCR,i,+y)/S). If 
x’/DCL,i is less, the DCL,i should be modified, and vice verse. 
If wi =0 and QL,i mod 2 =QR,i mod 2, the DC coefficient will 
not be changed either, otherwise, DCL,i, or DCR,i will be 
modified according to the rule of quantization. 
For the parameter S, it is related to the quality image, 
and according to transparency and robustness, S is set to 10 
in the experiments. 
C. Main Steps for Watermaring 
Four secret keys are designed for the algorithm. 1×2 
matrix EM is used for recording embedding methods as key1, 
L times Arnold transformation is key2 and cycle of 
transformation T is key3 and S is key4. The main steps for 
embedding watermark are depicted as following five steps. 
Step 1: The left and right images are divided into non-
overlap blocks of size 8×8 and it is block transformed using 
DCT and two-level DWT technique respectively. The 
watermark 
W 
is 
transformed 
to 
Ŵ 
with 
Arnold 
transformation, and set i=1; 
Step 2: Compute intra-block IABi for block i of left and 
right image and inter-block IRBi relationships.. 
Step 3: Preference 1: if IABi of left and  IABi of right 
images are both equal to wi, then EMi=”00”, and go to step 4. 
Otherwise, the preference 2 is chosen. Preference 2: if IRBi is 
equal to wi, then EMi=”01”, and go to step 4 as well. 
Otherwise, preference 3 will be selected. Preference 3: 
compute the QL,i and QR,i, and set  EMi=”10”. Update 
corresponding DC coefficients according to the processes of 
the quantization. 
Step 4: If i≤m×m, then i++ and go back to the step 3, 
otherwise, go to next step. 
Step 5: Reconstruct the stereo images with watermark by 
inversing modified DCT transforms of left and right images. 
D. Main Steps for Extracting Watermark  
For a given stereo image pair, the recorded information 
about the embedded watermark (key1, key2, key3 and key4) 
should be provided for the watermark extraction from the 
172
ICSNC 2011 : The Sixth International Conference on Systems and Networks Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-166-3

images. The detailed extracting procedure is described as 
follows. 
Step 1: the given embedded watermark stereo image pair 
is divided into non-overlap blocks of size 8×8 and it is block 
transformed using DCT and two-level DWT respectively.  
Step 2: set i=1, and get the DC coefficient DCEL,i, DCER,i 
for block i of left and right images, and get the second low 
frequency coefficient as well. If DC is greater than DWT 
coefficient in the same block, then intra-block value is “1”, 
otherwise is “0”. Thus IABL’
i is the intra-block value for 
block i of left image, and IABR’
i is the intra-block value for 
block i of right image. Suppose DCEL,i and  DCER,i are DC 
for block i of left and right image, and the inter-block 
relationship IRB’
i  is calculated by 
⎩
⎨
⎧
≤
>
=
R i
i
L
R i
L i
i
DCE
DCE
DCE
DCE
IRB
,
,
,
,
'
0
1
              (5) 
Step 3: via key1 get embedding methods matrix EM. Get 
the Arnold transformation watermark w’
i. When EMi=”00”, 
w’
i is calculated by:  
1
'
'
1
'
0
'
'
0
i
IABL i
IABR i
w
IABL i
IABR i
=
=
⎧
= ⎨
=
=
⎩
                    (6) 
Suppose  EMi=”01”, w’
i is computed by: 
'
'
1
1
'
0
0
i
i
i
IRB
w
IRB
⎧
=
⎪
= ⎨
=
⎪⎩
                                      (7) 
If EMi=”10”, and the quantization values for left and 
right images are calculated according to Eq.(1) and key4. 
If they have same parity w’
i=1, otherwise w’
i =0. 
Step 4: if i≤m×m, then i++ and go back to the step 2, 
otherwise, go to next step. 
Step 5:the Arnold transformation watermark W’={w’
1,w’
2 
w’
3…..,w’
m×m} is gained, and with key2 and key3, the final 
recovered watermark WN is achieved via (key3 -key2) Arnold 
transformation. 
III. 
EXPERIMENTAL RESULTS AND DISCUSSIONS 
In order to show the transparency and robustness of the 
proposed algorithm, a series of experiments will be tested in 
this section. The first frame of stereo image pair of “Puppy” 
with 640×480 pixels are taken for test images as illustrated in 
Fig 2. And a binary watermark with 64×64 pixels as shown 
in Fig 4(a).  
A. Watermark Evaluation  
To evaluate the quality of watermarked stereo images, 
the watermark recovering rates is defined with HC.  
m
m
W
W
HC
×
⊕
= −
∑
'
1
                      (8) 
where  ⊕  is exclusive-OR. 
B. Transparency of Watermark 
In the experiment, L=28, T=48, S=10. The watermark is 
transformed by Arnold as illustrated in Fig. 4(b). The 
watermark is embedded into the pair of stereo images shown 
in the Fig.3. Obviously the watermark is transparent to 
visualization. The peak signal to noise ratio (PSNR) is used 
to evaluate the perceptual distortion. The PSNR of 
watermarked left image and right image are 52.14dB 
51.99dB, respectively. It means the proposed algorithm has 
transparency ability. Moreover the watermark can be 
detected by the algorithm totally as illustrated in Fig. 4(c) 
and 4(d) when images are not under the attacks, and HC is 1. 
C. Robustness to Attacks 
Here, JPEG compression, salt and pepper noise, filtering, 
and cropping are used to attack watermark embedding 
images (left and right images are attacked to the same extents) 
respectively, the experiments results confirms the robustness 
and stability of the proposed algorithm. 
 
Figure 2.  Original image. (a) left image and (b) right image 
 
Figure 3.  (a) left watermarked image; (b) right watermarked image. 
 
 
 
 
 
(a) 
(b) 
(c) 
(d) 
Figure 4.   (a) original watermark; (b) Arnold transformation of  watermark; 
(c) extractedArnold transforamtion watermark; (d) recovered watermark. 
 
 
 
 
(a) Q=90 
HC=0.9765 
(b) Q=70 
HC=0.9685 
(c) Q=50 
HC=0.9248 
(d) Q=30 
HC=0.8982 
 
Figure 5.  Recorvered watermarks after JPEG compression. 
173
ICSNC 2011 : The Sixth International Conference on Systems and Networks Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-166-3

 
 
 
 
(a) r=1% 
HC=0.9231 
(b) r=2% 
HC=0.9133 
(c) r=3% 
HC=0.9055 
(d) r=4% 
HC=0.9006 
(e) r=5% 
HC=0.8943
Figure 6.  Recorvered watermarks after salt and peppers noise 
 
 
 
(a) Median(s=3) 
HC=0.9685 
(b) Median (s=5)  
HC=0.9460 
(c) Median (s=9) 
HC=0.9160 
 
 
(d) Average (s=3) 
HC=0.9775 
(e) Average (s=5) 
HC=0.9351 
(f) Average (s=9) 
HC=0.9216 
Figure 7.  Recorvered watermarks after median filter and average of 
different sizes (s×s). 
 
 
 
 
(a) 1/4 left-top 
HC=0.8345 
(b) 1/8 left-top 
HC=0.9614 
(c) 1/4 middle 
HC=0.6506 
(d) 1/8 middle 
HC=0.8284 
Figure 8.  Recorvered watermarks after cropped from different parts.. 
Attacks with JPEG Compression: Fig.5 shows 
recovered watermarks after JPEG compression with different 
quality and corresponding HC. Visually watermarks can be 
recognized and the values of HC are all around 0.9. It proves 
the robustness. When Q is from 90 to 30, the HC is 
decreased steadily and not dropped like Q decreased. So the 
proposed algorithm is still stabile. 
Attacks with salt and peppers noise: after distorting the 
watermarked images by different rates salt and pepper noise, 
the recovered watermarks are shown in Fig. 6. The 
watermark can be detected clearly and the most of HC are 
greater than 0.9. It proves the robustness again. Moreover, 
the changing scope of HC is tiny, which shows the stability 
of the proposed algorithm. 
Filtering: when the watermarked images are filtered by 
median and average filter of different sizes, all watermarks 
can be examined as illustrated in Fig. 7. Furthermore, the 
values of HC are all greater than 0.92. Thus, the proposed 
algorithm has the ability against filtering. 
Cropped: the proposed algorithm is tested against 
cropping as well. Watermarked images are cropped from 
different parts: 1/4 top-left, 1/8 top-left corner, 1/4 middle 
and 1/8 middle. Apparently watermarks can be detected as 
shown in Fig. 8.  
IV. 
CONCLUSTION 
In this paper, a novel stereo image watermarking 
algorithm based on relationships and quantization is 
proposed. The intra-block and inter-block relationships are 
employed 
for 
embedding 
watermarks. 
Moreover 
quantization of direct current coefficients in DCT domain is 
used for watermark embedding when relationships cannot 
work well. The experiments demonstrate the transparency of 
the proposed algorithm. Furthermore, when watermarked 
pairs of stereo images are on the attack, the watermark can 
be still detected well and it proves the robustness. However, 
cropping attack affects the quality of watermarked images 
much, and we will improve it in the future work. 
ACKNOWLEDGMENT 
This work was supported by Natural Science Foundation 
of China (61071120, 60872094, 60832003), Natural Science 
Foundation of Zhejiang Province (Y1101240), the projects 
of Chinese Ministry of Education (200816460003), and 
Natural Science Foundation of Ningbo (2011A610197). 
REFERENCES 
[1] P. Benzie, J. Watson, P. Surman, I. Rakkolainen, K. Hopf, H. 
Urey, and et al., A survey of 3DTV dispalys: techniques and 
technologies. IEEE Transactions on circuits and systems for 
video technology, vol. 11, no. 17, 2007, pp. 1647-1658. 
[2] I. Cox, M. Miller, J. Bloom, J. Fridrich and T. Kalker, Digital 
watermarking and steganography, the 2nd ed., Morgan: 
Kaufmann, 2007. 
[3] P. 
Campisi. 
Object-oriented 
stereo-image 
digital 
watermarking. Journal of Electronic Imageing, vol. 17, no. 4, 
2008, art. no. 043024. 
[4] D. Hwang, K. Bae, M. Lee and E. Kim, Real time stereo 
image watermarking using discrete cosine transform and 
adaptive disparity map, Proc. SPIE 5241, 2003, pp. 233-242. 
[5] D. Hwang, J. Ko, J. Park and E. Kim, Stereo watermarking 
scheme based on discrete wavelet transform and feature-based 
window matching algorithm, Proc. SPIE, 2004, pp. 182-191. 
[6] G. Langelaar and R. Lagendijk, Optimal differential energy 
watermarking of DCT encoded images and video, IEEE 
Transactions on Image Processing, vol. 10, no.1, 2001, pp. 
48-158. 
[7] H. Ling, Z. Lu, and F. Zou, Improved differential energy 
watermarking (IDEW) algorithm for DCT encoded image and 
video, Int. Conf. on Signal Processing, 2004, pp. 2326-2329. 
[8] Y. Chen, J. Su and H. Fu, Adaptive watermarking using 
relationships between wavelet coefficients, ISCAS, 2005, pp. 
4979-4982. 
[9] S. Kim, S. Lee, T. Kim, K. Kwon and K. Lee, A video 
watermarking using the 3-D wavelet transform and two 
perceptual watermarks. LNCS, 2005, pp. 294-303. 
[10] A. Haj, Combined DWT-DCT digital image watermarking, 
Journal of Computer Science, vol. 3, no. 9, 2007, pp. 740-746. 
 
 
174
ICSNC 2011 : The Sixth International Conference on Systems and Networks Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-166-3

