Pointing out the Convolution Problem of Stochastic Aggregation Methods for the
Determination of Flexibility Potentials at Vertical System Interconnections
Johannes Gerster
and Sebastian Lehnhoff
Department of Computing Science
CvO Universität Oldenburg
Email: johannes.gerster@uol.de
Marcel Sarstedt
and Lutz Hofmann
Institute of Electric Power Systems
Leibniz Universität Hannover
Email: sarstedt@ifes.uni-hannover.de
Eric MSP Veith
OFFIS e.V.
R&D Division Energy
Oldenburg, Germany
Email: eric.veith@ofﬁs.de
Abstract—The increase of generation capacity in the area
of responsibility of the Distribution System Operator requires
strengthening of coordination between Transmission System
Operator and Distribution System Operator in order to prevent
conﬂicting or counteracting use of ﬂexibility options. For this
purpose, methods for the standardized description and identiﬁca-
tion of the aggregated ﬂexibility potential of distribution grids
are developed in the context of Smart Grids management and
control. Approaches for identifying the ﬂexible operation region of
distribution grids can be categorized into two main classes: Data-
driven/stochastic approaches and optimization-based approaches.
While the latter have the advantage of working in real-world
scenarios where no full grid models exist, when relying on nai¨ve
sampling strategies, they suffer from poor coverage of the edges of
the feasible operation region. To underpin the need for improved
sampling strategies for data-driven approaches, in this paper
we point out and analyse the shortcomings of nai¨ve sampling
strategies with focus on the problem of leptocurtic distribution of
resulting interconnection power ﬂows. We refer to this problem
as convolution problem, as it can be traced back to the fact
that the probability density function of the sum of two or more
independent random variables is the convolution of their respective
probability density functions. To demonstrate the convolution
problem, we construct a series of synthetic 0.4 kV feeders,
which are characterized by an increasing number of nodes and
apply a sampling strategy to them that draws set-values for
the controllable distributed energy resources from independent
uniform distributions. By calculating the power ﬂow for each
sample in each feeder, we end up with a collapsing point cloud
of interconnection power ﬂows clearly indicating the convolution
problem.
Keywords—TSO/DSO-coordination; convolution of probability
distributions; aggregation of ﬂexibilities; feasible operation region;
hierarchical grid control.
I. INTRODUCTION
The increasing share of Distributed Energy Resources
(DERs) in the electrical energy system leads to new challenges
for both, Transmission System Operator (TSO) and Distribution
System Operator (DSO). Flexibility services for congestion
management and balancing, so far mostly provided by large
scale thermal power plants directly connected to the Transmis-
sion Grid (TG), increasingly have to be provided by DERs
connected to the Distribution Grid (DG). Thus, DGs evolve
from formerly mostly passive systems to Active Distribution
Grids (ADGs) that contain a variety of controllable components
interconnected via communication infrastructure and whose
dynamic behaviour is characterized by higher variability of
power ﬂows and greater simultaneity factors.
TSO-DSO coordination is an important topic which has been
pushed by ENTSO-E during the last years [1]–[4]. Coordination
between grid operators has to be strengthened to prevent
conﬂicting or counteracting use of ﬂexibility options [5]. To
reduce complexity for TSOs at the TSO/DSO interface and to
enable TSOs to consider the ﬂexibility potential of DGs in its
operational management and optimization processes, methods
are needed which allow for the determination and standardized
representation of the aggregated ﬂexibility potential of DGs.
The aggregated ﬂexibility potential of a DG can be described
as region in the PQ-plane that is made up from the set of feasi-
ble Interconnection Power Flows (IPFs) [6]. Thereby, feasible
IPFs are IPFs which can be realized by using the ﬂexibilities
of controllable DERs and controllable grid components such
as On-Load Tap Changer (OLTC) transformers in compliance
with grid constraints i.e., voltage limits and maximum line
currents.
In the literature, there are various concepts to determine
the Feasible Operation Region (FOR) of DGs. They can
be categorized into two main classes: Data-driven/stochastic
approaches and optimization-based approaches.
For data-driven approaches, the general procedure is such
that a set of random control scenarios is generated by assigning
set-values from a uniform distribution to each controllable
unit. By means of load ﬂow calculations, the resulting IPFs
are determined for each control scenario and classiﬁed into
feasible IPFs (no grid constraints are violated) and non-feasible
IPFs (at least one grid constraint is violated). The resulting
point cloud of feasible IPFs in the PQ-plane serves as stencil
for the FOR [6]. A problem that comes with this approach is
that drawing set-values from independent uniform distributions
leads to an unfavourable distribution of the resulting IPFs in
the PQ-plane and extreme points on the margins of the FOR
are not captured well [7].
This is where optimization-based methods come into play.
The basic idea behind these methods is not to randomly
sample IPFs but systematically identify marginal IPFs by
solving a series of Optimal Power Flow (OPF) problems [8].
In addition to better coverage of the FOR, optimization-
based approaches have the advantage of higher computational
efﬁciency. An important drawback is however that, except
31
Copyright (c) IARIA, 2021.     ISBN:  978-1-61208-855-6
ENERGY 2021 : The Eleventh International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

for approaches which solve the OPF heuristically, solving the
underlying OPF requires an explicit grid model [9]. On the
other hand, the only heuristic approach published so far, suffers
from poor automatability as it relies on manual tweaking of
hyperparameters [10].
In practice, considering the huge size of DGs, complete data
related to grid topology (data related to operating equipment
incl. its characteristics and topological connections) is not
commonly stored [11], which complicates parametrization of
explicit grid models. In such circumstances, black-box machine
learning (ML) models trained on measurement data provided
by current smart meters can be an alternative to physics-based,
explicit grid models [12]. Due to their compatibility with black-
box grid models, we argue that it is worthwhile to research
and improve data-driven approaches to determine the FOR
of DGs. This paper is intended to point out and analyse the
problem of leptocurtic distribution of IPFs with naïve sampling
strategies and thus to underpin the need for more effective and
more efﬁcient data-driven sampling strategies, such as those
published by Contreras et al. [13], when this paper was already
advanced.
The remainder of the paper is structured as follows: A survey
on existing approaches (data-driven and optimization-based)
and the contribution of this paper are given in Section II. Next,
in Section III the construction of a series of synthetic feeders
with increasing number of nodes is explained. On the basis of
these feeders, we performed our sampling experiments, whose
results are presented in Section IV. Finally, in Section V the
paper is summarized, the conclusion is given and an idea for
a distributed sampling strategy is presented which does not
suffer from unfavourable distribution of resulting IPFs.
II. SURVEY ON GRID FLEXIBILITY AGGREGATION METHODS
AND CONTRIBUTION OF THIS PAPER
As outlined in the introduction, relevant literature can be
grouped into two main categories: Data-driven/stochastic and
optimization-based approaches for exploring the FOR of DGs.
A. Data-driven approaches
Heleno et al. [7] are the ﬁrst to come up with the idea of
estimating the ﬂexibility range in each primary substation node
to inform the TSO about the technically feasible aggregated
ﬂexibility of DGs. In order to enable the TSO to perform a
cost/beneﬁt evaluation, they also include the costs associated
with adjusting the originally planned operating point of ﬂexible
resources in their algorithm. In the paper two variants of
a Monte Carlo simulation approach are presented, which
differ in the assignment of set-values to the ﬂexible resources.
While in the ﬁrst approach independent random set-values for
changing active and reactive power injection are associated
to each ﬂexible resource, in the second approach a negative
correlation of one between generation and load at the same bus
was considered. In a direct comparison of the two presented
approaches, the approach with negative correlation between
generation and load at the same bus performs better and results
in a wider ﬂexibility range and lower ﬂexibility costs with a
smaller sample size. Nevertheless, even with this approach,
the capability to ﬁnd marginal points in the FOR is limited.
Therefore, in the outlook the authors suggest the formulation of
an optimization problem in order to overcome the limitations
of the Monte Carlo simulation approach, increasing the
capability to ﬁnd extreme points of the FOR and reducing
the computational effort. In Silva et al. [8], which is discussed
in the next subsection, the authors take up this idea again.
Mayorga Gonzalez et al. [6] extend in their paper the
methodology presented by Heleno et al. [7]. First, they
describe an approach to approximate the FOR of an ADG
for a particular point in time, assuming that all inﬂuencing
factors are known. For this, they use the ﬁrst approach of
Heleno et al. [7] for sampling IPFs (the one that does not
consider correlations). That is, random control scenarios are
generated by assigning set-values from independent uniform
distributions to all controllable units. In contrast to [7], no
cost values are calculated for the resulting IPFs. Instead, for
describing the numerically computed FOR with sparse data, the
region is approximated with a polygon in the complex plane.
In addition, a probabilistic approach to assess in advance the
ﬂexibility associated to an ADG that will be available in a
future time interval under consideration of forecasts which are
subject to uncertainty is proposed. The authors mention that for
practical usage the computation time for both approaches has to
be signiﬁcantly reduced. However, the problem of unfavourable
distribution of the resulting IPF point cloud, when drawing
control scenarios from independent uniform distributions, which
is a mayor factor for the low computational efﬁciency, is not
discussed.
When this paper was already advanced, Contreras et al. [13]
came up with new sampling methods for data-driven approaches.
They show that, when focusing the vertices of the ﬂexibility
chart of ﬂexibility providing units during sampling, the quality
of the data-driven approach can be dramatically improved
in comparison to the nai¨ve sampling. On top of that, they
present a comparison of OPF-based and data-driven approaches,
whose results show that with their improved sampling strategies
both approaches are capable of assessing the FOR of radial
distribution grids. But for grids with large number of buses,
OPF-based methods are still better suited.
B. Optimization-based approaches
Silva et al. [8] address the main limitation of their sampling-
based approach in Heleno et al. [7], namely estimating extreme
points in the FOR. To this end, they propose a methodology
which is based on formulating an optimization problem with
below-mentioned objective function, whose minimization for
different ratios of α and β allows to capture the perimeter of
the ﬂexibility area.
α PDSO→TSO + β QDSO→TSO
(1)
where PDSO→TSO and QDSO→TSO are the active and re-
active power injections at the TSO-DSO boundary nodes.
Silva et al. [8] work out that the underlying optimization
32
Copyright (c) IARIA, 2021.     ISBN:  978-1-61208-855-6
ENERGY 2021 : The Eleventh International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

problem represents an OPF problem. Due to its robust char-
acteristics, they use the primal-dual, a variant of the interior
point methods to solve it. The methodology was evaluated in
simulation and validated in real ﬁeld-tests on MV distribution
networks in France. The comparison of simulation results with
the random sampling algorithm in Heleno et al. [7] shows the
superiority of the optimization-based approach by illustrating
its capability to identify a larger ﬂexibility area and to do it
within a shorter computing time.
Capitanescu [14] proposes the concept of active-reactive
power (PQ) chart, which characterizes the short-term ﬂexibility
capability of active distribution networks to provide ancillary
services to TSO. To support this concept, an AC optimal power
ﬂow-based methodology to generate PQ capability charts of
desired granularity is proposed and illustrated in a modiﬁed
34-bus distribution grid.
Contreras et al. [9] present a linear optimization model for
the aggregation of active and reactive power ﬂexibility of dis-
tribution grids at a TSO-DSO interconnection point. The power
ﬂow equations are linearized by using the Jacobian matrix of
the Newton-Raphson algorithm. The model is complemented
with non-rectangular linear representations of typical ﬂexibility
providing units, increasing the accuracy of the distribution grid
aggregation. The obtained linear programming system allows
a considerable reduction of the required computing time for
the process. At the same time, it maintains the accuracy of
the power ﬂow calculations and increases the stability of the
search algorithm while considering large grid models.
Fortenbacher et al. [15] present a method to compute reduced
and aggregated distribution grid representations that provide
an interface in the form of active and reactive power (PQ)
capability areas to improve TSO-DSO interactions. Based on a
lossless linear power ﬂow approximation, they derive polyhe-
dral sets to determine a reduced PQ operating region capturing
all voltage magnitude and branch power ﬂow constraints of the
DG. While approximation errors are reasonable, especially for
low voltage grids, computational complexity is signiﬁcantly
reduced with this method.
Sarstedt et al. [10] provide a detailed survey on stochastic
and optimization based methods for the determination of the
FOR. They come up with a comparison of different FOR
determination methods with regard to quality of results and
computation time. For their comparison, they use the Cigré
medium voltage test system. On top of that, they present a
Particle Swarm Optimization (PSO) based method for FOR
determination.
Contributions of this paper
In summary, it can be stated that optimization-based
approaches show high computational efﬁciency with good
coverage of the FOR. However, methods used for solving the
underlying OPF problem rely—except for heuristic approaches,
which have other drawbacks—on explicit grid models of the
DG, which must be parametrized with grid topology data often
not available in practice. Data-driven approaches, on the other
hand, do not require explicit grid modeling and are compatible
with black-box grid models, but suffer from low computational
efﬁciency and poor coverage of peripheral regions of the FOR,
when using conventional sampling strategies.
This is where our approach comes in. We are heading to-
wards improved sampling strategies for data-driven approaches,
which mitigate the weak points of data-driven methods (low
computational efﬁciency and poor coverage of FOR) while
retaining their advantage of being compatible with black-box
grid models. As a basis for this, in this paper we are the ﬁrst
to come up with an experiment setup by means of which the
problem of resulting convoluted distribution of IPFs with naïve
sampling strategies can be analyzed and pointed out in an
easily reproducible manner.
III. EXPERIMENT SETUP
To show the shortcomings of naïve sampling strategies,
we apply a sampling strategy that draws set-values for the
controllable DERs from indpendent uniform distributions to a
series of synthetic 0.4 kV feeders as shown in Figure 1. The
feeders are characterized by an increasing number of nodes.
To be able to consider the effect of the number of nodes on
the IPF-sample as isolated as possible, both, the total installed
power and the average transformer-node distance are chosen
equal for all feeders. The installed power is distributed equally
among all connected DERs:
P i
inst,DERj = P i
inst,DERs
N i
,
(2)
where P i
inst,DERj is the installed power of the DER connected
to the jth node ni
j of feeder i, P i
inst,DERs is the total installed
power of feeder i and N i is the number of nodes of feeder
i. Nodes are equally distributed along feeders as shown in
Figure 1 and the line length between adjacent nodes li
l of
feeder i with length li
f is:
li
l =
li
f
N i .
(3)
The transformer-node distance of node ni
j is:
di
t,nj = li
l · j.
(4)
With (4) the average transformer-node distance di
t,n of feeder
i can be written as:
di
t,n = 1
N i
N i
X
j=1
di
t,nj
= 1
N i
N i
X
j=1
li
l · j = li
l
N i
N i
X
j=1
j
= li
l
N i · N i
j · (N i
j + 1)
2
.
(5)
Resolved after the line length li
l, the result is:
li
l = di
t,n ·
2
N i + 1.
(6)
33
Copyright (c) IARIA, 2021.     ISBN:  978-1-61208-855-6
ENERGY 2021 : The Eleventh International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

(27 DERs)
feeder27
n1
1
n3
1
n3
2
n3
3
l3
l
l3
f
d3
t,n2
20/0.4 kV
IPF1
node ni
j
n9
1 ...
n9
9
DERj
n1
1 ...
n27
27
IPF3
IPF9
IPF27
(1 DER)
feeder1
(3 DERs)
feeder3
(9 DERs)
feeder9
Figure 1.
Synthetic 0.4 kV feeders
With (3) and (6) the length of feeder i results in:
li
f = di
t,n ·
2N i
N i + 1.
(7)
For our experiments, we have constructed four synthetic
0.4 kV feeders. The feeders differ in the number of nodes N i,
which has been set to 1, 3, 9 or 27, respectively. Line length
li
l and feeder length li
f have then been calculated according to
(6) and (7). There is one DER connected to each node and the
installed power P i
inst,DERs is distributed evenly among the
DERs according to (2). To be able to cover the entire ﬂexibility
area of the feeders including its border areas where voltage
band violations and/or line overloadings can be observed, all
DERs are inverter-connected battery storages because they offer
maximum ﬂexibility with regard to both, active and reactive
power provision. The dimensioning of the inverters has been
chosen in such a way that a power factor cos φ of 0.9 can be
kept, when the maximum active power is delivered:
|S|i
max,DERj =
P i
inst,DERj
cos φ
=
P i
inst,DERj
0.9
.
(8)
Active and reactive power ranges of the battery storages are
thus:
h
P i
min,DERj,P i
max,DERj
i
=
h
−P i
inst,DERj,P i
inst,DERj
i
h
Qi
min,DERj,Qi
max,DERj
i
=
h
−|S|i
max,DERj,|S|i
max,DERj
i
.
(9)
Values for the technical parameters of the four feeders including
connected DERs are listed in Table I.
For all feeders, we conduct the sampling in such a way that
for each DER and each sample element we independently draw
real and reactive power values from uniform distributions:
X i
P,DERj ∼ Ui
j
h
P i
min,DERj, P i
max,DERj
i
X i
Q,DERj ∼ Ui
j
h
Qi
min,DERj, Qi
max,DERj
i
.
(10)
300
200
100
0
100
200
QIPF (kvar)
1 DER
3 DERs
300
200
100
0
100
200
PIPF (kW)
300
200
100
0
100
200
QIPF (kvar)
9 DERs
300
200
100
0
100
200
PIPF (kW)
27 DERs
feasible
voltage band violation
line overloading
voltage band viol. & line overloading
Figure 2.
Results of naïve sampling strategy classiﬁed by feasibility
with regard to grid constraints (voltage band limits and max. line
loading); inverter constraints are neglected
After assigning active and reactive power values to each DER,
the pandapower library [16] calculates the power ﬂow. This
way we generate a sample of size 2500 for each feeder.
Following this, the sample elements are ﬁrst classiﬁed with
regard to their adherence to grid constraints and in case of non-
adherence with regard to the type of grid constraint violation
(i.e., voltage band violation, line overload, or both). Second,
inverter constraints are taken into account and the sample
elements are classiﬁed with regard to adherence to both, grid
and inverter constraints. In this case, sample elements are only
classiﬁed as feasible, if neither grid constraints nor device
constraints for any of the connected inverters occur. In case
of non-feasibility, we distinguish depending on the type of
constraint violation (i.e., grid constraint violation, inverter
constraint violation, or both).
Finally, we plot the classiﬁcation results in the domain of
active and reactive IPFs PIP F and QIP F .
IV. EXPERIMENT RESULTS
The resulting plots are shown in Figure 2 and 3. The sampling
has been performed once for each feeder from Figure 1. This
means that Figure 2 and 3 only differ in how the sample
elements are classiﬁed. While for Figure 2 only grid constraints
have been considered, Figure 3 also incorporates inverter
constraints. Both ﬁgures consist of four subplots—one for each
of the four feeders from Figure 1. Each dot of the point clouds
represents one sample element—so every subplot contains 2500
34
Copyright (c) IARIA, 2021.     ISBN:  978-1-61208-855-6
ENERGY 2021 : The Eleventh International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

TABLE I.
CONFIGURATION OF THE SYNTHETIC FEEDERS
# DERs
Pinst,DERj
(kW)
|S|max,DERj
(kVA)
Feeder Length
(m)
Line Length
(m)
Line Type
Voltage Band
(pu)
Trafo Type
1
200.0
222.2
400
400
NAYY 4x150
SE
0.9–1.1
0.4 MVA
20/0.4 kV
3
66.7
74.1
600
200
NAYY 4x150
SE
0.9–1.1
0.4 MVA
20/0.4 kV
9
22.2
24.7
720
80
NAYY 4x150
SE
0.9–1.1
0.4 MVA
20/0.4 kV
27
7.4
8.2
771
29
NAYY 4x150
SE
0.9–1.1
0.4 MVA
20/0.4 kV
300
200
100
0
100
200
QIPF (kvar)
1 DER
3 DERs
300
200
100
0
100
200
PIPF (kW)
300
200
100
0
100
200
QIPF (kvar)
9 DERs
300
200
100
0
100
200
PIPF (kW)
27 DERs
feasible
grid constraint violation
inverter constr. viol.
grid and inverter constr. viol.
Figure 3.
Results of naïve sampling strategy classiﬁed by feasibility
with regard to both, grid and inverter constraints; please note: green
dots are plotted above orange dots, i.e., no green dots are covered by
orange dots
dots. The shaded grey area marks the theoretically known
aggregated power limit for the DERs:

P i
min,DERs, P i
max,DERs

=

−P i
inst,DERs, P i
inst,DERs


Qi
min,DERs, Qi
max,DERs

=

−|S|i
max,DERs, |S|i
max,DERs

.
(11)
For the 1 DER case, shape and structure of the point cloud
look as one would expect from the conﬁguration. It largely
covers the grey area—only slightly skewed and shifted towards
lower active and reactive power values, which results from
active and reactive power consumption of grid elements (lines
and transformer). However, when increasing the number of
DERs, the convolution problem becomes obvious. With 3 DERs,
the feasible area is still covered to some extent, but the point
density already decreases strongly towards the edges. In case
of 9 DERs, the point density in the edges has decreased to
such an extent that hardly any sample elements are detected
which show grid constraint violations. Finally, with 27 DERs
the point cloud has collapsed to a fraction of the grey area and
only a small part of the theoretical FOR is covered.
From the 3 DERs subplot in Figure 2, it can be seen that
with increasing number of DERs not only the region covered by
the sample collapses, but at the same time the border between
feasible and infeasible elements (with regard to grid constraints)
becomes less distinct: The absence of a sharp border between
feasible and non-feasible IPFs complicates the use of multi-
class classiﬁcation for identifying the FOR from the sample
and indicates the use of a one-class classiﬁer for that purpose.
Figure 3, which additionally considers inverter constraints,
shows an other problem of the nai¨ve sampling approach: In this
consideration, not only the total area covered by the sample
decreases, but also the share of feasible examples shrinks
sharply, such that with 27 DERs only very few sample elements
are identiﬁed which violate neither grid nor inverter constraints.
This is because with the nai¨ve sampling approach power
values are assigned to each DER at once. After that, the power
ﬂow calculation is performed and only at the very end the
feasiblity with regard to grid and inverter constraints is checked.
Even if the constraints of only a single inverter are violated,
the example is classiﬁed as non-feasible with regard to inverter
constraints. If, for example, for a single converter one third of
the possible power setpoints violate constraints, the likelihood
to observe no constraint violations with N inverters amounts
to

1 − 1
3
N
.
For N = 27 inverters this would amount to approximately
1.76 × 10−5.
One way to address this would be to perform a successive
sampling as proposed by Bremer et al. [17] for the use case of
active power planning. With successive sampling the evaluation
of inverter constraints is done immediately after the assignment
of setpoints to single DERs and in case of non-feasibility
drawing of setpoints is repeated until a valid conﬁguration is
found. The power ﬂow calculation would then be carried out
only after setpoints compatible with inverter constraints have
been found for each DER.
To illustrate the convolution problem, in Figure 4 we plot the
frequency density of active IPFs resulting from our sampling
against the Probability Density Function (PDF) of the Bates
distribution. The Bates distribution is the continuous probability
distribution of the mean of n independent uniformly distributed
35
Copyright (c) IARIA, 2021.     ISBN:  978-1-61208-855-6
ENERGY 2021 : The Eleventh International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

300
200
100
0
100
200
PIPF (kW)
0.0000
0.0025
0.0050
0.0075
0.0100
0.0125
0.0150
0.0175
Density
1 DER
3 DERs
9 DERs
27 DERs
Figure 4.
Frequency density of active IPFs resulting from our
experiments (solid lines) compared with probability density function of
Bates distribution on the interval [−P i
inst,DERs, P i
inst,DERs] (dashed
lines)
random variables on the unit interval and thus closely related
to the Irwin-Hall distribution, which describes the sum of
n independent uniformly distributed random variables. More
general, in statistics the probability distribution of the sum of
two or more independent random variables is the convolution
of their individual distributions. For the variant of the Bates
distribution generalized to arbitrary intervals [a, b]:
X(a,b) = 1
n
n
X
k=1
Uk(a, b)
(12)
this results in the following equation deﬁning the PDF:
f(x) =

















n
X
k=0
"
(−1)k
n
k
 x − a
b − a − k
n
n−1
sgn
x − a
b − a − k
n
 #
if x ∈ [a, b]
0
otherwise.
(13)
Comparison with the Bates distribution is motivated by the
fact that with equations (2), (9) and (10) the active power range
from which we draw values during the sampling can be written
as follows:
X i
P,DERj ∼ Ui
j
"
−P i
inst,DERs
N i
,
P i
inst,DERs
N i
#
= 1
N i Ui
j

−P i
inst,DERs, P i
inst,DERs

.
(14)
For a single sample element the active IPF P i
IP F is made up of
the sum of active power injections of connected DERs P i
DERj
and the grid losses P i
loss:
P i
IP F =
Ni
X
j=1
P i
DERj + P i
loss
(15)
We are interested in the distribution X i
P,IP F of active IPFs.
Ignoring grid losses P i
loss in (15), with equations (14) and (15)
we can write:
X i
P,IP F ∼
Ni
X
j=1
1
N i Ui
j

−P i
inst,DERs, P i
inst,DERs

= 1
N i
Ni
X
j=1
Ui
j

−P i
inst,DERs, P i
inst,DERs

,
(16)
which is exactly the Bates distribution on the interval

−P i
inst,DERs, P i
inst,DERs

.
V. CONCLUSION AND FUTURE WORK
Aggregating the ﬂexibility potential of DGs is an important
prerequisite for effective TSO-DSO coordination in electric
power systems with high share of generation located in the
DG level. In this paper, we ﬁrst gave an overview of existing
ﬂexibility aggregation methods and categorized them in terms of
whether they are data-driven/stochastic or optimization-based.
Following this, we discussed the strengths and weaknesses
of both approaches (stochastic and optimization-based) and
motivated the investigation of improved sampling strategies for
data-driven approaches. As a basis for this, we presented an
experimental setup by means of which we demonstrated and
analyzed the shortcomings of nai¨ve sampling strategies with
focus on the problem of resulting leptokurtic distribution of
IPFs.
In future work we will investigate approaches for mitigating
the convolution problem. One idea is to formulate the sampling
as a distributed optimization problem whose objective function
takes into account the uniformity of the resulting set of IPFs.
First experiments in this direction with the Combinatorial Op-
timization Heuristic for Distributed Agents (COHDA) protocol
by Hinrichs et al. [18] and with Ripleys-K as metric for the
evaluation of the distribution show promising results.
Additionally, we are working on making OPF-based methods
compatible with black-box grid models by solving the under-
lying OPF with the help of evolutionary algorithms such as
the covariance matrix adaptation evolution strategy (CMA-ES)
[19] or REvol, an algorithm which was originally developed
for training artiﬁcial neural networks [20]. Furthermore, we
want to investigate if the total number of required objective
function evaluations can be reduced when sampling the border
of the FOR in one run by dynamically adapting the underlying
objective function.
ACKNOWLEDGEMENTS
This work was funded by the Deutsche Forschungsgemein-
schaft (DFG, German Research Foundation) – 359921210.
REFERENCES
[1] ENTSO-E, “General guidelines for reinforcing the cooperation between
TSO and DSO,” Tech. Rep., 2015.
[2] ——, “Towards smarter grids: Developing TSO and DSO roles and
interactions for the beneﬁt of consumers,” Position Paper, 2015.
[3] ——, “Distributed ﬂexibility and the value of TSO/DSO cooperation
– Fostering active customer participation to value their services on the
market – An ENTSO-E position,” Policy Paper, Dec. 2017.
36
Copyright (c) IARIA, 2021.     ISBN:  978-1-61208-855-6
ENERGY 2021 : The Eleventh International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

[4] ——, “TSO-DSO Report – An integrated approach to active system
management with the focus on TSO-DSO coordination in congestion
management and balancing,” Tech. Rep., 2019.
[5] M. Sarstedt et al., “Standardized evaluation of multi-level grid control
strategies for future converter-dominated electric energy systems,” at -
Automatisierungstechnik, vol. 67, no. 11, pp. 936–957, Nov. 2019.
[6] D. Mayorga Gonzalez et al., “Determination of the time-dependent
ﬂexibility of active distribution networks to control their TSO-DSO
interconnection power ﬂow,” in 2018 Power Systems Computation
Conference (PSCC).
Dublin, Ireland: IEEE, Jun. 2018, pp. 1–8.
[7] M. Heleno et al., “Estimation of the ﬂexibility range in the transmission-
distribution boundary,” in 2015 IEEE Eindhoven PowerTech. Eindhoven,
Netherlands: IEEE, Jun. 2015, pp. 1–6.
[8] J. Silva et al., “Estimating the active and reactive power ﬂexibility area at
the TSO-DSO interface,” IEEE Transactions on Power Systems, vol. 33,
no. 5, pp. 4741–4750, Sep. 2018.
[9] D. A. Contreras and K. Rudion, “Improved assessment of the ﬂexibility
range of distribution grids using linear optimization,” in 2018 Power
Systems Computation Conference (PSCC).
Dublin, Ireland: IEEE, Jun.
2018, pp. 1–7.
[10] M. Sarstedt, L. Kluß, J. Gerster, T. Meldau, and L. Hofmann, “Survey
and comparison of optimization-based aggregation methods for the deter-
mination of the ﬂexibility potentials at vertical system interconnections,”
Energies, vol. 14, no. 3, p. 687, 2021.
[11] R. Singh, E. Manitsas, B. C. Pal, and G. Strbac, “A recursive Bayesian
approach for identiﬁcation of network conﬁguration changes in distri-
bution system state estimation,” IEEE Transactions on Power Systems,
vol. 25, no. 3, pp. 1329–1336, Aug. 2010.
[12] P. Barbeiro, J. Krstulovic, F. J. Soares, H. Teixeira, and J. P. Iria,
“State estimation in distribution smart grids using autoencoders,” IEEE
8th International Power Engineering and Optimization Conference
(PEOCO2014), pp. 358–363, 2014.
[13] D. A. Contreras and K. Rudion, “Computing the feasible operating region
of active distribution networks: Comparison and validation of random
sampling and optimal power ﬂow based methods,” IET Generation,
Transmission & Distribution, vol. 2021, pp. 1–13, 2021.
[14] F. Capitanescu, “TSO–DSO interaction: Active distribution network
power chart for TSO ancillary services provision,” Electric Power Systems
Research, vol. 163, pp. 226–230, Oct. 2018.
[15] P. Fortenbacher and T. Demiray, “Reduced and aggregated distribution
grid representations approximated by polyhedral sets,” International
Journal of Electrical Power & Energy Systems, vol. 117, 2020, 105668.
[16] L. Thurner et al., “Pandapower—An open-source Python tool for
convenient modeling, analysis, and optimization of electric power
systems,” IEEE Transactions on Power Systems, vol. 33, no. 6, pp.
6510–6521, Nov. 2018.
[17] J. Bremer and M. Sonnenschein, “Sampling the search space of energy
resources for self-organized, agent-based planning of active power
provision,” in Environmental Informatics and Renewable Energies - 27th
International Conference on Informatics for Environmental Protection,
Hamburg, Sep. 2013, pp. 214–222.
[18] C. Hinrichs and M. Sonnenschein, “A distributed combinatorial optimi-
sation heuristic for the scheduling of energy resources represented by
self-interested agents,” Int. J. of Bio-Inspired Computation, vol. 10, no. 2,
pp. 69–78, Jul. 2017.
[19] N. Hansen, “The CMA Evolution Strategy: A Comparing Review,”
Towards a new evolutionary computation, pp. 75–102, 2006.
[20] E. M. Veith, B. Steinbach, and M. Ruppert, “An evolutionary training
algorithm for artiﬁcial neural networks with dynamic offspring spread
and implicit gradient information,” in The Sixth International Conference
on Emerging Network Intelligence (EMERGING 2014), Rome, Aug.
2014.
37
Copyright (c) IARIA, 2021.     ISBN:  978-1-61208-855-6
ENERGY 2021 : The Eleventh International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

