NC-OFDM Cognitive Radio Optimal Pilot Placement for the LS Estimator 
 
Boyan Soubachov 
Department of Electrical Engineering 
University of Cape Town 
Rondebosch, Cape Town, South Africa 
e-mail: boyan@crg.ee.uct.ac.za 
Neco Ventura 
Department of Electrical Engineer 
University of Cape Town 
Rondebosch, Cape Town, South Africa 
e-mail: neco@crg.ee.uct.ac.za
 
 
Abstract— A theoretical contradiction between the areas of the 
optimal pilot-pattern design and the optimal power loading 
algorithms has been found to exist for proposed Non-
Contiguous Orthogonal Frequency-Division Multiplexing (NC-
OFDM) Cognitive Radio (CR) systems. It has been found that 
the proposed, optimal pilot-patterns specify that the Secondary 
User (SU) should convert the two sub-channels adjacent to a 
Primary User (PU) to pilot sub-channels in order to ensure the 
lowest estimator Mean Squared Error (MSE) attainable. This 
algorithm has been found to contradict with the optimal power 
loading algorithm for CR systems should the Pilot-to-Data 
Power Ratio (PDPR) be greater than unity. The contradiction 
arises in that the optimal power loading algorithms for CR 
systems require that, in order for interference to the PU to be 
kept below an acceptable threshold, the sub-channels of the SU 
should have less power assigned to them the closer they are to 
the PU. In this paper, a proof of concept is demonstrated and 
evaluated such that the lowest MSE possible is achieved while 
maintaining interference threshold constraints in a simplistic 
environment. 
Keywords-Cognitive Radio; Power Loading; Pilot Patterns; 
Orthogonal Frequency Division Multiplexing. 
I. 
 INTRODUCTION 
Spectrum scarcity is an omnipresent and greatly 
impacting problem which needs to be overcome in order to 
allow new communications technologies to flourish. Due to 
the rapid pace of technological innovation, spectrum has 
become a very valuable and rare commodity. It has been 
noted that even though much of the practically usable 
spectrum has been occupied and licensed, it is only used 
anywhere from 15% to 85% of the time in a wide geographic 
and time dispersion [1]. This can be even lower in certain 
situations such as sub-urban environments where frequency 
utilisation from 100 MHz to 3 GHz can be utilised as little as 
7% of the time [2]. This means that much of the usable 
spectrum is reserved for licensed operation but is only used 
by its licensees a very small percentage of the time or its 
actual licensed use is limited to a relatively small 
geographical area. 
To address the problems of spectrum crowding, cognitive 
radio has been proposed as an attractive, viable solution [3]. 
Cognitive radio proposes to alleviate the problem of 
spectrum crowding by conducting communications in 
licensed bands during the time instances in which they are 
unused. 
It is commonly proposed that a variation of OFDM, non-
contiguous OFDM, be used to implement a CR system. This 
allows the sub-channels of an OFDM system which interfere 
with the primary user to be switched off. This means that the 
NC-OFDM system would comply with one of the principles 
of CR such that any CR-compliant communications are 
transparent to, and need not be considered by, non CR-
compliant systems. 
Much work has been done on power loading for the 
cognitive radio environment. In [4], a power loading 
algorithm was devised where the amount of interference to a 
PU was calculated for each sub-channel based on their power 
and spectral distance to the PU. It was found in [4] that a 
‘step’ profile needs to be applied where the sub-channels 
closest to the PU need to be allocated the least amount of 
power so that the interference to the PU is kept below an 
acceptable threshold. This means that the closer a sub-
channel is to a PU, the less power should be allocated to it. 
Another aspect which has been investigated is the pilot-
pattern algorithms needed for CR systems. Due to the fact 
that narrow and wideband interference from any PUs is not 
known prior to transmission, a PU could possibly take up 
one or several pilot sub-channels. This would greatly 
decrease channel interpolation accuracy due to the loss of 
one or more channel observations. It has been found that the 
optimal way to maximize channel estimation accuracy when 
one or more pilot sub-channels need to be disabled is 
converting the sub-channels adjacent to the interfering PU’s 
signal into pilot-bearing sub-channels [5]. 
If one considers these two aspects, they cannot be 
mutually ignored since it is necessary for the pilot-pattern of 
the system to adapt to changes in the utilised spectrum (such 
as intermittently appearing and disappearing PUs). This is 
because the effect on the bit-error rate (BER), and 
consequently the maximum channel capacity, is severe 
should the channel estimation accuracy (MSE) be degraded 
[8]. When also factoring the criterion for interference to the 
PU, indeed one on which the principles of CR is based, this 
would lead the implementation into placing pilots in the sub-
channels closest to the PU while reducing the power of those 
sub-channels significantly so as not to cause any interference 
to the PU. 
Another area of focus which has been noted is the pilot-
to-data power ratio. In most applications, the pilot symbols 
or sub-channels need to be allocated higher power than the 
data sub-channels so that the instantaneous channel 
5
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

estimation at the pilot symbol is as accurate as possible by 
providing a relatively high signal-to-noise ratio (SNR). This 
holds true especially for conditions where the SNR is low 
and therefore the transmitted pilot symbols are plagued by 
relatively high amounts of noise. The PDPR therefore needs 
to be increased substantially such that the channel estimation 
accuracy remains at a desirable level. 
These three aspects, namely the pilot-pattern, the power 
loading and the pilot-to-data power ratio are then seen to be 
contradictory. While the optimal pilot-patterns for CR 
systems imply that the pilot symbols or sub-channels need 
to be placed adjacent to the PU, the optimal power loading 
algorithms state that the sub-channels need to have their 
assigned power levels reduced such that they do not 
interfere with the PU but the principles of OFDM and PDPR 
research states that the pilot sub-channels should usually be 
assigned more power in order to achieve as high as possible 
channel estimation accuracy. 
These contradictions can then be modelled and solved by 
expressing them in the form of a constrained optimisation 
problem. In this paper, an optimal solution is derived for the 
case of a least squares (LS) estimator using linear 
interpolation. The research demonstrated in this paper is a 
continuation from [11], where an LS-based approach is 
investigated due to its practicality in terms of low-
complexity estimators. 
This paper is organised as follows. Section II describes 
the system model used and Section III derives and explains 
the optimal solution to the outlined problem. In Section IV, 
the simulation parameters are given as well as results of the 
simulations themselves. The results are discussed in this 
section and a conclusion is derived from the findings. This 
is elaborated upon in Section V. 
II. 
SYSTEM MODEL 
The CR system model considered is that of having a 
contiguous OFDM system interrupted by a PU of a fixed 
bandwidth, this means that the sub-channels of the SU 
which conflict with the PU’s used frequency band are 
disabled by the SU. This allows the spectrum to be fully 
utilised in that there are no guard bands between the PU’s 
and the SU’s signal. 
The CR system is then seen as an OFDM system of N 
sub-channels with certain sub-channels dedicated to 
transmitting pilot symbols meaning that, for simplicity, 1-
dimensional channel estimation is used to obtain the 
instantaneous channel gains. 
As prescribed in [6], the interference in the system is 
differentiated into PU-to-SU and SU-to-PU interference. 
A. Power Density Spectrum of Signals 
The transmitted signals in the system model are assumed, 
for the sake of simplicity, to be shaped by a rectangular pulse 
shaping function. The power density spectrum of the 
rectangular pulse shaping function can be represented as [4]
 
) 2
sin(
( )











s
s
s
i
i
T
f
T
f
PT
f



. 
(1) 
In (1), Pi represents the transmit power of the ith sub-carrier 
and Ts represents the symbol duration of that same sub-
carrier. It should be noted that this equation is only 
applicable for a rectangular pulse-shaping function. 
Equations for other pulse-shaping functions can be used as 
well but the problem will remain unchanged since every 
pulse-shaping function will have some form of spectral roll-
off (leakage), and therefore, present interference to non-
orthogonal frequencies. 
B. Interference from PU to SU 
The signals between the PU and the SU are assumed to be 
non-orthogonal, and therefore, the interference imposed by 
the PU on the SU is effectively ‘smeared’ due to the Fast 
Fourier Transform (FFT) processing performed by the SU 
[6]. The expected value of the power density spectrum of 
the PU’s signal after an FFT of size M is performed can be 
described as [6] 
 











d
M
e
M
I
E
j
PU
M










2
/) 2
sin(
/ 2
)
) sin(
(
2
1
( )}
{
,(2) 
where   represents the angular frequency which has been 
normalised to the sampling frequency, M is the number of 
samples (FFT size in this case) and 
)
(


j
PU e
 represents 
the power density spectrum of the PU’s pulse-shaping filter. 
The interference from the PU to the SU can then be 
described as the integral of the expected value of the power 
spectral 
density, 
which 
may 
be 
expressed 
as  
 





2
/
/ 2
( )}
{
)
,
(
f
d
f
d
M
i
i
PU
i
i
d
E I
d P
I


. 
(3) 
In (3), 
id  represents the spectral distance between the 
considered sub-carrier and the PU, and f

 represents the 
width of one sub-channel of the SU (equivalent to the 
inverse of the OFDM symbol duration). 
C. Interference from SU to PU 
The interference from the secondary user to the primary 
user is modelled using simpler mathematics due to the 
assumption that we do not have any information about the 
PU’s modulation scheme and other transmission properties, 
only the bandwidth and signal power. The interference 
caused by spectral roll-off from the SU can then be simply 
modelled as the integration of the power density spectrum of 
the signal, represented as (1) for the rectangular pulse 
shaping filter case. The interference from the SU can be 
modelled as [4]  
 
.
( )
)
,
(
2
/
/ 2




B
d
B
d
i
i
i
SU
i
i
f df
d P
I

 
(4) 
6
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

It should be noted that B denotes the bandwidth occupied by 
the PU’s signal such that the integration is performed over 
the PU’s bandwidth with an added frequency ‘offset’ 
introduced by the spectral distance between the considered 
sub-channel and the PU’s signal. 
D. Channel Model 
The multipath channel model used can be described as [7] 
 






1
0
)
(
)
(
L
l
l
l
n
h n



, 
(5) 
in the time domain where 
l
  and 
l  are the complex gain 
and delay for the lth path of a multipath propagation channel 
with a total of L resolvable paths. To model the channel in 
the frequency domain, the discrete Fourier transform (DFT) 
is applied to the time domain response in (5), resulting in 
 








 


1
0
2
exp
)
(
L
l
fft
l
l
N
i
j
H i


. 
(6) 
In (6), i and 
N fft
 represent the sub-channel index and the 
size of the DFT respectively.  
The probability distribution functions of the parameters 
l
  and 
l  may vary for different types of channels. In this 
case, they are assumed to be Rayleigh distributed such that a 
Rayleigh fading channel is simulated. The channel fading 
model is also used per OFDM symbol and a new frequency-
selective channel frequency response is calculated for each 
OFDM symbol. This allows the simulation of a worst-case, 
fast-fading channel where there is no correlation between 
one OFDM symbol and the next. As such, the coherence 
time of the channel compared to the OFDM frame is 1 
OFDM symbol.  
E. 
Pilot error 
The pilot error for the least squares estimator can be 
effectively modelled as dependent on the noise to pilot 
power 
ratio 
for 
pilot 
symbols, 
namely 
[7] 
  
p
p
p
P n
H
H
1
ˆ



, 
(7) 
therefore the error can simply be represented as 
  
p
p
p
p
P n
H
H
1
ˆ





. 
(8) 
where H  represents the vector form of the channel 
frequency response as derived in (6) and 
p
H  is the vector 
subset of H  at the pilot positions such that 
p  i
. 
F. 
Linear interpolation error bound 
The instantaneous channel gain at the data sub-channels 
needs to be interpolated in either the time or frequency 
direction. Since, for simplicity, it was assumed that sub-
channels were dedicated for pilot symbols, the interpolation 
was therefore done only in the frequency dimension. As the 
interpolation error cannot be known exactly unless the full 
channel frequency response is also known (which renders 
the need for interpolation moot), an error bound is used such 
that a worst-case interpolation error is used. 
The interpolation error bound for a linear interpolator is 
dependent on the second derivative of the function being 
interpolated and the distance between the two interpolation 
points, thus, the more a function varies on a given interval, 
the higher the linear interpolation error will be. The linear 
interpolation error bound can be described as [10] 
  
2
2
2
int
( )
max
8
i
H i
di





. 
(9) 
G. Optimal power loading 
The optimal power loading algorithm is specified in [4]. 
It is important to note that the same power loading 
algorithm is derived at the boundary level where the 
interference to the PU is equal to the interference threshold 
parameter such that transmission power is maximized and, 
consequently, so is channel capacity. This also then allows 
us to effectively ignore the interference to the PU when 
placing the pilot as the power we may use at each sub-
channel index complies with the optimal power loading 
requirements. 
The interference equation at the threshold was therefore 
used 
such 
that 
the 
equation 
is 
formulated 
as 
  
2
2
*
)
(
1
i
H
I
P
I
P
PU
i
SU
i








 
(10) 
where λ is the Lagrangian multiplier used to find the 
optimal power level for each sub-channel. 
 
iP
0i
Li
i
d
 
Figure 1. Pilot and data sub-channels for an NC-OFDM, CR system 
involving one PU and one SU. The pilots concerned for optimal placement 
is shaded on one diagonal. 
III. 
OPTIMAL SOLUTION 
In order to derive an optimal solution, the problem is 
7
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

formulated such that the estimation error between the 
concerned sub-channels, namely 
Li
i
i

0 
, is minimized. 
The constrained optimization problem is therefore modelled 
as  
  
int
min





p
i
 
(12) 
where  
  
*
2
)
(
i
PU
p
P
i
 I





p
P 1n
 
(13) 
and  
  
 
 








 







1
0
2
2
2
2
2
2
2
int
2
exp
4
max
8
)
(
( )
max
8
L
l
fft
l
l
fft
l
L
i
N
i
j
N
i
i
i
H i
d





 
 
(14)  
 
subject to, 
 
i  Li
, 
 
(15) 
 and 
iP  0
, 
 
(16) 
where 
Li
i

,1,0
 
. 
In the context of the optimisation problem, 
Li  is used to 
represent the upper limit (i.e. adjacent to the nearest, 
original pilot sub-channel) of the possible pilot sub-channel 
placement position and 
0i  represents the lower limit (i.e. 
adjacent to the PU). 
The interpolation error only considers the decrease in 
error as the pilot sub-channel approaches the PU since it is 
specified in [5] that a new pilot sub-channel is created 
instead of shifting an existing one and therefore MSE can 
only be decreased, assuming that the power allocated to the 
already existing pilot symbols remains the same.  
The derivative of the optimal power loading function in 
(10) was found to be a transcendental function and therefore 
the error function cannot be optimised using traditional, 
algebraic methods such as the Karush-Kuhn-Tucker (KKT) 
conditions and as such the solution may only be computed 
numerically. 
The 
optimal 
was 
therefore 
computed 
numerically by searching for the value of i  where the error 
function is lowest. 
In practice, the value of 
Li  may not be bigger than the 
pilot spacing and therefore the optimisation problem only 
considers the sub-channels between the PU and the nearest 
pilot sub-channel (before insertion of the extra pilot sub-
channel). 
The provided solution is for a single side of the PU, this 
can be identically applied to the other side of the PU’s 
transmission power remains uniform throughout the PU’s 
bandwidth. 
IV. 
SIMULATION PARAMETERS AND RESULTS 
A simulation was conducted by setting up an NC-OFDM 
system with parameters as listed in Table I. 
The simulation was run using a Monte Carlo method with 
10000 sample runs such that a statistically significant result 
was obtained and the results were noted. This allows for 
most noise factors to be factored out (specifically from 
AWGN) and an averaged result to be obtained.  
It was found that one of the most significant factors 
contributing to the error function’s variance was the 
interference threshold parameter as specified in the 
simulation. This meant that the interference threshold 
parameter is critical in determining the performance of the 
channel estimator and the optimal placement of the new 
pilot sub-channel. 
This problem was found to be exacerbated for a least 
squares estimator due to the estimation error at the pilot 
symbols being only a product of the inverse of the sub-
channel SNR. Since the LS estimator, unlike the Minimum 
Mean Squared Error (MMSE) estimator, is not dependent 
on the knowledge of noise statistics, therefore the optimal 
positioning for the LS estimator, without considering 
interpolation error, would indeed be where the SNR is 
highest.  
 
TABLE I 
SYSTEM SIMULATION PARAMETERS 
Parameter 
 
Value 
PU bandwidth 
 
768 kHz 
Channel path gain means (dB) 
 
[0 -15 -20] 
Path delay time means (µs) 
 
[0 0.4 0.9] 
OFDM symbol length 
 
333.3 µs 
SU sub-channel bandwidth 
 
3 kHz 
FFT size 
 
1024 
Pilot spacing (frequency, time) 
 
(12,12) 
Maximum Doppler shift 
 
24 Hz 
PU signal power 
 
20 dBm 
Noise floor 
 
-90 dBm 
Interference thresholds (mW) 
 
[1, 3, 5, 7, 9, 10] 
 
8
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

0
5
10
15
20
25
30
35
10
-3
10
-2
10
-1
Distance from PU (# of sub-channels, 1= adjacent)
Error Function Value
 
 
1 mW
3 mW
5 mW
7 mW
9 mW
10 mW
 
 
Figure 2. Error function values of the simulated system for parameters 
as set in table 1. Each curve represents the error function for a different 
threshold value where the lowest point of the curve is the optimal 
placement position for the pilot sub-channel. 
 
In Figure 2, the error function is shown for the applied 
simulation parameters of table 1. The curves shown indicate 
the interference threshold power, this parameter is pre-set to 
define what the maximum amount of interference power 
may be transmitted to the PU by the SU. The first curve 
(squares) therefore shows the highest error function value 
but with a trade-off in that the interference threshold is as 
low as 1 mW. This also means that the pilot is indeed placed 
the farthest for the highest interference threshold (at 18 sub-
channels away). The opposite can be observed for a high 
interference threshold, placing the new pilot sub-channel as 
close as 7 sub-channels away from the PU. An abrupt 
change is noticed for the error function values at sub-
channel distance of 19, this is attributed to the fact that the 
distance component in the interpolation error begins to 
dominate the 2nd order derivative of the channel gain 
component. This is unlike what is noticed in Figure 3 where 
due to the rapidly varying channel gains, the effects are not 
noticed as abruptly. 
In Figure 3, the error function is shown for the same 
simulation parameters as Figure 2 with the exception that a 
fast fading channel was used. This results in a decreased 
channel coherence bandwidth and as such makes the 
channel frequency response represent a more variant 
function. This in turn increases the error contribution of the 
interpolation error to the optimization error function. 
It can be seen that the optimal pilot position has therefore 
moved closer to the PU (such as being placed as low as 5 
sub-channels away for a 10 mW interference threshold). 
 
0
5
10
15
20
25
30
35
10
-3
10
-2
10
-1
Distance from PU (# of sub-channels, 1= adjacent)
Error Function Value
 
 
1 mW
3 mW
5 mW
7 mW
9 mW
10 mW
 
 
Figure 3. Error function values of the simulated system for parameters 
as set in table 1 but using a fast fading channel instead. Each curve 
represents the error function for a different threshold value where the 
lowest point of the curve is the optimal placement position for the new pilot 
sub-channel. 
 
In Figure 4, the optimal pilot placement is shown for the 
given interference threshold parameters for both the fast 
fading and slow fading channel cases. 
1
2
3
4
5
6
7
8
9
10
4
6
8
10
12
14
16
18
20
Interference Threshold (mW)
Optimal Pilot Distance (# of sub-channels from PU)
 
 
Fast fading
Slow fading
 
 
Figure 4. Optimal pilot placement (expressed as the separation distance 
between the pilot and the PU in number of sub-channels) for the fast-fading 
and slow fading channels. 
V. 
CONCLUSION 
A hypothesis of contradiction was noted between the 
optimal power loading and the optimal pilot-pattern 
algorithms for NC-OFDM cognitive radio systems. This 
meant that a compromise needed to be found such that the 
two contradictory ideas are implemented in the optimal way 
possible. An optimal solution for the simplified case was 
proposed in this paper as a proof of concept. 
It was found that the interference threshold parameter 
greatly influences the pilot placement and hence the 
9
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

estimation error. This means that there is a trade-off where 
the desired interference threshold from the SU inversely 
affects the estimation error.  
It was also discovered that a great dependency exists 
between the error function and the form of the channel 
frequency response. This was noted from the fact that the 
more variant the channel frequency response is (i.e. the less 
linear it is), the closer the new pilot sub-channels should be 
placed to the PU due to the greater interpolation error 
caused by having them move away. 
ACKNOWLEDGMENT 
The authors would like to thank Telkom SA, the National 
Research Foundation (NRF), Technology and Human 
Resources for Industry Programme (THRIP), the Department 
of Trade and Industry (DTI), Nokia Siemens Networks, 
TeleSciences and the University of Cape Town for 
supporting this research project. 
REFERENCES 
[1] I. F. Akyildiz, W. Lee, M. C. Vuran and S. Mohanty, "NeXt 
generation/dynamic spectrum access/cognitive radio wireless 
networks: A survey,"  Computer Networks, vol. 50, pp. 2127-
2159, 9/15, 2006 [Nov 12, 2011].  
[2] V. Valenta, Z. Fedra, R. Marsalek, G. Baudoin and M. 
Villegas, "Towards cognitive radio networks: Spectrum 
utilization measurements in suburb environment," in Radio 
and Wireless Symposium, 2009. RWS '09. IEEE, 2009, pp. 
352-355 [Nov 12, 2011]. 
[3] J. Mitola III and G. Q. Maguire  Jr., "Cognitive radio: making 
software radios more personal,"  Personal Communications, 
IEEE, vol. 6, pp. 13-18, 1999 [Nov 12, 2011].  
[4] G. Bansal, M. J. Hossain and V. K. Bhargava, "Adaptive 
power loading for OFDM-based cognitive radio systems," in 
Communications, 2007. ICC '07. IEEE International 
Conference on, 2007, pp. 5137-5142 [Dec 4, 2011].  
[5] I. Rashad, I. Budiarjo and H. Nikookar, "Efficient pilot 
pattern for OFDM-based cognitive radio channel estimation - 
part 1," in Communications and Vehicular Technology in the 
Benelux, 2007 14th IEEE Symposium on, 2007, pp. 1-5 [Dec 
4, 2011]. 
[6] T. Weiss, J. Hillenbrand, A. Krohn and F. K. Jondral, "Mutual 
interference in OFDM-based spectrum pooling systems," in 
Vehicular Technology Conference, 2004. VTC 2004-Spring. 
2004 IEEE 59th, 2004, pp. 1873-1877 Vol.4 [Dec 4, 2011]. 
[7] Shichang Zhang, Jun Wang and Shaoqian Li, "A channel 
estimation method for NC-OFDM systems in cognitive radio 
context," in Communication Systems, 2008. ICCS 2008. 11th 
IEEE Singapore International Conference on, 2008, pp. 208-
212 [Dec 4, 2011]. 
[8] Chia-Horng 
Liu, 
"Adaptive 
two-dimensional 
channel 
estimation scheme for OFDM systems," in Cognitive Radio 
Oriented Wireless Networks and Communications, 2008. 
CrownCom 2008. 3rd International Conference on, 2008, pp. 
1-5 [Dec 4, 2011]. 
[9] IEEE 802.16 Broadband Wireless Access Working Group. 
(2003-06-27, Channel models for fixed wireless applications). 
[10]  S. D. Conte and C. de Boor, "Interpolation by polynomials," 
in Elementary Numerical Analysis, an Algorithmic Approach, 
3rd ed. McGraw-Hill, 1980 [Nov 12, 2011]. 
[11] B. Soubachov, N. Ventura, “Optimal Pilot Placement in 
Cognitive Radio Systems for Wiener Filtered MMSE Channel 
Estimation”, in The First International Conference on 
Advances in Cognitive Radio, 2011. IARIA COCORA 2011, 
pp 54-59 [Dec 8, 2011]. 
 
10
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

