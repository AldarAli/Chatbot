On the Robustness of Quantum Key Distribution with Classical Alice
(photons-based protocol)
Michel Boyer
D´epartement IRO
Universit´e de Montr´eal, Canada
Email: boyer@iro.umontreal.ca
Tal Mor
Computer Science Department
Technion, Israel
Email: talmo@cs.technion.ac.il
Abstract—Quantum Key Distribution (QKD) with clas-
sical Bob, has been suggested and proven robust. Following
this work, QKD with classical Alice was also suggested and
proven robust. The above protocols are ideal in the sense
that they make use of qubits. However, in the past, well-
known QKD protocols that were proven robust and even
proven unconditionally secure, when qubits are used, were
found to be totally insecure when photons are used. This
is due to sensitivity to photon losses (e.g., Bennett’s two-
state protocol) or sensitivity to losses combined with multi-
photon states (e.g., the photon-number-splitting attack on
the weak-pulse Bennett-Brassard protocol, BB84). Here,
we prove that QKD with classical Alice is still robust when
photon losses and even multi-photon states are taken into
account. Our method can pave the road to robustness and
security analysis of various other two-way QKD protocols.
Index Terms—Cryptography; Quantum Mechanics.
I. INTRODUCTION
A two-way Quantum Key Distribution (QKD) protocol
in which one of the parties (Bob) uses only classical
operations was recently introduced [1,2]. A very inter-
esting extension in which the originator always sends
the same state |+⟩ = (|0⟩+|1⟩)/
√
2 (where 0 and 1 are
used to denote bits, to avoid confusion with the integers
0 and 1 used as occupancy numbers) while in [1] all
four states, |0⟩, |1⟩, |+⟩ and |−⟩ = (|0⟩ − |1⟩)/
√
2, are
sent, is suggested by Zou et al. [3]. In both “semi-
quantum” key distribution (SQKD) protocols the qubits
go from the originator Alice to (classical) Bob and back
to Alice. Bob randomly either reﬂects a received qubit
without touching its state (those are deemed CTRL bits),
or measures it in the standard (classical) basis and sends
back his result as |0⟩ or |1⟩ (those are deemed SIFT
bits). These two operations, “doing nothing” or measure-
resend in the standard (computation) basis, are called
classical [1,2] for obvious reasons; in principle, semi-
quantum protocols might be simpler to implement than
fully quantum ones.
Following [4], we prefer to call the originator in [3]
Bob (and not Alice), and to call the classical party Alice:
usually in quantum cryptography, Alice is the sender
of some non-trivial data, e.g., she is the one choosing
the quantum states. The originator in [3] does not have
that special role, as the state |+⟩ is always sent (and we
could even ask Eve to generate it). The classical person
is then the one actually choosing a basis and knowing
which of the three state (|0⟩, |1⟩, or |+⟩) is sent back
to the originator, thus it is natural to name that classical
person Alice. We call the originator Bob, and we call the
SQKD protocol of Zou et al “QKD with classical Alice”.
Note that QKD with classical Alice was also suggested,
independently of [3], by Lu and Cai [5]. As proven in [4],
QKD with Classical Alice (the protocol suggested in [3])
is completely robust against eavesdropping.
Here, we use Fock-space representation to extend the
QKD with classical Alice protocol to the important case
in which Alice and Bob use photons and not merely
ideal qubits. We ﬁrst extend the proof of robustness
to include photon loss, and subsequently, also multi-
photon states. To the best of our knowledge, such a
general analysis has not yet been provided for any of
the (many) two-way QKD protocols, including ping-
pong protocols and (experimental and commerical) plug
and play protocols, hence our approach and method may
have major inﬂuence on future robustness and security
analysis of QKD. A related (photonic) security analysis
was recently done for a different two-way QKD protocol,
see Section 4.2 in [6].
Such extensions from qubits to photons are far from
trivial; on the contrary, often, robustness is actually lost
when trying to deal with photons rather than qubits.
29
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-431-2
ICQNM 2015 : The Ninth International Conference on Quantum, Nano/Bio, and Micro Technologies

As a ﬁrst example, in the two-state scheme (known
as the Bennett’92 — B92 scheme), when qubits are
assumed to be carried by photons, photon losses cause
a severe problem: if Eve can replace a lossy channel by
a lossless one, she might be able to get full information
without causing errors at all, using an “un-ambiguous
state discrimination” attack. As a second example, in the
four-state scheme (known as the Bennett-Brassard’84 —
BB84 scheme), when qubits are assumed to be carried
by photons, photon losses combined with multi-photon
pulses cause a severe problem: if Eve can replace a
lossy channel by a lossless one, and can measure photon
numbers (via a non-demolition measurement), she might
be able to get full information without causing errors at
all [7], using a “photon number splitting” attack.
II. THE FOCK SPACE NOTATIONS
The Fock space notations that serve as an extension of
a qubit are as follows: in the standard (z) basis, the Fock
basis vector |0,1⟩ stands for a single photon in a qubit-
state |0⟩ and the Fock basis vector |1,0⟩ stands for a sin-
gle photon in a qubit-state |1⟩. Naturally, the Hadamard
(x) basis qubit-states are given by the superposition of
those Fock states so that [|0,1⟩± |1,0⟩]/
√
2 stand for a
single photon in a qubit-state |±⟩ = (|0⟩±|1⟩)/
√
2. The
general state of this photonic qubit can then be written
as α |0,1⟩+β |1,0⟩, with |α|2 +|β|2 = 1.
This photonic qubit lies in a much larger space called
Fock space. The ﬁrst natural extension is |0,0⟩ that
describes the lack of photons (the vacuum state), a
case of great practical importance, as it enables dealing
properly with photon loss. The next extension of a very
high practical importance is that |2,0⟩ describes two
(indistinguishable) photons in the same qubit-state |1⟩,
|0,2⟩ describes two (indistinguishable) photons in the
same qubit-state |0⟩, and |1,1⟩ describes two (in this
case, distinguishable) photons, one in the qubit-state
|0⟩, and one in the qubit-state |1⟩. This case (a six
dimensional space, describing two or less photons) was
found very important in the photon number splitting
attack [7], as prior to that analysis, experimentalists
assumed that the only impact of high loss rate is on
the bit-rate and not on security.
In general, if a single photon can be found in two
orthogonal states (these are called “modes” when dis-
cussing photons), then |n1,n0⟩ represents n1 (respec-
tively n0) indistinguishable photons in a qubit-state |1⟩
(resp. |0⟩). The numbers n0 and n1 are then called the
occupation numbers of the two modes. From now on,
the notations |0⟩ ≡ |0,1⟩, |1⟩ ≡ |1,0⟩, |+⟩ = (|0,1⟩ +
|1,0⟩)/
√
2 and |−⟩ = (|0,1⟩ − |1,0⟩)/
√
2 will be used
interchangeably. Similarly, since the single photon can
also be found in |0,1⟩x ≡ |+⟩ and |1,0⟩x ≡ |−⟩ (namely,
the x basis), then |n−,n+⟩ represents n− (resp. n+)
indistinguishable photons in qubit-state |−⟩ (resp. |+⟩).
More generally, one may consider more than two
modes. For instance, the four modes |n1b,n1a,n0b,n0a⟩
are the generalization of qu-quadrit (say a photon in
one of two arms a or b, and one of two orthogonal
polarizations, denoted 0 or 1).
III. THE CLASSICAL ALICE PROTOCOL, DEALING
WITH LOSSES
The originator Bob sends Alice qubits in the state |+⟩
and keeps in a quantum memory all qubits he received
back from her. If Bob does not hold a memory to
keep the qubits, he measures them upon reception at
random in the standard (z) or the Hadamard (x) basis.
Only CTRL bits measured in the x basis, and SIFT
bits measured in the z basis, are used. That does not
modify the conceptual proof (but in a security proof
it would mean that they need to send more qubits to
start with). When N qubits have been sent and received,
(classical) Alice announces publicly which qubits she
reﬂected (without disturbing them); the originator Bob
then checks that he received |+⟩ and not |−⟩ on those
positions (CTRL). For the (SIFT) qubits measured by
Alice in the standard (classical) {|0⟩;|1⟩} basis, a sample
is chosen to be checked for errors (TEST). The remain-
ing SIFT bits serve for obtaining a ﬁnal, secure key,
via error correction and privacy ampliﬁcation, as in any
conventional QKD protocol.
A. Deﬁning the (limited) “photonic QKD with classical
Alice” protocol
The qubits are embedded in the 3-dimensional, 2-
mode Fock space containing the qubit states |1,0⟩ and
|0,1⟩ and the vacuum state |0,0⟩. The Hilbert space
describing Alice+Bob states is (for now) the subspace
HAB = Span

is described (WLG) with the adjunction of a probe,
extending HAB to HA ⊗ HAB, a unitary transformation
and a measurement of her probe in the standard basis.
Such a description is meant to match the general frame-
work of measurements in quantum information, and
may not correspond to the actual physical measurement
performed by Alice. Using the Fock-space notations, it
is assumed that Alice adds a two-mode probe in a state
|0,0⟩A to get the state |0,0⟩A |+⟩AB. Alice then performs
one of the following two operations (with |n1,n0⟩AB in
the z, i.e., the standard basis):
UCTRL |0,0⟩A |n1,n0⟩AB = |0,0⟩A |n1,n0⟩AB
(2)
USIFT |0,0⟩A |n1,n0⟩AB = |n1,n0⟩A |n1,n0⟩AB
(3)
then she measures her probe in the standard classical
basis and sends Alice+Bob’s state to Bob; in the case
described by (2) (CTRL) she needs not measure, still the
probe and its measurement are added there only to make
the description uniform; Bob’s original state (|+⟩AB) is
reﬂected back to him, undisturbed. In the case described
by (3) (SIFT), Alice gets the outcome n1n0, and the state
|n1,n0⟩AB is sent to Bob. Note that, in order to analyze
the enlarged space of the protocol, we had to add the def-
inition of Alice’s operation on the added state, |0,0⟩AB.
Our choice of USIFT |0,0⟩A |0,0⟩AB = |0,0⟩A |0,0⟩AB is
the most natural way of extending Alice’s SIFT oper-
ation, and it thus becomes part of our deﬁnition of the
protocol “Photonic-QKD with classical Alice”.
Naturally, when Bob measures in the classical (z)
basis, he also measures the same three states as Alice,
|n1,n0⟩ with n0 +n1 ≤ 1. However, the space HAB (1) is
also spanned by the orthonormal basis {|+⟩, |−⟩, |0,0⟩},
thus Bob (who is not limited to being classical) can
perform a measurement in this generalized x basis of
the qutrit.
B. Eve’s attack on the (photonic) classical Alice protocol
Eve performs her attack in both directions; from Bob
to Alice, Eve applies U; from Alice to Bob, Eve applies
V. We may assume, WLG, that Eve is using a ﬁxed
probe space HE for her attacks in both directions. The
attack from Bob to Alice produces a state of the form
|E01⟩|0,1⟩AB + |E10⟩|1,0⟩AB + |E00⟩|0,0⟩AB
(namely
∑n1,n0 | n0+n1≤1 |En1n0⟩|n1,n0⟩AB ∈ HE ⊗ HAB), where
the |Eij⟩ are non normalized (and potentially non-
orthogonal) vectors in HE. With Alice’s probe attached
we obtain
|Ψ⟩ =
∑
n1,n0 | n0+n1≤1
|En1n0⟩|0,0⟩A |n1,n0⟩AB ,
(4)
in HE ⊗ HA ⊗ HAB. In particular, if Eve does noth-
ing then |E10⟩ = |E01⟩ = |E00⟩ ≡ |E⟩ and the state
in Alice+Eve’s hands, prior to Alice’s operation, is
|E⟩|0,0⟩A |+⟩AB .
Going back to the general case, if Alice applies UCTRL,
then the state in Eve+Alice hands (after Alice’s CTRL
action) is still |Ψ⟩. However, if Alice applies USIFT, the
resulting global state in Eve+Alice’s hands is
∑
n1,n0 | n0+n1≤1
|En1n0⟩|n1,n0⟩A |n1,n0⟩AB
(5)
and after Alice has measured her probe, she gets some
output ({00,01,10}), and some (non normalized) resid-
ual state that she sends back to Bob.
Once Alice has performed her measurements and sent
|i, j⟩AB back to Bob via Eve, the resulting global state
(fully in Eve’s hands) is given by Table I, where the |ψij⟩
TABLE I
GLOBAL STATE AFTER ALICE’S MEASUREMENT
Measurement
State (non normalized)
00
|ψ00⟩ = |E00⟩|0,0⟩AB
01
|ψ01⟩ = |E01⟩|0,1⟩AB
10
|ψ10⟩ = |E10⟩|1,0⟩AB
CTRL
|ψ⟩ = |ψ00⟩+ |ψ01⟩+ |ψ10⟩
are not normalized, and where the |Eij⟩ were chosen by
Eve. Eve now applies a unitary V on HE ⊗ HAB and
then sends Bob his part of the resulting state.
C. A proof of robustness
For Eve to stay undetectable, if Alice measured |0,0⟩
(namely, the outcome 00) in the SIFT mode, then Bob
should have a probability zero of measuring 01 or 10,
thus, a probability zero of receiving the states |0,1⟩ or
|1,0⟩. Similarly if Alice measured 10 (01), then Bob
should have a probability zero of measuring 01 (10);
he could however get a loss, 00. The resulting (non
normalized) Eve+Bob residual states thus take the form
|ψ′
00⟩ = V |ψ00⟩ = |H00⟩|0,0⟩AB when a loss arrives, and
otherwise,
|ψ′
01⟩ = V |ψ01⟩ = |F01⟩|0,1⟩AB + |H01⟩|0,0⟩AB
(6)
|ψ′
10⟩ = V |ψ10⟩ = |F10⟩|1,0⟩AB + |H10⟩|0,0⟩AB .
(7)
Finally, V being linear, the (normalized) residual state if
Alice applied CTRL is |ψ′⟩ ≡ V |ψ⟩ = |ψ′
00⟩ + |ψ′
01⟩ +
|ψ′
10⟩.
In order to check CTRL bits, Bob measures |ψ′⟩ in the
x basis and checks if he gets a photon in the illicit state
31
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-431-2
ICQNM 2015 : The Ninth International Conference on Quantum, Nano/Bio, and Micro Technologies

|−⟩. To avoid that, Eve must make sure that the overlap
between Eve-Bob’s state |ψ′⟩ and Bob’s state |−⟩ is
zero. This results with another limitation on Eve’s attack:
the norm of AB⟨−

suggested in [8] as an attack against QKD with classical
Bob ( [1]); see also [9].
B. Eve’s attack on the (photonic) classical Alice protocol
Eve performs her attack in both directions using a
ﬁxed probe space HE; from Bob to Alice, Eve ap-
plies U; from Alice to Bob, Eve applies V. The at-
tack from Bob to Alice produces a state of the form
∑ |En1n0⟩|n1,n0⟩AB ∈ HE ⊗HAB where HAB = F. With
Alice’s probe attached we obtain
|Ψ⟩ = ∑ |En1n0⟩|0,0⟩A |n1,n0⟩ ,
(11)
in HE ⊗ HA ⊗ HAB. In particular, if Eve does nothing
then |En1n0⟩ ≡ |E⟩ independently of n1 and n0, and the
state in Alice+Eve’s hands, prior to Alice’s operation, is
|E⟩|0,0⟩A |+⟩AB .
Going back to the general case, if Alice applies UCTRL,
then the state in Eve+Alice hands (after Alice’s CTRL
action) is still |Ψ⟩. However, if Alice applies USIFT, the
resulting global state in Eve+Alice’s hands is
∑ |En1n0⟩|ˆn1, ˆn0⟩A |n1,n0⟩AB ;
(12)
after Alice has measured her probe she gets some output
({00,01,10,11}), and some complicated (non normal-
ized) residual state (sent then back to Bob) that we soon
analyze.
Eve now attacks that residual state on the way back
from Alice to Bob using the unitary V acting on both
her probe and the state sent by Alice to Bob (see below).
Eve then sends Bob his part of the resulting state.
C. A proof of robustness
Alice’s measuring abilities put a constraint on the state
|Ψ⟩ for Eve not to be detectable: Alice’s probability
of measuring |1,1⟩A according to that model must be
zero, or else Eve can be noticed. It is thus required that
|En1n0⟩ = 0 for n1 ×n0 ̸= 0. Therefore, Eve+Alice’s state
when Alice applies USIFT must take the form
∑
n0≥1
|E0n0⟩|0,1⟩A |0,n0⟩+ ∑
n1≥1
|En10⟩|1,0⟩A |n1,0⟩
(13)
+ |E00⟩|00⟩A |0,0⟩ .
(14)
Once Alice has performed her measurements and sent
|i, j⟩AB back to Bob via Eve, the resulting global state
(fully in Eve’s hands) is given by Table II where |ψij⟩
are not normalized, and where the |Ei j⟩ were chosen by
Eve. Eve now applies a unitary V on HE ⊗ HAB and
then sends Bob his part of the resulting state.
Recall that Eve attacks now using the unitary V
acting on the residual state in HE ⊗ HAB, and then
TABLE II
THE STATE IN EVE’S HANDS AFTER ALICE’S MEASUREMENT
WHEN LOSSES AND MULTI-PHOTON PULSES ARE ALLOWED
Measurement
Residual state (in Eve’s hands)
00
|ψ00⟩ = |E00⟩|0,0⟩AB
01
|ψ01⟩ = ∑n0≥1 |E0n0⟩|0,n0⟩AB
10
|ψ10⟩ = ∑n1≥1 |En10⟩|n1,0⟩AB
CTRL
|ψ⟩ = |ψ00⟩+ |ψ01⟩+ |ψ10⟩
she sends Bob his part of the resulting state. Bob’s
measuring abilities put more constraints on the state |ψ⟩
for Eve not to be detectable. In case the SIFT bit is
used for TEST, Bob’s probability of measuring 11 must
be zero, no matter what Alice measured. Furthermore,
for Eve to stay undetectable, if Alice measured |0,0⟩
(namely, the outcome 00) in the SIFT mode, then Bob
should have a probability zero of measuring 01 or 10,
thus, a probability zero of receiving the states |1,0⟩ or
|0,1⟩. Similarly if Alice measured 10 (01), then Bob
should have a probability zero of measuring 01 (10);
he could however get a loss, 00. The resulting (non
normalized) Eve+Bob residual states thus take the form
|ψ′
00⟩ = V |ψ00⟩ = |H00⟩|0,0⟩AB when a loss arrives, and
|ψ′
01⟩ = V |ψ01⟩ = ∑
n0≥1
|F0n0⟩|0,n0⟩AB + |H01⟩|0,0⟩AB
|ψ′
10⟩ = V |ψ10⟩ = ∑
n1≥1
|Fn10⟩|n1,0⟩AB + |H10⟩|0,0⟩AB
(15)
otherwise; V being linear, the (normalized) residual state
if Alice applied CTRL is |ψ′⟩ ≡V |ψ⟩ = |ψ′
00⟩+ |ψ′
01⟩+
|ψ′
10⟩.
In order to check CTRL bits, Bob measures |ψ′⟩ in
the x basis and checks if he gets at least one photon in
any illicit state, such as |−⟩; more precisely, he measures
|ψ′⟩ in the Fock basis |n−,n+⟩x corresponding to the x
basis of single photon states, and aborts if he gets n− > 0
(if the detector for |−⟩ photons clicks). To avoid that, Eve
must make sure that the overlap between Eve-Bob’s state
|ψ′⟩ and each state of the form |n−,n+⟩x with n− > 0 is
zero. This results with another limitation on Eve’s attack.
Lemma 1. If Bob has a zero probability of measuring
any state |n−,n+⟩x with n− > 0, then |F01⟩ = |F10⟩, and
|F0n⟩ = |Fn0⟩ = 0 for n > 1.
Proof (sketch).
Let |ψ′⟩ = ∑n0≥1 |F0n0⟩|0,n0⟩ + ∑n1≥1 |Fn10⟩|n1,0⟩ +
33
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-431-2
ICQNM 2015 : The Ninth International Conference on Quantum, Nano/Bio, and Micro Technologies

|H⟩|0,0⟩ be the Eve+Bob residual state. Let |e(n)⟩ =

