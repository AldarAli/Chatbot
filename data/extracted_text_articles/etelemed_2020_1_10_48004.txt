Lower-Limb Falling Detection System Using Gated Recurrent Neural Networks
Francisco Luna-Perej´on, Luis Mu˜noz-Saavedra, Javier Civit-Masot, Juan M. Montes-S´anchez,
Manuel Dom´ınguez-Morales and Anton Civit
Robotics and Computer Technology Lab
Avda. Reina Mercedes s/n, E.T.S. Ingenier´ıa Inform´atica, Universidad de Sevilla, Sevilla, Spain
Email: {fralunper, luimunsaa, jcivit, jmontes, mdominguez, civit}@atc.us.es
Abstract—Accidental falls are one of the most common causes
of premature disability and mortality related to unnatural
causes. This affects mainly the elderly population. With the
current aging of the population, the rate of accidental falls
increases. Computer systems for gait analysis and fast assistance
in ubiquitous environments can be effective tools to prevent these
accidents. In this article we present the advances in the creation
of an intelligent device for detecting falls and risk situations
based on accelerometer signals registered on the user’s ankle.
The proposed method makes use of Deep Learning techniques,
speciﬁcally Gated Recurrent Neural Networks. The results show
that the proposed model is a viable alternative to detect falls and
fall risk, which can be implemented in low performance devices
for greater autonomy, lower cost and comfortable portability.
These results open the possibility of combining fall detection
with a biomechanical analysis system to identify gait deﬁciencies
and their relation with falls.
Keywords-fall detection; fall prevention; accelerometer; Gated
Recurrent Neural Networks.
I. INTRODUCTION
Elderly people commonly suffer falls, which can drastically reduce
their quality of life, their capabilities for independent living and, in
many cases, their sense of self efﬁciency. This is a very signiﬁcant
public health problem in a worldwide scale. World Health Organi-
zation (WHO) reports indicate that around 30% of seniors over 65
years old suffer at least one fall per year and the fall rate increases
signiﬁcantly with age [1]. There are many age related factors as-
sociated with this increased fall rate including cognitive, affective,
sensory, musculoskeletal, neurological, and metabolic changes [2]. It
is also well known that gender is also a key factor as women fall
more often than men and sustain more injuries when they fall [3].
Many factors related to falls have also an important inﬂuence on the
person gait. Thus, we can study a person gait in order to predict their
future probability of falling [4] and, also, it would be interesting to
study the capability of wearable devices to perform both gait analysis
[5] and fall detection tasks [6][7].
An important factor with a signiﬁcant impact in falls is that many
elderly people lose conﬁdence and adopt a more sedentary life, losing
mobility and increasing the probability of falling because of their poor
shape [8][9]. Direct consequences of falls include injuries to muscles,
bone fractures and head trauma among others. Major injuries pose
signiﬁcant risk for post-fall morbidity and mortality and have strong
economic impacts on family and public health providers [10].
Devices that monitor user activity and ideally alert when a fall
has occurred are known as Fall Detection Systems (FDS). Their
main objective is to distinguish between Activity of Daily Living
(ADL) and fall events (alerting when this one happens) [11]. On
one hand, context-aware systems use sensors installed in the envi-
ronment: users don’t need to wear any special device and they do
not have signiﬁcant computational or energy limitations. However,
these solutions are limited to speciﬁc areas and are prone to privacy
related ethical issues. On the other hand, wearable devices allow
user monitoring without any dependence with environment-based
sensors. These systems are usually based on simple sensors such
as accelerometers or gyroscopes, that can be integrated in low-power
devices to increase their battery life [12]. Wearable FDS require a
periodic sensor monitoring process (several times per second) that
may demand a signiﬁcant power consumption; but, if fall detection
is performed in the embedded device, the algorithm may reduce the
detection accuracy and increase the response time.
Regarding fall detection algorithms two main families are widely
used: threshold based and machine learning based algorithms. Delv-
ing into Machine Learning systems, Gated Recurrent Neural Net-
works (RNN), such as Long Short-Term Memory (LSTM) and Gated
Recurrent Units (GRU) are Deep Learning networks speciﬁcally
designed for sequence processing. Recent studies have shown the
potential of RNNs for dynamic signal classiﬁcations [13] and specif-
ically for accelerometer data [14][15].
Considering the other function that we want to embed into our
wearable device, Gait Analysis Systems (GAS) have been available
for a long time and are widely used in rehabilitation scenarios [16].
A good survey of the different technologies available for gait analysis
can be found at [17]. As in the case of fall detector and GAS can
either be environment based or wearable. Wearable GAS are popular
in the ﬁtness related communities. Moreover, our group developed
and tested an embedded GAS placed in a wearable device [18].
Thus, analyzing the publications related to these devices it is clear
that gait analysis can be performed using a sensor in the foot or
the ankle. However, it is not clear that wearable FDS can perform
adequately when they are attached to these locations.
The main goal would be to create a combined FDS and GAS device
(Fall Detection and Gait Analysis System: FDGAS) so that we can
use gait data to forecast possible falls. In this work, we will study the
feasibility of a lower-limb FDS. As the feasibility of a lower-limb
GAS has already been established, if we are able to prove that our
intermediate goal is reachable then, we would be able to achieve the
ﬁnal goal of design and evaluating the FDGAS.
The article is organized as follows: Section II describes Gated
Recurrent Neural Networks used for the Deep Learning classiﬁcation
algorithm; Section III describes the wearable device and the database
used for the training process; Section IV presents the results obtained
after the training and testing phases; and, ﬁnally, Section V includes
the discussion regarding the effectiveness of the trained Deep Learn-
ing models and the ﬁnal conclusions of the work.
II. GATED RECURRENT NEURAL NETWORKS
Recurrent Neural Networks are Deep Learning architectures
speciﬁcally designed to extract features from sequential data, such
as time varying signals. Gated Neural Networks are a newer version
of RNN that solve traditional problems that affect the learning process
of these networks. They add a vector as an information storage
component called cell, which stores information acquired during the
sequence analysis, relevant to process the rest of the sequence. Long
Short-Term Memory (LSTM) and Gated Recurrent Units (GRU) are
the most popular architectures of this type, which has demonstrated
1
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

good performance in problems such as signal classiﬁcation [13][14].
The main differences between them are the way they update and
use the stored information in the cells during the sequence analysis
(See Figure 1). An LSTM cell management system consists of three
activation functions called gates to add new information to the cell
(input gate), remove current information stored (forget gate) and
pass information to the neural network that considers relevant to
process the sequence in an speciﬁc stage (output gate). In case of
a GRU cell, there are only two gates, which adds (update gate) and
removes (reset gate) information from the cell respectively, allowing
all stored information to be used by the neural network throughout
the sequence analysis. Both kind of Recurrent Neural Networks have
similar performance, although GRU is theoretically more efﬁcient
due to having two gates.
Figure. 1. LSTM and GRU cells.
III. MATERIALS AND METHODS
A. Data register device
To collect data, we developed a data acquisition prototype using a
ST-nucleo L432KC low-power microcontroller, that obtains tri-axial
acceleration data from an ADXL345 accelerometer and transmits it
via Bluetooth to check the correct sensing of the data in real time
during the activity recording. The microcontroller frequency sampling
and transmission was conﬁgured at 25Hz. The accelerometer was
conﬁgured to work with a precision of ±16g. The x axis of the
accelerometer was aligned with the horizontal line, y axis with the
vertical, and z axis was in the march direction.
B. Dataset aqcuisition
A set of activities were selected for this work, including Activities
of Daily Living, fall risk situation and falls. We proposed 7 ADL, two
of which include a fall risk phase, and 4 different falls (Table I). The
subjects who performed the activities were 7 volunteers, 6 males and
1 female. The volunteers had heights between 1.60 and 1.95 meters,
weights between 70 and 110 kilograms and ages between 24 and 30.
All the activities were registered with the device placed on the right
ankle.
The ADL that the volunteers performed are described in Table I:
TABLE I. TYPE OF ACTIVITIES RECORDED.
Parameter
Set of values for grid search
ADL
Activity 1
The subject sits down on a chair.
Activity 2
The subject gets up from a chair.
Activity 3
The subject walks calmly.
Activity 4
The subject goes down the stairs.
Activity 5
The subject goes up the stairs.
Activity 6
The user trips over with the right foot.
Activity 7
The user trips over with the left foot.
Falls
Activity 8
The user falls backwards.
Activity 9
The subject falls to the left.
Activity 10
The subject falls to the right.
Activity 11
The subject falls forward.
C. Data labelling and block segmentation analysis
Each sample in the activity records was labelled according to what
part of the activity it belongs to. Four classes were considered:
• Fall: if the sample is part of the moment of fall in an activity.
• Risk: if the sample is part of the moment of risk of falling,
before a fall or recovering the balance in a stumble.
• ADL: if the sample is part of walking or another ADL contem-
plated in the activity set.
• Background (BKG): if the sample does not belong to any of
the previous classes. This class includes moments of stillness
at the beginning or end of the record of each activity. It also
contemplates the period of inactivity after a fall.
Two of the authors labeled the samples and veriﬁed the result. All
the activities were also recorded in a video as support material for
labeling.
The Gated Recurrent Neural Networks input should have a short
ﬁxed length for better performance. For this reason, each activity
record should be split in segments having the same number of
temporal samples. Henceforth, each segment will be referred to as a
block, and the number of samples as width. Since fall and risk events
last a short time, this fact is an advantage since it allows a detection in
real time. Additionally, each block needs to be associated to a unique
label. The criteria established to select a label was according to the
percentage of samples of the most relevant class (fall, risk, ADL,
BKG). BKG was the default class, that is, the label chosen when the
block does not contain the minimum percentage of samples of each
other class. In this study, different width and minimum percentage
of fall, risk and ADL classes were used. Data augmentation was also
used by establishing a window stride during the record split. Different
stride values were also analyzed.
D. Model training and evaluation
Two basic models based on Recurrent Neural Networks were
assessed. They are consisting of a batch normalization layer, a
recurrent layer, LSTM and GRU respectively, and a dense layer
with four nodes and softmax for class inference (See Figure 2). The
results in [12] show that this architecture has a high performance
with data acquired at the waist to infer three classes (fall, risk and
ADL-BKG combined) and low computational complexity allowing a
classiﬁcation in real time. A weighted loss function was applied to
offset the imbalance of the data.
Hold-out validation and grid-search were used for hyperparameter
optimization. The hyperparameters consisted of the number of nodes
of the recurrent layer (N), dropout rate (Dr), learning rate (lr) and
batch size (bs). The set of values used for each hyperparameter is
shown in Table II.
2
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

Figure. 2. Diagram of the Gated RNN architectures assessed.
TABLE II. GRID SEARCH VALUES FOR EXHAUSTIVE PARAMETERS
OPTIMIZATION.
Parameter
Set of values for grid search
Learning rate
0.0001, 0.0005, 0.001
Batch size
32, 64
Number of nodes
16, 32, 48
Dropout
0.15, 0.25
To assess the effectiveness of the models, we use a set of metrics,
that is, macro recall or sensitivity, precision and macro f1-score, and
speciﬁcity. They are expressed as follows:
Precisionm =
X
c
TPc
TPc + FPc , c ∈ classes
(1)
Recallm(sensitivity) =
X
c
TPc
TPc + FNc , c ∈ classes
(2)
Specificity =
X
c
TNc
TNc + FPc , c ∈ classes
(3)
F1 − scorem = 2 ∗ precisionm ∗ recallm
precisionm + recallm
(4)
where
m
index
refers
to
macro
metric
and
classes
=
{BKG, ADL, risk, fall}. TPc, FPc and FNc denote the number
of true positives, false positives and false negatives of each class
c ∈ classes, respectively. Finally, TNc denotes the number of true
negatives of each class c ∈ classes.
IV. RESULTS
The results obtained after optimization for the two models are
presented in Table IV. The models were trained using the resulting
dataset from 6 users and tested with the data from 1 user. The dataset
distribution before data segmentation and augmentation is shown in
Table III.
TABLE III. DATASET DISTRIBUTION FOR EACH SUBSET.
Blocks
Subset
Total
ADL
BKG
Alert
Fall
Training
5,621
1,179
3,553
348
541
Test
1,259
422
698
57
82
The confusion matrix can be observed in Figure 3. The metrics
values obtained before grid search optimization are shown in table
IV. The GRU model reached a better performance, but it does not
get a signiﬁcant difference, that matches with results in [19]. These
similarity on result by comparing the two types of RNN layers are
somewhat similar to [12]. Since the GRU layers present quite lower
computational costs, it can be a better option for a low power energy
device.
The performance obtained with these models and data is somewhat
low compared to the current state-of-the-art. However, there are
several limitations that inﬂuence the results. First, a classiﬁcation
problem with four classes has been carried out. A binary problem
would probably have reached higher success rates but, with this
problem we wanted to analyze the ability of the model to distinguish
several classes. Second, the dataset created is quite small to train
Deep Learning models, because it has many features to optimize.
We have not contemplated the analysis of more complex models
for this reason, since the number of features would be consider-
ably higher. Finally, no preprocessing of the data values has been
performed. Considering these factors, the results obtained show that
these models have great potential to identify falls and risk situations
with accelerometer data positioned on the ankle and without ﬁltering.
Figure. 3. Confusion matrices for the LSTM model in (a) and GRU model
in (b).
TABLE IV. RESULTS OBTAINED AFTER GRID SEARCH
OPTIMIZATION.
RNN type
Precisionm
Recallm
Specificity
F1scorem
LSTM
0.681
0.784
0.920
0.729
GRU
0.691
0.790
0.925
0.737
The results obtained after these preliminary tests demonstrate the
feasibility of using a fall detection system located in the lower limb.
This fact is the main novelty of this work, since in the literature
can only be found works that place the device on the waist or upper
extremities. However, this study has limitations that must be detailed:
• The ﬁnal number of volunteers used to obtain the database is
limited: in future studies it is necessary to expand the number
of people.
• Due to lack of time, a single data collection was carried out for
each activity and person. It is important to expand the samples
in the future to have, at least, 3 data collection of each activity
from each person.
• The previous deﬁciencies mean that the results obtained in this
preliminary study are not as good as those obtained in other fall
detection systems (not located in the lower limbs). However, the
improvement of the previous points in subsequent studies will
improve those results.
V. CONCLUSION
The performance reached with simple LSTM and GRU models
indicates the feasibility to extract features to identify ADL, falls and
risk events (in falling detection systems). This work demonstrates
that FDS can be placed in the lower limbs in order to combine the
information obtained from it with Gait Analysis Systems (GAS). This
is the main novelty of this work.
However, in order to improve the results obtained in this work,
it is necessary to deepen into these systems with more complex
3
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

architectures and larger datasets, as well as in the application of
appropriate data preprocessing techniques.
In future works, this lower-limb FDS will be combined with the
GAS to create a high-level system able to detect any abnormality
during the daily activities of the patient.
ACKNOWLEDGMENT
The authors would like to thank the Robotics and Computer
Technology Lab for the loan of materials and facilities to collect
data and testing.
REFERENCES
[1] “Ageing; life course unit. who global report on falls prevention in older
age,” World Health Organization, 2008.
[2] N.
Kronfol,
“Biological,
medical
and
behavioral
risk
factors
on
falls,”
World
Health
Organisation
http://www
who
int/ageing/project/falls prevention older age/en/inded
html,
2012
[Last access on January 25, 2020].
[3] M. E. Tinetti, J. T. Doucette, and E. B. Claus, “The contribution of
predisposing and situational risk factors to serious fall injuries,” Journal
of the American Geriatrics Society, vol. 43, no. 11, pp. 1207–1213,
1995.
[4] L. Wolfson, R. Whipple, P. Amerman, and J. N. Tobin, “Gait assessment
in the elderly: a gait abnormality rating scale and its relation to falls,”
Journal of gerontology, vol. 45, no. 1, pp. M12–M19, 1990.
[5] J. Pineda-Guti´errez, L. Mir´o-Amarante, M. Hern´andez-Vel´azquez,
F. Sivianes-Castillo, and M. Dom´ınguez-Morales, “Designing a wearable
device for step analyzing,” in 2019 IEEE 32nd International Symposium
on Computer-Based Medical Systems (CBMS).
IEEE, 2019, pp. 259–
262.
[6] F. Luna-Perejon et al., “An automated fall detection system using
recurrent neural networks,” in Conference on Artiﬁcial Intelligence in
Medicine in Europe.
Springer, 2019, pp. 36–41.
[7] F. Luna Perej´on et al., “Sampling frequency evaluation on recurrent
neural networks architectures for iot real-time fall detection devices,”
in IJCCI 2019: 11th International Joint Conference on Computational
Intelligence (2019), p 536-541.
ScitePress Digital Library, 2019.
[8] L. Rubenstein, “Falls in older people: epidemiology, risk factors and
strategies for prevention,” Age and ageing, vol. 35, no. suppl 2, pp.
ii37–ii41, 2006.
[9] M. Aschkenasy et al., “Aschkenasy, miriam t and rothenhaus, todd c,”
Emergency Medicine Clinics, vol. 24, no. 2, pp. 413–432, 2006.
[10] J. A. Stevens, P. S. Corso, E. A. Finkelstein, and T. R. Miller, “The
costs of fatal and non-fatal falls among older adults,” Injury prevention,
vol. 12, no. 5, pp. 290–295, 2006.
[11] R. Igual, C. Medrano, and I. Plaza, “Challenges, issues and trends in
fall detection systems,” Biomedical engineering online, vol. 12, no. 1,
p. 66, 2013.
[12] F. Luna-Perej´on, M. J. Dom´ınguez-Morales, and A. Civit-Balcells,
“Wearable fall detector using recurrent neural networks,” Sensors,
vol. 19, no. 22, p. 4885, 2019.
[13] C. Gao, D. Neil, E. Ceolini, S.-C. Liu, and T. Delbruck, “Deltarnn: A
power-efﬁcient recurrent neural network accelerator,” in Proceedings of
the 2018 ACM/SIGDA International Symposium on Field-Programmable
Gate Arrays, 2018, pp. 21–30.
[14] S. Yu, “Residual learning and lstm networks for wearable human activity
recognition problem,” in 2018 37th Chinese Control Conference (CCC).
IEEE, 2018, pp. 9440–9447.
[15] M. Musci, D. De Martini, N. Blago, T. Facchinetti, and M. Piastra,
“Online fall detection using recurrent neural networks,” arXiv preprint
arXiv:1804.04976, 2018.
[16] R. Baker, “Gait analysis methods in rehabilitation,” Journal of neuro-
engineering and rehabilitation, vol. 3, no. 1, p. 4, 2006.
[17] A. Muro-De-La-Herran, B. Garcia-Zapirain, and A. Mendez-Zorrilla,
“Gait analysis methods: An overview of wearable and non-wearable
systems, highlighting clinical applications,” Sensors, vol. 14, no. 2, pp.
3362–3394, 2014.
[18] M.
J.
Dom´ınguez-Morales,
F.
Luna-Perej´on,
L.
Mir´o-Amarante,
M. Hern´andez-Vel´azquez, and J. L. Sevillano-Ramos, “Smart footwear
insole for recognition of foot pronation and supination using neural
networks,” Applied Sciences, vol. 9, no. 19, p. 3970, 2019.
[19] J. Chung, C. Gulcehre, K. Cho, and Y. Bengio, “Empirical evaluation of
gated recurrent neural networks on sequence modeling,” arXiv preprint
arXiv:1412.3555, 2014.
4
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-763-4
eTELEMED 2020 : The Twelfth International Conference on eHealth, Telemedicine, and Social Medicine

