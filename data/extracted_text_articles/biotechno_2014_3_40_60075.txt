Magnetic Resonance Angiogram Processing
and Modelling of the Cerebral Vascular Network
Krzysztof Psiuk-Maksymowicz
Institute of Automatic Control
Silesian University of Technology
Gliwice, Poland
Email: krzysztof.psiuk-maksymowicz@polsl.pl
Jarosaw ´Smieja
Institute of Automatic Control
Silesian University of Technology
Gliwice, Poland
Email: jaroslaw.smieja@polsl.pl
Damian Borys
SInstitute of Automatic Control
Silesian University of Technology
Gliwice, Poland
Email: damian.borys@polsl.pl
Abstract—The main aim of the work is to develop an algorithm
for creation of three-dimensional model of the cerebral vascular
network on the basis of medical images. Two types of non-
contrast enhanced magnetic resonance angiograms were used as
input data. First of them, Time of Flight angiography, enabled
visualization of the arterial tree, whereas the next one, Phase
Contrast angiography, enabled visualization of both arterial and
venous trees. Medical images stored in Digital Imaging and
Communications in Medicine (DICOM) ﬁle format required
pre-processing. This process included resizing of the images,
segmentation of the brain area and morphological white top-
hat transformation in case of Time of Flight images, for noise
reduction and gamma transformation necessary for enhance-
ment of the vessels. The main core of the algorithm consists
of segmentation of the vessel sections, selection of the vessels
centroids, and construction of graph structure storing branches
and nodes of the network. Three types of segmentation algorithms
were analysed: algorithms with automatic and manual threshold
segmentation (where threshold is based on image histogram);
and binarization with hysteresis. The vascular trees obtained
from two types of images were compared with each other. The
developed algorithm allows for creation of three-dimensional
model of cerebral vascular network and is potentially useful for
the diagnosis of various vascular system abnormalities/diseases
of the brain , as well as for the scientiﬁc simulations of blood
ﬂow or prediction of the drug distribution in the brain.
Keywords-Medical image processing; image segmentation; MRI
angiography; cerebral vasculature.
I.
INTRODUCTION
Contemporary Magnetic Resonance Imaging (MRI) tech-
nique allows for angiographic studies without the use of
enhancing contrast agent. Cardiovascular imaging is crucial
in diagnosis of vascular pathologies, e.g., cerebral aneurysm.
The most common sites of intracranial saccular aneurysms are
anterior and posterior communicating arteries of the Circle of
Willis.
The main aim of this study is to create an efﬁcient algo-
rithm for creation of the model of the cerebral blood vessels
trees from three-dimensional medical MRI angiograms that
reﬂects real structure of both venous and arterial vessels. The
developed algorithm can be used not only for visualisation of
the cerebral vascular system but also can be useful in detection
of geometric deformations or abnormal narrowing of the blood
vessels.
MRI images are stored in standardized DICOM ﬁle for-
mat [1]. Apart from the pre-processing improving the quality
of the input data, the problem of extraction of vascular tree
comes down to the problem of segmentation. There are many
methods for medical image segmentation (see Chapter II
in [2]). Segmentation techniques can be divided into classes
in many ways, depending on classiﬁcation scheme. The most
commonly used segmentation techniques can be classiﬁed into
two broad categories: region segmentation, and edge-based
segmentation techniques. The most common region segmen-
tation method is method of thresholding (e.g., global or local
(adaptive) thresholding) [2], [3]. Other region segmentation
techniques include clustering, region growing, and watershed
algorithms. Whereas, the edge-based segmentation algorithms
include graph searching and contour following. The more
sophisticated techniques use fuzzy clustering, neural networks,
or deformable models.
Different segmentation techniques have different applica-
tions. Lesage et al. [4] review the techniques applicable for
the vessel lumen segmentation. They also raise the topic of
post-processing since initial extraction results may be lacking
in different aspects: surface information may be missing or
inaccurate, the vessels topology may be incorrect, non-vessel
regions may be included, vessel segments may be disconnected
or missing. An example of post-processing is skeletoniza-
tion [5], which is used to determine the centerline of the vessel.
In practice, image noise and the inherent limitations of 3D
thinning algorithm may result in a skeleton that contains cycles
and spurious spurs. Thus, it is necessary to perform skeleton
pruning [6] in order to preserve unit-width skeleton without
any bridges.
The rest of the paper is organized as follows: First, the
research methodology is described in Section II. In Section III,
we show the results of both image processing and algorytmic
part of the work. Finally, in Section IV, we present the
concluding remarks.
II.
MATERIALS AND METHODS
Two types of non-contrast enhanced magnetic resonance
angiograms were the input data of the developed algorithm.
First of them, Time of Flight (TOF) angiography, enabled vi-
sualization of the arterial tree (see Fig. 1(a) and 1(c)), whereas
59
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-335-3
BIOTECHNO 2014 : The Sixth International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies

the next one, Phase Contrast (PC) angiography, enabled vi-
sualization of both arterial and venous trees (see Fig. 1(b)
and 1(d)). An advantage of the TOF and PC techniques over
the tradicional MRI angiography is that there is no need to
use contrast agent, which may have adverse effects. Maximum
Intensity Projection (MIP) of both types of images is presented
in Fig. 1. The quality of the PC image data was higher then
of the TOF images. The PC images were of size 1140 x 1140
voxels, whereas TOF were of size 256 x 256 voxels.
(a) Transverse plane
(b) Transverse plane
(c) Sagittal plane
(d) Sagitall plane
Figure 1: MIP projection of magnetic resonance images
performed by means of TOF (a), (c) and PC (b), (d)
techniques.
Medical images are often subjected to pre-processing, for
increasing the quality of images. It enables for a more effective
segmentation. In order to reduce the noise of the images,
frequently median or convolution ﬁlters are applied. In this
work, median ﬁlters ware used. Second step in pre-processing
was application of the morphological White Top-Hat (WTH)
transformation [7]. The WTH transformation is deﬁned as
the difference between the input image and its opening by
some structuring element. The resulting images highlights
the sections of blood vessels; since, their intensities have
higher values than the image background. All images were
also subjected to nonlinear gamma correction [8] in order to
improve the contrast of the images.
Additionally, for the set of TOF images, it was necessary
to remove the skull oval.
For the purpose of segmentation, either thresholding seg-
mentation or binarization with hysteresis were applied. The
thresholds were chosen experimentally or automatically by
means of the image histograms.
A signiﬁcant part of the work was devoted to creation of
object-oriented model of the vascular network structure. This
work required:
•
Selection of the vessels centroids on each slice,
•
Iterative creation of branches from centroids, which
subsequent cross-sections overlapped with each other,
•
Saving the contours of subsequent sections for each
branch,
•
Capturing bifurcations, and storing it as node objects,
•
Recursive attaching branches to nodal points.
The process of branches creation was complemented by
a procedure of joining branches for those branches, which
marginal cross-sections did not overlapped but were in close
proximity. In such a case, changes in vessel circumference of
subsequent cross-sections were analysed.
III.
RESULTS
All of the calculations were carried out in Matlab environ-
ment. Input TOF and PC images were subjected to successive
image transformations. Median ﬁltering of the images is not
shown but the best results were obtained for 5x5 size of the
mask. Figure 2 presents the outcome of the process of skull
elimination from TOF image.
(a) Original MRI image.
(b) Image after skull removal.
Figure 2: Process of elimination of the skull from the TOF
images.
In the case of gamma correction, the best results for TOF
images were obtained for γ = 1.2, whereas for PC images
it was γ = 1.4. For the white top-hat transformation different
structural elements were analysed. The best element turned out
to be a square element with 30 pixels side length.
(a) Original MRI image.
(b) Segmented vessels.
Figure 3: Process of vessel segmentation from TOF images
with applied method of binarization with a hysteresis.
60
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-335-3
BIOTECHNO 2014 : The Sixth International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies

Different types of segmentation methods for vessel ex-
traction were analysed. Those implemented were compared
with methods implemented in graphical programs, e.g., Yen
method [9]. Nevertheless, those more advanced methods did
not show any signiﬁcant difference in comparison to the
methods described in Section II. For the TOF images the best
results were obtained for the binarization with hysteresis (see
Fig. 3). While for the PC images the best segmentation results
were obtained for binarization with threshold based on the
image histogram.
Figure 4: Visualization of two branching vessels with visible
skeleton (in red) of the vessel.
The implemented algorithm for creating the object-oriented
model of the vascular network structure is working properly.
An example of two enlarged network segments is present on
Fig. 4. One can see three-dimensional visualisation of the
branch objects in red colour connected with nodal points by
black lines, together with successive vessel contours presented
in blue colour.
(a) MIP projection from TOF images.
(b) Visualization of the blood ves-
sel network.
Figure 5: Comparison between input TOF data (a) and the
result of developedalgorithm (b).
The comparison between input TOF data and visualisation
of the model of arterial network for the whole brain is pre-
sented in Fig. 5. The selected method for the segmentation was
binarization, with the threshold based on the image histogram.
The advantage of the model is that one can selectively visualize
only a part of the branches of the vascular network (or
distinguish it with a different colour). Thanks to the model,
the statistical analysis of the network parameters may be
signiﬁcantly reduced.
The comparison between the structure of the vessel net-
work obtained by means of two different techniques is pre-
sented in Fig. 6. Images complement each other. Interestingly,
despite the TOF images are of much lower resolution and
(a) Vessel structure obtained
from TOF MRI.
(b) Vessel structure obtained
from PC MRI.
Figure 6: Comparison between two vessel network obtained
from TOF (a) and PC (b) MRi angiographies.
contain more noise, this angiography technique gives more
dense arterial network.
IV.
CONCLUSION
The developed algorithm allows for creation of three-
dimensional model of cerebral vascular network and is po-
tentially useful for the visualisation and diagnosis of various
vascular system diseases of the brain, as well as for the
scientiﬁc simulations for blood ﬂow or prediction of the drug
distribution in the brain. The best segmentation results for
TOF images were obtained by means of the binarization with
hysteresis, whereas, the best segmentation results for the PC
images were obtained for binarization with threshold based
on the image histogram. Beyond the image processing, the
work required the development of the algorithm of creation of
blood vessel skeleton. The way of merging centroid points
in the branches and bifurcations was no always trivial (in
particular due to vessel twisting). The present work is still
under development, it requires a quantitative analysis of the
results. Application of two types of non-contrast MRI imaging
is performed in order to extract the veins, which are present
only at PC images together with the arteries. Therefore,
the goal is not to improve the visualization of the entire
vessel network but correct estimation of both 3D structures.
The quality of the ﬁnal model of cerebral vascular network
depends strongly on the quality of the input data provided.
Pre-processing and choice of segmentation method play an
important role, however breaks in branches are mostly caused
by imperfection of the acquisition method.
Applicability of the method is very broad. Visualization
of the three-dimensional vascular network may have clinical
applications, and the same network model can be used in fur-
ther research. The obtained vascular tree structure of the brain
can complement for example mathematical model describing
vascular growth of tumours, mathematical modelling of blood
ﬂow, or models describing creation and growth of the blood
vessels (e.g., angiogenesis).
ACKNOWLEDGMENT
This work was supported by the National Science Centre
(NCN) under Grant No. 2011/03/B/ST6/04384.
61
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-335-3
BIOTECHNO 2014 : The Sixth International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies

REFERENCES
[1]
Ofﬁcial www website of the Association of Electrical Equipment
and Medical Imaging Manufacturers describing the DICOM standard
http://medical.nema.org/standard.html, [retrieved: 03, 2014].
[2]
I. N. Banckman, Handbook of Medical Imaging. Processing and Analy-
sis. United States of America: Academic Press, 2000.
[3]
M. Sezgin, and B. Sankur, ”Survey over image thresholding techniques
and quantitative performance evaluation”, Journal of Electronic Imaging,
vol. 13, Jan. 2004, pp. 146-165, doi: 10.1117/1.1631316.
[4]
D. Lesage, E. D. Angelini, I. Bloch, and G. Funka-Lea, ”A review of 3D
vessel lumen segmentation techniques: Models, features and extraction
schemes,” Medical Image Analysis, vol. 13, Dec. 2009, pp. 819-845,
doi:10.1016/j.media.2009.07.011.
[5]
L. Verscheure, L. Peyrodie, A. S. Dewalle, and N. Reyns, ”Three-
dimensional skeletonization and symbolic description in vascular imag-
ing: preliminary results,” International Journal of Computer Assisted Ra-
diology and Surgery, vol. 8, Mar. 2012, pp. 233-246, doi:10.1007/s11548-
012-0784-4.
[6]
Z. Chen and S. Molloi, ”Automatic 3D vascular tree construction in CT
angiography,” Comuterized Medical Imaging and Graphics, vol. 27, Nov.
2003, pp. 469-479, doi:10.1016/S0895-6111(03)00039-9.
[7]
P. Soille, Morphological Image Analysis. Berlin: Springer, 2004.
[8]
Y. Shi, J. Yang, and R. Wu, ”Reducing Illumination Based on Nonlinear
Gamma Correction,” Image Processing, 2007. ICIP 2007. IEEE Interna-
tional Conference on, vol.1, pp.I - 529,I - 532, Sept. 16 2007-Oct. 19
2007, doi:10.1109/ICIP.2007.4379008.
[9]
J. C. Yen, F. J. Chang, and S. Chang, ”A new criterion for automatic
multilevel thresholding,” Image Processing, IEEE Transactions on, vol.4,
pp.370-378, Mar. 1995, doi:10.1109/83.366472.
62
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-335-3
BIOTECHNO 2014 : The Sixth International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies

