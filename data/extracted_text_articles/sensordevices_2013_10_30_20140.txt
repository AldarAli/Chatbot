A Prototype for Blood Typing Based on Image Processing 
 
Ana Ferraz, Filomena Soares 
R&D Centre Algoritmi  
University of Minho 
 Guimarães, Portugal 
Ana.Ferraz@algoritmi.uminho.pt 
Filomena.Soares@algoritmi.uminho.pt 
Vitor Carvalho 
EST, Polytechnic Institute of Cávado and Ave 
Barcelos, Portugal & R&D Centre Algoritmi  
University of Minho, Guimarães, Portugal 
vcarvalho@dei.uminho.pt
 
 
Abstract—This paper presents a new methodology for blood 
phenotyping based on the plate test and on image processing 
techniques to determine the occurrence of agglutination 
(between blood sample and reagent). A portable device for 
ABO-Rh blood typing and blood phenotying that automates all 
the analysis procedure, including mixture/centrifugation, 
reading and interpretation of results is presented. The system 
was tested with donor blood samples. 
Keywords - blood type determination; phenotyping; image 
processing techniques; prototype. 
I. 
 INTRODUCTION 
The process of determination of blood types is essential 
before administering a blood transfusion, but in some cases, 
due to the risk of the individual´s life, it is necessary to 
quickly administer blood [1-3]. In these emergency 
situations, there is no time to determine the blood type and 
so the procedure is to administer the blood type O negative 
(universal donor) [1-3]. Nevertheless, due to some 
incompatibilities transfusion reactions may occur that could 
lead to the death of the patient [3]. 
Before performing a safe blood transfusion, certain 
compatibility tests, named pre-transfusion tests, must be 
undertaken, namely [4-6]: 
  
1. Determine the A, B, AB, O (ABO system) and 
Rhesus (Rh) type of the patient;  
2. Perform the reverse test: reverse grouping of ABO 
typing of the patient;  
3. Perform the Rh (C, c, E and e) and Kell (K) 
phenotyping for detecting the presence of antigens 
in the blood of the patient. The search of other 
antigens can also be performed, but only in few 
situations [7]; 
4. Perform the screening of antibodies to detect the 
presence of significant antibodies. If antibody 
screening is positive, an identification of the 
antibody must be performed to allow the selection 
of the compatible blood; 
5. Verify the results with previous data, if available; 
6. Select the erythrocytes of the donor and perform 
the cross match. 
 
The determination of ABO and Rh type can be 
performed in tube [8], plate [8], micro-plates [2], or gel 
centrifugation [9]. Due to the fast response time, the tube 
and the plate tests are those used in emergency situations. 
The micro-plates and gel centrifugation tests are more 
accurate than the tube or plate tests, but they require 
expensive and heavy devices.  
This work aims to develop a prototype able to 
automatically perform the pre-transfusion tests necessary for 
a safe blood transfusion. This device is based on a previous 
version of the equipment developed by the authors [10-13] 
and 
it 
automates 
the 
reading, 
centrifugation 
and 
interpretation of results of all the pre-transfusion tests 
previously mentioned. The prototype presented is able to 
determine ABO and Rh blood typing and blood 
phenotyping. 
 It is important to mention that currently these tests are 
performed manually or at least semi-automatically, which 
may occur in errors in the testing procedure, the reading and 
interpretation of the results, being sometimes fatal to the 
patient [14, 15].  
Apart from the present section, the paper is organized 
with more four sections. In Section II, the phenotyping 
determination is described, presenting the image processing 
techniques applied. The prototype developed is presented in 
Section III and in Section IV the results of the phenotyping 
ABO and Rh tests with the prototype developed are 
discussed. Finally, Section VI presents the conclusions and 
the directions for future work.  
II. 
PHENOTYPING DETERMINATION  
A methodology was developed regarding the pre-
transfusion tests for determining the ABO and Rh type, 
based on the plate test and image processing techniques [13, 
16-18].  
This work is focused on the phenotyping tests Rh (C, c, 
E and e) and Kell (K), based also on the plate test [8]. The 
phenotyping determination is obtained through image 
processing techniques applied to the target image. The plate 
test method was employed due to its reliability and fast 
response time suitable in emergency situations.  
The procedure used in the phenotyping is described in 
[19], where it can be observed that it requires centrifugation 
to separate the blood from the plasma and red blood cells, 
which is a costly and complex process.  
139
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-297-4
SENSORDEVICES 2013 : The Fourth International Conference on Sensor Device Technologies and Applications

The 
proposed system 
is able to perform the 
centrifugation in a simple approach. After separating the 
blood and obtaining the plasma, six slides are considered, 
one for each of the phenotypes tested. In each slide, it was 
added a drop of the respective reagent TransClone Anti-
RH1 (D), TransClone Anti-RH2 (C), Transclone Anti-RH3 
(E), TransClone Anti-RH4 (c), TransClone Anti-RH5 (e) 
and TransClone Anti-Kel1 (K) [19], and a drop of blood of 
the patient. The mixture was manually performed using a 
glass rod in each slide. An image of the sample (mixed 
blood/reagent) was acquired and sent to the computer for 
further 
processing. 
The 
presence 
(or 
absence) 
of 
agglutination in each sample was determined through image 
processing techniques. The classification algorithm used in 
the analysis is implemented to work with blood samples 
after its centrifugation. The camera used to capture the 
images was a Sony Cyber-shot DSC-S750 of 7.2 Megapixel 
with 3X Optical Zoom (35-105 mm eq.) and 5 point auto 
focus [20]. 
To process the images, in order to determine the blood 
phenotyping as well as ABO-Rh, an algorithm was 
developed using IMAQ Vision software from National 
Instruments [21]. The algorithm developed is presented in 
Figure 1, as a flowchart [21-23]. The image captured is 
segmented, the localization of each of the wells is obtained 
and then the mixture reagents/blood is quantified, among 
others, with the standard deviation value. 
In Figure 1 are presented the image processing techniques 
applied: image selection and storage, extraction of the color 
planes of the image, application of thresholds and fill holes, 
removal of small and border objects, and analysis.  The 
original image is retrieved and luminance planes are 
removed, pattern and geometric matching is used to identify 
the imagine reference and containers position; finally the 
quantify function is employed determining the blood type in 
analysis. 
 
 
 
Figure 1. Flowchart of the algorithm developed for the prototype.
Select 
Image 
Image Buffer: 
Store a Copy 
Color Plane  
Extraction: RGB  
Green Plane 
Auto Threshold: 
Clustering 
Local Threshold: 
Niblack 
Adv.  
Morphology: 
Fill Holes 
Adv. Morphology: 
Remove Small  
Objects 
Adv. Morphology: 
Remove Border  
Objects 
Particle  
Analysis 
Image Buffer: 
Retrieve Copy 
Color Plane 
Extraction: 
HLS Luminance Plane 
Pattern  
Matching 
Geometric  
Matching 
Quantify 
Results 
Pattern 
Geometry 
Blood Type: O Negative 
140
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-297-4
SENSORDEVICES 2013 : The Fourth International Conference on Sensor Device Technologies and Applications

 
III. 
AUTOMATIC AND PORTABLE SYSTEM DEVELOPED 
The proposed system was developed to automatically 
determine the human blood type of a patient (phenotyping 
and ABO-Rh). An important requisite of the developed 
system was its portability (small and easy to transport to any 
place) in order to be used in emergency vehicles and other 
services. Thus, the analysis can be performed outside the 
clinical analysis laboratory and the results can be sent to the 
hospital through Wi-Fi or GSM.  
The system developed has 30 cm of height and 10,5 cm 
of diameter (Figure 2). It has an AC motor that allows the 
mixture and the centrifugation. The motor rotational speed 
is adjustable depending if the test performed is a mixture 
(low speed) or a centrifugation (high speed). The motor can 
spin the plate test with the six containers and mixture the 
blood and reagent, or spin the plate and centrifuge the blood 
for obtaining the plasma. When the test is performed the 
motor is stopped, the LEDs switch on and then an image 
with all the necessary data is captured. The image is 
processed and the result of the test is given. At the end the 
LEDs switch off. The whole procedure is illustrated in the 
flowchart of Figure 3. 
 
 
 
Figure 2. Portable System developed: (a) base of the system where piece 
with containers fits into the system, (b) piece with containers for mixture of 
blood and reagents, (c) web camera used to capture the image, (d) LEDs 
around and web camera in the centre, (e) base of the system that promote 
the mixture, (f) final system with button to change velocity, (g) final 
system with switch to switch on/off the system. 
 
The user friendly application where all the image 
processing techniques are included as well as the 
classification algorithm was developed in C# Language and 
XAML (Figure 4).  
 
 
Figure 3. Flowchart of the system developed. 
 
 
 
Figure 4. Application Developed. (a) Button to capture the image. (b) 
Button to process the image captured. (c) Button to send the results 
message. 
This application contains a button to capture the original 
image with the six containers, Figure 4 (a), a button to 
process the original image and give the blood type result, 
Figure 4 (b), and finally a button to send a message to the 
laboratory with the blood type result, Figure 4 (c).  
IV. 
RESULTS OBTAINED WITH THE DEVELOPED SYSTEM  
This section presents the results of phenotyping tests (A) 
and the results of ABO and Rh tests (B), obtained with the 
prototype developed. The blood samples tested were from 
donors from the Portuguese Blood Institute (IPST). 
 
A.  Results of phenotyping tests 
 
The methodology presented in this paper was tested and 
validated using several blood phenotypes from donors. This 
subsection presents the obtained results when applying the 
image processing techniques developed in images captured 
after the procedure of plate test (Section II). Figure 5 shows 
(a) 
(b) 
(c) 
(d) 
(e) 
(f) 
(g) 
(a) 
(b) 
(c) 
141
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-297-4
SENSORDEVICES 2013 : The Fourth International Conference on Sensor Device Technologies and Applications

six original images corresponding to the mixture of blood 
and the respective reagent, TransClone Anti-RH1 (D), 
TransClone Anti-RH2 (C), Transclone Anti-RH3 (E), 
TransClone Anti-RH4 (c), TransClone Anti-RH5 (e) and 
TransClone Anti-Kel1 (K), captured by the camera. Figure 6 
shows the images obtained after the application of image 
processing techniques and in Table I are summarized the 
quantified results. 
 
Figure 5. Images captured of blood/reagent mix for determination of Rh 
and Kell phenotype. 
 
 
 
Figure 6. Results of the application of the developed algorithm through the 
images of Figure 4. 
 
 
TABLE  I.     RESULTS OF THE DEVELOPED ALGORITHM THROUGH THE 
IMAGES OF FIGURE 5 
Figure 6 
Area 
Mean 
Value 
Standard 
Variation 
Minimal 
Value 
Maximal 
Value 
D 
3,19 
118,36 
29,09 
21,00 
181,00 
C 
2,08 
59,24 
3,08 
51,00 
71,00 
c 
1,98 
118,69 
39,32 
20,00 
184,00 
E 
2,67 
125,20 
44,91 
15,00 
195,00 
e 
3,75 
131,88 
29,30 
25,00 
195,00 
K 
3,18 
67,31 
5,70 
55,00 
86,00 
 
Analyzing Figure 5, one can see that agglutination 
occurred in images corresponding to phenotype test D, c, E 
and e (Standard Variation values highlighted in bold), and 
agglutination does not occur in the remaining images C and 
K. It can be observed in Table I, that when agglutination 
occurs, images D, c, E and e of Figure 6, present a standard 
deviation value higher than 16 (threshold established in 
previous studies [13] to detect the occurrence of 
agglutination). The standard deviation value is the threshold 
for determining the occurrence or non occurrence of 
agglutination. Thus, standard deviation value above 16 
indicates the occurrence of agglutination, while standard 
deviation values below 16, mean the non occurrence of 
agglutination in the analyzed image. Thus, given that 
agglutination occurred for phenotypes D, c, E and e, and 
agglutination was not observed for other phenotypes, C and 
K, the phenotype under analysis is then cEeK-D (confirmed 
by the analysis performed by the IPST).  
 
B. Results of ABO and Rh tests 
 
The proposed system allows also ABO and RH blood 
typing [12, 13].  In Figure 7, it is presented the original 
image of the containers captured after the mixture of blood 
sample and the specific reagents. Figure 8 presents the final 
image after the application of the developed image 
processing algorithm. TABLE  II presents the occurrence of 
agglutination in each container and the correspondent ABO-
Rh blood type. The agglutination occurred in Figure 8 with 
the reagents Anti-B, Anti-AB and Anti-D and not in Figure 
8 with the reagent Anti-A, meaning that in this blood 
sample are present the antigens of type B and D and not the 
antigens of type A. The blood type is then B positive. 
The determination of the occurrence of agglutination in 
the ABO-Rh blood test is also performed through the value 
of standard deviation. 
 
 
Figure 7.  Image captured of blood/reagent mix for determination of ABO 
and Rh. 
C 
D 
c 
E 
e 
K 
D 
C 
c 
E 
e 
K 
A 
B 
AB 
D 
142
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-297-4
SENSORDEVICES 2013 : The Fourth International Conference on Sensor Device Technologies and Applications

 
Figure 8. Results of the application of the developed algorithm through the 
images of Figure 6 
 
TABLE  II.    RESULTS OF THE DEVELOPED ALGORITHM THROUGH THE 
IMAGES OF FIGURE 6 
Figure 7 
Occurrence 
of 
Agglutination 
Blood 
Type 
A 
No 
 
B 
B 
Yes 
AB 
Yes 
D(Rh) 
Yes 
Positive 
 
 By observing TABLE  II, it is possible to conclude that 
the blood type resultant is B Positive, as agglutination 
occurred with the reagents anti-B, anti-AB and anti-D. 
V. 
CONCLUSION AND FUTURE WORK 
This work allows enforcing the validation of the use of 
the plate test and image processing techniques as a feasible 
methodology to blood typing. As in [13, 16-18], the plate 
test has proven to be adequate to detect the occurrence of 
agglutination, even if it is weak, and the image processing 
techniques developed allow a correct automatic detection of 
agglutination, permitting ABO-RH blood typing as well as 
the phenotypes of the patient.  
Once the system obtains results in a short time, about 5 
minutes in total, at a low cost and being portable, it is 
characterized by an innovative solution with commercial 
added value. The system can be either used for dual 
operation, mixture (low speed) and centrifuging (high 
speed), depending of the motor velocity selected. Due to its 
portability and fast response time it can be used in 
ambulances or other vehicles for emergency situations.In 
future, it is intended to include closed loop control to the 
illumination and the rotational speed of the motor as well as, 
introduce neural networks to improve the classifications of 
the developed system. With the neural networks it will be 
possible to classify blood types as well as pre-transfusion 
tests more efficiently, quickly and safely. 
 
 
ACKNOWLEDGMENT 
Thanks to the Portuguese Foundation for Science and 
Technology (FCT) for funding through the PhD scholarship 
SFRH/BD/81094/2011.  
This work is funded also by FEDER funds through the 
"Programa Operacional Factores de Competitividade - 
COMPETE" and by national funds by FCT- Fundação para 
a Ciência e a Tecnologia, project reference FCOMP-01-
0124-FEDER-022674. 
REFERENCES 
[1] R. S. Rod, P. Tate, and D. S. Trent, "Anatomina & 
Fisionlogia", Lusociencia, 6nd ed., Loures, 2005. 
[2] V. A. Hoffbrand, E. J. Pettit, and H. A. P. Moss, 
“Fundamentos em Hematologia”, Artmed, 4nd Edition., Porto 
Alegre, 2004. 
[3] R. Caquet, "Guia Prático Climpsi de Análises Clínicas", 1st 
ed., Lisboa, 2004. 
[4] S. L. Mitchell, J. B. Brain, and I. Bates, “Dacie and Lewis 
Practical Haematology”, Elsevier Health Sciences. 9th 
Edition. ISBN: 0-443-06377-X, 2001. 
[5] J. D. Roback, B. J. Grossman, T. Harris, and C. D. Hillyer, 
“Technical Manual”, AABB, 17th Edition, 2011. 
[6] C. D. Hillyer, L. E. Silberstein, P. M. Ness, K. C. Anderson, 
and J. D. Roback, 2007. Blood Banking and Transfusion 
Medicine Basic Principles and Practice. Churchill Livingstone 
Elsevier. 2nd Edition. ISBN-13: 978-0-443-06981-9 
[7] D. B. L. McClelland, “Handbook of Transfusion Medicine”, 
United Kingdom Blood Service, 4th Edition, 2007. ISBN-10 
0 
11 
3226772. 
Online: 
http://www.transfusionguidelines.org.uk/docs/pdfs/htm_editio
n-4_all-pages.pdf; retrieved: June, 2013 
[8] M. Cressiers, “Datasheet of Diamed Diaclon Anti-A, Diaclon 
Anti-B, Diaclon Anti-AB”, 2008. 
[9] M. Cressier, “Datasheet of Diamed-ID Micro Typing System, 
Card-ID”. Diaclon ABO\Rh for patients, 2008.  
[10] K. Bezerra, et al. “Advanced Design of a Mechatronic System 
for Human Blood Typing”, Romanian Review Precision 
Mechanics, Optics & Mecatronics, 2012. ISSN 1584 - 5982. 
[11] V. Moreira, A. Ferraz, V. Carvalho,  F. Soares, and J. 
Machado,  2012. Design of a Mechatronic System for Human 
Blood Typing in Emergency Situations, ETFA’2012 17th 
IEEE International Conference on Emerging Technologies & 
Factory Automation. September 17th to 21th. Kraków, 
Poland. 
[12] A. Ferraz, V. Moreira, D. Silva, V. Carvalho, and F. Soares, 
“Automatic System for Blood Type Classification Using 
Image 
Processing 
Techniques”, 
BIODEVICES 
2011 
International Joint Conference on Biomedical Engineering 
Systems and Technologies, 26-29 de January, 2011, Rome, 
Italy. 
[13] A. Ferraz, V. Carvalho, F. Soares, and C. P. Leão, 
“Characterization of Blood Samples Using Image Processing 
Techniques”, Sensors & Actuators: A. Physical, 2010. 
[14] A. B. Myhre, D. McRuer, “Human error – a significant cause 
of transfusion mortality”, Transfusion. vol. 40, 2000, pp. 879–
885. 
[15] A. E. Henneman, et al. “Increasing patient safety and 
efficiency in transfusion therapy using formal process 
definitions”, Transfus Med Rev, vol. 21, 2007, pp. 49–57. 
[16] A. Ferraz, V. Carvalho, and F. Soares, “Development of a 
Human 
Blood 
Type 
Detection 
Automatic 
System”, 
EUROSENSORS XXIV, 5 - 8 September. Linz, Austria, 
2010.  
A 
B 
AB 
D 
143
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-297-4
SENSORDEVICES 2013 : The Fourth International Conference on Sensor Device Technologies and Applications

[17] A. Ferraz, V. Carvalho, and P. Brandão, “Automatic 
Determination of Human Blood Types using Image 
Processing Techniques”, BIODEVICES 2010 International 
Conference on Biomedical Electronics and Devices 2010. 20 
– 23 January. Valence, Spain, 2010.  
[18] A. Ferraz, V. Carvalho, and P.Brandão, “Determinação 
Automática do Tipo Sanguíneo de Humanos Utilizando 
Técnicas de Processamento de Imagem”, CBIS`2008 XI 
Congresso Brasileiro de Informática em Saúde, 29 November 
- 3 December , Sao Paulo, Brazil, 2008. 
[19]  Bio-Rad, “Human Monoclonal IgM Antibodies”, 2003. 
Online: http://www.bio-rad.com/ retrieved: June, 2013 . 
[20] Sony Cyber-shot S750 Digital Camera, 2008. Online: 
http://store.sony.com/p/DSC-S750/en/p/DSCS750 retrieved: 
June, 2013 
[21] IMAQ, 
“IMAQ 
Vision 
Concepts 
Manual”, 
National 
Instruments, Austin, 2004. 
[22] T. Klinger, T, “Image Processing with LabVIEW and IMAQ 
Vision”, Prentice Hall, New Jersey, 2003.  
[23] G. C. Relf, “Image Acquisition and Processing with 
LabVIEW”, CRC Boca Raton, 2003. 
 
144
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-297-4
SENSORDEVICES 2013 : The Fourth International Conference on Sensor Device Technologies and Applications

