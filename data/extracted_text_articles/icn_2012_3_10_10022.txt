Band-Pass Filters for Direct Sampling Receivers
Pavel Zahradnik, Boris ˇSim´ak and Michal Kopp
Department of Telecommunication Engineering
Czech Technical University in Prague
Prague, Czech Republic
zahradni, simak, koppmich@fel.cvut.cz
Miroslav Vlˇcek
Department of Applied Mathematics
Czech Technical University in Prague
Prague, Czech Republic
vlcek@fd.cvut.cz
Abstract—A robust analytical design procedure for high per-
formance digital equiripple band-pass ﬁnite impulse response
ﬁlters for direct sampling receivers is introduced. The ﬁlters are
optimal in Chebyshev sense. The underlaying generating function
of the equiripple approximation is the Zolotarev polynomial. The
closed form solution provides a straightforward evaluation of the
ﬁlter degree and of the impulse response coefﬁcients from the
ﬁlter speciﬁcation. One example is included. The robustness of
the design procedure is emphasized.
Keywords-FIR ﬁlter; band-pass ﬁlter; equiripple approxima-
tion; Zolotarev polynomial; direct sampling; digital receiver;
I. INTRODUCTION
Direct sampling receivers are based on the sampling and
processing of the ampliﬁed radio-frequency (RF) signal in-
comming from the aerial. The selectivity in the RF signal
is obtained using narrow-band band-pass (BP) digital ﬁlters.
Because of the high ratio between the pass-band frequency and
the bandwidth of the ﬁlters, high performance digital ﬁlters
are required. Such ﬁlters can be used in the receivers with
direct intermediate frequency (IF) sampling and in frequency
analyzers as well. Because of the inherent stability and because
of the linear phase the digital ﬁnite impulse response (FIR)
ﬁlters are preferred. A ﬁlter is optimal in terms of its length
provided its frequency response exhibits an equiripple (ER)
behavior. In [1] we have introduced an analytical design
procedure for the digital ER notch FIR ﬁlters. Here, we present
an analytical design procedure for the ER BP FIR ﬁlters. The
proposed design procedure is based on Zolotarev polynomials
[2]-[5]. We present here the closed form solution for the design
of ER BP FIR ﬁlters. It includes the degree equation and
formulas for the robust evaluation of the impulse response
coefﬁcients of the ER BP FIR ﬁlter.
II. ZERO PHASE TRANSFER FUNCTION
We assume the impulse response h(k) with odd length N =
2n + 1 with even symmetry
a(0) = h(n) , a(k) = 2h(n − k) = 2h(n + k) , k = 1 ... n .
(1)
The transfer function of the ﬁlter is
H(z) =
2n
X
k=0
h(k) z−k
= z−n
"
h(n) + 2
n
X
k=1
h(n ± k) 1
2

−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
5
10
15
20
Z12,6(w, 0.79023439)
w
w1
w2
wm
ym
Fig. 1.
Zolotarev polynomial Z12,6(w, 0.79023439).
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−60
−50
−40
−30
−20
−10
0
20 log |H(ejωT )|[dB]
ωT /π
as[dB]
∆ωT /π
ωmT
π
Fig. 2.
Amplitude frequency response 20 log |H(ejωT )| [dB] corresponding
to the Zolotarev polynomial from Fig. 1.
(1847-1878) derived the general solution of this approximation
problem in terms of Jacobi elliptic functions [3]-[5]
Zp,q(w, κ) = (−1)p
2
(7)
×




H(u − p
n K(κ))
H(u + p
n K(κ))


n
+


H(u + p
n K(κ))
H(u − p
n K(κ))


n
 .
The factor (−1)p/2 appears in (7) as the Zolotarev polynomial
alternates (p + 1)−times in the interval (w2, 1). The variable
u is expressed by the incomplete elliptical integral of the ﬁrst
kind
u =F


sn
 p
n K(κ)|κ
v
u
u
t
1 + w
w + 2 sn2
 p
nK(κ)|κ

− 1
|κ


 .
(8)
The function H (u ± (p/n) K(κ)) is the Jacobi Eta function,
sn(u|κ), cn(u|κ), dn(u|κ) are Jacobi elliptic functions, K(κ)
is the quarter-period given by the complete elliptic integral of
the ﬁrst kind and F(φ|κ) is the incomplete elliptic integral
of the ﬁrst kind. The degree of the Zolotarev polynomial is
n = p+q. A comprehensive treatise of Zolotarev polynomials
was published in [5]. It includes the analytical solution of the
coefﬁcients of Zolotarev polynomials, the algebraic evaluation
of the Jacobi Zeta function Z( p
nK(κ)| κ) and of the elliptic
integral of the third kind Π(σm, p
nK(κ)| κ). The Jacobi Zeta
function and the elliptic integral of the third kind are connected
by the formula
Π(u, u0| κ) = 1
2 ln Θ(u − u0)
Θ(u + u0) + uZ(u0| κ)
(9)
where
u0 =
p
p + q K(κ)
(10)
and Θ(w) is the Jacobi Theta function [4]. The position wm
of the maximum value ym = Zp,q(wm, κ) is
wm = w1 + 2
sn
 p
nK(κ)|κ

cn
 p
nK(κ)|κ

dn
 p
nK(κ)|κ

Z
 p
nK(κ)|κ

(11)
where the edges of the lobe are
w1 = 1 − 2 sn2  p
nK(κ)|κ

(12)
w2 = 2 sn2  q
nK(κ)|κ

− 1 .
(13)
The relation for the maximum value ym
ym = cosh 2n

σmZ( p
nK(κ)|κ) − Π(σm, p
nK(κ)|κ)

(14)
is useful in the normalization of Zolotarev polynomials. The
degree of the Zolotarev polynomial Zp,q(w, κ) is expressed by
the degree equation
n ≥
ln(ym +
p
y2m − 1)
2σmZ( p
nK(κ)|κ) − 2Π(σm, p
nK(κ)|κ) .
(15)
The auxiliary parameter σm is given by the formula
σm = F
 
arcsin
 
1
κ sn

Based on the differential equation (17) we have derived the
recursive algorithm for the evaluation of the impulse response
h(k) corresponding to the Zolotarev polynomial Zp,q(w, κ)
based on its expansion into Chebyshev polynomials of the
ﬁrst kind
Zp,q(w, κ) =
n
X
k=0
a(k)Tk(w) .
(18)
The corresponding recursive algorithm is summarized in
Table I.
IV. DESIGN PROCEDURE
There are two goals in the design of any ﬁlter. The ﬁrst
one is to obtain the minimal ﬁlter degree n (or minimal ﬁlter
length N) satisfying the ﬁlter speciﬁcation while the second
one is to evaluate the impulse response h(k) of the ﬁlter. The
ER BP FIR ﬁlter is speciﬁed by the pass-band frequency ωmT
and by the bandwidth ∆ωT for the attenuation as [dB] in the
stop-bands (Fig. 2). The proposed design procedure consists
of several steps as follows:
1) Specify the pass-band frequency ωmT (or fm), width of
the pass-band ∆ωT (or ∆f) and the attenuation in the
stop-bands as [dB] (Fig. 2). For the non-normalized fre-
quencies fm and ∆f specify additionally the sampling
frequency fs.
2) Evaluate the normalized frequencies
ωmT = π fm
fs
2
, ∆ωT = π ∆f
fs
2
.
(19)
if the ﬁlter is speciﬁed by the non-normalized ones.
3) Calculate the band edges
ω2T = ωmT − ∆ωT
2
, ω1T = ωmT + ∆ωT
2
. (20)
4) Evaluate the Jacobi elliptic modulus κ
κ =
s
1 −
1
tan2(ϕ1) tan2(ϕ2)
(21)
for the auxiliary parameters ϕ1 and ϕ2
ϕ1 = ω1T
2
, ϕ2 = π − ω2T
2
.
(22)
5) Calculate the rational values p/n and q/n
p
nK(κ) = F(ϕ1|κ) ,
q
nK(κ) = F(ϕ2|κ) .
(23)
6) Determine the required maximum value ym
ym =
2
100.05as[dB] .
(24)
7) Calculate and round up the minimum degree n required
to satisfy the ﬁlter speciﬁcation using the degree equa-
tion (15). For the algebraic evaluation of the Jacobi Zeta
function Z( p
nK(κ)| κ) and of the elliptic integral of the
third kind Π(σm, p
nK(κ)| κ) in the degree equation (15)
use the algebraical procedures [5].
8) Calculate the integer values p and q of the Zolotarev
polynomial Zp,q(w, κ)
p =

nF(ϕ1|κ)
K(κ)

,
q =

nF(ϕ2|κ)
K(κ)

.
(25)
The brackets [ ] in (25) stand for rounding.
9) For the values p, q, κ and ym evaluate the impulse
reponse h(k) algebraically using the procedure summa-
rized in Tab. I.
V. EXAMPLE OF THE DESIGN
Design the ER BP FIR ﬁlter speciﬁed by the pass-band
frequency fm = 10.7 MHz and by the bandwidth ∆f = 50
kHz for minimal attenuation in the stop-band as = −80 dB.
The speciﬁed sampling frequency is fs = 30 MHz.
From the ﬁlter speciﬁcation we get ωmT/π = 0.713 and
∆ωT/π = 0.003 (19). Further we get κ = 0.16239149 (21),
n = 2026 (15), p = 1445 and q = 581 (25). The ﬁlter
length is N = 4053 coefﬁcients. The actual attenuation in the
stop-bands is as act = −80.13 dB. The amplitude frequency
response of the ER BP FIR ﬁlter is shown in Fig. 3. A
detailed view of its passband is shown in Fig. 4.
0
5
10
15
−100
−90
−80
−70
−60
−50
−40
−30
−20
−10
0
f [MHz]
20 log |H(ej2πf/fs )| [dB]
Fig. 3.
Amplitude frequency response 20 log |H(ej2πf/fs)| [dB].
VI. ROBUSTNESS OF THE DESIGN PROCEDURE
In order to demonstrate the robustness of the presented
design procedure, let us design the ﬁlter which was speciﬁed
in our example, however, with modiﬁed bandwidth which is
now speciﬁed by ∆f = 5 kHz.
We get κ = 0.05166139 (21), n = 20248 (15), p = 14444
and q
=
5804 (25). The ﬁlter length is N
=
40497
coefﬁcients. The actual attenuation in the stop-bands is
as act
= −80.04 dB. The amplitude frequency response
of the ER BP FIR ﬁlter is shown in Fig. 5. A detailed
46
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-183-0
ICN 2012 : The Eleventh International Conference on Networks

TABLE I
ALGORITHM FOR THE EVALUATION OF THE IMPULSE RESPONSE h(k).
given
p, q, κ, ym
initialisation
n = p + q
w1 = 1 − 2 sn2  p
n K(κ)|κ

w2 = 2 sn2  q
n K(κ)|κ

− 1
wa = w1 + w2
2
wm = w1 + 2
sn
 p
n K(κ)|κ

cn
 p
n K(κ)|κ

dn
 p
nK(κ)|κ

Z
 p
n K(κ)|κ

α(n) = 1
α(n + 1) = α(n + 2) = α(n + 3) = α(n + 4) = α(n + 5) = 0
body
(for
m = n + 2
to
3)
8c(1) = n2 − (m + 3)2
4c(2) = (2m + 5)(m + 2)(wm − wa) + 3wm[n2 − (m + 2)2]
2c(3) = 3
4[n2 − (m + 1)2] + 3wm[n2wm − (m + 1)2wa] − (m + 1)(m + 2)(w1w2 − wmwa)
c(4) = 3
2(n2 − m2) + m2(wm − wa) + wm(n2w2
m − m2w1w2)
2c(5) = 3
4[n2 − (m − 1)2] + 3wm[n2wm − (m − 1)2wa] − (m − 1)(m − 2)(w1w2 − wmwa)
4c(6) = (2m − 5)(m − 2)(wm − wa) + 3wm[n2 − (m − 2)2]
8c(7) = n2 − (m − 3)2
α(m − 3) =
1
c(7)
6
X
µ=1
c(µ)α(m + 4 − µ)
(end
loop
on
m)
normalisation
s(n) = α(0)
2
+
n
X
m=1
α(m)
a(0) = (−1)p α(0)
2s(n)
(for
m = 1
to
n)
a(m) = (−1)p α(m)
s(n)
(end
loop
on
m)
impulse response
h(n) = ym − a(0)
ym + 1
(for
m = 1
to
n)
h(n ± m) = −
a(m)
2(ym + 1)
(end
loop
on
m)
47
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-183-0
ICN 2012 : The Eleventh International Conference on Networks

10.65
10.66
10.67
10.68
10.69
10.7
10.71
10.72
10.73
10.74
−100
−90
−80
−70
−60
−50
−40
−30
−20
−10
0
f [MHz]
20 log |H(ej2πf/fs )| [dB]
Fig. 4.
Detailed view of the pass-band.
0
5
10
15
−100
−90
−80
−70
−60
−50
−40
−30
−20
−10
0
f [MHz]
20 log |H(ej2πf/fs )| [dB]
Fig. 5.
Amplitude frequency response 20 log |H(ej2πf/fs)| [dB].
view of its passband is shown in Fig. 6.
In order to
point out the robustness of our design procedure, let us do
comparative designs of both ﬁlters presented above by the
established numerical Parks-McClellan procedure [6] which
is implemented e.g. in the Matlab function ﬁrgr. The ﬁlter
with the length of 4053 coefﬁcients from our example can
be designed using the function call [h,err,res]=ﬁrgr(4052,[0
10.675 10.7 10.725 15]/15,[0 0 1 0 0],’n’ ’n’ ’s’ ’n’
’n’) easily. Note that the Matlab function firgr returns
ﬁlters with different normalization of the ripples of the
corresponding frequency response. Except for the difference
in the normalization, the obtained results are identical. On
the other hand the design of the ﬁlter with the length of
40497 coefﬁcients speciﬁed in this section cannot be designed
using the function call [h,err,res]=ﬁrgr(40496,[0 10.6975
10.7 10.7025 15]/15,[0 0 1 0 0],’n’ ’n’ ’s’ ’n’ ’n’) as it
collapses (Matlab R2010b) because of numerical problems.
We assume that this failure is caused by the failed numerical
evaluation of the densely located roots (isoextremal values)
of the optimized function. To our knowledge, our design
10.695
10.696
10.697
10.698
10.699
10.7
10.701
10.702
10.703
10.704
−100
−90
−80
−70
−60
−50
−40
−30
−20
−10
0
f [MHz]
20 log |H(ej2πf/fs )| [dB]
Fig. 6.
Detailed view of the pass-band.
procedure presented here has no parallel in the design of
high performance ER BP FIR ﬁlters with the length beyond
several thousands of coefﬁcients. Further note that in the
Parks-McClellan design procedure the length of the ﬁlter is
an input argument, not the result of the design.
VII. IMPLEMENTATION OF THE FILTER
There are various ways for implementing of FIR ﬁlters
in real time available. For high order ﬁlters, the digital
signal processors (DSP) and the ﬁeld programmable gate
arrays (FPGA) dominate. We prefer the ﬁlter implementation
using digital DSPs over the implementation using FPGAs
mainly because it is a less time consuming process. The
band-pass FIR ﬁlter with the length of 4053 coefﬁcients from
our example requires 122 billions multiply-and-accumulate
(GMACs) operations per second. The adequate DSP is
the eight-core DSP
TMS320C6678 [7]
which provides
320GMACs operations per second in the 16-bit ﬁxed point
arithmetics. For the real-time implementation of the ﬁlter we
use the DSP Evaluation Module TMDXEVM6678 (Fig. 7).
The implementation of the ﬁlter in the IEEE-754 compliant
single precision ﬂoating point arithmetics would require a
two chip solution based on the DSP TMS320C6678 which
provides 160 billions ﬂoating point operations (GFLOPs) per
second per chip, or a single chip solution based on the 32-core
DSP TMS320TCI6609 [8]. The implementation of the ﬁlter
with the length of 40497 coefﬁcients from previous section
requires 1215 GMACs and consequently its implementation
would require a multi-chip solution, e.g. three chip solution
based on the 32-core DSP TMS320TCI6609.
VIII. CONCLUSIONS
We have presented an analytical design of high performance
digital equiripple band-pass ﬁnite impulse response ﬁlters. In
contrast to the established numerical design procedures the
proposed design method is based on the generating polynomial
48
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-183-0
ICN 2012 : The Eleventh International Conference on Networks

Fig. 7.
Evaluation Module TMDXEVM6678.
and provides a formula for the degree of the ﬁlter and formulas
for the evaluation of the coefﬁcients of the impulse response
of the ﬁlter. The demonstrated robustness is another advantage
of the proposed design method.
ACKNOWLEDGEMENTS
This activity was thankfully supported by the grant No.
VG20102015053, Ministry of the Interior, Czech Republic and
by Texas Instruments, Inc.
REFERENCES
[1] P. Zahradnik, M. Vlˇcek, Fast Analytical Design Algorithms for FIR Notch
Filters, IEEE Transactions on Circuits and Systems. March 2004 , Vol.
51, No. 3, pp. 608 - 623.
[2] N. I. Achieser, ¨Uber einige Funktionen, die in gegebenen Intervallen am
wenigsten von Null abweichen, Bull. de la Soc. Phys. Math. de Kazan,
Vol. 3, pp. 1 - 69, 1928.
[3] D. F. Lawden Elliptic Functions and Applications Springer-Verlag, New
York Inc., 1989.
[4] M. Abramowitz, I. Stegun, Handbook of Mathematical Function, Dover
Publication, New York Inc., 1972.
[5] M. Vlˇcek, R. Unbehauen, Zolotarev Polynomials and Optimal FIR Filters,
IEEE Transactions on Signal Processing,
Vol.47, No.3, pp. 717-730,
March 1999.
[6] J. H. Mc Clellan, T. W. Parks, L. R. Rabiner, FIR Linear Phase Filter
Design Program, Programs for Digital Signal Processing. newblock New
York: IEEE Press, 1979.
[7] www.ti.com/product/tms320c6678
[8] www.ti.com/lit/ml/sprt619/sprt619.pdf
49
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-183-0
ICN 2012 : The Eleventh International Conference on Networks

