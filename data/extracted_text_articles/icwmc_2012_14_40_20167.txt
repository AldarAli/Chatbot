Joint Source-Relay Precoding with MMSE-based
Interference Suppression in two-way MIMO
Amplify and Forward Relays
Sundar Aditya
Ming Hsieh Department of Electrical Engineering
University of Southern California
Los Angeles, CA 90089, USA
Email: sundarad@usc.edu
Rajeshwari S. S, K. Giridhar
Department of Electrical Engineering
Indian Institute of Technology Madras
Chennai - 600036, India
Email: {rajeshwariss, giri}@tenet.res.in
Abstract—In this paper, we consider a two-way multiple
input
multiple
output
(MIMO)
Amplify-and-Forward
(AF)
relay system, where interference is observed at the relay
node during the multiple access (MAC) phase. For such a
scenario, two new joint source-relay precoding algorithms with
interference suppression are proposed and their performance
analyzed through simulation results. These linear minimum
mean-squared error (MMSE) based receiver algorithms provide
acceptable error rate performance even in the presence of
strong interference. Additionally, the effect of number of relay
antennas and the number of interference streams on the overall
diversity of the system is also investigated. We show that it is
possible to handle interference at the relay node at the cost of
losing some of the diversity gain offered by the extra antennas
available at the relay.
Index Terms—Two-way MIMO relay, Amplify-and-Forward,
MMSE Interference Suppression, Joint Source-Relay Precoding
I. INTRODUCTION
The use of relays in future wireless networks as a means to
extend coverage as well as to improve the overall spectral
efﬁciency has been gaining considerable attention recently.
The principle of two-way relaying makes the use of relays
spectrally efﬁcient in spite of the additional hop, thus making
it suitable for mass deployment in future wireless networks,
where improving overall spectral efﬁciency is one of the goals.
While it is as yet not clear how relays will ﬁt into the overall
scheme of things in upcoming wireless networks, what can be
inferred to a certain degree of conﬁdence is that relays will
mostly be operational in interference limited environments.
One such plausible interference limited scenario is when a
base-station (BS) acts as a relay between a user-pair and also
receives information on the uplink from some other user, as
illustrated in Fig. 1. To the user pair A, B (also referred to
as sources) using the BS as a relay, the signal received by
the BS from a different user C appears as interference. This
is an example of interference affecting the performance of a
relay during the MAC phase. A situation where interference is
observed during the broadcast phase is shown in Fig. 2, where
the user B sees interference from a neighboring BS serving
Fig. 1.
Interference during MAC phase
Fig. 2.
Interference during broadcast phase
its user D. It is important to observe from Fig. 1 and Fig.
2 that the cause of interference in the MAC and broadcast
phases are different. Hence, MAC phase interference has an
entirely different characteristics when compared to broadcast
phase interference. Thus, the two kinds of interference are
independent and therefore the two problems can be studied
separately.
339
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

In this paper, we focus on the case where the performance of
a two-way AF relay performance is hampered by interference
during the MAC phase (Fig. 1). For such a situation, we
are interested in devising an effective method to suppress the
detrimental impact of interference. Furthermore, if all nodes
have multiple antennas, additional gains can be achieved by
means of MIMO precoding at both source and relay. Thus,
in this work, we focus on the problem of joint source-relay
precoding with interference suppression.
A. Prior Art
The joint design of source and relay precoders, along with
source decoders is considered in [1] for a noise-limited system
where only one stream of data is sent between the two com-
municating nodes utilizing the multi-antenna relay. However,
with multi-antenna source and relay nodes, we would also like
to transmit more than one stream of data from the sources. The
problem of transmitting multiple streams has been studied in
[2], where the source and relay precoders and decoders have
been jointly optimized according to the AMSE (Arithmetic
sum of Mean-Squared Error) as well as the ABER (Arithmetic
sum of Bit-Error Rate) criteria for a purely noise-limited
system without considering co-channel interference during
the MAC phase. To the best of our knowledge, interference
management in two-way MIMO relays has not been well-
explored. Interference in MIMO relays has been handled in
[3] in the limited context of separating the signal streams
of multiple user pairs which are simultaneously using the
same relay. In this work, we use a more generic model of
interference and make an attempt to extend the framework
proposed in [2] to cover the case where interference is also
present in the system by. The key conclusion of this paper
is that the joint source-relay precoding scheme designed for
noise-limited systems in [2] can be used even in the presence
of co-channel interference during the MAC phase as long
as the relay performs MMSE-based interference suppression,
for which only the knowledge of second-order statistics of
interference is required.
B. Notation
Throughout this work, bold upper-case letters denote matri-
ces (e.g., X, Y) while bold lower-case letters denote vectors
(e.g., x, y). (.)T , (.)H and (.)−1 denote the transpose, her-
mitian (complex conjugate-transpose) and inverse of a matrix
while Tr{.} and E{.} represent the trace of a matrix and the
expectation operator, respectively. CWGN stands for Circular
White Gaussian Noise and CN ∼ (µ, K) represents a complex
Gaussian random vector with mean µ and covariance matrix
K.
This paper is divided into ﬁve sections. Section II details
the signal model used, following which the joint source-
relay MIMO precoding framework is presented in Section III.
We back our hypothesis with simulation results presented in
Section IV, and ﬁnally, Section V concludes the paper.
II. SIGNAL MODEL
We interest ourselves in the problem where two multi-
antenna transceiver nodes, A and B communicate with each
other via an intermediate relay R. Let MA, MB and MR
denote the number of antennas at A, B and R, respectively.
Such a conﬁguration shall henceforth be referred to as a MA−
MR −MB system. Let HA ∈ CMR×MA and HB ∈ CMR×MB
represent the channels A −→ R and B −→ R, respectively.
Channel reciprocity is assumed to hold, whereby the channels
R −→ A and R −→ B are represented by HA
T and
HB
T , respectively. A and B transmit LA and LB streams of
data, respectively, where LA ≤ min(MR, min(MA, MB)) and
LB ≤ min(MR, min(MB, MA)). The vectors sA ∈ CLA×1
and sB
∈ CLB×1 denote the symbols transmitted by A
and B, respectively, and are assumed to contain indepen-
dent, unit-energy symbols. The MIMO nature of the links
can be exploited by performing precoding at A and B. Let
FA ∈ CMA×LA and FB ∈ CMB×LB be the precoders used
by A and B, respectively. Therefore, the signal at R seen after
the ﬁrst phase (MAC phase) is given by
yR = HAFAsA + HBFBsB + z + ηR
(1)
where z denotes the interference seen at the relay and ηR ∼
CN(0, σ2
RIMR) is the CWGN at the relay. We model the
interference as streams of data transmitted by nodes other than
A or B, i.e.,
z =
k
X
i=1
Hisi
(2)
where we assume the presence of k streams of interference
(k ≥ 1), and Hi ∈ CMR×1 and si ∈ C respectively denote the
channel from the kth interference stream to R, and the symbol
transmitted by the kth interference stream. Additionally, FA
and FB satisfy the following constraints
Tr{FAFA
H} ≤ PA
(3)
Tr{FBFB
H} ≤ PB
(4)
where PA and PB represent the maximum average transmit
powers at A and B, respectively. The signal yR in (1) is
ampliﬁed at R using the relay ampliﬁcation matrix G.
˜yR = GyR
(5)
This signal ˜yR satisﬁes the following power constraint
Tr(E{˜yR˜yR
H}) ≤ PR,
(6)
where PR is the maximum power available at R.
In the second phase (broadcast phase), the relay signal ˜yR
is transmitted to both A and B. The signals received at A and
340
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

B are as follows
yA = HA
T ˜yR + ηA
= HA
T GHAFAsA
|
{z
} +HA
T GHBFBsB + HA
T Gz
+ HA
T GηR + ηA
(7)
yB = HB
T ˜yR + ηB
= HB
T GHAFAsA + HB
T GHBFBsB
|
{z
} +HB
T Gz
+ HB
T GηR + ηB
(8)
Here, ηA ∼ CN(0, σ2
AIMA) and ηB ∼ CN(0, σ2
BIMB) denote
CWGN at A and B, respectively, while the highlighted terms
in (7) and (8) represent the self-interference seen at A and
B, respectively. If G and HA are known at A, then the self-
interference seen by A can be subtracted, and similarly an
equivalent condition holds at B too. We assume A, B and R to
have perfect CSI of HA and HB. Under such an assumption,
it shall be seen that G can be computed in a decentralized
manner at all the 3 nodes. The signals of interest therefore at A
and B, after cancelling the back-propagating self-interference
are as follows
˜yA = HA
T GHBFBsB + HA
T Gz + HA
T GηR + ηA
(9)
˜yB = HB
T GHAFAsA + HB
T Gz + HB
T GηR + ηB (10)
A and B employ linear receivers DA and DB to get their
respective estimates of sB and sA.
ˆsB = DA˜yA
(11)
ˆsA = DB˜yB
(12)
III. JOINT SOURCE-RELAY MIMO PRECODING
From (9) and (11), the expression for the MSE matrix at A
is given by
MSEA = E{(sB − ˆsB)(sB − ˆsB)H}
= I + DAE{˜yA ˜yH
A }DA
H − DAHA
T GHBFB
− (HA
T GHBFB)HDA
H
(13)
where ˜yA is as given in (9). For the rest of this section, we
consider node A while presenting our analysis. The results
for B can be obtained quite easily by the symmetry of the
problem. For ﬁxed G, FA and FB, the optimal linear receiver
DA in terms of minimizing the MSE can be obtained by
evaluating ∇DA (MSEA) = 0, which yields the familiar
Wiener-ﬁlter solution.
DA = (HA
T GHBFB)HE{˜yA ˜yH
A }−1
= (HA
T GHBFB)H[(HA
T GHBFB)(HA
T GHBFB)H
+ (HA
T G)Ri+n(HA
T G)H + σ2
aIMA]−1
(14)
where Ri+n = E{zzH} + σ2
RIMR is the covariance matrix of
the interference plus noise, at the relay. It is demonstrated in
[4] that the BER is a convex increasing function of the MSE
for small values of the argument (for BER less than 2 × 10−2
as a thumb rule). Thus, we are justiﬁed in our choice of a
linear MMSE receiver as it is not only easy to implement but
also ensures good BER performance for most practical cases.
Substituting (14) in (13) and using the matrix inversion
lemma, the following expression is obtained for the MSE
matrix at A
MSEA = (I + FB
HRBFB)−1
(15)
where RB
= (HA
T GHB)H[(HA
T G)Ri+n(HA
T G)H +
σ2
AIMA]−1(HA
T GHB) We now focus our attention to the
design of FA, FB and G according to the AMSE and ABER
optimization criteria, as speciﬁed in [2].
The AMSE and ABER objective functions have the
following form:
(i) AMSE
fAMSE = Tr{MSEA} + Tr{MSEB}
(16)
(ii) ABER
fABER =
LB
X
i=1
BERAi +
LA
X
j=1
BERBj
=
LB
X
i=1
Q(
q
2(MSE−1
Ai,i − 1))+
LA
X
i=1
Q(
q
2(MSE−1
Bi,i − 1) )
(17)
where BERAi and BERBj respectively denote the BERs for
the ith stream at A and the jth stream at B, and Q(.) denotes
the Q-function with (17) being valid for QPSK constellation
[5] at A and B, and the summation is over the number of
streams transmitted by A and B.
We proceed in an iterative manner to converge upon the
source precoders as well as G. Firstly, for ﬁxed G, the
optimization problems that need to be solved for the AMSE
and ABER criteria are as follows
(i) AMSE criterion
min
Fi|i=A,B fAMSE
subject to
Tr{FiFi
H} ≤ Pi
(18)
(ii) ABER criterion
min
Fi|i=A,B fABER
subject to
Tr{FiFi
H} ≤ Pi
(19)
For ﬁxed G, the design of source precoders FA and FB
becomes decoupled. We present the solution for FB. The
solution for FA can be obtained in an identical manner. The
optimal precoder structures for (18) and (19), as demonstrated
in [2], is given by
341
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

(i) AMSE
FB = UBΣB
(20)
(ii) ABER
FB = UBΣBVH
(21)
Here, UB
∈ CMB× LB contains the left eigenvectors
corresponding to the highest LB eigenvalues of RB in as-
cending order, and ΣB ∈ CLB×LB denotes the diagonal
matrix containing the corresponding powers allocated to the
various streams. The water-ﬁlling algorithm used to allocate
the powers is given in [4] and V ∈ CLB×LB is any unitary
matrix like the DFT matrix or the Hadamard matrix.
Given FA and FB, fAMSE and fABER become non-linear
functions of G, with quadratic constraints involving G. A
closed form solution for G is as yet unknown. Thus, we resort
to numerical techniques and propose two SQP (sequential
quadratic programming) based methods for the design of the
relay precoder - i) with implicit interference suppression and
ii) with explicit interference suppression.
A. Relay Precoder with Implicit Interference Suppression
In the analysis presented so far, the effects of interference
suppression as well as relay precoding are combined into one
effective relay ampliﬁcation matrix G. Thus, the optimization
problems for the AMSE and the ABER criteria have the
following form
(i) AMSE criterion
min
G
fAMSE
subject to
Tr{G[HAFAFA
HHA
H + HBFBFB
HHB
H
+ Ri+n]GH} ≤ PR
(22)
(ii) ABER criterion
min
G
fABER
subject to
Tr{G[HAFAFA
HHA
H + HBFBFB
HHB
H
+ Ri+n]GH} ≤ PR
(23)
For (22) and (23), the solution for G is obtained through
SQP. The joint source-relay precoding algorithm with implicit
interference suppression is summarized in Table I.
B. Relay Precoder with Explicit Interference Suppression
Since a closed form solution for the relay precoder G is
unavailable, the interference suppressing capabilities of the
relay precoders obtained as solutions to (22) and (23) may
be restricted. In this section, we propose the use of MMSE-
based interference suppression at the relay to explicitly take
care of the interference, before amplifying the desired signal
Step 1
Set k = 1. Fix Gk = γRIMR, FAk = γAIMA and FBk =
γBIMB , where γA =
p
PA/MA, γB =
p
PB/MB and γR =
q
PR/Tr{HAFAFA
HHA
H + HBFBFB
HHB
H + Ri+n}
(uniform power allocation).
Step 2
Compute FBk+1 and FAk+1 using Gk, HA and HB ac-
cording to (20) and (21) for the AMSE and ABER criterion,
respectively.
Step 3
Using FAk+1 and FBk+1, solve for Gk+1 by SQP as shown
in (22) and (23), for the AMSE and ABER criterion, respectively.
Step 4
If |fAMSEk+1 − fAMSEk| ≥ ϵ for the AMSE criterion, or if
|fABERk+1 − fABERk| ≥ ϵ for the ABER criterion, then set
k = k + 1 and repeat from step 2 onwards.
TABLE I
SUMMARY OF JOINT SOURCE-RELAY PRECODING WITH IMPLICIT
INTERFERENCE SUPPRESSION
components using the relay precoder G. The signals of interest
therefore at A and B at the end of the second phase are as
follows:
˜yA = HA
T GWHBFBsB + HA
T GWz + HA
T GWηR + ηA
(24)
˜yB = HB
T GWHAFAsA + HB
T GWz + HB
T GWηR + ηB
(25)
where W denotes the MMSE-interference suppression matrix,
acting on the signal at the relay at the end of the ﬁrst phase
before the relay precoder G. W has the following form:
W = (HAFAFA
HHA
H + HBFBFB
HHB
H)Ri+n
−1 (26)
The solutions for FA, FB, G and W are jointly computed
iteratively in a manner similar to the one described in the
above section. For ﬁxed G and W, the source precoder FB
is computed as given in (20) and (21), except that RB has the
following structure instead of the one given in the previous
section
RB = (HA
T GWHB)H[(HA
T GW)Ri+n(HA
T GW)H +
σ2
AIMA]−1(HA
T GWHB)
The expression for FA
can be obtained in a similar
manner as well. For ﬁxed FA and FB, W can be computed
as given in (26), and G can then be computed by SQP
using the knowledge of FA, FB and W, similar to (22)
and (23). The joint source-relay precoding algorithm with
explicit MMSE-based interference suppression at the relay is
summarized in Table II.
It can be observed in both the above-mentioned methods
that, with perfect knowledge of the channels HA and HB,
all three nodes can independently run the above mentioned
algorithms at their end and arrive at the same set of source
and relay precoders. Of course, the second-order statistics of
the interference, i.e., Ri+n, need to be made available at
both A and B as well. However, since the covariance matrix
is Hermitian Toeplitz, the amount of overhead required to
communicate it is quite small and can be easily accomplished.
342
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

Step 1
Set k
=
1. Fix FAk
=
γAIMA, FBk
=
γBIMB ,
where γA =
p
PA/MA, γB
=
p
PB/MB. Set Wk
=
(HAFAkFAH
k HAH
+
HBFBkFBH
k HBH)Ri+n−1.
Fix
Gk
=
γRIMR,
where
γR
=
r
PR
T r{Wk[HA FA FA
HHA
H+HB FB FB
HHB
H+Ri+n]WH
k } .
Step 2
Compute FBk+1 and FAk+1 using Gk, Wk, HA and HB
according to (20) and (21), for the AMSE and ABER criterion,
respectively.
Step 3
Using FAk+1 and FBk+1, compute Wk+1 as given in (26).
Step 4
Using FAk+1, FBk+1 and Wk+1, solve for bGk+1 by SQP
as shown in (22) and (23), for the AMSE and ABER criterion,
respectively.
Step 5
If |fAMSEk+1 − fAMSEk| ≥ ϵ for the AMSE criterion, or if
|fABERk+1 − fABERk| ≥ ϵ for the ABER criterion, then set
k = k + 1 and repeat from step 2 onwards.
TABLE II
SUMMARY OF JOINT SOURCE-RELAY PRECODING WITH EXPLICIT
(MMSE) INTERFERENCE SUPPRESSION
IV. SIMULATION RESULTS
In this section, we compare the relative performance of
implicit and explicit interference suppression at the relay
using simulation results. The simulations have been carried
out using MATLAB. For a 2 − 4 − 2 case, the MSE per-
formance of both methods is shown in Fig. 3 for AMSE-
based precoding. Here, A and B, each having 2 antennas,
transmit 2 streams of information each to the relay during
the ﬁrst phase (LA = LB = 2), along with the presence
of a single interferer who is also transmitting 2 streams of
information. Hence, the relay, with 4 antennas, receives 6
streams of information during Phase 1. For the same 2−4−2
conﬁguration, Fig. 4 contains the BER performance of both
methods for ABER precoding. For the simulations, Rayleigh
fading channels have been assumed for HA, HB and Hi
(all ∈ C4×2) with all channel coefﬁcients being drawn from
CN ∼ (0, 1). A and B use QPSK constellation for their
symbols sA and sB (∈ C2×1) and equal power constraints
are assumed at all 3 nodes (PA = PB = PR). The interferer
transmits symbols si ∈ C(2x1) having the following property:
E{sisiH} = PintfI, where Pintf denotes the interferer’s
power and I, the identity matrix. SIR has been deﬁned as
10 log(PA/Pintf). Additionally, equal noise ﬂoors are also
assumed at A, B and R (σ2
A = σ2
B = σ2
R =
Pintf
1000 ), with
the noise ﬂoor being 30dB below Pintf in order to make
the system interference-limited. The simulation results have
been obtained by averaging over 1000 independent channel
realizations.
We observe from Fig. 3 and Fig. 4 that explicit MMSE-
based interference suppression at the relay yields better BER
and MSE performance when compared to implicit interference
suppression using SQP based relay precoders. It can also be
observed from the BER curves in Fig. 4 that a 2−4−2 system
is capable of sending 2 streams of information each from A
and B in addition to suppressing 2 streams of interference.
Fig. 3.
MSE performance of Implicit and Explicit Interference Suppression
at the relay
Fig. 4.
BER performance of Implicit and Explicit Interference Suppression
at the relay
While it is well known that a base station with 4 antennas can
handle 4 streams of information in the uplink, it can be gauged
from Fig. 4 that when acting as a relay between 2 user pairs, a
base station with 4 antennas is capable of handling 6 streams
of information on the uplink. Thus, it is of interest to study
the effect of number of relay antennas on the diversity order
that can be achieved as far as BER performance is concerned.
A. Impact of Relay Antennas on Diversity Order
With A and B transmitting 2 streams of information each,
the BER performance of a 2 − 4 − 2 system with 2 streams
of interference is compared with that of a 2 − 5 − 2 system
with 3 streams of interference and a 2 − 6 − 2 system with
4 streams of interference in Fig. 5. It can be observed from
eye-balling the BER curves that they all have the same slope.
343
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

Fig. 5.
Diversity-multiplexing trade-off at the relay
Hence, a 2 − 5 − 2 system is able to suppress an extra stream
of interference while achieving the same diversity order of a
2 − 4 − 2 system. Likewise, a 2 − 6 − 2 system achieves the
same diversity order of a 2−4−2 system while suppressing 2
additional streams of interference. Thus, in general, additional
antennas at the relay help in mitigating more interference at
the cost of a loss in diversity. This is a manifestation of the
diversity-multiplexing tradeoff in a situation where co-channel
interference hampers relay communication during the MAC
phase.
V. CONCLUSION
In this paper, a scenario where relay operation is hampered
by the presence of interference in the ﬁrst MAC phase was
considered. In such a situation, the effectiveness of MMSE-
based interference suppression at the relay along with joint
source-relay precoding was demonstrated using simulation
results. It needs to be noted that while there is still some
residual interference at the relay even after MMSE interference
suppression, the fact that the joint source-relay precoding
takes the residual interference into account is what makes
our scheme robust even in low SINR regimes. Thus, the
joint source-relay precoding scheme proposed in [2] for noise-
limited systems is effective even in an interference-limited sce-
nario provided the relay performs MMSE-based interference
suppression, for which only the knowledge of second-order
statistics of interference is required. The effect of number
of relay antennas on the overall diversity order of BER
performance in the presence of interference was also studied
using simulation results for various conﬁgurations, where it
was observed that with additional antennas at the relay, it is
possible to suppress more streams of interference at the cost
of loss in diversity.
REFERENCES
[1] F. Roemer and M. Haardt, “Algebraic Norm-Maximizing (ANOMAX)
Transmit Strategy for Two-Way Relaying With MIMO Amplify and
Forward Relays,” IEEE Signal Processing Letters, vol. 16, no. 10, pp.
909–912, Oct. 2009.
[2] S. Rajeshwari and K. Giridhar, “New Approach to Joint MIMO Precoding
for 2-way AF Relay Systems,” in Proc. 17th National Conference on
Communications, Bangalore, India, Jan. 2011, pp. 1–5.
[3] A. U. T. Amah and A. Klein, “Pair-Aware Transceive Beamforming for
Non-Regenrative Multi-User Two-Way Relaying,” in Proc. IEEE ICASSP,
Dallas, USA, Jan. 2010, pp. 2506–2509.
[4] D. P. Palomar, J. M. Ciofﬁ, and M. A. Lagunas, “Joint Tx-Rx Beamform-
ing Design for Multicarrier MIMO Channels: A Uniﬁed Framework for
Convex Optimization,” IEEE Trans. Signal Process., vol. 51, no. 9, pp.
2381–2401, Sep. 2003.
[5] J. G. Proakis and M. Salehi, Digital Communications, 5th ed.
McGraw-
Hill Higher Education, 2008.
344
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

