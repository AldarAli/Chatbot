Ergodic Capacity Analysis for Ubiquitous Cooperative Networks Employing
Amplify-and-Forward Relaying
Peng Liu, Saeed Gazor, and Il-Min Kim
Department of Electrical and Computer Engineering
Queenâ€™s University, Kingston, ON, Canada
Emails: {peng.liu, gazor, ilmin.kim}@queensu.ca
Abstractâ€”This paper studies the ergodic capacity for ubiquitous
cooperative networks employing amplify-and-forward relaying
in Rayleigh fading. A general asymmetric channel model is
considered, in which the average signal-to-noise ratios associated
with different wireless channels are generally unequal. We derive
an exact expression of the ergodic capacity in a single-integral-
form, which serves as a benchmark for ubiquitous cooperative
networks. To the best of our knowledge, this exact expression has
not been reported in the literature. To evaluate this integral more
efï¬ciently, we develop a hybrid Gaussian quadrature expression
in closed-form, which has a high relative accuracy. Finally, it
is demonstrated that the obtained analytical results overlap the
simulation curves, while the existing bounds are loose in various
scenarios.
Keywordsâ€“Amplify-and-forward; ergodic capacity; Rayleigh fad-
ing; relaying.
I.
INTRODUCTION
Cooperative networks for ubiquitous communications have
gained considerable attention in the last decade, due to their
great potential to combat fading impairments [1]â€“[4]. The
main idea of cooperative communications is that several geo-
graphically distributed wireless terminals, including the source
and relay(s), collaborate with one another to form a virtual
multi-antenna array, which enables distributed spatial diversity.
Amplify-and-Forward (AF) is one of the most popular relaying
protocols, in which the relay simply ampliï¬es its received
signal and forwards it to the destination [4]â€“[6].
A. Ergodic Capacity
The fading environment manifests itself in ergodic fading
when the channel coherence time is (much) shorter than
the codeword length, due to the usage of sufï¬ciently long
codewords and/or high mobility of wireless terminals [7]. In
an ergodic fading scenario, each codeword typically spans
many coherence time intervals, giving rise to rapid fading
ï¬‚uctuations within each codeword. The codeword is long
enough to average out the randomness of fading, render-
ing Shannon capacity a deterministic constant independent
of the instantaneous fading state. Mathematically, Shannon
capacity of ergodic channels, a.k.a., ergodic capacity, is equal
to the maximum achievable rate averaged over the fading
distribution, which depends only on the fading statistics [7],
[8]. Ergodic capacity is a fundamental information-theoretic
performance measure, which captures the maximum rate of
reliable communications under ergodic fading [7].
B. Related Work
It is of paramount importance to characterize the ergodic
capacity, which serves as a benchmark for practical commu-
nication systems. However, due to the nonlinear expression of
the end-to-end Signal-to-Noise Ratio (SNR) in AF relaying,
only few works have studied the exact ergodic capacity for
AF networks [9][10]. Speciï¬cally, the exact analysis of the
ergodic capacity was limited only to a symmetric single-relay
network without the the direct source-destination link [9, eq.
(11)]. The major limitation of the symmetric channel setting is
that the average received SNRs of the ï¬rst- and the second-hop
channels must be identical in Rayleigh fading. However, this
does not necessarily hold in practice due to large-scale path-
loss and shadowing effects. Furthermore, Fan et al. derived
an exact expression of the ergodic capacity for a multi-relay
network without the direct link where only a single-relay with
the maximum second-hop SNR is allowed to assist the commu-
nication. Since the selection of the relay in [10][11] neglects
the ï¬rst-hop channel conditions, the achievable diversity order
is always equal to one in Rayleigh fading, irrespective of the
number of relays. That is, from a diversity point of view, the
relaying scheme in [10][11] achieves the same performance as
in a single-relay network with no direct link, which makes the
exact analysis by Fan et al. [10] valid only for a single-relay
network without the direct link.
In addition to the exact analysis, other works have been
devoted to ï¬nding bounds or approximations of the ergodic
capacity. Speciï¬cally, various upper bounds were obtained
using the geometric-mean [12, eq. (8)], harmonic-mean [13,
eq. (18)], and Jensenâ€™s inequality [12, eq. (5)], [14, eq. (10)].
In addition, series expansions of the ergodic capacity were
developed in [9, eq. (4)], [12, eq. (17)], and [15, eq. (9)].
These bounds/approximations, unfortunately, suffer from low
accuracy and/or high computational complexity. To the best
of our knowledge, an exact expression of the ergodic capacity
has not been reported for a general asymmetric AF cooperative
network with the direct link, which motivates our work.
C. Contribution
To the best of our knowledge, the exact analytical expres-
sion of the ergodic capacity for a single-relay network with
the direct link has not been reported in the literature, which
motivates this work. In this paper, we carry out exact analysis
under the general asymmetric channel setting where different
channels have generally unequal average SNRs. The exact
263
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-353-7
UBICOMM 2014 : The Eighth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

expression of the ergodic capacity is derived in a single integral
form for the single-relay network with the direct link. To nu-
merically evaluate this expression, we further develop a hybrid
Gaussian quadrature rule in closed-form, which achieves a high
relative accuracy of 10âˆ’6, and thus, is very suitable for real-
time evaluations. These obtained expressions serve as a useful
tool to analytically evaluate the performance limits of piratical
AF relaying systems.
The remainder of the paper is organized as follows. Section
II introduces the system model. Section III conducts the
ergodic capacity analysis. Section IV validates the capacity
analysis by simulations. Finally, Section V concludes the paper.
Notation: We use x
âˆ†= y to denote that x, by deï¬nition,
equals y. E(Â·), ln(Â·), and log2(Â·) denote the expectation, natural
logarithm, and base-2 logarithm, respectively. For a random
variable X, fX(Â·) and FX(Â·) are the probability density
function (PDF) and cumulative distribution function (CDF),
respectively. Finally, X âˆ¼ CN(Âµ, Ïƒ2) means that X is a
circularly symmetric complex Gaussian random variable with
mean Âµ and variance Ïƒ2.
II.
SYSTEM MODEL
Consider a cooperative network composed of three single-
antenna terminals: a source S, a relay R, and a destination
D, where the direct S-D link exists. Let hsd, hsr, and hrd
denote ï¬‚at fading gains for the S-D, S-R, and R-D links,
respectively. The fading gains are assumed independent and
modeled as hij âˆ¼ CN(0, â„¦ij), ij âˆˆ {sd, sr, rd}. The additive
white Gaussian noises (AWGNs) associated with hijâ€™s follow
the distribution of CN(0, Ïƒ2
ij), ij âˆˆ {sd, sr, rd}. Let Es
and Er denote the transmit powers at S and R, respectively.
The instantaneous SNRs of the S-D, S-R, and R-D links are
respectively denoted Î³sd
âˆ†=
Es|hsd|2
Ïƒ2
sd
, Î³sr
âˆ†=
Es|hsr|2
Ïƒ2sr
, and
Î³rd
âˆ†=
Er|hrd|2
Ïƒ2
rd
, and the corresponding average SNRs are
Â¯Î³sd
âˆ†= Esâ„¦sd
Ïƒ2
sd , Â¯Î³sr
âˆ†= Esâ„¦sr
Ïƒ2sr , and Â¯Î³rd
âˆ†= Erâ„¦rd
Ïƒ2
rd . We focus on
a general asymmetric channel setting where Â¯Î³sd, Â¯Î³sr, and Â¯Î³rd
are unequal in general, which makes our analysis practical.
III.
EXACT ANALYSIS OF ERGODIC CAPACITY
We consider the CSI-assisted orthogonal AF relaying with
a maximum ratio combiner at the destination, yielding the end-
to-end received SNR at the destination as follows [1], [2], [4]
Î³AF
âˆ†= Î³sd +
Î³srÎ³rd
Î³sr + Î³rd + 1.
(1)
The ergodic capacity is thus given by
CAF
âˆ†= 1
2E

log2(1 + Î³AF)
	
,
(2)
where the pre-log factor 1/2 accounts for the orthogonal
relaying.
Theorem 1: The ergodic capacity for a single-relay AF
network with the direct link is given by
CAF =
1
2 ln(2)

e
1
Â¯Î³sd E1
 1
Â¯Î³sd

+
âˆšÂ¯Î³srÂ¯Î³rd
2Â¯Î³sd
I

,
(3)
where
I
âˆ†=
Z âˆ
0
Ï†(x)dx.
(4)
The integrand of (4), Ï†(x), is deï¬ned as follows:
Ï†(x)
âˆ†= exp
âˆšÂ¯Î³srÂ¯Î³rd
2Â¯Î³sd
x + 1
Â¯Î³sd

E1
âˆšÂ¯Î³srÂ¯Î³rd
2Â¯Î³sd
x + 1
Â¯Î³sd

Ã—
s
x

x +
2
âˆšÂ¯Î³srÂ¯Î³rd

K1
 s
x

x +
2
âˆšÂ¯Î³srÂ¯Î³rd
!
Ã— exp

âˆ’ Â¯Î³sr + Â¯Î³rd
2âˆšÂ¯Î³srÂ¯Î³rd
x

,
(5)
where E1(Â·) and K1(Â·) denote the exponential integral function
[16, eq. (15.1.1)] and the ï¬rst-order modiï¬ed Bessel function
of the second kind [16, eq. (9.6.11)], respectively.
Proof: See Appendix A.
At the ï¬rst glance, the exact expression of ergodic capacity
in (3) involving the single-integral of (4) is complicated. In
fact, the integrand of (5), Ï†(x), is a well-behaved function for
x > 0. First of all, exp

0
10
20
30
40
50
60
70
80
10
âˆ’7
10
âˆ’6
10
âˆ’5
10
âˆ’4
10
âˆ’3
10
âˆ’2
M
Relative error tolerance
 
 
Î³ = 0 dB
Î³ = 10 dB
Î³ = 20 dB
Figure 1.
Relative error tolerance, |R/I|, versus M for dr = 0.5 and
Î³ = 0, 10, 20 dB, where Ï„ = 1, N1 = N2 = 15.
0
5
10
15
20
25
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Î³ = E/Ïƒ2 (dB)
Ergodic capacity
 
 
Simulation
Exact analysis in (3) and (4)
Hybrid Gaussian quadrature in (3) and (7)
Jensenâ€™s upper bound [14, eq. (10)]
Minâˆ’UB
Figure 2.
Ergodic capacity of single-relay AF network with the direct link
under asymmetric channel setting where dr = 0.6.
and R is the remainder. Also, w1,i and t1,i, i = 1, Â· Â· Â· , N1,
are, respectively, the weights and zeros of the Legendre
polynomial of order N1 [16, Table 25.4], and w2,i and t2,i,
i = 1, Â· Â· Â· , N2, are, respectively, the weights and zeros of
the Laguerre polynomial of order N2 [16, Table 25.9]. It is
obvious that the accuracy of (7) is dependent on Ï„, M, N1,
and N2. In general, any speciï¬c accuracy can be achieved by
simultaneously increasing M, N1, and N2 [19], for any Ï„. In
practice, however, using small M, N1, and N2 to achieve the
target accuracy for a speciï¬c Ï„ is desirable. The choice of
parameters are discussed in detail in the next section.
IV.
NUMERICAL RESULTS
Consider a line S-R-D model in which R is located in
the straight line between S and D. Let dr denote the distance
between S and R. The path loss model for typical urban
environments is adopted, i.e., â„¦sd = 1, â„¦sr = dâˆ’4
r , and
0
5
10
15
20
25
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Î³ = E/Ïƒ2 (dB)
Ergodic capacity
 
 
Simulation
Exact analysis in (3) and (4)
Hybrid Gaussian quadrature in (3) and (7)
Jensenâ€™s upper bound [14, eq. (10)]
Minâˆ’UB
Figure 3.
Ergodic capacity of single-relay AF network with the direct link
under symmetric channel setting where dr = 0.5.
â„¦rd = (1 âˆ’ dr)âˆ’4 [8]. We set Es = Er =
E
2 , where
E is the total power consumed in the whole network. The
variances of AWGNs are set to be identical, i.e., Ïƒ2
ij = Ïƒ2
for ij âˆˆ {sd, sk, kd}K
k=1. By varying the source-relay distance
dr, the link SNRs Â¯Î³sd, Â¯Î³sr, and Â¯Î³rd are unequal in general,
constituting a general asymmetric network. The ratio of the
total transmission power E to the AWGN variance, Î³
âˆ†= E/Ïƒ2,
is referred to as the network SNR.
A. Choice of Parameters in (7)
The parameters Ï„, M, N1, and N2 in (7) need to be chosen
appropriately to achieve a desirable accuracy. In practice, Ï„
is chosen such that Ï†(x) < 0.1 for x â‰¥ Ï„, and thus, the
approximation error of the (second) integral over [Ï„, âˆ) in (6)
can be made negligible by using a reasonably small value of
N2, e.g., N2 = 15 [19]. Since Ï†(x) < 0.0249 for all x â‰¥ 1, we
choose Ï„ = 1 and N2 = 15. Then, the overall accuracy of (7)
mainly depends on the ï¬rst (ï¬nite) integral over [0, Ï„] in (6). It
is possible to increase the accuracy of this integral by simply
increasing M for any ï¬xed value of N1. Thus, by setting Ï„ = 1
and N1 = N2 = 15, the overall accuracy of (7) is solely
dependent on the parameter M. The relative error tolerance,
i.e., |R/I|, versus M is illustrated in Fig. 1 for Î³ = 0, 10, 20
dB, where dr = 0.5. As a benchmark, we compute the integral
I of (4) using MATLAB quadgk function at a relative error
tolerance of 10âˆ’10, which is considered as the â€œexactâ€ value.
The difference between this exact value and that computed
using (7) is the absolute error tolerance R. It is clearly seen
that for Ï„ = 1, N1 = N2 = 15, and M = 20, the relative error
tolerance, |R/I|, is smaller than 10âˆ’6. Therefore, we suggest
that Ï„ = 1, N1 = N2 = 15, and M = 20 constitutes a suitable
choice in (7) to yield an accurate and efï¬cient approximation
for (4).
B. Ergodic Capacity Evaluation
For a single-relay AF network with the direct link, the
following results are compared: i) proposed â€œexactâ€ result
265
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-353-7
UBICOMM 2014 : The Eighth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

A =
2
Â¯Î³sd
e
1
Â¯Î³sd
( Z âˆ
0
E1
1 + z
Â¯Î³sd

e(
1
Â¯Î³sd âˆ’
1
Â¯Î³sr âˆ’
1
Â¯Î³rd )z
s
z(z + 1)
Â¯Î³srÂ¯Î³rd
K1
 
2
s
z(z + 1)
Â¯Î³srÂ¯Î³rd
!
dz
âˆ’
"
E1
1 + z
Â¯Î³sd
 Z z
0
e(
1
Â¯Î³sd âˆ’
1
Â¯Î³sr âˆ’
1
Â¯Î³rd )x
s
x(x + 1)
Â¯Î³srÂ¯Î³rd
K1
 
2
s
x(x + 1)
Â¯Î³srÂ¯Î³rd
!
dx
|
{z
}
âˆ†
=B(z)
#âˆ
z=0
)
(A.4)
=
2
Â¯Î³sd
e
1
Â¯Î³sd
Z âˆ
0
E1
1 + z
Â¯Î³sd

e(
1
Â¯Î³sd âˆ’
1
Â¯Î³sr âˆ’
1
Â¯Î³rd )z
s
z(z + 1)
Â¯Î³srÂ¯Î³rd
K1
 
2
s
z(z + 1)
Â¯Î³srÂ¯Î³rd
!
dz.
(A.5)
by (3) and (4), where (4) is computed using quadgk at a
relative error tolerance of 10âˆ’10; ii) proposed hybrid Gaussian
quadrature using (7) in (3), where Ï„ = 1, N1 = N2 = 15,
and M = 20; iii) Jensenâ€™s upper bound [14, eq. (10)]; and
iv) â€œMin-UBâ€ which refers to the widely-used upper bound
using the minimum of the two-hop SNRs, i.e.,
Î³srÎ³rd
Î³sr+Î³rd+1 â‰¤
min(Î³sr, Î³rd). The comparison is performed for an asymmetric
network with dr = 0.6 in Fig. 2 and a symmetric network
with dr
=
0.5 in Fig. 3. We observe that the ergodic
capacity computed using the hybrid Gaussian quadrature in
(7) is in excellent agreement with the exact value of (3).
This validates once again the accuracy and efï¬ciency of the
proposed hybrid Gaussian quadrature. Furthermore, it is clearly
seen that Jensenâ€™s upper bound and the Min-UB are loose
upper bounds, throughout the whole SNR range. Indeed, the
loose bounds/approximations highlight the usefulness of the
obtained exact expression.
V.
CONCLUSION
We analyzed the ergodic capacity of AF relaying for
ubiquitous cooperative networks in Rayleigh fading where
the average SNRs of different wireless channels are unequal
in general. For the single-relay case with the direct link,
we derived the ergodic capacity in an exact single-integral-
form, which serves as a benchmark for AF relaying systems.
To facilitate evaluation of this exact expression, we derived
a hybrid Gaussian quadrature rule in closed-form, which is
extremely accurate and easy to compute.
An interesting extension of this work is to study the exact
ergodic capacity for general multi-relay AF networks, which
will be addressed in our further work.
APPENDIX A
PROOF OF THEOREM 1
Let Î³r
âˆ†=
Î³srÎ³rd
Î³sr+Î³rd+1, and thus, Î³AF = Î³sd + Î³r. It follows
from [20, eq. (11)] that the CDF of Î³r is
FÎ³r(z) = 1 âˆ’ 2eâˆ’

limxâ†’âˆ{ln(1 + 1
x)} = 0, using Squeeze Theorem [21],
we
have
limxâ†’âˆ{exE1(x)}
=
0.
This
implies
that
limzâ†’âˆ

e
1+z
Â¯Î³sd E1

