Detection of AV Impulse Frequency and Verification of Pacemaker Battery Status 
 
Ivana Gálová, Michal Gála 
Department of Electromagnetic and Biomedical 
Engineering 
University of Žilina 
Žilina, Slovak Republic 
ivana.galova@fel.uniza.sk, michal.gala@fel.uniza.sk 
 
Martin Augustýnek, Martin Černý, Marek Penhaker 
Department of Cybernetics and Biomedical Engineering 
VSB – Technical University Ostrava 
Ostrava, Czech Republic 
martin.augustynek@vsb.cz, martin.cerny@vsb.cz, 
marek.penhaker@vsb.cz 
 
 
 
Abstract — Pacemaker therapy has irreplaceable position in 
therapy of many cardiac diseases. The lifetime of 
implantable devices is several years and functionality 
depends on the battery condition. The verification of 
pacemaker battery is possible using portable pacemaker 
programmers manufactured for specific pacemakers. This 
option is costly for the general public. An alternative 
approach is to analyze the patient’s electrocardiogram. This 
article deals with possibilities and methods of pacemaker 
battery state verifying using stimulation pulse width 
detection. Future plans include the construction of a small 
and embedded device, enabling general physicians and 
patients to obtain on-demand information about the battery 
status of the pacemaker.  
Keywords 
- 
electrocardiography; 
single 
chamber 
pacemaker; dual chamber pacemaker; pulse width; battery. 
I. 
 INTRODUCTION 
Pacemakers play an important role in the treatment of 
cardiac diseases. This is especially true in cases where 
medication is no longer sufficient and patients require a 
pacemaker while waiting for a heart transplant. The other 
group of patients includes less severe heart-related 
problems which can be satisfactorily solved by implanted 
pacemakers and thus preserving patient vital functions. 
The lifetime of such devices is several years. Guaranteed 
operation is currently limited by the battery life of the 
device. When the battery capacity decreases, the device 
must be replaced. This end, manufacturer-specific portable 
pacemaker programmers must be used to verify battery 
properties. These are however expensive and usually 
available only to cardiologists or internal physicians 
performing invasive cardiology. An alternative approach is 
to evaluate the state of the pacemaker battery by analyzing 
the patient electrocardiogram (ECG) recording. This 
article discusses the possibilities and means to verify the 
battery status of implantable stimulation devices and it 
proposes future plans for the construction of a small and 
embedded device, enabling general physicians and patients 
to obtain on-demand information about the battery status 
of the pacemaker [1][2][3][4]. 
Section 2 deals with lifetime of the power source 
according to norm EN 45502-2-2:2008. Section 3 
describes a system for measurement and analysis of 
simulated ECG signal. This section describes the steps of 
algorithm for distance detection between the AV impulses 
that stimulate the atria and ventricles. In Section 4, we test 
the proposed algorithm. Testing is realized on simulated 
data with different kinds of noises and on real patient data. 
After AV impulse detection, the algorithm evaluates 
battery state. Section 5 deals with conclusion and future 
work. 
II. 
PACEMAKER BATTERY STATES 
According to standard EN 45502-2-2:2008, active 
implantable medical devices must include means to warn 
in advance of low battery state. The warning interval 
(during normal use of the device) must be comparable to 
regular patient checks at the ambulance. The conditions of 
replacement are model and manufacturer specific. In 
Figure 1, the following device lifetime phases are defined 
based on the residual battery capacity of implantable 
medical devices: 
 
 
Beginning of life (BOL) - implantable device is 
first approved by the manufacturer and certified 
for marketing, 
 
Elective replacement time (ERT) - the power 
supply 
reaches 
a 
pre-determined 
threshold 
capacity of the manufacturer, in which case the 
device 
replacement 
is 
recommended. 
This 
indicates the beginning stages of prolonged 
service period, 
 
Prolonged service period (PSP) - time period for 
the recommended replacement, during which the 
device continues to operate as specified by the 
manufacturer, 
 
End of life (EOL) - expiration of the extended 
service life, which is the end of the original 
manufacturer's specified functionality of the 
device, power saving mode until complete failure. 
 
More frequent patient monitoring is recommended 
after crossing the elective replacement near (ERN) 
threshold [1][9]. 
 
34
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-335-3
BIOTECHNO 2014 : The Sixth International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies

 
 
Figure 1.  Lifetime of the power source. 
The mentioned norm does not define dependence of 
the device lifetime phases on frequency or on magnitude, 
but most of the manufacturers especially indicate the 
dependence on frequency (see Table I). The frequency is 
measured in asynchronous mode which is activeted by 
permanent magnet with induction of more than 1 mT 
[1][9]. 
TABLE I.  
THE PACING PULSE FREQUENCIES IN ASYNRONOUS 
MODE FOR BOL AND ERT STAGES 
Manufacturer 
BOL 
[1/min] 
ERT 
[1/min] 
Biotronik 
90 
80 
Boston Scientific 
100 
85 
ELA 
96 
80 
Medtronic 
85 
65 
MEDICO 
100 
70 
St. Jude Medical 
98.6 
86.3 
Vitatron 
100 
86 
A. Low battery 
Figure 2 shows that the battery status of a single 
chamber pacemaker is determined by measuring the 
frequency (f = 1/T, f – frequency, T – period) and pacing 
pulse width (label - d) in asynchronous mode. In general 
the pacing pulse width can be from 0.05 ms to 2 ms [1]. 
 
 
Figure 2.  The frequency of single chamber pacemaker stimulation in 
asynchronous mode: a) the proper function, b) low battery condition. 
 
Figure 3.  The stimulation frequency in asynchronous mode during 
correct functioning of a dual chamber pacemaker. 
Figure 3 shows that dual chamber pacemakers can also 
determine the distance between the AV impulses that 
stimulate the atria and ventricles [1]. 
III. 
CONSTRUCTION OF SYSTEM FOR SENSING AND 
EVALUATION OF THE BATTERY STATUS 
To evaluate the pacemaker battery, we must first use a 
permanent magnet to switch the pacemaker into 
asynchronous mode and then record the ECG signal. To 
capture the signal, we used the MP36 unit manufactured 
by Biopac which we connected to the patient simulator 
FLUKE MPS450. In Figure 4 we can see the mentioned 
test system. 
Using the simulator, we tested asynchronous mode of 
single chamber (Figure 5) as well as of dual chamber 
(Figure 6) pacemaker. The pacemaker in the mentioned 
mode generates periodic pacing pulses regardless of the 
actual heart electrical activity. The recorded signal enables 
us to obtain information about the frequency and pulse 
width of the stimulus, or the duration of AV delay in dual 
chamber pacemaker. Based on the measured parameters, it 
is possible to evaluate the condition of the battery. 
Stimulation frequency decreases in time and the pacing 
pulse widens. The proposed algorithm is designed only for 
these conditions (frequency, pulse width and AV delay) 
and it does not give a solution for the dependence of the 
device lifetime phases on magnitude. The future work will 
be focused on the solution for this problem. 
 
 
Figure 4.  The Test system (measuring unit and MP36 patient simulator 
MPS450). 
 
35
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-335-3
BIOTECHNO 2014 : The Sixth International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies

 
 
Figure 5.  The simulated ECG signal of a patient with a single chamber 
pacemaker in asynchronous mode. 
The design and implementation of the algorithm was 
carried out in MATLAB. The algorithm development was 
divided into several steps, each addressing possible 
drawbacks so as to achieve the desired accuracy and speed 
of the proposed algorithm. The first step consisted in the 
analysis and evaluation of the original recording without 
any modification. The algorithm takes into account only 
samples above the pre-selected threshold (red line, 
Figure 7). By comparing the distance between successive 
samples and known pacing pulse width (information 
obtained from the simulator), pacing pulses were detected 
and the required parameters were calculated. 
However, detection was not accurate because the 
signal contained undesired artifacts. To eliminate these 
artifacts, different filter types were applied (differential 
filter, averaging filter, band-stop filter) [5][8]. However, 
after their application, the processed signal lost the 
information necessary to determine the pulse width (after 
applying the differential filter) and the evaluation time 
significantly increased (due to the averaging filter). In the 
end, we decided to use simple mathematical operations, as 
one of the main criteria was to design a fast and simple 
algorithm to enable use thereof in a microcontroller. 
 
Figure 6.  The simulated ECG signal of a patient with a dual chamber 
pacemaker in asynchronous mode. 
 
Figure 7.  Noisy simulated ECG of a patient with a single chamber 
pacemaker in asynchronous mode and detail of noisy signal at the 
boundary (f - frequency of 75 min-1, d - 2 ms pulse width). 
Each recorded sample was amplified by its square in 
order to “smooth out” the recording (amplify the 
stimulation pulses). Boundaries for pacing pulse detection 
were first determined intuitively (empirically). At later 
stages the algorithm has then been modified so as to 
determine 
these 
boundaries 
based 
on 
individual 
recordings. Subsequent analysis of samples exceeding the 
threshold value enabled the evaluation of the pulse width, 
frequency and, in case of dual chamber pacemaker, the 
duration of the AV delay. 
Figure 7 shows that the search for local maxima was 
performed in order to confirm the correct identification of 
stimulation pulses and to discard possible noise-related 
artifacts [6][7]. 
IV. 
TESTING OF THE PROPOSED ALGORITHM 
The proposed algorithm has been tested on several 
simulated signals. Individual signals were degraded by 
different types of artifacts (AC 50 or 60 Hz noise and 
various breathing motion artifacts). The following section 
details the individual signals along with the detection and 
indication of stimulation pulses. Figure 8 shows a sample 
signal heavily degraded by noise from muscle activity and 
Figure 9 shows the same signal after processing. In 
Figure 10, it is shown the detected pacing pulses of a dual 
chamber pacemaker. 
36
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-335-3
BIOTECHNO 2014 : The Sixth International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies

 
 
Figure 8.  The captured signal containg noise from muscle activity. 
 
Figure 9.  Signal after amplification. 
 
Figure 10.  Detection of stimulus pulses (red points). 
The developed algorithm was tested with multiple one 
hour long recordings and the reliability of pacing pulse 
detection was above 98%. We also tested real-life patient 
recordings obtained from the Faculty hospital in Zilina. 
The recording was measured from the first “standard” 
bipolar limb lead. The patient pacemakers were 
manufactured by Medtronic. The algorithm efficiency was 
once again confirmed and the results were discussed with a 
cardiologist (Dr. Jan Lehotsky) and compared with those 
obtained 
from 
portable 
pacemaker 
programmers 
manufactured by Medtronic. In Figure 11, it is shown the 
final evaluations of battery status obtained from real 
patient data. Figure 11a represents the single chamber 
pacemaker and Figure 11b the dual chamber pacemaker. 
V. 
CONCLUSION AND FUTURE WORK 
The algorithm has been tested on real life data from 
patients with implanted pacemakers (Faculty Hospital 
Zilina) as well as on simulated recordings containing 
different types of artifacts (50 Hz, 60 Hz, breathing 
activity, muscular activity and random noise) and the 
success rate was above 98%. Current development is 
focused on hardware design of a small and portable ECG 
logger to measure and consequently evaluate the status of 
the battery pacemaker. 
The mentioned algorithm is designed only for 
detection of frequency, pulse width and AV delay and it 
does not solve the dependence of the device lifetime 
phases on magnitude. The future work will be therefore 
focused on solution of this question. 
ACKNOWLEDGMENT 
This paper is supported by the following project: 
University Science Park of the University of Zilina (ITMS: 
26220220184) supported by the Research & Development 
Operational Program funded by the European Regional 
Development Fund. 
REFERENCES 
[1] D. Korpas, Pacemaker technology, Praha: Mladá fronta, 
2011, ISBN 978-80-204-2492-1. 
[2] Z. Labza, D. Korpas, and M. Penhaker, “Determination of 
the 
Electric 
Parameters 
of 
Dual-Chamber 
Cardiostimulator,“ 
Proc. 
9th 
IFAC 
Workshop 
on 
Programmable Devices and Embedded Systems (PDES 
2009), Roznov pod Radhostem, Czech Republic, Feb. 
2009, pp. 290-293, ISBN 978-3-902661-41-8, ISSN 1474-
6670, doi:10.3182/20090210-3-CZ-4002.xxxx. 
[3] J. J. Bax, T. Abraham, S. S. Barold, O. A. Breithardt, J. W. 
Fung, S. Garrigue, J. Gorcsan, D. L. Hayes, D. A. Kass, J. 
Knuuti, C. Leclercq, C. Linde, D. B. Mark, M. J. 
Monaghan, P. Nihoyannopoulos, M. J. Schalij, C. 
Stellbrink, and C. M. Yu, “Cardiac resynchronization 
therapy: Part 1--issues before device implantation,” J Am 
Coll Cardiol, Dec. 2005. 
[4] D. Korpas, “Psychological Intolerance to Implantable 
Cardioverter Defibrillator,” Biomedical Papers-Olomouc, 
vol. 152, no. 1, June 2008, pp. 147-149, ISSN 1213-8118. 
[5] M. Penhaker, T. Stula, and M. Augustynek, “Long-term 
heart rate variability assessment” The 5th Kuala Lumpur 
International Conference on Biomedical Engineering 
(BIOMED 2011), Held in Conjunction with the 8th Asian 
37
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-335-3
BIOTECHNO 2014 : The Sixth International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies

 
Pacific Conference on Medical and Biological Engineering, 
(APCMBE 2011), Springer-Verlag Berlin Heidelberg, 20 - 
23 June 2011, pp. 532-535, ISSN 16800737, ISBN 978-
364221728-9, doi:10.1007/978-3-642-21729-6_134. 
[6] B. Babusiak and M. Gala, “Detection of Abnormalities in 
ECG” Information Technologies in Biomedicine (ITIB 
2012), Springer-Verlag Berlin Heidelberg, 2012, pp. 161-
171, ISBN 978-3-642-31195-6, ISSN 0302-9743. 
[7] Š. Borik and I. Čáp, “Investigation of Pulse Wave Velocity 
in Arteries” The 35th International Conference on 
Telecommunications and Signal Processing (TSP 2012), 
Brno: University of Technology, 2012, pp. 562-565, ISBN 
978-1-4673-1116-8. 
[8] M. Penhaker, R. Hajovsky, and D. Korpas, “Measurement 
and Analysis EMC Parameters of Implantable Pacemaker,” 
Przegląd Elektrotechniczny (Electrical Review), vol. 87, 
no. 5, 2011, pp. 265-268, ISSN 0033-2097. 
[9] EN 45502-2-2:2008, Active implantable medical devices - 
Part 2-2: Particular requirements for active implantable 
medical devices intended to treat tachyarrhythmia (includes 
implantable defibrillators), May 2007. 
 
 
 
Figure 11.  Data analysis of patient with: a) single chamber pacemaker, b) dual chamber pacemaker. 
38
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-335-3
BIOTECHNO 2014 : The Sixth International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies

