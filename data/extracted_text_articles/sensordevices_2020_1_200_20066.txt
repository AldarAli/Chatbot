Comparison Between Electrical Impedance and Optical Spectroscopy for a Field 
Soil Analysis 
 
Olga Chambers 
Faculty of Electrical Engineering, Trzaska 25,  
Ljubljana 1000, Slovenia 
email: olga.chambers@fe.uni-lj.si 
Janez Trontelj ml. 
Faculty of Electrical Engineering, Trzaska 25,  
Ljubljana 1000, Slovenia 
email: janez.trontelj2@guest.arnes.si
 
 
Abstract— In this paper, we performed a comparative analysis 
of the electrical impedance and optical methods performance 
for a field soil characterization. The study was optimized by 
reducing the texture variation and the influence of the 
unknown soil elements that are not in the focus of this 
research. The research dataset was created using pure soil 
from two agriculture farms and fertilized with fertilizers 
selected by farmers. The impedance spectrometer developed in 
our laboratory was used to perform the impedance 
measurements between 30 kHz and 14 MHz showing 
promising results. Optical measurements were performed 
within the ultraviolet-visible-near infrared (UV-VIS-NIR) 
range. The obtained results indicate that it is possible to 
perform low-cost soil analysis with high accuracy for a field 
fertilization analysis. 
  Keywords- fertilizer analysis; soil analysis; impedance sensor; 
spectral analyser. 
I. 
 INTRODUCTION  
The development of the fast and accurate soil 
characterizing sensors has been recognized as a crucial 
problem in nowadays agriculture. Several strategies with 
different degrees of success have been proposed to predict 
soil properties in a field [1][2]. Literature indicates a 
different degree of the accuracy for sensors that usually 
depends on the soil properties variation and sensor 
specifications [3]. Soil texture variation is the most common 
problem for agriculture sensors, leading to large datasets 
with an expensive chemical analysis that significantly 
increases the research cost [4]. Thus, the commercial 
AgroCares scanner is based on the reflectance spectroscopy 
and uses a large dataset to provide only brief information 
about soil nutrients, i.e., low, medium, and high. Therefore, a 
compromise between strategy and price must be found 
concerning the measuring time and accuracy. The most 
advanced technologies in agriculture use multi-sensor 
systems that include expensive ion-selective sensors [5]. This 
sensors type has high cost and requires a chemical solution 
that is not suitable for real-time measurement in a field. 
Alternative sensors, such as optical reflectometry and 
impedance spectroscopy, have relatively low cost and do not 
require chemical support. Unlikely, they are sensitive to soil 
moisture 
level, 
microelements 
variation, 
ambient 
temperature, humidity, etc. Optical reflectometry is the most 
common method mentioned in the literature that operates on 
the whole Ultraviolet-Visible-Near Infrared (UV-VIS-NIR) 
range.  
Nevertheless, some researchers indicate the unstable 
performance of this method. Luleva et al. [6] showed the 
influence of the soil texture on the position of the potassium 
absorption centre. They also reported that samples with high 
clay content results in a smaller change in absorption. The 
electrical impedance method is less accurate for soil nutrients 
detection and is commonly used for soil moisture analysis or 
quantitative analysis when other components are neglected 
[7]. Pandey et al. [8] reported their results for soil-nitrates 
detection in a real-time application indicating the impedance 
method great potential for in-suite measurements.  
Our research aims to integrate a low-cost solution 
suitable for real-time field applications with high accuracy. 
Therefore, the comparison between impedance and optical 
methods performance was studied. To minimize the 
influence of the texture and unknown microelements (that 
are not in the focus of this research), the fertilized soil's 
characterization was performed using soil from a field. The 
fertilized soil samples with different nutrition levels were 
achieved using only fertilizers defined by farmers. Following 
the literature recommendations, soil samples were prepared 
in the laboratory and measured using electrical impedance 
and optical methods. Finally, the classification-based 
validation approach for soil collected in two entirely 
different locations in Slovenia was performed to compare the 
methods' effectiveness. Due to the non-uniform soil 
properties, it is common to perform a set of measurements in 
different locations to reduce variability. Therefore, the final 
validation accuracy was achieved based on a set of repetitive 
measurements for each soil sample.  
Section II describes research datasets, set-ups for 
electrical impedance and optical measurements, method for 
soil 
properties 
prediction 
using 
classification-based 
approach. Electrical impedance measurement was performed 
using 
laboratory 
designed 
soil 
spectrometer. 
This 
spectrometer is small and easy to use. Its impedance 
Application Specific Integrated Circuit (ASIC) was 
implemented by using the CMOS process. A programmed 
microprocessor enables the communication between ASIC 
and personal computer. Finally, results of the soil properties 
prediction are shown and discussed in Section III.  
97
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-820-4
SENSORDEVICES 2020 : The Eleventh International Conference on Sensor Device Technologies and Applications

II. 
MATERIALS AND METHODS  
This section describes the research dataset and 
instruments used for soil measurements. All measurements 
were performed in the laboratory under controlled 
conditions. To eliminate the impact of external factors, the 
ambient temperature near 22 ̊C and relative humidity under 
40% are kept constant. 
A. Dataset 
The research datasets, i.e., Dataset A and Dataset B, 
consist of soil samples collected from two different 
agriculture farms in Slovenia. The pure soil samples are 
collected from a 0-30 cm top-soil surface. Each sample is 
air-dried for one month, grounded, and then sieved through a 
2-mm sieve to provide a dry base for experiments. Following 
recommendations in literature and farmers requirements, a 
simple system for nutrient-level classification and coding 
shown in Table I is created and used for model parameters 
learning. Using this system and chemical characteristics, 
codes for each soil sample were obtained with respect to the 
amount of phosphorus, potassium, and magnesium (see last 
columns in Tables II and III).   
TABLE I.  A SIMPLIFIED SYSTEM FOR SOIL NUTRIENTS LEVEL CODING.  
Score, mg/100g 
Grade 
0 - 10 
0 
11 - 20 
1 
21 - 30 
2 
31 - 40 
3 
> 40 
4 
 
The commonly used agricultural fertilizers selected by 
farmers were used to prepare samples with a different 
nutrition levels. Each fertilizer was diluted in a deionized 
(DI) water and then mixed with an air-dried soil in various 
concentrations. Tables II and III provide information about 
soil chemical characteristics performed by a certified 
laboratory at the Agriculture Institute of Slovenia [9]. The 
chemical analysis results shown in tables indicate an entirely 
different fertilizer impact on the soil chemical properties, 
with an observable correlation between the added fertilizer 
concentration and nutrient change. Thus, a medium level of a 
nutrient in the soil corresponds to roughly 0.05% of 
fertilizer. A 0.1% concentration of fertilizer leads to a high 
level of a nutrient that is also confirmed in literature [10].  
TABLE II.  
CHEMICAL CHARACTERIZATION OF THE SOIL SAMPLES 
FROM DATASET A. 
Soil 
ID 
Added fertiliser 
P, 
mg/100g 
K, 
mg/100g 
M, 
mg/100g 
Code 
1 
none 
3.9 
6.4 
23 
002 
2 
0.05% F1 
14 
6.4 
24 
102 
3 
0.05%P+0.05% F2 
16 
15 
25 
112 
4 
0.1%K 
4.2 
44 
23 
042 
5 
0.1% F1+0.1% F2 
39 
47 
23 
342 
6 
0.05% F3 
7.8 
14 
22 
012 
7 
0.1% F3 
12 
17 
22 
112 
F1: Triple super phosphate (P2O5 -46%); F2: potassium sulphate (K2O - 50%); 
F3: Potassium phosphate (14% P2O5, 28%K2O, 2%MgO). 
 
TABLE III.  CHEMICAL CHARACTERIZATION OF THE SOIL SAMPLES FROM 
DATASET B.  
Soil 
ID 
Added fertiliser 
P, 
mg/100g 
K, 
mg/100g 
M, 
mg/100g 
Code 
1 
0.05%F1 
18 
13 
25 
112 
2 
0.05%F2 
10 
20 
25 
012 
3 
0.05%F3 
11 
15 
29 
112 
4 
0.05%(F1+F2+F3+F4) 
23 
23 
30 
222 
5 
0.1%F1 
23 
16 
25 
212 
6 
0.1%F3 
11 
16 
34 
113 
7 
0.1%F5 
11 
14 
24 
113 
8 
none 
10 
17 
23 
012 
F1: calcium phosphate (P2O5 -26%, CaO - 40%); F2: potassium sulphate (K2O 
- 50%); F3: magnesium sulphate (MgO - 25%, SO3 - 50%); F4: potassium 
sulphate (K2O - 60%); F5: organic mass minimum 70%. 
B. Soil electrical impedance measurement set-up 
This paragraph describes the laboratory set-up for the 
measurement of soil samples. Measurements were carried 
out from the moist soil. Therefore, the dry soil samples were 
mixed with the predefined amount of the DI water (i.e., 60% 
of the dry soil sample base) to obtain soil samples with the 
same moisture level. The obtained soil samples were then 
placed in a 3D-printed holder with approximate dimensions 
of 20 x 10 x 10 mm (Figure 1). The soil holder was designed 
to hold small soil moisture samples of approximately 5 g. 
The workspace set-up for impedance measurement is 
shown in Figure 1 that includes an impedance spectrometer 
interfaced with the personal computer (PC) for data 
processing and storage. The measuring process was 
controlled using a graphical user interface developed in 
Matlab software [11].  
 
 
 
       
Figure 1.  Photography of the set-up for electrical impedance measurement 
and sample holder with soil. (a) set-up workspace for measurement; (b) 
sample holder with the soil. 
The impedance spectrometer's architecture is split into 
three main sections: analog, processing, and sensor. The 
Analog section measures soil electrical impedance. The 
spectrometer generates AC current with user-set frequency 
and sends it in the soil through sensor electrodes. The 
resulting imaginary and real components of the impedance 
are then digitized and send to the PC via the universal serial 
bus (USB).  
98
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-820-4
SENSORDEVICES 2020 : The Eleventh International Conference on Sensor Device Technologies and Applications

 
Figure 2.  Impedance magnitudes of three pure soil sub-samples and three fertilized soil sub-samples respectively.   
 
Spectroscopy measures resultant voltages when a 
constant current is applied at different frequencies. The 122 
frequencies selected between 30 kHz and 14 MHz enable a 
good fit of the whole frequency domain's impedance signal. 
Figure 2 shows impedance magnitudes plots corresponding 
to three sub-samples of the pure soil and impedance 
magnitudes plots corresponding to three sub-samples of the 
fertilized soil over the selected frequency range. As 
expected, measurements of sub-samples collected from the 
same soil are very similar. A small deviation can be 
explained by non-ideal manual sample preparation that can 
be improved by an automatic sample preparation. As the 
frequency increased, the impedance of the samples dropped 
obviously. It can also be noted that the lower fertilizer 
content is associated with higher impedance amplitude. Our 
earlier research indicates that soil solutions' primary 
information can be achieved from impedance magnitudes 
alone [12] that is also observed for soil characterization in 
our study. Therefore, the only impedance magnitudes are 
used in the following analysis.       
C. Soil optical measurement set-up 
This paragraph describes the set-up for the light 
reflectance measurement. A deuterium-halogen light box 
was used as the light source. The light reflectance from the 
sample was measured by placing 5 g of air-dried sieved 
sample into a quartz glass petri dish three mm-diameter, as 
shown in Figure 3. The set-up includes a fiber-coupled 
spectrometer FCR-7UV200-2-ME from Avantes that is fixed 
perpendicularly to have a 3 cm distance between the probe 
and samples. The light from a light source is sent through six 
illumination fibers to the sample, and the reflection is 
measured by a seventh fiber in the center of the reflection 
probe 
tip. 
The 
AvaSpec-ULS2048CL-EVO-RS 
and 
AvaSpec-HSC-TEC perform the light measurement in the 
ultraviolet, visible, and near-infrared regions of the 
electromagnetic spectrum, i.e., 200-2500 nm. Spectra 
normalization was performed by dividing soil reflectance 
spectra by the white body reflectance spectra used here as a 
reference. 
Soil spectral measurements were collected from seven 
randomly selected points for each air-dry sample. Figure 4 
shows seven plots corresponding pure soil in the UV-VIS 
range and NIR range, separately. It can be seen that the UV 
range between 200 to 400 nm is less informative than the 
VIS range and does not provide any characteristic variations 
that can be seen visually. The normalized signal in the VIS 
range appears with a bias having shape variation and peaks 
appearance that can be characteristic for different soil 
properties. The obtained plots indicate good repetitiveness of 
the measurements corresponding to the same soil. The small 
variation between measurements can be explained by a non-
uniform soil surface resulting in a reflectance angle 
variation. 
 
 
 
Figure 3.  The experimental set-up for optical measurement 
 
 
99
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-820-4
SENSORDEVICES 2020 : The Eleventh International Conference on Sensor Device Technologies and Applications

   
 
Figure 4.  Normalized spectra plots obtained for pure soil in the UV-VIS range and NIR range. 
D. Soil properties prediction 
The principle of the soil's properties prediction is based 
on identifying the measurement from the research dataset. 
This measurement has shape variation as close as possible to 
the shape variation of the test measurement belonging soil, 
which characteristics need to be predicted. Then, chemical 
characteristics of the identified measurement are used to 
indicate the properties of the soil. The leave-one-out 
principle [13] is applied to validate the classification 
accuracy, where each sample is excluded from the dataset 
and used as a testing set. The rest of the samples are then 
joined in a training set.  
The classification procedure consists of feature extraction 
and machine learning. Several feature extraction methods, 
such as' regionprops', moment invariants, etc., are proposed 
in the literature. However, each particular task requires a 
complex analysis to estimate the optimal features enabling 
the best classification of high-dimensional data. Thus, 
classification based on a principal component analysis (PCA) 
[14] is used in this research allowing the most optimal 
performance, where fixed threshold Th=0.2 was applied on 
the feature weights to reduce irrelevant features (Figure 5). 
The PCA maximizes the expected classification accuracy 
reducing feature vector. The decision tree procedure was 
used 
for 
machine 
learning 
to 
estimate 
parameters 
characterizing the training set [15].  
III. 
RESULTS AND DISCUSSIONS 
This section demonstrates the effectiveness of the 
electrical impedance and optical methods for identifying the 
soil samples in research dataset A and research Dataset B 
using a classification-based approach. Measurements were 
performed using set-ups described in Section II for electrical 
impedance and optical methods. Thus, 21 feature vectors 
corresponding to 7 soils from Dataset A and 24 feature 
vectors corresponding to 8 soils from Dataset B were 
obtained during electrical impedance measurement. During 
optical measurement, 49 feature vectors corresponding to 7 
soils from Dataset A and 56 feature vectors corresponding to 
8 soils from Dataset B were obtained. Tables IV and V show 
the results of the leave-one-out classification for research 
datasets with entirely different characteristics. Classification 
results from the corresponding optical method are shown 
separately for the UV-VIS range and NIR range to 
investigate their effectiveness for the soil properties 
prediction. As can be noted, the optical approach enables 
more accurate sample identification when the electrical 
impedance is less accurate. The incorrect identification of the 
soil samples with different amounts of the phosphorus can be 
observed. This can be explained by a small difference 
between measurements corresponding to pure soil and soil 
with added potassium fertilizer. In this research, it was 
observed that the impedance response of the phosphorus 
fertilizer is the smallest compared to other fertilizers under 
analysis. The NIR range showed results that are also less 
accurate than the VIS range. Therefore, it is possible to 
provide a characterization using only the VIS range.   
Figure 5 shows the weights of the dataset values for 
different methods. The essential features for classification 
using the UV-VIS range are concentrated near the NIR 
range. 
Features 
corresponding 
electrical 
impedance 
magnitudes can also be easily observed and detected near the 
domain end. Therefore, using feature selection procedure it is 
possible to significantly reduce frequencies and wavelengths 
required for accurate analysis. The fixed threshold in our 
analysis was selected based on the visual inspection and 
enabled 
good 
delineation 
between 
informative 
and 
uninformative features. Nevertheless, for different set-up it is 
possible to detect threshold invisibly based on the statistical 
analysis of the all feature weight. For this purpose, the 
automatic Otsu method can be used [16].  
TABLE IV. CLASSIFICATION RESULTS FOR DATASET A.  
method of data capturing 
P, 
mg/100g 
K, 
mg/100g 
M,  
mg/100g 
El. impedance measurements  
77% 
71% 
100% 
UV-VIS range measurements 
90% 
84% 
100% 
NIR range measurements 
90% 
81% 
100% 
TABLE V. CLASSIFICATION RESULTS FOR DATASET B.  
method of data 
capturing 
P, 
mg/100g 
K, 
mg/100g 
M,  
mg/100g 
El. impedance measurements  
75% 
96% 
100% 
UV-VIS range measurements 
80% 
91% 
93% 
NIR range measurements 
75% 
92% 
88% 
100
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-820-4
SENSORDEVICES 2020 : The Eleventh International Conference on Sensor Device Technologies and Applications

 
           (a)                                                (b)                                               (c) 
Figure 5.  Feature weights corresponding (a) frequency domain, (b) UV-VIS range, and (c) NIR range 
 
The classification results obtained for soils located in 
entirely different Slovenia locations indicate the potential of 
the sensors for a real-time field fertilization analysis. The 
difference between classification accuracy obtained for 
Dataset A and Dataset B can be explained by the fertilizer 
difference used in the analysis. Thus, a different chemical 
solution may have different influence on the measurements 
when performing measuring.   
Due to the obtained results, it can be concluded that there 
is possible to obtain the low-cost sensor for soil fertilisation 
characterisation. Feature selection procedure significantly 
reduced the wavelength range and frequencies in our 
analysis without classification accuracy lost. Thus, the final 
price of the sensor would be also reduced.  
 All measurements were carried out under controlled 
laboratory conditions in order to perform accurate methods 
performance comparison. This is a critical step when 
selecting sensor for implementation. The atmospheric 
factors, such as rain and wind, has obviously significant 
influence on the methods that will be discovered in a future 
work.  
IV. 
CONCLUSION 
The results obtained in this research indicate the potential 
of both electrical impedance and optical method for accurate 
soil analysis and nutrients identification alone when 
performing characterization within a field. Due to the high 
sensitivity of the electrical impedance measurements to the 
various factors, such as texture, temperature, etc., it is critical 
to minimize their influence on the classification procedure. 
The feature extraction using principal component analysis 
enables detecting the most informative frequencies and 
wavelengths for a low-cost real-time sensor implementation. 
Only the VIS range for optical spectroscopy is required. The 
electrical impedance method in this research performs better 
for magnesium identification and less accurate for 
phosphorus due to the different impacts of the fertilizer on 
the measurements.   
REFERENCES 
[1] A. Bah, S. Balasundram, and M.H.A. Husni, "Sensor 
Technologies for Precision Soil Nutrient Management and 
Monitoring", American Journal of Agricultural and Biological 
Science, vol. 7, pp. 43-49, 2012.   
[2] G. Pajares, "Advances in sensors applied to agriculture and 
forestry", vol. 11, pp. 8930–8932, December 2011. 
[3] V. I. Adamchuk, J. W. Hummel, and M. T. Morgan, S. K. 
Upadhyaya, "On-the-go Soil Sensors for Precision Agriculture.", 
Computers and electronics in agriculture, vol. 44, issue 1, pp. 71-91, 
July 2004. 
[4] A. K. Rêgo Segundo et al., "A Novel Low-Cost 
Instrumentation System for Measuring the Water Content and 
Apparent Electrical Conductivity of Soils", Sensors, vol. 15, Issue 
10, pp. 25546-25563, October 2015.  
[5] W. S. Lee et al., "Sensing technologies for precision 
specialty crop production", Computers and Electronics in 
Agriculture, vol. 74, issue 1, pp. 2–33, 2010. 
[6] M. I. Luleva, H. van der Werff, V. Jetten, and F. van der 
Meer, "Can infrared spectroscopy be used to measure change in 
potassium nitrate concentration as a proxy for soil particle 
movement?", Sensors (Basel), vol. 4, issue 4, pp. 4188-4206, 2011. 
[7] U. Lazuardi and S. Rahmondia, "Low Cost Soil Sensor 
Based on Impedance Spectroscopy for In-Situ Measurement", AIP 
Conference Proceedings, American Institute of Physics, 
April 2015, vol. 1656, issue 1, pp. 040005(1-9), ISBN: 978-
0-7354-1298-9. 
[8] G. Pandey, R. Kumar, and R. J. Weber, "Real Time 
Detection of Soil Moisture and Nitrates Using On-Board In-Situ 
Impedance Spectroscopy", 2013 IEEE International Conference on 
Systems, Man, and Cybernetics, Manchester, 2013, pp. 1081-1086, 
2013, doi: 10.1063/1.4917112. 
[9] Agriculture Institute of Slovenia. [retrieved: October, 
2020] 
Available 
online 
from: 
http://arhiv.kis.si/pls/kis/!kis.web?j=EN  
[10] M. Sirsat, E. Cernadas, M. Fernandez-Delgado, and R. 
Khan, "Classification of agricultural soil parameters in India", 
Computers and Electronics in Agriculture, vol. 135, pp. 269 – 279, 
2017.  
[11] The Mathworks, Inc., Natick, Massachusetts. MATLAB 
version 8.5.0.197613 (R2015a), 2015. 
[12] O. Chambers, A. Sešek, R. Ražman, J. F. Tasič, and J. 
Trontelj, "Fertiliser characterisation using optical and electrical 
impedance methods", Computers and Electronics in Agriculture, 
vol. 155, pp. 69-75, 2018. 
[13] K. Anbumani and R. Nedunchezhian. Soft 
Computing 
Applications 
for 
Database 
Technologies: 
101
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-820-4
SENSORDEVICES 2020 : The Eleventh International Conference on Sensor Device Technologies and Applications

Techniques and Issues. Hershey, PA: IGI Global, 2010. 
http://doi:10.4018/978-1-60566-814-7. 
[14] Yang, W., K. Wang, and W. Zuo. "Neighborhood 
Component Feature Selection for High-Dimensional Data", Journal 
of Computers, vol. 7, issue 1, pp. 161-168, January, 2012. 
[15] W. Y. Loh, "Regression Trees with Unbiased Variable 
Selection and Interaction Detection", Statistica Sinica, vol. 12, pp. 
361–386, 2002. 
[16] Nobuyuki Otsu. "A threshold selection method from gray-
level histograms". IEEE Trans. Sys. Man. Cyber. Vol 9, issue 1, pp. 
62–66, 1979. 
 
 
 
 
 
 
 
102
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-820-4
SENSORDEVICES 2020 : The Eleventh International Conference on Sensor Device Technologies and Applications

