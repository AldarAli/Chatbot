Influence of the Channel Model in the Optimum Switching Points in an Adaptive 
Modulation System 
 
Ana Paula Teles Ribeiro da Silva and José Marcos Câmara Brito 
Instituto Nacional de Telecomunicações - INATEL 
Santa Rita do Sapucaí, Brazil 
e-mail:anaptrs@gmail.com, brito@inatel.br  
 
 
Abstract— Adaptive modulation techniques have been widely 
employed in order to improve the performance of wireless 
networks. 
The 
switching 
point 
between 
neighboring 
modulations is a key issue to define the performance of an 
adaptive modulation system. In this paper, we analyze in depth 
the influence of the fading channel model in the optimum 
switching points considering the maximum throughput as the 
criterion to determine the switching points. 
Keywords- Adaptive modulation; Nakagami-m fading; 
optimum switching points; maximum throughput criterion. 
I. 
 INTRODUCTION  
Due to the growing demand for high transmission rates 
and the scarcity of spectrum in wireless networks, several 
studies have been developed to improve the performance and 
ensure Quality of Service (QoS) for such networks.  
The adaptive modulation technique has been studied in 
order to improve the performance of time-varying conditions 
channels, maintaining the required performance [1]-[3]. This 
scheme consists of the dynamic adaptation of the modulation 
scheme as a function of the channel’s state. The receptor 
makes an estimation of the channel state and sends this 
information back to the transmitter through a feedback 
channel. Based on this information, the transmitter changes 
the modulation order, choosing a modulation that better 
matches with the conditions of the channel at that time [1]-
[5]. 
In general, the change of modulation order occurs 
between neighboring modulations (for a modulation with 2n  
points in its constellation, the neighboring modulations has 
1
2n  or 
1
2n points in its constellation). A key issue in 
adaptive modulation schemes is to define the best point to 
switch from one modulation to its neighboring modulation 
[4][5]. 
The switching points between neighboring modulations 
can be determined in several ways, and the most commonly 
used in the literature is to determine the switching as a 
function of a target for the bit error rate (BER) [2], or a target 
for the packet error rate (PER) in the channel [1]. However, 
in [4] the authors show that these criteria can't optimize some 
quality of service parameters, like throughput; thus, these 
authors propose the determination of the optimum switching 
points based on the maximum throughput criterion in the 
wireless channels. The analysis presented in [4] consider a 
memory-less channel, e.g., an AWGN channel. Then, in [5], 
the authors use the same criterion, but considering Rayleigh 
fading channels, and show that the model of the channel 
affects the optimum switching points. 
In this paper, we analyze in depth the influence of the 
channel model in the optimum switching points of an 
adaptive modulation scheme.  For this, we consider the more 
generic Nakagami-m channel model. We consider a wireless 
network over a Nakagami-m block fading channel with 
adaptive M-ary Quadrature Amplitude Modulation (M-
QAM). Thus, this paper extends the analysis presented in [5] 
considering several different fading channels, besides the 
Rayleigh fading model considered in [5]. 
The remainder of this paper is organized as follows: In 
Section II, we introduce the channel model; in Section III, 
we present the calculation of the exact PER in the channel, 
necessary to compute the throughput; the maximum 
throughput criterion is shown in Section IV; Section V 
presents the numerical results, and finally we present our 
conclusions in Section VI. 
II. 
CHANEL MODEL  
We assumed that the transmissions occur over a slowly-
varying flat-fading channel, modeled as a Nakagami-m block 
fading channel, where the choice of modulation in the 
physical layer is made on a frame-by-frame basis, so that the 
channel gain remains invariant on a single frame, but may 
vary between adjacent frames [1][3]. 
The signal-to-noise ratio (SNR) in the receiver can be 
statistically described by a general Nakagami-m model, with 
probability density function (pdf) given by: 
 
1
( )
exp
.
( )
m
m
m
m
m
p
m















 
(1) 
where  is the average received SNR, ( )
 m
 is the Gamma 
function defined by
1
0
( )
,
m
x
m
x
e dx




 
 and m is the 
Nakagami fading parameter [1]. 
The Nakagami-m fading model is equivalent to a set of 
independent Rayleigh fading channels obtained by maximum 
ratio combining (MRC), with the diversity order of m 
[6].The Nakagami-m distribution is an approximation widely 
used in literature for representing a wide range of multipath 
7
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

channels [2]. For 
m  0.5,
 the Nakagami fading model 
represents the unilateral Gaussian distribution (which 
corresponds to the highest amount of multipath fading 
scenario). When 
m 1,
 it assumes a Rayleigh distribution 
model. For 
m 1,
 there is a one-to-one mapping between 
the Nakagami fading parameter and the Rician factor and 
allows the Nakagami distribution to approach the Rice 
distribution [2]. Furthermore, reference [2] claim that the 
Nakagami-m distribution often gives the best fit to urban and 
indoor multipath propagation. 
Thus, in this paper, we study the impacts of the variation 
of the parameter m in the optimum switching points in an 
adaptive modulation scheme. 
III. 
CALCULATION OF THE EXACT PER 
A. Instantaneous PER 
We employed several n-mode modulation schemes in our 
analysis: M-QAM with M = 8, 16, 32, 64, 128 and 256. Each 
M-ary modulation scheme has Rn bits per symbol, where and 
n = 1, 2… 6 the modulation mode (one of the six considered 
modulations). 
The data is transmitted in packets containing a fixed 
number of bits, called np. Therefore, in each modulation 
mode each packet is mapped in np / Rn symbols [1]. 
For a system where the bits inside a packet have the same 
BER and the bit-errors are uncorrelated, the PER can be 
calculated as a function of the BER, as in [1]: 


1
1
.
np
PER
BER
 

 
(2) 
However, the author of [1] claims that the PER 
calculation through BER in (2) isn't accurate for large-size 
QAM constellations because the information bits of the same 
packet incurs different error probabilities for such 
constellations. 
In this paper, we use the approach proposed in [1] to 
compute the PER in the system, which, in turn, is based on 
the methodology proposed in [7] to compute the exact BER 
for an arbitrary rectangular M-QAM modulation.  
To compute the BER, following [7], we consider that a 
rectangular M-QAM modulation can be modeled as two 
independent pulse amplitude modulation (PAM), I-ary and J-
ary, where
* .
M
I
J

 The exact BER expression is obtained 
by observing regular patterns that occur due to the 
characteristics of Gray code bit mapping. The error 
probability of the kth bit in-phase components of the I-ary 
PAM, where 

1,2,...,log2 
,
k
I

 is given by [7]: 






1
1
(1 2
)
1
2
1
0
2
2
2
1
2
1
( )
1
2
2
3log
erfc
2
1
2
k
k
k
I
i
k
I
I
i
i
P k
I
I
I J
i
I
J








 
















































 
(3) 
where denotes the SNR per bit, and x
 
  denotes the largest 
integer to .x   
The error probability of the lth bit in the quadrature 
components of the J-ary PAM, where

1,2,...,log2 
,
l
J

 is 
obtained from [7]: 






1
1
(1 2
)J 1
2
1
0
2
2
2
1
2
1
( )
1
2
2
3log
erfc
2
1
.
2
l
l
l
j
l
J
J
j
j
P l
J
J
I J
j
I
J








 
















































 
(4) 
In [1], the authors use the results given by (3) and (4) and 
derive an exact closed-form to compute PER. The exact 
instantaneous PER for each modulation mode as a function 
of the received SNR in a system with rectangular QAM 
symbols is given by [1]: 
2
2
2
2
(
/log (
))
log
1
(
/log (
))
log
1
( )
1
[1
( )]
[1
( )]
.
p
p
n
I J
I
n
I
k
n
I J
J
J
l
PER
P k
P l






 










 
(5) 
To 
compute 
( )
IP k
 and 
( )
JP l
 we 
considered 
I
J
M


for square QAM modulations (256, 64 and 16-
QAM), 
I  8
 and 
J 16
for 128-QAM, 
I  4
 and 
J  8
 
for 32-QAM, and finally
I  2
 and 
J  4
for 8-QAM. 
 
B. Average PER 
As stated earlier, in this system the packets are 
transmitted over a block-fading channel and, to determine 
the average PER, it is necessary to consider the influence of 
the fading. So, the average PER for each modulation mode   
is equal to the integral of the instantaneous PER for the 
current modulation n, multiplied by the probability density 
function of the received SNR (in this case, the pdf of a 
Nakagami-m distribution)[1][8][9]. Therefore, the average 
PER is: 
0
( )
( )
( )
.
n
n
PER
PER
p
d






 
 
(6) 
IV. 
THE MAXIMUM THROUGHPUT CRITERION 
Since we considered an adaptive modulation scheme 
without coding, all transmitted bits will be information bits. 
We consider only correct packets to compute the throughput 
(some authors refer to this as goodput). Thus, to compute the 
normalized throughput of the current modulations, we 
consider the following factors [4]:  
8
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

 
Figure 1. Throughput for m = 0.5 and 256, 128 and 64-QAM. 
 
 
Figure 3. Throughput for m = 1 and 256, 128 and 64-QAM. 
 
 
Figure 2. Throughput for m = 0.5 and 64, 32, 16 and 8-QAM. 
 
 
The ratio between the maximum numbers of 
transmitted bits and the maximum number of 
possible bits. In other words, the number of bits per 
symbol of the current modulation over the number of 
bits per symbol of a reference modulation (in our 
case, 256-QAM); 
 
The percentage of packets correctly transmitted. 
The normalized throughput of the current modulation is 
given by: 
2
2
log
log
i
c
r
M
P
M
 

 
(7) 
where Mi is the number of points in the constellation of the 
current modulation, Mr is the number of points in the 
constellation of the reference modulation and Pc is the 
probability of a packet being correctly transmitted, given by, 
(1
).
cP
PER


 
V. 
NUMERICAL RESULTS 
In this section, we present numerical results for the 
optimum switching points using the maximum throughput 
criterion. We considered 256-QAM as the reference 
modulation and we set the packet length, following [5], np = 
424 bits. We analyze the influence of the fading on the 
optimum switching points by varying the diversity order m 
of the fading Nakagami considering m = 0.5, 1, 2, 3 and 10 
(this value was used in order to consider an AWGN-like 
channel). 
To compute the throughput, for a given modulation and a 
given average SNR, we compute the PER using (3), (4), (5) 
and (6), then we compute the throughput using (7). All 
computations were done using Mathcad software. 
Figures 1, 3, 5, 7 and 9 show the throughput curves, as a 
function of the average SNR, for m = 0.5, 1, 2, 3 and 10, and 
modulations 256, 128, 64-QAM, respectively. Figures 2, 4, 
6, 8 and 10 show the throughput curves, as a function of the 
average SNR, for the same m = 0.5, 1, 2, 3 and 10, but now 
considering the modulations 64, 32, 16 and 8-QAM, 
respectively. 
The optimum switching point between two neighboring 
modulations is obtained by the crossing point of the 
corresponding throughput curves. 
Table I shows the optimal switching points and the 
throughput in these points. We can observe that the 
throughput in the switching points increases with the 
increasing of the diversity order m. So, in a system with 
adaptive modulation at the physical layer, if the diversity 
order increases, i.e., the channel becomes less severe in 
terms of fading, the throughput in the switching points 
improves. 
 
 
 
 
 
 
 
9
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 5. Throughput for m = 2 and 256, 128 and 64-QAM. 
 
 
Figure 8. Throughput for m = 3 and 64, 32, 16 and 8-QAM. 
 
 
Figure 6. Throughput for m = 2 and 64, 32, 16 and 8-QAM. 
 
 
Figure 7. Throughput for m = 3 and 256, 128 and 64-QAM. 
 
 
Figure 9. Throughput for m = 10 and 256, 128 and 64-QAM. 
 
 
 Figure 4. Throughput for m = 1 and 64, 32, 16 and 8-QAM. 
10
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

 
 
 
 
 
 
 
 
 
 
TABLE I.         OPTIMUM SWITCHING POINTS AND THROUGHPUT 
Switch 
from 
m 
Average SNR (dB) 
Switching points 
Throughput 
( ) 
256 to128-
QAM 
0.5 
32.7 
0.559 
1 
32.3 
0.685 
2 
31.6 
0.77 
3 
31.2 
0.806 
10 
30.1 
0.846 
128 to 64-
QAM 
0.5 
33.7 
0.592 
1 
31.9 
0.671 
2 
30.4 
0.718 
3 
29.6 
0.729 
10 
28.2 
0.746 
64 to 32-QAM 
0.5 
25.1 
0.353 
1 
25.1 
0.449 
2 
24.9 
0.527 
3 
24.6 
0.553 
10 
23.9 
0.603 
32 to 16-QAM 
0.5 
25.4 
0.364 
1 
24.5 
0.429 
2 
23.5 
0.469 
3 
23 
0.484 
10 
21.8 
0.492 
16 to 8-QAM 
0.5 
16.5 
0.168 
1 
17.3 
0.231 
2 
17.6 
0.289 
3 
17.6 
0.311 
10 
17.3 
0.353 
 
Also, we can see that the optimum switching points vary 
with the channel model (represented by the parameter m of 
the Nakagami model). Also, for a particular value of m, we 
can observe that the SNR at the switching points is not a 
fixed value, but varies with the neighboring modulations. 
Finally, we can observe that the switching points between 
some neighboring modulations are close to each other. For 
example, the switching point between the neighboring 
modulations 256-QAM to 128-QAM is close to the 
switching point between the neighboring modulations 128-
QAM to 64-QAM, for m = 1, 2, 3 and 10. The switching 
point between the neighboring modulations 64-QAM to 32-
QAM is also close to the switching point between the 
neighboring modulations 32-QAM to 16-QAM, and, 
therefore, their throughput is close as well, for all considered 
m. Based on this result, we can conclude that some 
modulations (like 128-QAM and 32-QAM) can't be 
considered in the implementation of an adaptive modulation 
system. 
Furthermore, for 
m  0.5
 the switching point from 128 
to 64-QAM occurs before the switching point from 256 to 
128-QAM, similarly, the switching point from 32 to 16-
QAM occurs before the switching point from 64 to 32-QAM. 
Thus, 128-QAM and 32-QAM should not be used in the 
adaptive modulation system in this case. 
VI. 
CONCLUSION  
In this paper, we considered a system with an adaptive 
modulation technique, considering a Nakagami-m fading 
channel model, and we analyzed the optimum switching 
points between neighboring modulations by using the 
maximum throughput criterion. We considered M-QAM 
modulations, with M = 8, 16, 32, 64, 128 and 256, and we set 
the diversity order to m = 0.5, 1, 2, 3 and 10. 
We observed that if we modify the diversity order m of 
the Nakagami fading model, the optimum switching points, 
and the throughput in the switching points changed. So, the 
higher is the parameter m, higher is the throughput. 
We also observed that some switching points between 
neighboring modulations are close to each other, indicating 
that some modulations (like 128-QAM and 32-QAM) can be 
neglected in the implementation of a practical adaptive 
modulation scheme. 
ACKNOWLEDGMENT 
This work was partially supported by Finep, with 
resources from Funttel, Grant No. 01.14.0231.00, under the 
Radiocommunication 
Reference 
Center 
(Centro 
de 
Referência em Radiocomunicações - CRR) project of the 
National Institute of Telecommunications (Instituto Nacional 
de Telecomunicações - Inatel), Brazil. 
REFERENCES 
[1] Q. Liu, S. Zhou, and G. B. Giannakis, “Cross-Layer 
combining of adaptive Modulation and coding with truncated 
ARQ over wireless links,” IEEE Trans. Wirel. Commun., vol. 
3, no. 5, Sep. 2004, pp. 1746–1755. 
[2] M.-S. Alouini and A. J. Goldsmith, “Adaptive Modulation 
over Nakagami Fading Channels,” Wirel. Pers. Commun., 
vol. 13, no. 1–2, May 2000, pp. 119–143. 
[3] T. Quazi and H. Xu, “Performance analysis of adaptive M-
QAM over a flat-fading Nakagami-m channel,” South Afr. J. 
Sci., vol. 107, no. 1–2, Feb. 2011, pp. 1–7. 
[4] J. M. C. Brito and I. S. Bonatti, “Analysing the optimal 
threshold level for adaptive modulation in the wireless ATM 
networks,” Proc Iasted Int. Conf. Wirel. Opt. Commun. Banf 
Can., Jul. 2002, pp. 510–515. 
 
Figure 10.   Throughput for m = 10 and 64, 32, 16 and 8-QAM. 
 
11
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

[5] M. S. Y. Bandiri and J. M. C. Brito, “Analyzing the Optimum 
Switching Points for Adaptive Modulation in Wireless 
Networks with Rayleigh Fading,” 6th IEEE Lat.-Am. Conf. 
Commun, Nov. 2014, six pages. 
[6] Z. Wang and G. B. Giannakis, “A simple and general 
parameterization 
quantifying 
performance 
in 
fading 
channels,” IEEE Trans. Commun., vol. 51, no. 8, Aug. 2003, 
pp. 1389–1398. 
[7] K. Cho and D. Yoon, “On the general BER expression of 
one- and two-dimensional amplitude modulations,” IEEE 
Trans. Commun., vol. 50, no. 7, Jul. 2002, pp. 1074–1080. 
[8] Y. Xi, A. Burr, J. Wei, and D. Grace, “A General Upper 
Bound to Evaluate Packet Error Rate over Quasi-Static 
Fading Channels,” IEEE Trans. Wirel. Commun., vol. 10, no. 
5, May 2011, pp. 1373–1377. 
[9] A. J. de Faria and J. M. C. Brito, “A New Throughput 
Analysis in Cognitive Radio Networks Using Slotted 
CSMA,” presented at the COCORA 2013, The Third 
International Conference on Advances in Cognitive Radio, 
Apr. 2013, pp. 1–6. 
12
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-450-3
ICN 2016 : The Fifteenth International Conference on Networks (includes SOFTNETWORKING 2016)

