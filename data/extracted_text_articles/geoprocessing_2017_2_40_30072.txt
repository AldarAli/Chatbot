Combining Ground Penetrating Radar Scans of Differing Frequencies Through 
Signal Processing 
 
Roger Tilley, Hamid Sadjadpour 
Department of Electrical Engineering 
University of California, Santa Cruz 
Santa Cruz, CA. 95064 
Email: rtvax@soe.ucsc.edu, Email: hamid@soe.ucsc.edu  
Farid Dowla 
Lawrence Livermore National Laboratory 
Livermore, CA. 94550 
Email: dowla1@llnl.gov 
 
 
Abstract— Interference reduction is vital in delivering a clear 
usable signal, whether in the form of beamforming in a noisy 
environment 
of 
radar 
target 
responses, 
or 
effective 
communication in the presence of noise for mobile phone users, 
as examples.  The methods used to render a cleaner signal can 
also be used to combine signals of various frequencies.  In this 
paper we explore using an optimization problem solver, the 
Expectation-Maximization Algorithm, to define the weights to 
be used to combine multiple Ground Penetrating Radar 
frequency scans over the same target area. This approach 
exploits the Gaussian Mixture Model feature to combine the 
scans to produce a cleaner image at depth. Our method 
demonstrates a measured improvement toward producing a 
cleaner image. 
Keywords- 
Ground 
Penetrating 
Radar; 
Expectation-
Maximization; Gaussian Mixture  Model; Maximum Likelihood 
Parameter Estimation; Finite Difference Time Domain Method; 
GprMax . 
I. 
 INTRODUCTION 
Ground Penetrating Radar (GPR) signal scans are used to 
illuminate terrain and buried objects at various depths.  The 
frequency scan that generates the best illumination is 
different for each depth.  In general, higher frequencies 
image objects and terrain closer to the surface in great detail 
while lower frequencies image objects deeper with less 
fidelity.  Developing a way to combine high and low 
frequencies suggests that the resolution of the combined 
signal is increased to a lower depth.  Determining how to 
weight each frequency signal to be combined for an optimal 
result, poses as an optimization problem to solve.  In the 
literature a few methods have been proposed to solve this 
problem with varying success, all with a very similar 
approach.  Methods by Dougherty[1], Booth[2] and 
Bancroft[3] all discussed ways to weight each signal used in 
the sum of each system of frequency traces.   
Dougherty’s effort to enhance the original GPR data 
involved direct wave removal, bandwidth enhancement, and 
cross-correlation analysis.  Dougherty aligned each trace by 
the direct arrival pulse. Scaled each trace by the L2 norm of 
the direct arrival pulse then simply summed the frequency 
traces after removing the direct arrival pulse and equally 
weighting each trace.   
Booth used weights derived from the maximum value of 
the frequency spectra of each trace.  The value used to 
equalize the spectra provided the signal trace weighting prior 
to summation.  Booth’s weights were derived from a time-
variant least squares analysis of the amplitude spectra of 
each frequency data set, referred to as optical spectral 
whitening.   
Bancroft uses a ramped summation method where the 
higher frequency data is suppressed by the same amount the 
lower frequency data is enhanced over a portion of the two 
way transit time of a GPR trace, determined by Bancroft and 
referred to as amplitude envelope equalization.   
Absent from these works are optimization problem 
solvers.  We have chosen to investigate the use of an 
optimization problem solver referred to as the Expectation-
Maximization (EM) Algorithm; using the data mixture 
feature of the EM Algorithm to develop optimal weights. 
In this paper, we illustrate the EM Algorithm data 
mixture feature as it relates to GPR scans of different 
frequencies.  The paper is organized as follows.  In 
SECTION II, we describe the EM Algorithm data mixture 
process.  In SECTION III, we present an EM algorithm test 
case.  In SECTION IV, GPR scans over the same area are 
processed using EM Algorithm tools developed to combine 
the frequencies.  SECTION V draws some conclusions from 
using this approach. 
II. 
EXPECTATION-MAXIMIZATION ALGORITHM 
The EM Algorithm, is often used to group like items 
contained in complex mixtures.  Another use is to solve 
incomplete data problems by performing Maximum 
Likelihood (ML) Parameter estimation.  An offshoot use for 
the EM algorithm is determining the membership weights of 
points in a cluster within a finite Gaussian mixture model 
[4][9].  This feature will be exploited to combine several 
frequency scans into a composite wave.  The entire data set 
can be represented by other mathematical distributions but 
we used Gaussian because it is often used when the 
distribution for the real-valued random variables is unknown. 
We can define a finite mixture model 𝑓𝑓(𝑥𝑥; 𝜃𝜃)  of 𝐾𝐾 
components as mixtures of Gaussian functions: 
 
𝑓𝑓൫𝑥𝑥; 𝜃𝜃൯ = ∑
𝛼𝛼𝑘𝑘𝑝𝑝𝑘𝑘(𝑥𝑥| 𝜃𝜃𝑘𝑘)
𝐾𝐾
𝑘𝑘=1
 
(1) 
 
 
 
 
32
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-539-5
GEOProcessing 2017 : The Ninth International Conference on Advanced Geographic Information Systems, Applications, and Services

Where:  
- 
𝑝𝑝𝑘𝑘൫𝑥𝑥ห𝜃𝜃𝑘𝑘൯  are K mixture components with a 
distribution defined over 𝑝𝑝൫𝑥𝑥|𝜃𝜃𝑘𝑘൯ with parameters 
𝜃𝜃𝑘𝑘 = ቄ𝜇𝜇𝑘𝑘, 𝐶𝐶𝑘𝑘ቅ  (mean, covariance) 
- 
𝑝𝑝𝑘𝑘൫𝑥𝑥ห𝜃𝜃𝑘𝑘൯ = 
 
1
(2𝜋𝜋)𝑑𝑑 2
⁄  |𝐶𝐶𝑘𝑘|1 2
⁄ 𝑒𝑒− 1
2ቀ𝑥𝑥−𝜇𝜇𝑘𝑘ቁ
𝑇𝑇
𝐶𝐶𝑘𝑘−1ቀ𝑥𝑥−𝜇𝜇𝑘𝑘ቁ 
(2) 
- 
𝛼𝛼𝑘𝑘 are the mixture weights, where  ∑
𝛼𝛼𝑘𝑘
𝐾𝐾
𝑘𝑘=1
= 1. 
- 
൛𝑥𝑥𝑖𝑖, … … … , 𝑥𝑥𝑛𝑛ൟ  Data set for a mixture component 
in d dimensional space. 
 
In each iteration of the EM Algorithm, there are 2 steps, 
the Expectation step (E-step) and the Maximization step (M-
step).   In this case the E-Step computes the conditional 
expectation of the group membership weights (𝑤𝑤𝑖𝑖𝑘𝑘′𝑠𝑠) for 
𝑥𝑥𝑖𝑖′𝑠𝑠  , adding unobservable data given 𝜃𝜃𝑘𝑘 .  The M-Step 
computes new parameter values ቀ𝛼𝛼𝑘𝑘, 𝜇𝜇𝑘𝑘, 𝐶𝐶𝑘𝑘ቁ to maximize 
the finite mixture model using the membership weights.  The 
E-Step and M-Step are repeated until stopping criteria is 
reached (convergence).  Convergence is signaled by the log-
likelihood of 𝑓𝑓(𝑥𝑥; 𝜃𝜃) not appearing to change substantially 
from one iteration to the next. 
 
E-Step – 
𝑤𝑤𝑖𝑖𝑘𝑘 = 
𝑝𝑝𝑘𝑘൫𝑥𝑥𝑖𝑖|𝜃𝜃𝑘𝑘൯∗𝛼𝛼𝑘𝑘
∑
𝑝𝑝𝑚𝑚൫𝑥𝑥𝑖𝑖|𝜃𝜃𝑚𝑚൯∗𝛼𝛼𝑚𝑚
𝐾𝐾
𝑚𝑚=1
  
 
(3)  
 
for  1 ≤ 𝑘𝑘 ≤ 𝐾𝐾,   1 ≤ 𝑖𝑖 ≤ 𝑁𝑁;  
  
 
with constraint ∑
𝑤𝑤𝑖𝑖𝑘𝑘
𝐾𝐾
𝑘𝑘=1
= 1   
 
 
M-Step – 
𝑁𝑁𝑘𝑘 = ∑
𝑤𝑤𝑖𝑖𝑘𝑘
𝑁𝑁
𝑖𝑖=1
  
 
(4) 
 
𝛼𝛼𝑘𝑘
𝑛𝑛𝑛𝑛𝑛𝑛 = 
𝑁𝑁𝑘𝑘
𝑁𝑁  , for  1 ≤ 𝑘𝑘 ≤ 𝐾𝐾  
(5) 
 
𝜇𝜇𝑘𝑘
𝑛𝑛𝑛𝑛𝑛𝑛 = ቀ
1
𝑁𝑁𝑘𝑘ቁ ∑
𝑤𝑤𝑖𝑖𝑘𝑘 ∗ 𝑥𝑥𝑖𝑖
𝑁𝑁
𝑖𝑖=1
   
(6)  
 
for  1 ≤ 𝑘𝑘 ≤ 𝐾𝐾  
 
 
 
 
𝐶𝐶𝑘𝑘
𝑛𝑛𝑛𝑛𝑛𝑛 =    
 
ቀ
1
𝑁𝑁𝑘𝑘ቁ ∑
𝑤𝑤𝑖𝑖𝑘𝑘 ∗ ቀ𝑥𝑥𝑖𝑖 − 𝜇𝜇𝑘𝑘
𝑛𝑛𝑛𝑛𝑛𝑛ቁ ቀ𝑥𝑥𝑖𝑖 − 𝜇𝜇𝑘𝑘
𝑛𝑛𝑛𝑛𝑛𝑛ቁ
𝑇𝑇
𝑁𝑁
𝑖𝑖=1
  (7) 
 
Convergence (log likelihood of  𝑓𝑓(𝑥𝑥; 𝜃𝜃) ) – 
 
Log 𝑙𝑙(𝜗𝜗) =  
 
∑
log 𝑓𝑓൫𝑥𝑥𝑖𝑖; 𝜃𝜃൯ = 
𝑁𝑁
𝑖𝑖=1
  
 
 
 
 
∑
൫log ∑
𝛼𝛼𝑘𝑘𝑝𝑝𝑘𝑘൫𝑥𝑥𝑖𝑖ห𝜃𝜃𝑘𝑘൯
𝐾𝐾
𝑘𝑘=1
൯
𝑁𝑁
𝑖𝑖=1
  
(8) 
III. 
EXPECTATION-MAXIMIZATION ALGORITHM TEST 
CASE 
As a test case, we constructed a series of six sine waves 
(50, 150, 250, 350, 450 and 550 Hz) noted in Fig. 1, Fig. 2 
and Fig. 3, which when weighted properly sum to the square 
wave of Fig. 4.  As noted in Fig. 5, the result is not quite a 
square wave but well on the way.  The apparent error can be 
attributed 
to 
the 
constraints 
associated 
with 
this 
implementation; specifically group membership weights, 
𝑤𝑤𝑖𝑖𝑘𝑘 and/or mixture weights,  𝛼𝛼𝑘𝑘 each constrained to sum to 
one.  The weights normally sum to greater than 1 dependent 
on the number of signals added together. The constructed 
sine waves are harmonics of the square wave used 
. 
 
 
Fig. 1 – Sine wave frequencies 50-150 Hz  
 
 
Fig. 2 –Sine wave frequencies 250, 350Hz 
 
33
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-539-5
GEOProcessing 2017 : The Ninth International Conference on Advanced Geographic Information Systems, Applications, and Services

 
Fig. 3 – Sine wave frequencies, 450-550 Hz 
 
 
Fig. 4 – Square wave desired signal 
 
 
Fig. 5 – EM algorithm result with desired signal  
 
 
 
 
 
IV. 
PROCESSING GPR SCANS AT VARIOUS FREQUENCIES 
A fictional area was defined using a Finite Difference 
Time Domain (FDTD) [5][6][7] modeling software package.    
A Proprietary package in development similar in operation to 
the popular GprMax software program by A. Giannopoulos 
[8] was used to model a defined space.  The space consisted 
of a Transmitter (Tx) and Receiver (Rx) suspended 5 meters 
above the ground in air with a target (perfect electrical 
conductor) buried 10 meters below ground in a moist-sand 
medium with a relative permittivity (𝜀𝜀𝑟𝑟 ) of 9.0 and an 
electrical conductivity of 0.001 mS/m.  The transmitter and 
receiver were moved along the length of the defined space as 
shown in Fig. 6 for a total of 36 scans at 0.25 meters per 
step.  The Tx starts at 0.5 meters ending at 9.5 meters, and 
the Rx starts at 0.75 meters ending at 9.75 meters well within 
the defined space of 10 meters in length by 25 meters in 
depth. 
 
 
Fig. 6  Defined Space with buried target at 15 meters depth and Tx’s & Rx’s 
5 meters above ground. 
 
GPR scans over the same defined space were run at 20, 
30, 50, 100, 500 and 900MHz.  The resultant 2-D display for 
each frequency is shown in Figs. 7-14.  Note that in each 
case the object is correctly identified at approximately 10 
meters below ground, approximately 15 meters below Tx’s 
and Rx’s or approximately 240 ns from the direct arrival 
signal (black line on plot).   In Fig. 12 and Fig. 14, a display 
of each trace is shown to better depict the target return 
signal.  The direct arrival signal and ground bounce (radar 
return from the ground) are shown (see arrow 1 in Fig. 7).  
Arrow 2 in Fig. 7 denotes the target reflection at depth. In the 
30MHz trace result (Fig. 8), the target is indicated by arrow 
3.  The remaining unlabeled arrows indicate the target 
reflection at depth for the indicated scan frequency.  Of note, 
is the length of the line indicating the target in frequency 
scans 100MHz and below, representing limited if not non-
existent edge detection.  For this analysis the test area length 
is less than half the depth (25 meters depth by 10 meters 
length), more like a bore hole, contributing to the limited 
target edge detection.  Arrow 4 (Fig. 14) exhibits better edge 
detection. 
 
34
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-539-5
GEOProcessing 2017 : The Ninth International Conference on Advanced Geographic Information Systems, Applications, and Services

 
Fig. 7  2-D GPR scans 20MHz 
 
 
Fig. 8  2-D GPR scan 30 MHz 
 
 
Fig. 9  2-D GPR scan 50 MHz 
 
 
Fig. 10  2-D GPR scan 100MHz,).. 
 
Fig. 11  GPR scan 500MHz 
 
Fig. 12  GPR scan 500MHz (individual traces) 
1 
2 
3 
35
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-539-5
GEOProcessing 2017 : The Ninth International Conference on Advanced Geographic Information Systems, Applications, and Services

 
Fig. 13  GPR scan 900MHz (normal 2 D image display) 
 
Fig.. 14  GPR scan 900MHz (individual traces) 
 
In all of the GPR scan results, of note is that as the 
frequency is increased, the area where the target exists is 
more pronounced.  The opposite occurs as the scan 
frequency is lowered. 
Fig. 15 shows the result of adding each of the frequencies 
together having removed the direct arrival signal and scaling 
each signal max value to the same magnitude.  A broad area 
of target reflection is shown from approximately 240 ns to 
320 ns in depth (two-way travel time); a very rough 
indication of target depth. 
 
 
 
Fig. 15.  Sum of frequency signals with direct arrival and ground bounce 
signals removed. 
 
Fig. 16 and Fig. 17, show the same signals combined 
using the EM algorithm to determine the weight of each 
signal.  Fig. 17 shows the EM processed individual signal 
traces.  The area that is being scanned is more like a bore 
hole, twice as deep as it is wide.  This accounts for the broad 
reverse “u-shaped” area that begins at target depth.  The 
existence of lower frequencies in the sum broadens the 
output result. 
 
 
 
Fig. 16  EM sum of frequency signals with Direct Arrival and ground 
bounce signals removed. 
 
4 
36
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-539-5
GEOProcessing 2017 : The Ninth International Conference on Advanced Geographic Information Systems, Applications, and Services

 
Fig. 17 EM processed signal traces with Direct Arrival and ground bounce 
signals removed. 
 
As a test, a more complex structure was developed.  This 
structure, Fig. 18, consists of an area 30 meters in length and 
25 meters in depth with little or no space above ground, 
(0.15 meters), for the Tx and Rx used.  The Tx and Rx are 
swept along the scan axis length starting at 0.5 meters (Tx) 
and ending at 24.85 meters with spacing between the Tx and 
Rx the same as before (0.25 meters).  The number of GPR 
scans is 145.  The electrical conductivity of the ground is the 
same as before but the relative permittivity (𝜀𝜀𝑟𝑟)  is 3.0 for dry 
sand.  Buried in the ground at 8 different levels (4.565m, 
6.065m, 8.565m, 10.065m, 12.815m, 14.065m, 16.565m and 
18.065m) are sheets of corrugated aluminum, modelled as 
perfect electrical conductors for ease of computation.  Each 
sheet is approximately 2 meters in length and 0.1 meters 
thick.  The GPR scanning frequencies are the same as before.  
The result for the EM method, shown in Fig. 19, identifies 8 
targets at very close to the correct depth (approximately 
50ns, 70ns, 100ns, 116ns, 148ns, 160ns, 190ns and 208ns for 
two-way travel time at a velocity in the medium of 0.1732 
m/ns for the defined relative permittivity) with edges 
depicted reliably but with less fidelity as one descends in 
depth.  Fig. 20 displays the individual GPR traces instead of 
the image response. 
 
 
Fig. 18  EM algorithm Test Case, (8) 2m long plates, 0.1m thick 
 
Fig. 19  GPR scan result for complex structure 
 
 
Fig. 20  EM processed signal traces for complex structure 
 
V. 
CONCLUSIONS AND FUTURE WORK 
We have shown that the Expectation and Maximization 
Gaussian Mixture Model approach to summing sine waves 
of a particular set of frequencies (harmonics of a square 
wave), works reasonably well.  It is not, however, without 
problems associated with the magnitude of the calculated 
weights.  As discussed earlier, the mixture weights are 
constrained to sum to 1; this is not what occurs in actuality.  
The result of summing sine waves was encouraging enough 
to continue this approach to GPR scans.  Since actual 
equipment and a suitable target area were not available, 
computer codes were used to generate the scan area, the 
target, the type of material for the medium, and the resultant 
scans at several frequencies.  The number of frequencies to 
use for this analysis was not defined at any time.  We have 
illustrated that the computer code results is very similar to 
actual scans reported in an earlier paper [10].  We have 
further shown that just removing the direct arrival signal, the 
ground bounce, equalizing the magnitude of each frequency 
and adding the signals together is not sufficient.  The result, 
though it points out the area of interest, the depth where the 
target appears is not well defined, Fig. 15.  The depth 
indicator line is spread over 10s of nanoseconds.  However, 
37
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-539-5
GEOProcessing 2017 : The Ninth International Conference on Advanced Geographic Information Systems, Applications, and Services

the EM method confirms that a more definitive depth 
indication transpires than just adding the frequencies 
together, Fig. 16.  A final test using a more complex 
structure demonstrates the viability of the EM algorithm 
method for GPR analysis, Figs. 19-20.  
Our results illustrate that this approach is promising, 
however, further research is needed to prove its capability 
using more complicated simulated experiments and field 
experiments.  
This work suggests more items to be explored like 
removing any DC shift in the data, any global background 
(mean trace) information in the data and any “wow” (signal 
interference, which manifests itself as low frequency signal 
added to the signal trace).  Lining up each signal trace by the 
peak direct arrival pulse and reprocessing the data or looking 
at how the spectral bandwidth has been changed, are a few 
methods to investigate. 
ACKNOWLEDGMENT 
This work was performed under the auspices of the U.S. 
Department of Energy by Lawrence Livermore National 
Laboratory under Contract DE-AC52-07NA27344. 
 
REFERENCES 
[1] M. E. Dougherty, P. Michaels, J. R. Pelton, L. M. Liberty, 
“Enhancement of Ground Penetrating Radar Data Through 
Signal Processing”, Symposium on the Application of 
Geophysics to Engineering and Environmental Problems 
1994, pp. 1021-1028, Jan 1994, DOI 10.4133/1.2922053 
[2] A. D. Booth, A. L. Endres, T. Murray, “Spectral Bandwidth 
Enhancement of GPR Profiling Data Using Multiple-
Frequency Compositing”, Journal of Applied Geophysics, vol 
67, pp. 88-97, Jan 2009, DOI 10.1016/j.jappgeo.2008.09.015. 
[3] S. W. Bancroft, “Optimizing the Imaging of Multiple 
Frequency GPR Datasets using composite Radargrams: An 
Example from Santa Rosa island, Florida”, PhD dissertation, 
University of South Florida, 2010. 
[4] Padhraic Smyth, “The EM Algorithm for Gaussian Mixtures, 
Probabilistic Learning: Theory and Algorithms, CS274A”, 
University of California, Irvine, Department of Computer 
Science, Lecture Note 4. 
[5] A. P. Annan, “Electromagnetic Principles of Ground 
Penetrating Radar,” in Ground Penetrating Radar Theory and 
Applications, M. J. Harry, Ed., ed Amsterdam: Elsevier, pp. 
1-40,  2009, ISBN: 978-0-444-53348-7.  
[6] A. Tavlove, “Review of the formulation and Applications of 
the Finite-Difference Time-Domain Method for Numerical 
Modeling 
of 
Electromagnetic-Wave 
Interactions 
with 
Arbitrary Structures,” Wave Motion, vol. 10, pp. 547-582, 
Dec 1988, DOI 10.1016/0165-2125(88)90012-1. 
[7] N. Blindow, D. Eisenburger, B. Illich, H. Petzold, and T. 
Richter, “Ground Penetrating Radar,” in Environmental 
Geology, Ed. Springer Berlin Heidelberg, pp. 283-235,  2008, 
DOI 10.1007/978-3-540-74671-3_10. 
[8] A. Giannopoulos, “Modelling Ground Penetrating Radar by 
GprMax”, Construction and Building Materials, vol. 19, pp. 
755-762, Dec 2005, DOI 10.1016/j.conbuildmat.2005.06.007. 
Article in Conference proceedings: 
[9] J. J. Verbeek, N. Vlassis, and B. Krӧse, “Efficient Greedy 
Learning of Gaussian Mixtures”,The 13th Belgian-Dutch 
Conference on Artificial Intelligence (BNAIC’01),pp. 251-
258, 2001,  INRIA-00321510. 
[10] R. Tilley, F. Dowla, F. Nekoogar, and H. Sadjadpour, “GPR 
Imaging for Deeply Buried Objects: A comparative Study 
based on FDTD models and Field Experiments, Selected 
Papers Presented at MODSIM World 2011 Conference and 
Expo; pp. 45-51, Mar. 2012; (NASA/CP-2012-217326); 
(SEE 20130008625) . 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
38
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-539-5
GEOProcessing 2017 : The Ninth International Conference on Advanced Geographic Information Systems, Applications, and Services

