eHealth Trafﬁc Detection and Classiﬁcation Using
Machine Learning Techniques
Monika Grajzer
Telcordia Poland
Applied Research Center
Umultowska 85, 61-614 Pozna´n
Email: mgrajzer@telcordia.com
Piotr Szczechowiak
Telcordia Poland
Applied Research Center
Umultowska 85, 61-614 Pozna´n
Email: pszczech@telcordia.com
Abstract—With the growing number of available eHealth
applications, the amount of eHealth trafﬁc transmitted through
communication networks increases signiﬁcantly. This implies that
network mechanisms must provide Quality of Service (QoS)
assurances to support these new applications. In order to improve
network performance, there is a need to develop new QoS
methods that would properly detect and classify eHealth trafﬁc.
In this paper we present a selection of machine learning -
based trafﬁc classiﬁcation methods in the context of eHealth
services provisioning. We also present a mapping of eHealth
application classes to appropriate QoS classes. Finally we propose
an eHealth-aware approach, which can perform real-time trafﬁc
classiﬁcation. In this technique the packet content is not inspected
and at the same time the privacy of transmitted information is
preserved.
Index Terms—eHealth applications, trafﬁc classiﬁcation, ﬂow
analysis, machine learning;
I. INTRODUCTION
High capacity and throughput of current telecommunica-
tion networks make it possible to provide remote eHealth
services to users, no matter if they are at home or on the
move. Telemedicine applications are gaining popularity and
the amount of eHealth trafﬁc transmitted through commu-
nication networks increases signiﬁcantly. At the same time,
network mechanisms must provide Quality of Service (QoS)
assurances to a whole range of different eHealth applications.
Appropriate service levels should be guaranteed for simple
consulting services as well as life-critical clinical telemedicine
applications.
The increasing demand to ensure appropriate bandwidth,
maximum delay and jitter for telemedicine applications is very
challenging for current network QoS mechanisms. eHealth
services have diversiﬁed demands and each application type
requires different treatment [1]. Existing QoS solutions [2],
[3] were designed to support generic types of applications
and have not been tuned to address e-Health needs. Current
methods have difﬁculties in detecting eHealth trafﬁc and
cannot provide proper classiﬁcation of medical applications.
All these problems have a signiﬁcant impact on the reliability
of eHealth services. In order to improve network performance
there is a need to develop new QoS methods that would
properly detect and classify eHealth applications at the edge
of the network.
We can identify several challenges in the design of QoS
classiﬁcation mechanisms for eHealth trafﬁc. This kind of
trafﬁc is very often related to time-critical applications, where
delays should be kept to minimum. Such behaviour requires
real-time operation of QoS classiﬁcation algorithms. More-
over, early detection of trafﬁc type is necessary to allow
proper handling by the network nodes. Since new eHealth
applications are constantly emerging, the classiﬁer should
also have the ability to recognise previously unknown trafﬁc.
Finally the classiﬁcation is usually performed on an encrypted
trafﬁc, which makes it difﬁcult to asses the packet content. An
ideal method for eHealth trafﬁc classiﬁcation should address
all the above design challenges.
In this paper, we review different trafﬁc classiﬁcation tech-
niques in the context of eHealth services provisioning. We
propose the mapping of eHealth application classes to QoS
classes and point out which e-Health trafﬁc characteristics are
the best metrics for the classiﬁcation algorithms. We also pro-
pose an eHealth-aware classiﬁcation approach, which is based
on Machine Learning (ML) techniques. It takes advantage of
IP trafﬁc classiﬁcation based on statistical properties of a ﬂow.
It applies complex classiﬁcation techniques, where decision
is made through the multi-criteria reasoning without looking
deep into the packet content. By employing this approach the
privacy of the data is intact and classiﬁcation can be performed
at the edge of the network in real time to guarantee proper
handling of eHealth trafﬁc by each network node.
II. RELATED WORK
Trafﬁc classiﬁcation is an important aspect of every QoS
solution and is usually performed at the edge of the network,
where the application trafﬁc originates. In the literature on
QoS solutions for eHealth trafﬁc, we can ﬁnd QoS mechanisms
that investigate priority assignment and scheduling techniques
for eHealth applications [4]. However, these techniques cannot
distinguish medical applications and take an assumption that
eHealth trafﬁc can be easily detected. Such an approach may
lead to incorrect classiﬁcation of eHealth data and decreased
quality of service. Therefore ehealth tarfﬁc classiﬁcation is a
subject to our research.
In general, there are several methods, which address the
trafﬁc classiﬁcation problem in the communication networks
151
Copyright (c) IARIA, 2012.     ISBN: 978-1-61208-179-3
eTELEMED 2012 : The Fourth International Conference on eHealth, Telemedicine, and Social Medicine

[2], [3]. The basic and most common methods are focused
on the evaluation of the QoS related ﬁelds in the IP packet
header. They look at the so called “5 tuple” - a set of
packet’s source IP address, destination IP address, source
and destination TCP/UDP port number and layer 4 protocol
type [2]. Although such classiﬁcation is simple, fast and
differentiates basic networking services (e.g., voice service
from data service), it very often mis-classiﬁes the trafﬁc or
puts trafﬁc from diversiﬁed applications into one category.
Therefore it was argued that such a simple method is not
enough to perform complex classiﬁcation tasks [2], [3], [5].
Additional information about a network ﬂow can be ob-
tained by analyzing the information contained in the packet
payload. This approach, denoted as Deep Packet Inspection
(DPI) [2], investigates application-speciﬁc packet metrics,
which can signiﬁcantly increase classiﬁcation success rate. The
main drawbacks of this approach are problems with access-
ing encrypted messages and high computational complexity
of payload analyzing algorithms (hardware implementations
needed). Moreover DPI techniques require previous knowl-
edge about application-speciﬁc parameters, which have to be
updated for every new application. Since medical data is
usually encrypted and requires real-time packet processing the
applicability of DPI methods to classify this type of trafﬁc is
rather limited.
The techniques described above (port numbers, DPI) have
limited practical relevance in case of eHealth applications, but
they can still serve as a reference (ground-truth) for more
advanced methods. New solutions might be based on machine
learning classiﬁers, which are capable of making decisions
based on the observation of the trafﬁc ﬂow features like
packet lengths and packet inter-arrival times. This makes them
particularly suitable for the classiﬁcation of e-Health trafﬁc.
Previous works on ML trafﬁc classiﬁcation [3], consider
both supervised and unsupervised learning approaches. Both
techniques usually require a training phase to precede the
classiﬁcation phase. Supervised learning techniques are par-
ticularly suitable to solve classiﬁcation problems, whereas
unsupervised learning techniques enable clustering of trafﬁc
ﬂows into groups sharing common features. As such, they
must be accompanied by the labelling algorithm that would
assign particular applications to the identiﬁed clusters, which
is challenging. The additional beneﬁt of these methods is the
ability to classify applications which are unknown. The exam-
ples of ML classiﬁers that can be used for QoS mechanisms
are: J48 Decision Tree, K-Nearest Neighbourhood, Random
Tree, Naive Bayes and the Neural Networks method [3], [5].
Although ML-based techniques have several features making
them suitable to e-Health trafﬁc classiﬁcation, not all of them
are applicable to this particular problem. It has been also
presented that the accuracy of a single classiﬁer is not good
enough to classify different types of applications when early
classiﬁcation is required [5].
A selection of ML techniques and classiﬁers suitable to
e-Health trafﬁc is presented in Section IV. Based on this
methods, we propose a solution, which combines different
TABLE I
EHEALTH APPLICATIONS CLASSIFICATION BASED ON THE REQUIRED QOS
PARAMETERS
Service type
Bandwidth
Delay
Packet loss
Class
Teleconsultation
High
Low
Low
1
HPC services
High
Low
Min
1
HD video
Max
Low
Low
1
HD images
High
Medium
Min
2
Sensor data
Medium
Low
Min
3
Patient data
Medium
Medium
Low
4
e-learning
High
Medium
Low
4
Voice
Medium
Low
Medium
5
classiﬁers in order to maximize the performance and accuracy
of eHealth applications classiﬁcation.
III. EHEALTH TRAFFIC CHARACTERISTIC
There are various types of medical applications and each
of them has different requirements when it comes to quality
of service parameters. The QoS measures have been well
deﬁned in the domain of communication services; however,
they have not been well deﬁned in the eHealth domain. eHealth
service category introduces a more diversiﬁed set of trafﬁc
patterns with bandwidth, delay and reliability requirements
very different from typical network ﬂows. They also introduce
some of the highest QoS requirements among all services
provided over IP networks. Real-time teleconsulation services
require high throughput and are susceptible to packet delays
(speech and HD video transmission). Video streaming from en-
doscopes and other medical devices has similar requirements.
Medical images transmission needs high bandwidth and a very
low packet loss ratio. This is especially important in case of
high resolution images (X-ray, MRI, USG), because distorted
images may lead to a wrong diagnosis. Clinical telemedicine
applications, medical simulation tools and image reconstruc-
tion programs require guaranteed data delivery and minimal
packet loss. Data transmission from medical sensors is not
delay tolerant and even minimal packet loss is unacceptable
(e.g., heart rate monitoring sensors).
Before an appropriate trafﬁc classiﬁcation technique can be
designed, there is a need to characterize different types of
eHealth trafﬁc and identify all its distinctive features. Based
on this information applications can be grouped together into
classes, which require similar service parameters and forward-
ing priorities. This is necessary to properly mark classiﬁed
packets and introduce further QoS mechanisms in the network
(e.g., scheduling).
In Table I, we present the result of our analysis of eHealth
application types in the context of the required QoS parame-
ters. The above classiﬁcation distinguishes ﬁve basic classes of
eHealth applications. The ﬁrst class contains highest priority
services, which have strict requirements regarding bandwidth
and maximum packet delay (e.g. High Perfomance Computing
- HPC services). The second class contains data transmission
services, which need guranteed packet loss rates. The third
152
Copyright (c) IARIA, 2012.     ISBN: 978-1-61208-179-3
eTELEMED 2012 : The Fourth International Conference on eHealth, Telemedicine, and Social Medicine

group of applications gathers services which have low packet
loss and delay. The next class aims at high bandwidth pro-
visioning and has some tolerance against packet delay. The
last class targets VoIP connections in eHealth networks, which
require low packet delay and jitter.
IV. CLASSIFICATION ALGORITHMS AND TRAFFIC
CLASSIFIERS
Having in mind the requirements towards classiﬁcation of e-
health trafﬁc, we have identiﬁed several ML-based techniques
as particularly suitable to the analysis of e-Health trafﬁc.
As a general rule ML classiﬁers investigate multiple ﬂow
descriptors - called features - simultaneously and provide
learning capabilities, which introduce adaptive behaviours.
They need to be trained on the examples of trafﬁc ﬂows
from different applications, and the proper learning process
is crucial to the ﬁnal performance of the classiﬁer. Moreover,
the performance is very often dependent on the type of the
data and on the set of features selected for observation, which
describe characteristics of given application. Therefore, not
all well performing classiﬁers would be valuable during the
analysis of e-Health trafﬁc.
In order to identify ML classiﬁers, which are the most
suitable for our research subject, we have deﬁned a set of
criteria that are driven by e-Health trafﬁc characteristics:
• Real time operation – most techniques require the obser-
vation of a full trafﬁc ﬂow to provide good classiﬁcation
results. This approach imposes signiﬁcant delay, which
is not tolerable in our case. Therefore in our solution we
need methods where the observation of a whole ﬂow is
not required.
• Low number of necessary packets – a decision regarding
classiﬁcation needs to be made on the shortest possible
part of the ﬂow.
• Ability to perform classiﬁcation based on a randomly
selected part of the ﬂow – in many cases the beginning
of a ﬂow cannot be observed, and the classiﬁer should
still make an accurate decision.
• Small processing overhead – a lightweight solution is
required, but higher overhead is acceptable in the learning
phase, which is performed ofﬂine.
• Ability to classify currently unknown application types.
• Small number of required features.
• Ability to work with encrypted trafﬁc.
Below, we present an overview of the ML methods which
were selected based on the evaluation of the above criteria:
1) Simple K-Means method: This method, proposed in [6],
is the unsupervised learning approach based on the Simple-
K-Means algorithm. The main advantage of this method is
that it only needs the ﬁrst few packets of the trafﬁc ﬂow,
which depict application’s negotiation phase [6]. It is thus
assumed that unique negotiation phase is the differentiator
between applications. This method has also very small set
of features limited to the investigation of packet lengths. As
an unsupervised learning method, Simple-K-Means divides
observed trafﬁc ﬂows into clusters. During the learning phase
each cluster is associated with a set of related applications.
The particular ﬂow in the cluster is classiﬁed as belonging
to the most prevalent application from this set. The most
challenging aspect of this approach is to properly assign
different applications to clusters, so that given application is
dominating in at least one of them and thus can be selected as
a result of the classiﬁcation. Although real-time classiﬁcation
is possible with this approach, difﬁculties might occur when
the beginning of the ﬂow is lost.
2) Multiple Sub-Flows method: The authors in [7] propose
a supervised learning solution, which allows classiﬁcation a
ﬂows based on the observation of N consecutive packets from
any part of the ﬂow. This feature is an important asset of
the method. During the training process sub-ﬂows of length
N are extracted from the original ﬂow, which represent parts
with diversiﬁed characteristics. The classiﬁer is trained on the
sub-ﬂows instead of the original ﬂow. Therefore, the number
of packets required for actual classiﬁcation is relatively small
(around 25), likewise is the number of necessary features.
Capturing the start of the ﬂow is not required. This method
fulﬁls many of the identiﬁed criteria. Its disadvantage is
however the inability to identify new application types.
3) Statictical protocol ﬁngerprint method: This approach,
presented in [8], analyses the ﬂow and extracts its statistical
properties, called protocol ﬁngerprints, that would correspond
to the behaviour of given protocols. This is performed in a
training phase. Supervised learning - based classiﬁcation is
then performed by comparing those ﬁngerprints to the statisti-
cal behaviour of the observed ﬂow. On this basis particular
protocols are identiﬁed. The method requires evaluation of
only 3 features and enables real-time processing by observing
ﬁrst few packets of the ﬂow. This approach is a promising
technique with good performance. However when applied to
e-Health trafﬁc it may not always be possible to identify the
application types correctly. This is because many applications
would use several protocols in parallel, e.g. to transmit voice
and data information separately.
4) Semisupervised classiﬁcation method: Erman et al. [9]
proposed a hybrid approach that takes advantage from both
supervised and unsupervised ML techniques. The aim was
to minimize the problem with proper labeling of clusters,
which are the result of unsupervised techniques. Although
this method requires the observation of full ﬂows, it can be
still valid in our case since it provides a unique ability to
classify unknown application types. In this approach, both
labeled and unlabeled ﬂows are used in the training phase.
Unsupervised method is exploited to form clusters whereas
labeled ﬂows in the cluster provide a way to map the cluster
to the particular application type. The classiﬁer, i.e., supervised
technique, is then used to map unlabeled ﬂows to one of the
clusters/applications. An advantage of this method is reduced
processing overhead in the learning phase.
5) Multi-classiﬁcation: The authors in [5] observed that
a signiﬁcant number of network trafﬁc classiﬁers performs
well when applied to full ﬂows. In order to work with
parts of the ﬂows, more sophisticated classiﬁcation methods
153
Copyright (c) IARIA, 2012.     ISBN: 978-1-61208-179-3
eTELEMED 2012 : The Fourth International Conference on eHealth, Telemedicine, and Social Medicine

TABLE II
SELECTION OF TRAFFIC CLASSIFICATION METHODS VS. CRITERIA IDENTIFIED FOR E-HEALTH TRAFFIC
Real time
Number of
Flow beginning
Processing
Unknown
Small number
Encrypted
operation
packets
can be skipped
overhead
applications
of features
trafﬁc
5-tuple (Ports)
Yes
Low
Yes
Low
No
N/A
No
DPI
No
Low
Yes
Very High
No
N/A
No
Simple K-Means
Yes
Low
No
Low
No
Yes
Yes
Multiple Sub-Flows
Yes
Low
Yes
Average
No
Yes
Yes
Protocol ﬁngerprint
Yes
Low
No
Average
No
Yes
Yes
Semisupervised
No
High
No
Average
Yes
Yes
Yes
Multi-classiﬁcation
Yes
Very low
No
Moderate-High
No
Not clear
Yes
are required. Based on these observations they proposed a
multi-classiﬁer approach. In this method several classiﬁcation
techniques are combined to work in parallel. Classiﬁcation
is made based on the observation of a very short fragment
of the ﬂow (<10 packets). Although each classiﬁer alone
would perform rather poorly under such conditions, the ap-
propriate combination of outputs from standalone classiﬁers
can signiﬁcantly increase the performance. However, this fast
trafﬁc classiﬁcation method is performed at a cost of increased
processing overhead.
V. OUR APPROACH
Table II presents the comparison of different QoS classiﬁ-
cation techniques based on the criteria speciﬁed for e-Health
trafﬁc. It can be observed that none of the standalone classiﬁers
would be able to fulﬁl all the requirements that we have
identiﬁed for eHealth trafﬁc. Moreover, the performance of
these methods, when applied to classiﬁcation of eHealth trafﬁc,
should be veriﬁed through experimental results on real-life
trafﬁc streams. Therefore, in our future research we will focus
on implementing different multi-classiﬁcation methods that
would take advantage of the standalone classiﬁers described in
the previous chapter. We will investigate different combination
techniques to achieve the optimal set of features and the best
classiﬁcation accuracy for any type of eHealth trafﬁc.
The eHealth application classes proposed in Section III
will be used by the ML-based classiﬁcation techniques as the
base for assigning clusters into appropriate ﬂow groups. Such
an approach will allow straightforward mapping of eHealth
application classes into the appropriate QoS classes. In this
way, the results of eHealth trafﬁc classiﬁcation could be
directly used by the packet scheduling mechanisms used in
existing QoS architectures (e.g., Diffserv, Interserv).
VI. CONCLUSIONS
The main difﬁculties in eHealth services provisioning are
connected with the reliability and privacy issues of personal
data transmissions over public networks. Ubiquitous eHealth
service category poses the most stringent performance require-
ments to Internet technology and network systems in terms
of quality of service due to its nature of life and liability.
Current methods for QoS provisioning over IP networks were
not designed to guarantee reliable transfer of data for eHealth
applications. The main problems lay in proper eHealth trafﬁc
detection and classiﬁcation in order to assign packets to
appropriate QoS classes.
This paper presented an overview of trafﬁc classiﬁcation
methods, which might be applicable to different eHealth ap-
plications. It proposed a basic mapping of eHealth application
classes to appropriate QoS classes and also proposed machine
learning - based trafﬁc classiﬁcation techniques for real-time
packet ﬂows. The proposed methods are able to address most
of the challenges of eHealth trafﬁc classiﬁcation and does not
require any packet payload inspections. In this way the privacy
of the transmitted information can be preserved.
ACKNOWLEDGMENT
This work is partially supported by the Polish Ministry of
Science and Higher Education under the grant agreement no.
543/N-COST/2010/0 ”Trafﬁc analysis in eHealth networks”.
REFERENCES
[1] L. Skorin-Kapov and M. Matijasevic, “Analysis of qos requirements for
e-health services and mapping to evolved packet system qos classes,”
International Journal of Telemedicine and Applications, vol. 2010.
[2] J. Evans and C. Filsﬁls, Deploying IP and MPLS QoS for multiservice
networks: theory and practice, ser. The Morgan Kaufmann Series in
Networking, R. Adams, Ed.
Morgan Kaufmann Publishers is an imprint
of Elsevier, 2007.
[3] T. Nguyen and G. Armitage, “A survey of techniques for internet
trafﬁc classiﬁcation using machine learning,” Communications Surveys
& Tutorials, IEEE, vol. 10, no. 4, pp. 56–76, 2008.
[4] P.
Koutsakis,
“Guaranteed
bandwidth
allocation
and
qos
support
for mobile telemedicine trafﬁc,” 2008 IEEE Sarnoff Symposium, pp.
1–5, 2008. [Online]. Available: http://ieeexplore.ieee.org/lpdocs/epic03/
wrapper.htm?arnumber=4520075
[5] A. Dainotti, A. Pescap, and C. Sansone, “Early classiﬁcation of network
trafﬁc through multi-classiﬁcation,” in Trafﬁc Monitoring and Analysis,
ser. Lecture Notes in Computer Science, J. Domingo-Pascual, Y. Shavitt,
and S. Uhlig, Eds.
Springer Berlin / Heidelberg, 2011, vol. 6613.
[6] L. Bernaille, R. Teixeira, I. Akodkenou, A. Soule, and K. Salamatian,
“Trafﬁc classiﬁcation on the ﬂy,” ACM SIGCOMM Computer Communi-
cation Review, vol. 36, no. 2, pp. 23–26, 2006.
[7] T. Nguyen and G. Armitage, “Training on multiple sub-ﬂows to optimise
the use of machine learning classiﬁers in real-world ip networks,” in
Proceedings. 2006 31st IEEE Conference on Local Computer Networks.
IEEE, 2006, pp. 369–376.
[8] M. Crotti, M. Dusi, F. Gringoli, and L. Salgarelli, “Trafﬁc classiﬁcation
through simple statistical ﬁngerprinting,” ACM SIGCOMM Computer
Communication Review, vol. 37, no. 1, pp. 5–16, 2007.
[9] J. Erman, A. Mahanti, M. Arlitt, I. Cohen, and C. Williamson, “Semi-
supervised network trafﬁc classiﬁcation,” in Proceedings of the 2007 ACM
SIGMETRICS International Conference on Measurement and Modeling
of Computer Systems.
ACM, 2007, pp. 369–370.
154
Copyright (c) IARIA, 2012.     ISBN: 978-1-61208-179-3
eTELEMED 2012 : The Fourth International Conference on eHealth, Telemedicine, and Social Medicine

