A Spectrum Sensing Technique Based on Variably Weighted Sensing Samples 
in the Presence of Random Traffic of Primary Users 
Eunyoung Cho, Keunhong Chae, and Seokho Yoon 
College of Information and Communication Engineering  
Sungkyunkwan University 
Suwon, South Korea 
e-mail: syoon@skku.edu 
 
Abstract—This paper investigates the spectrum sensing 
problem under the random traffic condition of the primary 
user (PU) in cognitive radio (CR) networks, where the PU may 
depart or arrive in a random way during the sensing period. 
Considering that the data transmission period of the secondary 
user (SU) starts right after the sensing period ends, we observe 
that, in the presence of the random traffic of the PU, the 
sensing samples in the latter part of the sensing period are 
more reliable in making a decision on whether the PU is 
present or not. Based on this observation, then, we propose 
spectrum sensing test statistics exploiting only sensing samples 
in the latter part the sensing period and assigning a larger 
weight to a sensing sample closer to the end of the sensing 
period. It is demonstrated in numerical results that the 
proposed methods offer a significant improvement in detection 
and receiver operating characteristic (ROC) performances 
over the conventional methods under the random traffic 
condition of the PU. 
Keywords- Cognitive  radio (CR); Random traffic; Spectrum 
sensing;  Primary user (PU). 
I. 
INTRODUCTION  
With the explosive demands for various high date rate 
services in wireless communications, recently, the radio 
frequency spectrum has rapidly become a scarce resource, 
and thus, the cognitive radio (CR) has gained much interest 
with its capability of offering a high degree of efficiency in 
using the radio frequency spectrum [1]-[3]. Spectrum 
sensing is an essential task in CR, which detects a spectral 
hole of the frequency spectrum allocated to the primary user 
(PU), thus allowing the secondary user (SU) to share the 
frequency spectrum with the PU [4].  
Conventionally, the spectrum sensing techniques [5]-
[7] have been designed under the assumption that the status 
of the PU does not change during the sensing period (i.e., 
the PU is present or absent during the whole sensing time). 
However, it is clear that the status of the PU may change in 
a real environment, i.e., the PU may depart or arrive in a 
random way during the sensing period. Although several 
spectrum sensing techniques [8]-[10] have been presented 
with considering this random traffic of the PU, the 
techniques require the channel knowledge, such as the 
distributions of the departure and arrival times of the PU 
signal [8] and noise variance [9], or they employ the sensing 
samples in the initial part of the sensing period causing a 
wrong spectral hole detection with a high likelihood [10]. 
In this paper, we propose a spectrum sensing technique 
based on variably weighted sensing samples, where only 
sensing samples in the latter part of the sensing period are 
used in the spectral hole detection, and a larger weight is 
assigned to a sensing sample closer to the end of the sensing 
period (i.e., the sensing sample closest to the end of the 
sensing period has the largest weight). The proposed 
technique is expected to perform well in the presence of the 
random traffic of the PU signal, since a sensing sample 
closer to the end of the sensing period is more reliable in the 
decision on the presence and absence of the PU signal when 
the PU departs or arrives randomly during the sensing 
period, as shown in Figure 1 [11]. 
The remainder of this paper is organized as follows. 
Section 2 models the spectrum sensing problem under the 
random traffic condition of the PU as a binary hypothesis 
test. Section 3 describes the proposed technique. Section 4 
 
Figure 1. Spectrum sensing decision under the random traffic condition of 
the PU. 
1
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-591-3
ICSNC 2017 : The Twelfth International Conference on Systems and Networks Communications

compares the proposed and conventional techniques in 
terms of the detection probability and receiver operating 
characteristic (ROC) curve. Section 5 concludes this paper 
with a brief summary. 
II. 
RANDOM TRAFFIC MODEL OF THE PU SIGNAL 
The static and random traffic models of the PU signal 
are depicted in the left-hand and right-hand sides of Figure 2, 
respectively. In the static traffic model, the status of the PU 
signal remains unchanged during the whole sensing time, 
and thus, the spectrum sensing can be formulated as the 
following binary hypothesis testing problem [5]  
s
0 : [ ]
[ ]
H
z i
 w i
           for i=1,2, 
 ,I,             (1) 
and 
s
1 : [ ]
[ ]
[ ]
H
z i
s i
w i


  for i=1,2, 
 ,I,            (2) 
where the hypotheses 
s
0
H and 
s
1
H  represent the absence and 
presence of the PU signal during the whole sensing time, 
respectively, I is the total number of the sensing samples, 
and z[ ]i , [ ]
s i , and w[i] represent the ith samples of the 
received signal, the PU signal, and the additive noise, 
respectively.  
In the random traffic model of the PU signal, on the 
other hand, the spectrum sensing is formulated as [8] 
0
0
0
0
[ ]
[ ] for
1,2,
,
,
: [ ]
[ ]
for
1,
2,
, ,
r
s i
w i
i
J
H
z i
w i
i
J
J
I



 




     (3) 
and 
1
1
1
1
[ ]
for
1,2,
,
,
: [ ]
[ ]
[ ] for
1,
2,
, ,
r
w i
n
J
H
z i
s i
w i
n
J
J
I


 





     (4) 
where the hypothesis
0
r
H and
1
r
H represent the absence and 
presence of the PU signal not during the whole sensing time 
but at the end of the sensing period, respectively, i.e., the PU 
signal is declared absent in the frequency band under 
consideration if it departs between the 
0
J th and 
( 0
J 1)
th 
samples, and thus, is eventually absent at the I th sample 
instant, whereas the PU signal is declared present if it arrives 
between the
1J th and 
( 1
J 1)
th samples and so is present at 
the I th sample instant. It is noteworthy that (3) and (4) 
reduce to (1) and (2), respectively, when 
0
1
0.
J
 J

 
III. 
PROPOSED SPECTRUM SENSING TECHNIQUE  
A. Test Statistics Based on Variably Weighted Sensing 
Samples 
To obviate the need for the knowledge on the 
distributions of the departure and arrival times of the PU 
signal, we consider a spectrum sensing technique based on 
the energy detection [6] with the sensing samples, and also, 
to exclude the sensing samples in the initial part of the 
sensing period causing a wrong decision on the presence 
and absence of the PU signal with a high likelihood, we 
exploit only the last L  samples out of the I samples. In 
addition, we enable the spectrum sensing technique to 
assign a larger weight to a sensing sample closer to the end 
of the sensing period, since a sensing sample closer to the 
end of the sensing period is more reliable in the decision on 
the presence and absence of the PU signal under the random 
traffic condition of the PU signal, as mentioned in 
Introduction. Bearing all of these desired features in mind, 
now, we propose the following two spectrum sensing test 
statistics  
2
1
(
)
| z[ ]| ,
a
I
P
i I
L
i
I
L
T
i
L
  










              (5) 
and 
(
)
2
1
| z[ ]| ,
i
I
L
I
L
E
i I
L
T
b
i


  
 
                  (6) 
where 
a  0
 and 
b 1.
The two test statistics are similar in 
that both of them assign a larger weight to a sensing sample 
closer to the end of the sensing period; yet, they are 
different in their weights: The weights of (5) and (6) are the 
power and exponential functions, respectively, of the 
normalized indices of the last L samples. 
B. Distributions of Test Statistics  
Assuming that the L noise samples 

1
[ ]
I
i I L
w i
   are 
statistically independent and identically distributed Gaussian 
random variables with zero mean and variance 
 2,
we can 
derive the characteristic functions of the test statistics as 
0
2
1
1
(
)
1
2
L
l
l
j
j

 





                       (7) 
under 
0
r
H and 
2
1
2
2
1
1
[
]
(
)
exp
(1
2
)
1
2
L
l
l
l
j s I
L
l
j
j
j


 
 














      (8) 
under
1 ,
Hr
where 
( / )a
l
  l L
 and 
( / )
b l L
for 
TP
and 
TE ,
respectively. The inverse Fourier transforms of (7) and 
(8) would yield the probability density functions (PDFs) 
under 
0
H r
 and 
1 ,
Hr
respectively; however, it is highly 
complicated to express the PDFs in a closed form. Noting 
that the values of a and b do not change the general forms 
of the PDFs, thus, we verify the validity of the characteristic 
functions by deriving the PDFs for a simplified case (i.e., 
when 
a  0
and
b 1,
and so, when
),
P
E
T
 T
 and then, by 
comparing the analytical detection probability based on the 
PDFs with the simulated detection probability. The 
characteristic functions
0(
j)

and 
1(
j)

reduce to 
 
Figure 2. The static and random traffic models of the PU signal  
2
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-591-3
ICSNC 2017 : The Twelfth International Conference on Systems and Networks Communications

2
/2
1
(1
2
 j  )L
                              (9) 
and 
2
1
2
/2
2
[
]
1
exp
,
(1
2
)
(1
2
)
L
l
L
j
s I
L
l
j
j





















       (10) 
respectively, when 
a  0
and
b 1.
 In fact, (9) and (10) are 
the characteristic functions of the central chi-square and 
non-central chi-square PDFs, respectively, with L degrees 
of freedom [12]. Thus, the detection probability is given by  
2
(
2)
(
)
4
2
/2 1
2
2
2
1
(
)
2
L
y
L
y
y
e
B
dy






















      (11) 
for both 
P
T and 
TE ,
where  
2
2
1
[ -
],
L
l
s I L
l





                        (12) 
2
0
( / 2)
( )
,
! (
1)
k
k
x
B
x
k
k











                   (13) 
is the  th-order modified Bessel function of the first kind 
with 
1
0
( )
x
t
x
t
e dt




 
 and x>0, and  is a threshold 
obtained from 
2
/2 1
/2
/2
1
2
(L/ 2)
L
y
L
L
y
e
dy










          (14) 
with   a pre-determined false alarm probability.  Figure 3 
shows the analytical and simulated detection probabilities 
for 
P
T and 
E
T  when  =0.01, 0.03, 0.05, and 0.1 and L=50, 
where we can clearly see that the analytical and simulated 
results agree with each other, thus verifying the validity of 
(7) and (8), and allowing us to use them in determining a 
threshold for the detection performance evaluation in the 
next section. 
 
IV. 
NUMERICAL RESULTS  
In this section, the proposed spectrum sensing 
technique is compared with the conventional spectrum 
sensing techniques in terms of the detection probability and 
ROC curve, where I is set to 200, 
0
J and
1J  are assumed to 
be distributed uniformly over the sensing period, the signal-
to-noise-ratio (SNR) is defined as 
2
2
[ ]/
{ [ ]}
s i
E
w i
with 
{ }
E   
denoting the statistical expectation, and
, , and 
L a
b are 
numerically optimized to maximize the detection probability 
for each of the given SNR values and false alarm 
probabilities. 
 
Figure 3. The analytical and simulated detection probabilities for 
P
T  and  
E
T when  =0.01, 0.03, 0.05, and 0.1 and L=50. 
 
Figure 4. The detection probabilities as a function of the SNR of the 
proposed and conventional schemes when the false alarm probability is (a) 
0.01 and (b) 0.1.  
3
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-591-3
ICSNC 2017 : The Twelfth International Conference on Systems and Networks Communications

Table I shows the optimized values of , , and 
L a
b for 
various values of the SNR when the false alarm probability 
is 0.01 and 0.1, where it is observed that, as the value of the 
SNR decreases, the values of  and 
a
b  generally increases to 
amplify the signal power, whereas the value of L generally 
decreases to exclude highly noise-contaminated sensing 
samples while preserving the reliable samples in the latter 
part of the sensing period. 
Figure 4 shows the detection probabilities of the 
proposed and conventional spectrum sensing techniques as a 
function of the SNR when the false alarm probability is 0.01 
and 0.1, where we can observe that the proposed techniques 
outperform the conventional techniques with a gain ranging 
approximately from 0.5 dB to 13 dB, which stems from the 
fact that the proposed techniques use only reliable sensing 
samples in the latter part of the sensing period unlike the 
conventional techniques. In addition, in the figure, we can 
 
Figure 5. The ROC curves of the proposed and conventional techniques when the value of the SNR is (a) -5dB, (b) -10dB, (c) -15dB, and (d)-20dB.  
TABLE I. THE OPTIMIZED VALUES OF , , and
L a
b  WHEN THE FALSE ALARM PROBABILITY IS 0.01 AND 0.1. 
SNR (dB) 
0 
-2 
-4 
-6 
-8 
-10 
-12 
-14 
-16 
-18 
-20 
 
False 
Alarm 
Probability 
= 0.01 
TP 
Optimized a 
0.4 
0.3 
0.7 
1 
1.6 
2.2 
2.7 
2.4 
2.6 
2.2 
2.3 
Optimized L 
175 
175 
175 
175 
175 
95 
85 
175 
100 
100 
95 
 
TE 
Optimized b 
6.5 
3 
3.5 
4.5 
9.5 
10.5 
3 
10.5 
13 
13 
15 
Optimized L 
175 
175 
175 
175 
150 
125 
65 
95 
105 
125 
110 
False 
Alarm 
Probability 
= 0.1 
 
TP 
Optimized a 
0.6 
0.1 
0.6 
0.7 
1.3 
1.9 
1.9 
0.8 
1.7 
2.3 
3 
Optimized L 
150 
150 
175 
175 
175 
175 
150 
95 
110 
150 
90 
 
TE 
Optimized b 
13.5 
1.5 
3 
2.5 
5 
8.5 
14.5 
7.5 
14.5 
13.5 
7 
Optimized L 
175 
150 
175 
150 
175 
150 
175 
150 
175 
80 
150 
 
 
4
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-591-3
ICSNC 2017 : The Twelfth International Conference on Systems and Networks Communications

see that the performance of 
E
T is slightly better than that 
of
TP ,
due to the effect of the weights on the sensing samples 
being slightly larger with
E
T than with
TP .
  
Figure 5 shows the ROC curves of the proposed and 
conventional techniques when the value of the SNR is (a) -
5dB, (b) -10dB, (c) -15dB, and (d) -20dB. It is seen in the 
figure that the proposed techniques offer an improvement in 
performance over the conventional techniques for all cases 
shown, and the improvement becomes more pronounced for 
a larger SNR value generally. This is because the reliable 
sensing samples are more efficiently utilized in the spectral 
hole detection through the proposed variable weighting 
methods, and the number L of the reliable sensing samples 
generally increases as the value of the SNR becomes larger, 
as shown in Table I. 
Although the PU signal is assumed to arrive or depart 
only one time during the sensing period in this paper, the 
PU signal may arrive or depart several times [13] during the 
sensing period or even during the data transmission period 
[14]. So, we would like to address sensing techniques in 
such more realistic environments in the future work. 
V. 
CONCLUSION 
In this paper, we have proposed two novel detection test 
statistics based on variably weighted sensing samples for 
spectrum sensing under the random traffic condition of the 
PU signal. Using the power and exponential functions of the 
sensing samples in the latter part of the sensing period, we 
have designed weighting methods that enable the detection 
test statistics to assign a larger weight to a sensing sample 
closer to the end of the sensing period, and consequently, to 
improve their own decision reliability in the presence of the 
PU random traffic. Numerical results demonstrate that the 
proposed test statistics provide better detection and ROC 
performances than the conventional ones under the random 
traffic condition of the PU signal.  
ACKNOWLEDGMENT 
This research was supported by Basic Science Research 
Program through the National Research Foundation (NRF) 
of Korea under Grant 2015R1D1A1A01057327 with funding 
from the Ministry of Education. 
 
 
 
 
 
 
 
 
 
 
 
 
 
REFERENCES 
[1] S. Haykin, “Cognitive radio: Brain-empowered wireless 
communications,” IEEE J. Select. Areas Comm. vol. 23, no. 2, 
pp. 201-220, 2005. 
[2] D. W. K. Ng, E. S. Lo, and R. Schober, “Multiobjective 
resource allocation for secure communication in cognitive 
radio networks with wireless information and power transfer,” 
IEEE Transactions on Vehicular Technology, vol. 65, no. 5, 
pp. 3166-3184, 2016. 
[3] S. W. Oh, Y. Ma, E. Peh, and M. H. Yao, TV white space: 
The first step towards better utilization of frequency spectrum, 
1st ed.; John Wiley & Sons, 2016. 
[4] A. Ghasemi and E. S. Sousa, “Spectrum sensing in cognitive 
radio networks: Requirements, challenges and design trade-
offs,” IEEE Communications Magazine, vol. 46, no. 4, pp. 
32-39, 2008. 
[5] N. A. Hussien, E. Barka, M. Abdel-Hafez, and K. Shuaib, 
“Secure spectrum sensing in cognitive-radio-based smart grid 
using 
role-based 
delegation,” 
in 
Proc. 
International 
Conference on Information Management and Engineering, pp. 
25-29, 2016. 
[6] Y. Zeng and Y. C. Liang, “Eigenvalue-based spectrum 
sensing algorithms for cognitive radio,” IEEE Transactions 
on Communications, vol. 57, no. 6, pp. 1784-1793, 2009. 
[7] H. Hu, H. Zhang, H. Yu, and Y. Chen, “Spectrum-energy-
efficient sensing with novel frame structure in cognitive radio 
networks,” AEU-International Journal of Electronics and 
Communications, vol. 68, no. 11, pp. 1065-1072, 2014. 
[8] N. C. Beaulieu and Y. Chen, “Improved energy detectors for 
cognitive radios with randomly arriving or departing primary 
users,” IEEE Signal Process. Lett., vol. 17, no. 10, pp. 867-
870, 2010. 
[9] W. L. Chin, J. M. Li, and H. H. Chen, “Low-complexity 
energy detection for spectrum sensing with random arrivals of 
primary users,” IEEE Transactions on Vehicular Technology, 
vol. 65, no. 2, pp. 947-952, 2016. 
[10] X. Xie, X. Hu, B. Ma, and T. Song, “Improved energy 
detector with weights for primary user status changes in 
cognitive 
radio 
networks,” 
International 
Journal 
of 
Distributed Sensor Networks, vol. 10, no. 3, pp. 1-8, Article 
ID 836793, 2014. 
[11] X. Xie and X. Hu, “Improved energy detector with weights 
for primary user status changes in cognitive radios networks,” 
in Proc. Consumer Communications and Networking 
Conference, pp. 53-58, 2014. 
[12] J. G. Proakis, Digital communications, 4th ed.; McGraw-Hill, 
2001. 
[13] T. Düzenli and O. Akay, “A new spectrum sensing strategy 
for dynamic primary users in cognitive radio,” IEEE 
Communications Letters, vol. 20, no. 4, pp. 752-755, 2016. 
[14] M. Amini, F. Hemati, and A. Mirzavandi, “Optimizing SU 
transmission time under collision constraint considering PU 
returns,” IETE Journal of Research, vol. 61, no. 6, pp. 679-
685, 2015. 
 
 
 
 
 
 
 
 
 
5
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-591-3
ICSNC 2017 : The Twelfth International Conference on Systems and Networks Communications

