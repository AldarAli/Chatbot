Sensing by Proxy: Occupancy Detection Based on Indoor CO2 Concentration
Ming Jin, Nikolaos Bekiaris-Liberis, Kevin Weekly, Costas Spanos, Alexandre Bayen
Department of Electrical Engineering and Computer Sciences
University of California, Berkeley
Berkeley, California 94720, USA
Emails: {jinming,bekiaris-liberis,kweekly,spanos,bayen}@berkeley.edu
Abstract—Sensing by proxy, as described in this study, is a sensing
paradigm which infers latent factors by “proxy” measurements
based on constitutive models that exploit the spatial and physical
features in the system. In this study, we demonstrate the efﬁciency
of sensing by proxy for occupancy detection based on indoor CO2
concentration. We propose a link model that relates the proxy
measurements with unknown human emission rates based on a
data-driven model which consists of a coupled Partial Differential
Equation (PDE) – Ordinary Differential Equation (ODE) system.
We report on several experimental results using both a CO2
pump that emulates human breathing, as well as measurements
of actual occupancy by performing controlled ﬁeld experiments,
in order to validate our model. Parameters of the model are data-
driven, which exhibit long-term stability and robustness across
all the occupants experiments. The inference of the number of
occupants in the room based on CO2 measurements at the air
return and air supply vents by sensing by proxy outperforms a
range of machine learning algorithms, and achieves an overall
mean squared error of 0.6569 (fractional person), while the best
alternative by Bayes net is 1.2061 (fractional person). Building
indoor occupancy is essential to facilitate heating, ventilation,
and air conditioning (HVAC) control, lighting adjustment, and
occupancy-aware services to achieve occupancy comfort and
energy efﬁciency. The signiﬁcance of this study is the proposal of a
paradigm of sensing that results in a parsimonious and accurate
occupancy inference model, which holds considerable potential
for energy saving and improvement of HVAC operations. The
proposed framework can be also applied to other tasks, such as
indoor pollutants source identiﬁcation, while requiring minimal
infrastructure expenses.
Keywords–Occupancy detection; Building energy efﬁciency
I.
INTRODUCTION
The thorough understanding of the interaction of occupants
and indoor environment has been the key component towards
occupancy comforts and energy efﬁciency of buildings, which
account for 40% of total energy usage in the U.S. [1]. Intelli-
gent buildings are conscious about both its occupancy and en-
vironment, in order to take controls over its physical systems,
such as HVAC and lighting, to optimize user comforts and
energy consumption. The knowledge of zone-based occupancy
coupled with adaptive building services offers considerable
potential for energy reduction [2]–[5].
Many existing methods resort to machine learning al-
gorithms through dense sensor deployment. Various sensors
have been employed, including passive infrared (PIR) sensors,
read switches, camera [3], [5]–[7], as well as environmental
sensors such as acoustics, carbonmonoxide (CO), total volatile
organic compounds, small particulates (PM2.5), CO2, illumi-
nation, temperature, and humidity [6], [8], [9]. Indoor CO2
concentration is indicative of the occupancy, as humans are the
main source of CO2 production, although existing approaches
suffer from the delay of detection as a result of the relatively
long time (10–15minutes) it takes for CO2 to build up to the
corresponding level of concentration [6].
Unlike traditional sensing problems, sensing by proxy has
explicit dependency on sensors relative locations as it appears
in the computational physics. There are three essential com-
ponents inherent in the problem, the Location, Link function,
and Latent factors, which we call the L3 factors. In all sensing
by proxy systems, the crucial step is to identify these three
components and the relationship between them. Location refers
to the dependence between sensors location and latent factors.
Latent factors, as its name suggests, includes factors that are
not directly observable by the sensors and have nonnegligible
impact on the system. Link model, a term analogous to the
link function from the generalized linear model (GLM) in
statistics, refers to the transformation of sensor readings to
the quantity of interests. As the design of sensing by proxy
systems relies on the identiﬁcation of the above L3 factors
and their interdependency, the most critical part is the link
model, which links location and latent factors and determines
the effectiveness of the system.
The key contributions of our work are as follow:
•
We develop a link model based on constitutive partial
differential equation (PDE) coupled with ordinary dif-
ferential equation (ODE) that captures the spatial and
temporal features of the system and links unobserved
human emission to “proxy” measurements of CO2
concentrations (Section II).
•
Our most signiﬁcant contribution is the design, im-
plementation, and evaluation of occupancy detection
algorithm (Algorithm 1, Section II) based on the
sensing by proxy methodology in controlled and ﬁeld
experiments (Section III). Our method achieves a root
mean-squared error (in fractional person) of 0.6311,
as compared to 1.2061 by the best alternative strategy
(Section IV).
The rest of the paper is organized as follow. The link model
is detailed in Section II, which includes the proxy design,
modeling, as well as inference. Section III describes the design
of CO2 pump and occupants experiments, whose results are
reported in Section IV. Related work is summarized in Section
V. Section VI draws conclusion and discusses future works.
1
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

II.
SENSING BY PROXY: LINK MODEL
The focus of this section is to introduce the link model in
our sensing by proxy framework, which relates the proxy to
latent factors and enables the estimation of the latent factors
(Section IV).
We start with a description of the PDE-ODE model.
A. Proxy Design and Modeling
We model the dynamics of the CO2 concentration in the
room using a convection PDE with a source term which models
the effect of the CO2 that is generated by humans. The source
term, X(t), measured in ppm (part per million), is the output of
a linear, time-invariant, scalar, stable ODE system whose input,
V (t), in ppm/s, represents the unknown humans’ emission rate
of CO2 inside the room (within the vicinity of humans), given
by
˙X(t) = −aX(t) + V (t)
(1)
where we assume that the unmeasured CO2 emission rate,
V (t), from the humans has the form of a piece-wise constant
signal,
˙V (t) = 0
(2)
which is based on our experimental observation that the
response of the CO2 concentration in the room due to changes
of the human’s CO2 input has some similarities with the
step response of a low-pass ﬁlter. The measure of how fast
changes to the CO2 emission rate by the humans affect the CO2
concentration in the room is speciﬁed by the time constant, 1
a,
in units of 100s.
The ODE is coupled with a PDE that models the evolution
of the CO2 concentration in the room given by
ut(x, t) = −bux(x, t) + bXX(t)
(3)
u(0, t) = U(t)
(4)
where u(x, t) denotes the concentration of CO2 in the room in
ppm at a time t ≥ 0 and for 0 ≤ x ≤ 1, the steady state input
CO2 concentration of the fresh incoming air in ppm is Ue,
and the measured concentration of the fresh incoming air at
the air supply vent is the input U in ppm. Positive parameter,
b, in
1
100s, represents the speed of air convection in the room.
The rate of dispersion of CO2 from the local vicinity of the
human to the room is measured by bX, in
1
100s, which is a
positive number. We scale and center the dimension along the
supply-return path so that the air supply is located at x = 0
and the air return is at x = 1; therefore, the spatial variable x
is unitless and represents a normalized distance along the path.
The CO2 concentration inside the room at the location of the
air supply is represented by u(0, t), and the CO2 concentration
inside the room at the location of the air return is given by
u(1, t).
The evolution of the CO2 concentration in the room is
thus modeled as a linear system, one of whose inputs is the
CO2 concentration of the fresh incoming air measured at the
location of the air supply, and the other input is the human
emission, if any. The output of the system can be viewed as
the CO2 concentration of the air at the return vent, which is
mixed with CO2 that convects from the air supply towards
the air return and the CO2 that is produced from humans.
The concentration of CO2 at the ceiling in a (non-ratiometric)
normalized distance along an axis from the supply to the return
vent is indicated by the value of the PDE on the corresponding
interior point of its spatial domain.
The physical representation of our model is illustrated in
Figure 1. The convection of air from air supply to the air
return vent near the ceiling is represented by the PDE part. The
diffusive term is intentionally omitted since it plays a relatively
minor role in dispersing indoor pollutants as suggested in [10].
Another design consideration involved is the modeling of the
CO2 concentration near the ceiling since this is where we see
most effect from human-generated CO2. One explanation is
that the warm breath from a human occupant acts as a “bubble”
of gas that rises to the ceiling, since it is more buoyant than
the ambient, cooler air. Thus, the air coming from lower in the
room is modeled as a source term on the PDE across its entire
path. The fact that this bubble of air does not immediately rise
to the ceiling but only gradually (as observed in the response
of the CO2 concentration in the room due to changes of the
human’s CO2 input shown in Figures 5 and 8, during the
occupant experiments) is captured by the ODE part of the
model, which behaves as a ﬁlter between the unknown CO2
emission rate of humans and the CO2 concentration in the
room.
Human Breathing, V(t) 
u(x,t),	  0<x<1	  
u(1,t)	  
u(0,t)	  
CO2 mixing + convection 
Supply, U(t) 
Return, u(1,t) 
Figure 1. The physical representation of the model. Fresh air with CO2
concentration U(t) enters the room from the supply vent, and exits the room
after convection and mixing with human breath, V (t), which rises to the
ceilings, and the measured CO2 concentration at the return vent is u(1, t).
B. Proxy Inference
The latent factors that are not directly observable are sensed
by proxy based on the link model which describes the evolu-
tion of proxy under the effects of latent factors. The temporal
and spatial dynamics captured by the PDE-ODE link model
effectively regularizes the inference output. The approach is
clearly different from discriminative models, which assume
samples are independent and identically distributed (i.i.d.).
It shares some similarities with dynamic Bayesian models
such as particle ﬁlters (PF) and Conditional Random Field
(CRF), which accounts for time evolution of the underlying
phenomenon. Nevertheless, proxy inference is directly derived
from physical dependency among sensors and is thus more
accurate and reliable with provable behaviors as we show next.
2
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

The central task in this chapter is to derive an estimation
strategy for latent factors, namely the human emission rate
V (t), based on proxy measurements at the supply vent, U(t),
and return vent, u(1, t). The notation in the derivation follows
from the previous description, with a hat to indicate estimation.
We consider the following observer, which is a copy of the
plant (1)-(4) plus output injection
ˆut(x, t) = −bˆux(x, t)+bX ˆX(t)+r(x)(u(1, t)− ˆu(1, t)) (5)
ˆu(0, t) = U(t)
(6)
˙ˆX(t) = −a ˆX(t) + ˆV (t) + L1(u(1, t) − ˆu(1, t))
(7)
˙ˆV (t) = −L2(u(1, t) − ˆu(1, t))
(8)
The corresponding occupancy detection algorithm is shown
in Algorithm 1. The observer design for our PDE-ODE model
is based on the design in [11], speciﬁcally Theorem 2, which
has its origins on the backstepping observer design for some
classes of PDEs presented in [12]. We refer the interested
reader to [11] for the proof of the following corollary.
Corollary 1: Consider the system (1)-(4) and the proxy
observer (5)-(8) with
r(x) = L1π1(x) + L2π2(x)
(9)
π1(x) = bX
a (e
a
b x − 1)
(10)
π2(x) = bX
ba x + bX
a2 (1 − e
a
b x)
(11)
Let bX ̸= 0 and choose L1, L2 such that the matrix A −
L1
L2

C is Hurwitz, where
A =
−a
1
0
0

(12)
C = (π1(1)
π2(1))
(13)
Then for any u0(x), ˆu0(x) ∈ L2(0, 1), X(0), ˆX(0), V (0),
ˆV (0) ∈ R, there exists positive constant λ and κ such that the
following holds for all t ≥ 0
Ω(t) ≤ κΩ(0)e−λt
(14)
Ω(t) =
Z 1
0
(u(x, t) − ˆu(x, t))2dx
+ (X(t) − ˆX(t))2 + (V (t) − ˆV (t))2
(15)
III.
EXPERIMENTAL DESIGN
A. Hardwares
As our approach is not particularly demanding of the
accuracy of the proxy measurements, we employ the low-
cost K30 CO2 sensor [13], shown in Figure 2, as the main
module in our sensor platform. We implemented a local data
storage solution with SD card, and plan to integrate a wireless
transmission module in the long run to directly deposit data
in our database. The sensor is capable of measuring CO2
concentrations from 0 to 5000 ppm at a frequency of 1Hz
with an accuracy of ±30 ppm, or ±3% of measured value,
Algorithm 1 Sensing by proxy for Occupancy Detection
1: function SENSINGBYPROXY(XR,XS, Param)
2:
Inputs: XR: measurements at air return of size 1 × T
3:
XS: measurements at air supply of size 1 × T
4:
Param: hyperparameters
1)
Model speciﬁcation as in Table III: convection
coefﬁcient b, source term coefﬁcient bX, time
constant of human effect a, human emission rate
V H, equilibrium concentration in air Ue
2)
Control parameters: L1, L2 as in (7) and (8).
3)
Spatial resolution ds, temporal resolution dt
4)
Smoothing window for median ﬁlter: w
5:
Initialization:
6:
ˆu ← Ue1(ds, Tdt)
▷ matrix of size ds × Tdt
7:
ˆX ← 0(1, Tdt)
▷ vector 1 × Tdt for emission effect
8:
ˆV ← 0(1, Tdt)
▷ vector 1 × Tdt for emission rate
9:
xR ← kron(XR, 1(1, dt)) ▷ Discretize return/supply
10:
xS ← kron(XS, 1(1, dt))
▷ by kronecker product
11:
τ ←
1
dt
▷ time discretization step
12:
r(n) ← L1
bX
a (ea/b − 1) + L2( bX
ba + bX
a2 (1 − ea/b))
13:
Main program:
14:
for t ∈ {1, ..., Tdt} do
15:
ˆu(0, t) ← xS(t)
▷ Equ.(6)
16:
for n ∈ {1, ..., ds} do
▷ PDE updates
17:
ˆux(n, t) ← (ˆu(n, t) − ˆu(n − 1, t))ds ▷ spatial
18:
ˆu(n, t + 1) ← ˆu(n, t) + τ

− bˆux(n, t) +
bX ˆX(t) + r(n)(xR(t) − ˆu(ds, t))

▷ Equ. (5) updates
19:
end for
20:
ˆX(t+1) ← ˆX(t)+τ

−a ˆX(t)+ ˆV (t)+L1(xR(t)−
ˆu(ds, t))

▷ updates by (7)
21:
ˆV (t + 1) ← ˆV (t) + τL2(xR(t) − ˆu(ds, t))
22:
end for
23:
Outputs: yOccupants ← ⌊ median( ˆV ,w)
V H
+ 1
2⌋
▷ round of
signal after median ﬁlter with window size w
24: end function
which is considered sufﬁcient for the purpose of occupancy
detection.
Sensor calibration is performed by baseline method. We
leave the sensors in a well ventilated room with outdoor supply
air for few hours. The systematic offset, ξi, is given by
ξi =
1
Tcal
Tcal
X
t=1
yt − xoutdoor
(16)
where Tcal is the length of the calibration period, yt is the
sensor reading at time t, and xoutdoor is the outdoor CO2
concentration, usually at 400ppm. The offset ξi is subtracted
from sensor i under the well mixed assumption, which states
as “at steady state, the air in the room is well mixed, with
the CO2 concentration the same as the fresh air from the air
supply vent”.
3
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

(a) 
(b) 
Figure 2. (a) CO2 sensor up close. The platform is integrated with the main module to sense CO2 concentration, and a local data storage solution with SD
card. (b) The testbed is a conference room located at the Center for Research in Energy Systems Trasnformation (CREST) in Cory Hall on the UC Berkeley
campus. The space is of size 14 × 10 × 9 ft3, equipped with a full ventilation system including an air return vent and air supply vent, as illustrated in Figure 1.
B. Testbed Deployment
We implemented the experiments in a typical conference
room, shown in Figure 2, located at the Cory Hall on the UC
Berkeley campus, whose occupancy is demand-based and not
regular. The room bears close resemblance to other typical
indoor spaces, with a ventilation system including air supply
and air return vents on the ceiling. The sensors are placed on
both vents, in addition to the blackboard on the sidewall.
C. Experiments
Two types of experiments are performed, namely CO2
pump and occupants experiments, with different focuses.
For the CO2 pump experiments, an outlet placed ∼ 20cm
above the desk injects beverage-grade CO2 through a 200W
personal heater to emulate warm human breaths. The experi-
ment is designed with two purposes. First, we want to examine
the spatial dependence of CO2 concentration in the room.
Second, we can collect data to identify the parameters of the
model whose output matches the measured data, under differ-
ent frequency of excitation. Hence, we conducted experiments
with the pump alternating between ON and OFF states, with
the length of a full period of 30min (A), 1hour (B), 3hours
(C), and 10hours(D), whose results are detailed in Section IV.
For the occupants experiments, the purpose is to validate
sensing by proxy in a real setting. Hence we performed both
controlled experiments (E) and ﬁeld measurements (F,G). Our
excitation procedure for the controlled experiments consists of
adding or removing one of two participants of the experiment,
and noting the time that the occupancy changes. The subjects
are graduate students with similar physique. The door is closed
during the experiment, while the participants are engaged in
normal activity such as working on their computers and talking
to each other. The ﬁeld measurements require much less
commitment from the occupants, who are using the conference
room for meetings or group study. The occupancy schedules
for E, F, G are demonstrated in Figures 5 and 8.
IV.
RESULTS AND DISCUSSION
In this section, we report results from experiments and sim-
ulation, and the performance of sensing by proxy in occupants
experiments.
A. Experimental Results and Data Analysis
As described in the section of experimental design, we
performed two groups of experiments, namely, one with CO2
pump and the other with varying number of occupants. Based
on the measurements, we make qualitative and quantitative
analysis as a preparation.
1) CO2 pump experiments:
Hypothesis: when the CO2 is injected for a long time with
constant emission rate, the system reaches steady state.
The steady-state characterization experiment is conducted,
when the pump is turned on for 5 consecutive hours. Figure 3
illustrates the measurements from the supply vent, return vent,
and blackboard.
The rate of CO2 concentration starts to decrease after few
hours, and reaches a plateau in the last hour. The steady state
concentration settles at around 1200 ppm as a result of mixing
of fresh incoming air and CO2 release.
Hypotheses: when the CO2 is released periodically, the
measurement exhibits periodic patterns according to the PDE-
ODE system. Further, besides transient behavior due to
changes of ventilation rate, the CO2 concentrations from
different points in the room react the same, albeit with different
magnitudes.
Both the short period and long period excitation experi-
ments are performed, with the periods of 30 minutes (15min
ON, 15 min OFF, same for the following), 1 hour, and 3 hours,
as shown in Figures 4 and 7.
As can be seen the CO2 concentrations at all the sensed
locations are responsive to the periodic injection, though the
measurement at the air supply vent has a smaller magnitude
compared with blackboard and the air return vent. While the
CO2 accumulates from the start of the injection, the ﬁrst
4
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

0
2
4
6
8
10
400
600
800
1000
1200
1400
1600
CO2 concentration (ppm)
 
 
return
supply
blackboard
0
2
4
6
8
10
0
0.2
0.4
0.6
0.8
1
Time (hours)
Emiss. rate (ppm/s)
Figure 3. CO2 pump experiment D. The measured CO2 concentration from
different locations for a 5-hour CO2 release are shown.
0
1
2
3
4
5
6
7
8
9
300
400
500
600
700
800
900
1000
CO2 concentration (ppm)
 
 
return
supply
blackboard
0
1
2
3
4
5
6
7
8
9
0
0.2
0.4
0.6
0.8
1
Time (hours)
Emiss. rate (ppm/s)
Figure 4. CO2 pump experiment B. Short term excitation with period of 1
hour. Measurements at return (red), supply (green) vents, and blackboard
(blue) are shown.
order derivative decreases as the room reaches higher CO2
concentration.
To quantitatively evaluate the spatial dependencies of sen-
sors in the room, we now derive the cross-correlation between
measurements from three different locations for the CO2
pump experiments. The deﬁnition of the cross-correlation ry1y2
between two signals y1, y2, that is employed here is given by
ry1y2 =
PT
k=1 (y1(k) − ¯y1)(y2(k) − ¯y2)
qPT
k=1 (y1(k) − ¯y1)2(y2(k) − ¯y2)2
(17)
where ¯y1 and ¯y2 are the sample mean of y1 and y2 respec-
tively. The cross-correlation is a measure of the degree of linear
dependency between two signals, and hence, it is a meaningful
measure for comparing the measurements from different loca-
tions inside the room. The values of the cross-correlations are
shown in Table I. One can observe that the cross-correlation
between return and blackboard measurements is high, whereas
TABLE I. CROSS-CORRELATION VALUE OF CO2 MEASUREMENTS
AT DIFFERENT LOCATIONS FOR EXPERIMENTS A, B, C.
Location
Cross-correlation
Return-Supply
0.9592
Return-Blackboard
0.9882
Supply-Blackboard
0.9635
the cross-correlations that involve supply measurements are
lower. This implies that the signals have a high degree of
linear dependency (note that when y1(k) = c1y2(k) + c2, for
all k, the cross-correlation is one) on each other, although the
correlation with the supply measurements is lower due to the
ventilation operation. Note that the cross-correlation between
any two locations is derived as the average cross-correlation
obtained from the measurements of the experiments.
2) Occupants experiments:
As sensing by proxy aims at accurately infer occupancy
through proxy measurements, in addition to CO2 pump exper-
iments, occupants experiments are necessary to validate our
methodology.
As described in the experimental design, we perform
strictly controlled and ﬁeld experiments. The former imple-
ments a designed schedule of occupancy, and requires the
occupants to sit in designated chairs and remain in the room
during the experiment, while allowing them to be engaged
in normal activities, such as using computers and chatting.
The latter is taken during daily events and requires much less
commitment from the occupants.
The following shows results from several such experiments,
which substantially cover the usage of the conference room,
and can be easily extended to other areas in the building.
The ﬁeld measurements are shown in Figure 5 and 8 (right),
and the strictly controlled experiment is illustrated in Figure 8
(left). Note that to avoid signiﬁcant overlap between graphs of
this section and those of the simulation section, we arbitrarily
decide which graphs show the blackboard measurement and
the others show the simulated return, as long as the evidence
is sufﬁcient to for the argument.
0
1
2
3
4
5
6
7
400
500
600
700
800
900
1000
CO2 concentration (ppm)
 
 
return vent
supply vent
blackboard
0
1
2
3
4
5
6
7
0
1
2
3
4
Time (hours)
Number occupants 
Figure 5. Occupants experiment F. Field measurements during project
discussion. Top: Proxy measurements. Bottom: Corresponding occupancy.
Similar to the pump experiment, CO2 concentration in-
5
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

creases almost immediately at the start of occupancy, and the
concentration level and rate have a clear correspondence to the
number of occupants in the room. The possibility of relating
proxy measurements, namely CO2 concentration, to latent
factors, namely occupancy, lays the foundation for sensing by
proxy.
Though the system is responsive to the change of occu-
pancy, the time it takes to accumulate or deplete CO2 to the
corresponding stationary value is fairly long. From vacancy to
a high level occupancy, the measurement slowly sweeps across
several intermediate levels. The difﬁculty of most distribution-
based classiﬁcation methods is illustrated in Figure 6, where
the signiﬁcant overlapping of regions and misplacement of
modes corresponding to different levels of occupancy will lead
to confusion for standard machine learning algorithms. By
modeling the temporal and spatial dynamics of the system,
as we demonstrate in the subsequent sections, we can develop
an inference method that is both robust to noise and responsive
to change of occupancy.
200
400
600
800
1000
1200
1400
1600
1800
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
CO2 concentration in room (ppm)
Normalized frequency
 
 
Vacancy
1 Occupant
2 Occupants
3 Occupants
4 Occupants
5 Occupants
6 Occupants
7 Occupants
Figure 6. Empirical distribution of CO2 concentration for all occupants
experiments corresponding to different occupancy (color coded).
B. Simulation with Proxy Link Model
This section applies the model as described by (1)-(4),
which links the location-speciﬁc proxy measurements to latent
CO2 emission factors to the CO2 pump experiments and
occupants measurements. In particular, we are concerned with
the reproduction of the return vent measurements u(1, t), i.e.,
the output of the system, given the supply vent measurements
U(t) and emission rate V (t).
The results are illustrated in Figure 7, where two exper-
iments from CO2 pump measurements are arbitrarily shown
since the results are very similar. The set of parameters for
the group of CO2 pump experiments is determined by visual
evaluation of the matching of simulation to the air return
measurements, which is listed in Table II. The process of
parameter evaluation is actually very simple, given the derived
equation for stationary distribution
ustationary = Ustationary + bXV
ab
(18)
according to the link model (1)-(4), where V is the ﬁxed
emission rate.
The stability of the CO2 system can be seen in the good
matching of all the air return vent measurements. There are,
TABLE II. PHYSICAL PARAMETERS OF PROXY LINK MODEL USED
IN ALL THE CO2 PUMP EXPERIMENTS (A, B, C, D)
Physical parameter
Symbol
Value
Convection coefﬁcient (
1
100s )
b
2.5
Source coefﬁcient (
1
100s )
bX
1.00
Time constant of human effect (100s)
1
a
16.67
Pump emission rate (ppm/sec)
ρpump
0.833
Equilibrium concentration in air (ppm)
Ue
400
TABLE III. PHYSICAL PARAMETERS OF PROXY LINK MODEL USED
IN ALL THE OCCUPANTS EXPERIMENTS (E, F, G)
Physical parameter
Symbol
Value
Convection coefﬁcient (
1
100s )
b
2.5
Source coefﬁcient (
1
100s )
bX
1.50
Time constant of human effect (100s)
1
a
16.67
Human emission rate (ppm/sec)
V H
0.183
Equilibrium concentration in air (ppm)
Ue
400
nevertheless, occasionally over- and under- matching, espe-
cially around the peak and valleys, which might be caused by
the ﬂuctuation of ventilation rates. The mismatch, even though
not frequent, might introduce bias in our emission rate and
occupancy estimations as we show in the next section. It is,
therefore, recommended to examine the cause of the mismatch
in actual building operations and periodically calibrate the
model in order for sensing by proxy to make the most reliable
inference. It is also possible to design an automatic calibrator
for each distributed sensor system.
Based on our experiences in the CO2 pump experiments,
we designed occupants controlled and ﬁeld experiments to
collect occupancy ground truth and validate our link model
in practice, as shown in Figure 8.
In actual building usage, especially conference rooms and
common areas, the occupancy is often irregular, as exempliﬁed
by the experimental proﬁles. The simulation of proxy mea-
surements, therefore, is direct estimation of the effects of the
irregular change of latent factors. The closeness of simulation
matching to actual proxy measurements, as can be seen, is a
clear indication of the accuracy of the link model, and also
ensures reliable inference of latent factors. The spatial and
temporal simulation is illustrated in Figure 9.
As a general remark, our proxy link model is extremely
simple and parsimonious with parameters. The set of pa-
rameters, including the convection coefﬁcient b, the source
coefﬁcient bX, time constant of human effects 1
a, in addition to
the human emission rate V and CO2 concentration of fresh air
Ue, which are standard ﬁxed parameters, are shared among all
the experiments in the same group of CO2 pump and occupants
experiments, with relatively small difference between different
groups due to the extent of emulation by the pump to human
breathing. This makes our model extremely easy to train and
employ in practice. The additional advantage of parsimonious
model relies on its stability and robustness by avoiding the
potential overﬁtting problem. As we demonstrate next, the
sensing by proxy approach substantially outperforms other
popular methods and yet remains physically meaningful.
C. Proxy Inference of Occupancy
The observer model as described by (5)-(8) and Algorithm
1 are applied in this section to infer the CO2 emission rate
and occupancy based on proxy at return and supply vents.
6
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

0
1
2
3
4
5
6
7
8
9
300
400
500
600
700
800
900
CO2 concentration (ppm)
 
 
measured return
measured supply
simulated return
0
1
2
3
4
5
6
7
8
9
0
0.2
0.4
0.6
0.8
1
Time (hours)
Emiss. rate (ppm/s) 
0
2
4
6
8
10
12
14
16
300
400
500
600
700
800
900
1000
1100
1200
CO2 concentration (ppm)
 
 
measured return
measured supply
simulated return
0
2
4
6
8
10
12
14
16
0
0.2
0.4
0.6
0.8
1
Time (hours)
Emiss. rate (ppm/s) 
Figure 7. Proxy model simulation with CO2 pump experiment A with 30 minutes (left) and experiment B with 1 hour (right) periodic excitation.
Measurements at supply (green), return (blue), and simulated return (red) vents are shown.
0
2
4
6
8
10
400
600
800
1000
1200
1400
1600
1800
CO2 concentration (ppm)
 
 
measured return
measured supply
simulated return
0
2
4
6
8
10
0
2
4
6
8
Time (hours)
Number occupants
0
1
2
3
4
5
6
7
400
600
800
1000
1200
1400
1600
CO2 concentration (ppm)
 
 
measured return
measured supply
simulated return
0
1
2
3
4
5
6
7
0
2
4
6
8
Time (hours)
Number occupants
Figure 8. Proxy link model simulation with occupants experiment E (left) and G (right). The proxy measurements at return (blue), supply (green), and
simulated return (red) vents are demonstrated.
Sensing by proxy distinguishes from other machine learn-
ing methods that assumes independence of samples by im-
plicitly considering time-autocorrelation of the latent emission
rate. The advantage as a result is to have smooth state trajectory
after simple signal processing, where we employed median
ﬁlter directly on the estimated emission rate, ˆV , with a window
of 8min for Experiment A, 20min for B and C, and 25min
for all the occupant experiments. The median ﬁlter is a useful
denoising method in signal processing, which is often preferred
to mean ﬁlter to preserve relevant details and sharp transitions
in the trace, as we will demonstrate next. Figure 10 is plotted
for the CO2 pump experiment with periods of 30 minutes and
3 hours, respectively.
Contrary to the common belief that CO2-based methods
are slow in response, sensing by proxy exhibits fast response
to the change of occupancy. The previous argument is based
on the fact that it takes time to accumulate CO2 to a level
that can be detected, and this accumulation time is fairly long
as we observed in the experiments. During the accumulation,
the concentration value sweeps across the stationary values for
lower occupancy when several people enter the room, or those
for higher occupancy when people leave, which account for
the signiﬁcant overlap in the histograms of CO2 concentration
in Figure 6.
Sensing by proxy, however, tackles this issue by modeling
the dynamics of the measurements based on our link model,
which implicitly considers the increasing rate and stationary
values to infer the actual occupancy. As a result, sensing by
proxy is immediately responsive to changes of occupancy even
when the transition is fairly frequent in the case of Figure
10 (left), which is not possible with other methods since the
concentration remains at a relatively high level even when the
pump is turned off. The parameters chosen for the estimation
are L1 = 2, L2 = 0.02, and the other physical parameters of
7
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

0
1
2
3
4
5
6
7
0
0.2
0.4
0.6
0.8
1
Time (hours)
CO2 input rate (ppm/s)
 
 
Estimation rate
Ground truth
Median filter
0
2
4
6
8
10
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Time (hours)
CO2 input rate (ppm/s)
 
 
Estimation rate
Ground truth
Median filter
Figure 10. Sensing the latent CO2 emission rate by proxy for CO2 pump experiment A (left) and experiment C (right). The estimated emission rate (blue),
median ﬁltered rate (green), and ground truth (red) are given.
0
2
4
6
0
0.2
0.4
0.6
0.8
1
300
400
500
600
700
800
900
Time (hours)
Normalized distance
CO2 concentration (ppm)
Figure 9. Spatial and temporal dynamics of CO2 concentration as
represented as the states in the proxy link model.
the model are shown in Table II.
In the case of occupants estimation, the task is more
difﬁcult due to the following reasons. First, humans are
not uniform in physique, so the emission rate must vary
for different occupants. Second, the positions of the people
sitting in the room are arbitrary, which might question our
assumption that the human emission has uniform effect on
measurements on the ceiling regardless of positions of sources.
Also, the ventilation rate, opening and closing of doors, and
different activities might all introduce additional noise to the
measurements. Nevertheless, regardless of these factors, Figure
11 shows that sensing by proxy is reasonably robust to these
inﬂuences, where we plot the estimated number of occupants
together with the ground truth.
The fast transition behavior exhibited in the CO2 pump
experiments is also observed for the occupants experiments,
even without any sensors to explicitly sense the exits or entry
of people as in other methods such as particle ﬁlters or Markov
models [8]. The occupancy inference is accurate without ex-
plicitly specifying the transition rates of the occupancy model.
For all these inference, the parameters chosen are the same,
namely L1 = 2, L2 = 0.02, and physical parameters from
Table III.
To compare with other models, we employ the root mean-
squared-error (RMSE) with units of fractional people, given
by
RMSE =
v
u
u
t 1
T
T
X
k=1

φ(k) − ˆφ(k)
2
(19)
where φ(k) is the ground truth occupancy at time k, ˆφ(k) is
the estimated occupancy at time k given by
ˆφ(k) =
$ ˜ˆV (k)
ρhuman
+ 1
2
%
(20)
where ˜ˆV (k) is the median-ﬁltered estimated emission rate at
time k, ρhuman = 0.183ppm/sec is the average sedentary person
emission rate, and ⌊x⌋ is the ﬂoor operation to obtain the
largest integer smaller than x.
The comparison of sensing by proxy with other methods
are shown in Table IV. Since all the other models require sub-
stantial training phase, the data is split to training and testing
sets and the RMSE is computed by 10-fold cross-validation.
The algorithms take the measurements from the air supply and
air return vents as features, where the corresponding labels are
the number of occupants. The outputs for each testing point
are the number of occupants obtained by classiﬁcation, which
are compared against the ground truth. For standardization
purpose, we employ the Weka Machine Learning Toolkit [14]
for the implementation of these algorithms. No time dynamic
models, such as particle ﬁlters are learned for comparison,
as it requires additional sensors to measure transitions and
extra knowledge of transitional probabilities, which require
substantial learning data and might not be reliable for the case
of non-stationary activities in practice.
Even though the parameters of our link model are shared
across all the experiments, the training for other models might
be signiﬁcantly different for each experiments, which differ
by scale and time. Therefore we decide to separate the RMSE
for each experiment, as shown in the ﬁrst three columns of
Table IV, which might make it obvious that which model
is consistently better even with different dataset. In the last
column, we combine all the occupants experiments data and
test each model. Note that as it is possible for other models
8
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

0
1
2
3
4
5
6
7
8
9
0
1
2
3
4
5
6
7
8
9
Time (hours)
Number of occupants
 
 
Ground truth
Estimation occupancy
0
1
2
3
4
5
6
7
0
1
2
3
4
5
6
7
8
9
Time (hours)
Number of occupants
 
 
Ground truth
Estimation occupancy
Figure 11. Occupancy detection by “sensing by proxy” (Algorithm 1) for experiment E (left) and G (right). The response times from vacancy to occupancy
and vice versa are about 10 seconds and 5 to 10 minutes respectively, since the method detects the dynamics of the system rather than static concentration.
The estimations (green) are within 1 occupant of the ground truth (red).
TABLE IV. COMPARISON OF ROOT MEAN-SQUARED ERROR OF
ESTIMATION IN OCCUPANTS EXPERIMENTS
Exp. E
Exp. F
Exp. G
Mixed
Na¨ıve Bayes
1.3080
0.7454
1.7457
1.3555
Bayes Net
1.2345
0.6555
1.5406
1.2061
Logistic regression
1.0796
0.6109
1.8414
1.4736
Multi-Layer Perceptron
0.9686
0.5672
1.6221
1.2321
RBF Network
1.0837
0.6760
1.6496
1.3341
Seq. Min. Opt. (SMO)
1.2326
0.6185
1.8803
1.6118
AdaBoostM1
1.6415
0.7053
2.2257
2.3927
Sensing by Proxy
0.5922
0.3809
0.7331
0.6311
to yield different outputs due to different training, sensing by
proxy will output the same value given the chosen parameters,
which is desirable since it is less susceptible to training noise.
Sensing by proxy, as can be seen, delivers standout perfor-
mance in all the testings, while the second best (underlined)
positions are shared between Multi-Layer Perception (MLP)
and Bayes Net, whole error metric almost doubles that of
sensing by proxy in the mixed dataset case. By ignoring the
dynamics of CO2 concentration, these algorithms are confused
by the overlapping concentration region as shown in Figure 6
especially during CO2 accumulation and depletion period.
Close examination of the confusion matrix for our model
and the second best model, in the mixed dataset case, the
Bayes Net, as visualized in Figure 12, reveals an additional
advantage of sensing by proxy. In the illustration, the size of
the bubble represents the percentage of data classiﬁed as ˆφ
(y-axis) for ground truth φ (x-axis), normalized for the sample
size corresponding to φ. Bayes Net has a straight diagonal
pattern, but it is undermined by the nonnegligible points far
off the diagonal, representing misclassiﬁcation error with large
magnitude. On the contrary, sensing by proxy, though not
possessing the straight diagonal pattern as in Bayes Net, is
fairly clean of points far off the diagonal region. The point
mass is also concentrated in the narrow band of sub-diagonals,
which indicate that the estimation is within an error of 1
person. This is clearly preferred in practice, as sufﬁciently
accurate estimation of occupancy can save much more energy
than exact occupancy estimation but with misinference of
crowded space when the room is just vacant.
V.
RELATED WORK
Existing approach to indoor occupancy estimation em-
ployed machine learning methods with multi-sensor fusion
through dense sensor deployment. Passive Infrared (PIR) sen-
sors and magnetic reed switch to detect door open/close events
are suitable for binary occupancy detection [3]. Fusion of
PIR sensors with cameras in the particle ﬁlter framework was
proposed for occupancy prediction. Inhomogeneous Markov
Chain, such as closest distance Markov chain and Blended
Markov Chain, was employed for real-time occupancy based
conditioning strategies [7]. Occupancy estimation using real
(motion, door closure) and virtual (PC activity detector) sen-
sors was presented in a small ofﬁce based on the decision tree
and artiﬁcial neural network models [15]. Individual presence
detection based on power consumption using zero-training
algorithm is proposed in [16]. A complex sensor network
was established [8] comprising ambient-sensing (lighting, tem-
perature, relative humidity, motion detection and acoustics),
CO2 sensing, and air quality sensing systems, which were
incorporated into a Hidden Markov Model.
There are two main streams of modeling room air dynam-
ics, namely computational ﬂuidic dynamics (CFD) and zonal
models [17]. CFD requires substantial model speciﬁcation
(e.g., locations of all walls, furniture, and occupants) and
computation to produce detailed map of air motion. Zonal
models, on the contrary, relies on ODE mass balance laws
between different zones, though the distributed local nature
of airborne contaminant transfer within a single space is not
captured. Clearly a trade-off between spatial details and model
simplicity is more practical for occupancy sensing.
Techniques for the estimation of the concentration of
contaminants emitted from a source in indoor environments
exist in the literature [17]. Boundary observers for some classes
of PDEs are constructed in [18] via backstepping. In [19],
this methodology is applied for the estimation of the state-of-
charge of batteries. Observer designs for time-delay systems
with unknown inputs are presented in [20]. In light of the
current development in control theory, sensing by proxy recasts
the occupancy inference as a problem of state and input
estimation to allow robust, automatic, real-time inference.
9
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

Figure 12. Visualization of confusion matrix for Bayes Net (left) and sensing by proxy (right), where the position of circles represents the true number of
occupants (x-axis) and estimated number of occupants (y-axis), and the size indicates the percentage normalized for each column.
VI.
CONCLUSION
This study describes an occupancy detection algorithm
using indoor CO2 concentration based on the sensing by proxy
methodology, which explores the spatial and temporal features
of the system with constitutive models. Controlled ﬁeld exper-
iments are conducted in a typical indoor space to show that
the proposed link model can reproduce the CO2 measurements
given the latent emission rates. It is demonstrated that sensing
by proxy can reliably detect the number of occupants based on
“proxy” observations with RMSE of 0.6311 (factional person),
as compared to 1.2061 (factional person) of the best alternative
machine learning algorithm. Investigation of the confusion ma-
trices reveals that the estimation by sensing by proxy is within
1 occupant of the ground truth with high probability, while the
estimation by Bayes Net sometimes has large deviations. By
successfully identifying the L3 factors (location, latent factors,
and link model) in the problem, sensing by proxy can be
also applied to other tasks, such as indoor pollutants source
identiﬁcation, while requiring minimal capital investments.
ACKNOWLEDGMENT
This research is funded by the Republic of Singapore’s
National Research Foundation through a grant to the Berkeley
Education Alliance for Research in Singapore (BEARS) for
the Singapore-Berkeley Building Efﬁciency and Sustainability
in the Tropics (SinBerBEST) Program. BEARS has been
established by the University of California, Berkeley as a
center for intellectual excellence in research and education in
Singapore.
REFERENCES
[1]
J. McQuade, “A system approach to high performance buildings,”
United Technologies Corporation, Tech. Rep, 2009.
[2]
V. Garg and N. Bansal, “Smart occupancy sensors to reduce energy
consumption,” Energy and Buildings, vol. 32, no. 1, 2000, pp. 81–87.
[3]
Y. Agarwal, B. Balaji, R. Gupta, J. Lyles, M. Wei, and T. Weng,
“Occupancy-driven energy management for smart building automation,”
in Proceedings of the 2nd ACM Workshop on Embedded Sensing
Systems for Energy-Efﬁciency in Building.
ACM, 2010, pp. 1–6.
[4]
J. Lu et al., “The smart thermostat: using occupancy sensors to save
energy in homes,” in Proceedings of the 8th ACM Conference on
Embedded Networked Sensor Systems.
ACM, 2010, pp. 211–224.
[5]
V. L. Erickson et al., “Energy efﬁcient building environment control
strategies using real-time occupancy measurements,” in Proceedings of
the First ACM Workshop on Embedded Sensing Systems for Energy-
Efﬁciency in Buildings.
ACM, 2009, pp. 19–24.
[6]
S. Meyn, A. Surana, Y. Lin, S. M. Oggianu, S. Narayanan, and T. A.
Frewen, “A sensor-utility-network method for estimation of occupancy
in buildings,” in Decision and Control, 2009 held jointly with the 2009
28th Chinese Control Conference. CDC/CCC 2009. Proceedings of the
48th IEEE Conference on.
IEEE, 2009, pp. 1494–1500.
[7]
V. L. Erickson, S. Achleitner, and A. E. Cerpa, “Poem: Power-efﬁcient
occupancy-based energy management system,” in Proceedings of the
12th international conference on Information processing in sensor
networks.
ACM, 2013, pp. 203–216.
[8]
B. Dong et al., “An information technology enabled sustainability test-
bed (itest) for occupancy detection through an environmental sensing
network,” Energy and Buildings, vol. 42, no. 7, 2010, pp. 1038–1046.
[9]
S. Wang and X. Jin, “Co2-based occupancy detection for on-line
outdoor air ﬂow control,” Indoor and Built Environment, vol. 7, no. 3,
1998, pp. 165–181.
[10]
A. Baughman, A. Gadgil, and W. Nazaroff, “Mixing of a point source
pollutant by natural convection ﬂow within a room,” Indoor air, vol. 4,
no. 2, 1994, pp. 114–122.
[11]
N. Bekiaris-Liberis and M. Krstic, “Lyapunov stability of linear pre-
dictor feedback for distributed input delays,” Automatic Control, IEEE
Transactions on, vol. 56, no. 3, 2011, pp. 655–660.
[12]
M. Krstic and A. Smyshlyaev, Boundary control of PDEs: A course on
backstepping designs.
Siam, 2008, vol. 16.
[13]
“K-30 10,000 ppm CO2 sensor,” http://www.co2meter.com/products/
k-30-co2-sensor-module, June 2015.
[14]
M. Hall, E. Frank, G. Holmes, B. Pfahringer, P. Reutemann, and I. H.
Witten, “The weka data mining software: an update,” ACM SIGKDD
explorations newsletter, vol. 11, no. 1, 2009, pp. 10–18.
[15]
S. Srirangarajan and D. Pesch, “occupancy estimation using real and
virtual sensors,” in Proceedings of the 12th international conference on
Information processing in sensor networks.
ACM, 2013, pp. 347–348.
[16]
M. Jin, R. Jia, Z. Kang, I. C. Konstantakopoulos, and C. Spanos,
“Presencesense: Zero-training algorithm for individual presence detec-
tion based on power monitoring,” in BuildSys14, November 5–6, 2014,
Memphis, TN, USA, 2014, pp. 1–10.
[17]
L. Mora, A. Gadgil, and E. Wurtz, “Comparing zonal and cfd model
predictions of isothermal indoor airﬂows to experimental data,” Indoor
air, vol. 13, no. 2, 2003, pp. 77–85.
[18]
A. Smyshlyaev and M. Krstic, “Backstepping observers for a class of
parabolic pdes,” Systems & Control Letters, vol. 54, no. 7, 2005, pp.
613–625.
[19]
S. Moura, N. Chaturvedi, and M. Krstic, “Pde estimation techniques
for advanced battery management systemspart i: Soc estimation,” in
American Control Conference (ACC), 2012.
IEEE, 2012, pp. 559–
565.
[20]
D. Koenig, N. Bedjaoui, and X. Litrico, “Unknown input observers
design for time-delay systems application to an open-channel,” in
Decision and Control, 2005 and 2005 European Control Conference.
CDC-ECC’05. 44th IEEE Conference on. IEEE, 2005, pp. 5794–5799.
10
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-418-3
UBICOMM 2015 : The Ninth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

