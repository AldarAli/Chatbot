Dynamic Spectrum Allocation in Low-Bandwidth Power Line Communications
Kyle Kastner
Southwest Research Institute
San Antonio, TX 78228, USA
email: kkastner@swri.org
Stan McClellan and William Stapleton
Ingram School of Engineering
Texas State University
San Marcos, TX 78666, USA
email: stan.mcclellan@txstate.edu
email: wstapleton@txstate.edu
Abstract—The application of frequency-agile communica-
tions techniques, or Dynamic Spectrum Allocation (DSA), have
proven to be effective for adaptive communication in many
scenarios. In particular, DSA ﬁnds primary application in
wireless systems, such as cognitive or software-deﬁned radio.
In this work, we implement a form of DSA which uses weighted
statistical analysis of channel parameters and a heuristic
decision process. This algorithm selects and prioritizes the
most favorable subcarriers for multicarrier, frequency-division
transmission while avoiding arbitrary spectral obstructions in
occupied channels. We validate this technique in the context
of “Smart Grid” communication, which provides a very useful
means of exercising the capability of the algorithm.
Keywords-Dynamic spectrum allocation, DSA, cognitive ra-
dio, power line communcations, Smart Grid, Frequency Divi-
sion Multiplexing, FDM
I. INTRODUCTION
This paper presents an algorithm designed to analyze a
transmission channel and prioritize appropriate subcarriers
for use in subsequent transmissions. The algorithm forms
a subset of the processing required to achieve “Dynamic
Spectrum Allocation” (DSA) in a communication system.
The collection of DSA techniques ranges from simple,
efﬁcient, and non-robust energy measurements [1]–[4] to so-
phisticated, resource-intensive, and robust pattern matching
algorithms [5]–[7]. In most cases, DSA algorithms are used
in wireless communications systems where spectrum is over-
used, or has been allocated by regulatory means [8].
In this work, we use a combination of subband energy
measurements, statistical characterizations, and heuristic de-
cision making to produce a robust channel selection al-
gorithm which can be used for DSA in cognitive radio
or other transmission schemes where bandwidth is scarce,
such as power line communications (PLC). The algorithm
selects and prioritizes the subcarriers while avoiding spec-
tral obstructions in occupied channels. Since the approach
uses particular statistical metrics to sort and rank channel
parameters, we use the description “Mean-based Spectral
Moment Algorithm”, or MSMA. The MSMA algorithm is
intended to be a component of a larger, more complicated
multicarrier communication system. As a result, discussion
of speciﬁc modulation schemes, access control algorithms,
protocol structures, or other higher-layer topics is beyond the
scope of this paper. However, we refer to basic modulation
techniques during the evaluation of the algorithm.
A particularly interesting use of MSMA may include
application in a “Smart Grid” communication system, com-
prising a low-bandwidth management network for metering,
utility monitoring and pay-per-use electrical power [9]. To
clearly distinguish this application, we present MSMA in the
context of low-bandwidth, low-frequency communication on
a power line channel.
The remaining sections of this paper discuss various as-
pects of adaptive channel allocation, the MSMA algorithm,
and the power line as a communications channel. Section II
discusses challenges and features of the power line channel
which can be leveraged by MSMA. Section III describes
the MSMA algorithm, and Section IV presents simulation
results for the MSMA algorithm in a power line channel.
Finally, Section V discusses conclusions and proposes future
work on the MSMA algorithm.
II. CHALLENGES OF POWER LINE COMMUNICATIONS
The concept of communicating over existing power in-
frastructure is not new. Several well-known systems and
technologies allow local, home based communication be-
tween devices and so on [10]. There is a clear distinction,
however, between these existing systems and the appli-
cation of the MSMA algorithm in a PLC scenario. The
main objective of the MSMA algorithm is to facilitate
one-way, upstream communication between end hardware
(meters, charging stations), grid hardware (transformers,
troubleshooting equipment) and the serving substation. In
this scenario, attenuation and noise constraints in the channel
are important concerns, but effective navigation around
established power quality regulations are perhaps more
signiﬁcant. Power quality requirements can be found in
national and international standards [11], [12] which impose
limits on parameters related to voltage/current ﬂuctuations,
harmonic distortion, transients, and noise. Most of these
limits focus on measurements at the “point of common
coupling,” or the intersection between utility and consumer
terminals [13]. In addition to these regulatory limitations,
the natural characteristics of the power line channel offer a
very interesting and difﬁcult challenge.
28
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

This application focuses on transmitting data “upstream”
in the distribution grid, from end-user applications to the
substation, without relays or ampliﬁers or transformer by-
passes. The network properties of the distribution grid
severely limit the frequency range that may be used. The
main factor contributing to the frequency limitation seems
to be related to the frequency response or admittance of the
transformers used in power distribution. A simple model of
this admittance characteristic shows a sharp notch passband
around the fundamental (50-60Hz) and a “high admittance
lobe” from approximately 200 Hz to 2 kHz [14]. This
high-admittance lobe varies depending on the quantity, type,
and even the brand of the transformers present in the
distribution grid, and the band-edges of the lobe are time
variant. Thus, for a communication signal to effectively
transit the distribution grid and not interfere directly with
the fundamental, it must be within this high-admittance lobe.
This limitation reduces the methods of modulation and the
effective bandwidth of low-frequency PLC.
Power line systems also experience varying attenuations
and phase distortions for signals within them. Upon inves-
tigating the conditions of the power line it can be seen
that it has constantly changing topology and, in fact, is
a time variant system. This makes it exceedingly difﬁcult
to deal with the many changes that can occur in order to
locate a suitable frequency band for communication. Further
increasing the complexity of the problem is the fact that
there are a large number of connected devices which cause
interference, and which present time-varying loads. This
complex channel topology creates a unique challenge and
a good proving ground for frequency-agile communication
schemes.
III. THE MSMA ALGORITHM
The goal of any adaptive communication algorithm is to
analyze channel conditions and send data as efﬁciently as
possible while minimizing error. Depending on conditions
in the channel, techniques to maximize transmission quality
vary widely, but most methods attempt to exploit consistent,
unique characteristics of the channel to maximize desirable
output. In the case of the power line, the presence of a
large amount of energy at the fundamental frequency (60Hz
in the U.S., for example) is well-known. The remaining
frequency space of the channel is cluttered by reduced-
amplitude harmonics of the fundamental (typically odd), as
well as a signiﬁcant amount of transient noise. This noise
can be temporal or pseudo-stationary as well as broadband
and relatively uncorrelated [15].
The concepts behind policy based cognitive radio systems
can be leveraged for adaptive powerline communication
[16]. Constant monitoring of the channel and continuous
adaptation to avoid interference with the primary channel
user is very important, as powerline conditions are extremely
dynamic. Additionally, routing aware channel selection al-
gorithms, such as those proposed for IEEE 802.11s mesh
networks [17] can be leveraged effectively for powerline
communications. As in cognitive radio, such active selection
algorithms constantly scan and monitor channel conditions,
but the mesh algorithm uses uplink and downlink airtime
cost as a key decision making factor.
Similar to cognitive radio systems or mesh network rout-
ing algorithms, the MSMA algorithm is a technique for
analyzing a given frequency spectrum, discovering a number
of potential transmit channels, using calculated statistics
to rank these potential transmit channels, and producing a
vector of suggested transmission carrier frequencies to be
used by the transmission subsystem(s).
To achieve this outcome, the MSMA algorithm attempts
to exploit the regulated nature of power-line harmonic peaks,
transmitting inside the low interference areas of the power-
line spectrum. The MSMA algorithm also places high values
on potential transmit bands inside the “high admittance lobe”
of the distribution grid, ranking potential channels with
a weighted combination of mean, variance, and ﬁt within
transformer admittance limits. After calculating appropriate
ranking values for subcarriers, potential channels can be
sorted, and carrier frequencies and amplitude values selected
to transmit in the “best” areas of the channel. Figure 1 shows
a high-level ﬂow diagram of the processing implemented by
the MSMA algorithm.
There are several important conditions that must be met
for this application of the MSMA algorithm. The most im-
portant condition is that transmission must not interfere with
any powerline harmonics. The location of these harmonic
frequencies is loosely deﬁned by Eqn. 1 for positive integer
values of n.
Fh(n) = (60Hz)(2n − 1)
(1)
Using the values from a Fast Fourier Transform (FFT)
of the channel activity, statistically favorable areas in the
spectrum are found. To accomplish this, the fact that power-
line harmonics are generally well regulated and stand far
above the noise levels in the channel is utilized. The index
values of these spikes are used as markers, and statistical
data is computed related to the areas between harmonics.
This data, weighted using application speciﬁc weighting
factors, allows for quantiﬁcation of the transmit channel
decision making process, and channel ranking based on
mean and variance. To avoid false positives, it is imperative
to remove values near the peak. Once the index values of
the spikes are found, it is relatively simple to calculate mean
and variance of the “nulls” between spike indices.
IV. IMPLEMENTATION AND TESTING
The MSMA algorithm utilizes several statistics taken from
spectral analysis of an input waveform. Speciﬁcally, the
29
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

Figure 1.
MSMA decision-making process.
mean and variance about mean of particular sections of the
input waveform are utilized to create a detailed ranking of
potential transmit channels. To calculate these statistics, an
FFT of 2048 points is used to transform a time domain input,
sampled at 8 kHz, into a frequency domain representation.
In accordance with Eqn. 2, this means that each FFT bin
represents 3.9063 Hz.
Hz
bin = sampling frequency
FFT length
(2)
Stepping through the input spectrum, maximum values
and their corresponding indices are stored in an array. The
number of maxima stored depends on user speciﬁcations.
For this implementation, the 15 largest maxima were more
than sufﬁcient. Once a harmonic maximum is found, the
usual sample mean (3), sample variance (4), minimum val-
ued bin index, and allowable bitmask is stored in the array,
alongside the peak bin index and maximum bin value. In
this case, the allowable bitmask is a binary value indicating
whether the candidate subcarrier lies inside the channel’s
admittance proﬁle.
¯x = 1
N
N
X
i=1
x(i)
(3)
s2
n =
1
N − 1
N
X
i=1
(¯x − x(i))2
(4)
Finding these maxima is not a trivial task. To ﬁnd accurate
maxima for this particular implementation of the MSMA
algorithm, a bitmask is shifted to center about the index
of the spectrum’s current maximum bin. This bitmask is
then multiplied by the input spectrum to annihilate the local
maximum and neighboring elevated values. This action is
repeated as many times as necessary to ﬁnd the remove the
requisite number of peaks and associated potential transmit
channels. When sufﬁcient maxima are found and associated
statistics calculated, a weighted “ranking index” is computed
which combines ¯x, s2
n, and admissibility parameters, as
shown in Eqn. 5.
Ri = km
¯x
AVG(¯x) + kv
s2
n
AVG(s2n)
(5)
The set of “ranking indices” is used to prioritize sub-
carriers using a two-stage, masked sorting process. First,
the admissible subcarriers are ranked above non-admissible
subcarriers. Then these two groups are sorted in ascending
order based on ranking index.
A variable width bit mask is used to center on the index
of the maximum frequency. The input spectrum is then
multiplied by the bit mask, eliminating the found maximum
and surrounding high values. A new maximum value is
then found and the elimination process repeated. This “ﬁnd
maximum, then annihilate” process is repeated until the req-
uisite number of peaks is found. Once these peak indices is
established, it is assumed that these values correspond with
the regulated odd-harmonic peaks of the supplied power.
The minimum valued bin index within the potential transmit
channel is then located and stored in an array. This potential
transmission frequency remains linked to the corresponding
channel during the ranking process. By calculating the mean
and variance of the following spectrum, the transmission
potential of these transmit channels is quantiﬁed and used
to rank the channels from best to worst.
This method is classiﬁed as O(n), where n corresponds to
the spectrum array length to be analyzed. Once the number
of potential transmit channels is speciﬁed, the speed of
the algorithm itself will only vary based on input length.
The only thing that may affect this categorization is the
construction of the max() operation, which may scale
differently depending on input array length. It is assumed
here that the max() operation is O(n), and is the primary
limiting factor in algorithm decision speed.
Obviously, this technique would need adjustment in order
to accommodate multiple users, but the mean and variance
based ranking concepts behind transmit channel choice
should remain valid.
30
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

Admissible region
Admissible region
Figure 2.
Frequency domain representations of MSMA transmitter output
with admittance windows of 400 Hz to 800 Hz and 400 Hz to 1400
Hz, respectively. The admittance window restricts admissible subcarrier
frequencies.
All of the following graphical samples were taken by
applying a Hanning window to the input, followed by a
2048 length FFT. The channel denoted by CH1 in red in
the graphic legend of each ﬁgure, represents the result of
feeding the MSMA algorithm output into a low-rate BPSK
transmitter. The channel denoted as CH2 in blue, shows the
spectral content of the input data.
A. Transmit Channel Ranking
Figure 2 shows transmit peaks shifting upward in fre-
quency, to the spectral regions with lower average power
and activity. This is a natural tendency of the algorithm, as
the transformer ﬁltering reduces both noise and harmonic
presence. For these same reasons, correct adjustment of the
high-admittance window is vital in order to avoid losses in
transmitted signals. The effect of the admittance window
is evident in Figure 2 where subcarrier frequencies are
restricted to particular spectral regions.
B. Transmit Channel Noise Avoidance
Figure 3 shows the micro-adjustment of transmit fre-
quency, based on centering the transmission frequency at
the minimum valued bin index. The top graph has no delay,
while the middle graph has a 1 buffer sample delay (1600
input samples), and the bottom graph has a 2 buffer sample
delay (3200 input samples). In the ﬁgure, vertical dotted
lines denote the original positioning of subcarriers (top plot),
and arrows indicate micro-adjusted subcarriers (subsequent
plots). Micro adjustment of the carrier frequency is used to
center transmission over low power areas of the transmit
channel. By using the minimum valued index from the
chosen channel, interference is minimized, producing a
superior bit error rate.
C. Reaction to Changes in Channel Conditions
Figure 4 shows a clear example of channel adaptation
based on changing input conditions. All channels are shifted
downwards in response to increased noise in the upper
region of the spectrum.
V. CONCLUSIONS AND FUTURE WORK
Future enhancement of the MSMA algorithm may include
using different approaches to scan the incoming FFT data
or may include alternative approaches to spectral estimation.
For example a sliding discrete Fourier transform (DFT) or
a sliding Goertzel algorithm [18] could work through the
input spectrum in small blocks, ﬁnd areas with the lowest
power, and send data out to transmit at these points. The
Goertzel algorithm is mentioned here because of its use
in telecommunications networks for Dual Tone Multiple
Frequency (DTMF) tone detection which could be extended
for detecting signaling tones that would act as control
indicators in PLC.
Additionally, advanced statistics such as curve ﬁtting,
elimination of outliers, and specialized metrics could be used
to ﬁnd a more exact center for transmission as well as more
effective analysis of channel superiority.
Overall, the MSMA algorithm has potential application
in “Smart Grid” communication systems to enable direct
adaptation of channels or subcarriers. The key concept for
this algorithm is dynamic adaptation. As in cognitive radio
and mesh networking systems, the MSMA algorithm is
adaptable, able to quickly and effectively make decisions
about the location of optimal transmission regions in a
given spectrum, as long as the spectral characteristics of
the channel are well deﬁned. This could be valuable for
audio processing, statistical data-mining, and transmissions
in other channels with well deﬁned spectral tendencies.
REFERENCES
[1] J. Shen, S. Liu, Y. Wang, G. Xie, H. Rashvand, and Y. Liu,
“Robust energy detection in cognitive radio,” IET Communi-
cations, vol. 3, no. 6, pp. 1016–1023, June 2009.
[2] Y. M. Kim, G. Zheng, S. H. Sohn, and J. M. Kim, “An alterna-
tive energy detection using sliding window for cognitive radio
system,” in 10th Int. Conf. Adv. Comm. Technology (ICACT
2008), vol. 1, Feb. 2008, pp. 481–485.
[3] J. Wu, T. Luo, and G. Yue, “An energy detection algorithm
based on double-threshold in cognitive radio systems,” in 1st
Int. Conf. Info. Science and Eng. (ICISE 2009), Dec. 2009,
pp. 493–496.
[4] K. Kim, Y. Xin, and S. Rangarajan, “Energy detection based
spectrum sensing for cognitive radio: An experimental study,”
in Proc. IEEE GLOBECOM, Dec. 2010, pp. 1–5.
[5] P. D. Sutton, K. Nolan, and L. Doyle, “Cyclostationary
signatures in practical cognitive radio applications,” IEEE J.
Sel. Areas Commun., vol. 26, no. 1, pp. 13–24, 2008.
31
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

Figure 3.
Micro-adjustment of transmit peaks to maximize SNR. The top plot shows initial positioning of subcarriers. Subsequent plots show subcarrier
micro-adjustment relative to the initial positioning (vertical dotted lines).
Broadband noise in
admissible region
Figure 4.
Example of transmit channels adapting in response to wideband noise interference above 1 kHz.
32
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

[6] B. Farhang-Boroujeny and R. Kempter, “Multicarrier commu-
nication techniques for spectrum sensing and communication
in cognitive radios,” IEEE Commun. Mag., vol. 46, no. 4, pp.
80–85, Apr. 2008.
[7] J. Lunden, V. Koivunen, A. Huttunen, and H. Poor, “Collab-
orative cyclostationary spectrum sensing for cognitive radio
systems,” IEEE Trans. Signal Process., vol. 57, no. 11, pp.
4182–4195, Nov. 2009.
[8] P. Pawelczak, K. Nolan, L. Doyle, S. W. Oh, and D. Cabric,
“Cognitive radio: Ten years of experimentation and devel-
opment,” IEEE Commun. Mag., vol. 49, no. 3, pp. 90–100,
2011.
[9] F. Li, W. Qiao, H. Sun, H. Wan, J. Wang, Y. Xia, Z. Xu, and
P. Zhang, “Smart transmission grid: Vision and framework,”
IEEE Trans. Smart Grid, vol. 1, no. 2, pp. 168–177, 2010.
[10] P. Sutterlin and W. Downey, “A power line communication
tutorial - challenges and technologies,” Universita di Pisa,
Tech. Rep., Dec. 2010.
[11] Recommended Practices and Requirements for Harmonic
Control in Electrical Power Systems, IEEE Std. 519, 1992.
[12] American National Standard for Electrical Power Systems
and Equipment - Voltage Ratings (60 Hz), ANSI Std. C84.1,
2006.
[13] Power Quality Standards for Electric Service, Entergy Power
Company, 2008.
[14] D. Reiken, “Maximum-likelihood estimation of the frequency
response of a low frequency power-line communication chan-
nel,” in IEEE Int. Symp. Power Line Comm., Jeju City, Jeju
Island, 2008.
[15] N. Andreadou and F. Pavlidou, “Modeling the noise on
the OFDM power line communication system,” IEEE Trans.
Power Delivery, vol. 25, no. 1, pp. 150–157, 2010.
[16] D.-H. Na, H. Nan, and S.-J. Yoo, “Policy-based dynamic
channel architecture for cognitive radio networks,” in Com-
munications and Networking in China, Shanghai, 2007.
[17] G. Athanasiou, I. Brousis, T. Korakis, and L. Tassiulas,
“Routing-aware channel selection in multi-radio mesh net-
works,” in Proc. IEEE Int. Conf. on Commun., Dresden, 2009.
[18] E. Jacobsen and R. Lyons, “The sliding DFT,” IEEE Signal
Processing Mag., vol. 20, no. 2, pp. 74–80, 2003.
33
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-197-7
COCORA 2012 : The Second International Conference on Advances in Cognitive Radio

