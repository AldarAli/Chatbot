Multi-Level Collaborative Spectrum Sensing in Nakagami Fading Channels 
 
Omkalthoum El-Bashir Hamed 
Department of Electrical Engineering 
The Petroleum Institute 
Abu-Dhabi, United Arab Emirates 
e-mail: ohamed@pi.ac.ae 
 
Mohammed Abdel-Hafez 
Department of Electrical Engineering 
United Arab Emirates University 
Al-Ain, United Arab Emirates 
e-mail: mhafez@uaeu.ac.ae  
 
 
Abstract— This paper is to investigate the problem of spectrum 
scarcity and underutilization with particular attention to the 
performance of opportunistic spectrum access in fading 
channels. In this paper we studied the energy detector in 
collaborative and non-collaborative sensing modes when the 
channels between the primary and the sensors are generalized 
Nakagami-m fading channel. Soft combining techniques 
perform well enough, but require that each spectrum sensor 
sends complete signal information to the band manager. 
Sending the signal information introduces unnecessary 
complexity. Moreover, it is more complicated and time 
consuming for the band manager to handle. To reduce the 
communication overhead, hard decision techniques can be 
used.  In this paper, two techniques will be studied. The first is 
the simple hard decision technique, and the second is the use of 
multi-threshold decision technique. The results of this study 
show that the multi-threshold technique outperforms the single 
one with slight increment in the cost. The performances of all 
these techniques are evaluated in terms of probability of false 
alarm and probability of detection. Although soft decision 
techniques give less probability of miss detection at certain 
value of probability of false alarm, the hard techniques are 
simpler to implement.  It is also found that the multi-threshold 
works better than the single threshold especially in low SNRs.  
Keywords - Spectrum sensing; opportunistic access; cognitive 
radio; Nakagami-m fading channel; square law combining; 
maximum selection combining; hard decision combining. 
I. 
 INTRODUCTION 
The underutilization of the spectrum leads to thinking in 
managing the spectrum in more flexible way by allowing 
second level of spectrum usage. So, some users called 
“secondary users” are allowed to access spectrum holes, a 
band of frequency assigned to a primary user, but at a 
particular time and specific geographic location, the band is 
not being utilized by that user [1, 2]. Spectrum utilization can 
be improved significantly by making it possible for 
secondary users to access spectrum holes.   
The telecommunication sector debates the reallocation of 
frequencies used for GSM, plans for digital TV switchover, 
formulates policies for cognitive radio and considers options 
for dealing with the wireless data explosion [3]. So, applying 
a sensing technique in the opportunistic wireless networks is 
needed. A simple sensing technique that can be used for this 
purpose is the energy detection. One of the simplest energy 
detectors is presented in [4,5]. This energy detector measures 
the energies of    samples of a received signal over a flat 
band-limited Gaussian noise channel. Then, it combines 
these Gaussian samples for comparison with a certain 
threshold. The result of the comparison can be defined by 
two hypotheses, either signal or no signal.  Accordingly, the 
secondary user will decide on whether or not to access the 
spectrum band. Relying on chi-square statistics of the 
resulting sum of squared Gaussian random variables, 
Urkowitz [6] derived both probability of detection and 
probability of false alarm in Gaussian channel. Since we 
need to have enough protection for the primary user, we have 
to set the threshold such that it provides some protection 
level to the primary user.  However it is found that one 
sensor cannot provide reliable sensing system specially in 
real fading channels. Collaborative sensing techniques had 
been studied in [8,9,10] with local energy detectors to 
improve the sensing system performance in fading channels. 
Zou et al. [8] investigated the effect of user collaboration in 
Rayleigh fading channel. It showed that using more 
collaborative users increases the performance significantly 
and improves the spectrum utilization. The researcher used 
the equal gain and maximum selection as soft decision 
combining techniques to combine the local measurements 
and finalize the decision. Although, soft combining 
techniques perform well, it consumes high bandwidth for 
sharing information. Simple hard decision combining 
technique was used by [8] where each user shares his vote 
with the controller using only binary 0 for empty and binary 
1 for occupied band. Then, the controller makes the decision 
according to the collaborative users votes. As a comparison 
between the soft and hard decision combining techniques, 
soft techniques give much better decisions, but the cost is in 
the network overload by the overhead used to share their 
knowledge about the signal to noise ratios.  
Yilmaz et al. [7] extended the work by applying a new 
combining technique which is collaborative sensing with a 
decision vector that uses a uniform quantization. It consists 
of multiple thresholds and a weight vector for global 
decision. Each operating secondary user should sense the 
channel locally and decide on one of the designed levels 
according to the measured signal to noise ratio. Then the 
secondary user should send his decision to the fusion center. 
The fusion center then makes final decisions according to the 
different users’ votes using a special weighted sum decision 
rule. This method performed better than the single threshold 
hard decision studied in [8] with little addition to the 
overhead. Moreover, as much as the number of levels 
increased, the decision becomes better and the overhead 
increases.   
In [9], Liang et al. came up with a closed form solution 
for the probability of detection in Nakagami-  channel with 
284
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

only integer fading parameters in non-collaborative mode. 
Since Nakagami-  fading channel can have a non-integer 
fading parameter, and to our best knowledge, this hasn’t 
been studied this before. Therefore we started the work by 
using new approach to study soft combining collaboration 
techniques in sensing in Nakagami-  fading channel with 
any real parameter. In this paper, we extended the work of 
[11] to study the hard single and multi-thresholds combining 
techniques for collaborative sensing in Nakagami fading 
channel with any real fading parameters.  
The rest of this paper is organized as follows: Section 2 
presents the system model followed by the analysis of 
spectrum sensing in Additive White Gaussian Noise 
(AWGN) channel in Section 3.  Section 4 addresses the 
spectrum sensing in Nakagami fading channel. Single 
threshold hard decision detection technique is introduced in 
Section 5. In Section 6, multi-levels hard decision technique 
is introduced and the effect of collaborative sensing is 
studied.  Section 7 shows the results of some numerical 
examples. Concluding remarks are presented in Section 8. 
 
II. 
SYSTEM MODEL 
Figure 1 shows the suggested model for sensing scenario 
in our opportunistic spectrum access system. Infrastructure-
based sensors are distributed in the model to sense the 
primary user signal in a certain band. The channel between 
the sensor and the use is assumed to be generalized 
Nakagami-  fading channel with instantaneous signal to 
noise ratio  . The band manager at data fusion center will 
then decide based on the information reported from   
sensors with one of combining techniques will be studied in 
this paper. 
 
Figure 1.  System model. 
III. 
SPECTRUM SENSING IN NON-COLLABORATIVE MODE 
IN AWGN 
AWGN channel is the ideal case of wireless channel 
where the noise is only due to the additive noise at the 
receiver.  The performance in AWGN channel is studied in 
terms of the probability of detection and probability of false 
alarm.  The probability of detection,     and probability of 
false alarm,      in AWGN channel were studied in [6]. Then 
it is revisited by [9] and studied for the sampled version of 
the signal. It is found that these probabilities can be 
expressed as, 
 
      (√  
   √  
   )                          ( ) 
 
and 
 
    (       )
 ( )
   ( )                    ( ) 
 
where   is the    ,    is the variance of the channel. For 
simplicity and without loss of generality,   can be assumed 
to be unity,   (   ) is incomplete gamma function [12],    is 
the half number of samples.    (   )  is the Generalized 
Marcum   function [13]. 
 
IV. 
SPECTRUM SENSING IN NAKAGAMI FADING 
CHANNELS 
This section focuses on the performance of spectrum 
sensing in the Nakagami fading channel. The performance of 
spectrum sensing in the Rayleigh fading channel is a special 
case when fading parameter    . The performance is 
formulated in terms of the probability of detection and 
probability of false alarm. 
For the Nakagami fading channel, the       of the signal 
to noise ratio    ,  ,  has the following gamma distribution, 
 
  ( )  
 
 ( ) ( 
 ̅ )
 
       (  
 ̅  )       ( ) 
 
where  ̅ is the average signal to noise power ratio in the 
fading channel and  m is the Nakagami fading parameter.  
The probability of false alarm is independent of   
because it is the probability of the received energy being 
above the threshold with the absence of the primary user. 
Since, under   , no primary user’s signal exists,    is not 
affected by fading. On the other hand, the probability of 
detection over Nakagami fading channel,       , can be 
found by averaging (1) over (3) as, 
 
       
 
 ( ) ∫
   (√(  ) √  ) ( 
 ̅ )
 
 
 
  
        (
  
 ̅  )                                     ( )  
 
This integration can be simplified using the following steps: 
Let   √(  )   √  , and     
 
 ̅ , then (4) can be 
expressed as, 
 
       
 
 ( ) (  
 )
 
∫    (   )      
 
 
 
    (     
 )                               ( ) 
285
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

 
Marcum  -function defined by [12] is used and defined by, 
 
   (    )  ∫
  
     
 
 
 
 (      
 
)    (  )           ( ) 
 
where α is a dummy variable. After some manipulations and 
using the formulas in (p720 and p1059, [15]), the probability 
of detection in Nakagami channel can be expressed as, 
 
            
 ( ) (
  
    )
 
                                             
 ∫      
 
 
   
 
 
 (    
  
 (     ) )       ( ) 
 
where  (    ) is the degenerate hyper geometric function 
defined in [12]. 
The probability of miss detection, can be expressed as,  
 
                                       ( ) 
 
or 
 
            
 ( ) (
  
    )
 
                                                        
 ∫      
 
 
   
 
 
 (    
  
 (    ))           ( ) 
 
reverting to the original terms and constants in (9), we arrive 
at the following, 
 
            
 ( ) (
 
 ̅   )
 
                                                       
 ∫
     
√ 
 
   
 
 
 (    
   ̅
 ( ̅   ))        (  ) 
 
The integration in (10) is limited and can be evaluated 
easily by using the Monte Carlo integration method [16]. 
The advantage here is that        can be evaluated for 
(integer and non-integer) fading parameters  . At this point, 
the probability of miss detection in Rayleigh fading channel 
can be found by simply setting     as special case.  This 
approach of finding the probability of miss detection in 
Nakagami-m fading channel is suggested and confirmed by 
comparing its results with some results in the literature. 
Digham and Alouini [4] found a closed form formula for the 
average probability of detection in Nakagami for only integer 
values of    values.  
V. 
SINGLE THRESHOLD HARD DECISION TECHNIQUE 
Using this technique, the spectrum sensor sends only one 
bit information as an individual decision. It sends 0 if the 
locally detected signal energy is less than the threshold to 
decide on   . Otherwise, it sends 1 to decide on   . Then, 
the band manager finalizes the decision using votes 
according to the              rule, where   is the required 
number of voters necessary to decide on the existence of the 
primary signal. 
Given that all the sensors are independent, and applying 
the Neyman-Pearson criterion (which is based on fixing the 
probability of false alarm to an acceptable value to find a test 
threshold that maximizes the probability of detection), results 
in the following combining rule [5]  
 
∑       [
   (      )
(     )       ]        
            
 
   
(  ) 
 
where    is the  th sensor decision.     and     are the 
individual probabilities of detections and false alarm, 
respectively. The band manager decides by comparing the 
weighted sum of the individual decisions to a threshold  ; 
where    is a global threshold with discrete value in this 
technique. In this study,     sensors are assumed to simplify 
the analysis. So,      and      are assumed to be equal for all 
the sensors as a result of identical path loss and fading. It is 
also assumed that all the users imply the same threshold λ in 
their local decision for simple implementation. Thus based 
on the other chosen global threshold  , the data fusion center 
implements an               voting rule. It decides    if   or 
more vote to   , otherwise, it will decide on   . The average 
probabilities of detection and false alarm for the            
rule are related to their single user probabilities through 
binomial distribution. The AND and the OR decision rules 
are considered as special cases from the general             
rule. By using AND rule, the band manager will decide on 
   if all the sensors agree on deciding on the primary user 
existence. On the other hand, by the OR rule, the band 
manager will decide on    when at least one sensor has 
decided locally on the primary user existence [5]: 
 
         ∑ ( 
 )   
 (    )
   
 
   
                (  ) 
 
and 
 
 
         ∑ ( 
 )       
 (        )
          
 
   
(  ) 
                 
where        and    are the individual probabilities of 
detection and false alarm as defined by (7) and (2), 
respectively.  
VI. 
MULTI-THRESHOLD HARD DECISION TECHNIQUE 
The simple hard decision algorithm introduced in Section 
5 was based on single threshold. In the single threshold 
detection method, the decision     or     depends only on 
one local threshold λ.    and    for a single secondary user 
286
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

can be calculated using λ for  a selected channel model and 
using the exact formulas given by (12) and (13).  
Figure 2 shows four-thresholds as an example of the 
method proposed by [7], namely,    ,    ,    and   . The 
distance between the center thresholds     and      and  the 
other thresholds is fixed and is equal to ∆, and there is a    
distance among the center thresholds themselves. Each 
sensor determines the quantization bin from the bins vector 
                 locally according to its measurement and 
the thresholds given. For example, if the measured energy 
value is between the values of    and    , the sensor will 
decide on     bin. When the measurement is in the region 
between thresholds     and     the sensor shouldn’t send its 
decision. This technique censors some sensors from sending 
their information because of its low importance. The 
measurements in the “no decision” region are not important 
because it is in the middle of the range. In other words, it is 
not high enough to vote for the primary user  presence, nor 
low enough to vote for its absence. The idea behind 
censoring is avoiding overloading the band with unnecessary 
data by having sensors send their decision to the fusion 
center only if this decision is considered to be "informative" 
Or, only if they are sure enough about it.  
 
 
Figure 2.  Multi threshold Energy detector with four thresholds. 
The sensors send their softened decisions or quantized 
measurements in 2-bit formats for 4-threshold case and 3-bit 
formats for 8-threshold cases and so on. The fusion center 
gives a weight vector to the quantization bins. So, deciding 
on each bin has special weighting determined by the fusion 
center to change the rule of the decision used. For example 
  ⃑⃑                is equivalent to the majority rule. The 
fusion center receives the softened decisions and counts the 
number of users in each quantization bin and forms a vector 
 ⃑  that lists how many sensors reported in each bin. Then, if 
the inner product of the two vectors   ⃑⃑  and  ⃑  is > 0,   ⃑⃑ ( ⃑ ) 
is considered 1, otherwise, it will be considered as 0. 
To quantify the performance of this method, probability 
of detection and probability of false alarm are calculated 
using the formulas below [7]: 
 
   ∑   ⃑⃑ ( ⃑ )  (    ) (       ) (          )
 ⃑   
 
 (             )(      )
  (      )
  (      )
    
 
(      )
  (      )
                                                              (  ) 
 
 
 
 
and             
   ∑   ⃑⃑ ( ⃑ )  (    ) (       ) (          )
 ⃑   
 
 (             )(      )
  (      )
  (      )
     
 
(      )
  (      )
                                                              (  ) 
 
where   represents all combinations of number of users 
distributed in quantization bins,  (    )  represents   
combinations out of  ,    represents the number of users in 
  , and        represents the probability of the received 
energy being in    conditioned on    and under AWGN 
channel. Similar formulas can be obtained for fading 
channels by calculating local probabilities according to 
fading channel formulas. This model is used in [7] to 
evaluate ROC in AWGN and in Rayleigh channels. In this 
thesis, only a special case of this model is studied and 
applied as per the Nakagami-m channel with any real fading 
parameter. 
VII. NUMERICAL RESULTS 
Figure 3 shows the Complementary Region Of 
Convergence (CROC) for combined iid   spectrum sensors 
in Nakagami fading channel with average            
and fading parameter       . The figure shows the 
performance improvement when using more than one sensor 
to detect the channel when the hard decision combining 
technique is used. The decision rule is based on  “            
rule. Figure 3 shows the OR rule has the least probability of 
miss detection at a certain value of probability of false alarm 
among all the other values of  . The AND rule has the most 
probability of detection at a certain value of probability of 
false alarm among the other voting rules.   This means that 
by using the OR rule, we can guarantee a better level of QoS 
for the primary user. However, the down side is degradation 
in utilization. Therefore, the AND rule gives better 
utilization, but it decreases the QoS of the primary user. 
Performance of all other              schemes is in between 
the two extreme cases, the OR and the AND rules. The 
network designer should be aware of the required level of 
primary user QoS and the additional utilization required in 
deciding which rule to use.  
By comparing this technique with the soft decision 
technique presented in [11], we can consider the 
performance of the least probability of miss detection case 
(OR curve) with the soft decision cases when the number of 
collaborated users is     . In general, soft decision 
technique outperforms hard decision but hard decision 
technique is much simpler. The complexity of the soft 
decision combining techniques arises from different factors. 
The first is implementation needs; for example MSC needs 
channel gain estimation. Moreover, in the soft decision 
combining technique, the process of gathering information 
from sensors is complicated. In addition, the sensors share 
their measurements rather than their decisions with the 
fusion center. This needs more bandwidth to carry all the 
287
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

information, especially when there is large number of 
sensors. This will affect the utilization of the scarce 
spectrum, because the hard decision uses only one bit (0 or 
1) to report its final decision to the band manager, after 
which the band manager simply applies one of the discussed 
voting rules to finalize the decision. So, a very simple 
receiver can carry out the process of finalizing the decision.  
 
Figure 3.  CROC for diversity in Nakagami for      iid sensors using 
Hard Decision combining technique for                       and 
     . 
Figure 4 shows the effect of the number of collaborated 
sensors on detection performance. In this figure,     iid 
sensors are used. The figure shows               voting rule 
with especial cases OR, and AND. The improvement in the 
performance due to larger number of collaborative sensors is 
very clear in this instance. So, to get good detection without 
degrading the utilization, the designer can use more sensors 
and use any of the           . For example, instead of using 
the            rule, we can use the            rule to get 
better performance without degrading the utilization. The 
cost of this improvement is the cost of the extra sensors and a 
slight addition in band consumption (1 bit/sensor). 
Figure 5 shows the CROC curve for the single and 4-
threshold Hard Decision combining technique model system. 
The figure is generated for the two cases with     
collaborative sensors, average          , and majority 
rule. The 4-threshold majority rule is chosen with a 
weighting vector  ⃑⃑  =[-1 -1 0 1 1]. For the single threshold, 
the majority rule is considered when     in the 
             rule and is compared with the performance of 
the single threshold hard decision combining technique. It is 
found that this method significantly outperforms the single 
threshold hard decision technique. The cost of this 
improvement is only a slight increment in the overhead 
coming from sending two bits instead of one bit for each 
sensor.  
 
 
Figure 4.  CROC for diversity in Nakagami for      iid sensors using 
Hard Decision combining technique for                       and 
     . 
This combining technique can be considered to be the 
best among all the combining techniques studied, because it 
gives the designer the chance to make a trade-off between 
the cost and the detection accuracy of the system. Then 
accordingly, the number of collaborative sensors and number 
of thresholds can be chosen to fit the need.  
 
Figure 5.  CROC for 4 thresholds hard decision combining technique 
compared to the single threshold, majority rule in the two 
cases,                                      
 
 
10
-4
10
-3
10
-2
10
-1
10
0
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
pf
pm
 
 
n=2
n=3
n=4 (AND)
n=1 (OR)
10
-4
10
-3
10
-2
10
-1
10
0
10
-7
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
pf
pm
 
 
n=1 (OR)
n=8 (AND)
n=4
n=6
10
-6
10
-4
10
-2
10
0
10
-10
10
-8
10
-6
10
-4
10
-2
10
0
pf
pm
 
 
Single Threshold Hard Decision
4 Thresholds Hard Decision
288
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

VIII. CONCLUSION AND FUTURE WORKS  
In conclusion, collaborative spectrum sensing model is 
studied in this paper when the sensing channel is a general 
Nakagami fading channel. Hard decision combining 
techniques were used to combine the collaborated sensors 
signal where each sensor shares only one or few bits to 
represent its sensing results. Single and multi-thresholds 
techniques are considered. Results show that both of them 
improved the system sensing performance significantly. It is 
also found that the multi-threshold works better than the 
single threshold especially in low SNRs. Results were 
compared to the other soft decision techniques used in the 
literature. It is found that soft techniques perform better but it 
has high fixed cost. On the other hand, the multi-level hard 
techniques are simpler to implement and have the flexibility 
tradeoff between the performance and the cost according to 
the application and the channel type.   
REFERENCES 
[1] http://www.portiodirect.com/productDetail.aspx?pid=49$55$51$431, 
Portio Research Mobile Factbook 2009, retrieved: April, 2012.  
[2] http://www.sharedspectrum.com, retrieved: April, 2012. 
[3] Fedral Communication Commission, “Spectrum Policy Task Force,” 
Rep.  ET, Docket No. 02-135, Nov. 2002. 
[4] F. F. Digham, M.-S. Alouini, and M. K. Simon, “On The energy 
Detection of Unknown Signals over Fading Channels,” IEEE 
Transactions on Communications, vol. 55, no.1, pp. 21-24, January 
2007. 
[5] A. Ghasemi and E. Sousa, “Opportunistic Spectrum Access in Fading 
Channels 
Through 
Collaborative 
Sensing,” 
Journal 
of 
communications, vol. 2, no. 2, pp. 71-82, March 2007. 
[6] H. Urkowitz, “Energy Detection of Unknown Deterministic Signals,” 
Proc. IEEE, vol. 55, pp. 523-531, April 1967. 
[7] H.Birkan Yilmaz, Tuna Tugcu, and Fatih Alagoz, “Uniform 
Quantizer for Cooperative Sensing in Cognitive Radio Networks”, 
PIMRC 2010, September 2010. 
[8] Q. Zou, S. Zheng, and A. H. Sayed, “Cooperative Spectrum Sensing 
Via Coherence Detection,” 15th workshop on statistical signal 
processing, IEEE/SP, pp. 610 – 613, Aug. 31 2009-Sept. 3 2009. 
[9] Y.-C. Liang, Y. Zeng, T. Hoang, and E. Peh, “Sensing-Throughput 
Trade-off for Cognetive Radio Networks,” IEEE Trans. on wireless 
communications, vol. 7, no. 4, pp. 1326-1337, April 2008. 
[10] A. Ghasemi and E. Sousa, “Fundmental Limits of Spectrum-Sharing 
in Fading Environments,” IEEE Trans. on wireless communnication, 
vol. 6, no. 2, pp. 649-658, Feb. 2007. 
[11] O. Al-Bashir and M. Abdel-Hafez, “Opportunistic Spectrum Access 
Using Collaborative Sensing in Nakagami-m Fading Channel with 
Real Fading Parameter,” 7th International Wireless Communications 
and Mobile Computing Conference (IWCMC), pp. 472 - 476, July 5-
8, 2011, Istanbul, Turkey. 
[12] A. H. Nuttal,“Some Integral Involving the   -Function,” IEEE 
Trans. Inf. Theory , vol. 21, no. 1, pp. 95-96, Jan. 1975. 
[13] A. Papoulis, “Probability, Random Variables, and Stochastic 
Processes,” McGraw-Hill Europe; 4th edition (January 2002). 
[14] C. Shannon, “A mathmatical theory of communication,” Bell Systems 
Technical Journal 1948, 27, pp. 623-656. 
[15] I. S. Gryadshteyn and IM. Ryzhik, “Table of Integrals, Series, and 
Products,” 5th Edition. San Diego: Academic, 1994. 
[16] W. Tranter, K. Shanmugan, T. Rappaport and K. Kosbar, “Principles 
of Communication Systems Simulation with Wireless Applications,” 
Prentice Hall, 2004. 
289
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-203-5
ICWMC 2012 : The Eighth International Conference on Wireless and Mobile Communications

