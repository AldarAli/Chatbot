Robust Integer Frequency Offset Estimation Scheme
Based on Differentially Combined Correlator
Outputs for DVB-T Systems
Jong In Park1, Hyung-Weon Cho2, Youngpo Lee1, Sun Yong Kim3, Gyu-In Jee3, Jin-Mo Yang4, and Seokho Yoon1,†
1School of Information and Communication Engineering, Sungkyunkwan University, Suwon, Korea
2Samsung Thales Co. LTD., Seongnam, Korea
3Department of Electronics Engineering, Konkuk University, Seoul, Korea
4Agency for Defense Development (ADD), Daejeon, Korea
†Corresponding author
(E-mail: pji17@skku.edu, hyungweon.cho@samsung.com, leeyp204@skku.edu,
{kimsy, gijee}@konkuk.ac.kr, jmy1965@dreamwiz.com, and †syoon@skku.edu)
Abstract—A pilot-aided integer frequency offset (IFO) estima-
tion scheme robust to the timing offset is proposed for orthogonal
frequency division multiplexing (OFDM)-based digital video
broadcasting-terrestrial (DVB-T) systems. The proposed scheme
ﬁrst produces correlation values between each continual pilot
(CP) and a predetermined scattered pilot (SP), and then, re-
correlates the correlation values in order to reduce the inﬂuence
of the timing offset. Simulation results show that the proposed
IFO estimation scheme is robust to the timing offset and has
better estimation performance than the conventional scheme.
Index Terms—DVB-T, estimation, IFO, OFDM, timing offset,
emerging networks
I. INTRODUCTION
Due to its immunity to multipath fading and high spectral ef-
ﬁciency, orthogonal frequency division multiplexing (OFDM)
has been adopted as a modulation format in a wide variety of
emerging wireless systems such as digital video broadcasting-
terrestrial (DVB-T), digital audio broadcasting (DAB), and
wireless local area networks (WLANs) [1], [2]. Moreover, the
next generation telecommunication system including long term
evolution (LTE) also employs OFDM as the physical layer
implementation. However, the OFDM is very sensitive to the
frequency offset (FO) caused by Doppler shift or oscillator
instabilities, and thus, the FO estimation is one of the most
important technical issues in OFDM-based wireless systems
[3], [4]. The FO normalized to the subcarrier spacing can
be divided into integer and fractional parts that bring on a
cyclic shift of the OFDM subcarrier indices and intercarrier
interference (ICI), respectively [5]. In this paper, we deal with
the integer FO (IFO) estimation for OFDM-based DVB-T
systems.
Recently, several IFO estimation schemes [6], [7] have
been proposed for OFDM-based DVB-T systems. [6] estimates
the IFO by using the correlation between the received pilots
and reference pilots in the receiver; however, it exhibits poor
performance in the multipath channel. In [7], to alleviate the
inﬂuence of the multipath, the IFO is estimated based on the
correlation between each continual pilot (CP) and its most
adjacent scattered pilot (SP) in the received OFDM symbol;
however, the scheme assumes that the timing synchronization
is perfectly achieved before IFO estimation. In practical sys-
tems, only coarse timing synchronization is performed before
FO estimation, and ﬁne timing synchronization is performed
after FO estimation [5]. Thus, the timing offset often remains
during the IFO estimation step and affects the IFO estimation
performance.
In this paper, we propose a novel pilot-aided IFO estimation
scheme robust to the inﬂuence of the timing offset for OFDM-
based DVB-T systems. By producing the correlation values
between each CP and predetermined SP and re-correlating the
correlation values, the proposed scheme reduces the inﬂuence
of the timing offset on the IFO estimation. Simulation results
show that the proposed scheme has more robust and better es-
timation performance compared with that of the conventional
scheme in [7]. The rest of this paper is organized as follows.
Section II describes the OFDM-based DVB-T system model.
In Section III, we present the conventional IFO estimation
scheme, and a novel IFO estimation scheme robust to the
inﬂuence of the timing offset is proposed in Section IV.
Section V demonstrates the IFO estimation performance of the
two schemes in the multipath channel. Section VI concludes
this paper.
II. SYSTEM MODEL
DVB-T systems operate in 2K or 8K mode, of which the
former is considered in this paper, where 1705 subcarriers
among a total of 2048 subcarriers are used to transmit data and
pilots of 45 CPs and 142 or 143 SPs. The pilots are used for
frequency and timing synchronization and channel estimation,
and have a value of either +4/3 or −4/3 depending on a
pseudo random binary sequence (PRBS). Fig. 1 describes the
pilot arrangement in a DVB-T system with 2K mode, where
29
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-174-8
EMERGING 2011 : The Third International Conference on Emerging Network Intelligence

ˎ
Symbol 67
Symbol 0
Symbol 1
Symbol 2
ˎ
Symbol 66
OFDM subcarrier index
OFDM symbol index
ˎ
ˎ
ˎ
ˎ
ˎ
ˎ
ˎ
CP
SP
Data
Kmin = 0
Kmax = 1704
Fig. 1.
Pilot arrangement in a DVB-T system with 2K mode.
SPs are periodically inserted every twelve subcarriers between
the smallest and largest subcarrier indices Kmin and Kmax of
the active subcarriers in all OFDM symbols and the insertion
pattern is repeated every four OFDM symbols [8].
In the transmitter, the OFDM symbol is transmitted with
the guard interval inserted at the beginning of the OFDM
symbol to prevent the intersymbol interference. After passing
through the channel, the n-th sample of the l-th received
OFDM symbol in the receiver can be expressed as
yl(n) = xl(n + τ)ej2πν(lNT +n+τ)/N + wl(n),
for l = 0, 1, · · · ,
and n = 0, 1, · · · , N − 1,
(1)
where τ and ν are the timing and frequency offsets normalized
to the OFDM sample and subcarrier spacing, respectively, NT
is the number of the samples in an OFDM symbol including
the guard interval, N is the size of the inverse fast Fourier
transform (IFFT), and wl(n) is the additive white Gaussian
noise (AWGN) sample with mean zero and variance σ2
w =
E{|wl(n)|2}. The signal xl(n) can be represented as
xl(n) =
1
√
N
N−1
∑
k=0
Xl(k)Hl(k)ej2πkn/N,
for l = 0, 1, · · · ,
and n = 0, 1, · · · , N − 1,
(2)
where Xl(k) is a pilot or data transmitted through the k-th
subcarrier of the l-th OFDM symbol and Hl(k) is the channel
frequency response on the k-th subcarrier of the l-th OFDM
symbol.
In the receiver, the estimation and compensation processes
for the fractional FO (FFO) are generally performed before
the IFO estimation [5], in this paper, we assume the perfect
estimation and compensation for the FFO. Then the FFT
output corresponding to the k-th subcarrier of the l-th received
OFDM symbol is expressed as
Yl(k) = ej2π∆lNT /Nej2πτk/N
× Hl(k − ∆)Xl(k − ∆) + Wl(k),
(3)
where Wl(k) is the zero-mean complex AWGN sample in the
frequency domain and ∆ is the IFO. From (3), we can observe
that the IFO and timing offset cause the cyclic shift of the
subcarrier indices and the phase rotation in the received OFDM
symbol, respectively.
III. CONVENTIONAL SCHEME
The conventional scheme presented in [7] estimates the IFO
by using the template Tm(k) expressed as
Tm(k) = Zm(k′)
Zm(k) ,
for
k ∈ Ccp and m ∈ {0, 1, 2, 3},
(4)
where m is the index of the OFDM symbol to distinguish the
four different pilot patterns, Zm(k) denotes the CP with the
subcarrier index k in the m-th pilot pattern, and Zm(k′) is the
most adjacent SP of Zm(k), respectively, Ccp is the set of the
subcarrier indices of the CPs.
In the conventional scheme, the following metric is ﬁrst
performed for all trial values for the IFO estimation in order
to recognize the pilot pattern of the received OFDM symbol.
m0 = arg max
m∈{0,1,2,3}
{
Re
(
Ψ(f, m)
)}
,
for
|f| ≤ N/2,
(5)
where Ψ(f, m) = ∑
km∈Ccp Y0(km + f)Y ∗
0 (k′
m + f)Tm(km),
f is a trial value, and km and k′
m are the indices of the CP
and its most adjacent SP in the m-th pilot pattern, respectively.
Then, the most reliable α trial values in all trial values are
chosen as follows
{f1, . . . , fα} = arg maxα
|f|≤N/2
{
Re
(
Ψ(f, m0)
)}
,
(6)
where arg maxα
|f|≤N/2
{b(f)} selects the α largest values among f
according to the results of b(f). By exploiting the selected
α trial values and correlation values of the pilots in the D
consecutive OFDM symbols, the estimate b∆ of IFO is obtained
as follows
Ω(f) =
∑
km0⊕l∈Ccp
D−1
∑
l=0
Yl(km0⊕l + f)
× Y ∗
l (k′
m0⊕l + f)Tm0⊕l(km0⊕l),
(7)
b∆ =
arg max
f∈{f1,f2,...,fα}
{
Re
(
Ω(f)
)}
,
(8)
where f is an element of the set of trial values selected in (6),
D is the number of consecutive OFDM symbols used for IFO
estimation, and (m0 ⊕ l) is the remainder operation when the
sum of the m0 and l is divided by four, respectively. If α is set
to be 1, (7) and (8) become meaningless. Due to the narrow
subcarrier spacing in the OFDM-based DVB-T systems, it can
be assumed that the channel frequency responses of a CP and
its most adjacent SP are the same. Thus, when there exists the
timing offset, (7) can be rewritten as
Ω(f) =
∑
km0⊕l∈Ccp
D−1
∑
l=0
ej2πτ(km0⊕l−k′
m0⊕l)/N
×
Hl(km0⊕l + f − ∆)

2
Xl(km0⊕l + f − ∆)
× X∗
l (k′
m0⊕l + f − ∆)Zm0⊕l(k′
m0⊕l)
Zm0⊕l(km0⊕l)
+ c
Wl(km0⊕l),
(9)
30
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-174-8
EMERGING 2011 : The Third International Conference on Emerging Network Intelligence

where c
Wl(km0⊕l) represents the noise term. As shown in
(9), the phase rotation caused by the timing offset affects the
estimation of the IFO in the conventional scheme.
IV. PROPOSED SCHEME
In this section, we propose a novel IFO estimation scheme
robust to the timing offset. In the proposed scheme, the
correlation value between each CP and a predetermined SP
is calculated for all CPs, and then, the correlation values are
classiﬁed into several groups according to the predetermined
sample distances between the CP and predetermined SP. Since
the correlation values with the same sample distance are
equally affected by the timing offset, the inﬂuence of the
timing offset can be removed by re-correlating the classiﬁed
correlation values.
If the subcarrier indices of the CP and SP are the same, the
pilot on the index is considered as the CP, and the most adja-
cent SP to the CP is called the predetermined SP. According to
the DVB-T standard document, the sample distances between
a CP and its predetermined SP in an OFDM symbol is among
±3, ±6, ±9, and ±12 [8], and thus, the pilot pattern of the
received OFDM symbol is recognized as follows
m0 = arg max
m∈{0,1,2,3}
{
Re
(
Λ(f, m)
)}
,
for
|f| ≤ N/2, (10)
where Λ(f, m) is given by
Λ(f, m) =
∑
g∈G
Gn(m,g)−1
∑
i=1
Gn(m,g)
∑
j=i+1
Y0(Ig,m(i) + f)
× Y ∗
0 (Ig,m(i) + g + f)Tm(Ig,m(i))
×
{
Y0(Ig,m(j) + f)Y ∗
0 (Ig,m(j) + g + f)
× Tm(Ig,m(j))
}∗
,
(11)
where g is the sample distance between the CP and predeter-
mined SP, G is the set of the sample distances between the
CPs and predetermined SPs, and Gn(m, g) is the number of
the CPs with the sample distance g in the m-th pilot pattern.
Ig,m(i) is the subcarrier index of the i-th CP included in the
group with the sample distance g in the m-th pilot pattern.
The template of the proposed scheme is expressed as
Tm
(
Ig,m(k)
)
= Zm(Ig,m(k) + g)
Zm(Ig,m(k))
,
for
k ∈ Ccp and m ∈ {0, 1, 2, 3}.
(12)
After recognizing the pilot pattern of the received OFDM
symbol, we select the most reliable α trial values as follows:
{f1, . . . , fα} = arg maxα
|f|≤N/2
{
Re
(
Λ(f, m0)
)}
.
(13)
By exploiting the selected α trial values and correlation
values of the pilots in the D consecutive OFDM symbols,
the proposed scheme estimates the IFO as follows:
Γ(f) =
D−1
∑
l=0
∑
g∈G
Gn(m,g)−1
∑
i=1
Gn(m,g)
∑
j=i+1
Yl(Ig,m0⊕l(i) + f)
× Y ∗
l (Ig,m0⊕l(i) + g + f)Tm0⊕l(Ig,m0⊕l(i))
×
{
Yl(Ig,m0⊕l(j) + f)Y ∗
l (Ig,m0⊕l(j) + g + f)
× Tm0⊕l(Ig,m0⊕l(j))
}∗
(14)
and
b∆ =
arg max
f∈{f1,f2,...,fα}
{
Re
(
Γ(f)
)}
,
(15)
where f is an element of the set of trial values selected in
(13).
Assuming that the channel frequency responses of the CP
and predetermined SP are the same, when there exists a timing
offset, we can re-write (14) as
Γ(f) =
D−1
∑
l=0
∑
g∈G
Gn(m,g)−1
∑
i=1
Gn(m,g)
∑
j=i+1
Hl(A)

2
Xl(A)
× X∗
l (A + g)Zm0⊕l(Ig,m0⊕l(i) + g)
Zm0⊕l(Ig,m0⊕l(i))
Hl(B)

2
× X∗
l (B)Xl(B + g)
×
{Zm0⊕l(Ig,m0⊕l(j) + g)
Zm0⊕l(Ig,m0⊕l(j))
}∗
+ c
Wl(Ig,m0⊕l(j)),
(16)
where A = Ig,m0⊕l(i)+f −∆, B = Ig,m0⊕l(j)+f −∆, and
c
Wl(Ig,m0⊕l(j)) represents the noise term.
V. SIMULATION RESULTS
In this section, the proposed scheme is compared with the
conventional scheme in terms of the IFO detection probability
in the multipath channel. We consider a DVB-T system
with 2K mode and quadrature amplitude modulation. The
parameters used in the simulation are as follows: the guard
interval size of 128, D = 1 and 2, N = 2048, ∆ = 1, and
α = N/4. The signal-to-noise ratio (SNR) is deﬁned as σ2
x/σ2
w
where σ2
x = E{|xl(n)|2}. We consider a ten-path Rayleigh
fading channel with path delays of 0, 10, · · · , 90 samples and
an exponential power delay proﬁle where the power ratio of
the ﬁrst path to the last path is 20 dB. The phase of each
path is assumed to be distributed uniformly in (−π, π] and
the maximum Doppler frequency is set to be 100 Hz.
Fig. 2 shows the IFO detection probabilities of the proposed
and conventional schemes as a function of the timing offset
normalized to the length of one OFDM symbol when the SNR
is 5 dB. As shown in Fig. 2, the IFO detection probability of
the conventional scheme is severely degraded as the timing
offset is increased, whereas that of the proposed scheme is
almost constant regardless of the timing offset value.
Figs. 3-5 show the IFO detection probabilities of the pro-
posed and conventional schemes as a function of the SNR
when the timing offset is 1/64, 2/64, and 3/64, respectively.
31
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-174-8
EMERGING 2011 : The Third International Conference on Emerging Network Intelligence

0
32
64
96
128
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Timing offset
Detection probability
Conventional scheme (1 symbol)
Proposed scheme (1 symbol)
Conventional scheme (2 symbols)
Proposed scheme (2 symbols)
1/64
2/64
3/64
4/64
Fig. 2.
IFO detection probabilities of the conventional and proposed schemes
when the SNR is 5 dB.
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR (dB)
Detection probability
Conventional scheme (1 symbol)
Proposed scheme (1 symbol)
Conventional scheme (2 symbols)
Proposed scheme (2 symbols)
Fig. 3.
IFO detection probabilities of the conventional and proposed schemes
when the timing offset is 1/64.
From the ﬁgures, it is found that the difference in IFO esti-
mation performance between the proposed and conventional
schemes becomes larger as the timing offset is increased.
The proposed scheme has a better performance under the
inﬂuence of timing offset, however, it requires higher compu-
tational complexity than the conventional scheme. Thus, the
robust scheme to the timing offset with a low complexity will
be studied in our future work.
VI. CONCLUSION
By ﬁrst producing the correlation values between CPs
and their own predetermined SPs and then re-correlating the
correlation values, we have proposed a novel IFO estimation
scheme robust to the inﬂuence of the timing offset. From the
simulation results, it has been conﬁrmed that the proposed
scheme has more robust and better estimation performance
compared with that of the conventional scheme.
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR (dB)
Detection probability
Conventional scheme (1 symbol)
Proposed scheme (1 symbol)
Conventional scheme (2 symbols)
Proposed scheme (2 symbols)
Fig. 4.
IFO detection probabilities of the conventional and proposed schemes
when the timing offset is 2/64.
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR (dB)
Detection probability
Conventional scheme (1 symbol)
Proposed scheme (1 symbol)
Conventional scheme (2 symbols)
Proposed scheme (2 symbols)
Fig. 5.
IFO detection probabilities of the conventional and proposed schemes
when the timing offset is 3/64.
ACKNOWLEDGMENT
This work was supported by the National Research Founda-
tion (NRF) of Korea under Grants 2011-0018046 and 2011-
0002915 with funding from the Ministry of Education, Sci-
ence and Technology (MEST), Korea; by a Grant-in-Aid of
Samsung Thales; by the Information Technology Research
Center (ITRC) program of the National IT Industry Promo-
tion Agency (NIPA) under Grant NIPA-2011-C1090-1111-
0005 with funding from the Ministry of Knowledge Econ-
omy (MKE), Korea; and by National GNSS Research Center
program of Defense Acquisition Program Administration and
Agency for Defense Development.
REFERENCES
[1] A. Filippi and S. Serbetli, “OFDM symbol synchronization using fre-
quency domain pilots in time domain,” IEEE Trans. Wireless Commun.,
vol. 8, no. 6, pp. 3240-3248, June 2009.
32
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-174-8
EMERGING 2011 : The Third International Conference on Emerging Network Intelligence

[2] M. M. Wang, L. Xiao, T. Brown, and M. Dong, “Optimal symbol timing
for OFDM wireless communications,” IEEE Trans. Wireless Commun.,
vol. 8, no. 10, pp. 5328-5337, Oct. 2009.
[3] M. Morelli and M. Moretti, “Integer frequency offset recovery in OFDM
transmissions over selective channels,” IEEE Trans. Wireless Commun.,
vol. 7, no. 12, pp. 5220-5226, Dec. 2008.
[4] P. Dharmawansa, N. Rajatheva, and H. Minn, “An exact error probability
analysis of OFDM systems with frequency offset,” IEEE Trans. Commun.,
vol. 57, no. 1, pp. 26-31, Jan. 2009.
[5] M. Speth, S. Fechtel, G. Fock, and H. Meyr, “Optimum receiver design
for OFDM-based broadband transmission - part II: a case study,” IEEE
Trans. Commun., vol. 49, no. 4, pp. 571-578, Apr. 2001.
[6] P. Liu, B.-B. Li, Z.-Y. Lu, and F.-K. Gong, “A new frequency synchro-
nization scheme for OFDM,” IEEE Trans. Consumer Electron., vol. 50,
no. 3, pp. 823-828, Aug. 2004.
[7] K.-T. Lee and J.-S. Seo, “Pilot-aided frequency offset estimation for
digital video broadcasting systems,” IEICE Trans. Commun., vol. E90-B,
no. 11, pp. 3327-3329, Nov. 2007.
[8] ETSI EN 300 744, “Digital video broadcasting (DVB); framing structure,
channel coding and modulation for digital terrestrial television,” ETSI,
Tech. Rep., Jan. 2001.
33
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-174-8
EMERGING 2011 : The Third International Conference on Emerging Network Intelligence

