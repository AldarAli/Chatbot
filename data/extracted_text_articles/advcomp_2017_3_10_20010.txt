Optimal Design of Diffuser and Matching Lens in Proton Radiography
Haibo Xu
Institute of Applied Physics and Computational
Mathematics, Beijing, China
e-mail: xu_haibo@iapcm.ac.cn
Qinggang Jia
Institute of Applied Physics and Computational
Mathematics, Beijing, China
e-mail: 345515962@qq.com
Abstract—In this paper, we study the optimal design of diffuser
and
matching
magnetic
lens
in
high-energy
proton
radiography. The constraints related to the limitation of
overall length, maximum magnetic lens intensities, cross-
sectional size of magnetic lens and the size of object are all
addressed using the genetic algorithm. The parameters of the
diffuser and the matching lens are obtained to be suitable for
the proton beam of 20 GeV. The Monte Carlo code Geant4 is
applied to verify the diffuser performance and to improve it.
Keywords-proton radiography; multiple Coulomb scattering;
diffuser; matching lens.
I.
INTRODUCTION
Compared to X-ray, high-energy protons perform better
as a radiographic probe for dense objects in hydrotest
experiments because of their extremely penetrating power
[1]. The three most important effects on the protons as they
go through an object are absorption, Multiple Coulomb
Scattering (MCS), and energy loss. The MCS effect will
seriously blur the radiographic image of the object. To
suppress this kind of blurring, a magnetic structure called
Zumbro lens was developed by Mottershead and Zumbro [2].
The protons that are not scattered or absorbed in the
object emerge from the object with a reduced energy spread
due to collision with atomic electrons. The energy spread,
together with chromatic aberration in the lens, causes image
blurring. Chromatic aberrations in the magnetic lens can be
minimized by making the lens system as short as possible
and by using an illuminating beam with a special correlation
between transverse position and angle. The protons must
have an “angle-position correlation”, which means that the
angle of the illuminating rays is a linear function of the
distance from the axis, as if it comes from a (virtual) point
source a distance upstream of the entry plane of the lens.
Before entering the imaging lens that forms the radiographic
images, the proton beam passes through a thin tantalum sheet,
which spreads the beam so it can illuminate the entire test
object. The beam passes through a set of quadrupole
electromagnets that gives the protons the angle-position
correlation. The matching lens may give the protons the
necessary correlation [3].
To the best of our knowledge, there is no report on how
to design both the diffuser and the matching lens. Some
references [4-6] focus on optimal design of Zumbro lens
(downstream of matching lens). These designs are mainly
based on an analytic method with thin-lens approximation.
With all constraints such as Fourier points and Field-of-
View (FOV) [4], the allowed parameter sets can produce the
inverting identity (-I) magnetic optics. Beam physics
packages such as MARTLIE [5] and COSY [6] are
employed to compute the chromatics for each parameter set.
Regarding the design of the diffuser and the matching lens,
several constraints such as the position-angle correlation
required by Zumbro lens, FOV size and drifting length are
limiting the searching of best solutions with less chromatic
aberration. This kind of chromatic aberration is produced
when the proton attenuates the diffuser. So, the design of
both the diffuser and the matching lens is expected to be a
multi-objective
optimization
with
many
constraints.
Therefore, we employ genetic algorithm (GA) as the
optimization method because it is recognized as the best
globally well-adapted
optimization algorithm [7]. The
Monte Carlo code Geant4 is applied to verify the diffuser
performance [8].
This paper is organized as follows. The principles of the
diffuser and the matching lens are presented in Section II. In
Section III, the numerical results are obtained with the GA.
Finally, the conclusion is given in Section IV.
II.
PRINCIPLES OF DIFFUSER AND MATCHING LENS
The designed matching lens should have two functions.
The first function is to provide proton beam with the desired
angle-position correlation at the object plane. The second
function is to expand the beam size to fully illuminate the
object. In addition, the design should consider the upstream
diffuser. The diffuser works together with the matching
lens. Once the lens is designed, the thickness of the diffuser
is obtained. To get a lower chromatic aberration, a thinner
diffuser should be used. However, if the diffuser is too thin,
it may not provide the required position-angle correlation
for the matching lens. Therefore, the diffuser thickness
should also be taken into the matching lens optimization.
The transfer of a proton in matching lens of x plane has
the form:






+





 = 





diffuser
0
0
0
22
21
12
11
0
0
ϕ
x
w
x
M
M
M
M
wAx
Ax
        (1) 
Here, A is the amplification factor of matching lens; w is the
required correlation at the object plane; w0 is the correlation
when the proton is at the entrance of the matching section;
31
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-599-9
ADVCOMP 2017 : The Eleventh International Conference on Advanced Engineering Computing and Applications in Sciences

ϕdiffusr
represents all deviations from the correlation line due
to both MCS in the diffuser and non-zero emittance in the
illuminating beam; M is the x plane transfer matrix of the
matching lens. The value of w0 is not only involved in the
matching lens, but it also closely relates to the diffuser.
Compared to the distance from matching lens to the
diffuser, the beam size is small. The proton beam is
approximated as a point source. Therefore, w0 equals to the
reciprocal of the draft from the diffuser to the matching lens
D1. Then, w0 is expected to have a positive correlation with
the diffuser thickness:
diffusr
1
0
1
T
D
w
∝
=
                        (2) 
To decrease the chromatic aberration caused by the
diffuser, a thin diffuser should be used. However, it results in
a large distance between the matching lens and the diffuser.
Therefore, apart from the correlation and amplification, a
reasonable value of w0 should be carefully selected in the
optimization of the matching lens.
If the
ϕdiffusr
is close to zero, then (1) can be expressed as



= −
+
= −
+
wA
w M
M
A
w M
M
22
0
21
12
0
11
                  (3) 
The equation for y plane is similar to (3). If w is positive
in the x plane, it is equal in magnitude and negative in the y
plane.
Equation
(3)
acts
as
the
constraints
in
the
optimization.
The design of the diffuser and matching lens is expected
to be a multi-objective optimization. The traditional method
is based on thin-lens approximation. It takes the size of field
of view (FOV) as a posterior limitation on the parameters.
However, this may not provide the best solution. The
constraints should be taken as object functions to guarantee a
reasonable result. The GA is recognized as the best globally
well-adapted optimization algorithm and this is why we
decided to use it in our approach.
III.
OPTIMIZATION FOR PROTON RADIOGRAPHY
The basic structure of both the diffuser and the matching
lens can be found in Figure 1 (trajectories are simulated by
Geant4 code [8]). The matching lens consists of three
quadrupoles combined with four drifts. The proton beam
starts from the right side and it is scattered by a diffuser.
Then, the beam with angular divergence drifts (with length
of D1) to the matching lens with position X0 and direction
vector w0*X0 in x-axis. When the proton transport to the end
of matching lens has position A*X0 and direction vector
A*w0*X0 in x-axis, then the beam will cover the object.
The goal of the optimization is to obtain a higher
amplification factor of the matching lens. The parameters to
optimize are drifts: D1, D2, D3, D4, the magnetic lens
thicknesses: T1, T2, T3 , magnetic lens strength G1, G2, G3 and
diffuser
thickness. The
constraints are related
to
the
limitations of overall length, maximum magnetic lens
intensities, cross-sectional size of magnetic lens and the size
of object. Because w0 can be calculated by drift length D1,
the domain of w0 is set to be from 0.1 to 0.13 to ensure an
available drift length. The GA is employed to obtain a
matching lens with larger amplification.
Figure 1.
Simulated proton trajectories in matching lens.
All the constraints can be written as:
4
3
1
1
pos
quadrupoles
drift_tube
FOV
object
27
10,
1,2,3,4
min(
,
)
i
i
i
j
i
D
T
G
i
X
R
R
R
R
=
=

+
≤


≤
=


<


>

∑
∑
                  (4) 
in which the Rquadrupoles and Rdrift_tube are the inner radius of
quadrupoles and drift tubes, Xpos is the proton position value
on the designed trajectories. This constraint means the
proton should not bombard the magnet. The RFOV is a
function of A and diffuser thickness.
The matching lens should provide the proton beam with
the necessary correlation for Zumrbo lens, which means the
vaule of w in (3) is fixed. With constraints shown in (3) and
(4), the object is to minimize the difference between the
obtained w and the desired Zumbro lens. All the constraints
could be written as a penalty term which is part of the object
fuction. The contribution of each constraint can not be
expressed by a formula. Therefore the optimizer may use
intelligent optimization algorithms.
For the proton beam of 20 GeV , we use GA and found
the best results are obtained when: the drifts D1=7.95m,
D2=0.70m,
D3=1.90m,
D4=2.00m;
the
magnet
length
T1=5.72m,
T2=
6.17m,
T3=2.65m;
the
field
gradient
G1=1.00T·m-1,
G2=9.93
T·m-1,
G3=8.79T·m-1;
diffuser
thickness Tdiffuser= 1.50mm.
Two issues should be noted for the parameters. (2) is
obtained by using the assumption which the initial beam
comes from a point source. Therefore, 1/w0 is just an initial
value of D1. Geant4 is employed to obtain the exact value of
D1 by repetition simulations. The secondary issue is relevant
to the thickness of the diffuser.
32
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-599-9
ADVCOMP 2017 : The Eleventh International Conference on Advanced Engineering Computing and Applications in Sciences

If the parameters of the required proton beam are
obtained, the diffuser thickness can be calculated. To use the
proton beam efficiently, the proton intensity at the center of
illuminating beam should be higher than that at the edge of
FOV. The root mean square (RMS) angular deviation θ0
induced by the expected diffuser can be calculated by:
[ ( ) ( )
0 ]
ln
2
2
2
0
2
0
diffusr
I
I θ
θ
ϕ
θ
ϕ
−
=
+
=
             (4) 
where
0
ϕ is the angular deviation of the beam generated by
the accelerator. θ0 is the MCS angle given approximately by
X
T
pc
diffusr
0
1. MeV
14
β
θ
≈
                        (5) 
Here, p is the beam momentum,
β = v/c
where v is the beam
velocity and c is the speed of light, and X is the radiation
length for the material of the diffuser.
Combining (4) with (5), the thickness of tantalum
diffuser can be obtained.
Figure 2.
The angle-positon correlations at object plane.
Figure 3.
The planar distribution and cross-sectional distribution profile at
the object plane.
The designed diffuser, matching lens and Zumbro lens
were assembled as a whole system and simulated by Geant4.
The obtained angle-position correlations for both x and y
planes at the object plane are given in Figure 2. The
simulated
correlations
coincide
with
the
design.
The
simulation also shows that over 95% of protons can pass
through this whole system, and finally reach the detector.
Figure 3 shows the beam distribution at the object
plane. The result shows that the proton flux at the edge of
FOV is about 20% of the maximum value. The beam
distribution is also consistent with our design. Both the
diffuser and the matching lens work as expected.
IV.
CONCLUSIONS
The diffuser and matching lens are key components in
high-energy proton radiography. In order to minimize
chromatic aberration, the optimal design of the diffuser and
matching lens should provide the proton beam with the
necessary correlation for Zumrbo lens imaging system. The
domains of parameters, magnification, target size and the
thickness of diffuser are all considered by the genetic
algorithm. The parameters of diffuser and matching lens are
obtained for the proton beam of 20 GeV. The beam
distribution is consistent with our design by use of the Monte
Carlo code Geant4. Thus, the study is beneficial for the
design
of
the
magnetic
lens
in
high-energy
proton
radiography.
REFERENCES
[1]
C. L. Morris, J. W. Hopson, and P. Goldstone, “Proton
Radiography,” Los Alamos National Laboratory, LA-UR-06-
0331, 2006.
[2]
C. T. Mottershead and J. D. Zumbro, “Magnetic Optics for
Proton Radiography,” Proc. Particle Accelerator Conference.
Vancouver B C, 1997, pp. 1397-1402.
[3]
A. J. Jason, “Magnetic Imaging Lenses for the Advanced
Hydrodynamic Facility,” Los Alamos National Laboratory,
LA-UR-00-5447, 2000.
[4]
Y. M. Antipov, et al., “A Radiographic Facility for the 70
GeV Proton Accelerator of the Institute of High Energy
Physics,” Instrum. Exp. Tech., vol. 53, 2010, pp. 319-326.
[5]
F. E. Merrill, et al., “Magnifying Lens for 800 MeV Proton
Radiography,” Review of scientific Instruments, vol. 82,
2011, pp. 103709.
[6]
H. Y. Barminova and V. I. Turtikov, “Proton Microscope
Design for 9 GeV pRad Facility,” Journal of Instrumentation,
vol. 11, 2016, pp. 05021.
[7]
M.
Zbigniew,
“Genetic
Algorithms+Data
Structures=
Evolution Programs,” Springer, Berlin, 1999.
[8]
S. Agostinelliae, et al., “Geant4 –a Simulation Toolkit,” Nucl.
Instrum. Methods Phys. Res. A, vol. 506, 2003, pp. 250-303.
33
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-599-9
ADVCOMP 2017 : The Eleventh International Conference on Advanced Engineering Computing and Applications in Sciences

