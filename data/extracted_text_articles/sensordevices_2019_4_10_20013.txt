Advanced Mathematical Calibration Procedure for Sensor Systems Measuring 
Multi Component Gas Mixtures 
 
Rolf Seifert  
HybridSensorNet e.V. (HSN) 
D-76131 Karlsruhe, Germany 
e-mail: rolf.seifert@partner.kit.edu 
 
Hubert B. Keller 
Institute of Automation and Applied Informatics (IAI) 
Karlsruhe Institute of Technology 
D-76344 Eggenstein-Leopoldshafen, Germany 
e-mail: hubert.keller@kit.edu
 
 
Abstract—Although sensor chips for multi gas sensors are 
usually batch wise fabricated, each sensor chip has to be 
individually calibrated to yield a high analytic performance. 
For multi gas applications, a sensor chip normally has to be 
measured for calibration at least at 3 calibration points for 
every component. An advanced mathematical procedure for 
batch wise calibration called ProCal2.0 is introduced to reduce 
the calibration effort nearly by a factor of three even for multi 
gas-analysis. By application of the procedure to sensitivity data 
sampled at binary Ethanol/H2 gas mixtures, it is demonstrated 
that, with this efficient calibration procedure, the analysis 
results are very close to those which are obtained when each 
sensor chip is individually calibrated. 
Keywords  - multi gas sensors; batch wise calibration; multi 
gas applications; multi gas analysis; analysis error. 
I. 
 INTRODUCTION 
Economic online and in-situ field analyses applications 
like discriminated alarming of smouldering fire or toxic gas 
leakages, monitoring of volatile components in chemical and 
biochemical 
processes, 
quality 
monitoring 
in 
food 
processing, etc., rely on reliable and economic analytical 
solutions by sensor systems.  
In this context, the isothermally operated Metal Oxide 
Gas sensors (MOGs) with tin oxide as base material have 
been introduced due to their high sensitivity, long term 
stability and low price. Their sensitivity to specific gas 
components, however, cannot be cultivated with high 
discrimination to others. Therefore, other approaches are 
necessary like a gas sensor array of MOGs [1][2] or a 
thermo-cyclic operation of the MOG and simultaneous 
sampling of the conductance which finally leads to the 
mathematical analysis of the so called Conductance-over-
Time-Profiles (CTPs) [3]. These CTPs show characteristic 
profile shapes reflecting gas composition and gas component 
concentrations depending on the choice of additives. It can 
be shown that, using this approach, valuable signal 
information can be extracted to be numerically analyzed for 
substance identification and concentration determination 
even in the case of varying environmental conditions (e.g. 
humidity) [4].  
The effort for calibration of the sensor elements is very 
time consuming and costly. Sensor elements are usually 
batch 
wise 
fabricated. 
But, 
unavoidable 
production 
inaccuracies 
of 
the 
sensor 
elements 
lead 
to 
unreproducibilities of the gas analytic attributes. Therefore, 
although the signal patterns of the various sensor elements of 
a production batch are quite similar, each sensor element has 
to be calibrated, in order to yield high analytic performance, 
and this can be very costly. The number of components to be 
simultaneously analyzed determines the dimension of the 
calibration field and, for good analysis results, as was 
experimentally shown, about three to five or even more 
calibration points for every dimension are necessary 
depending on the accuracy demands of the analysis. 
In this report, an advanced mathematical calibration 
procedure called ProCal2.0 is introduced which is able to 
drastically reduce the calibration effort of batch wise 
fabricated sensor chips measuring multi component gas 
mixtures.  
In Section 2, the considered application field is briefly 
described. A short outline of the advanced calibration 
procedure ProCal2.0 is given in Section 3. Different 
calibration models to compare the performance of the 
procedure are introduced in Section 4. In Section 5, the 
analysis results are presented. Section 6 summarizes the 
results of this report. 
II. 
APPLICATION: BINARY ETHANOL/H2 GAS MIXTURES 
The application, on which the outline of ProCal2.0 is 
described and the analysis results are presented, is measuring 
binary Ethanol/H2 gas mixtures. The measurements are 
performed using the sensor system, which is described in 
detail in [5]. The sensor system is armed with batch wise 
fabricated sensor chips and runs in the above mentioned 
thermo-cyclic mode. 
III. 
OUTLINE OF PROCAL2.0 
As mentioned above, even if the sensor chips are 
fabricated in a batch wise manner, each sensor chip has to be 
individually calibrated to gain reasonable analysis results. To 
calibrate a sensor chip, calibration measurements have to be 
performed, which are very time consuming and, therefore, 
costly. In the case of binary Ethanol/H2 gas mixtures, the gas 
mixture has to be measured at least at three concentration 
levels 
of 
each 
component 
and 
all 
concentration 
combinations. That leads to at least 9 calibration 
measurements to determine a reasonable mathematical 
calibration model.  
Table I shows the considered calibration field. 
 
49
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-745-0
SENSORDEVICES 2019 : The Tenth International Conference on Sensor Device Technologies and Applications

TABLE I. CALIBRATION FIELD OF 9 CONCENTRATION POINTS 
(CP) AND RELATED APPROXIMATION FUNCTIONS 
Ethanol H2 in ppm 
Ethanol H2 in ppm 
Ethanol H2 in ppm 
50-10          CP1 
50-20        CP4 
50-30         CP7 
100-10        CP2 
100-20      CP5 
100-30       CP8 
175-10        CP3 
175-20      CP6 
175-30       CP9 
Function f(i,10) 
Function f(i,20) 
Function f(i,30) 
 
ProCal2.0 is an extension of the procedure ProCal [6], 
which was only designed for calibrating single gases. 
ProCal2.0 is developed to drastically reduce the 
calibration effort for multi component gas mixtures.  
Therefore, one sensor chip of the batch wise fabricated 
sensor chips is chosen as the so-called reference chip. Using 
this reference chip, the binary Ethanol/H2 gas mixture is 
measured at all 9 calibration points.  
With all the other sensor chips of the batch, the binary 
Ethanol/H2 gas mixture is measured only at the calibration 
points CP2, CP5 and CP8, the so-called reference calibration 
points, which are written in red in the calibration field in 
Table I.  
Next, approximation functions are determined which 
map the signal patterns, in our case the CTPs, of the 
reference chip in a best manner to the signal patterns of the 
other, non-reference, sensor chips at the reference calibration 
points. That means, we get 3 approximation functions for 
each non-reference chip. 
For example, function f(i,10) in Table I is the best 
approximation function for mapping the signal pattern of 
CP2 of  the reference chip to the corresponding signal pattern 
of sensor chip i. The signal pattern of sensor chip i at CP1 is 
calculated by mapping the signal pattern of the reference 
chip at this calibration point, using this approximation 
function f(i.10). 
This procedure is performed in a similar way for all non-
reference sensor chips and for all calibration points. 
 
Figure 1.  Comparison of real measured CTP and calculated CTP. 
Therefore, we get all the needed signal patterns to 
determine the related mathematical calibration models. 
However, only 3 instead of 9 calibration measurements are 
needed for all non-reference chips. This reduces the 
calibration effort by factor of 3.   
It can be shown that ProCal2.0 is also able to determine 
the best choice of the reference chip and also to detect 
outliers. That means, ProCal2.0 can identify chips of the 
production batch which cannot be reasonably calibrated 
using this procedure. 
IV. 
MATHEMATICAL CALIBRATION MODELS 
To demonstrate the performance of the above described 
procedure ProCal2.0, three mathematical calibration models 
are established. The ”individual model of each chip” means 
that each sensor chip of the batch is individually calibrated. 
This is a very costly and time consuming calibration process 
and leads to the best possible analyses results. Using the 
”class reference model”, only one sensor element of a batch 
(here, the reference chip) is completely calibrated and the 
calibration model of this sensor chip is assigned to each one 
of the other chip of the batch. This leads to very poor 
analysis results will be shown later in the paper. The third 
calibration model is the above mentioned “batch wise 
calibration model” using procedure ProCal2.0 with reduction 
of the complete calibration effort by a factor of 3.  
The data analysis is performed with the calibration and 
evaluation program ProSens [7]. 
V. 
ANALYSIS RESULTS 
In this section, we consider 4 sensor chips of a batch, 
called S1, S2, S3 and S4. Sensor chip S4 was chosen as 
reference chip.  
Binary Ethanol/H2 gas mixtures at the concentration 
points given in Table II are measured using the 4 chips and 
the concentration determination is performed using the 3 
calibration models mentioned above. 
TABLE II. CONTRATION POINTS FOR DATA ANALYSIS 
Ethanol-H2 in ppm 
Ethanol-H2 in ppm 
Ethanol-H2 in ppm 
50-10 
50-20 
50-30 
100-10 
100-20 
100-30 
135-10 
135-20 
135-30 
175-10 
175-20 
175-30 
The red marked line is additionally measured for data 
analysis. 
 
A. 
Analysis Results of Sensor Chip S1 
The following tables show the analysis results of sensor 
chip S1 using the 3 calibration models. Table III shows the 
analysis results using the individual calibration model, Table 
IV the results using the class reference model and Table V 
using the batch wise calibration model. The bold values are 
the dosed values and the values in the table are the calculated 
values (all values in ppm).  
50
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-745-0
SENSORDEVICES 2019 : The Tenth International Conference on Sensor Device Technologies and Applications

TABLE III. ANALYSIS RESULTS USING THE INDIVIDUAL MODEL 
Ethanol/H2 
10 
20 
30 
50 
50.3-10.1 
47.9-20.1 
54.6-27.6 
100 
95.1-11.1 
111.3-18.9 
92.7-32.8 
135 
127.0-11.1 
139.9-20.2 
134.5-31.2 
175 
175.1-9.7 
168.5-21.0 
179.4-28.7 
TABLE IV. ANALYSIS RESULTS USING THE CLASS REFERENCE MODEL 
Ethanol/H2 
10 
20 
30 
50 
60.2-4.5 
59.3-18.3 
69.7-26.1 
100 
106.4-9.9 
121.7-18.5 
114.0-30.7 
135 
141.3-10.4 
149.6-20.1 
156.4-28.7 
175 
156.4-28.7 
177.6-20.7 
202.2-25.6 
TABLE V. ANALYSIS RESULTS USING THE BATCH WISE CALIBRATION 
MODEL 
Ethanol/H2 
10 
20 
30 
50 
46.2-11.7 
48.0-19.6 
54.8-26.5 
100 
89.2-11.3 
110.5-18.6 
84.3-32.3 
135 
119.6-11.2 
138.9-20.4 
120.0-31.7 
175 
163.8-10.0 
165.7-21.7 
157.3-30.4 
 
Tables VI to VIII show the relative analysis errors. 
TABLE VI. RELATIVE ANALYSIS ERRORS IN % USING THE INDIVIDUAL 
MODEL 
Ethanol/H2 
10 
20 
30 
50 
0.6-0.8 
4.1-0.7 
9.3-7.9 
100 
4.9-11.1 
11.3-5.7 
7.3-9.3 
135 
5.9-10.9 
3.6-1.1 
0.4-3.8 
175 
0.1-2.5 
3.7-5.0 
2.5-4.5 
TABLE VII. RELATIVE ANALYSIS ERRORS IN % USING THE CLASS 
REFERENCE MODEL 
Ethanol/H2 
10 
20 
30 
50 
20.3-55.1 
18.7-8.5 
39.4-12.9 
100 
6.4-0.9 
21.7-7.6 
14.0-2.2 
135 
4.6-4.4 
10.8-0.3 
15.9-4.4 
175 
11.5-6.3 
1.5-3.7 
15.5-14.8 
TABLE VIII. RELATIVE ANALYSIS ERRORS IN % USING THE BATCH WISE 
CALIBRATION MODEL 
Ethanol/H2 
10 
20 
30 
50 
7.6-17.5 
4.0-2.1 
9.6-11.5 
100 
10.8-12.6 
10.5-6.9 
15.7-7.6 
135 
11.4-11.9 
2.9-1.8 
11.1-5.5 
175 
6.4-0.1 
5.3-8.5 
10.1-1.3 
 
The red marked numbers indicate the largest relative 
analysis errors in the related tables.  
It can be clearly seen that, as expected, the best the 
analysis results are obtained using the individual calibration 
model. The analysis results using the batch wise calibration 
are very close to these best results but the calibration effort is 
reduced by the factor of 3. Using the class reference model, 
the analysis results are very poor. 
B. 
Analysis Results of the Other Sensor Chips 
The analysis results of the other sensor chips based on 
the 3 calibration models are very similar to those of sensor 
chip S1. 
The following Tables IX to XI show the maximum 
analysis errors of the components Ethanol and H2 using the 
sensors S1, S2 and S3 and the related calibration models. 
TABLE IX. MAXIMAL ANALYSIS ERRORS IN % FOR SENSOR S1 
Maximal Analysis Errors in % 
Ethanol 
H2 
Individual Model 
11.3 
11.1 
Batch wise Calibration Model 
15.7 
17.5 
Class Reference Model 
39.4 
55.1 
TABLE X. MAXIMAL ANALYSIS ERRORS IN % FOR SENSOR S2 
Maximal Analysis Errors in % 
Ethanol 
H2 
Individual Model 
14.8 
13.1 
Batch wise Calibration Model 
19.3 
13.3 
Class Reference Model 
44.5 
17.4 
TABLE XI. MAXIMAL ANALYSIS ERRORS IN % FOR SENSOR S3 
Maximal Analysis Errors in % 
Ethanol 
H2 
Individual Model 
14.2 
12.4 
Batch wise Calibration Model 
14.2 
13.9 
Class Reference Model 
34.5 
17.1 
 
It can be clearly seen that in all considered cases the 
analysis results obtained by the batch wise calibration model 
are very close to the best possible analysis results. 
VI. 
CONCLUSION 
Using the calibration procedure ProCal2.0, the very time 
consuming and expansive calibration of batch wise 
fabricated sensor elements can be reduced almost by the 
factor of 3. ProCal2.0 is able to determine the class reference 
chip, which best represents the chips of the batch and can 
exclude outliers, i.e, chips which cannot be calibrated with 
this procedure. It was shown that the calculated signal 
patterns are close to the sampled signal patterns and the 
analysis errors using this calibration model are very close to 
the best possible ones using the very time-consuming 
individual model, but dramatically better than those using the 
class reference model.  
The same procedure can also be applied for cost effective 
and time saving recalibration. 
 
51
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-745-0
SENSORDEVICES 2019 : The Tenth International Conference on Sensor Device Technologies and Applications

REFERENCES 
 
[1] P. Althainz, J. Goschnick, S. Ehrmann, and H. J. Ache, 
“Multisensor Microsystem for Contaminants in Air“, Sensors 
and Actuators B: Chemical, 33, 1-3, 1996, pp. 72-76. 
[2] V. V. Sysoev, I. Kiselev, M. Frietsch, and J. Goschnick, 
“Discrimination Power of a Metal-Oxide Thin-Film Sensor 
Microarray“, Sensors, 4, 2004, pp. 37-46. 
[3] A. Jerger, H. Kohler, F. Becker, H. B. Keller, and R. Seifert, 
“New applications of tin oxide gas sensors II. Intelligent 
sensor system for reliable monitoring of ammonia leakages“, 
Sensors and Actuators B: Chemical, 81, 2-3, 2002, pp. 301-
307. 
[4] K. Frank et al., “Chemical Analysis with Tin Oxide Gas 
Sensors:Choice of Additives, Method of Operation and 
Analysis of Numerical SignalSensors“, Letters 6, pp. 908-911 
2008. 
[5] R. Seifert, H. B. Keller, T. Conrad, and J. Peter, “Alcohol 
Control: Mobile Sensor System and Numerical Signal 
Analysis“, Sensors and Transducers, (ISSN: 2306-8515, e-
ISSN 1726-5479), Vol. 205, Issue 10, October 2016, pp.10-15 
[6] R. Seifert, H. B. Keller, K. Frank, and H. Kohler, “ProSens—
An Efficient Mathematical Procedure forCalibration and 
Evaluation of Tin Oxide Gas Sensor Data“, Sensor Letters, 
Vol. 9/2, pp. 621-624, 2011 
[7] R. Seifert, H. B. Keller, K. Frank, and H. Kohler, “Batch-
Wise 
Mathematical 
Calibration 
of 
Thermo-Cyclically 
Operated Tin Oxide Gas Sensors“, Sensor Letters  9, pp. 621-
624, 2011. 
 
 
52
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-745-0
SENSORDEVICES 2019 : The Tenth International Conference on Sensor Device Technologies and Applications

