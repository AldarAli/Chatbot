Hybrid QoS Based Routing for IEEE 802.16j Mesh Infrastructure 
Hajer Bargaoui, Nader Mbarek, Olivier Togni 
LE2I Laboratory, University of Burgundy 
Dijon, France 
e-mails : {Hajer.Bargaoui, Nader.Mbarek, 
Olivier.Togni}@u-bourgogne.fr 
Mounir Frikha 
MEDIATRON Laboratory, High School of Communication 
of Tunis (SUP’COM) 
Tunis, Tunisia 
e-mail : m.frikha@supcom.rnu.tn
 
 
Abstract—With the growth of wireless networks, 
Wireless Mesh Network (WMN) has appeared as an emerging 
key solution for broadband Internet access with a low-cost 
deployment. Moreover, providing QoS guarantees for real-time 
and streaming applications such as VoIP (Voice over IP) and 
VoD (Video on Demand) is a challenging issue in such 
environment. In this paper, we propose a hybrid wireless mesh 
architecture to provide mesh clients with Internet access while 
guaranteeing QoS. It is formed by an IEEE 802.16j based 
infrastructure and several  IEEE 802.11s based client domains. 
A clustering algorithm is developed to enhance scalability issues 
within the mesh infrastructure and a novel protocol called 
Hybrid QoS Mesh Routing (HQMR) is specified in order to 
provide QoS requirements. The HQMR protocol is deployed 
within the IEEE 802.16j infrastructure and it is composed of two 
routing sub-protocols: a reactive routing protocol for intra-
infrastructure communications and a proactive QoS-based 
multi-tree routing protocol for communications with external 
networks. The proposed architecture provides real-time and 
streaming 
applications 
with 
QoS 
guarantee 
in 
mesh 
environment thanks to a clustering algorithm and a QoS-based 
routing protocol. 
Keywords—Wireless Mesh Network; QoS routing; IEEE 
802.16j; HQMR.  
I. 
 INTRODUCTION 
Recently, wireless mesh networks have received increased 
attention from researchers and industrial environments. They 
have emerged as a key wireless technology for numerous 
applications such as broadband home networking, community 
and neighborhood networks, enterprise networking, etc., 
[1][2]. Besides, they are a promising solution to provide last-
mile connectivity to the Internet for fixed and/or mobile users 
in zones where wired networks deployment is difficult, thanks 
to its various qualities such as self-organizing and self-
configuring abilities.  
One major challenge for wireless mesh networks is to 
provide QoS support. Since deployments of WMNs continue 
to grow, providing Quality of Service for real-time and 
streaming applications, such as VoIP and VoD, is an 
important task. Moreover, establishing paths with the highest 
performance is a challenging issue for routing protocols on 
wireless mesh networks in order to satisfy applications’ 
requirements.  
However, the different research works proposing routing 
solutions on wireless mesh networks rely simply on adapting 
protocols originally designed for mobile ad hoc networks and 
adding a little support for QoS. In this paper, we propose a 
hybrid QoS based routing protocol, called Hybrid QoS Mesh 
Routing (HQMR) that exploits more efficiently the particular 
topology of a wireless mesh network, based on a hybrid 
wireless mesh architecture. The proposed wireless mesh 
architecture is formed by an IEEE 802.16j based infrastructure 
and different IEEE 802.11s based client domains. 
Furthermore, in order to solve scalability issues and reduce 
efficiently the network’s load, a clustering algorithm is 
proposed for the IEEE 802.16j infrastructure of our global 
wireless mesh architecture. HQMR is then deployed on the 
IEEE 802.16j infrastructure to ensure routing functionalities. 
It is a hybrid protocol adopting a reactive routing sub-protocol 
for intra-infrastructure communications and a proactive 
multipath 
tree-based 
routing 
sub-protocol 
for 
inter-
infrastructure communications, where the mesh gateway is 
considered as a root. 
The remainder of this paper is organized as follows. In 
Section II, we present some related works. Section III 
introduces the architecture of our framework. Then, we define 
in Section IV, the proposed HQMR routing protocol. Section 
V defines two usage scenarios of HQMR to illustrate its 
processing. Finally, Section VI concludes the paper. 
II. 
RELATED WORK 
A. IEEE 802.16j Standard 
IEEE 802.16j task group was officially established in 
March 2006 and their work was published in 2009. The IEEE 
802.16j standard [3], is an amendment to the IEEE 802.16e 
[4] standard in order to introduce Mobile Multi-hop Relay 
(MMR) specifications where traffic between a Multi-Relay 
Base Station (MR-BS) and a Subscriber Station (SS) can be 
relayed through nodes named Relay Stations (RS). The 
number of hops between MR-BS and SS is not defined but it 
must only contain RS nodes. In fact, IEEE 802.16j has defined 
two different relay modes: transparent mode and non-
transparent mode. In transparent mode, the RS is used to 
improve the network capacity. It does not forward any 
signaling frame. It relays only data traffic. The non-
transparent mode is usually used to extend the network 
coverage. The RS nodes in this mode are able to generate their 
own signaling frame or forward those provided by the MR-BS 
depending on the scheduling mechanism. 
B. QoS Routing 
QoS provisioning is an important issue for wireless mesh 
networks since they are typically used for providing 
broadband wireless Internet access to a large number of users 
110
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

and networks. To meet applications’ QoS requirements, 
different QoS routing protocols were proposed for wireless 
mesh networks. 
Wireless Mesh Routing (WMR) [5] is a QoS solution for 
wireless mesh LAN networks. It provides QoS guarantees in 
terms of minimum bandwidth and maximum end-to-end 
delay. These two parameters are verified jointly with the route 
discovery process. The value of the node’s available 
bandwidth, is estimated thanks to the bandwidth already in use 
by the considered node and by its neighboring nodes. Then, 
the end-to-end delay is estimated by using the round trip delay 
method [6]. Kon et al. [7] improve the WMR protocol by 
proposing a novel end-to-end packet delay estimation 
mechanism with a stability-aware routing policy. The delay 
estimation is based on packets named DUMMY-RREP, which 
have the same size, priority and data rate as real data traffic. 
Some other works include the QoS verification in the route 
discovery phase. For example, QoS AODV (QAODV) [8] 
integrates a new metric for IEEE 802.11 mesh networks, 
composed of bandwidth, delay, hop count and load ratio. In 
the same way, Rate-Aware AODV (R-AODV) [9] uses 
minimum network layer transmission time as a performance 
metric in multi-rate WiFi mesh networks. Mesh Admission 
control and qos Routing with Interference Awareness 
(MARIA) [10] is another QoS aware routing protocol for 
wireless mesh networks. It is a reactive protocol incorporating 
an interference model in the route discovery process. This 
protocol uses a conflict graph model to characterize both inter 
and intra-flow interference. 
Thus, there are few research works for QoS based routing 
for IEEE 802.16j wireless networks. Hence, through our 
proposed protocol HQMR, we intend to provide QoS 
provisioning routing functionalities within an IEEE 802.16j 
architecture. 
C. Clustering 
Clustering concept was introduced to organize large 
wireless multi-hop networks into groups named clusters. 
Every cluster is coordinated by a cluster-head to achieve basic 
network performances, even with mobility and limited energy 
resources. The different clustering algorithms differ mainly in 
the method used for the election of the cluster-heads: Lowest-
ID heuristic [11], Highest-degree heuristic [12] and node-
Weight heuristic [13]. 
Combining clustering algorithms with routing protocols 
offers better performances within the network layer, by 
reducing the amount of control messages propagated inside 
the network since the exchange is limited within a cluster; and 
by minimizing the size of routing tables at each node since it 
stores only the information of its cluster. 
Zone Routing Protocol (ZRP) [14] is a cluster-based 
routing protocol for ad hoc networks that uses different 
routing 
sub-protocols 
for 
inter 
and 
intra-clusters 
communications. Within a cluster zone, a proactive 
component is used to maintain up-to-date routing tables. 
Routes outside the routing zone are explored with a reactive 
component combined with a border-casting concept. Singh et 
al. [15] propose a hierarchical cluster based routing protocol 
for wireless mesh networks in which the mesh gateway is the 
highest level node. Similarly, the research work in [16] 
defines a multi-level clustering approach with a reactive 
routing protocol for wireless mesh networks, in order to 
reduce the load on the mesh gateway.  
For its benefits, we adopt this concept of cluster based 
routing for our HQMR protocol to solve scalability issues and 
to offer better routing performances within the IEEE 802.16j 
infrastructure. 
III. 
PROPOSED GLOBAL HYBRID WIRELESS MESH 
ARCHITECTURE 
For our framework, we adopt a hybrid wireless mesh 
network architecture, combining two different technologies. It 
is formed by a non-transparent IEEE 802.16j-based 
infrastructure and IEEE 802.11s-based client domains (Fig. 
1). A hybrid QoS based routing protocol (HQMR) is also 
proposed 
within 
the 
802.16j-based 
wireless 
mesh 
infrastructure. 
 
Figure 1.  Global hybrid wireless mesh architecture 
A. IEEE 802.16j-based mesh infrastructure domain 
For the wireless mesh infrastructure, we use the non-
transparent relay mode of the IEEE 802.16j technology to 
ensure a better coverage. Then, in order to organize the 
functionalities of each node, we define three types of nodes 
within the mesh infrastructure: the Mesh Gateway (MG), the 
Relay Nodes (RN) and the Access Nodes (AN). The MG is 
the intermediate node between the Internet cloud and the 
wireless mesh infrastructure. It helps forwarding clients 
requests to the Internet network. The RNs are the nodes 
located in the core of the mesh infrastructure to ensure 
forwarding traffic flows from a node to another inside it. Last, 
we consider the nodes located in the border of the 
infrastructure, as Access Nodes (AN). They provide 
interconnection between the mesh infrastructure and the client 
domains. Thus, compared to the topology of an IEEE 802.16j 
network, our MG and RN nodes have, respectively, the same 
functionalities as the MR-BS node and the RS nodes. In fact, 
the AN nodes may be considered as bridge nodes playing both 
the role of a relay node in the IEEE 802.16j infrastructure and 
the role of a gateway in the IEEE 802.11s area. Thus, they are 
111
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

equipped with two radio interfaces: one is operating with the 
Wimax technology [4] and another with WiFi technology 
[17]. 
At each relay node of the wireless mesh infrastructure 
(including the ANs and the MG), the proposed routing 
protocol (HQMR) must be implemented with our clustering 
algorithm to reduce mainly the size of the routing tables. The 
different blocks of HQMR will be described in Section IV. 
B. IEEE 802.11s based mesh client domain 
The client domains are formed by a set of 802.11s [18] MP 
(Mesh Point) which are interconnected to each other forming 
the mesh topology and by a gateway node that we called 
Mesh-Gateway Access Node (MG-AN). The MG-ANs have 
the functionality of the 802.11s MPP (Mesh Portal Point) 
implemented in the access node (AN) of our mesh 
infrastructure. This way, to connect to the Internet cloud, the 
mesh clients forward, first, their traffic to their own gateway 
(i.e., MG-AN), for accessing the mesh infrastructure. Then, 
the MG-AN forwards directly the received traffic from its 
mesh clients to its own gateway (i.e., MG). 
IV. 
HYBRID QOS MESH ROUTING 
HQMR, the proposed protocol, is used to ensure routing 
functionalities within the IEEE 802.16j infrastructure of our 
global wireless mesh architecture. It is a hybrid QoS-based 
routing protocol composed of two different routing blocks. 
The first routing sub-protocol Intra-Mesh infrastructure 
Reactive 
Routing 
(IMRR) 
is 
designed 
to 
forward 
communications within the infrastructure in a reactive 
manner, while the second routing block Inter-Mesh 
infrastructure Proactive Routing (IMPR) is deployed to 
forward 
communications 
to 
the 
external 
networks, 
particularly to the Internet network. The second routing sub-
protocol is a tree-based multipath routing protocol, with the 
Mesh Gateway as a root of the routing tree.  
Moreover, in order to improve the performance of our 
routing protocol, we adopt the concept of clustering to divide 
the topology of the infrastructure into a set of groups.  
In this section, we present the algorithm adopted for the 
clusters elaboration within the wireless mesh infrastructure 
and we introduce the two routing sub-protocols of HQMR. 
Before that, we define the mechanism used to provide the 
needed information about each node’s neighbors and we 
specify the different QoS parameters and their estimation 
method to guaranty the QoS based routing characteristic of 
our proposed HQMR protocol. 
A. Neighborhood Maintenance 
Neighborhood information is very important for our 
protocol in order to provide the local topology (node’s 
different neighbors), the necessary information for our 
clustering algorithm and the available QoS toward each 
neighbor. To maintain this information, every node in the 
network is required to send out periodically a Hello message 
(Table I), announcing its existence and its cluster information 
such as its state in the cluster, its calculated weight parameter 
used for cluster-head election, its CH’s IP address (ID-CH) 
and its used bandwidth parameter. By receiving the Hello 
message from the different neighbors, each node updates its 
Neighbor Table (Table II), which is used to store for each 
neighbor its IP address (ID), all the needed information for 
clusters formation (Weight, State, ID-CH) and the available 
QoS parameters. 
TABLE I.  
HELLO MESSAGE 
ID 
Weight 
State 
ID-CH 
Used Bandwidth 
TABLE II.  
NEIGHBOR TABLE  (NT) 
ID 
Weight 
State 
ID-CH 
QoS Metric 
B. QoS Routing Metrics 
The purpose of our routing protocol is to find paths, which 
can satisfy the QoS requirements of real-time flows. The set 
of QoS requirements includes the bandwidth, the delay and 
the jitter parameters. 
1) Available Bandwidth metric 
 
To estimate the available bandwidth, each node 
considers the used bandwidth by its flows and the 
consumption of its neighbors announced in the Hello 
messages (1). 
 


N(v)
v'  
used
 (v')
B
B(v)   B - 

where B(v) is the estimated available bandwidth by a node v, 
B is the total Bandwidth, Bused is the bandwidth used by a node 
and N(v) in the neighborhood of the node v. 
Then, the bandwidth parameter of the entire path is 
determined as the minimum bandwidth estimated at each node 
toward the destination. 
2) Delay Metric 
This metric estimation is based on measuring the round 
trip delay time (RTT) [6] of the Hello messages, which 
represents the time between initiating a Hello message and 
receiving a response. The delay metric of a path is the sum of 
its links delay metric. 
3) Jitter Metric 
The jitter metric defines the delay metric variation. It is 
estimated by calculating the mean of the differences between 
the RTT values for a specific period. Besides, the Jitter of a 
path is calculated by summing the Jitter of each link. 
C. Clusters formation algorithm 
Our clustering algorithm is a variant of the LID-based 
clustering algorithm [11] combined with the use of the weight 
concept developed on the Weighted Clustering Algorithm 
(WCA) [13] for the election of cluster-heads. Thus, a cluster 
is formed by the node with the lowest weight and all its 
neighbors. The same procedure is repeated among the 
remaining nodes, until each node is assigned to a cluster. 
Inter-clusters connectivity is maintained by defining some 
Gateway-nodes (sub-section 3), named Cluster Gateway (C-
Gw) and Distributed Gateway (D-Gw). Moreover, in our 
adapted algorithm, we have opted for one-hop clusters to 
reduce the load of control messages within a cluster and to 
112
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

ensure a line of sight between the different cluster-heads and 
gateway nodes, which is an important characteristic for the 
deployment of our second routing sub-protocol IMPR 
(section E). An example of a clustered wireless mesh 
infrastructure is illustrated in Fig. 2. 
 
Figure 2.  Clustered architecture of the wireless mesh infrastructure 
Our clustering algorithm is composed of three main 
functions, which are presented in the following sub-sections: 
weight calculation, cluster-head election and clusters 
elaboration process. 
1) Weight Calculation 
In our algorithm, the weight assigned to each node is based 
on the WCA algorithm [13]. The latter takes into account the 
degree (neighbors’ number), the transmission power, the 
mobility and the battery power of each node. It optimizes the 
degree of each cluster-head by choosing an optimal number 
M of nodes per cluster (M is a pre-defined threshold). This 
restriction aims that the cluster-head would be able to support 
ideally the nodes within its cluster.  
However, given the stability of the nodes within our 
wireless mesh infrastructure, we are only interested in the first 
two parameters used to calculate the weight of WCA to find 
the optimal number of nodes within the transmission range 
and to estimate the transmission power toward the neighbors 
of a node. In addition, since most of the traffic is oriented to 
the Mesh Gateway, a third parameter is used in our weight 
calculation to take into account the power transmission of the 
node toward the Mesh Gateway. By this way, the cluster-head 
will be elected among the nearest nodes to the Mesh Gateway. 
Thus, the weight is calculated according to (2)-(6): 
DPv
c
b Dv
v
a
Wv



  


where a, b and c are the weighing factors so that a+b+c=1 and 
Wv is the weight of a node v.  
)
)'
( ,
(
)
(
, '
'






v
V v
v
txrange
dist v v
N v
dv

where V is the neighborhood of a node v. 
M
dv
v

 




( )
'
)'
,
(
N v
v
dist v v
Dv

)
( ,
DPv  dist v MG

Equation (4) represents the degree-difference for a node v 
to compare its number of neighbors (3) to the optimal number 
of nodes that a CH may coordinate efficiently. The 
transmission power toward the neighbors is estimated in (5) 
by computing the sum of the distances with all its neighbors. 
Samely, the third parameter namely the transmission power 
toward the Mesh Gateway is calculated in (6). 
2) Cluster-head Election 
Initially, all the nodes are in the initial state that is the 
"Undecided" state and with a weight equal to zero. Thanks to 
the periodic exchange of Hello messages, the Neighbor Table 
(Table II.) will be updated with the last calculated value of 
weight (W) for each neighbor. Each node waits for a period Te 
before starting the selection of the cluster-heads, so that all the 
nodes have updated their NT. After this period, the node with 
the lowest W among its neighbors broadcasts a Hello 
message, as illustrated in Fig. 3. 
 
 
 
Figure 3.  Cluster-head election algorithm 
3) Clusters elaboration process 
The division of the network on a set of clusters is based on 
the exchange of Hello Messages between each node and its 
neighbors. Fig. 4 illustrates the algorithm of the clusters 
elaboration.  
Figure 4.  Clusters elaboration algorithm 
According to our algorithm, we distinguish five possible 
states of a node within a cluster. Besides, it is important to 
1: If Wi = min (NT [weight]) then 
2: 
Si = CH 
3: 
ID-CHi = IDi 
4: 
Broadcasts Hello (IDi, Wi, Si, ID-CHi, Bused) 
5: End If 
 
On receiving a Hello message: 
1: If (Hello [State] = CH) then { 
2:    If ID-CHi = null then { 
3: 
Si = CM 
4: 
ID-CHi = Hello [ID-CH] 
5: 
Update (NT) 
6: 
Broadcast Hello (IDi, Wi, Si, ID-CHi, Bused) } 
7:     Else { 
8: 
If (Hello [ID] < ID-CHi) then 
9:                        G = ID-CHi 
10:  
    ID-CHi = Hello [ID]}  
11: 
End If 
12: 
Unicast [ID-CHi, GW-D (IDi, Wi, C-Gw, ID-CHi, G, null)] } 
 
13:   End If } 
14: Else if (Hello [State] = CM) then { 
15:    If (Si = CM) then { 
16:                If (ID-CHi = Hello [ID-CH]) then  
17:                    Update (NT) 
18:                 End If 
19:                 Unicast [ID-CHi, GW-D (IDi, Wi, D-Gw, ID-CHi, Hello [ID- CH], Hello[ID])] 
20:     } 
21:     Else 
22:                 Update (NT) 
23:     End If } 
24: Else { 
25:     If (ID-CHi = Hello [ID-CH]) then Update (NT)     
26:     Else { 
27:          Update (NT) 
28:          Update (NCHT) 
29:           } 
30:     End If } 
31: End If 
 
113
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

notice that the clustering algorithm is executed on each node 
of the infrastructure except the Mesh Gateway. The latter has 
its own state MG as Mesh Gateway. For the rest of nodes, we 
have the following states: 
 Undecided: it is the initial state indicating that the 
node does not yet belong to any cluster. 
 Cluster Member (CM): it is a node, which belongs 
already to a cluster. 
 Cluster Head (CH): it is the node with the lowest 
weight and it is the cluster’s manager. 
 Cluster Gateway (C-Gw): it is a node in direct vision 
with two different cluster heads at the same time. It 
acts as a bridge between the two clusters. 
 Distributed Gateway (D-Gw): it is a CM that has a 
neighbor belonging to another cluster. D-Gw ensures 
the communications between two disjoint clusters. 
These different states with the different necessary 
transition conditions are decribed in a FSM diagram (Fig. 5).  
 
Figure 5.  FSM of a node participating in the clustering algorithm 
A node becomes a CM node when it receives a Hello 
message for the first time from a CH node. This node may 
change its state to a gateway node to ensure interconnection 
between two clusters. It may become a C-Gw when receiving 
a Hello message from another cluster-head. It sends a GW-D 
(Declare) message (Table V.) to its cluster-head without 
changing state.  By receiving this message, the cluster-head 
consults its Neighbor CH Table (NCHT) (Table IV) in which 
it keeps the neighbor cluster-heads and its corresponding 
gateways and responds with a GW-A (Accept) or GW-R 
(Refuse) message. When a node is accepted as C-Gw, it 
changes its state to a C-GW (it is no more a CM) and updates 
its Gateway Table (Table III), in which it keeps its type as 
gateway and the two interconnected cluster-heads. 
TABLE III.  
GATEWAY TABLE (GWT) 
Type-Gw 
ID-CH1 
ID-CH2 
ID_D-Gw 
TABLE IV.  
NEIGHBOR CLUSTER-HEAD TABLE (NCHT) 
Neighbor ID-CH 
Gw-ID 
Type-Gw 
TABLE V.  
GW-D MESSAGE 
ID 
Weight 
Type-Gw 
ID-CH 
Neighbor ID-CH 
A CM node may also become a D-Gw when receiving a 
Hello message from a CM belonging to another cluster, as 
illustrated in the MSC diagram in Fig. 6.  
 
.
RN/AN 2
RN/AN 3
RN/AN 1
Hello ( S=CM , ID CH = CH(A) )
update NT
Hello ( S=CH , ID CH=CH(A) )
Hello ( S=CM , ID-CH =CH(C) )
Hello (S=DG , ID CH=CH(A) )
Hello ( S=CM , ID CH = CH(A) )
Gw-D
Gw-A
Hello (S=DG , ID CH=CH(A) )
update NT & NCHT
update NT & GT
update NT & GT
update NT
 
Figure 6.  MSC of D-Gw selection scenario 
D. Intra-infrastruture Routing (IMRR) 
Intra-Mesh Infrastructure Reactive Routing (IMRR) is the 
reactive routing sub-protocol of our proposed HQMR 
protocol. It is used to find routes in order to forward 
information between two nodes located within the 
infrastructure. It ensures QoS based routing for nodes 
belonging to a same cluster as well for those located in 
different clusters. Furthermore, the proposed IMRR sub-
protocol is an adaptation of AODV routing protocol [19] to 
take into account the clustering approach and the QoS 
verification in route discovery process. 
1) IMRR operation 
Fig. 7 illustrates the algorithm of IMRR operation. A node 
S starts directly to forward data if a valid route to D exists in 
its routing table or if D is one of its neighbors, with verified 
QoS. Otherwise, S launches the route discovery process.  
Figure 7.  IMRR operation algorithm 
The received RREQ message is either forwarded directly 
to the destination or forwarded to the multicast group formed 
by the different CHs, C-Gws, D-Gws and the MG. The use of 
When a node S wants to transmit data to a node D: 
1: S verifies its routing table 
2: If a valid route with requested QoS exists then  Forward (data, D) 
3: Else {verify (NT) 
4:      If D exists and QoS verified then Forward (data, D) 
5:      Else send (RREQ, CH) 
6:      End If} 
7: End If 
On receiving a RREQ message: 
1: If QoS verified then { 
2:      If it is the destination then Send (RREP, S) 
3:      Else {update (RREQ); update (RT) 
4:               If it is a CH then {Verify (NT)  
5:                      If D exists then Unicast (RREQ, D) 
6: 
 Else multicast (RREQ) 
7:                      End If} 
8:                Else multicast (RREQ) 
9:                End If} 
10:     End If 
11: Else discard (RREQ) 
12: End If 
 
114
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

the multicast group limits the broadcast of the RREQ 
messages, which helps reducing the load of the network. 
 We distinguish two main cases: the intra-cluster routing 
and the inter-clusters routing. For the first case, a node 
communicates with another within its cluster either in direct 
manner or through its cluster-head. An example of the second 
case is illustrated by a MSC (Message Sequence Chart) [20] 
in Fig. 8.  
RT update
QoS update & verif
RREP
RT update
QoS update & verif
RT update
RREP
QoS update & verif
RREQ
RREQ
SequenceDiagram_1
RREQ
RREQ
RREQ
NT &RT verif
QoS update & verif
RT update
QoS update & verif
NT &RT verif
QoS update & verif
RT verif
NT verif
Source
CH1
C-Gw
CH2
Destination
 
Figure 8.  MSC for inter-clusters IMRR routing 
Two nodes from different clusters may communicate with 
each other only through a route formed by CHs and/or Gws 
and/or the Mesh Gateway. 
2) Route Discovery Process 
Like AODV protocol, IMRR uses RREQ message for 
route discovery (Table VI). However, the RREQ message 
used by our IMRR routing protocol introduces specific QoS 
fields to enable QoS based routing. Each intermediate node 
proceeds to a QoS verification before forwarding the request 
(7). 
(Boff>=Breq or B=null) and (Doff>=Dreq or D=null) and (Joff>=Jreq or J=null)(7) 
where B is the bandwidth, D is the delay and J is the Jitter. 
TABLE VI.  
RREQ MESSAGE 
Src IP 
address 
Dest IP 
address  
Broadcast 
ID 
Path 
QoS 
Metric 
request-
ed 
QoS 
Metric 
offered 
ID 
msg 
 
In Fig. 9, we illustrate the processing of a RREQ message 
at each node. Unlike AODV protocol, only the destination 
node is able to respond to a RREQ message, so that it would 
have the entire path’s estimated QoS to compare it properly to 
the requested one. Moreover, the duplicate RREQ messages 
are not rejected. Instead, we send as much as possible of 
RREQ messages to the destination to guarantee the discovery 
of the best path. In order to avoid an infinite loop of a message, 
each node verifies first if its address already exists in the Path 
field or not. Then, we introduce a new parameter called "ID 
msg" to distinguish the duplicate messages at a node. This 
parameter is updated at each intermediate node for each 
RREQ message received (duplicated or not). Then, the reverse 
route is created within the routing table (Table VII), by taking 
into consideration this parameter, so that it would be used later 
for the RREP message forward. 
 
 
Figure 9.  RREQ processing 
TABLE VII.  
IMRR ROUTING TABLE 
Dest IP 
address 
Next 
Hop 
Lifetime 
QoS Metric 
offered 
ID 
msg 
Nxt ID 
msg 
 
3) Route Replay Process 
In order to establish a route toward the source node, the 
destination responds with a RREP message (Table VIII) to the 
first RREQ received verifying the requested QoS parameters 
and rejects the following RREQ messages. The processing of 
a RREP message at each intermediate node is illustrated by a 
flowchart in Fig. 10. 
A mesh node determines the next hop thanks to the “ID 
msg” parameter. It updates then the routing table with the 
direct route and the “ID msg” with the “Nxt ID msg” of the 
routing table before forwarding the RREP message. 
TABLE VIII.  RREP MESSAGE 
Src IP 
address 
Dest IP 
address 
Lifetime 
QoS Metric 
requested 
QoS Metric 
offered 
ID 
msg 
 
 
Figure 10.    RREP processing 
115
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

E. Inter-infrastructure Routing (IMPR) 
Inter-infrastructure Mesh Proactive Routing (IMPR) is the 
second routing sub-protocol of HQMR, designed to ensure 
communications toward external networks, especially Internet 
network. Since most of the traffic goes through the Mesh 
Gateway to provide Internet services, we opted for a proactive 
tree based routing protocol, having the Mesh Gateway as a 
root and the different CHs and C-Gw and/or D-Gw as 
children. It is important to notice that the different cluster 
members would not participate in the trees construction 
process. 
In addition, to provide QoS guarantees for real-time flows, 
IMPR deploys a multi-path routing concept to define three 
different routes, partially node-disjoint, between each child 
and the root. These routes would be used to construct three 
partially disjoint routing trees within the IEEE 802.16j 
wireless mesh infrastructure, in such a way that each tree is 
used to forward a specific type of traffic. To this end, we 
define for our protocol three service classes, namely 
interactive 
real-time 
applications 
class, 
Streaming 
applications class and Best Effort class. The first class is more 
sensitive to delay and jitter variations, the second one is more 
sensitive to jitter variation and the last class is more exigent in 
terms of loss ratio. In other words, IMPR allows the 
construction of three partially disjoint trees with a common 
root: Real Time, Streaming and Best Effort Trees.  
1) Root Announcement process 
The root (i.e., MG) broadcasts a RANN (Route 
Announcement) message to all its neighbors to announce its 
presence. This message is considered only by the CHs and the 
Gws. It is rejected by all the CM nodes. On receiving a RANN 
message (Table IX.), each intermediate node stores the Path 
parameter in its route cache and updates it next by adding its 
address. It updates also the QoS Metric and proceeds to the 
forward of the updated RANN message to its multicast group 
formed by the CHs, the Gws and the MG. In order to keep as 
many routes as possible, duplicated RANN messages are not 
rejected. Instead, to avoid an infinite loop of a message, each 
node verifies first if its address already exists in the Path field 
or not. In fact, each node keeps the entire path received 
through the RANN message in its route cache in order to be 
able to verify later the disjunction of two paths.  
TABLE IX.  
RANN MESSAGE 
Root IP address 
Path 
QoS Metric 
 
2) Routing trees construction 
Each node waits for a certain time Ts before starting the 
routing trees construction process, in order to store the 
maximum of paths. Firstly, using the routes selection 
algorithm (Fig. 11), each node selects a route for the Real 
Time Tree. This route is validated as one of the tree branches 
by an exchange of PREQ and PREP messages with the root. 
Once the PREP received from the root, each node removes the 
chosen path from its route cache and starts the construction 
process of the second routing tree in the same manner. Then, 
the mechanism is repeated for the third routing tree. In fact, 
the exchange of PREQ/PREP messages performed for routes 
validation is used to ensure that each intermediate node of a 
path is using the same path toward the root, so that each node 
has no more than a single branch toward the root of a tree.  
3) Routes Selection Algorithm 
This algorithm is described in Fig. 11. The idea is to select 
at each node a potential path for each routing tree, satisfying 
the requirements of the defined service classes. For the first 
path corresponding to the Real Time Tree, we choose the best 
in terms of delay and jitter with satisfying bandwidth metric. 
The second one should be partially disjoint from the first one 
to reduce congestion issues, with good values of the jitter QoS 
parameter. Lastly, from the remaining paths, we select the best 
in terms of disjunction over the other paths.  
Some nodes may not be able to select three different paths. 
Thus, for the case where a node has only selected two paths, 
the first one would be used to forward the highest priority 
traffic, while the second one would be shared between the two 
other service classes . If only one path is present at a node, we 
adopt the default QoS mechanism of IEEE 802.16j to share it 
between the three service classes. 
Figure 11.  IMPR routes selection algorithm 
4) Path Request Process 
By executing the route selection algorithm, a node selects 
a path for its ith routing tree and sends a PREQ message (Table 
X). Each intermediate node compares its chosen path for its ith 
routing tree to the path carried by the PREQ message. If the 
next hop in the two paths is different, the node either modifies 
its entire path or updates the path in the PREQ message, as 
presented in the Flowchart in Fig. 12. Then, the intermediate 
node updates its routing table (Table XI) with both the direct 
route (toward the root) and the reverse route (toward the 
source) and forwards the PREQ message to the next hop. 
TABLE X.  
PREQ MESSAGE 
Src IP address 
Dest IP address 
Path 
ID-Path 
Levela 
a. Level : the level of a node in the Real Time tree 
 
P  set of stored paths ; Disj  number of common nodes between paths   
HC: Hop Count ; wi : QoS parameters’ weight 
1: If treei =1 then {  
2:    A = {P}(D<Dmax and J<Jmax) 
3:      If A ≠ Ф then P1 = minHC {maxBw A} 
4:    Else {  
5:      B = {P}(D<Dmax) 
6:      If B ≠ Ф then{Calculate L=w1*rankdescBw + w2*rankascJ for each path in B; P1 = minL 
B} 
7:      Else{Calculate L=w1*rankdescBw+w2*rankascD+w3*rankascJ for each Path in P; P1 = 
minL P} 
8:      End If } 
9:    End If } 
10: End If 
11: If treei=2 then {  
12:    P = P\{P1} ; A = {P}(J<Jmax) 
13:      If A ≠ Ф then { 
14:        Calculate L=a*rankdesc Bw+b*rankasc Disj+c*rankascJ for each Path in A 
15:        P2 = minL A} 
16:    Else { 
17:         Calculate L =w1*rankdesc Bw + w2*rankasc J + w3*rankasc Disj for each Path in P 
18:         P2 = minL P } 
19:    End If } 
20: End If  
21: If treei=3 then { 
22:        P = P\{P2} ; P3 = minHC {minDisj P} } 
23: End If 
 
116
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

TABLE XI.  
IMPR ROUTING TABLE 
Dest IP address 
Next Hop 
ID-Path 
 
 
 
 
Figure 12.    Flowchart of PREQ process 
5) Path Replay Process 
On receiving the PREQ message, the root updates its 
routing table and sends a PREP (Table XII) message to its 
child.  
TABLE XII.  
PREP MESSAGE 
Dest IP address  
Path 
ID-Path 
 
Each intermediate node adds its address to the Path 
parameter of the PREP message and forwards it to the 
destination. Once the destination receives the PREP message, 
it updates its routing table and its chosen path for the routing 
tree if it is different from the Path parameter in the PREP 
message. Then, it removes it from its route cache to begin the 
selection of a route for the next tree. 
V. 
HQMR USAGE SCENARIOS 
In this section, we present two different usage scenarios of 
our HQMR protocol, describing how a path is selected to 
reach a destination within or outside the mesh infrastructure.  
A. Intra-infrastructure Routing Usage Scenario 
This scenario describes how to determine a QoS verified 
path between two nodes from different clusters for a VoIP 
application between two mesh clients of our architecture. To 
this end, the reactive routing bloc, named IMRR would be 
used and a RREQ message is generated for route discovery 
process. In Fig. 13, we illustrate the RREQ process through 
each intermediate node by comparing the offered QoS to the 
requested one (Breq=56Kb/s, Dreq=150ms and Jreq=20ms). 
The first RREQ received by D (<2, 155, 19>) does not 
satisfy the requested delay parameter. Thus, this message is 
discarded and D waits for another RREQ messages. Since the 
second message received (RREQ2) verifies the different QoS 
parameters (<2, 145, 13>), a RREP message is unicasted to 
the source node. 
 
Figure 13.    Intra-infrastructure usage scenario  
Then, regarding the third RREQ message received, it 
would be discarded since a RREP message has been already 
sent back. By this way, the route discovered by RREQ2 would 
be used to forward the traffic of the VoIP application between 
the two mesh clients. 
B. Inter-infrastructure Routing Usage scenario  
For communications with the Internet network, the 
proactive routing protocol IMPR of HQMR protocol is used. 
In this scenario, we describe how to forward a VoD 
application traffic from a streaming video server in the 
Internet. To this end, three QoS based routing trees are 
constructed. Fig. 14 shows an example of clustered topology 
over which we have built the three QoS based routing trees.  
For the first routing tree, by executing the route selection 
algorithm (Dmax=150 ms, Jmax=20 ms), we chose the paths 
with satisfying delay and Jitter parameters. For example, in 
the case of the node B, we have four paths towards the root 
satisfying the delay and jitter parameters: B-A-R: <4,30,11> ; 
B-C-R: <3,70,6> ; B-D-A-R: <3,95,16> ; B-E-C-R: <2,70,9>. 
Then, the path with the highest Bandwidth is selected: B-A-
R. This process is repeated at each node of the topology and a 
PREQ message is sent for route validation.   
 
 
Figure 14.    The QoS based routing Trees 
Path: the chosen Path by the 
intermediate node. 
 
Path_S= the path sent in the 
PREQ. 
 
117
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

Similarly, the path at each node for the second routing tree 
is selected according to the routes selection algorithm. For 
example, at the node E, we have two paths verifying the jitter 
parameter: E-B-C-R: <2, 90, 11>; E-B-A-R: <2, 50, 16>. The 
second path is the one selected by E since it offers better 
disjunction with the path selected for the first tree. However, 
the PREQ of this message would be changed at the node B. In 
fact, the nodes B and E have the same level parameter but 
node B has a greater IP address than E. Thus, the path in the 
PREQ sent by the node E would be changed (to E-B-C-R) to 
correspond to the route chosen by the node B: B-C-R. 
By receiving the PREP message for the selected route, 
each node starts the selection of its third route that is the most 
disjoint route to the two first selected paths with a minimum 
of hops. For example, the node I according to these conditions 
chooses the path I-H-G-D-A-R. However, its PREQ at the 
node G would be changed (see the flowchart in Fig. 12). The 
selected path by the node I would be modified partially (I-H-
G-F-E-C-R) to correspond to the one selected by the node G. 
Then, the set of paths selected at each node forms the routing 
tree for the third service class. 
Regarding our usage scenario, and in order to forward the 
VoD traffic, the second routing tree would be used since this 
application is considered as an application of the Streaming 
service class. 
VI. 
CONCLUSION 
In this paper, we presented our proposed hybrid wireless 
mesh architecture composed of two different domains: an 
IEEE 802.16j-based infrastructure domain and several IEEE 
802.11s based client domains. Then, we have specified the 
HQMR protocol for ensuring routing functionalities within 
the 802.16j infrastructure of our global architecture. It is a 
hybrid QoS based routing protocol formed by a reactive 
routing sub-protocol for a clustered infrastructure and a 
proactive multipath tree based routing sub-protocol for 
communications toward Internet network. Two usage 
scenarios are presented to show the importance of HQMR in 
order to provide real time and streaming applications with 
QoS guarantee in wireless mesh networks.  
As a future work, we are working on the HQMR 
performance evaluation within our global wireless mesh 
architecture as well as comparison with other protocols. 
ACKNOWLEDGMENT 
This work has been funded by the Regional Council of 
Burgundy, France.  
REFERENCES 
[1] 
I. F. Akyildiz, X. Wang, and W. Wang, “Wireless mesh networks: a 
survey”, Comput. Netw., march. 2005, vol. 47, no 4, pp. 445‑487. 
[2] 
I. F. Akyildiz and X. Wang, “A survey on wireless mesh networks”, 
IEEE Commun. Mag., 2005, vol. 43, no 9, pp. S23‑S30. 
[3] 
“IEEE Standard for Local and metropolitan area networks Part 16: Air 
Interface for Broadband Wireless Access Systems Amendment 1: 
Multihop Relay Specification”, IEEE Std 80216j-2009 Amend. IEEE 
Std 80216-2009, 2009, pp. 1‑290. 
[4] 
“IEEE Standard for Local and Metropolitan Area Networks Part 16: 
Air Interface for Fixed and Mobile Broadband Wireless Access 
Systems Amendment 2: Physical and Medium Access Control Layers 
for Combined Fixed and Mobile Operation in Licensed Bands and 
Corrigendum 1”, IEEE Std 80216e-2005 IEEE Std 80216-2004Cor 1-
2005 Amend. Corrigendum IEEE Std 80216-2004, 2006, pp. 01‑822. 
[5] 
Q. Xue and A. Ganz, “QoS Routing for Mesh-Based Wireless LANs”, 
Int. J. Wirel. Inf. Netw., 2002, vol. 9, no 3, pp. 179‑190. 
[6] 
R. Draves, J. Padhye, and B. Zill, “Comparison of routing metrics for 
static multi-hop wireless networks”, New York, NY, USA, 2004, pp. 
133–144. 
[7] 
V. Kone, S. Das, B. Y. Zhao, and H. Zheng, “QUORUM: quality of 
service in wireless mesh networks”, Mob Netw Appl, Dec. 2007, vol. 
12, no 5, pp. 358–369. 
[8] 
L. Liu, L. Zhu, L. Lin, and Q. Wu, “Improvement of AODV Routing 
Protocol with QoS Support in Wireless Mesh Networks”, Phys. 
Procedia, 2012, vol. 25, pp. 1133‑1140. 
[9] 
Y. Zhang, Y. Wei, M. Song, and J. Song, “R-AODV: Rate aware 
routing protocol for WiFi mesh networks”, IET International 
Conference on Wireless, Mobile and Multimedia Networks, 2006, pp. 
1‑4. 
[10] X. Cheng, P. Mohapatra, S. Lee, and S. Banerjee, “MARIA: 
Interference-Aware Admission Control and QoS Routing in Wireless 
Mesh 
Networks”, 
in 
IEEE 
International 
Conference 
on 
Communications, ICC ’08, 2008, pp. 2865‑2870. 
[11] C. R. Lin and M. Gerla, “Adaptive clustering for mobile wireless 
networks”, IEEE J. Sel. Areas Commun., 1997, vol. 15, no 7, pp. 
1265‑1275. 
[12] P. Krishna, N. H. Vaidya, M. Chatterjee, and D. K. Pradhan, “A 
cluster-based approach for routing in dynamic networks”, SIGCOMM 
Comput Commun Rev, April 1997, vol. 27, no 2, pp. 49–64. 
[13] M. Chatterjee, S. K. Das, and D. Turgut, “WCA: A Weighted 
Clustering Algorithm for Mobile Ad Hoc Networks”, Clust. Comput., 
April 2002, vol. 5, no 2, pp. 193‑204. 
[14] Z. Haas, M. Pearlman, and P. Samar, “The Zone Routing Protocol 
(ZRP) for Ad Hoc Networks”, http://tools.ietf.org/html/draft-ietf-
manet-zone-zrp-04 [retrieved: May,2014]. 
[15] M. Singh, S. G. Lee, T. W. Kit, and L. J. Huy, “Cluster-based routing 
scheme for Wireless Mesh Networks”, 13th International Conference 
on Advanced Communication Technology (ICACT), 2011, pp. 
335‑338. 
[16] D. Kaushal, A. G. Niteshkumar, K. B. Prasann, and V. Agarwal, 
“Hierarchical Cluster Based Routing for Wireless Mesh Networks 
Using Group Head”, International Conference on Computing Sciences 
(ICCS), 2012, pp. 163‑167. 
[17] “IEEE 
Draft 
Standard 
for 
Information 
Technology-
Telecommunications and information exchange between systems-
Local and Metropolitan networks-Amendment 8: IEEE 802.11 
Wireless Network Management", IEEE P80211vD160, 2010, pp. 
1‑428. 
[18] “IEEE Standard for Information Technology–Telecommunications 
and information exchange between systems–Local and metropolitan 
area networks–Specific requirements Part 11: Wireless LAN Medium 
Access Control (MAC) and Physical Layer (PHY) specifications 
Amendment 10: Mesh Networking”, 2011, pp. 1‑372. 
[19] “Ad 
hoc 
On-Demand 
Distance 
Vector 
Routing 
(AODV)”. 
http://www.ietf.org/rfc/rfc3561.txt [retrieved: May,2014]. 
[20]  D. Harel and P. S. Thiagarajan, "Message Sequence Charts", in UML 
for Real, Ed. Springer US, 2003, pp. 77‑105. 
 
 
118
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-360-5
AICT2014 : The Tenth Advanced International Conference on Telecommunications

