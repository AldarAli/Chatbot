Magnetic Resonance Signal Processing in Medical Applications 
 
 
Jan Mikulka, Eva Gescheidtová 
Department of Theoretical 
and Experimental Electrical Engineering 
Brno University of Technology 
Brno, Czech Republic 
e-mail: mikulka@feec.vutbr.cz, gescha@feec.vutbr.cz 
Karel Bartušek 
Institute of Scientific Instruments 
Academy of Sciences of the Czech Republic 
Brno, Czech Republic 
e-mail: bar@isibrno.cz
 
 
Abstract—Image processing in biomedical applications is an 
important developing issue. Many methods and approaches for 
image preprocessing, segmentation and visualization were 
described. It is necessary to choose a suitable segmentation 
method to create a correct three-dimensional model. The 
accuracy of reconstruction depends on precision of regions 
boundary determining in magnetic resonance slices. A 
frequent application is detection of soft tissues. To obtain 
images of the soft tissues mentioned, tomography based on 
magnetic resonance is usually used. Ideally, several tissue slices 
in three orthogonal planes (sagittal, coronal, transverse) are 
acquired. Following reconstruction of shape of examined 
tissues is the most accurate. In case of acquired slices only in 
one plane, the high spatial information lost occurs by image 
acquisition. Then it is necessary to reconstruct the shape of 
tissue appropriately. At first the images are segmented and 
with use of particular segments the three dimensional model is 
composed. This article compares several segmentation 
approaches of magnetic resonance images and their results. 
The results of segmentation by active contour, thresholding, 
edge analysis by Sobel mask, watershed and region-based level 
set segmentation methods are compared. The results for 
different values of parameters of segmentation methods are 
compared. As the test image, slice of human liver tumour was 
chosen. 
Keywords-magnetic resonance; biomedical image processing; 
image segmentation; level set; active countour; edge analysis; 
noise suppression; volumetry  
I. 
 INTRODUCTION 
Image processing in biomedical applications is an 
important developing issue. Many methods and approaches 
for signal/image preprocessing, segmentation and visualizing 
were described. On the basis of segmented images, it is 
simple to describe the boundaries of the objects sought; these 
boundaries serve further processing aimed at calculating the 
perimeter, 
area, 
surface, 
volumetry 
or 
even 
3D 
reconstruction of the object being imaged. To obtain images 
of the soft tissues mentioned, tomography based on magnetic 
resonance (MR) is usually used. It is necessary to reconstruct 
the shape of tissue appropriately. The shape is reconstructed 
via its segmentation in several slices. The reconstructed 
model has staggered shape. There are several methods for 
smoothing the shape. In this article the methodology for 
shape smoothing is discussed. The results of volumetry with 
use of several smoothing levels are compared. Impact of 
shape smoothing to quality of reconstruction is discussed. It 
is shown that high level of smoothing suppresses the 
staggered shape but the edge information is lost. With 
increased smoothing level the staggered shape of the model 
comes to be suppressed, with the transitions between 
individual model segments suppressed. 
For a comparison of the segmentation properties of the 
methods, two sets of real medical images were chosen: MR 
images of the human liver with a tumour visible in several 
slices, MR images of the human head for the processing of 
the region of temporomandibular joint (TMJ). The 
segmentation of the mandibular disc is made difficult not 
only by the low contrast and the presence of noise but also 
by the fact that in most of the images obtained the region of 
the mandibular disc is represented by a very small number of 
pixels. The liver region exhibits homogeneous distribution of 
intensity, which is lower than in the surrounding area of the 
liver. The topicality of the selected topic of liver tumour 
segmentation is attested by the diverse conferences held and 
papers published [1] [2] [3] [4] [5] [6]. 
In the paper, an image segmentation method is described, 
which reduces the requirements for image pre-processing 
(elimination of noise) and yields good results also when 
segmenting a noisy image [7][8][9]. This is of much 
advantage when processing images exactly by the MR 
method. State of the art is mentioned in the next chapter. 
Some publications in the area of liver tumour segmentation 
are mentioned. It is followed by describing used 
mathematical models in the next chapter. Implementation 
problems, results and their comparison with other 
segmentation methods are shown in rest of the paper. 
 
II. 
STATE OF THE ART 
Extensive research was conducted in the area of 
processing MR images of tumours in the human liver in the 
past. The liver region exhibits homogeneous distribution of 
intensity, which is lower than in the surrounding area of the 
liver. 
148
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

The topicality of the selected topic of liver tumour 
segmentation is attested by the diverse conferences held and 
papers published. Evidently, the greatest impulse to 
investigate methods for processing liver images was the 
workshop “3D Segmentation in the Clinic: A Grand 
Challenge II” [1], which was part of the conference “Medical 
Image Computing and Computer Assisted Intervention 
2008”. The aim of holding the Conference was a) to define 
the input data (64 or 40 slices in each set of images obtained 
by computer tomography were available, slice thickness 1 – 
1.5 mm), and b) to define the criteria for the evaluation of the 
methods In [4], a chain of processing CT images of the 
human liver is described which, in brief, consists of image 
pre-processing – histogram-based segmentation of the 
region, multimodal thresholding, maximum a posteriori 
decision-making, and of the segmentation of the liver region, 
which is given by the basic local properties. The image 
processing chain gives very good results. A disadvantage can 
certainly be seen in the many degrees of freedom of this 
chain. A simpler approach is described in [3]. In the 
proposed methodology, the pre-processing of images is 
eliminated. Prior to the segmentation using the level set 
method the images are pre-segmented by fuzzy cluster 
algorithms. The author demonstrates the segmentation 
function on several selected CT images. But, the results are 
not discussed and there is no mention of important 
parameters such as segmentation speed or differences in 
comparison with the actual/real division of tissues, for 
example by tracing manually the tumour edges. A similar 
approach, segmentation of liver tumour area by the level set 
method, is described in [4]. The level set segmentation is 
preceded by the initialization method, which pre-processes 
the image prior to its segmentation proper. This initialization 
method is the so-called spiral-scanning method with 
supervised fuzzy pixel classification. The paper describes the 
segmentation of the liver tumour area in images produced by 
computer tomography. We can also come across methods 
that are based on segmentation approaches that are today 
considered traditional, e.g. the watershed method [5], 
thresholding method [6] and region growing method [7]. The 
development of the method for the segmentation of liver 
tumours follows from the previously published work [8], in 
which region-based level set segmentation was used. 
The greatest disadvantage of the methods described 
above can be seen in that either a greater interaction of the 
physician in the segmentation of the liver tumour in 
tomographic images is required or it is necessary to choose a 
large number of segmentation parameters or to pre-process 
the images. 
 
III. 
MATHEMATICAL MODELS 
The selected segmentation methods are based on the 
solution of partial differential equations. These are iterative 
algorithms with initial conditions whose solution is used to 
shape the curve placed in the image. The steady-state 
solution is a curve delineating the image regions, which 
satisfies the sought minimum of the energy function of the 
mathematical model of a given method. The problem is to 
delineate by a smooth closed curve only the tumour region 
such that the curve does not delineate any other tissues. This 
can happen in the comparatively frequent case when the 
tumour is at the liver periphery; it is then important not to 
exceed the liver boundary. Better results were obtained using 
the edge-based analysis, which satisfied the above condition 
of delineating the tumour region alone.  
The edge-based segmentation is described by this energy 
functional [9]: 

 
 


d d
d d
F
g
x y
gH
x y


 













where the first term means the length of the zero level curve 
of Φ (level set distance function) and the second term is 
called weighted area of 


.  and  are the weighted 
coefficients of the mentioned terms, 
 
 
is the Dirac 
function and H is the Heaviside function. The g function is 
the edge indicator defined by [10] 

2
1
1
g
G
I


 



where I is the original image and G is the Gaussian kernel 
with standard deviation . By calculus of variation, the first 
variation of the functional in (2) can be written as [9] 

 
 
d
div
d
λ
div
.
t
g
g






 
  







 




























This gradient flow is the evolution equation of the level 
set function Φ. The second and third term in the equation (3) 
correspond to the length and area energy functional. The first 
term penalizes the deviation of the level set function from a 
signed distance function during its evolution. 
The region-based segmentation method is of greater 
advantage when segmenting an image in which there are no 
sharp transitions or in the case when the extraction of an 
object in the image is required when the statistical properties 
of intensities at the site of the object sought are known. With 
this approach the principle is that no edges are sought in the 
image – regions in the image are viewed according to the 
local intensity statistics and, according to the given 
properties, the image is subdivided into two or more regions. 
The model of which is given by the energy functional [10]: 









2
0
1
2
1
,
,
d d
n
I
I
I
n
i
i m
m
F
u
x y
c
x y
H Φ



  
 





 
 
c Φ


149
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

and for the two-phases result the general energy functional 
(4) is in shape [10]: 
 







 




 


 
2
1
2
0
1
2
0
2
,
,
,
d d
,
1
d d
,
F c c
u
x y
c
H
x y
u
x y
c
H
x y
H




















where the first two terms divide the area   of the original 
image u0 to two subareas with the mean values of intensity c1 
and c2. The third term minimizes the length of the resultant 
contour. It can be used for suppression of noise in the image 
and the final contour is smoother. This term is weighted by 
the coefficient . H is the Heaviside function. This function 
recognizes where the level set function   is positive, 
respectively negative. 

 




2
2
0
1
0
2
div
Φ
Φ
Φ
u
c
u
c
t
Φ



























 
This gradient flow [10] is the evolution equation of the 
level set function Φ. The first term in the brackets (6) 
corresponds to the length functional. 
Thresholding - the simplest segmentation method is 
defined as: 







1
pro 
,
T
,
0
pro 
,
T
f i j
g i j
f i j



 
<


The biggest disadvantage of this method is that it is very 
sensitive to noise, but it is very often used in medical 
practice in manual processing. It is very simple and fast. 
Image segmentation based on Sobel mask convolution is 
defined by convolution kernel: 

1
0
1
1
2
1
2
0
2 ,
0
0
0
1
0
1
1
2
1
x
y
S
S






























IV. 
IMPLEMENTATION 
The algorithm was implemented in Matlab 7.0. The 
equation (3) was approximated by central and forward 
difference schemes and solved by iterative process. The 
Dirac function was approximated by [10]: 

 
0,
1
1 cos
,
2
x
x
x
x









 



















V. 
RESULTS, LIVER TUMOUR SEGMENTATION 
The aim of processing is to segment the tumour in all 
slices, reconstruct the obtained segments back to a 3D image 
and calculate the tumour volume so that the tumour 
evolution in time can be monitored (Fig. 1) In the case of 
liver tumour, a correct diagnosis is very important as it is 
decisive in determining the treatment procedure. The main 
drawbacks of traditional segmentation methods include, in 
the first place, the necessary individual pre-processing of 
images in order to suppress their unfavourable properties 
(presence of noise in images, blurred edges, low contrast), 
the necessity of individually adapting the segmentation 
method according to the number of image subregions sought 
(segmentation into two (background/object) or more 
subregions), etc. The aim was to simplify as much as 
possible the image processing chain, i.e., to find a method by 
means of which it would be possible in ideal case to segment 
the regions sought, without the necessity of image pre- and 
post-processing. For the segmentation of liver tumours the 
edge-based segmentation method was selected [9][10]. Good 
results were obtained using the edge-based analysis, which 
satisfied the above condition of delineating the tumour 
region alone.  
 
 
Figure 1.  Example of MR slice through human liver; the tumour sought is 
in the delineated region. 
Fig. 2 shows the results of segmenting a liver tumour by 
the active contour method based on the edge-based analysis 
of image. The contour smoothness is given by the filtering 
properties of the method itself, which thus does not require 
any pre-processing of the image (smoothing, filtering, 
focussing) and which delineates only the region of the 
tumour proper and, in spite of the very similar mean value of 
brightness does not evolve in time towards delineating some 
narrow regions connected with the tumour.  
 
150
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

 
 
 
 
 
 
Figure 2.  Results of segmenting a liver tumour by the active contour 
method based on edge-based analysis; 6 chosen slices. 
VI. 
RESULTS, MANDIBULAR DISC SEGMENTATION 
The aim of processing is to segment the mandibular disc 
in all slices and reconstruct the obtained segments back to a 
3D image (Fig. 3). In the case of TMJ disorder in the disc 
area (rupture, dislocation) a correct diagnosis is very 
important as it is decisive in determining the treatment 
procedure. . The main drawbacks of traditional segmentation 
methods are similar to the previous one. The aim was to 
simplify as much as possible the image processing chain, i.e. 
to find a method by means of which it would be possible in 
ideal case to segment the regions sought, without the 
necessity of image pre- and post-processing. The MR slices 
with visible mandibular discs were segmented by edge-based 
level set segmentation method. This level set approach gives 
very good results in segmentation of noised MR images with 
low contrast and smooth edges so that it is not necessary to 
preprocess the image before the segmentation of image.  
 
 
Figure 3.  Example of MR image of human head for diagnosing TMJ, with 
delineated region of temporomandibular disc. 
The results of segmentation without any kind of 
preprocessing are given in Fig. 4. 
 
 
 
 
 
Figure 4.  Result of segmentation of TMJ in four selected slices by edge-
based segmentation active contur method. 
VII. COMPARISON OF RESULTS WITH OTHER METHODS 
In this section, a comparison is shown of the 
segmentation of a selected image (MR, human liver) and 
other traditional segmentation approaches. The first to be 
chosen was the simplest segmentation method, which is used 
very often in medical practice and is supported by the 
majority of professional software applications designed for 
MR images that are processed by physicians. This method is 
thresholding. Fig. 5 gives the result of segmenting the image 
of a slice through liver tumour by the thresholding 
segmentation method with two different thresholds, which 
were established empirically (100, 150). A mere subjective 
assessment is enough to conclude that in spite of its 
simplicity and speed, this method cannot be used to process 
such an image. With a low threshold level the darker regions 
inside the tumour were segmented while with a higher 
threshold level a contour was found that delineates the 
tumour region and goes through the tumour “edge” but this 
curve is not closed and penetrates farther into the liver 
region, out of the tumour. It is obvious that in the case of 
processing a large set of images the search for a suitable 
threshold would be demanding and the segmented images 
would have to be further processed in order to obtain a 
complete segmentation result. 
 Fig. 6 gives the result of the Sobel mask edge-based 
analysis [1, 2] with two different levels of thresholding the 
edge-based analysis image (0.05, 0.15).The edge-based 
analysis yields results similar to those of the segmentation 
thresholding method. Choosing a low threshold value gives 
an oversegmented image while a higher threshold will yield 
information only on very pronounced edges in the image. 
151
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

The other edge analyzers give similar results; the result of 
edge-based analysis must be additionally processed and can 
be used, for example, as additional information for another 
segmentation method. Practically, never does this method 
give a closed curve representing the edges of the region of 
interest sought. 
 
 
 
Figure 5.  Result of segmenting the image of a slice through liver tumour 
via thresholding with thresholding levels a) 100, c) 150, within a brightness 
intensity range of 0 – 255. 
Fig. 7 shows the result of image segmentation of a slice 
through liver tumour using the water shed segmentation 
method [1]. This segmentation method gives good results 
and is frequently used in practice. It has, however, one great 
disadvantage – the result of segmentation without prior 
image processing is oversegmented and the image must 
practically always be adapted in an appropriate way. Fig. 7 
b) gives the result of watershed image segmentation after 
prior processing of the grey-tone image by thresholding 
(with automatic threshold search) and by transforming the 
binary image into a grey-tone image representing the 
Euclidean distance of every single pixel of the binary image 
from the background. The watershed image segmentation 
with prior image processing gives very good results. 
However, the method is dependent on an appropriate 
determination of the threshold of primary segmentation and 
the segmented region of the tumour reaches into the liver 
region since the method responds to any tiny interruption of 
the edge by merging the regions. 
 
 
 
Figure 6.  Result of edge-based analysis of a slice through liver tumour 
using the Sobel mask, with threshold values a) 0.05, c) 0.15. 
 
 
Figure 7.  Result of image segmentation of a slice through liver tumour 
using the watershed segmentation method; a) oversegmented result without 
pre-processing, b) with pre-processing. 
VIII. SUMMARY 
Results of image processing show that the active contour 
method based on the level set principle is very appropriate 
for the segmentation of both low-contrast images and regions 
with interrupted edges. An example of the first type of task, 
namely the segmentation of regions in low-contrast images, 
was demonstrated on the processing of MR images in the 
TMJ region, specifically the TMJ disc. The segmentation of 
regions with interrupted edges, on the other hand, is 
demonstrated by the application of active contours in the 
processing of MR images of human liver. In contrast to other 
traditional segmentation methods, the active contour method 
was always able to segment the given region of interest. The 
segmentation result is always a closed curve delineating the 
tissue sought. 
 
IX. 
CONCLUSIONS AND FUTURE WORKS 
The segmentation of regions of interest in MR images is 
an important part of the image processing chain. The quality 
of separating the region of interest from the background 
determines the quality of further processing. This may 
include the quantification of the delineated regions such as 
establishing the dimensions, area and volume or three-
dimensional reconstruction and visualization of objects. 
The future work will be concerned with registration of 
segmented images and creation of the 3D model of the 
region of interest and its visualization.  
 
ACKNOWLEDGMENT 
This work was supported within GACR 102/11/0318, 
CZ.1.05/2.1.00/01.0017 (ED0017/01/01), and FEKT-S-11-
5/1012. 
REFERENCES 
[1] Deng, X. and Du, G. Editorial: 3D Segmentation in the Clinic: A 
Grand Challenge II – Liver Tumour Segmentation. 2008. 
[2] Seo, K. and S., Chung, T. W. Automatic Boundary Tumour 
Segmentation of a Liver. ICCSA 2005, LNCS 3483, pp. 836-842, 
2005. 
[3] Li, B., N., Chui, Ch., K., Ong, S., H. and Chang, S. Integrating FCM 
and Level Sets for Liver Tumour Segmentation. ICBME 2008, 
Proceedings 23, pp. 202-205, 2009. 
152
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

[4] Smeets, D., Loeckx, D., Stijnen, B., Dobbelaer, B., Vandeurmeulen, 
D. and Suetens, P. Semi-automatic level set segmentation of liver 
tumours combining a spiral-scanning technique with supervised fuzzy 
pixel classification. Medical Image Analysis, vol. 14, 2010, pp. 13-
20. 
[5] Stawiaski, J., Decenciere, E. and Bidault, F. Interactive Liver Tumour 
Segmentation Using Graph-cuts and Watershed. MICCAI 2008. 
[6] Abdel-Massieh, N., H., Hadhoud, M., M. and Amin, K., M. 
Automatic Liver Tumour Segmentation from CT Scans with 
Knowledge-based Constraints. 5th Cairo International Biomedical 
Engineering Conference, 2010, pp. 215-218. 
[7] Qi, Y., Xiong, W., Leow, W. K., Tian, Q., Yhou, J., and Liu, J. Semi-
automatic Segmentation of Liver Tumours from CT Scans Using 
Bayesian Rule-based 3D Region Growing. MICCAI 2008 Workshop 
3D Segmentation in the Clinic, 25. 
[8] Mikulka, J., Gescheidtová, E. and Bartušek, K. Processing of MR 
slices of human liver for volumetry. In PIERS 2010 in Xi' an 
Proceedings. 2010. pp. 202-204. ISBN: 978-1-934142-12- 7. 
[9] Li, Ch., Xu, Ch., Gui, Ch. and Fox, M., D. Level set evolution 
without re-initialization: A new variational formulation. In 
Proceedings of the 2005 IEEE Computer Society Conference on 
Computer Vision and Pattern Recognition CVPR’05. San Diego 
(USA): IEEE Computer Society Washington, DC, USA, 2005, pp. 
430–436. ISBN 0-7695-2372-2. 
[10] Aubert, G. and Kornprobst, P. Mathematical problems in image 
processing: Partial differential equations and the calculus of 
variations. 2nd edition. New York : Springer Science + Business 
Media, LLC, 2006. ISBN 0-387-32200-0. 
153
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

