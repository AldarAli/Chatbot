A New Coarse Timing Estimation Method for OFDM Signals
Soumitra Bhowmick, K.Vasudevan
Department of Electrical Engineering
Indian Institute of Technology
Kanpur, India 208016
Abstract—In this paper, a data aided timing synchronization
scheme for Orthogonal frequency division multiplexing (OFDM)
signals is proposed. The algorithm uses multiple preambles for
initial (coarse) timing estimation, and it works in the time
domain. We also propose a timing estimation method using one
preamble which is independent of the structure of the preamble,
and that works better than the other existing methods in the
presence of carrier frequency offset (CFO). The performance is
compared in terms of probability of erasure, probability of correct
estimation and mean square error (MSE) with the existing timing
synchronization methods for OFDM systems.
Keywords—Timing synchronization; OFDM; Preamble; MSE;
Probability of erasure; Probability of correct estimation.
I.
INTRODUCTION
The main impairments in a wireless communication system
are multipath fading and noise. Multipath fading introduces
inter symbol interference (ISI). The major requirements of
a digital communication system is to maximize the bit rate,
minimize bit error rate, minimize transmit power and minimize
transmission bandwidth [1]. Orthogonal frequency division
multiplexing (OFDM) has emerged as a powerful technique
which meets the above requirements in multipath fading chan-
nels [2]. However, OFDM is known to be very sensitive to
timing and carrier frequency synchronization errors [3].
Timing estimation in OFDM systems can be achieved by
either data aided (DA) or non data aided (NDA) method. In
this paper, we focus on the data aided (DA) timing estimation
methods. Data aided timing estimation methods proposed in
the literature can be broadly classiﬁed into two categories.
1)
Approaches that depend on the special structure of
the preamble [3]–[7]
2)
Approaches that work independent of the structure of
the preamble [8]–[13].
The technique proposed in the literature by Schmidl and Cox
[3] uses a preamble with two identical halves to estimate the
timing synchronization. The variance of the timing estimation
proposed in [3] is large due to the timing metric plateau. The
performance of timing estimation is further improved by the
authors in [4]–[7]. All these methods are dependent on the
special structure of the preamble; hence they cannot work with
other preambles and moreover the variance of the timing esti-
mation of these methods is high in multipath fading scenario.
Kang [8] proposed a technique to estimate timing offset which
is independent of the preamble structure. In [8], a delayed
correlation of the preamble is used for timing synchronization.
The performance is further improved in [9] [10] by utilizing all
correlation points without repetition. In [12] [13], a new timing
estimation method using a matched ﬁlter is proposed which
gives better performance than [8] [9] with less computational
complexity. All these methods proposed in the literature [8]–
[10] [12] [13], which are independent of the structure of the
preamble utilize only one preamble for timing synchronization.
Hamed [11] ﬁrst proposed a timing estimation method by
utilizing more than one preamble. The main drawback of
these methods [8]–[12] is that the coarse timing estimation is
severely degraded in the presence of carrier frequency offset
(CFO). Here, we propose a new timing estimation method
using multiple preambles and we also propose a modiﬁed
timing estimation method which is robust to CFO.
This paper is organized as follows. The system model is
presented in Section II. The proposed method is presented in
Section III. The simulation results are given in Section IV and
ﬁnally, the conclusions in Section V.
II.
SYSTEM MODEL
Fig. 1 shows the typical structure of a OFDM frame in
the time domain. An OFDM frame contains preamble, cyclic
preﬁx (CP) and data. The preamble is used for synchronization
purpose. The mth preamble in the frequency domain can be
Figure 1: OFDM frame structure in the time domain
represented in vector form as follows.
Xm = [Xm (0) Xm (1) ... Xm (N − 1)]
(1)
where 0 ≤ m ≤ M − 1. The IFFT of the mth preamble is
given by
xm (n) = 1
N
N−1
X
k=0
Xm (k) ej2πnk/N.
(2)
The mth preamble in the time domain can be represented in
vector form as follows
xm = [xm (0) xm (1) ... xm (N − 1)]
(3)
where 0 ≤ k, n ≤ N − 1. Let x0 to xM−1 be the preambles
of the frame in the time domain. Let the transmitted frame be
given by (Fig. 1)
x = [x0 .. xM−1 CP DATA] .
(4)
Now, x is transmitted through the frequency selective channel.
The channel is assumed to be quasi static and it is ﬁxed for
80
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

one frame and varies independently from frame to frame. Its
impulse response for a given frame can be expressed as:
h = [h(0) h(1) h(2) ..... h(L − 1)]
(5)
where L is the number of channel taps. The received signal
r(n) in the time domain is given by:
r (n) = y (n) ej2πnϵ/N + w (n)
(6)
where
y (n)
=
h (n) ⋆ x (n)
=
L−1
X
l=0
h (l) x (n − l) .
(7)
and w (n) is zero mean Gaussian noise sample and ϵ is the
normalized frequency offset.
III.
PROPOSED MODEL
The received signal r(n) is used to estimate the start of the
frame ˆθt. It is assumed that the preambles x0, x1, ..., xM−1 are
known to the receiver. We deﬁne the correlation function given
by
T (d) =
N−1
X
n=0
M−1
X
m=0
r⋆ (d + n + mN) xm (n)
(8)
R =
N−1
X
n=0
M−1
X
m=0
| xm (n) |2
(9)
G (d) =| T (d) |2
M.R
(10)
The estimated start of the frame is given by
ˆθt = max
d
[G (d)]
(11)
Note that in the special case of M = 1 in (8), T(d) reduces
to
T(d) =
N−1
X
n=0
r⋆ (d + n) x0 (n)
(12)
It is equivalent to the method proposed in [12] which is a
matched ﬁltering approach using one preamble. The perfor-
mance of the proposed timing metric (10) is severely degraded
in the presence of CFO. Hence, we propose a modiﬁed timing
metric which performs better than (10) in the presence of CFO.
Let the frequency offset ϵ lie within [−I, I]. We divide the
interval [−I, I] into B sub intervals. The length of the each
sub interval is 0.1. The modiﬁed correlation function TCF O(d)
is given by
(13)
TCF O(d) =
p=P
X
p=1




N−1
X
n=0
M−1
X
m=0
r⋆ (d + n + mN)
xm (n) e(j2π(i(p))(n+mN)/N)

2


where i(p) takes equally spaced points within the interval
[−I, I]. The spacing between two successive points is 0.1. i(p)
is deﬁned as
i (p) = − I + (p − 1) 0.1
(14)
i (P) =I
(15)
where 1 ≤ p ≤ P and P = B + 1. The estimated start of the
frame is given by
ˆθt = max
d
[TCF O (d)]
(16)
Note that in the special case of M = 1 in (13) TCF O(d)
becomes
TCF O(d) =
p=P
X
p=1

N−1
X
n=0
r⋆ (d + n) x0 (n) e(j2π(i(p))n/N)

2
(17)
Now (17) is the proposed timing estimation method using
one preamble, which is independent of the structure of the
preamble. Note that (17) gives better performance than (12) in
the presence of CFO.
In the proposed method the computational complexity is
high as the range of CFO increases because as the value of
I increases, the value of P is also increases. If the estimated
start of the frame ˆθt satisﬁes the condition 1 ≤ ˆθt ≤ L then the
frame is processed further, otherwise frame is discarded and
considered as an erasure. Let F1 be the total number of frames
that is considered as erasure and F2 be the total number of
frames that is transmitted. Probability of erasure (PE) is given
by
PE = F1
F2.
(18)
Let the number of detected frames is given by
F = F2 − F1.
(19)
The mean squared error (MSE) of the detected frames is given
by
MSE =
PF −1
f=0

θtf − ˆθtf
2
F
(20)
where θtf is the maximum absolute value of the channel
impulse response for the fth detected frame given by
θtf = max (abs (hf))
(21)
where hf is the channel impulse response for the fth detected
frame and ˆθtf is the estimated start of the fth detected frame.
Let F3 be the total number of frames for which ˆθt = θt,
then the probability of correct estimation P(ˆθt = θt) is given
by
P(ˆθt = θt) = F3
F2
(22)
where θt is the maximum absolute value of the channel
impulse response for a given frame, given by
θt = max (abs (h))
(23)
where h is the channel impulse response for a given frame
and ˆθt is the estimated start of that frame.
81
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

IV.
SIMULATION RESULTS AND DISCUSSION
In this section, the performance of the proposed method
is compared with the major existing timing synchronization
methods [8]–[13] for OFDM systems, which work independent
of the structure of the preamble.
0
5
10
15
20
25
30
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR per bit (dB)
Probabilty of erasure (PE)
 
 
Kang [8]
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Hamed [11]
Proposed M=2
Figure 2: Probability of erasure of different estimators using ran-
domly generated preamble in the presence of CFO
[(M=1,2), I=0.5, P=11]
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR per bit (dB)
Probability of correct estimation
 
 
Kang [8]
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Hamed [11]
Proposed M=2
Figure 3: Probability of correct estimation of different estimators
using randomly generated preamble in the presence of CFO
[(M=1,2), I=0.5, P=11]
We have assumed N=64 and performed the simulations
over 5 ∗ 105 frames. QPSK signaling is assumed. A frequency
selective Rayleigh fading channel is assumed with L = 5
path taps and path delays µl = l for l = 0, 1, ..., 4. The
channel has an exponential power delay proﬁle (PDP) with
an average power of exp (−µl/L). The CFO takes random
0
5
10
15
20
25
30
10
−2
10
−1
10
0
10
1
SNR per bit (dB)
MSE
 
 
kang [8]
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Hamed [11]
Proposed M=2
Figure 4: Timing MSE of different estimators using randomly gen-
erated preamble in the presence of CFO [(M=1,2), I=0.5,
P=11]
0
5
10
15
20
25
30
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR per bit (dB)
Probabilty of erasure (PE)
 
 
Schmidl [3]
Kang [8]
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Figure 5: Probability
of
erasure
of
different
estimators
using
Schmidl’s preamble in the presence of CFO [M=1, I=0.5,
P=11]
value within the range [−I, I] and it varies independently from
frame to frame. For the methods presented in [9] [10], we
have considered all the available correlation points without
repetition, i.e., N(N−1)/2=2016 and for the method presented
in [11] we have considered all the available correlation points
utilized by two preambles, i.e., N 2=4096. In order to compare
with [8]–[10] [12], we consider M=1 and to compare with [11]
we consider M=2. In Fig. 2, Fig. 3 and Fig. 4 probability of
erasure, probability of correct estimation and timing MSE of
the proposed method is compared with major existing timing
synchronization methods in the presence of CFO using a ran-
domly generated preamble. One randomly generated preamble
is used for the methods presented in [8]–[10] [12] and the
82
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR per bit (dB)
Probability of correct estimation
 
 
Schmidl [3]
Kang [8]
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Figure 6: Probability of correct estimation of different estimators
using Schmidl’s preamble in the presence of CFO [M=1,
I=0.5, P=11]
0
5
10
15
20
25
30
10
−2
10
−1
10
0
10
1
SNR per bit (dB)
MSE
 
 
Schmidl [3]
Kang [8]
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Figure 7: Timing MSE of different estimators using Schmidl’s pream-
ble in the presence of CFO [M=1, I=0.5, P=11]
proposed method with M=1 and two randomly generated
preambles are used for the method presented in [11] and the
proposed method with M=2. We assume I = 0.5 and in the
proposed method P = 11. From Fig. 2, Fig. 3 and Fig. 4,
it is observed that proposed method performs better than the
existing methods in the presence of CFO. Note that in the
presence of CFO (I ̸= 0) with M = 1 in the proposed
method, there is a signiﬁcant improvement in the performance
as compared to method presented in [12]. In Fig. 5 to Fig. 13,
the probability of erasure, probability of correct estimation and
timing MSE of the proposed method is compared with the
major existing timing synchronization methods, for different
preambles. In Fig. 5 to Fig. 7, the Schmidl’s preamble is used
considering M = 1. In Fig. 8 to Fig. 10, the Minn’s preamble
0
5
10
15
20
25
30
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR per bit (dB)
Probabilty of erasure (PE)
 
 
Minn [3]
Kang [8]
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Figure 8: Probability of erasure of different estimators using Minn’s
preamble in the presence of CFO [M=1, I=0.5, P=11]
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR per bit (dB)
Probability of correct estimation
 
 
Minn [4]
Kang [8]
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Figure 9: Probability of correct estimation of different estimators
using Minn’s preamble in the presence of CFO [M=1, I=0.5,
P=11]
is used considering M = 1 and in Fig. 11 to Fig. 13, both
Schmidl’s and Minn’s preamble are used considering M = 2.
We assume I = 0.5 and in the proposed method P = 11.
From Fig. 5 to Fig. 13, we ﬁnd that the proposed method
gives the best performance. In ﬁg. 14, probability of erasure
of different estimators along with the proposed method are
compared with the method proposed in [13] assuming M = 1.
Randomly generated preamble is used. A 10 tap channel with
uniform power delay proﬁle is considered. Preamble length
( N) is assumed as 128 and the number of OFDM frames
simulated is 5 ∗ 105. We assume I is 3.2. For the methods
presented in [9] [10], we have considered all the available
correlation points without repetition, i.e., N(N − 1)/2=8128.
83
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

0
5
10
15
20
25
30
10
−2
10
−1
10
0
10
1
SNR per bit (dB)
MSE
 
 
Minn [4]
Kang [8]
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Figure 10: Timing MSE of different estimators using Minn’s pream-
ble in the presence of CFO [M=1, I=0.5, P=11]
0
5
10
15
20
25
30
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR per bit (dB)
Probability of erasure(PE)
 
 
Schmidl [3]
Minn [4]
Hamed [11]
Proposed M=2
Figure 11: Probability
of
erasure
of
proposed
estimator
using
Schmidl’s and Minn’s preamble in the presence of CFO
[M=2, I=0.5, P=11]
In the proposed method P = 65 . It is observed that [13] gives
the best performance since it is the optimum method.
V.
CONCLUSION
In this paper, a new timing estimation method using
multiple preambles has been proposed and the performance
is investigated in the presence of CFO. It is observed that the
proposed method performs better than most of the existing
methods in the presence of CFO.
REFERENCES
[1]
K. Vasudevan, “Coherent detection of turbo-coded ofdm signals trans-
mitted through frequency selective rayleigh fading channels with re-
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR per bit (dB)
Probability of correct estimation
 
 
Schmidl [3]
Minn [4]
Hamed [11]
Proposed M=2
Figure 12: Probability of correct estimation of proposed estimator
using Schmidl’s and Minn’s preamble in the presence of
CFO [M=2, I=0.5, P=11]
0
5
10
15
20
25
30
10
−2
10
−1
10
0
10
1
SNR per bit (dB)
MSE
 
 
Schmidl [3]
Minn [4]
Hamed [11]
Proposed M=2
Figure 13: Timing MSE of proposed estimator using Schmidl’s and
Minn’s preamble in the presence of CFO [M=2, I=0.5,
P=11]
ceiver diversity and increased throughput,” Wireless Personal Commu-
nications, vol. 82, no. 3, pp. 1623–1642, 2015.
[2]
K. Vasudevan, Digital communications and signal processing.
Uni-
versities Press, 2007.
[3]
T. M. Schmidl and D. C. Cox, “Robust frequency and timing synchro-
nization for OFDM,” IEEE Transactions on Communications, vol. 45,
no. 12, pp. 1613–1621, 1997.
[4]
H. Minn, M. Zeng, and V. K. Bhargava, “On timing offset estimation
for OFDM systems,” IEEE Communications Letters, vol. 4, no. 7, pp.
242–244, 2000.
[5]
B. Park, H. Cheon, C. Kang, and D. Hong, “A novel timing estimation
method for OFDM systems,” IEEE Communications Letters, vol. 7,
no. 5, pp. 239–241, 2003.
[6]
J. Kim, J. Noh, and K. Chang, “Robust timing & frequency synchro-
84
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

nization techniques for OFDM-FDMA systems,” in Signal Processing
Systems Design and Implementation, IEEE Workshop, pp. 716–719,
2005.
[7]
G. Ren, Y. Chang, H. Zhang, and H. Zhang, “Synchronization method
based on a new constant envelop preamble for OFDM systems,” IEEE
Transactions on Broadcasting, vol. 51, no. 1, pp. 139–143, 2005.
[8]
Y. Kang, S. Kim, D. Ahn, and H. Lee, “Timing estimation for OFDM
systems by using a correlation sequence of preamble,” IEEE Transac-
tions on Consumer Electronics, vol. 54, no. 4, pp. 1600–1608, 2008.
[9]
H. Abdzadeh-Ziabari, M. G. Shayesteh, and M. Manaffar, “An improved
timing estimation method for OFDM systems,” IEEE Transactions on
Consumer Electronics, vol. 56, no. 4, pp. 2098–2105, 2010.
[10]
H. Abdzadeh-Ziabari and M. G. Shayesteh, “Robust timing and fre-
quency synchronization for OFDM systems,” IEEE Transactions on
Vehicular Technology, vol. 60, no. 8, pp. 3646–3656, 2011.
[11]
H. Abdzadeh-Ziabari, M. G. Shayesteh, “A novel preamble-based frame
timing estimator for OFDM systems,” IEEE Communications Letters,
vol. 16, no. 7, pp. 1121–1124, 2012.
[12]
U. Samal and K. Vasudevan, “Preamble-based timing synchronization
for OFDM systems,” in Advance Computing Conference (IACC), IEEE
3rd International, pp. 313–318, 2013.
[13]
K. Vasudevan, “Coherent detection of turbo coded ofdm signals trans-
mitted through frequency selective rayleigh fading channels,” in Signal
Processing, Computing and Control (ISPCC), IEEE International Con-
ference, pp. 1–6, 2013.
0
1
2
3
4
5
6
7
8
9
10
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR per bit (dB)
Probability of erasure(PE)
 
 
Hamed [9]
Method [12]
Hamed [10]
Proposed M=1
Method [13]
Figure 14: Probability of erasure of different estimators using ran-
domly generated preamble in the presence of CFO [M=1,
I=3.2, P=65]
85
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-514-2
ICWMC 2016 : The Twelfth International Conference on Wireless and Mobile Communications (includes QoSE WMC 2016)

