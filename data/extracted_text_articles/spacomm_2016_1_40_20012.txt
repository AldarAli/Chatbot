Mode Selection Algorithm for Advanced TOA Trilateration Techniques 
 
Sajina Pradhan 
Dept. of Advanced Parts and Materials Engineering 
Chosun University 
Gwangju, Republic of Korea  
sajinapra@hotmail.com 
Suk-seung Hwang  
Dept. of Electronic Engineering 
Chosun University 
Gwangju, Republic of Korea  
hwangss@chosun.ac.kr (corresponding author)
 
 
Abstract—The location detection technology (LDT) with 
various applications is one of the core techniques for the 
mobile communication system. The time-of-arrival (TOA) 
trilateration, which is a representative approach of network-
based LDTs, estimates the location of a mobile station (MS) 
using an intersection point of three circles based on signals 
from at least three base stations (BS). Since the distance 
between MS and BS is generally estimated by the number of 
delay samples and it is an integer number, the radius of circles 
is usually increased and three circles may not meet at a point, 
which results in the serious estimation error. In order to 
overcome this problem, the shortest distance and the line 
intersection algorithms for the general case and the 
comparison approach of intersection distances for the specific 
case have been recently proposed. In this paper, we provide the 
selection methodology between these two cases for using the 
line intersection algorithm or the comparison approach of 
intersection distances, for the MS location estimation. The 
selection procedure for both cases is based on comparing the 
radiuses of two large circles to distances between four 
intersection points of a small circle with others and center 
coordinates of corresponding large circles. 
Keywords-location detection; time-of-arrival; trilateration; 
mode selection; three circles intersection. 
I. 
 INTRODUCTION 
Recently, the location estimation of MS has received a 
great attention, because a lot of information related to the 
MS location is being utilized in many communication 
services such as location based services (LBS). More and 
more researches focus on estimating the accurate MS 
location with the low cost, the high performance, and the 
reliability of the components. In USA, the MS location 
estimation should follow the requirement of locating 
emergency 911 (E-911) services [1]. LBSs involve the 
ability to find the geographical location of MS and provide 
services based on its location. The main objective of these 
services is to assist with the exact information in real time at 
the right place likes finding patient, children, elder person, 
transportation services, location of food court, and necessary 
things [2]-[6]. 
For estimating the location of MS, several techniques are 
commonly utilized based on the received signal strength 
(RSS), TOA, angle of arrival (AOA), and time difference of 
arrival (TDOA) [7][8]. The TOA trilateration method, which 
is one of representative location estimation approaches, 
estimates the MS location using the intersection point of 
three circles with their centers corresponding BS coordinates 
and radiuses corresponding the distances between MS and 
BSs. However, since we generally estimate the distance 
between MS and BS counting the number of delay samples, 
which is an integer, the estimated distance may be slightly 
increased and three circles based on the radiuses 
corresponding to the estimated distance may not intersect at 
a single point. Therefore, three circles have total six 
intersection points causing estimation error for the accurate 
location of MS. In order to solve this problem, recently, the 
shortest distance algorithm [9] and the line intersection 
algorithm [10] have been proposed for the general case. In 
general, 
the 
line 
intersection 
algorithm 
has 
better 
performance than the shortest algorithm, because it considers 
the increasing factor of the estimated circles. However, its 
estimation performance may be degraded for the specific 
case, in which a small circle is located inside the area of two 
large circles and it intersects two large circles at four 
intersection points. In order to improve this problem, the 
comparison approach of intersection distances for the 
specific case has been proposed in [11]. It calculates four 
distances between two neighbor intersections among four 
intersection points of a small circle and two large circles, and 
compares them. From the compared result, we select the 
shortest distance and determine the averaged coordinate of 
two intersection points corresponding to the shortest distance 
as the estimated location of MS.  
Although this approach has better performance than the 
line intersection algorithm for the general case, it has worse 
performance than the line intersection algorithm for the 
above specific case. Thus, we should select better algorithm 
according to both cases for the optimized performance. In 
this paper, we propose a mode selection algorithm for using 
the line intersection algorithm or the comparison approach of 
intersection distances, according to two cases of the general 
case or the specific case. In order to select the proper mode 
between both approaches, the proposed algorithm considers 
four intersection points related to a small circle and other two 
large circles. Note that we consider three circles with a small 
circle and two large circles in the specific case. For the 
proposed method, we calculate the distance between one of 
four intersection points and the center of the circle which is 
not related to the corresponding intersection. We repeat the 
previous calculation for all four intersections and get four 
distances from the calculated results. Finally, this algorithm 
compares each distance to the radius of the circle related to 
18
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-453-4
SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)

the center used to calculating its distance. If all four distances 
are shorter than the corresponding radiuses, we determine 
that it is the specific case and select the comparison approach 
of intersection distances for the advanced TOA trilateration 
technique. However, if at least one distance is longer than 
them, we determine that it is the general case and select the 
line intersection algorithm. 
The rest of the paper is organized as follow: Section II 
describes TOA trilateration algorithms, i.e. the line 
intersection algorithm for the general case and the 
comparison approach of intersection distances for the 
specific case. Section III describes the proposed mode 
selection algorithm for differentiating the general case and 
the specific case. The performance of the proposed algorithm 
is discussed by computer simulation results in Section IV. 
Finally, the conclusion is presented in Section V. 
II. 
ADVANCED TOA TRILATERATION ALGORITHMS  
The trilateration technique estimates the location of MS 
using the intersection points of three circles based on 
radiuses corresponding to distances between MS and BSs 
and center corresponding to coordinates of BSs. The 
Euclidean distance between MS and the 𝑖th BS is given by 
           𝑟𝑖 = ඥ(𝑥 − 𝑥𝑖)2 + (𝑦 − 𝑦𝑖)2     𝑖 = 1, 2, 3 
(1) 
where (𝑥, 𝑦) is the true coordinate of MS and (𝑥𝑖, 𝑦𝑖) is the 
coordinate of the 𝑖th BS. The location of MS is determined 
by a unique intersection point of three circles, shown in 
Figure 1. The distance between MS and BS is usually 
estimated counting the number of time delay samples. Since 
that number must be an integer, it is given by  
                 𝑛𝑖 = ceil ቀ
𝑟𝑖
𝑐 × 𝑓ቁ                                   (2) 
where 𝑛𝑖 is the number of delay samples, “ceil” is the round 
up function used to make an integer value, 𝑓  is the particular 
carrier frequency, and 𝑐  is the velocity of the light. The 
increased distance between MS and BS due to counting the 
number of delay samples, 𝑒𝑑𝑖, is given by 
                                   𝑒𝑑𝑖 =
𝑛𝑖×𝑐
𝑓  .      
(3) 
Since the radius of circle may be increased by the increased 
distance, three circles may not meet at a single point and they 
have six intersection points, which results in the location 
estimation error shown in Figure 2. In order to solve this 
problem, recently, a couple of algorithms have been 
proposed. In this paper, we consider two advanced TOA 
trilateration algorithms such as the line intersection 
algorithm having good performance in the general case and 
the comparison approach of intersection distances having 
good performance in the specific case. 
A. Line Intersection Algorithm 
Three circles based on the estimated distances between 
MS and BSs do not intersect at a unique point, because each  
 
Figure 1.  Three intersecting circles to locate MS at a unique point in the  
general case. 
TABLE I.  
LINE IINTERSECTION ALGORITHM 
1. 
Calulate the estimated distance between each BS and MS  
after counting number of time delay sample, and is given by 
𝑒𝑑𝑖 =
𝑛𝑖 × 𝑐
𝑓  . 
2. 
Generate three circle equations using estimated distance 
𝑥ො2 + 𝑦ො2 + 𝑎𝑖𝑥ො + 𝑏𝑖𝑦ො + 𝑐𝑖 = 0 
where 𝑎𝑖 = −2𝑥𝑖, 𝑏𝑖 = −2𝑦𝑖, 𝑎𝑛𝑑 𝑐𝑖 = 𝑥𝑖
2 + 𝑦𝑖
2 − 𝑒𝑑𝑖
2. 
3. 
Obtain the estimated location of MS (𝑥ො, 𝑦ො), using 
𝑥ො =
(𝑐2−𝑐1)(𝑏2−𝑏3)−(𝑐3−𝑐2)(𝑏1−𝑏2)
(𝑎1−𝑎2)(𝑏2−𝑏3)−(𝑎2−𝑎3)(𝑏1−𝑏2),
 
and 
𝑦ො =
(𝑎1−𝑎2)(𝑐3−𝑐2)−(𝑐2−𝑐1)(𝑎2−𝑎3)
(𝑎1−𝑎2)(𝑏2−𝑏3)−(𝑎2−𝑎3)(𝑏1−𝑏2). 
 
 
Figure 2.  Line intersection at a single point to estimate MS location in the 
general case. 
radius corresponding the estimated distance is generally 
increased comparing to the original radius. Based on the 
calculated radiuses, they meet at six intersection points. 
From the six relevant intersection points, we make three 
straight lines which connect two intersection points for 
specific two circles among entire three circles.These three 
19
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-453-4
SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)

straight lines must meet at a point and this algorithm 
determines the intersection point of three lines as the 
location of MS as shown in Figure 2. Table I summarizes 
the line intersection algorithm in the general case. 
B. Comparison Approach of Intersection  Distances 
Although the line intersection algorithm has good 
performance for estimating the MS location in general case, 
it may have the poor performance in the specific case, where 
a small circle is located in the area of two large circles, 
shown in Figure 3. In order to improve this problem, the 
comparison approach of intersection distances has been 
proposed, specialized in the specific case. This algorithm 
focuses on distances between two neighboring points of four 
interior intersections related to a small circle, among six 
entire intersection points, shown in Figure 4. First of all, it 
calculates two distances between two sets of points. They are 
calculated from two intersecting points of the small circle 
with one large circle to the neighboring intersection points of 
the small circle and another large circle. After calculating 
two distances, we compare them and select the shorter 
distance. Finally, this algorithm determines the averaged 
coordinate of two intersections corresponding to the shorter 
distance as the MS location.  
 
Figure 3.  Three intersecting circles to locate MS at a unique point in the 
specific case 
 
 
Figure 4.  Three intersecting circles with the increased radius in the 
specific case. 
TABLE II.  
COMPARISON APPROACH OF  INTERSECTION DISTANCES 
1. Initialize the circles C1, C2, and C3, based on centers of BSs 
and radiuses equal to estimated distances.  
2. Find all six intersections coordinate points I, J, K, I’, J’, and 
K’. 
3. Take two intersection points of a small circle C3 with two 
large circles C1 and C2 (J’, K’) and calculate distance 
between two points (distance between J’ and K’). 
4. Repeat step 3 for other intersection points (J, K). 
5. Compare two distances ((distance J’K’) and (distance J K)). 
6. Select the shorter distance between two distances. 
7. Take two intersection points corresponding to the selected 
distance. 
8. Calculate the averaged coordinate of two intersection points 
and determine it as the estimated MS location, given 
by           𝑥ො =
𝐽𝑥 ′+ 𝑘𝑥′
2
,      𝑦ො =
𝐽𝑦 ′+ 𝑘𝑦′
2
. 
The detail step of comparison approach of intersection 
distances algorithm has been summarized in Table II. 
III. 
MODE SELECTION ALGORITHM 
The line intersection algorithm and the comparison 
approach 
of 
intersection 
distances 
have 
the 
good 
performance for estimating the MS location for the general 
case and the specific case, respectively. For the optimized 
location estimation, we should select an algorithm between 
both according to the case. In this section, we propose the 
mode selection algorithm for distinguishing the general case 
and the specific case. If the algorithm selects the general case, 
it employs the line intersection algorithm for estimating the 
MS location. However, if it selects the specific case, it 
employs the comparison approach of intersection distances. 
In order to select the case mode, the proposed algorithm 
calculates four distances related to centers of two large 
circles and four intersection points of a small circle with two 
large circles. Each distance is calculated from the center of 
each large circle to the intersection of the small circle with 
another large circle, defined as  
𝑑𝑙𝑘 = ඥ(𝑥𝑙 − 𝑥𝑘)2 + (𝑦𝑙 − 𝑦𝑘)2    𝑙 = 1, 2, 𝑘 = 1, 2,   (4) 
where (𝑥𝑙, 𝑦𝑙) is a coordinate of the 𝑙th large circle and 
(𝑥𝑘, 𝑦𝑘) is a coordinate of the intersection point of the 
small circle with another large circle. Next, the distances 
related to the 𝑙th large circle are compared to the radius of 
the 𝑙th large circle; 𝑑11 and 𝑑12 are compared to 𝑟1 and 𝑑21 
and 𝑑22 are compared to 𝑟2. If all distances related to the 𝑙th 
large circle are shorter than the radius of the 𝑙th large circle 
(𝑑11 and 𝑑12 are shorter than 𝑟1 and 𝑑21 and 𝑑22 are shorter 
than 𝑟2), it selects the specific case mode and employs the 
comparison approach of intersection distances. Otherwise, it 
selects the general case mode and employs the line 
intersection algorithm.  
 
 
20
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-453-4
SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)

 
Figure 5.  Flow chart for the mode selection algorithm. 
TABLE III.  
MODE SELECTION ALGORITHM  
1. 
Find the two intersection points (J, J’) formed by the small 
circle C3 intersected with the large circle C2. 
2. 
Calculate the distances from the center of the large circle C1 
(x1,y1) to the two intersection points (J, J’), given by 
𝑑1𝑘 = ඥ(𝑥1 − 𝑥𝑘)2 + (𝑦1 − 𝑦𝑘)2    𝑘 = 1, 2. 
3. 
Find the two intersection points (K, K’) formed by small circle 
C3 intersected with the large circle C1. 
4. 
Calculate the distances from the center of the large circle C2 
(x2,y2) to the two intersection points (K, K’), given by 
𝑑2𝑘 = ඥ(𝑥2 − 𝑥𝑘)2 + (𝑦2 − 𝑦𝑘)2   𝑘 = 1, 2. 
5. 
Compare the radius of C1, r1, to d11 and d12. 
6. 
Compare the radius of C2, r2, to d21 and d22. 
7. 
a.  d11 < r1 and d12 < r1, and d21 < r2 and d22 < r2 
                 ☞ Specific Mode (employing comparison approach of 
intersection distances) 
            b. Otherwise 
                 ☞ General Mode (employing line intersection Algorithm) 
Figure 5 shows a flow chart for the proposed mode 
selection algorithm and Table III summarizes steps of the 
algorithm. Using this mode selection algorithm, we may get 
the optimized performance for estimating the location of 
MS for the general case and the specific case.  
IV. 
COMPUTER SIMULATIONS 
In this section, we provide computer simulation results to 
illustrate the location estimation performance for the 
proposed approach. For the simulation, we consider three 
fixed BSs and two cases for coordinates of BSs and MS for 
distinguishing the general case and the specific case:  
1. General case: three BSs with coordinates of (-1000, 
5000), (6000, -3000), and (-7000, 600). 
2. Specific case: three BSs with coordinates of (-3000, 
5000), (1500, 3000), and (7000, 600). 
The unit of the coordinate is meter (m) and we consider the 
different carrier frequencies of 50MHz, 100MHz, 500MHz, 
1GHz, 5GHz, and 10GHz. Also, we consider two scenarios 
for the occurrence possibility of the general case and the 
specific case: 
1. First scenario: 90% general case and 10% specific case. 
2. Second scenario: 95% general case and 5% specific 
case. 
We assume that the MS location coordinate is randomly 
chosen with ranges from -100 to 100 and from -500 to 500 
for the first case and the second case, respectively. 
The performances of the location estimation algorithm 
are evaluated by the mean square error (MSE). The error 
between the true MS position and the estimated MS position 
is defined as 
𝐸𝑟𝑟𝑜𝑟𝑃𝑜𝑠𝑖𝑡𝑖𝑜𝑛 = ඥ(𝑥 − 𝑥ො)2 + (𝑦 − 𝑦ො)2  
(5) 
and MSE for estimating the MS position is given by 
MSE𝑃𝑜𝑠𝑖𝑡𝑖𝑜𝑛 = 𝐸[𝐸𝑟𝑟𝑜𝑟𝑃𝑜𝑠𝑖𝑡𝑖𝑜𝑛
2
]. 
 
(6) 
The simulation results of the MSE for the MS location 
estimation verses frequencies for the first scenario are shown 
in Figures 6 and 7, for the first and second cases, 
respectively. In addition, the simulation results of the MSE 
for the MS location estimation verses frequencies in the 
second scenario are shown in Figures 8 and 9, for the first 
and second cases, respectively. From figures, we observe 
that the MSE of the advanced TOA trilateration based on the 
mode selection algorithm is lower than the MSE of that 
based on only the line intersection algorithm. Note that the 
difference between two curves for the first scenario is larger 
than the difference for the second scenario, because the 
occurrence possibility of the specific case in the first 
scenario is higher than it in the second scenario. 
V. 
CONCLUSION 
The line intersection algorithm has good location 
estimation performance for the general case, but it may have 
the serious location estimation error for the specific case, 
where a small circle is located in the area of two large circles. 
Although the comparison approach of intersection distances 
has worse performance for estimating the MS location 
compared to the line intersection algorithm in the general 
case, it has good performance in the specific case. In order to 
alternately use both algorithms according to the proper case, 
in this paper, we proposed the mode selection algorithm. The 
21
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-453-4
SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)

proposed algorithm compares the distances between the 
intersection points of the small circle and one large circle to 
the radius of another large circle. If all distances are shorter 
than the corresponding radiuses, it selects the specific case 
mode and employs the comparison algorithm of intersection 
distances. Otherwise, it selects the general case and employs 
the line intersection algorithm. The performance for the 
proposed algorithm was illustrated through computer 
simulations. 
 
Figure 6.  MSE curves for the first scenario for the first case 
 
Figure 7.  MSE curves for the first scenario for the second case 
 
Figure 8.  MSE curves for the second scenario for the first case. 
 
Figure 9.  MSE curves for the second scenario for the second case. 
ACKNOWLEDGMENT 
This research was supported by Basic Science Research 
Program through the National Research Foundation of 
Korea (NRF) funded by the Ministry of Education, Science 
and Technology (No. 2015-053557 and No. NRF-
2015R1D1A1A01058827). 
REFERENCES 
[1] F. C. Commission, “Revision of the Commission’s Rules to 
Insure Compatibility with Enhanced 911 Emergency Calling 
Systems,” FCC Docket No. 94-102, July 1996. 
[2] C. Drane, M. Macnaugton, and C. Scott, “Positioning GSM 
Telephones,” IEEE Communications Magazine, vol. 36, no. 4, 
April 1998, pp. 46-59. 
[3] Y. Zhao, “Standardization of Mobile Phone Positioning for 
3G Systems,” IEEE Communications Magazine, vol. 40, July 
2002, pp. 108-116. 
[4] J. J. Caffery, “Wireless Location in CDMA Cellular Radio 
Systems,” Kluwer Academic Publishers, Boston, Mass, USA 
2000. 
[5] H. Koshima and J. Hoshen, “Personal locator services 
emerge,” IEEE Spectrum, vol. 37, no. 2, February 2000, pp. 
41-48. 
[6] A. Kupper, “Location based services fundamentals and 
operation,” John wiley & Sons Ltd, The Atrium, Southern 
Gate, Chichester, West Sussex PO19 8 SQ, England, 2005. 
[7] J. M. Zagami, S. A. Parl, J. J. Bussgang, and K. D. Melillo, 
“Providing Universal Location services using a wireless E911 
location  Network,” IEEE Communications Magazine, April 
1998, pp. 66-71. 
[8] S. Tekinay, E. Chao, and R. Richton, “Performance 
Benchmarking for Wireless Location Systems,” IEEE 
Communications Magazine, April 1998, pp. 72-76. 
[9] S. Pradhan and S. S. Hwang, “A TOA Shortest Distance 
Algorithm for Estimating Mobile Location,” The Journal of 
the 
Korea 
Institute 
of 
Electronic 
Communication 
Sciences, vol. 8, no. 12, 2013, pp. 1883-1890. 
[10] S. Pradhan, S. S. Hwang, H. R. Cha, and Y. C. Bae, “Line 
Intersection Algorithm for the Enhanced TOA Trilateration 
Technique,” International Journal of Humanoid Robotics, vol. 
11, no. 4, 2014, pp. 1442003. 
[11] S. Pradhan and S. S. Hwang, “TOA trilateration algorithm 
based on comparison of intersection distances,” The 16th 
International Symposium on Advanced Intelligent Systems, 
November  2015. 
22
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-453-4
SPACOMM 2016 : The Eighth International Conference on Advances in Satellite and Space Communications (includes RESENS 2016)

