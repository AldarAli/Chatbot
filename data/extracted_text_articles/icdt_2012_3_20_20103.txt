A LUT Baseband Digital Pre-Distorter For Linearization
∗Feng Li, ∗§Bruno Feuvrie, ∗Yide Wang, ∗§Anne-Sophie Descamps
∗L’UNAM Universit´e - Universit´e de Nantes, UMR CNRS 6164 Institut d’Electronique et
de T´el´ecommunications de Rennes (IETR), Ecole polytechnique de l’universit´e de Nantes,
Rue Christian Pauc - La Chantrerie BP 50609, 44306 Nantes Cedex 3 France
§IUT GEII Nantes - Site Fleuriaye, Av. du Prof J. Rouxel, 44475 Carquefou, France
feng.li@etu.univ-nantes.fr;
Bruno.Feuvrie@univ-nantes.fr;
Yide.Wang@univ-nantes.fr;
Anne-Sophie.Bacquet@univ-nantes.fr
Abstract—This paper proposes a Look-Up-Table Digital Pre-
Distorter (LUT DPD) for PA linearization with baseband
predistorting procedure. Memory effect can be compensated
with Memory Polynomial (MP) modelisation for the wideband
applications. Measurements are realized on a PA ZFL-2500
driven by a modulated 16QAM signal with 3.84MHz bandwidth
at the carrier frequency of 1.8GHz. The proposed solution
achieves maximum ACPR reduction of 12.5dB and EVM
correction of 3%.
Keywords-power ampliﬁer; baseband predistortion procedure;
nonlinear memory effect; digital predistortion; linearization.
I. INTRODUCTION
Modern wireless communication systems aim to provide
sevices of high data rates for the applications such as
video conference, broadcast TV. Constrained by the limited
radio frequence resource, spectrally efﬁcient modulation
schemes (OFDM, etc.) are widely used in order to increase
system capacity. Unfortunately, the resulted non-constant-
envelope signals with high Peak-to-Average Power Ratio
(PAPR) become more sensitive to the inherent nonlinearity
of Power Ampliﬁer (PA) [3]. Thus, a tradeoff between
spectrum efﬁciency and power efﬁciency must be made.
The memory effect increases the distortions on the output
signal. The origins of memory effect can be thermal or
electrical. Electrical origin is mainly caused by the mismatch
of circuit impendence, due to capacitors and resistances. The
thermal origin due to the temperature variation may affect
low modulation frequencies up to a few megahertz. There-
fore, the nonlinear memory effect is device dependant (bias
condition, temperature, et) and signal dependant (signal’s
PAPR, average power, bandwidth, etc).
Digital Pre-Distortion (DPD) is one of the promising
techniques for minimizing these distortions. Its advantages
lie in the fact that it is reconﬁgurable and doesn’t require
deep knowledge of PA’s physic circuits [1]. In order to deﬁne
the predistorting procedure, we need to ﬁnd a precise model
to exactly describe the nonlinear memory effect behavior of
the PA.
Figure 1 illustrates the basic principle of DPD. A digital
predistortion circuit is inserted before the PA. Then, the over-
all system produces linearized characteristic. The objective is
to efﬁciently determine the predistorted signal e(nT), which
is also the new input of the PA. With ideal linearization, the
output of the DPD-PA cascade S(nT) can be written as:
S(nT) = G(F(x(nT))) = G0x(nT)
(1)
where x(nT) is the input signal; G represents the nonlinear
behavior of the PA, F the behavior of the DPD, which is
also the inversed characteristic of G; G0 is the desired linear
gain.
Figure 1.
DPD principle
In [5], a baseband DPD based on the Hammerstein
model is proposed to linearize the PAs. However this DPD
presents two disadvantages. Firstly, the Hammerstein model
implicitly separates the memory effect from the nonlinearity.
I practice these two effects are often closely related. Sec-
ondly, the complex root-ﬁnding procedure for ﬁnding the
amplitude of predistorted signal is not adaptive for the real-
time systems. In this paper, we use the MP model to better
model the nonlinear memory effect behavior of the PAs and
a LUT technique is proposed to avoid the complex root-
ﬁnding procedure. In section II, the principle of baseband
DPD is presented. Based on the baseband signal processing,
in section III, the modelisation and the LUT technique are
illustrated in detail. In section IV, the measurement is shown.
Finally the conclusions and the perspectives are presented.
55
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-193-9
ICDT 2012 : The Seventh International Conference on Digital Telecommunications

II. PRINCIPLE OF BASEBAND DPD
Predistorting procedure can be classiﬁed into three cat-
egories: baseband, Intermediate Frequency (IF) and Radio
Frequency (RF). RF predistorter suffers from constrained
adaptivity to the variable PA characteristics, due to its
high frequency (considered from 800MHz to several GHz
for radio communication systems). For IF predistorter, the
development of Digital Signal Processing (DSP) still cannot
sustain the high sampling frequency to digitize the IF
signals. Furthermore, higher power consumption is required
for RF/IF predistorters than the baseband predistorters. This
affects the ﬂexibility, the size, the mobility, the cost, and the
communication quality [2].
Table I
BANDWIDTH FOR DIFFERENT STANDARDS
Standards
Bandwidth
Digital Advanced Mobile Phone System
25kHz
Global System for Mobile Communications
200kHz
Interim Standard 95
1.25MHz
Universal Mobile Telecommunications System
5MHz
Digital Video Broadcasting - Terrestrial
8MHz
3GPP Long Term Evolution and WiMAX
Up to 20MHz
802.11a/g
25MHz
Emerging 4G systems
up to 100MHz
Compared
with
RF/IF
predistorters,
baseband
DPD
presents higher adaptivity to these various parameters. DPD
is a DSP-based PD technique. Beneﬁting from the develop-
ment of DSP technology, DPD can theoretically to process
signal bandwidth greater than 1GHz. But in practice, it is
constrained to less than 100MHz [6] for complexity and cost
reasons. Baseband predistorting procedure operates on the
input signals in baseband frequency, where it is much easier
to construct the inversed characteristics [4]. Bandwidths for
typical standards are illustrated in Table I. This technique
can be applied to different standards and further developed
to emerging 4G systems. DPD is added in the stage prior to
the DAC and the up-conversion before the PA.
Figure 2.
Baseband DPD System Design
Figure 2 presents the typical baseband DPD system
design. For the nonlinear system, the gain of the PA G
presents device-dependant and signal-dependant character-
istics, which can be described as:
G = G(B, |x(nT)|, fc, T . . . )
(2)
here B is the bandwidth of input signal x(nT), fc illustrates
the carrier frequency, T represents the temperature.
The nonlinear RF output of PA SR(nT) is down converted
to baseband S(nT) to be compared with the baseband input
x(nT) and to obtain the inversed nonlinear behavior of PA
F:
F = G−1
G0
(3)
In order to compensate the nonlinear memory effect in
wideband systems, the baseband input sample x(nT) is
predistorted in DPD (Figure 1):
e(nT) = F(x(nT))
(4)
The predistorted output signal e(nT) is then directly up
converted to RF eR(nT) (equation (5)) to be ampliﬁed
by the PA. Finally, the PA’s linearized output SRL(nT)
(equation (6)) is radiated by the antenna to transmit the
messages.
The signal eR(nT) can be expressed as:
eR(nT) =Re[e(nT)ej2πfcnT ]
=I′(nT) cos(2πfcT) − Q′(nT) sin(2πfcnT)
(5)
The signal SRL(nT) is given by:
SRL(nT) = G(eR(nT)) = G0x(nT)ej2πfcnT
(6)
Note that, with ideal linearization, G0 is a real constant, pre-
senting no device-dependant or signal-dependant distortions
anymore.
As shown in Figure 2, the spectrum of baseband input sig-
nal is without spectral regrowth. Due to the nonlinearity or
the nonlinear memory effect especially presented by the PA,
spectral regrowth appears in the adjacent channels. While
with the predistortion, these distortions can be minimized.
III. PROPOSED LUT BASEBAND DPD
A. PA modelisation
The ﬁrst step in PA linearization is to provide a mathemat-
ical description of PA’s nonlinear memory effect behavior.
In the narrowband systems, memoryless polynomial
model (Figure 3(a)) exhibits good performances in describ-
ing the PA’s behavior. With the baseband input sample
x(nT), the PA’s nonlinear output is:
S(nT) = a1x(nT) + ... + a2j+1x(nT)|x(nT)|2j + ... (7)
where a2j+1 (j = 0, 1, 2 . . . N) are the coefﬁcients of the
nonlinearity. N represents the order of nonlinearity.
56
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-193-9
ICDT 2012 : The Seventh International Conference on Digital Telecommunications

(a) Memoryless Polynomial
(b) Hammerstein model
Figure 3.
Model structures
For wideband applications, memory effect should be taken
into account. Hammerstein model (Figure 3(b)) consists of
a polynomial to model the static nonlinearity and a Finite
Impulse Response (FIR) ﬁlter to represent the memory
effect.
y(nT), the output of the polynomial block is deﬁned as:
y(nT) =
N
X
j=0
b2j+1x(nT)|x(nT)|2j
(8)
where b2j+1 are the coefﬁcients representing nonlinearity.
The output of FIR ﬁlter, S(nT), which is also the output
of PA is given by:
S(nT) =
P −1
X
i=0
aiy[(n − i)T]
(9)
where ai are the coefﬁcients representing memory effect. P
shows the length of memory effect.
The DPD proposed in [5] is based on the Hammerstein
model. This model implicitly separates the memory effect
from the nonlinearity. However, in practice these two effects
are often closely related. In this paper, we use the MP model
to better model this nonlinear memory effect behavior. The
PA’s MP modelisation is given by [7]:
S(nT) =
P −1
X
i=0
N
X
j=0
ai,2j+1x[(n − i)T]|x[(n − i)T]|2j (10)
where ai,2j+1 are the coefﬁcients of the nonlinear memory
effect.
B. Look-Up-Table DPD
According to the DPD principle (equation (1)), if the PA
is perfectly linearized, we get:
P −1
X
i=0
N
X
j=0
ai,2j+1e[(n−i)T]|e[(n−i)T]|2j = G0x(nT) (11)
The left member of above equation can be divided into
two parts: static nonlinearity d(nT) (equation (12)) and
dynamic deviation P(nT) (equation (13)). The ﬁrst part
depends only on the current input at instant nT with
i = 0. The second part, depending on the previous inputs,
is composed of the terms with i varying from 1 to P − 1.
d(nT) =
N
X
j=0
a0,2j+1e(nT)|e(nT)|2j
(12)
P(nT) =
P −1
X
i=1
N
X
j=0
ai,2j+1e[(n − i)T]|e[(n − i)T]|2j
(13)
Seperating the static nonlinearity d(nT) and dynamic
deviation P(nT), we get:
N
X
j=0
a0,2j+1e(nT)|e(nT)|2j = G0x(nT) − P(nT)
(14)
With P(nT) being known at instant nT, the correspond-
ing predistorted signal e(nT) can be found for each x(nT).
Taking the absolute value of each side of equation (14), we
obtain:
|
N
X
j=0
a0,2j+1e(nT)|e(nT)|2j| = |G0x(nT) − P(nT)| (15)
In [5], the Hammerstein DPD adopts a complex root-
ﬁnding procedure to calculate the amplitude of the predis-
torted signal |e(nT)|. Unfortunately, this procedure is too
time-consuming to be applicable in the real-time applica-
tions. In this paper, the LUT principle [7] is proposed to
efﬁciently ﬁnd E(m), which is also deﬁned as |e(nT)|.
Firstly, we decompose the maximum dynamic range of
|e(nT)|, function of the input amplitude of saturation point
and the maximum magnitude of input signal, into M (table
size) intervals of equal length. Each interval corresponds
to a quantiﬁed value E(m) (m = 1, 2, M). Each E(m)
corresponds to a value f(m), according to the left member
of equation (15). Thus a LUT (TABLE II) is generated
according to the following equation:
LUT : f(m) = |
N
X
j=0
a0,2j+1E(m)2j+1|
(16)
Table II
LUT
INLUT
OUTLUT
E(1)
f(1)
...
...
E(m)
f(m)
...
...
E(M)
f(M)
For each baseband input sample x(nT), we calculate the
right member of equation (15) (|G0x(nT) − P(nT)|) and
compare with the values f(m) in the MP LUT to ﬁnd the
corresponding E(m), which is also the desired |e(nT)|.
57
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-193-9
ICDT 2012 : The Seventh International Conference on Digital Telecommunications

The corresponding phase Arg(e(nT)) is calculated by:
Arg(e(nT)) = arg
(
G0x(nT) − P(nT)
PN
j=0 a0,2j+1|e(nT)|2j+1
)
(17)
Finally, the predistorted signal e(nT) is given by:
e(nT) = |e(nT)|ejArg(e(nT ))
(18)
Table III
LUT DPD ALGORITHM
Initialization:
n = 0, P(0) = 0
Generate LUT:
f(m) = | PN
j=0 a0,2j+1E(m)2j+1|
Loop(n = n + 1)
{
- Calculate:
|G0x(nT) − P(nT)|
- Compare with values OUTLUT in the table to ﬁnd the corresponding
|e(nT)| for each x(nT)
- Calculate:
Arg(e(nT)) = arg

G0x(nT )−P (nT )
PN
j=0 a0,2j+1|e(nT )|2j+1

- Calculate:
e(nT) = |e(nT)|ejArg(e(nT ))
- Calculate:
P[(n + 1)T] =
P −1
X
i=1
N
X
j=0
ai,2j+1e[(n + 1 − i)T]|e[(n + 1 − i)T]|2j
}Goto loop
Table III gives the summary of the proposed LUT algo-
rithm.
The proposed MP model based LUT DPD exhibits lower
complexity than the Hammerstein DPD [5]. With the simu-
lation in Matlab, the Hammerstein DPD needs 1.24s, while
only 0.32s is required for the LUT DPD with a table size
of 1000.
IV. MEASUREMENT
The test bench consists of a Vector Signal Generator
(VSG), a Spectrum Analyzer (SA) and a PC. It is designed to
be fully automatic by using a Matlab toolbox. The baseband
data are generated in Matlab and then sent to the VSG. The
VSG (Rhode & Schwartz SMU 200A) receives the complex
envelope data via an Ethernet cable (TCP/IP) from the PC
and uses a direct up-conversion from baseband to RF. Once
the data have been sent to the VSG, the VSG will send the
corresponding modulated signal to the PA. The RF input
and output signals of the PA are then analyzed by the SA
(Agilent E4440A). In this case, the signal analysis software
(89601A) provided by this instrument can be used to acquire
and demodulate the input and output signals separately. It
digitalizes each IF signal by using two ADC (14bits), each
with a frequency of 100MHz, totally 200MHz. These
signals are then transferred via an Ethernet cable to the PC,
and ﬁnally processed in the workspace of Matlab.
Figure 4.
Test Bench
In the PC, the acquired signals by the SA are used to
identify the parameters of the PA to obtain the inversed
characteristics and then loaded again to the VSG. Finally,
the output of the linearized PA is digitized in the SA and
sent back to the PC to evaluate the performance of the DPD.
The tested wideband (500-2500 MHz) PA (Mini-Circuits
ZFL-2500) has a gain of 28dB(±1.5) and the 1dB com-
pression point around the output power of 15dBm. It is
saturated at the average output power around 19.7dBm. The
measurement is driven by a 16QAM modulated signal with
3.84MHz bandwidth at the carrier frequency of 1.8GHz.
The offset of adjacent channel is set to be 5MHz. The pulse
shaping ﬁlters are square-root raised cosine ﬁlters with a
roll-off factor of 0.35. A sequence of 200 symbols (4000
samples) is sent to the VSG. The table size is 1000 with N
of 4 and P of 2.
(a) Measured ACPR
(b) Measured EVM
Figure 5.
Measured performances
The measured ACPR performance is presented in Figure
58
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-193-9
ICDT 2012 : The Seventh International Conference on Digital Telecommunications

5. The proposed LUT DPD achieves slightly higher ACPR
corrections than the Hammerstein DPD, meanwhile with
higher simplicity and lower time consumption. The best
performance for ACPR reduction is about 12.5dB for the
proposed LUT DPD and 10dB for Hammerstein DPD
around the average output power of 12dBm. For the in-
band distortion (EVM), these two DPDs present nearly the
same performances with 3% maximum corrections around
the average output power of 14dBm.
V. CONCLUSION AND PROSPECTIVE
In this paper, we proposed a MP model based LUT
baseband DPD which presents the ability to linearize the PA
with memory effect for the wideband applications. Based
on the MP model, a robust modelisation is presented to
describe the nonlinear memory effect behavior of the PA.
For this DPD, the generated LUT in digital signal processing
is used to predistort the baseband signal prior to DAC and
up conversion to the desired carrier frequency. The results
present maximum ACPR reduction of 12.5dB and EVM
correction of 3% with lower complexity compared with
the Hammerstein DPD. The LUT is updated continuously
so as to enable the DPD to adapt to variations of the
transmitter chain characteristics (due to temperature drift,
antenna impedances, etc.). We are also planning to consider
the nonuniform LUT intervals.
REFERENCES
[1] F.M. Ghannouchi, and O. Hammi, Behavioral Modeling and
Predistortion.
IEEE Microwave Magazine, Vol. 10, N7, pp.
52-64, Dec 2009.
[2] W.J. Kim, K.J. Cho, S.P. Stapleton, and J.H. Kim, Baseband
Derived RF Digital Predistortion.
Electronics letters, Vol.
42, N8, pp. 468-470, April 2006.
[3] M.A. Hussein, Y. Wang, B. Feuvrie, S. Toutain, and G.
Peyresoubes, Piecewise Complex Circular Approximation of
the Inverse Characteristics of Power Ampliﬁers for Digital
Predistortion Techniques.
ICDT ’08, pp. 59-63, Bucharest,
June 2008.
[4] E. Cottais, and Y. Wang, Inﬂuence of Instruments Bandwidth
in the Power Ampliﬁer Linearization Process.
ICDT ’08, pp.
11-14, Bucharest, June 2008.
[5] E. Cottais, B. Feuvrie, Y. Wang, and S. Toutain, Experimental
results for power ampliﬁer adaptive baseband predistortion
linearization.
IEEE Topical Symposium on Power Ampliﬁers
for Wireless Communications, Long Beach, USA, 8-9, January
2007
[6] A. Katz, R. Gray, and R. Dorval, Truly wideband linearization.
IEEE Microwave Magazine, Vol. 10, N7, pp. 20-27, Dec 2009.
[7] Li F.; Feuvrie B.; Wang Y.; Chen W.; MP/LUT baseband digital
predistorter for wideband linearization.
Electronics Letters,
Vol. 47, N19, pp.1096-1098, September 2011.
59
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-193-9
ICDT 2012 : The Seventh International Conference on Digital Telecommunications

