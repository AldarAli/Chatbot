A Transient Classiﬁcation System Implementation
on an Open Source Distributed Power Quality Network
Charles Dickens
Department of Electrical and
Computer Engineering
University of Hawaii Manoa
Honolulu, Hawaii 96822
Email: dickensc@hawaii.edu
Anthony Christe
Department of Information and
Computer Sciences
University of Hawaii Manoa
Honolulu, Hawaii 96822
Email: achriste@hawaii.edu
Philip Johnson
Department of Information and
Computer Sciences
University of Hawaii Manoa
Honolulu, Hawaii 96822
Email: johnson@hawaii.edu
Abstract—Capturing and classifying Power Quality (PQ) phenom-
ena is important for the smooth functioning of electrical grids.
This paper presents methods for classifying the four types of
transients (impulsive, arcing, oscillatory, and periodic notching)
speciﬁed in the IEEE 1159 Power Quality standard. Our methods
implement a tractable algorithm, which applies well understood
signal processing methods and statistical inference for feature
extraction and decision making. We tested our methods on sim-
ulated PQ disturbances in order to demonstrate the capabilities
of the system. The results of this research include an operational
implementation of a transient classiﬁer for Open Power Quality,
an open source distributed PQ network. Additional functionality
can be easily incorporated into the system to extend the utility
of our methods, such as a meta-analysis to capture higher level
network wide events.
Keywords–Power quality; power transients; open source; renew-
able energy.
I.
INTRODUCTION
Introducing renewable energy generation to existing elec-
trical grid infrastructures has proven itself to be an engineering
challenge. The transition to cleaner energy generation methods
such as wind and solar, which are inherently unpredictable,
has increased the severity and frequency of problems related
to Power Quality (PQ) [1]. For example, sensitive instruments
connected to an unstable grid can be potentially de-calibrated
or damaged.
A ﬁrst step to correcting PQ problems is understanding
the problem from top to bottom. Electricity supplied by the
grid should be continuously monitored to detect and log PQ
events. Classiﬁcation of PQ phenomena can reveal problematic
patterns in the system and provide potential explanations for
failures that can be understood and resolved.
There is considerable research on classiﬁcation of PQ
[2]–[6]. Current state of the art techniques commonly utilize
wavelet transforms for feature extraction and then run the data
through a trained neural network or decision tree algorithm.
Another approach by Manikandan, Samantaray, and Kamwa
[3] decomposes the signal using sparse signal decomposition
on an overcomplete hybrid dictionary matrix and then extracts
the power disturbance features of the decomposed signal
and classiﬁes the transient waveforms using a decision tree
algorithm.
In this paper, we present a tractable implementation of a
transient classiﬁcation system for our open source distributed
PQ network called Open Power Quality (OPQ). By includ-
ing this transient detection system in OPQ, we can gather
information on both local transients and global transients (i.e.,
transients from a single source that were detected on multiple,
distributed sensors). This information can be used to determine
how transients and other PQ signals propagate throughout a
power grid. Further, data metrics generated from intermittent
renewable sources, weather reports, and user reports can be
fused by OPQ with the transient detection results to provide
insights on how intermittent renewable energy sources affect
the quality of power on the grid.
This paper is structured as follows. Section II explains and
justiﬁes the proposed methodology for classifying transients.
Section III describes the implementation of the methodology
on the OPQ system. Section IV reports the simulated results
of the transient detection system. Finally, Section V provides
the conclusions.
II.
METHODOLOGY
The transients classiﬁed with the methodologies discussed
in this paper are deﬁned in the IEEE 1159 Draft Recommended
Practice for Monitoring Electric Power Quality [7]. Table I
summarizes the deﬁnition and characteristics of each transient.
TABLE I. TRANSIENT CLASSES
Class
Description
Impulsive
Unidirectional change from the nominal waveform.
Arcing
Bipolar random frequency noise.
Oscillatory
Decaying oscillatory wave.
Periodic Notching
Periodic and strictly negative in power.
We use a decision tree algorithm to classify signals with
potential transients. The beneﬁt of this approach is that it min-
imizes necessary computation. As PQ features are extracted
from the signal, the potential classes that it could fall into are
narrowed. Computationally expensive analysis can be bypassed
if simple features can rule out a class early in the process.
Leveraging this idea, the potential transients are checked to
see if they ﬁt the classes in the same order as listed in Table
I. Once the signal is classiﬁed, then additional meta data can
be computed that appropriately details the transient.
33
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-713-9
ENERGY 2019 : The Ninth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

A. Signal Decomposition
The ﬁrst task is to decompose the raw signal into the
fundamental waveform and the potential transient waveform.
In the context of this application, the fundamental waveform
is expected to have little to no variation from the standard,
which is 60 Hz and 120 Vrms in the U.S. [8]. There is the
potential for simultaneous waveform distortion and transient
PQ phenomena. However, waveform distortions for frequency
phenomena are typically found to only vary by ±0.1 Hz and
for voltage phenomena by 0.11.8 pu [7], whereas the transients
that the system is capturing typically have a spectral content
between 1 kHz5 MHz.
Thus, a simple digital implementation of a 4th order low
pass Butterworth ﬁlter with a cutoff frequency at 500 Hz
is justiﬁable and practical for this application to extract the
fundamental waveform from the raw digital signal. A different
ﬁlter could be used to achieve similar results. We decided to
use a Butterworth ﬁlter with these order and cutoff frequencies
due to the desirable property that the ﬁlter is monotonic in
both the passband and stopband, which results in a clean
decomposition. Once the fundamental waveform is retrieved,
the transient waveform is then obtained by subtracting out the
fundamental waveform from the raw signal.
B. Classifying Impulsive Transients
The ﬁrst step in the decision tree algorithm is to determine
whether the transient could be impulsive. We test for impulsive
transients ﬁrst since it is computationally cheapest to verify.
As deﬁned by the IEEE 1159 standard, an impulsive transient
is a unidirectional change from the nominal condition of the
voltage [7]. Therefore, a simple check which ensures that the
excitation in the transient waveform is unipolar will qualify the
transient to be in the broad category of impulsive transients.
If the transient is impulsive, then arcing and oscillatory
transients can be ruled out. Additional cases do need to be
accounted for since there is a chance that the transient could
also be periodic notching. If the impulsive transient is positive
in power, then periodic notching can be ruled out, otherwise
it needs to be tested. At this point meta-data detailing the rise
and decay time, the peak amplitude, and whether or not the
transient causes additional zero crossings in the raw signal can
be calculated and recorded with the classiﬁcation.
C. Classifying Arcing Transients
An arcing transient is a burst of relatively higher frequency
noise that is random in frequency content. The arcing transient
should have more than ten zero crossings and should not have
more than two cycles with same period [7].
Thus, the test for arcing transients can be a veriﬁcation of
more than ten zero crossings and a threshold for randomness in
the frequency content. The deﬁned threshold for randomness
is whether more than two zero crossings have the same period.
D. Classifying Oscillatory Transients
An oscillatory transient is a bipolar change that typically
lasts between a few milliseconds to a quarter cycle of the
nominal waveform. It is characterized by its frequency content
and decay rate [7].
To determine whether the potential transient ﬁts the os-
cillatory classiﬁcation, the system implements an incremental
F-test. The F-test gives a numerical value of the signiﬁcance
of additional variables added to the regression function. The
null hypothesis of the test is H0 : β3 = β4 = β5 = 0.
We implement this by ﬁrst computing a least squares curve
ﬁtting of the potential transient waveform and an exponentially
decaying sinusoid using gradient descent. The complete model
is shown in (1).
ˆy = β0 + β1e−β2tcos(β3 · 2πt + β4)
(1)
Then, a reduced model is ﬁt using the same least square
ﬁtting methods. The reduced model equation is shown in (2).
ˆy = β0 + β1e−β2t
(2)
Large values of F result in rejection of the null hypothesis
and the classiﬁcation of the transient as oscillatory. The
threshold value that F must pass is a design decision and
will determine the expected type 1 and type 2 errors of the
classiﬁcation.
We record additional meta-data upon this classiﬁcation
including the decay rate, frequency content, dc offset, and peak
amplitude, all of which follow from the results of the curve
ﬁtting.
E. Classifying Periodic Notching Transients
A periodic notching transient is a periodic and strictly
negative power disruption of the nominal waveform. Therefore,
the signal is ﬁrst veriﬁed to be strictly negative in power
before further analysis is made. If so, the system moves on to
determine whether the potential transient waveform is periodic.
To test for periodicity the auto-correlation of the signal is
computed. Auto-correlation highlights the similarity between
the signal and its previous values. Our method convolves the
ﬁrst half the transient signal with the original transient. The
convolution is only calculated for points where the signals
completely overlap. If the potential transient is indeed periodic,
then the resulting signal from the convolution will have the
same periodicity with peaks that highlight where the signal
had the highest correlation.
Our method determines the peaks of the auto-correlation
signal by setting a height threshold. Then, it ﬁnds the standard
deviation of the distance between the peaks, and if this value is
less than a deﬁned threshold, the signal is classiﬁed as periodic.
If so, the period is easily calculated from the auto-correlation
signal along with additional meta-data to characterize the
transient.
III.
IMPLEMENTATION
We implemented and tested these methods using our OPQ
system. The OPQ project began in 2012 with the goal of devel-
oping and evaluating PQ technology to support improvements
to electrical grids, in particular the incorporation of distributed
intermittent renewable energy sources.
In general, the OPQ system architecture consists of OPQ
Boxes, which are plugged into standard residential outlets to
monitor PQ as it is experienced at the point of consumption.
These results are communicated over the Internet to OPQ
Cloud, a set of cloud-based services that provide end-to-end
support for the capture, triggering, analysis, and reporting of
34
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-713-9
ENERGY 2019 : The Ninth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

local and global level PQ phenomena. A major design goal of
OPQ is to not just report PQ locally for each device, but to
look at PQ in an aggregate manner. This is possible because
the OPQ cloud services provide a global view of all PQ sensors
(OPQ Boxes). Thus, OPQ is able to detect distributed PQ
incidents (where multiple distributed sensors sense the same
incident) and also observe how PQ incidents propagate through
the electrical grid.
The two principle cloud services in OPQ are called Makai
and Mauka. The Makai service is responsible for aggregating
and processing the measurements generated by the OPQ boxes.
Inside Makai, a triggering broker creates a PQ event when it
detects a deviation from the nominal waveform in a low ﬁdelity
data stream and sends a message to the Mauka system to
analyze the event further. The Mauka service performs analysis
of high ﬁdelity data and is thus where our transient detection
system is located.
Our implementation proceeds as follows.
First, the raw signal is decomposed into its fundamental
and potential transient waveform. The fundamental waveform
is extracted using a digital implementation of a 4th order low
pass Butterworth ﬁlter with a cutoff frequency of 500 Hz.
The digital ﬁlter used is an implementation in the scientiﬁc
Python library SciPy [9]. The transient waveform is then the
raw waveform minus the fundamental waveform.
Our method does not assume that only a single transient
exists in a PQ event triggered by the Mauka system. There-
fore, before classiﬁcation, the complete transient waveform is
separated into potential windows with individual transients.
This is achieved through a sliding window technique with
a predeﬁned threshold for a maximum lull. The maximum
lull between transients is a design decision that is made with
domain knowledge. The transients that are being classiﬁed with
the system are expected to have a duration on the order of
milliseconds.
The sliding window method works by ﬁrst scanning the
transient waveform and ﬁnding the ﬁrst measurement which
is above the conﬁguration noise ﬂoor. It is common practice
to account for potential instrumentation error by deﬁning a
noise ﬂoor. Measurement deviating from the nominal wave-
form more than the deﬁned noise ﬂoor are considered to
be signiﬁcant and can reasonably be considered to be PQ
phenomena and not a faulty measurement. The noise ﬂoor in
the implementation is deﬁned to be 5% of the nominal voltage.
The ﬁrst measurement above the noise ﬂoor is considered
to be the starting point of the transient. Then, the scanning
continues until there is a lull in measurements above the noise
ﬂoor longer than the deﬁned maximum, or the scanning has
reached the end of the transient signal. At which point the last
signiﬁcant measurement is deﬁned to be the endpoint of the
potential transient. This process is repeated until the end of
the transient signal is reached.
Once the start and end points of all of the potential
transients are determined, then the classiﬁcation analysis can
begin. Feature extraction and the decision tree structure is de-
scribed in detail in Section II. Only important implementation
notes will be mentioned in the rest of this section.
The multiple non-linear least squares regression required
for classiﬁcation of the oscillatory transient is provided in
the SciPy library [9]. The solution to the regression is an
approximation obtained by a gradient descent method. Since
the expected characteristics of oscillatory transients are known,
the gradient descent method can be seeded to increase the rate
at which a local optimum is found.
To classify periodic notching transients, a convolution oper-
ation is necessary. The code used to implement this calculation
is found in the NumPy library [10].
IV.
RESULTS
To test the performance of the proposed methodology,
simulated transients were constructed and run through the
system. The conﬁguration of the system at the time of these
reported results has the sampling rate at 12000 Hz.
First, we created a simulated waveform with an impulsive
transient by superimposing an exponentially decaying excita-
tion onto a portion of 6 cycles of a fundamental waveform.
This simulated transient has a peak amplitude of 18 volts and
decays to the noise ﬂoor in
1
32 cycles. The raw signal is shown
in Figure 1.
Figure 1. Simulated 60 Hz 120 Vrms sine wave with an impulsive transient.
The decomposed fundamental and transient signal are shown in the bottom
left and right subﬁgures, respectively.
Second, we created a simulated waveform with an oscil-
latory transient by superimposing an exponentially decaying
sinusoidal wave with 960 Hz frequency with starting amplitude
of 72 volts onto a portion of 6 cycles of a fundamental
waveform. The raw signal is shown in Figure 2.
Third, we created a simulated arcing transient by drawing
7 random samples from a uniform random distribution over
the support (61, 2401). We then used the random samples to
deﬁne the frequencies for single cycles of an arcing transient
wave. The raw signal is shown in Figure 3.
We simulated a multiple zero crossing transient by su-
perimposing three single sawtooth cycles in positions of the
fundamental waveform near a zero crossing. The single saw-
tooth cycle has an amplitude of a 72 volts and a period of 10
samples. The raw signal is shown in Figure 4.
Finally, we created a simulated waveform with a periodic
notching transient by superimposing a sawtooth waveform with
35
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-713-9
ENERGY 2019 : The Ninth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

Figure 2. Simulated 60 Hz 120 Vrms sine wave with an oscillatory
transient. The decomposed fundamental and transient signal are shown in the
bottom left and right subﬁgures, respectively.
Figure 3. Simulated 60 Hz 120 Vrms sine wave with an arcing transient.
The decomposed fundamental and transient signal are shown in the bottom
left and right subﬁgures, respectively.
a frequency of 1440 Hz and amplitude of 18 volts for a single
fundamental cycle, i.e., 24 notches per cycle for one cycle.
We determined the polarity of the notching transient by the
fundamental signal since notching is deﬁned to be strictly
negative in power. The raw signal is shown in Figure 5.
Figures 1, 2, 3, 5 show the raw simulated waveforms with
impulsive, oscillatory, arcing, and periodic notching transients,
respectively, all starting near the 600th measurement. The
two subﬁgures show the extracted fundamental waveform and
transient waveform detected by the system. These simulated
waveforms were all correctly classiﬁed by the system using
our methods.
Figure 4. Simulated 60 Hz 120 Vrms sine wave with multiple impulsive
transients which cause additional zero crossings in the raw waveform. The
ﬁrst decomposed fundamental and transient signal are shown in the bottom
left and right subﬁgures, respectively.
Figure 5. Simulated 60 Hz 120 Vrms sine wave with a periodic notching
transient. The decomposed fundamental and transient signal are shown in the
bottom left and right subﬁgures, respectively.
V.
CONCLUSION AND FUTURE WORK
This paper presents an implementation of a transient de-
tection system using OPQ, an open source distributed PQ net-
work, which can successfully classify four types of transients
as deﬁned in the IEEE 1159 standard. Our method shows
promise based upon its ability to correctly classify simulated
versions of all four transients.
The most immediate future work is to monitor an electrical
grid in real-time to determine how well the methods work on
real world transients.
We also hope to add functionality to OPQ that would
36
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-713-9
ENERGY 2019 : The Ninth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

enable us to search our historical data for the occurrence
of transients and classify them. From this, a meta-analysis
for higher level network wide events could lead to clues
regarding the sources of these phenomena. This data could
provide new insight into our understanding of how intermittent
renewable energy sources affect PQ on the grid, helping us to
better modernize our grids with larger amounts of distributed
renewable energy.
REFERENCES
[1]
R. Toma and M. Gavrilas, “The impact on voltage stability of the
integration of renewable energy sources into the electricity grids,” in
Proceedings of the 2014 International Conference and Exposition on
Electrical and Power Engineering (EPE) October 16–18, 2014, Iasi,
Romania.
IEEE, Oct. 2014, ISBN: 978-1-4799-5849-8.
[2]
V. Garrido, J. Rodriquez, and A. Garcia, “Classiﬁcation of power
quality phenomena using intelligent techniques,” in Proceedings of
the 2014 IEEE PES Transmission and Distribution Conference and
Exposition - Latin America (PES TD-LA) September 10–13, 2014,
Medellin, Colombia.
IEEE, 2014, ISBN: 978-1-4799-6251-8.
[3]
M. Manikandan, S. Samantaray, and I. Kamwa, “Detection and Classi-
ﬁcation of Power Quality Disturbances Using Sparse Signal Decompo-
sition on Hybrid Dictionaries,” IEEE Transactions on Instrumentation
and Measurement, vol. 64, pp. 27–38, Jan. 2015, issue: 1, ISSN: 0018-
9456.
[4]
K. Thirumala, A. Umarikar, and T. Jain, “A generalized emperical
wavelet transform for classiﬁcation of power quality disturbances,” in
Proceedings of the 2016 IEEE International Conference on Power
System Technology (POWERCON) September 28–1 October, 2016,
Wollongong, NSW, Australia.
IEEE, 2014, ISBN: 978-1-4673-8848-1.
[5]
M. Valtierra-Rodriguez, R. Romero-Troncoso, R. Osornio-Rios, and
A. Perez-Garcia, “Detection and Classiﬁcation of Single and Combined
Power Quality Disturbances Using Neural Networks,” IEEE Transac-
tions on Industrial Electronics, vol. 61, pp. 2473–2482, May 2014,
issue: 5, ISSN: 1557-9948.
[6]
N. Tse, J. Chan, W. Lau, and L. Lai, “Hybrid Wavelet and Hilbert
Transform With Frequency-Shifting Decomposition for Power Quality
Analysis,” IEEE Transactions on Instrumentation and Measurement,
vol. 61, pp. 3225–3233, Dec. 2012, issue: 12, ISSN: 1557-9662.
[7]
P1159/D3 Draft Recommended Practice for Monitoring Electric Power
Quality, IEEE, 2018.
[8]
C84.1-2016, American National Standard for Electric Power Systems
and Equipment Voltage Ratings (60 Hz), ANSI, 2016.
[9]
E. Jones, T. Oliphant, P. Peterson et al., “SciPy 1.1.0: Open source
scientiﬁc tools for Python,” 2001–, [accessed February 2, 2019].
[Online]. Available: http://www.scipy.org/
[10]
T. Oliphant, “NumPy 1.14.5: A guide to NumPy,” USA: Trelgol
Publishing, 2006–, [accessed February 2, 2019]. [Online]. Available:
http://www.numpy.org/
37
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-713-9
ENERGY 2019 : The Ninth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

