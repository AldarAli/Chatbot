141
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
Dynamic VLC Navigation System in Crowded Buildings  
 
Manuela Vieira, Manuel Augusto Vieira, Paula Louro, 
Alessandro Fantoni 
ADETC/ISEL/IPL,  
R. Conselheiro Em√≠dio Navarro, 1959-007  
Lisboa, Portugal 
CTS-UNINOVA  
Quinta da Torre, Monte da Caparica, 2829-516,  
Caparica, Portugal 
  
e-mail: mv@isel.ipl.pt, mv@isel.pt, plouro@deetc.isel.pt, 
afantoni@deetc.isel.ipl.pt 
 
Pedro Vieira 
ADETC/ISEL/IPL,  
R. Conselheiro Em√≠dio Navarro, 1959-007  
Lisboa, Portugal 
Instituto das Telecomunica√ß√µes  
Instituto Superior T√©cnico, 1049-001,  
Lisboa, Portugal 
e-mail: pvieira@deetc.isel.pt 
 
Abstract‚Äî This paper investigates the applicability of an 
intuitive risk of transmission wayfinding system in public 
spaces, virtual races, indoor large environments and complex 
buildings using Visible Light Communication (VLC). Typical 
scenarios include: finding places, like a particular shop or 
office, guiding users across different floors, and through 
elevators and stairs. The system is able to inform the users, in 
real time, not only of the best route to the desired destination, 
through a route without clusters of users, but also of crowded 
places. Data from the sender is encoded, modulated and 
converted into light signals emitted by the transmitters. Tetra-
chromatic white sources are used providing a different data 
channel for each chip. At the receiver side, the modulated light 
signal, containing the ID and the 3D geographical position of 
the transmitter and wayfinding information, is received by a 
SiC optical sensor with light filtering and demultiplexing 
properties. Since lighting and wireless data communication is 
combined, each luminaire for downlink transmission becomes 
a single cell, in which the optical Access Point (AP) is located in 
the ceiling and the mobile users are scattered across the 
overlap discs of each cell, underneath. The light signals emitted 
by the LEDs are interpreted directly by the receivers of the 
positioned users. Bidirectional communication is tested. The 
effect of the location of the Aps is evaluated and a 3D model for 
the cellular network is analyzed. In order to convert the 
floorplan to a 3D geometry, a tandem of layers in a orthogonal 
topology is used, and a 3D localization design, demonstrated  
by a  prototype implementation, is presented. Uplink 
transmission is implemented, and the 3D best route to navigate 
through venue is calculated. Buddy wayfinding services are 
also considered. The results showed that the dynamic VLC 
navigation system enables to determine the position of a mobile 
target inside the network, to infer the travel direction along the 
time, to interact with received information and to optimize the 
route towards a static or dynamic destination.  
 
Keywords- Visible Light Communication; Indoor navigation; 
Bidirectional Communication; Wayfinding; Optical sensors; 
Multiplexing/demultiplexing techniques. 
I. 
INTRODUCTION 
This paper is an extended version from the one presented 
in ALLSENSORS 2021 [1].  
Optical wireless communication has been widely studied 
during the last years in short-range applications. Therefore, 
communications within personal working/living spaces are 
highly 
demanded. 
The 
availability 
of 
portable 
communication devices, such as smartphones and tablets 
increases the demand on mobile wireless connectivity. 
Several technologies have been investigated to provide 
wireless connections to the users in indoor and outdoor 
environments. Nowadays, indoor positioning methods are 
mainly based on Wi-Fi, Bluetooth, Radio-Frequency 
Identification (RFID) and Visible Light Communications 
(VLC) [2][3][4][5]. VLC is a data transmission technology 
[6] that can easily be employed in indoor environments 
since it can use the existing LED lighting infrastructure with 
simple modifications [7][8]. VLC can be regarded as a light 
based Wi-Fi, i.e., instead of radio waves uses visible light to 
transmit the data. It presents advantages when compared 
with the Wi-Fi, namely the invulnerability to the hackers 
since it does not penetrate through the wall, its high capacity 
and efficiency. Once lights are essential part of operating 
rooms, the VLC technology finds applications in a wide 
variety of fields like: in medical and healthcare, in airlines 
and aviation, in supermarkets and railway stations, in retail 
stores, in hidden communication or in Line-of -Sight (LoS) 
applications as in traffic control, vehicle to vehicle 
communication or smart street lighting.  
The VLC systems use the wavelength range between 380 
nm and 780 nm and the LEDs are used as light sources and 
transmitters. Therefore, the LEDs are twofold by providing 
illumination, as well as communication. LEDs are 
incoherent light sources and transmitting information can 
only be realized by the optical intensity change. Here, the 
On-OFF keying (OOK) modulation scheme is used. In the 
sequence, we propose to use modulated visible light, carried 
out by white tetra-chromatic low cost LEDs. The use of 
those LEDs provides different data channel for each chip 
offering 
the 
possibility 
of 
Wavelength 
Division 
Multiplexing (WDM), which enhances the transmission data 
rate. At the receiver side, the modulated light signal is 
received by a SiC photodetector, based on a tandem a-

142
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
SiC:H/a-Si:H pin/pin structure, which presents light filtering 
and demultiplexing properties decoding the received 
information [9] [10]. Here, when different visible signals are 
encoded in the same optical transmission path, the device 
multiplexes the different optical channels, performs 
different filtering processes (amplification, switching, and 
wavelength conversion) and finally decodes the encoded 
signals recovering the transmitted information. 
Research is still necessary to design LED arrangements 
that can optimize communication performance while 
meeting the illumination constraints for a variety of large 
indoor layouts. Visible light can be used as an ID system in 
different places such as buildings and subways and can be 
employed for identifying the room number and its building. 
The main idea is to divide the space into spatial beams 
originating from the different ID light sources, and identify 
each beam with a unique timed sequence of light signals. 
Fine-grained indoor localization can enable several 
applications; in airports, supermarkets and shopping malls. 
Exact location of products can greatly improve the 
customer's shopping experience and enable customer 
analytics and marketing [11]. The signboards, based on 
arrays of LEDs, positioned in strategic directions to 
broadcast the information [12], are modulated acting as 
down- 
and 
up-link 
channels 
in 
the 
bidirectional 
communication.  
In this paper, a LED-supported positioning and 
navigation VLC system is proposed. After the Introduction, 
in Section II, a VLC scenario for large environments is 
established, the emitters and receivers are characterized and 
the communication protocol presented. In Section III, the 
main experimental results are presented, the effect of the 
location of the optical Access Points (Aps) is evaluated and 
a model for the different cellular networks is analysed. 
Square and hexagon mesh are tested, and a 2D localization 
design, demonstrated by a prototype implementation, is 
presented. Uplink transmission is implemented and the 2D 
best route to navigate through venue calculated. In Section 
IV, the conclusions are drawn showing that the system 
makes possible to determine the position of a mobile target 
inside the network, to infer the travel direction along the 
time and to interact with information received. 
II. 
VLC NETWORK  
In the follow, the VLC network is described. 
 
A. 
Self-localization 
Self-localization is a fundamental issue since the person 
must be able to estimate its position and orientation (pose) 
within a map of the environment it is navigating. We 
consider the path to be a geometric representation of a plan 
to move from a start pose to a goal pose. Let us consider a 
person navigating in a 2D environment (Figure 1). Its non-
omnidirectional configuration is defined by position (x, y) 
and orientation angle ÔÅ§, with respect to the coordinate axes. 
q(t) = [x(t), y(t), ÔÅ§(t)] denotes its pose at time t, in a global 
reference frame. In cooperative positioning systems, persons 
are divided into two groups, the stationary persons and the 
moving persons. Let us consider that qi(t,t¬¥) represents the 
pose of person i at time t¬¥ relative to the pose of the same 
person at time t and qij(t) denotes the pose of person j 
relative to the pose of person i at time t. qi(t,t¬¥) is null for 
people standing still and non-zero if they move. These three 
types of information qi (t), qi (t,t¬¥)and qij (t) compose the 
basic elements of a pose graph for multi-person cooperative 
localization. 
Person-to-person spread to be the most common form of 
transmission of COVID-19, occurring mainly among people 
who are within 2m of each other for a prolonged period of 
time. This means people should stay the recommended 
distance apart from others. It also means people should 
avoid gathering in groups, crowded places and mass 
gatherings. So, in crowded building the routes to a specific 
place should avoid those regions. We consider that the risk 
of transmission exists if qij(t) is less than 2 m. The system 
has to alert the users to stay away from those regions and to 
plan the better route to the desired wayfinding services. To 
estimate each person track the pure pursuit approach [13], 
[14] is used. The principle took into account the curvature 
required for the mobile receiver to steer from its current 
position (t1) to its intended position (t2). By specifying a 
look-ahead distance, it defines the radius of an imaginary 
circle. Finally, a control algorithm chooses a steering angle 
in relation to this circle. Then, this allows to iteratively 
construct the intermediate arcs between itself and its goal 
position as it moved, thus, obtaining the required trajectory 
for it to reach its objective position. To avoid the risk of 
transmission, in the same frame of time and in known 
crowded regions, qij(t) is estimated and the steering angle 
readjusted.  
 
B. 
Virtual scenario and Architecture 
When we are looking for the shortest route to a place, we 
want to be guided on a direct, shortest path to our 
destination. Advances in wayfinding responds to our need to 
establish markers and identify patterns by creating spatial 
relationships between users and areas. Directional aids 
remain in force, but there is now a digital framework that 
goes beyond providing basic information. This expansion 
has encouraged the rise of multi-device connectivity that 
can tell users where they are (current point), where they 
need to be (goal point) and what they need to do to get there 
(path).  
Interaction between planning, control, and localization is 
important. The localization (Where am I?) senses the 
environment and computes the user position, the planning 
(Where am I going?) computes the route to follow from the 
position and the control (How do I get there?) moves the 
user in order to follow the route. A destination can be 
targeted by user request to the Central Manager (CM).  

143
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
The simulated scenario is an airport. Here, the  traveler, 
equipped with a receiver, navigates from outdoor to indoor. 
It sends a request message to find the right track and, in the 
available time, he adds customized points of interest and 
halls to boarding. During his path, the passenger is advised 
how to reach its destination and the possibility to use 
location 
based 
advertising 
services. 
The 
requested 
information is sent by the emitters at the ceiling to its 
receiver. In Figure 1, the proposed architecture and scenario 
are illustrated. 
Restaurants
Red
Green
Blue
Violet
Transmitters
Boarding
A1
A2
A4
A3
B
A
Hall
Shops
Receivers
B
C
C
Main entrance
a) 
b) 
 
Figure 1 
a) Optical infrastructure and indoor layout.b) a) Mesh and 
cellular hybrid architecture  
Two topologies were considered: the square for the main 
hall and the hexagonal for the marketing zones (Figure 1a). 
Data from the infrastructure is encoded, modulated and 
converted into light signals emitted by the transmitters. 
Tetra-chromatic (Red, Green, Blue, Violet) white sources 
are used, providing a different data channel for each chip. 
At the receiver side, the modulated light signal, containing 
the ID and the 2D geographical position of the transmitter 
and wayfinding information, is received by a SiC 
photodetector with light filtering and demultiplexing 
properties. To synchronize the signals from multiple LEDs, 
the transmitters use different IDs, allowing the signal to be 
reconstructed at the receiver.  
We propose a mesh cellular hybrid structure to create a 
gateway-less system without any external gateways needed. 
We propose this network configuration since it is wireless 
and ad-hoc. It spans all devices, is wire free, demonstrate 
resiliency to physical obstructions and adapt to changes in 
the transmission medium. Therefore, a mesh network is a 
good fit because it dynamically reconfigures itself and 
grows to the size of any installation. It is also a secure and 
trustworthy network [15]. As illustrated in Figure 1b, the 
luminaires, in this architecture, are equipped with one of 
two types of nodes: A ‚Äúmesh‚Äù controller that connects with 
other nodes in its vicinity. These controllers can forward 
messages to other devices (I2D) in the mesh, effectively 
acting like routers nodes in the network. A ‚Äúmesh/cellular‚Äù 
hybrid controller equipped with a modem provides IP base 
connectivity to the central manager services (CM). These 
nodes act as border-router and can be used for edge 
computing. Under this architecture, the short-range mesh 
network purpose is twofold: enable edge computing and 
device-to-cloud communication, by ensuring a secure 
communication from a luminaire controller to the edge 
computer or datacenter (I2CM), through a neighbor 
luminaire controller with an active cellular connection; and 
enable peer-to-peer communication (I2IIP), to exchange 
information between smart devices.  
Building a geometry model of interiors of buildings is 
complex since the interior structure has to be seen as an 
aggregation of several different types of objects (rooms, 
stairs, etc.) with different shapes. In the proposed 
architecture the logical model is easier since represents each 
room/crossing/exit with a node (Figure 1a), and a path as the 
links between nodes. The user positions can be represented 
as ùëÉ (ùë•, ùë¶) by providing the horizontal positions (ùë•, ùë¶) The 
indoor route throughout the building is presented to the user 
by a responding message transmitted by the ceiling 
luminaires that work also either as router or mesk/celular 
nodes (Figure 1b). With this request/response concept, the 
generated landmark-based instructions help the user to 
unambiguously identify the correct decision point where a 
change of direction (pose) is needed, as well as offer 
information for the user to confirm that he/she is on the right 
way. 
III. VLC LINK MODELS  
A. VLC dynamic navigation system (position and route 
control)  
To support people‚Äôs wayfinding activities in unfamiliar 
indoor environments, a method able to generate ceiling 
landmark route instructions using VLC is proposed. The 
dynamic navigation system is composed of several 
transmitters (LEDs ceiling luminaries), which send the map 
information and path messages required to wayfinding. A 
mobile optical receiver, using joint transmission, extracts 

144
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
user location to perform positioning and, concomitantly, the 
transmitted data from each transmitter. To synchronize the 
signals from multiple LEDs, the transmitters use different 
ID¬¥s, such that the signal is constructively at the receiver. 
Bidirectional communication between the emitters and the 
receivers is available in strategic optical access point (Li-Fi 
zone).The block diagram of the VLC system is presented in 
Figure 2.  
 
Medium
pin/pin  MUX 
device
Receiver circuit
Decoding
Display
Receiver
Data
Encoding
Map information
Buddy localization
LEDs
Luminaires
Transmitter
 
Figure 2. VLC block diagram of the VLC system. 
The system is composed by the transmitter and the 
receiver modules located, respectively, at the infrastructures 
and at the mobile users. The VLC receiver, at the reception 
end of the communication link, is responsible to extract the 
data from the modulated light beam. It transforms the light 
signal into an electrical signal that is subsequently decoded 
to extract the transmitted information. 
The principal components of the VLC system are the 
LEDs, which act as the communication sources and the SiC 
WDM devices that serve as receiving elements. Data from 
the sender is converted into an intermediate data 
representation, byte format, and converted into light signals 
emitted by the transmitter module. The data bit stream is 
input to a modulator where an ON‚ÄìOFF KEYING (OOK) 
modulation is utilized. Here, a bit one is represented by an 
optical pulse that occupies the entire bit duration, while a bit 
zero is represented by the absence of an optical pulse.  
The light signal is received by the WDM photodetector 
that detects the on/off states of the LEDs, generates a binary 
sequence of the received signals and convert data into the 
original format. The LEDs emit light when the energy levels 
change in the semiconductor diode. The wavelength 
depends on the semiconductor material used to form the 
LED chip. For data transmission, commercially available 
polychromatic white LEDs were used at the nodes of the 
network. On each node only one chip is modulated for data 
transmission and carries useful information while the others 
are only supplied with DC to maintain white colour 
illumination. Red (R; 626 nm), Green (G;530 nm), Blue (B; 
470 nm) and violet (V; 390 nm) LEDs, are used [16][17]. 
Since lighting and wireless data communication is 
combined, each luminaire for downlink transmission 
becomes a single cell, in which the optical access point (AP) 
is located in the ceiling and the mobile users are scattered 
within the overlap discs of each cells underneath.  
LEDs are modeled as Lambertian sources where the 
luminance is distributed uniformly in all directions, whereas 
the luminous intensity is different in all directions. The 
luminous intensity for a Lambertian source is given by 
Equation (1) [18]: 
 
I·à∫‚àÖ = IùëÅ cos·à∫‚àÖ ùëö    
Where m is the order derived from a Lambertian pattern, IN 
is the maximum luminous intensity in the axial direction 
and  ÔÅ¶ is the angle of irradiance. The Lambertian order m is 
given by: 
 
 ùëö =
ùëôùëõ·à∫2 
ùëôùëõ ùëêùëúùë† ‚àÖ1/2    
 
 
For the proposed system, the commercial white LEDs 
were designed for illumination purposes, exhibiting a wide 
half intensity angle (ÔÅ¶1/2) of 60¬∫. Thus, the Lambertian order 
m is 1.  
 
 
 
Figure 3. Geometry of the relative position of the transmitter 
and receiver units. 
The light signal is received by the WDM photodetector 
that detects the on/off states of the LEDs, generates a binary 
sequence of the received signals and convert data into the 
original format.  For simplicity we will consider a line of 
sight (LoS) connection for both VLC links, which 
corresponds to the existence of straight visibility between 
the transmitter and the receiver. In Figure 3, it is plotted the 
geometry of the transmitter and receiver relative position, 
with 
emphasis 
to 
the 
main 
parameters 
used 
for 
characterization of the LED source and the photodiode 
receiver (angles of irradiance and illumination, transmitter‚Äôs 
semi-angle at half-power and field of view). The Lambertian 
model is used for LED light distribution and MatLab 
simulations are used to infer the signal coverage of the LED 
in the illuminated indoors space [19] [20]. 
The VLC photosensitive receiver is a two terminal 
double 
PIN 
photodetector 
based 
on 
a 
multilayer 
heterostructure, 
p-i‚Äô(a-SiC:H)-n/p-i(a-Si:H)-n. 
Two 
transparent front and back contacts are used [9]. The device 
(2) 
(1) 

145
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
presents high sensitivity and linear response in the visible 
range 
generating 
at 
the 
terminals 
a 
proportional 
photocurrent. It fast response enables the possibility of high 
speed communications. Modulated light supplied by the 
polychromatic LEDs is used for data transmission. The 
signals are encoded into colours intensities emitted by red, 
green, blue and violet LEDs. The generated photocurrent is 
processed using a transimpedance circuit and the 
proportional voltage is processed, by using signal 
conditioning techniques (adaptive bandpass filtering and 
amplification, triggering and demultiplexing), until the data 
signal is reconstructed at the data processing unit (digital 
conversion, decoding and decision) [16].  
 
B. 
Large Environments emitters and receivers  
Lighting in large environments is designed to illuminate 
the entire space in a uniform way. Ceiling plans for the LED 
array layout is shown in Figure 4. 
1
R1,2
V2,3
B2,2
G1,3
1
1
1
1
2
2
4
5
4
5
5
6
6
6
8
8
8
9
9
9
9
8
4
2
4
6
2
3
7
G3,3
R3,2
3
3
4
2
,2
2
9
9
1
1
1
1
1
7
4
6
6
8
8
8
8
5
7
2
2
8
6
6
6
4
4
4
5
V4,3
5
B4,2
V4,1
R1,4
B2,4
3
R3,4
3
3
B4,4
G1,1
V2,1
7
7
G3,1
7
G5,1
G5,3
R5,4
R5,2
G1,5
V2,5
G3,5
V4,5
G5,5
1
2
8
4
5
6
1
1
1
1
1
1
2
2
2
2
2
2
6
6
6
6
6
9
9
5
9
9
8
8
8
8
8
8
4
4
4
4
4
3
3
9
7
9
7
7
7
7
Hall
B
A
C
 
1
2
3
5
5
R
G
B
V
X
Y
5
1
2
3
5
5
5
5
R1,1
G0,1
G2,1
R3,1
R-1,1
G-2,1
V2,2
V0,2
B1,2
B-1,2
B3,2
V0,0
V2,0
V-20
B1,0
B-1,0
R1,-1
R-3,-1 G-2,-1
G2,-1
V-2,-2
V0,-2
B-1,-2
B-3,-2
B1,-2
R-1,-3
G-2,-3
R1,3
G2,3
G0,-1
R-1,-1
4
4
4
4
4
4
 
 
Figure 4. Illustration of the optical scenarios (RGBV >modulated LEDs 
spots). Cellular topologies:  a) Clusters of cells in square topology . b) 
Clusters of cell in hexagonal topology. 
Two topologies considered: the square, (Figure 4a) and 
the hexagonal (Figure 4b). In the square topology the cells 
have squares shapes while in the hexagonal one they are 
distributed to form a hexagonal shaped constellation. To 
receive the information from several transmitters, the 
receiver must be positioned where the circles from each 
transmitter overlap, producing at the receiver, a multiplexed 
(MUX) signal that, after demultiplexing, acts twofold as a 
positioning system and a data transmitter. In both, the grid 
sizes were chosen to avoid overlap in the receiver from 
adjacent grid points. The coverage map for a square unit cell 
is displayed in Figure 5. All the values were converted to 
decibel.  
 
G
V
B
R
#1
RGBV
#4
RBV
#6
GBV
#8
RGV
#2
RGB
#7
GV
#9 RG
#3
RB
#5 BV
 
Figure 5. Illustration of the coverege map in a square unit cell.   
Friis‚Äô transmission equation is frequently used to 
calculate the maximum range by which a wireless link can 
operate. The coverage map is obtained by calculating the 
link budget from the Friis Transmission Equation [21]. The 
Friis transmission equation relates the received power (PR) 
to  the  transmitted  power (PE),  path loss  distance (LR),  
and  gains from the emitter (GE) and receiver  (GR) in  a  
free-space  communication  link. 
 
PR [dBm]=PE [dBm]+GE [dB]+GR [dB]-LR [dB]                        
Taking into account Figure 3, the path loss distance and the 
emitter gain will be given by:   
 
LR [dB]=22 +20ln d
ÔÅ¨                 
 
 
GE [dB]= 
·à∫ùëö + 1 ùê¥
2ùúãùëëùê∏‚àíùëÖ
2
I·à∫‚àÖ  cos ·à∫ùúÉ          
  
With A the area of the photodetector and dE_R the 
distance between each transmitter and every point on the 
receiver plane. 
(3) 
(4) 
(5) 

146
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
The receptors act as active filters [9] [16]. Due to their 
filtering properties the gains are strongly dependent on the 
wavelength of the pulsed LEDs. Gains of 5, 4, 1.7 and 0.8 
were used, respectively, for the R, G, B and V LEDs. 
The coverage map, Figure 5, was obtained by calculating 
the link budget using the Equation (3). The input parameters 
are displayed in Table 1. All the values were converted to 
decibel. 
TABLE 1. LINK BUDGET INPUT. 
Variable 
Value 
Red 
LED 
Green 
LED 
Blue 
LED 
Violet 
LED 
IN(mcd)  
730 
650 
800 
900 
GE(dB) 
Equation (5) 
GR 
5 
4 
1.7 
0.8 
LR(dB) 
Eq. (4) 
 
Users in different locations are served simultaneously by 
the 
same 
transmitter 
leading 
to 
a 
fine 
grained 
implementation. Due to the overlapping coverage area of 
adjacent Aps joint transmission exists. In Table II, and for 
both topologies, the overlap regions below each AP 
(footprints) are displayed.  Results show that the received 
power in each cell depends on the receiver position. Nine 
separated levels were found, in the square topology, and 
correspond to the nine possible combinations of the pulsed 
LEDs framed at corners of the unit cell (Figure 4a).  The 
same occurs in the hexagonal topology (Figure 4b) where 
five different levels are detected. 
 
TABLE 2. FINE-GRAINED TOPOLOGIES: FOOTPRINT REGIONS. 
Footprint 
regions 
Square topology 
Hexagonal 
topology 
#1 
RGBV 
RGV 
#2 
RGB 
GBV 
#3 
RB 
RBV 
#4 
RBV 
RGB 
#5 
BV 
RGBV 
#6 
GBV 
- 
#7 
GV 
- 
#8 
RGV 
- 
#9 
RG 
- 
 
In both topologies, each node, X i,j, carries its own color, 
X, (RGBV) as well as its ID position in the network (i,j). 
The overlap regions (footprints) are pointed out in Figure 4 
and reported in Table 1. The device receives multiple 
signals, finds the centroid of the received coordinates and 
stores it as the reference point position (# in Figure 5). 
 
C. 
Modulation technique 
An on-off keying (OOK) modulation scheme was used 
providing a good trade-off between system performance and 
implementation complexity.  
The OOK transmits data by sequentially turning on and 
off the LED providing digital dimming support. To create a 
communication protocol to ensure the required system 
performance and overcome the technology constraints, a 32 
bits data frame was designed. Three control fields, one for 
synchronism (Sync.) and two for the identification of the 
cell (ID) begin each frame. This sequence is followed by a 
fourth block that is for the payload, as it is shown, for both 
topologies, in Figure 6. A stop bit is used at the end of each 
frame.  
 
 
 
Figure 6. Data frame structure. Representation one encoded message, in a 
time slot from the array in the network: a) Square topology; R12 ; G1,3 ; B2,2 
and V2,3 are the transmitted node packet.       B) Hexagonal topology; R-1,-1; 
G0,-1; B1,0 and V0,0  are the transmitted node packet. 
The first five bits in the frame are used for time 
synchronization. The same synchronization header [10101], 
in an ON-OFF pattern, is imposed simultaneously to all 
emitters. Each colour signal (RGBV) carries its own ID-
BIT, so, the next bits give the coordinates of the emitter 
inside the array (Xi,j). Cell‚Äôs IDs are encoded using a binary 
representation for the decimal number. In the square 
topology (Figure 4a) six bits are used: the first three for the 
binary code of the line and the other three for the column. In 
the hexagonal topology, 60¬∫ Cartesian coordinates were 
applied (Figure 4b). Here, an extra bit was added at the 

147
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
beginning of the binary code to represent the number‚Äôs sign: 
setting that bit to 0 is for a positive number, and setting it to 
1 is for a negative number. The remaining bits in the 
number indicate the absolute value. So, the next eight bits 
(ID) are assigned, respectively, to the x and y coordinate (I,j) 
of the emitter in the array (Figure 3b). For both, the last bits, 
in the frame, are reserved for the message send by the Xij 
node (payload data). With this information, the method will 
give an unique answer, i.e., the location of the receiver in 
the array (Xi,j) and the broadcast information. 
Results show that in the square network R1,2 , G1,3, B2,2 
and V2,3 are the transmitted node packets, in a time slot, 
from the unit cell where the restrooms are located (Figure 
4a). In the hexagonal network, the nodes R-1,-1, G0,-1, B1,0 and 
V0,0, at the first ring of the restaurant zone (Figure 4b) are 
the transmitters. 
IV. 
EXPERIMENTAL RESULTS AND DISCUSSION 
In this section, the main results are presented and 
discussed. 
 
A. 
Decoding 
In a data frame, the MUX signal at the receiver, due to 
the joint transmission of four R, G, B and V optical signals, 
is presented in Figure 7. The data acquisition was obtained 
under environment light. On the top, the bit sequence used 
to drive the LEDs is displayed. This sequence allows all the 
on/off sixteen possible combinations of the four input 
channels (24). 
0.0
0.5
1.0
1.5
2.0
2.5
0
1
2
3
4
5
6
7
8
#1
d15
d14
d13
d12
d11
d10
d9
d8
d7
d6
d5
d4
d3
d2
d1
d0
R
G
B
V
0 0 0 0
0 0 0 1
0 0 1 0
0 0 1 1
0 1 0 0
0 1 0 1
0 1 1 0
0 1 1 1
1 0 0 0
1 0 0 1
1 0 1 0
1 0 1 1
1 1 0 0
1 1 0 1
1 1 1 0
1 1 1 1
R G B V
 
 
MUX (ÔÅ≠ÔÅÅ)
Time (ms)
Figure 7. MUX signal of the calibrated cell. On the top the transmitted 
channels packets [R, G, B, V] are depicted. A received MUX signal is also 
superimposed to exemplify the decoding process. 
 
Results show that the code signal presents as much 
separated levels as the on/off possible combinations of the 
input 
channels, 
allowing 
decoding 
the 
transmitted 
information [16]. All the ordered levels (d0-d15) are pointed 
out at the correspondent levels, and are displayed as 
horizontal dotted lines. In the right hand side the match 
between MUX levels and the 4 bits binary code assigned to 
each level is shown. For demonstration of the decoding 
technique, a signal received, in the same frame of time, 
when the receiver is in the main the hall (Figure 4a) 
underneath position #1, is also added. Comparing the 
calibrated levels (d1-d15) with the different assigned 4-digit 
binary code, the decoding is straightforward.  
After decoding each input channel, and taking into 
account the frame structure (Figure 6), the position of the 
receiver and its ID in the network is revealed [22] [23]. The 
footprint position comes directly from the synchronism 
block, where all the received channels are simultaneously on 
or off. For instance, in any footprint #1 the maximum 
amplitude detected (see arrow) corresponds to the binary 
word [1111], meaning that the received information comes 
from the overlap of the four input channels. 
 
B. 
Positioning  
In Figure 8, for the same frame time and in three 
successive instants (t1, t2, t3), the received MUX signals, 
when the receiver is in the main hall and moves from #5 to 
#9, through #1 (Figure 4a), confirm the decoding process. 
0.0
0.5
1.0
1.5
2.0
2.5
t3
t3
t1
t2
t1
[#5]
[#7]
[#3]
[#9]
[#1]
0011
0101
1100
1010
1111
RGBV
ID
Sync
Payload data
V2,3
B2,4
G3,3
R3,4
 
 
IMUXnor
Time (ms)
 
 
 
 
Figure 8. Fine-grained indoor localization and navigation in successive 
instants (t1, t2 and t3): MUX/DEMUX signals in a point-to-point path across 
the main hall (#5>#1> #9) at the. On the top the complete transmitted 
channels packets [R, G, B, V] are decoded. 
Decoding, when the four channels overlap (#1), is set on 
the top of the figure to direct into the packet sent by each 

148
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
node. The footprint position comes directly from the 
synchronism block. For instance, if the maximum amplitude 
detected corresponds to the binary word [0011], it means 
that it has only received the overlap transmission from the 
blue and the violet channels (footprint #5). In the right side 
of the figure the levels ascribed to #1, #3, #5 and #9 are 
point it out. 
Each decoded message carries, also, the transmitter‚Äôs 
node address. So, the next block of six bits, in the square 
topology (or eight in the hexagonal one), gives de ID of the 
received node. In Figure 8, in position #5 the network 
location of the transmitters are B2,4 [010;100] and V2,3 
[010;011] and while in #1 the assigned transmitters are R3,4, 
G3,3, B2,4 and V2,3. The last block is reserved for the 
transmission of the advertising (Payload data). The stop bit 
(0) is used always at the end of each frame. 
  
C. 
Point-to-point Route 
To compute the point-to-point along a path, we need the 
data along the path. The input of the aided navigation 
system is the coded MUX signal, and the output is the 
system state decoded at each time step (ÔÅÑt). As a proof of 
concept, in the lab, a navigation data bit transition was 
tested by moving the receiver along known pattern path. 
 
0.0
0.5
1.0
1.5
2.0
2.5
R
#4(t1)
#3 (t3)
#5 (t2)
[1011]
[1110]
[1111]
RGBV
Payload data
ID
Sync
V0,-2
B-1,-2
G-2,-3
R-1,-3
 
 
IMUX nor
Time (ÔÅ≠s)
 
 
 
 
 
Figure 9 
Fine-grained indoor localization and navigation in successive 
instants instants (t1, t2 and t3). Signal acquisition through the restaurants 
area (R). On the top the transmitted channels packets are decoded [R, G, B, 
V]. 
In this example (Figure 8) at t1 the user enters the hall by 
line #5, it goes to position #1 at t2 and it chooses the 
boarding terminal C (#5) at t3. Results show that, as the 
receiver moves between generated point regions, the 
received information pattern changes. Between two 
consecutive data sets, there is a navigation data bit transition 
(channel is missing or added). We observe that when the 
receiver moves from #1 to # 9 (Figure 8) two different ID 
channels are missing (B2,4 and V2,3). Here, the 4-bynary bit 
code has changed from [1111] to [1100].  
In Figure 9, a path across the hexagonal topology was 
also tested. Here, the receiver enters the restaurants area 
(#4> #5> #3). 
Main results from both topologies show that fine grained 
localization is achieved by detecting the wavelengths of the 
received channels in each region. The location and path of a 
mobile receiver was obtained based on the LED-based 
navigation system. In an orthogonal layout (hall), the square 
topology is the best. It allows crossroads and the client can 
walk easily in the horizontal, vertical or both directions. In 
concentric layouts, to fill all the space with hexagon 
presents advantages (restaurants, and shops areas). Here, the 
client can move around and walk between the different rings 
toward the outside region.  
 
D. 
Bidirectional Communication 
The VLC is a wireless broadband technology. It provides 
multiuser with simultaneous access communication. All the 
nodes communicate with each other through a centralized 
controller and the signal is used to establish a point-to-point 
link between the transmitters and the receiver.  
Bidirectional communication between VLC emitters and 
receivers at a handheld device can be established through a 
control manager linked to a signboard. Each ceiling lamp 
broadcasts a message with its ID and useful information 
which is received and processed by the receiver. Using a 
white polychromatic LED as optical source for uplink, the 
receptor sends to the local controller a ‚Äúrequest‚Äù message 
with its location (ID) and adds its needs for the available 
time (Payload data). For route coordination, the local 
controller emitter sends the downlink ‚Äúresponse‚Äù message. 
In Figure 10, the MUX signal assigned to a ‚Äúrequest‚Äù and a 
‚Äúresponse‚Äù message are displayed. In the top, the decoded 
information is presented. In the right side, the match 
between the MUX signal and the 4-binary code is pointed 
out. 
Here, in a time slot, the traveler, in position #3 (R3,2 , 
B2,2), sends to the central controller the message ‚Äúrequest‚Äù 
in order to add the points of interest (boarding or the right 
track). After that it is advised, through a ‚Äúresponse‚Äù 
message, that the request was received, how to reach its 
destination in time and how to use location based services. 
 
4
5 3

149
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
Request
Response
 
0.0
0.5
1.0
1.5
2.0
2.5
0.0
0.5
1.0
 INFO 
#3
#3
0 1 1 0 1 0
0 1 1 0 1 0
0 1 0 0 1 0
0 0 0 0 0 0
0 1 0 0 1 0
0 0 0 0 0 0
Response
Request
[0000]
[0010]
[1000]
  ID    
B2,2
R3,2
RGBV
[1010]
 Sync
      Payload Data    
B2,2
R3,2
 
 
I MUX nor
Time (ms)
 
Figure 10. Bidirectional communication: MUX/DEMUX signals assigned 
to a ‚Äúrequest‚Äù and a ‚Äúresponse‚Äù message. On the top the transmitted 
channels packets [Xi,j] are decoded. 
In bidirectional VLC transmission we use different codes 
in the frame structure for uplink and downlink. Taking into 
account the frame structure (Figure 6), results show that the 
codification of both signals is synchronized (Sync). The 
‚Äúrequest‚Äù message includes the complete address of the 
traveller (Sync+ID) and the help need (Payload Data). In the 
‚Äúresponse‚Äù message the block (ID), in a pattern [000000], 
means that a response message, from the local manager, is 
being sent. The next block (6 bits) identifies the address 
(INFO) for which the message is intended and finally in the 
last block appears the requested information (Payload Data). 
Here, the emitter controller [000000] responds to a request 
of a passenger located in position # 3 (R3,2 , B2,2) and sends 
back the requested information. 
 
E. 
Multi-person cooperative localization 
An unforeseen pandemic is facing the world caused by a 
corona virus known as SARS-CoV-2. Transmission of the 
coronavirus is possible indoors, especially when people 
spend extended periods in crowded and poorly ventilated 
rooms [ 24 ]. The widely accepted main transmission 
mechanism is through droplet borne pathways.  
Person-to-person spread to be the most common form of 
transmission of COVID-19, occurring mainly among people 
who are within 2m of each other for a prolonged period of 
time. This means people should stay the recommended 
distance apart from others. It also means people should 
avoid gathering in groups, crowded places and mass 
gatherings. So, in crowded building the routes to a specific 
place should avoid those regions. We consider that the risk 
of transmission exists if the distance between two users is 
less than 2 m. The system has to alert the users to stay away 
from those regions and to plan the better route to the desired 
wayfinding services. 
 
Track 1
Track 2
 
 
Figure 11 Safety close person virtual track. 
The existence of congested zones can be locally detected 
by the ‚Äúmesh / cellular‚Äù hybrid controller (Figure 1b), which 
is also equipped with a modem providing IP base 
connectivity to the central manager. The hybrid controller 
integrates the number of requests and individual positions, 
received during the same time interval. Once the individual 
positions are known, the relative positions are calculated. If 
the relative position is less than 2 m, a contamination risk 
locally exists and an alert message is send for the users and 
the CM is informed. This alert allows the CM to recalculate, 
in real time, the best route for the users that request 
wayfinding 
services 
avoiding 
crowded 
regions 
as 
exemplified in Figure 11.  
V. 
CONCLUSIONS  
A VLC multi-person cooperative localization dynamic 
LED-assisted 
navigation 
system 
for 
large 
indoor 
environments was proposed. For lighting, data transmission 
and positioning, white LEDs were used. A SiC optical 
MUX/DEMUX mobile receiver decodes the data and based 
on the synchronism and ID of the joint transmitters infers its 
location, point-to-point path, timing and user flows.  
A VLC scenario was established and the communication 
protocol presented. Bidirectional communication between 
the infrastructures and the mobile receivers were analysed. 
Two cellular networks were tested and compared: square 
and hexagonal. Main results show that, for both topologies, 
the location of a mobile receiver, concomitant with data 
transmission is achieved. The LED-aided VLC navigation 
system makes possible to determine the position of a mobile 

150
International Journal on Advances in Software, vol 14 no 1 & 2, year 2021, http://www.iariajournals.org/software/
2021, ¬© Copyright by authors, Published under agreement with IARIA - www.iaria.org
target inside the network, to infer the travel direction along 
the time and to interact with received information. 
Minding the benefits of VLC, it is expected that this type 
of communication will have an important role in positioning 
applications. Moving towards real implementation, the 
performances of such systems still need to improve. As a 
future goal, we plan to finalize the embedded application, 
for experimenting in several network layouts. Effects as 
synchronization, shadowing and ambient light noise will be 
minimized by distributing lighting sources (MIMO 
techniques) to optimize the coverage. 
ACKNOWLEDGEMENTS 
The work was sponsored by FCT ‚Äì Funda√ß√£o para a Ci√™ncia 
e a Tecnologia, within the Research Unit CTS ‚Äì Center of 
Technology and Systems, reference UIDB/00066/2020. The 
project 
IPL/IDI&CA/2020/Geo-Loc/ISEL, 
is 
also 
acknowledge. 
REFERENCES 
 
[1] M. Vieira, M. A. Vieira, P. Louro, P. Vieira, and A. Fantoni 
‚ÄúWayfinding Services in Crowded Buildings Through Visible 
Light‚Äù The Sixth International Conference on Advances in 
Sensors, 
Actuators, 
Metering 
and 
Sensing, 
ALLSENSOR2021, Copyright: Copyright (c) IARIA, 2021, 
July 18, 2021, ISSN: 2519-836X, ISBN: 978-1-61208-875-4, 
pp. 1-8. 
[2] C. Yang and H. R. Shao,, ‚ÄúWiFi-based indoor positioning,‚Äù 
IEEE Commun. Mag., vol. 53, no. 3, pp. 150‚Äì157, Mar. 2015. 
[3] X. Y. Lin, T. W. Ho, C. C. Fang, Z. S. Yen, B.J. Yang, and F. 
Lai, ‚ÄúA mobile indoor positioning system based on iBeacon 
technology,‚Äù in Proc. Int. Conf. IEEE Eng. Med. Biol. Soc., 
pp. 4970‚Äì4973, 2015. 
[4] C. H. Huang, L. H. Lee, C. C. Ho, L. L. Wu, and Z. H. Lai, 
‚ÄúReal-time rfid indoor positioning system based on kalman 
filter 
drift 
removal 
and 
heron-bilateration 
location 
estimation,‚Äù IEEE Trans. Instrum. Meas., vol. 64, no. 3, pp. 
728‚Äì739, Mar. 2015. 
[5] N. U. Hassan, A. Naeem, M. A. Pasha, T. Jadoon, and C. 
Yuen, ‚ÄúIndoor positioning using visible led lights: A 
survey,‚ÄùACM Comput. Surv., vol. 48, pp. 1‚Äì32 , 2015. 
[6] E. Ozgur E. Dinc, O. B. Akan, ‚ÄúCommunicate to illuminate: 
State-of-the-art and research challenges for visible light 
communications,‚Äù Physical Communication 17 pp. 72‚Äì85, 
2015. 
[7] D. Tsonev, H. Chun, S. Rajbhandari, J. McKendry, S. Videv, 
E. Gu, M. Haji, S. Watson, A. Kelly, G. Faulkner, M., 
Dawson, H. Haas, and D. O‚ÄôBrien, ‚ÄúA 3-Gb/s single-LED 
OFDM-based wireless VLC link using a Gallium Nitride 
ŒºLED,‚Äù IEEE Photon. Technol. Lett. 26 (7), pp.637‚Äì640, 
2014. 
[8] D. O‚ÄôBrien, H. L. Minh, L. Zeng, G. Faulkner, K. Lee, D. 
Jung, Y. Oh, and E. T. Won, ‚ÄúIndoor visible light 
communications: challenges and prospects,‚Äù Proc. SPIE 7091, 
709106, 2008. 
[9] M. Vieira, P. Louro, M. Fernandes, M. A. Vieira, A. Fantoni 
and J. Costa, ‚ÄúThree Transducers Embedded into One Single 
SiC Photodetector: LSP Direct Image Sensor, Optical 
Amplifier and Demux Device,‚Äù Advances in Photodiodes 
InTech, Chap. 19, pp. 403-425, 2011. 
 
[10] M. A. Vieira, P. Louro, M. Vieira, A. Fantoni, and A. Steiger-
Gar√ß√£o, ‚ÄúLight-activated amplification in Si-C tandem 
devices: A capacitive active filter model,‚Äù IEEE sensor 
journal, 12, no. 6, pp. 1755-1762, 2012. 
[11] A. Jovicic, J. Li, and T. Richardson, ‚ÄúVisible light 
communication: opportunities, challenges and the path to 
market,‚Äù Communications Magazine, IEEE, vol. 51, no. 12, 
pp. 26‚Äì32, 2013. 
[12] S. B. Park, D. K.Jung, H. S. Shing, D. J. Shing, Y. J. Hyun, 
K. Li, and Y. J. Oh, ‚ÄúInformation broadcasting system based 
on visible light signboard,‚Äù presented at Wireless and Optical 
Communication 2007, Montreal, Canada, 2007. 
[13]  R. Rajesh, ‚ÄúDynamic Vehicle and control‚Äù Mechanical 
Engineering Series, ISBN 978-1-4614-1433-9. 2012. 
[14]  J. Ackermann, J. Guldner, W. Sienel, R. Steinhauser, and  V. 
Utkin, ‚ÄúLinear and Nonlinear Controller Design for Robust 
Automatic Steering‚Äù IEEE Transactions on Control Systems 
Technology ( Volume: 3, Issue: 1, Mar 1995), pp. 132 ‚Äì 143, 
DOI: 10.1109/87.3,70719,  1995. 
[15] A. Yousefpour, C. Kong, J. P. Jue, ‚ÄúAll one needs to know 
about fog computing and related edge computing paradigms: 
A complete survey‚Äù, Journal of Systems Architecture,Volume 
98, pp. 289-330, 2019. 
[16] M. Vieira, M. A. Vieira, P. Louro, P. Vieira, A. Fantoni, 
‚ÄúFine-grained indoor localization: optical sensing and 
detection,‚Äù Proc. SPIE 10680, Optical Sensing and Detection 
V, 106800H. 9 May 2018.  
[17] M. Vieira, M. A. Vieira, P. Louro, P. Vieira, A. Fantoni, 
‚ÄúLight-emitting diodes aided indoor localization using visible 
light communication technology,‚Äù Opt. Eng. 57(8), 087105, 
2018. 
[18]  Y. Zhu, W. Liang, J. Zhang, and Y. Zhang, ‚ÄúSpace-
Collaborative Constellation Designs for MIMO Indoor 
Visible Light Communications,‚Äù IEEE Photonics Technology 
Letters, vol. 27, no. 15, pp. 1667‚Äì1670,  2015. 
[19] Y. Qiu, H-H. Chen and W-X. Meng, ‚ÄúChannel modeling for 
visible light communications‚Äîa survey‚Äù, Wirel. Commun. 
Mob. Comput. 2016; 16:2016‚Äì2034, 2016.  
[20] S. Imran Raza, S. Jabeen, R. Chaudhry, S. A. Hussain, A. 
Saeed, M. S. Bhatti and M. H. Raza, ‚ÄùOptical Wireless 
Channel 
Characterization 
For 
Indoor 
Visible 
Light 
Communications‚Äù, Indian Journal of Science and Technology, 
Vol 8 (22), DOI: 10.17485/ijst/2015/v8i22/70605, 2015. 
[21]  H. T. Friis, ‚ÄúA note  on  a  simple  transmission  formula‚Äù 
Proc.  IRE34, pp. 254‚Äì256, 1946. 
[22] M. A. Vieira, M. Vieira, P. Louro,V. Silva, and P. Vieira, 
"Optical signal processing for indoor positioning using a-
SiCH technology," Opt. Eng. 55 (10), 107105, 2016.  
[23] M. Vieira, M. A. Vieira, P. Louro, and Vieira, "Positioning 
and advertising in large indoor environments using visible 
light communication," Opt. Eng. 58(6), 066102, 2019. 
[24] C. Iddon, A. Hathaway and S. Fitzgerald, ‚ÄúCIBSE COVID-19 
Ventilation Guidance‚Äù, CIBSE, 2020.  

