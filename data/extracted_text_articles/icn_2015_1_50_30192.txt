Analyzing the Optimum Switching Points for Adaptive FEC in Wireless Networks with 
Rayleigh Fading 
 
Moise S. Y. Bandiri 
National Institute of Telecommunications - Inatel 
Santa Rita do Sapucaí, Brazil 
e-mail: jumoses2000@yahoo.fr 
José Marcos C. Brito 
National Institute of Telecommunications - Inatel 
Santa Rita do Sapucaí, Brazil 
e-mail: brito@inatel.br
 
 
Abstract—Adaptive techniques have an important role in 
modern wireless communications networks, like cognitive radio 
networks. Adaptive modulation and adaptive Forward Error 
Correction (FEC) are two very important approaches used to 
improve the performance of the wireless networks. In an 
adaptive technique, a key factor to maximize the performance of 
the system is the optimum switching point between neighboring 
modulations, in an adaptive modulation system, or codes, in an 
adaptive FEC system. In this paper, we analyze the optimum 
switching points for adaptive FEC in a wireless network with 
Rayleigh fading. We compute the optimum switching points 
considering three criteria: maximum throughput, maximum 
packet error rate target and delay to transmit a correct packet. 
We show that the optimum switching points depend on several 
parameters, including the channel model and the selected 
criterion to define the switching points.   
Keywords—adaptive FEC; performance analysis; optimum 
switching points. 
I. 
INTRODUCTION 
A mandatory issue for the next generation of wireless 
networks is to improve the performance. Several technologies 
have been proposed to achieve this goal. One important 
technology is cognitive radio networks, in which the radio 
adjusts its parameters as a function of the radio environment in 
order to achieve the best performance [1]. 
Adaptive techniques (like adaptive modulation and 
adaptive error control) are fundamental to implement cognitive 
radio networks and also for other candidate technologies for 
the next-generation of the wireless networks. In particular, 
adaptive Forward Error Correction (FEC) schemes have been 
proposed to improve Quality of Service (QoS) for several 
technologies and techniques [2]-[7]. 
Adaptive FEC schemes vary the number of parity bits and, 
consequently, the error correction capacity of the error 
correcting code as a function of the quality in the wireless link. 
A key point in implementing an adaptive FEC scheme is to 
define the optimum switching point from one error correcting 
code to its neighboring error correcting code. In our analysis, 
we consider two error correcting codes as neighboring if their 
error correction capacity differs by one bit. In other words, two 
error correcting codes are neighboring if one has an error 
correction capacity equal to t bits and the other one has an error 
correction capacity equal to (t + 1) or (t – 1) bits. 
The optimum switching points for an adaptive FEC system 
have been analyzed by Brito and Bonatti in [8]. However, 
those analyses consider a memoryless channel, which may not 
be appropriate for some wireless links. In a more general case, 
the wireless channel has memory and the results presented in 
[8] are imprecise. 
The goal of this paper is to analyze the optimum switching 
points for an adaptive FEC system considering a channel with 
Rayleigh fading. The criteria used to compute the optimum 
switching points are the same used in [8]: maximum 
throughput, for real time traffic, maximum Packet Error Rate 
(PER) target and, for non-real time traffic, the delay to transmit 
a correct packet. 
To define the switching points it is necessary to adopt a 
model to calculate the PER in a Rayleigh channel. The model 
considered in our analysis has been presented by Sharma, 
Dholakia and Hassan in [9] and is summarized in Section II of 
this paper. 
  The remainder of this paper is organized as follows: in 
Section II, we summarize the mathematical model used to 
compute the PER in the wireless channel; in Section III, we 
analyze the optimum switching points that maximize the 
throughput in the wireless network; in Section IV, we consider 
the maximum PER target criterion; in Section V, we compute 
the optimum switching points considering the delay to transmit 
a correct packet as the QoS parameter; and finally, in Section 
VI, we present our conclusions. 
II. 
MODEL TO COMPUTE THE PACKET ERROR RATE  
In a Rayleigh channel, the errors tend to occur in bursts and 
the PER can not be computed using the Binomial distribution. 
Thus, it is necessary to use a model that considers the memory 
of the channel.  
Several papers address the problem of calculating the PER 
in a channel with burst errors [9]-[12]. In this paper, we use the 
analytical model presented by Sharma, Dholakia and Hassan in 
[9]. In this model, the Rayleigh channel is represented by a 
Gilbert-Elliott Channel (GEC).  
A GEC is represented by a discrete time Markov chain with 
two states: Good (G) and Bad (B). Figure 1 illustrates a GEC 
with transition probabilities  and ; each state is modeled as a 
Binary Symmetric Channel (BSC) with bit error probabilities 
pg, in G state, and pb in B state. 
The steady state probabilities of the Markov chain 
illustrated in Figure 1 are given by 





g 
                                     (1) 
    





b 
                                     (2) 
23
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks

where g and b are the steady state probabilities of the 
good and bad states, respectively. 
 
 
G
B

1 

1 
0
0
1
1
1-pg
1-pg
pg
pg
0
0
1
1
1-pb
1-pb
pb
pb
 
Figure 1. Gilbert-Elliott Channel. 
Considering a slow fading channel, with respect to a bit 
interval, the probability density function of the Signal-to-Noise 
Ratio (SNR) is given by  
 
0
1







 





e
f
                           (3) 
where  is the average SNR and  is the instantaneous 
SNR. 
The status of the channel is defined by a given threshold 
(ψ): the channel is considered in good state if the SNR is above 
the threshold and in bad state if the SNR is below the 
threshold.  
The transition probabilities of the GEC can be calculated by 
[9]:     
1
2




e
f d T


                                   (4) 
            




2
fd T
                                     (5) 
where T is the symbol interval and fd is the maximum 
Doppler speed. The parameter  is the ratio between the 
threshold () and the average SNR in the wireless channel. 
Following [9], in our analysis we set the parameter  equal to 
0.1, meaning that a SNR 10 dB below the average SNR is the 
condition resulting in the transition from the good to the bad 
state.  
The Bit Error Rate (BER) for each state of the channel is 
computed by (6) and (7) [9]: 
   
 












d
f
d
f
BER
pg
                             (6) 
   
 










0
0
d
f
d
f
BER
pb
                            (7) 
where BER() is the bit error rate for an Additive White 
Gaussian Noise (AWGN) channel with SNR equal to  and 
f() is the probability density function of the SNR for Rayleigh 
fading, given by (3).  
After calculating the bit error rate by (6) and (7), we can 
compute the packet error rate in each state of the channel. In 
this paper, we are interested in analyzing the optimum 
switching points of an adaptive FEC system. Thus, we 
considered that an (n,k) error correcting block code is used in 
the wireless link, where k is the number of information bits and 
(n – k) is the number of parity bits in the block code. Defining 
the error correction capacity of the code as t, the PER in each 
state can be computed by [9]:  




i
g
i
n
g
t
i
n
i
g
p
p
p
P







 

1
1
0
                 (8) 




i
b
i
n
b
t
i
n
i
b
p
p
p
P







 

1
1
0
                  (9) 
where pg and pb are the BER in good and bad states,  given 
by (6) and (7), respectively.  
Finally, the packet error rate in the Rayleigh channel is 
computed by 



b 
b
g
g
P p
P p
PER




                    (10) 
where G and B are given by (1) and (2), respectively, and 
P(pg) and P(pB) are given by (8) and (9), respectively. 
III. 
OPTIMUM SWITCHING POINTS BASED ON THE 
MAXIMUM THROUGHPUT CRITERION 
In this section, we analyze the switching points that 
maximize the throughput in the wireless link. To define the 
throughput we consider two factors: the overhead due to the 
error correcting code, expressed by the ratio between the 
number of information bits, k, and the total number of bits in a 
packet, n; and the percentage of packets received without error 
or containing only correctable errors, computed by 1 – PER.  
Thus, only packets received without error, after the error-
correcting code action, are considered when computing the 
throughput (some authors refer to this as ‘goodput’). As our 
definition of throughput does not consider the bandwidth of the 
channel and the modulation used in the wireless link, we refer 
to this throughput as a normalized throughput. Thus, the 
normalized throughput in the wireless link is given by:  

PER
n
k
T



1
                               (11) 
The parameter n depends on the current code used in the 
adaptive FEC system and PER is the packet error rate for this 
code, given by (10).  
To compute the parameter n as a function of the error 
correction capacity, t, of the current code, it is necessary to 
define a particular family of codes or to use some known 
bound. In this paper, we opted to use the bound for the Bose, 
Chaudhuri and Hocquenghem (BCH) code. The BCH codes 
form a large class of powerful random error-correcting cyclic 
codes. The BCH bound can be summarized as: for any 
positive integers m (m  3) and t (t < 2m – 1) exists a (n,k) 
binary t-error correcting BCH code with the following 
parameters: [13] 
24
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks



1
2
1
2
min






t
d
mt
k
n
n
m
                                   (12) 
where dmin is the minimum distance of the code. 
 In order to compare our results with those presented in 
[8], we set k = 424 bits when computing the PER. For this 
value of k, a BCH code with suitable natural length or suitable 
number of information digits may not be obtained. However, 
by subtracting a proper number of bits from the natural code, a 
shortened BCH code can be implemented [13]. 
Thus, using the bounds given by (12) and considering k = 
424 bits, we can compute the number of parity bits (and thus 
the value of n) as a function of the error correction capacity of 
the code, t, as: 




59
t
if  10
10
9
t
if 1 
9








t
k
n
t
k
n
                      (13) 
We are interested in computing the throughput as a 
function of the SNR in the channel. For this we follow the 
steps: 
1. Define a given modulation (reference modulation) to 
the wireless channel. We use Quadrature Amplitude 
Modulation (QAM) with 256 points in its constellation 
(256-QAM modulation) 
2. Compute the BER as a function of the Symbol Energy 
to Noise Density Ratio (ES/N0) in an AWGN channel, 
using classical formulas presented in the literature, like 
in [14]. 
3. Using (6) and (7), compute the BER in the good and 
bad states. 
4. Define the error correction capacity of the current code 
and, using (13), the number of parity bits in the code 
and after the total number of bits, n. 
5. Using (8), (9) and (10), compute the PER in the 
Rayleigh channel. 
6. Finally, compute the normalized throughput for the 
current code using (11). 
Figure 2 shows the normalized throughput as a function of 
ES/N0 considering codes with different error correction 
capacity, a 256-QAM in the wireless link and k = 424 bits. 
The optimum switching point between two neighboring codes 
is obtained by the cross point of the corresponding throughput 
curves. 
Table I summarizes the optimum switching points 
presented in Figure 2 and, to permit comparisons, the 
optimum switching points previously published in [8]. 
30
35
40
0.7
0.8
0.9
t=0
t=1
t=2
t=3
t=4
t=5
Es/No (dB)
Normalised Throughput
 
Figure 2. Normalized throughput as a function of Es/No for k = 424 bits and 0 
 t  5.  
TABLE I.  OPTIMUM SWITCHING POINTS FOR MAXIMUM THROUGHPUT 
CRITERION, K = 424 BITS. 
Switching 
Es/N0 (dB) 
obtained 
from Fig. 2 
Es/N0 (dB) 
obtained 
from [8] 
From 
to 
t = 0 
t = 1 
37.7 
30.7 
t = 1 
t = 2 
35.1 
29.0 
t = 2 
t = 3 
33.6 
28.1 
t = 3 
t = 4 
32.6 
27.5 
t = 4 
t = 5 
31.8 
27.0 
 
Based on the results presented on Table I, we can conclude 
that the optimum switching points depend on the channel 
model.  
Another interesting point is to investigate the influence of 
the packet length, k, in the optimum switching points. For this, 
we compute again the normalized throughput considering now 
k = 848 bits (note that, with this new value of k, the Equation 
(13) needs to be modified based on the bounds presented on 
(12)). Figure 3 shows the new results obtained and Table II 
compares the optimum switching points for k = 424 bits and k 
= 848 bits.  
 
25
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks

 
30
35
40
0.7
0.8
0.9
t=0
t=1
t=2
t=3
t=4
t=5
Es/No (dB)
Normalised Throughput
 
Figure 3. Normalized throughput as a function of Es/No for k = 848 bits and 0 
 t  5.  
TABLE II. OPTIMUM SWITCHING POINTS FOR MAXIMUM 
THROUGHPUT CRITERION, K = 848 BITS. 
Switching 
Es/N0 (dB)  k 
= 848 bits 
Es/N0 (dB)   
k = 424 bits 
from 
to 
t = 0 
t = 1 
38.9 
37.7 
t = 1 
t = 2 
36.4 
35.1 
t = 2 
t = 3 
35.1 
33.6 
t = 3 
t = 4 
34.1 
32.6 
t = 4 
t = 5 
33.4 
31.8 
 
Based on the results summarized in Table II, we can 
conclude that the optimum switching points depend on the 
number of information bits in the packet, with the ES/N0 in the 
switching points increasing when k increases. 
It is important to observe that the PER in the optimum 
switching points can be unacceptable for some applications. 
For example, considering k = 848 bits, the PER is about 0.11 
in the switching points. This result leads us to the next 
criterion to define the optimum switching points: the 
maximum PER target.  
IV. OPTIMUM SWITCHING POINTS BASED ON THE 
MAXIMUM PER TARGET 
The criterion presented in the last section maximizes the 
throughput but does not consider any restriction about PER. If 
the application needs to maintain the PER below a given 
threshold, the maximum PER target is a better criterion. In this 
criterion we compute the PER for each error correcting code, 
as a function of the ES/N0. The optimum switching point in 
this case is the cross point between the PER curve and the 
PER threshold. To illustrate this approach, Figure 4 shows the 
switching points considering the maximum PER target equal 
to 0.15 (actually, this value is too high for most of the 
applications and has just been chosen to illustrate the concept). 
To plot Figure 4 we set k = 424 bits and we consider 256-
QAM modulation. Table III summarizes the switching points 
showed in Figure 4.  
 
 
 
30
35
40
0.1
0.2
0.3
0.4
t=0
t=1
t=2
t=3
t=4
PERmáx
Es/No (dB)
Packet Error Rate (PER)
 
 
Figure 4. Switching points considering maximum PER criterion with target 
equal to 0.15 for 0  t  5 . 
TABLE III. OPTIMUM SWITCHING POINTS FOR MAXIMUM PER 
TARGET. 
Switching 
Es/N0 (dB) 
from 
to 
t = 0 
t = 1 
36.7 
t = 1 
t = 2 
34.3 
t = 2 
t = 3 
32.9 
t = 3 
t = 4 
32.0 
t = 4 
t = 5 
31.3 
 
Based on the results presented in Table III and comparing 
these results with those presented in Section II and those 
presented on reference [8], we can conclude that: the optimum 
switching points depend on the selected criterion; again, the 
optimum switching points depend on the channel model. 
V. 
OPTIMUM SWITCHING POINTS BASED ON THE DELAY  
In this section, we consider the mean delay to transmit a 
correct packet as the criterion to define the optimum switching 
points. This criterion is appropriate for non-real time 
applications where we can retransmit a packet in order to 
guarantee that all packets delivered to the receiver are correct. 
To compute the delay it is necessary to define a reference 
scenario in terms of multiple access and the strategy to 
retransmit packets. In order to permit comparisons, we use 
here the same reference scenario used in [8]: 
 
A TDMA (Time Division Multiple Access) system 
with X time slots in a frame, whit n bits being 
transmitted in each time slot. 
 
Each packet is transmitted over Z frames (one packet 
needs Z time slots to be transmitted). 
 
Each packet is retransmitted until being correctly 
received 
(we 
consider 
that 
the 
number 
of 
retransmissions in unlimited). 
26
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks

 
A slow fading channel, meaning that the duration of 
the fades is greater than de duration of the packet 
transmission. 
 
Each time slot is protected by an error correcting 
code, but the retransmissions occur at the packet level 
and not at the time slot level. In other words, the 
receiver requests retransmission of the whole packet.  
 
With these assumptions, the mean delay to transmit a 
correct packet is given by [8] 
 





PER
R
n
X
Z
E T




1
1
1
                 (14) 
where R is the transmission rate in the wireless link and the 
parameter PER is calculated at the packet level. As the FEC 
code is applied in each slot, we need to modify (8) and (9) to 
compute the PER associated with each state of the GMC. The 
new equations are: 
   



Z
i
g
i
n
g
t
i
n
i
g
p
p
P p















1
1
0
               (15) 




Z
i
b
i
n
b
t
i
n
i
b
p
p
P p















1
1
0
                (16) 
With these new equations we can apply (10) to compute the 
PER and then we can calculate the delay using (14). 
As we are only interested in comparing the delay for 
different error correcting codes and as the parameters Z, X and 
R are independent of the FEC code, we can define a 
normalized delay as: 
 

PER
n
E T


1
                            (17) 
 Figure 5 shows the delay for 0  t  5, considering k = 424 
bits and Z = 5. For each code, n is computed using (13) and 
PER is computed using (15), (16) and (10). Again, the 
optimum switching point between any two neighboring codes 
is obtained by the cross point of the corresponding curves 
illustrated in the figure. 
Table IV summarizes the optimum switching points 
obtained from Figure 5. Comparing these results with those 
presented on previously sections, we can conclude that the 
optimum switching points depend on the selected criterion. 
Again, comparing these results with those presented in [8], we 
conclude that the optimum switching points depend on the 
channel model. 
TABLE IV. OPTIMUM SWITCHING POINTS FOR DELAY CRITERION. 
Switching 
Es/N0 (dB) 
from 
to 
t = 0 
t = 1 
39.0 
t = 1 
t = 2 
36.2 
t = 2 
t = 3 
34.6 
t = 3 
t = 4 
33.5 
t = 4 
t = 5 
32.7 
 
 
Figure 5. Switching points considering delay criterion for 0  t  5 . 
VI. 
CONCLUSIONS 
The switching point is a key factor to maximize the 
performance of systems using adaptive FEC. The optimum 
switching points for this kind of system have been analyzed in 
[8] considering three criteria: maximum throughput, maximum 
PER target and delay to transmit a correct packet. However, 
analyses performed in [8] consider an AWGN channel or that 
an interleaving process is used to randomize the burst errors in 
the wireless channel. 
In this paper, we analyze the optimum switching points 
considering a wireless link modeled as a Rayleigh channel. We 
use the same three criteria proposed in [8]. We concluded that 
the optimum switching points depend on: the channel model, 
the selected criterion and the packet length. 
In future works, we will extend the results presented here 
considering an adaptive hybrid system, in which we combine 
adaptive modulation and adaptive FEC in order to improve the 
performance of the system. Also, we will consider different 
fading models, like Rician model and Nakagami model. 
REFERENCES 
[1] I. F. Akyildiz, W. Lee, M. C. Vuran, and S. Mohanty, “NeXt 
generation/dynamic spectrum access/cognitive radio wireless networks: 
A survey”, Computer Networks 50 (2006), pp. 217-2159. 
[2] J. Yang, A. K. Khandani, and N. Tin, “Adaptive Modulation and Coding 
in 3G Wireless Systems”, Proceedings on 56th Vehicular Technology 
Conference, VTC 2002-Fall, pp. 544-548.  
[3] S. H. O. Salih and M. M. A. Suliman, “Implementation of Adaptive 
Modulation and Coding Technique using”, International Journal of 
Scientific & Engineering Research Volume 2, Issue 5, May-2011, pp. 
137 – 139. 
[4] Y. Fakhri, B. Nsiri, D. Aboutajdine, and J. Vidal, "Adaptive Throughput 
Optimization in Downlink Wireless OFDM System," Int'l J. of 
Communications, Network and System Sciences, Vol. 1 No. 1, 2008, pp. 
10-15. 
27
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks

[5] M. Taki and F. Lahouti, “Spectral Efficiency Optimization for an 
Interfering Cognitive Radio with Adaptive Modulation and Coding”, 
IEEE J. Select. Areas Commun, 2009, pp.1-6. 
[6] M.R.Ebenezar jebarani and T.Jayanthy, “An Analysis of Various 
Parameters in Wireless Sensor Networks Using Adptive FEC 
Technique”, International Journal of Ad hoc, Sensor & Ubiquitous 
Computing (IJASUC) Vol.1, No.3, September 2010, pp.33-43. 
[7] Y.Baguda et al., “Adaptive FEC Error Control Scheme for Wireless 
video Transmission”, In: Advanced Communication Technology 
(ICACT), 2010 The 12th International Conference on. IEEE, 2010, pp. 
565-569. 
[8] J. M. C. Brito and I. S. Bonatti, “Analysing the switching points in 
wireless ATM Networks that use adaptive FEC Schemes”, Proceedings 
the second International Symposium on Communications and 
Information Technology, Pattaya, Thailand, 23-25 October 2002, pp. 
305-308. 
[9] G. Sharma, A. Dholakia, and H. Hassan, “Simulation of error trapping 
decoders on a fading channel”, IEEE Vehicular Technology Conference, 
GS, Atlanta, USA, VOL 2, 28 Apr. - 1 May 1996, pp. 1361-1365.  
[10] R. Khalili and K. Salamatian, “A new analytic approach to evaluation of 
packet error rate in wireless networks”, Proceeding of the 3rd 
Communication Networks and Services Research Conference, 2005, pp. 
333–338. 
[11] Y. Xi,  A. Burr ,  J. Wei, and D. Grace, “A general upper bound to 
evaluate packet error rate over quasi-static fading channels”, IEEE 
Transactions on Wireless Communications, V.10, No 5, May 2011, pp. 
1373-1375. 
[12] C. Jiao, L. Schwiebert, and B. Xu; “On modeling the packet error 
statistics in bursty channels”, Proceedings on 27th Local Computer 
Networks - LCN, November 2002, pp. 534-541.  
[13] S. Lin and D. J. Costello; Error Control Coding: Fundamentals and 
Applications. Prentice Hall, 1983.  
[14] B. Sklar, Digital Communications – Fundamentals and Applications, 2nd 
edition, Prentice Hall, 2001. 
28
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-398-8
ICN 2015 : The Fourteenth International Conference on Networks

