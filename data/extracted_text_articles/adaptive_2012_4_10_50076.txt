Adaptive Control of a Biomethanation Process using Neural Networks 
 
 
Dorin Sendrescu 
Department of Automatic Control 
University of Craiova 
Craiova, Romania 
e-mail: dorins@automation.ucv.ro 
Elena Bunciu 
Department of Automatic Control 
University of Craiova 
Craiova, Romania 
e-mail: selena@automation.ucv.ro 
 
 
Abstract— This paper deals with the design of an adaptive 
control scheme for the regulation of the acetate concentration 
in a biomethanation process with production of methane gas 
that takes place inside a Continuous Stirred Tank Bioreactor. 
The control structure is based on the nonlinear model of the 
process whose parameters are identified using the distributions 
method and the unknown reaction rates are estimated using a 
radial basis neural network. These estimations are then used in 
a nonlinear model predictive control (NMPC) scheme.  
Minimization of the cost function is realized using the 
Levenberg–Marquardt numerical optimization method. The 
effectiveness and performance of the proposed control strategy 
is illustrated by numerical simulations. The simulation results 
obtained with a continuous stirred tank reactor plant model 
confirmed the good quality of the control.  
Keywords-neural 
networks; 
biotechnological 
process; 
adaptive control 
I. 
 INTRODUCTION 
In the last period, the control of biotechnological 
processes has been an important problem attracting wide 
attention. The main engineering motivation in applying 
advanced control methods to such processes is to improve 
operational stability and production efficiency. But, the use 
of modern control for these bioprocesses is still low. The 
nonlinearity of the bioprocesses and the uncertainty of 
kinetics impose the adaptive control strategy as a suitable 
approach. 
So, 
the 
difficulties 
encountered 
in 
the 
measurement of the state variables of the bioprocesses 
impose the use of the so-called “software sensors”. Note that 
these software sensors are used not only for the estimation of 
the concentrations of some components but also for the 
estimation of the kinetic parameters or even kinetic 
reactions. The adaptive control scheme used in this work is 
based on a predictive controller that uses the nonlinear 
dynamic model to predict the effect of sequences of control 
steps on the controlled variables.  
This paper deals with the adaptive control of a 
wastewater biodegradation process. The dynamics of this 
biotechnological process are described by a set of nonlinear 
differential equations obtained from the reaction scheme and 
the unknown reaction rates are estimated using a radial basis 
neural network. For the estimation of unknown parameters of 
the process, the distribution approach is used. The parameter 
identification of deterministic nonlinear continuous-time 
systems (NCTS), modeled by polynomial type differential 
equation has been considered by numerous authors [1], [2]. 
In this paper, we use an identification method for a class of 
NCTS considering that the unknown parameters can appear 
in rational relations with measured variables. Using 
techniques used in distribution approach, the measurable 
functions and their derivatives are represented by functionals 
on a fundamental space of testing functions. Such systems 
are common in biotechnology [3]. The main idea is to use a 
hierarchical structure of identification. First, some state 
equations are utilized to obtain a set of linear equations in 
some parameters. The results of this first stage of 
identification are utilized for expressing other parameters by 
linear equations. This process is repeated until all parameters 
are identified.   
The paper is organized as follows. Section II is devoted 
to description and modeling of a biomethanation process. 
The adaptive control strategy is presented in Section III. 
Simulations results presented in Section IV illustrate the 
performance of the proposed control algorithms and, finally, 
Section V concludes the paper. 
 
II. 
PROCESS MODELING 
A. Analytical approach of process modeling 
Anaerobic 
digestion 
is 
a 
multi-stage 
biological 
wastewater treatment process whereby bacteria, in the 
absence of oxygen, decompose organic matter to carbon 
dioxide, methane and water. A linear model, no matter how 
well it has been structured and tuned, may be acceptable only 
in the case where the system is working around the operating 
point. If the system is highly nonlinear, such as 
biotechnological processes, control based on the prediction 
from a linear model may result in unacceptable response. In 
some cases, remarkable static errors exist, and in other cases, 
oscillation or even instability may occur. Therefore, some 
kinds of non-linear models should be used to describe the 
behavior of a highly non-linear system [4].  
In this paper, we consider a biomethanation process – 
wastewater biodegradation with production of methane gas 
that takes place inside a Continuous Stirred Tank Bioreactor 
whose reduced model is presented in [5]. In the first phase, 
the glucose from the wastewater is decomposed in fat 
volatile acids (acetates, propionic acid), hydrogen and 
75
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-219-6
ADAPTIVE 2012 : The Fourth International Conference on Adaptive and Self-Adaptive Systems and Applications

inorganic carbon under action of the acidogenic bacteria. In 
the second phase, the ionised hydrogen decomposes the 
propionic acid CH3CH2COOH in acetates, H2 and carbon 
dioxide CO2. In the first methanogenic phase, the acetate is 
transformed into methane and CO2, and finally, in the second 
methanogenic phase, the methane gas CH4 is obtained from 
H2 and CO2, [5]. The following simplified reaction scheme is 
considered, 









1
2
2
2
2
1
1
1
P
X
S
S
X
S




 
where: S1 represents the glucose substrate, S2 the acetate 
substrate, X1 is the acidogenic bacteria, X2 the acetoclastic 
methanogenic bacteria and P1 represents the product, i.e. the 
methane gas. The reaction rates are denoted by 
1,2
. The 
corresponding dynamical model is: 











































































1
1
2
2
1
1
2
1
4
3
2
1
1
2
2
1
1
0
0
0
0
1
0
0
0
1
Q
DS
P
S
X
S
X
D
k
k
k
k
P
S
X
S
X
dt
d
in




 
where Sin is the influent substrate, Q1 the methane gas 
outflow rate, D the dilution rate and the state vector of the 
model is: 

T
X S X S P T
]
[
]
[
5
4
3
2
1
1
2
2
1 1
    





whose components are concentrations in (g/l). The reaction 
rates are nonlinear functions of the state components, 
expressed as 




 

)
(
( )
)
(
2
1


 
 



The reaction rates for this process are given by the 
Monod law [3] 

1
1
1
1
1
1
( )
S
K
X
S
M 

   


and the Haldane kinetic model [3]: 

i
M
K
S
S
K
X
S
/
)
(
2
2
2
2
2
2
2
2



  



where 
2
1 ,
M
M
K
K
 are Michaelis-Menten constants, 
1, 2
 
represent specific growth rates coefficients and Ki is the 
inhibition constant. 
For simplicity, shall we denote the plant parameters by 
the vector: 

T]
[
9
8
7
6
5
4
3
2
1








  


where: 
 
;
;
;
;
;
1
5
4
4
3
3
2
2
1
1











k
k
k
k
 

i
M
M
K
K
K




9
8
7
2
6
;
;
;
2
1


 



Because the dilution rate D can be externally modified, it 
will be considered the third component of the input vector 



u T
u
u
u
3
2
1



The other two components of u are the concentration Sin 
and the methane gas outflow rate Q1 so, 

D
Q u
u
S
u
in



3
1
2
1
;
;


Usually, Q1 depends on state variables, 
( )
1
Q  
; 
determining a feedback to the input u2. Written explicitly by 
components, the state equation (2), within the above 
notations, takes the form: 
 

1
3
1
1






u




2
7
2
1
5
1













3
1
2
3
1
1
2
u
u
u





 







3
3
2
3






u




9
'
9
2
4
'
9
4
8
4
3
6
2
1
,




















4
3
2
3
1
2
4












u




2
2
4
5
3
5
u
u




 






B. Parameters estimation 
For parameters estimation the distribution based method 
was used. In this approach the set of nonlinear differential 
equations describing the state evolution is mapped into a set 
of linear algebraic equations respect to the model parameters. 
Using techniques utilized in distribution approach, the 
measurable functions and their derivatives are represented by 
functionals on a fundamental space of testing functions. The 
main advantages of this method are that a set of algebraic 
equation with real coefficients results and the formulations 
are free from boundary conditions. 
Let n be the fundamental space from the distribution 
theory of the real functions 
( )
,
:
t
R t
R




 and  
( )
,
:
q t
R t
q R


 a function which admits a Riemann 
integral on any compact interval T from R. Using this 
function, a unique distribution  

R
F
R
F
q
n
q



( )
,
:





can be built by the relation: 





R
n
q
t dt
q t
F




,
( ) ( )
( )


76
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-219-6
ADAPTIVE 2012 : The Fourth International Conference on Adaptive and Self-Adaptive Systems and Applications

In distribution theory, the notion of k-order derivative is 
introduced. If 
n
Fq

, then its k-order derivative is a new 
distribution 
n
Fq k
( ) 
 uniquely defined by the relations:  
 

n
k
q
k
q k
F
F
 

 



),
(
)1
(
)
(
( )
( )



R
t dt
q t
F
R
k
k
q k


 

( )
( )
)1
(
)
(
( )
( )





where 

k
k
k
k
dt
t
d
t
R t
R
( )
( )
,
:
( )
( )








is the k-order time derivative of the testing function.  
When 
C (R)
q
k

, then 

,
( )
( )
)1
(
( ) ( )
)
(
( )
( )
( )

 
 
R
k
k
R
k
q k
t dt
q t
t dt
t
q
F





that means the k-order derivative of a distribution generated 
by a function 
C (R)
q
k

 equals to the distribution generated 
by the k-order time derivative of the function q. 
So, in place of the states and their time derivatives of a 
system one utilizes the corresponding distributions and, in 
some particular cases, it is possible to obtain a system of 
equations linear in parameters. If the system is compatible 
then all the model parameters are structurally identifiable.  
Consider all state variables accessible for measurements. 
The 
dynamical 
system 
(11)-(17) 
contains 
rational 
dependencies between parameters and measured variables. 
To obtain linear equations in unknown parameters, the 
identification problem is split in several simpler problems. 
Based on the specific structure of this system, it is possible to 
group the state equations, in such way to determine five 
interconnected relations. They are organized in a hierarchical 
structure. In the first stage, some state equations are utilized 
to obtain a set of linear equations in some parameters. If 
these parameters are identified then they can be used as 
known parameters in the following stages. This process is 
repeated in the other stages until all the parameters are 
identified. 
III. 
ADAPTIVE CONTROL ALGORITHM 
A. Problem formulation 
Consider the following discrete-time, time-invariant 
nonlinear system: 

)
,
(
1
k
k
k
u
f 

 


with 
k
  the state vector, uk the control signal, corresponding 
in our case with the discretisation of system (2). The 
objective is to regulate the state vector (or a particular 
output signal) to a specified setpoint value while 
guaranteeing that certain input and state constraints: 

max
min
max
min
u
u
u
k
k









Nonlinear model predictive control treats such a 
constrained control problem by repeatedly solving the 
following optimization problem [6]: 











1
0
)
(
)
(
min
N
i
k i
T
k i
k i
ref
T
k i
ref
Ru
u
Q
















max
min
max
min
1
)
,
(
..
u
u
u
u
f
t
s
k
k
k
k
k







Among the whole sequence resulting from the on-line 
optimization, only the first optimal control is applied as input 
to the system [7]. At the next sampling time, the current state 
is obtained (measured or estimated) and the optimization 
problem (26), (27) is solved again with this new initial state 
value, according to the well-known receding horizon 
principle. 
B. The Neural Network Model 
The predictive model for a conventional MPC controller 
is usually a linear model which is preferred as being more 
intuitive and requiring less a prior information for its 
identification. MPC based on linear models is acceptable if 
the process operates at a single setpoint and the primary use 
of the controller is the rejection of disturbances. Many 
chemical processes, including polymer reactors, do not 
operate at a single setpoint. However, these models are not 
suitable for a nonlinear system such as biotechnological 
processes. To solve this problem neural networks are 
proposed to obtain the estimated output used by the MPC 
controller, because the neural networks have the ability to 
map any nonlinear relationships between an input and output 
set. There have also been many reports on the application of 
neural network to bioprocesses control, modelling and 
identification [8], [9]. 
In this paper, the process model is obtained using a radial 
basis neural network (RBNN) with adjustable parameters to 
approximate the reaction rates 
1
  and 
2
  from model (2). 
A RBNN is made up of a collection of 
p  0
 parallel 
processing units called nodes. The output of the ith node is 
defined 
by 
a 
Gaussian 
function 
)
| /
exp( |
)
(
2
2
i
i
i
c
x
x





, where 
n
x

 is the input to 
the NN, 
ic  is the centre of the i-th node, and 
i
  is its size of 
influence. The output of a RBNN, 
)
,
( W
yNN  F x
, may be 
calculated as [13] 

( ) ( )
( )
)
,
(
1
x
t
W
x
w
x W
F
T
p
i
i i








where 
wp t T
w t w t
W t
( )]
( )
( )
[
( )
2
1


 is the vector of 
network weights and 
(x)
 is a set of radial basis functions 
defined by 
p x T
x
x
x
( )]
( )
( )
[
)
(
2
1


 


. 
Given a RBNN, it is possible to approximate a wide 
variety of functions 
f (x)
 by making different choices for W. 
In particular, if there is a sufficient number of nodes within 
77
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-219-6
ADAPTIVE 2012 : The Fourth International Conference on Adaptive and Self-Adaptive Systems and Applications

the 
NN, 
then 
there 
is 
some 
W *
 such 
as 
 


( )
)
( ,
sup
*
f x
x W
F
x Sx
, where 
x
S  is a compact set, 
  0
 is a finite constant, provided that 
f (x)
 is continuous. 
The RBNN is used to estimate the reaction rates 
1
  and 
2
  
(that 
are 
considered 
unknown) 
using 
some 
state 
measurements. 
 
C. The Neural Network Adaptive Control Algorithm 
 
The model predictive control is a strategy based on the 
explicit use of system model to predict the controlled 
variables over a certain time horizon, called the prediction 
horizon. The adaptive control strategy can be described as 
follows: 
1) Using the on-line measurements the unknown 
dynamics of the system are estimated using an ANN. 
2) At each sampling time, the value of the controlled 
variable yt+k is predicted over the prediction horizon k=1,..., 
Ny. This prediction depends on the future values of the 
control variable ut+k within a control horizon k=l,..., Nu.  
3) A reference trajectory 
ref
k
ty  , k=1,.., N is defined which 
describes the desired system trajectory over the prediction 
horizon. 
4) The vector of future controls ut+k is computed such 
that an objective function (a function of the errors between 
the reference trajectory and the predicted output of the 
model) is minimised. 
5) Once the minimisation is achieved, the first optimised 
control actions are applied to the plant and the plant outputs 
are measured. These measurements are used as the initial 
states of the model to perform the next iteration. Steps 1 to 5 
are repeated at each sampling instant. 
The adaptive control strategy is illustrated by the scheme 
represented in Fig. 1. 
Nonlinear
Model 
estimated 
reaction rates 
measured 
states 
predicted  
output 
 
input 
Adaptive 
Controller 
Nonlinear 
Bioprocess 
Artificial 
Neural 
Network 
controlled  
output
  
Figure 1.  Adaptive control scheme. 
 When a solution of the nonlinear least squares (NLS) 
minimization problem cannot be obtained analytically, the 
NLS estimates must be computed using numerical methods. 
To optimize a nonlinear function, an iterative algorithm 
starts from some initial value of the argument in that function 
and then repeatedly calculates next available value according 
to a particular rule until an optimum is reached 
approximately. Between many different methods of 
numerical optimization the Levenberg-Marquardt (LM) 
algorithm was chosen. The LM algorithm is an iterative 
technique that locates the minimum of a multivariate 
function that is expressed as the sum of squares of non-linear 
real-valued functions [10]. It has become a standard 
technique for non-linear least-squares problems, widely 
adopted in a broad spectrum of disciplines. LM can be 
thought of as a combination of steepest descent and the 
Gauss-Newton method. When the current solution is far from 
the correct one, the algorithm behaves like a steepest descent 
method. When the current solution is close to the correct 
solution, it becomes a Gauss-Newton method. 
 
IV. 
SIMULATION RESULTS 
In this section, we will apply the designed adaptive 
control in the case of the anaerobic digestion bioprocess 
presented in Section II. In order to control the output 
pollution level y, as input control we chose the dilution rate, 
u = D . The main control objective is to maintain the output 
y  at a specified low level pollution 
dy 
. We will 
analyze the realistic case where the structure of the system of 
differential equation (2) is known and specific reaction rates 
1
  and 
2
  (described by “(6)” and “(7)”) are completely 
unknown and must be estimated. Using a RBNN from 
subsection 3.2, one constructs an on-line estimate of 
1
  
respectively of 
2
 . 
The performance of the adaptive controller presented in 
Subsection III - C has been tested through extensive 
simulations by using the process model (2). The values of 
yield and kinetic coefficients are: k1 = 3.2, k2 = 16.7, k3 = 
1.035, k4 = 1.1935, k5 = 1.5, k6 = 3, k7 = 0.113, 

1 = 0.2 h-1, 
KM1
= 0.5 g/l, 

2  = 0.35 h-1, 
KM2
= 4 g/l, 
K 2I
= 21 g/l, and 
the values 
1
 = 1.2, 
2
 = 0.75. It must be noted that for the 
reaction rates estimation a full RBNN with deviation 
i  .0 05
 was used. The centres ci of the radial basis 
functions are placed in the nodes of a mesh obtained by 
discretization of states 
12]
X1  ,1[
g/l, 
.0 65]
,4.0
X2 [
g/l, 
4.1 ]
,1.0
S1 [
g/l 
and 
6.1 ]
,3.0
S2 [
g/l 
with 
2.0


i
i
dS
dX
g/l, 
.2
i  ,1
 
The simulation results, obtained with a sample period 
Ts=6 min, are presented in Figs. 2 – 5. In Fig. 2 the 
controlled output trajectory is presented and in Fig. 3 the 
nonlinear model predictive control action (dilution rate D 
evolution) is depicted. The functions 
1
  and 
2
  provided 
by the RBNN are depicted versus the “real” functions in Fig. 
4 and Fig. 5. From these figures it can be seen that the 
behaviour of the control system with adaptive controller is 
very good, although the process dynamics are incompletely 
known. The control action has an oscillatory behavior, but 
these oscillations are relatively slow and with small 
magnitude. 
78
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-219-6
ADAPTIVE 2012 : The Fourth International Conference on Adaptive and Self-Adaptive Systems and Applications

0
10
20
30
40
50
60
70
0.8
1
1.2
1.4
1.6
1.8
2
2.2
2.4
2.6
Time [h]
[g/l]
1
2
 
Figure 2.   The controlled output evolution (reference (1) and controlled 
output (2)). 
0
10
20
30
40
50
60
70
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0.2
Time [h]
[1/h]
 
Figure 3.   The nonlinear model predictive control action (dilution rate D). 
0
10
20
30
40
50
60
70
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
Time [h]
[g/l h]
1
2
 
Figure 4.   The real reaction rate 
1
  (1) versus the function provided by 
the RBNN (2) 
0
10
20
30
40
50
60
70
0
0.005
0.01
0.015
0.02
0.025
0.03
0.035
0.04
Time [h]
[g/l h]
1
2
 
Figure 5.   The real reaction rate 
2
  (1) versus the function provided by 
the RBNN (2) 
 
V. 
CONCLUSIONS 
In this paper, an adaptive control strategy was developed 
for a wastewater treatment bioprocess. The nonlinear model 
used by the control algorithm was obtained using the 
analytical description of the biochemical reactions. The yield 
coefficients are identified using an algorithm based on test 
functions from distribution theory. This procedure is a 
functional type method, which transforms a differential 
system of equations to an algebraic system in unknown 
parameters. The relation between the state variables of the 
system is represented by functionals using techniques from 
distribution theory based on test functions from a finite 
dimensional fundamental space. The identification algorithm 
has a hierarchical structure, which allows obtaining a linear 
algebraic system of equations in the unknown parameters. 
The unknown reaction rates are estimated using radial basis 
neural networks. The nonlinear model states are used to 
calculate the optimal control signal applied to the system. 
The optimization problem was solved using the iterative 
Levenberg-Marquardt algorithm. The efficiency of the 
proposed algorithm was illustrated by numerical simulation. 
ACKNOWLEDGMENT 
This work was supported by the National University 
Research Council - CNCSIS, Romania, under the research 
project TE 106, no. 9/04.08.2010. 
 
REFERENCES 
[1] A. Patra and H. Unbehauen, “Identification of a class of 
nonlinear continuous time systems using Hartley modulating 
functions”, International Journal of Control, vol. 62, no. 6, pp. 
1431-1452, 1995. 
[2] A. Pearson and F. Lee, “On the identification of Polynomial 
input-output differential systems”, IEEE Transactions on 
Automatic Control, vol. AC30, no. 8, pp. 778-782, 1985. 
[3] G. Bastin and D. Dochain, On-line Estimation and Adaptive 
Control of Bioreactors, Elsevier, Amsterdam, 1990. 
[4] D. Dochain and P. Vanrolleghem, Dynamical Modelling and 
Estimation in Wastewater Treatment Processes, IWA 
Publishing, 2001. 
[5] E. Petre and D. Selisteanu, Modelling and Identification of 
Depollution Bioprocesses, Universitaria, Craiova, 2005. 
[6] M. Cannon, B. Kouvaritakis, Y.I. Lee and A.C. Brooms,” 
Efficient non-linear model based predictive control”, 
International Journal of Control, vol. 74, no. 4, pp. 361-372, 
2001. 
[7] E.F Camacho and C. Bordons, Model Predictive Control, 
second edition, Springer, 2004. 
[8] J.W. Eaton and J.R. Rawlings, “Feedback Control of 
Nonlinear Processes Using Online Optimization Techniques,” 
Computers and Chemical Engineering, vol. 14, pp. 469-479, 
1990. 
[9] J.T. Spooner and K.M. Passino, “Decentralized adaptive 
control of nonlinear systems using radial basis neural 
networks”, IEEE Transactions on Automatic Control, vol. 44, 
no. 11, pp. 2050-2057, 1999. 
[10] J. Nocedal and S.J. Wright, Numerical Optimization, 
Springer, New York, 1999. 
 
79
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-219-6
ADAPTIVE 2012 : The Fourth International Conference on Adaptive and Self-Adaptive Systems and Applications

