Said El-Khamy 
Department of Electrical Engineering 
Faculty of Engineering, Alexandria University 
Alexandria, Egypt 
 elkhamy@ieee.org 
 
Abstract— Space-Time Block Codes represent an exciting 
development in the field of wireless communication. It is a 
promising technique to increase the data rates with minimal 
decoding complexity. In this paper, we present an adaptive 
transmission system for Rayleigh fading Multiple Input 
Multiple Output channels. Code selection and adaptive 
modulation are combined together by two feedback 
scenarios. Channel State Information is sent back from the 
receiver to the transmitter controlling three feedback 
decision bits. By applying these adaptive techniques, the 
system adjusted its performance with the channel conditions. 
As a result, signal transmission with an improved coding 
gain and diversity near to the maximum diversity order is 
achieved. The proposed system has shown enhanced bit 
error rate performance and better outage data throughput, 
when compared with non adaptive systems. 
 
Keywords--Space-Time Block Codes; Multiple Input Multiple 
Output; Channel State Information; feedback; Adaptive 
Modulation.
 
I.   INTRODUCTION
 
Third-generation wireless communication systems are 
required to provide data bit rates of up to 2 Mbits/s. 
Recently released fourth-generation standards will push 
these rates even higher, possibly over 100 Mbits/s [1]. To 
support such high rates, multiple antennas can be 
employed to increase channel capacity.  
 As a result of Space Time Coding (STC) [4], the 
transmitted signal resists the multipath fading effects that  
increases the Bit Error Rate (BER) by  depending on both 
time and space diversity.  It was shown in [4] that an 
orthogonal full-rate design, offering full diversity for any 
arbitrary complex symbol constellation, is limited to the 
case of two transmit antennas. Data-rate or decoding 
simplicity must be sacrificed if the number of transmit 
antennas is increased. 
Most Space Time Block Codes (STBCs) are designed 
under the assumption that the transmitter has no 
knowledge about the channel. On the other hand, it has 
been shown in [3] that an outage performance with perfect 
Channel State Information (CSI) available at the 
transmitter and at the receiver is better compared to the 
case when only the receiver has perfect knowledge of the 
channel.  
 When 
applying 
adaptive 
modulation, 
great 
enhancements in the system performance are achieved. 
Constantly changing the modulation scheme with the 
varying channel conditions and thus, yielding higher data 
throughput when compared with the non adaptive systems 
[7]. According to [4], an orthogonal complex 4x4 code 
matrix is not full rate on the other hand, the Extended 
Alamouti 4x4 near orthogonal code matrix is full rate   
 
Amr El-Helw, Sara Zaalik 
Electronics and Communication Department 
Arab Academy for Science and Technology (AAST) 
Alexandria, Egypt 
A.M.El-Helw@aast.edu, sarazaalik@gmail.com 
 
Thus sacrificing the code orthogonality, code selection 
technique is used to overcome this problem. The proposed 
system combines adaptive modulation and code selection 
techniques depending on the CSI available at both the 
transmitter and receiver, this combined system outstands 
the non-adaptive systems in both bit error rate (BER) 
results and outage data throughput.  
The paper is organized as follows. Section II reviews 
the simple 2x1 Alamouti scheme [4] and the Extended 
Alamouti scheme with code selection technique [3]. 
Section III presents the proposed system combining 
adaptive modulation with code selection techniques. The 
system simulation and results will be presented in Section 
IV. Finally, Section V contains the paper conclusion.   
 
II.   ALAMOUTI AND EXTENDED ALAMOUTI SCHEMES 
A.  Alamouti Scheme  
In 1998, the preliminary form of STBC was 
introduced by Alamouti [4]. It linearly and orthogonally 
encodes a data stream and transmits it simultaneously 
across the channel. The encoder takes a block of two 
modulated symbols S1 and S2 in each encoding operation 
and maps them to two transmit antennas according to a 
code matrix given in (1). After transmission, the data 
stream is successfully extracted at the receiver due to the 
orthogonal encoding.  
                          
                                        S1       S2 
 S =                                                       (1) 
  S2
*    
   -S1
* 
 
At the receiver, the signals are expressed as: 
 
                 R1  =  h1 S1   +  h2 S2  + n1                                           (2)  
                 R2  =  h1 S2
* -   h2 S1
*+  n2                                          (3) 
 
Or, written in the vector form, as mentioned in [5] 
                   r = Sh+n                                                    (4) 
where n represents Gaussian noise. 
 
B.    4x1 Extended Alamouti Scheme and code selection 
The Extended Alamouti Space Time Block Coding 
(EA-STBC) uses four transmit antennas and one receiver 
antenna [3]; as a result, four symbols are transmitted each 
time slot. The code matrix is generated as a result of 
“alamoutisation” of the basic Alamouti code mentioned in 
(1) [2].  In other words, two Alamouti codes are used to 
Channel-Matched Space-Time Code Selection and Adaptive Modulation for 
Rayleigh Fading Channels  
111
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-229-5
MOBILITY 2012 : The Second International Conference on Mobile Services, Resources, and Users

build up the EA-STBC for four transmit antennas. The 
resulting code extends over four time slots and is 
described in [3][5] by the following signal matrix, 
 
                      S1        S2          S3      S4 
 
                                   S2
*    
   -S1
*       S4
*    -S3
* 
    S1 =                                                    .                   (5) 
                                   S3
*         S4
*      -S1
*    -S2
* 
 
                                   S4
    
     -S3
        -S2          S1 
 
 
 
The received signals within four successive time slots, 
assuming one receiver antenna, are given in [3] as, 
 
r1 = S1 h1  +  S2 h2  +  S3 h3   +  S4 h4  +  n1                    (6) 
r2 = S2
* h1  -  S1
* h2 + S4
* h3   -  S3
* h4 +  n2                    (7) 
r3 = S3
* h1 + S4
* h 2  -  S1
* h3  -  S2
* h4 +  n3                    (8) 
r4 = S4 h1   -  S3 h2   -  S2 h3   + S1 h4   +  n4.                   (9) 
 
With complex conjugation of (7) and (8), we obtain, 
 
y2 = r2
*   ,     n2 = n2
*                                                   (10)
 
y3 = r3
*   ,     n3 = n3
*                                  (11)
   
 
Resulting in (12), the matrix equation representing the 
transmission scheme, 
 
      y = H v1 s + n                                          (12) 
 
where H v1  is the virtual effective channel matrix and is 
equal to, 
 
                        h1        h2           h3        h4 
 
                              -h2
*    
    h1
*       -h4
*       h3
* 
     H v1 =                                                                     (13) 
                              -h3
*      -h4
*        h1
*         h2
* 
 
                               h4
    
     -h3
         -h2            h1 
 
 
 
It is shown in [3] that Hv1 is nearly orthogonal. As 
mentioned in [4] that fully orthogonal codes achieve full 
diversity gain. So, to overcome the problem of near 
orthogonal codes, the code selection technique is 
proposed in [3].  
The signal transmission is described by the vector 
form discussed in (4) where r is the (4x1) vector of the 
received signals. S is the space time block code that could 
be either S1 as defined in (5) or S2 defined in (14) 
depending on a feedback bit b3, and finally, n is the (4x1) 
noise vector [5]. In [3][5],  the EA-STBCs are generated 
from each others by changing the signs, which is obvious 
in the generated code named S2 in (14).  
 
                            -S1       S2        S3      S4 
 
                            -S2
*     
  -S1
*      S4
*    -S3
* 
          S2 =                                                                  (14) 
                            -S3
*        S4
*     -S1
*    -S2
* 
 
                            -S4
    
     -S3
      -S2         S1 
 
 
Similarly,  HV2 is generated if S2 is used, 
 
 
                   -h1        h2           h3         h4 
 
                               -h2
*    
   - h1
*       -h4
*      -h3
* 
     H v2 =                                                                    (15) 
                               -h3
*       -h4
*       - h1
*         h2
* 
  
                                h4
    
      -h3
          -h2          - h1 
 
 
 
As in [5], we obtain  
 
                 G = Hvi
H  Hvi =  Hvi  Hvi
H 
 
 
                          1       0       0        Xi 
 
                               0       1      - Xi      0 
= h2                                                                                                         (16) 
                          0     - Xi       1        0 
 
                         Xi      0         0        1 
      
 
where i =1 or 2  and   h2 =  h1
2 + h2
2  + h3
2 + h4
2       (17) 
 
(
)
2
*
3
2
*
4
1
1
2Re
h
h h
h h
X
−
=
,    when S1 is sent           (18) 
And 
(
)
2
*
3
2
*
4
1
2
2Re
h
h h
h h
X
−
−
=
,  when S2 is sent         (19) 
 
It is known from [6] that G should be an identity 
matrix to achieve full diversity and an optimum system 
performance. But, on the other hand, if G is not an 
identity matrix as in (16), channel dependent parameter 
named Xi appears leading to interference between the four 
channel parameters. Thus,  Xi should be as small as 
possible to reach near orthogonality of STBC used. 
Thus, code selection is applied between the two 
transmission codes S1 and S2. By computing the values of 
X1 and X2 from (18) and (19), respectively, the system 
returns feedback bit b3 to the transmitter to select the code 
block corresponding to the minimum value of X. 
   
112
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-229-5
MOBILITY 2012 : The Second International Conference on Mobile Services, Resources, and Users

Figure 1. Combined Adaptive Modulation and Code Selection Techniques
 
  
III.   PROPOSED COMBINED ADAPTIVE MODULATION 
AND CODE SELECTION TECHNIQUES 
The combined adaptive transmission system proposed 
in this paper requires full knowledge of CSI at both the 
transmitter and the receiver. Figure 1 presents the block 
diagram of the proposed combined system. Binary data is 
fed into an adaptive M-ary modulator set to three 
modulation states, BPSK, QPSK or 8-ary PSK. Switching 
between these modulation techniques requires two 
feedback bits b1 and b2. The data is then encoded with 
either one of two Extended Alamouti block codes S1 or S2. 
Switching between these block codes requires a feedback 
bit b3.  The encoded data is then transmitted through four 
time slots, using four different antennas. At the receiver 
end, the transmitted signals are received using one 
receiver antenna. Finally, Maximum Ratio Combining 
(MRC) is used for signal detection at the receiver.       
 Choosing between S1 and S2 at the transmitter is 
considered a type of system adaptation, or, in other words, 
matching the code selection process with the value of 
channel dependent interference parameter Xi given in (18) 
and (19). Adaptive modulation is also applied which 
denotes the matching of the modulation technique with 
the channel conditions. Higher order modulation is 
assigned to the system at poor channel conditions. In this 
way we could benefit from the channel response, whereas 
the channel is considered as gain for the transmitted 
signal. In this paper, we have investigated three 
modulation techniques, BPSK, QPSK and 8-PSK, 
therefore requiring two feedback bits b1 and b2 
implemented between the receiver end and the modulator 
in the transmitter as shown in Figure 1. 
For acquiring the CSI, two thresholds are defined to 
assign a modulation scheme to the system using bits b1 
and b2; the third feedback bit b3 returns information on the 
code block that will be used to encode the modulated data.  
From (17), h2 is easily computed, and, according to its 
value, the suitable modulation is chosen. As a result, the 
adaptive modulation system controls the outage data rate. 
In the following section, performance of the proposed 
system which combines adaptive modulation and code 
selection will be investigated.  
 
 
 
IV.    SIMULATION AND RESULTS 
In our simulations, we have used flat Rayleigh fading 
channel remaining constant during the transmission of 
each code block [3]. At the receiver side, we have used 
MRC receiver. The BER results have been averaged over 
105 realizations of i.i.d channel matrix. We simulated 
MIMO systems with two and four transmit antennas and a 
single receive antenna. BPSK, QPSK [3] and 8-PSK 
modulation techniques 
are used 
in the 
adaptive 
modulation process. In the simulations of the adaptive 
modulation systems, the BER and the modulation order 
(M) are averaged for each value of Signal to Noise Ratio 
(SNR). The results are introduced in three parts; part A 
presents the processes of adaptive modulation and code 
selection while, the BER results are presented in part B. 
To visualize the data throughput more clearly and to 
support the enhanced BER results, Figure of Merit is 
calculated, which is presented in part C. 
A.  Adaptive modulation and code selection Processes 
This section presents the behavior of the proposed 
combined system for a given sample of ten time frames 
for the same SNR.  
In Figure 2, the normalized channel response is 
represented against time frame. It is quiet obvious that the 
channel is varying at each frame. By extensive simulation 
of the proposed system according to the simulation 
environment mentioned at the beginning of this section, it 
was noticed that the values of h2 lies between a certain 
range of numbers.  Two middle values were chosen as the 
threshold values to control the adaptive modulation 
process.  During the time frames that contain values of the 
normalized channel beneath threshold 1, BPSK (M=2) is 
assigned. While QPSK (M=4) is used during the time 
frames containing values of the normalized channel in 
between threshold 1 and threshold 2. Finally, 8-PSK 
(M=8), is assigned otherwise (above threshold 2) as 
shown below. 
113
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-229-5
MOBILITY 2012 : The Second International Conference on Mobile Services, Resources, and Users

 
Figure 2.  Channel Response Normalized (h2/hn)  Against 
Time/Frame 
 
On the other hand, Figure 3 shows the system 
response (from the adaptive modulation aspect) towards 
the variation of the normalized channel values- presented 
in Figure 2 for the exact ten time frames leading to 
variation in the modulation order used at each frame. 
 
 
Figure 3.  MPSK Modulation Order at each Time/Frame 
 
Figure 4 represents the values of the channel 
dependent parameter, Xi, against the same time frames 
presented in Figures 2 and 3. With varying values of X1 
and X2, code switching between S1 and S2 is applied by 
the system as shown below. For easy visualization of this 
process, S1 is represented by 1 and S2 is represented by 
1.5. 
 
Figure 4.   Code Selection Technique 
 
 
 
 
B.  BER  Results 
For the system setup mentioned in the beginning of  
Section IV, this section shows the resulting performances 
(BER against SNR) for the proposed combined system 
against non adaptive systems.  Figure 5 shows the 
resulting BER against SNR for the 2x1 simple Alamouti 
scheme that uses adaptive modulation  against non-
adaptive system (no code selection is applied in both 
systems). Performance improvement is obvious, for the 
same BER the adaptive system is almost 7dB better than 
the non-adaptive one. 
 
Figure 5.  BER for 2x1 Adaptive Alamouti scheme 
against 2x1 Non-Adaptive Alamouti scheme 
 
Figure 6 shows the BER results for the proposed 
system 
(adaptive 
modulation 
and 
code 
selection 
techniques) against the non-adaptive system that uses only 
QPSK modulation. The proposed system gives 7dB SNR 
improvement than the non adaptive system. 
 
Figure 6. BER for 4x1 Adaptive system against 4x1 non 
adaptive system.
 
 
Figure 7 shows the BER performance improvements 
for the proposed combined adaptive system that uses three 
modulation schemes (at the same time) against non 
adaptive systems using BPSK, QPSK and 8-PSK each at a 
time, The results shows at least 4 dB of SNR 
improvement as shown in the figure.  
114
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-229-5
MOBILITY 2012 : The Second International Conference on Mobile Services, Resources, and Users

 
Figure 7.  The 4x1 combined system against non adaptive 
systems using BPSK, QPSK and 8-PSK 
 
At almost 3 dB, the performance of the 4x1 BPSK 
outstands the proposed combined system which is 
expected as the BPSK should have the optimum 
performance (lower BER) for all ranges of SNR on the 
account of the data throughput. On the other hand, the 
proposed combined system shows better throughput than 
the other non-adaptive systems as will be shown in Figure 
8.   
C.  Figure of Merit 
Figure of merit is an indication of the data throughput 
of the system. It is drawn against the SNR and it is 
calculated by the following formula, 
 
                   Figure of Merit = M* (1-BER)          (20) 
 
 where M is the modulation order. 
 
Figure 8 shows the resulting figure of merit for 4x1 
proposed combined adaptive system against non-adaptive 
BPSK and QPSK. As clearly shown, the adaptive system 
shows better figure of merit than the other systems 
therefore better throughput. For the adaptive system, in 
the calculation of the above formula, M is averaged along 
the whole adaptive modulation process ( as mentioned 
earlier). Its quiet clear that the figure of merit tends to M 
in each case where Mmax=M. 
 
Figure 8.  Figure of Merit results for the 4x1 Adaptive 
System Against 4x1 non Adaptive Systems. 
 
 
 
 
V  CONCLUSION 
By combining both adaptive modulation and code 
selection to the 4x1 Extended Alamouti system, 
performance improvements are visible in all the presented 
results. With assigning higher order modulation to the 
system when h2 is above threshold 2, it is considered as a 
gain for the transmitted signal therefore the signal is more 
robust to noise. Figure of Merit results indicate better 
throughput for the adaptive system by calculating the 
average modulation order (Maverage) through out the 
process which will be greater than that of the BPSK and 
QPSK individually. In addition, code selection between 
the non- orthogonal codes S1 and S2 to reach the code with 
minimum value of Xi, in other words, the near orthogonal 
code. Changing the receiver and the number of the 
receiver antennas could be considered later on to achieve 
near optimum performances.  
ACKNOWLEDGMENT 
I would like to express my deep gratitude to the 
reviewers as well as all my professors and colleagues.  
REFERENCES
 
[1]  N. S. J. Pau, “Robust high throughput Space-Time Block 
Coded MIMO systems”, Ph.D. Thesis, University of 
Canterbury, Christchurch, New Zealand, June 2007. 
[2] J. F. Torras, “New Hybrid Automatic Repeat Request 
(HARQ) scheme for a 4x4 MIMO system, based on The 
Extended Alamouti Quasi-orthogonal Space-Time Block 
Coding (Q-STBC), in invariant and variant fading channel”, 
M.Sc. Thesis ,New Jersey Institute of Technology, May 
2006. 
[3]   B. Badic, M. Rupp, and H. Weinrichter, “Adaptive channel-
matched Extended Alamouti Space-Time Code exploiting 
partial feedback”, ETRI Journal, Vol. 26, No. 5, pp. 443-
451 , October 2004 
[4]  V. Tarokh, H. Jafarkhani, and A.R. Calderbank, “Space-
Time Block Codes from orthogonal design ” IEEE Trans. 
Inf. Theory, vol. 45, pp. 1456-1467,  July 1999. 
[5] M. Rupp and C. F. Mecklenbräuker, “On Extended   
Alamouti schemes for Space-Time Coding”, The 5th 
International Symposium on Wireless Personal Multimedia 
Communications, Honolulu, pp. 115-119, October 2002. 
[6]   C. F. Mecklenbräuker and M. Rupp, “Flexible Space-Time 
Block Codes for trading quality of service against data rate 
in MIMO UMTS”,  EURASIP J. Applied Signal 
Processing, Special Issue on MIMO Communication and 
Signal Processing,  vol. no. 5,  pp. 662-675, May 2004. 
[7]   J. Yang, N. Tin, and A. K. Khandani, "Adaptive modulation 
and coding in 3G wireless systems", in proceedings of the 
56th IEEE Vehicular Technology conference, vol.1, pp. 24-
28, September 2002. 
 
115
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-229-5
MOBILITY 2012 : The Second International Conference on Mobile Services, Resources, and Users

