Quaternion Lifting Scheme for Multi-resolution Wavelet-based Motion Analysis
Agnieszka Szczesna
The Silesian University of Technology
Institute of Informatics
Gliwice, Poland
agnieszka.szczesna@polsl.pl
Janusz Slupik
The Silesian University of Technology
Institute of Mathematics
Gliwice, Poland
janusz.slupik@polsl.pl
Mateusz Janiak
The Silesian University of Technology
Institute of Informatics
Gliwice, Poland
mateusz.janiak@polsl.pl
Abstract—This paper considers human body motion analysis
as local changes of orientations in hierarchical skeleton parts
over time. Possible approaches by applying multiresolution
analysis in form of a second generation wavelet transform
directly on quaternion signal are shown. Quaternions in terms
of motion analysis are a more efﬁcient representation of
rotation than Euler angles. This paper presents that the lifting
scheme can be efﬁciently applied directly to quaternions.
Lifting scheme building blocks for the quaternion Haar and
linear transformation are presented.
Keywords-quaternions;
multi-resolution
analysis;
wavelet
transform; lifting scheme; quaternion interpolation; motion anal-
ysis.
I. INTRODUCTION
Human body motion synthesis and analysis are very
challenging tasks and a very popular research domain. The
most precise measurements of motion data are obtained by
motion capture systems. We cooperate with a high tech mo-
tion capture laboratory having dedicated hardware capable
of performing motion acquisition. It can acquire motion
data through simultaneous and synchronous measurement
and recording of motion kinematics, muscle potentials by
electromyography, ground reaction forces and video streams
in high deﬁnition format and the HML supporting system
which allows for storing, playing and browsing data. The
data from the above mentioned subsystems are large and
accurate, allowing for a thorough analysis of motion. Tech-
niques of analysis of such data can be potentially applied
in:
• Medicine - diagnosis and veriﬁcation of a medical
treatment;
• Entertainment - realistic animations;
• Sport - new training techniques;
• Security - people recognition based on their body
movement.
In this paper, we present our approaches in performing
motion analysis with multi-resolution techniques based on
rotations of joints over time written in the form of quaternion
signal. For this reason, we are trying to use a second gen-
eration wavelet transform constructed by the lifting scheme
for quaternion rotation representation. Using the quaternion
lifting scheme based on the quaternion algebra we can work
directly on correlated motion data. This is in opposition to
the methods presented in the literature where the ﬁlters work
on Euler angles as three non-correlated components. Also,
the example application of multi-resolution for denoising
data is presented.
Section II describes the main assumptions of multi-
resolution wavelet analysis of motion data and presents a
short review of solutions presented in literature. Section III
presents general information about the second generation
wavelets and the lifting scheme as a simple construction
tool of such wavelets. Section IV focuses on quaternion
interpolating methods. Section V describes the construction
of the lifting schema blocks for Haar and linear quater-
nion transformation and presents some results. Section VI
presents example application of result quaternion multi-
resolution representation. The last section is a conclusion.
II. MULTI-RESOLUTION WAVELET ANALYSIS OF MOTION
DATA
The main idea of the multi-resolution transformation is to
represent a signal coarse to ﬁne hierarchy. The input signal is
decomposed into coarse base data (global pattern of signal)
and a hierarchy of detail coefﬁcients. The result multi-
resolution representation can be based of many algorithms
such as [10], [14]: denoising, ﬁltering (smoothing, enhance-
ment), compression, feature detection and multi-resolution
editing.
Most of the solutions are based on processing orientation
data as three non-correlated signals deﬁned by Euler angles.
In [1], spatial ﬁlters for orientation data are proposed. A
similar solution based on a digital ﬁlter bank technique is
in [2]. In [3], the cubic interpolating bi-orthogonal wavelet
basis, implemented as lifting scheme blocks, are used to
compression skeletal animation data. Temporal coherence is
exploited by this wavelet transform. The B-spline wavelet
for unit quaternion is used for smoothing motion data in
[4].
Quaternion wavelets are also proposed for phase based
stereo matching for uncalibrated images [5]. This solution
is based on a bi-orthogonal ﬁlter bank, where the real
valued image signal is convolved with an analytic quaternion
wavelet ﬁlter, to construct the 2D analytic signal.
223
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

In [6] and [7], the quaternion multiplier of plane rota-
tions, inspired by a factorization algorithm, is implemented.
This proposition considers the factorization of a quaternion
multiplication matrix into lifting scheme steps. Our work is
different because we work directly on quaternion signal as
representing orientation changes over time and we design
lifting scheme blocks using the convention of second gener-
ation wavelets. Our main task is to analyze human motion.
III. SECOND GENERATION WAVELETS AND LIFTING
SCHEME
The lifting scheme [8], [9] is a simple but powerful tool to
construct a wavelet transform. The main advantage of this
solution is the possibility of building wavelet analysis on
non-standard structures of data (irregular samples, bounded
domains, curves, surfaces) while keeping all powerful prop-
erties as speed and good ability of approximation [10],
[11], [12], [13]. This generalization are called as second
generation wavelets [14]. They are not necessarily trans-
lated and dilated of one function (mother function). In this
meaning, the lifting scheme also considers non-linear and
data-adaptive multi-resolution decompositions.
sj+1,k
Split
P
U
-
+
sj+1,2k+1
sj+1,2k
sj,k
dj,k
Figure 1.
The forward lifting scheme
A general lifting scheme (Figure 1) consists of three types
of operations:
• Split: splits input dataset into two disjoint sets of even
and odd indexed samples. The deﬁnition of the lifting
scheme does not impose any restriction on how the data
should be split nor on the relative size of each subsets.
• Predict: predicts samples with odd indexes based on
even indexed samples. Next the odd indexed input value
is replaced by the offset (difference) between the odd
value and its prediction.
• Update: updates the output, so that coarse-scale coefﬁ-
cients have the same average value as the input samples.
This step is necessary for stable wavelet transform [14].
These calculations can be performed in-place. In all stages
input samples can be overwritten by output samples of that
step. The inverse transform (Figure 2) is easy to ﬁnd by
reversing the order of operations and ﬂipping the signs.
IV. INTERPOLATING QUATERNIONS
Quaternions [15]–[17] are structures allowing descriptions
of vectors relations. They are commonly used (mainly in
computer graphics) for performing rotations.
Merge
U
P
-
+
sj+1,2k+1
sj+1,2k
sj,k
dj,k
sj+1,k
Figure 2.
The reverse lifting scheme
Quaternion q is denoted as: q = [s, v], s ∈ R, v ∈ R3.
Here, s represents the scalar part and v is the imaginary
part of the quaternion. In more details this representation
can be given as:
q = xi + yj + zk + w,
x, y, z, w ∈ R, i2 = j2 = k2 = ijk = −1.
Now, w is the scalar part and [x, y, z] is the imaginary
part. The space of quaternions is denoted as H.
We are working with unit quaternions; therefore, all
interpolated quaternions are assumed to be unit quaternions.
Interpolation step h is in range [0; 1]. Based on [18], the
following quaternion interpolation methods can be distin-
guished:
• lerp - Computationally the most efﬁcient from pre-
sented those but gives poor quality in generated rotation
quaternions and does not guarantee unit quaternions as
a result. Normalization is required. Generated move-
ments have sharp ending motion so the movement of
the body is not considered to be smooth.
lerp(qi, qi+1, h) = qi ∗ h + qi+1 ∗ (1 − h)
• slerp - Ensures unit quaternion as a result. Unfortu-
nately on the endings moves are still sharp.
slerp(qi, qi+1, h) = qi(q∗
i qi+1)h
• squad - Computational very demanding but gives very
smooth movement after interpolation. No rapid changes
in movement are noticeable at the interpolation range
endings. This method is inspired by splines.
squad(qi, qi+1si, si+1, h) = slerp(slerp(qi, qi+1, h),
slerp(si, si+1, h), 2h(1 − h))
si = qi exp

−log(q−1
i
qi+1) + log(q−1
i
qi−1)
4

• shoemake-bezier - Interpolation method is based on the
De Castlejau algorithm. More details might be found
in [19].
224
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

bezier(qi, qi+1, si, si+1, h) = slerp(slerp(q11, q12, h),
slerp(q12, q13, h), h)
q11 = slerp(qi, si, h)
q12 = slerp(si, si+1, h)
q13 = slerp(si+1, qi+1, h)
si = qi exp

−log(q−1
i
qi+1) + log(q−1
i
qi−1)
4

V. QUATERNION LIFTING SCHEME
Using the quaternion lifting scheme based on the quater-
nion algebra we can work directly on correlated motion
data. This is in opposition to the methods presented in the
literature where the ﬁlters work on Euler angles as three
non-correlated components.
A short comment about the interpretation of details for
the lifting scheme must be given here, as currently the
coefﬁcients are represented by quaternions. The goal of the
prediction step is to produce values as close as possible to
the given data. It means the smaller the difference (detail
coefﬁcient), the better the prediction step is. For quaternions
this difference should tend to a zero rotation quaternion
- [1, [0, 0, 0]]. If all coefﬁcients are close to this value it
means we have found a closed form description of the
analyzed movement and this function might be used for such
movement reproduction and analysis. Additionally small
detail values suggest that the data is strongly correlated. On
the other hand, if all coefﬁcients have similar, but rather
large values it is also possible that either the prediction step
poorly describes data correlation or mean signal value is not
maintained in the next resolutions.
Input motion signal with length 2n is a set of normalized
quaternions. In the split block this signal is divided into even
and odd indexed samples: ..., oj
i, ej
i, oj
i+1, ej
i+1, .... The upper
index j indicates the step scheme (the level of resolution).
In this paper, we give two propositions for the quaternion
lifting schemes, which are fully and easy reversible and
allow in-place computations. Those schemes also preserve
the average signal at each resolution level.
A. Motion data
Data for analysis are obtained from the Human Motion
Laboratory of the Polish-Japanese Institute of Information
Technology in Bytom (Poland). The data (Figures 3 and 4)
represent knee joint motion sampled at 100Hz. To better
visualize the motion data, we have chosen the three Euler
angles plots.
B. Quaternion Haar lifting schema
In literature the most basic lifting scheme is the Haar
wavelet transformation. It predicts odd indexed samples with
corresponding even indexed samples. The lifting scheme
steps are the following:
0
100
200
300
400
500
600
−10
−5
0
5
10
Frame
Y−axsis rotation angle(degrees)
0
100
200
300
400
500
600
−20
0
20
40
Frame
X−axsis rotation angle(degrees)
0
100
200
300
400
500
600
−5
0
5
10
Frame
Z−axsis rotation angle(degrees)
Figure 3.
The Euler angles of knee joint motion data obtained from the
Human Motion Laboratory of the Polish-Japanese Institute of Information
Technology in Bytom (Poland).
−0.1
−0.08
−0.06
−0.04
−0.02
0
0.02
0.04
0.06
0.08
0.1
−0.2
−0.1
0
0.1
0.2
0.3
0.4
0.5
X
Y
Figure 4. The quaternion curve of knee joint motion data obtained from the
Human Motion Laboratory of the Polish-Japanese Institute of Information
Technology in Bytom (Poland).
• Prediction step:
oj
i = oj+1
i
· SLERP(ej+1
i
, oj+1
i
, 0.5)−1
• Update step:
ej
i = oj
i · ej+1
i
The reverse lifting scheme steps:
• Undo prediction step:
oj+1
i
= oj
i· ej
i
• Undo update step:
ej+1
i
= SLERP(oj+1
i
, ej
i, 2)
The results of the Haar transformation are presented in
Figure 5 and 6. These are plots of Euler angles at the ﬁrst
and forth level of resolution (after ﬁrst and forth step of
the lifting schema) and details for such levels (differences
between removed quaternions and predicted by the lifting
schema).
225
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

0
50
100
150
200
250
300
−10
−5
0
5
10
Frame
Y−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−20
0
20
40
Frame
X−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−5
0
5
10
Frame
Z−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−0.4
−0.2
0
0.2
0.4
0.6
Frame
Y−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−2
−1
0
1
2
Frame
X−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−0.5
0
0.5
1
Frame
Z−axsis rotation angle(degrees)
Figure 5.
The ﬁrst level of resolution computed by the Haar lifting schema: data (left plot) and details (right plot).
0
5
10
15
20
25
30
35
40
−5
0
5
Frame
Y−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−20
0
20
40
Frame
X−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−4
−2
0
2
4
6
Frame
Z−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−0.4
−0.2
0
0.2
0.4
0.6
Frame
Y−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−2
−1
0
1
2
Frame
X−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−0.4
−0.2
0
0.2
0.4
0.6
Frame
Z−axsis rotation angle(degrees)
Figure 6.
The forth level of resolution computed by the Haar lifting schema: data (left plot) and details (right plot).
C. Quaternion linear lifting schema
The next common prediction step is the linear interpola-
tion between surrounding values. The lifting scheme steps
are the following:
• Prediction step:
oj
i = SLERP(ej+1
i
, ej+1
i+1, 0.5)−1· oj+1
i
• Update step:
ej
i = ej+1
i
· (SLERP(oj
i−1, oj
i, 0.5))0.5
The reverse lifting scheme steps are:
• Undo update step:
ej+1
i
= ej
i · (SLERP(oj
i−1, oj
i, 0.5))0.5
• Undo prediction step:
oj+1
i
= SLERP(ej+1
i
, ej+1
i+1, 0.5)· oj
i
The results of the linear transformation are presented in
Figure 7 and 8. These are plots of Euler angles of data at the
ﬁrst and forth level of resolution (after ﬁrst and forth step
of lifting schema) and details for such levels (differences
between removed quaternions and predicted by the lifting
schema).
VI. EXAMPLE APPLICATION - DENOISING MOTION DATA
Denoising methods rely on removing the high frequency
component of a signal, which consists of noise. The simplest
method is to set to zero wavelet coefﬁcients representing
high frequencies from the ﬁrst few levels of decomposition.
In the quaternion lifting schema, details are set to unit
quaternion. Another method is based on threshold methods,
which change the wavelets coefﬁcients selected on the basis
of some threshold value. Determining the value of threshold
for the quaternions domain requires further research.
Motion data with artiﬁcially added white Gaussian noise
(Figure 9) was decomposed by a lifting schema into two
levels of resolutions with detail quaternions coefﬁcients.
Coefﬁcients from the ﬁrst levels of transformation are small
and mostly contain information about high frequency com-
ponent. We can see this in Figure 10. In the reverse lifting
scheme those coefﬁcients were set to the unit quaternion.
The results of the Haar and linear lifting schemes are
presented in Figure 11. Because the prediction step in the
linear lifting schema is based on two adjacent samples, the
results of denoising for this schema are much better.
VII. SUMMARY AND FUTURE WORK
We have shown with results of our experiments that the
lifting scheme can be efﬁciently applied to quaternions. This
226
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

0
50
100
150
200
250
300
−10
−5
0
5
10
Frame
Y−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−20
0
20
40
Frame
X−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−5
0
5
10
Frame
Z−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−0.1
−0.05
0
0.05
0.1
0.15
Frame
Y−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−0.4
−0.2
0
0.2
0.4
Frame
X−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−0.2
−0.1
0
0.1
0.2
Frame
Z−axsis rotation angle(degrees)
Figure 7.
The ﬁrst level of resolution computed by the linear lifting schema: data (left plot) and details (right plot).
0
5
10
15
20
25
30
35
40
−10
−5
0
5
10
Frame
Y−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−20
0
20
40
60
Frame
X−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−5
0
5
10
15
Frame
Z−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−5
0
5
10
Frame
Y−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−20
−10
0
10
20
Frame
X−axsis rotation angle(degrees)
0
5
10
15
20
25
30
35
40
−4
−2
0
2
4
6
Frame
Z−axsis rotation angle(degrees)
Figure 8.
The forth level of resolution computed by the linear lifting schema: data (left plot) and details(right plot).
0
100
200
300
400
500
600
−10
−5
0
5
10
Frame
Y−axsis rotation angle(degrees)
0
100
200
300
400
500
600
−20
0
20
40
Frame
X−axsis rotation angle(degrees)
0
100
200
300
400
500
600
−5
0
5
10
Frame
Z−axsis rotation angle(degrees)
0
100
200
300
400
500
600
−10
−5
0
5
10
Frame
Y−axsis rotation angle(degrees)
0
100
200
300
400
500
600
−20
0
20
40
Frame
X−axsis rotation angle(degrees)
0
100
200
300
400
500
600
−5
0
5
10
Frame
Z−axsis rotation angle(degrees)
Figure 11.
The motion data after removal of noise based on the Haar (left plot) and the linear lifting schema (right plot).
allows us to quickly and in place multi-resolution analysis
applied directly on quaternion signal, which is a description
of orientation changes over time. Using quaternion algebra
properly, following quaternion space laws, data correlation
would be captured at each level of resolution. This is more
efﬁcient than analyzing changes in time of each angle as a
non-correlated signal.
Moreover, we are looking forward to creating proper
update and predict steps for more complex quaternion inter-
polation methods mentioned in this paper, but not included
in our research.
The results of multi-resolution representation can also
be a base for different motion processing algorithms as a
generalization of signal processing tools. Examples can be
ﬁltering, feature detection and compression. As an example,
the very simple denoising algorithm was presented in this
paper.
227
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

0
100
200
300
400
500
600
−10
−5
0
5
10
Frame
Y−axsis rotation angle(degrees)
0
100
200
300
400
500
600
−20
0
20
40
Frame
X−axsis rotation angle(degrees)
0
100
200
300
400
500
600
−5
0
5
10
Frame
Z−axsis rotation angle(degrees)
Figure 9.
The signal with added white Gaussian noise.
0
50
100
150
200
250
300
−1
−0.5
0
0.5
1
Frame
Y−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−2
−1
0
1
2
Frame
X−axsis rotation angle(degrees)
0
50
100
150
200
250
300
−0.5
0
0.5
1
Frame
Z−axsis rotation angle(degrees)
Figure 10.
The Euler angles of the ﬁrst level of details coefﬁcients
computed by the linear lifting scheme.
ACKNOWLEDGMENT
Used application is based on QuTEM [20] implemented
by K. Lebek.
This work was partly supported by the European Commu-
nity from the European Social Fund (UDA-POKL.04.01.01-
00-106/09) and by grant (number NN518289240, ”The de-
velopment of a quantitative measurement of motion, ratio-
nalizing, on the basis of multimodal motion measurement,
UPDRS subjective criteria in order to improve pre and post
DBS implantation diagnostics for patients with Parkinson’s
disease.”) awarded by the National Science Centre of the
Polish Ministry of Science and Higher Education.
REFERENCES
[1] J. Lee and S.Y. Shin, Multiresolution Motion Analysis and
Synthesis. Technical paper, 2000, (retrieved: 12, 2010)
[2] A. Bruderlin and L. Williams, Motion signal processing. Pro-
ceedings of the 22nd annual conference on Computer graphics
and interactive techniques, 1995, pp. 97-104
[3] P. Beaudoin, P. Poulin and M. Panne, Adapting wavelet
compression to human motion capture clips. Proceedings of
Graphics Interface, 2007, pp. 313-318
[4] Ch.-Ch. Hsieh, B-spline wavelet-based motion smoothing.
Computers and Industrial Engineering, 41(1), 2001, pp. 59-76
[5] J. Zhou, Y. Xu, and X. Yang, Quaternion wavelet phase based
stereo matching for uncalibrated images. Pattern Recogn. Lett.
28(12), 2007, pp. 1509-1522
[6] M. Parﬁeniuk and A. Petrovsky, Inherently lossless structures
for eight- and six-channel linear-phase paraunitary ﬁlter banks
based on quaternion multipliers. Signal Processing (Elsevier),
90(6), 2010, pp. 1755-1767
[7] M. Parﬁeniuk and A. Petrovsky, Quaternion Multiplier Inspired
by the Lifting Implementation of Plane Rotations. IEEE Trans-
actions on Circuits and Systems I, 57(10), 2010, pp. 2708-2717
[8] W. Sweldens, The lifting scheme: A construction of second
generation wavelets. SIAM J. Math. Anal, 29(2), 1997, pp.
511-546
[9] W. Sweldens, The Lifting Scheme: A new philosophy in
biorthogonal wavelet constructions. Wavelet Applications in
Signal and Image Processing III, 1995, pp. 68-79
[10] E.J. Stollnitz, T. DeRose, and D. H. Salesin, Wavelets for
Computer Graphics: Theory and Applications. Morgan Kauf-
mann, 1996
[11] I. Daubechies, I. Guskov, P. Schr¨oder, and W. Sweldens,
Wavelets on Irregular Point Sets. Royal Society, 357, 1999,
pp. 2397-2413
[12] I. Guskov, W. Sweldens, and P. Schr¨oder, Multiresolution Sig-
nal Processing for Meshes. Computer Graphics Proceedings,
1999, pp. 325-334
[13] A. Szczesna, The Multiresolution Analysis of Triangle
Surface Meshes with Lifting Scheme. In Computer Vi-
sion/Computer Graphics Collaboration Techniques, Proceed-
ings of MIRAGE, Gagalowicz A., Philips W. (editors),
Springer, LNCS 4418, 2007, pp. 274-282
[14] M. Jansen and P. Oonincx, Second Generation Wavelets and
Applications. Springer, 2005
[15] J.C. Hart, G.K. Francis, and L.H. Kauffman, Visualizing
Quaternion Rotation. ACM Trans. Graph. 13(3), 1994, pp. 256-
276
[16] K. Shoemaker, Animating Rotation with Quaternion Curves.
SIGGRAPH Comput. Graph., 19(3), 1985, pp. 245-254
[17] A. Sudbery, Quaternionic analysis. Proc. Camb. Phil. Soc. 85,
1979, pp. 199-225
[18] E.B. Dam, M. Koch, and M. Lillholm, Quaternions, Inter-
polation and Animation. University of Copenhagen, Denmark.
Technical Report, 1998, (retrieved: 12, 2010)
[19] C. Buckley, Bezier Curves for Camera Motion. Department of
Computer Science, Trinity College, Dublin , 1994, (retrieved:
12, 2010)
[20] M.P. Johnson, Exploiting Quaternions to Support Expressive
Interactive Character Motion. Massachusetts Institute of Tech-
nology, PhD Thesis, 2003
228
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-184-7
ICONS 2012 : The Seventh International Conference on Systems

