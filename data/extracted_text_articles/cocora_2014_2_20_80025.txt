FBMC/COQAM: An Enabler for Cognitive Radio
Hao Lin and Pierre Siohan
Orange Labs
Cesson S´evign´e, France
Email: hao.lin,pierre.siohan@orange.com
Abstract—To solve the issue of spectrum scarcity, new paradigms
of spectrum access must be investigated. The Cognitive Radio
(CR) is an efﬁcient solution to response to the requirement. But
it needs the support from physical layer design, especially the
signal modulation. In the literature, Filter-Bank-based Multi-
Carrier with Offset QAM (FBMC/OQAM) and Generalized Fre-
quency Division Multiplexing (GFDM) were proposed as suitable
enablers for CR. However, both of them have some drawbacks
that eventually prevent them from a practical usage. In this paper,
we present an improved modulation scheme, which successfully
combines these two schemes into one named FBMC/Circular
OQAM (FBMC/COQAM). With this scheme, we are able to
overcome all the drawbacks of its predecessors, while still keeping
their advantages.
Keywords-Cognitive Radio; FBMC; GFDM; OQAM.
I.
INTRODUCTION
In the vision towards future radio systems, the spectrum
scarcity tends to be an inevitable issue, which urgently calls
for some new spectrum access paradigms. The CR as an
emerging application effectively addresses the requirement for
efﬁcient spectrum usage. Nevertheless, the implementation of
CR solutions needs the support from a suitable modulation.
Indeed, one important requirement is that the modulation
scheme must provide a good spectrum localization. Orthogonal
Frequency Division Multiplexing (OFDM) has been widely
used in today’s radio communications. However, the main
drawback of the OFDM systems is the rectangular pulse shap-
ing, which leads to an unsatisfactory energy localization in fre-
quency domain. This drawback can cause several consequences
in CR applications because the high out-of-band radiation
may severely pollute the neighbors in the adjacent bands.
To overcome this problem or, otherwise said, to enable the
CR concept, more advanced modulation scheme is necessarily
required. During the past years, two main alternatives have
been proposed in the CR ﬁeld, i.e., FBMC/OQAM and GFDM.
The FBMC/OQAM scheme shifts the conventional OFDM
paradigm [1]. The key idea is that the modulated data at each
subcarrier is shaped by a well-designed prototype ﬁlter, which
is different from the rectangular pulse in OFDM, so that it
indeed provides a large number of degrees of freedom to use
different waveform shapes that can be intentionally optimized
towards the localized frequency content, straightforwardly en-
abling the CR applications [2]. Since then, many research
works have been conducted towards the CR applications,
in particular for FBMC/OQAM [3]–[7]. However, since the
FBMC/OQAM is a continuous transform based scheme, it
is not easy to employ a Cyclic Preﬁx (CP), which makes
it less robust against the frequency selective fading. Another
alternative, which is the GFDM, extends the traditional OFDM
paradigm to a general framework by introducing a circular
ﬁltering at each subcarrier with an improved pulse shape.
By this way, it trades the orthogonality with the possibility
of using a non-rectangular pulse. This is the reason why
the GFDM is recognized as a non-orthogonal system [8].
The GFDM was ﬁrst presented for the communication over
TV white space. Later, due to its good out-of-band energy
attenuation, it rapidly captured a lot of attention in the CR
ﬁeld [9]–[12]. Nevertheless, its non-orthogonality could be a
vital drawback in a practical usage. The in-band interference
severely causes a performance degradation, which further
was proved to be pulse shape dependent [13]. To mitigate
the performance degradation, one possible solution is to use
an iterative interference cancellation [11]. Thus, the receiver
complexity gets largely increased and might even get exploded
when considering it together with Multiple-Input-Multiple-
Output (MIMO) transmission. Although, it is absolutely neces-
sary to seek for an advanced Multi-Carrier Modulation (MCM)
scheme at a price of increased complexity, when it exceeds an
affordable limit, the practical implementation of such system
cannot be envisaged in a near future.
In this paper, we propose a novel MCM concept that
successfully combines FBMC/OQAM with GFDM. To be
speciﬁc, we adopt the circular ﬁltering for the FBMC/OQAM,
which makes it a block transform scheme. Such that the CP can
be easily inserted. We call this scheme FBMC/COQAM. More-
over, the core part of this scheme remains the FBMC/OQAM
structure, which indeed allows to guarantee a true orthogonal-
ity system. Thus, the non-orthogonality issue of GFDM can be
solved and in the meantime it enhances the robustness against
the fading channels. Ultimately, it shows a good suitability
for CR applications. The rest of the paper is organized as
follows: in Section II, we give a brief recall of FBMC/OQAM
and GFDM schemes. In Section III, we present the concept
of the FBMC/COQAM and its motivation behind. In Section
IV, we detail the FBMC/COQAM transmitter design in radio
transmission. In Section V, we evaluate the FBMC/COQAM
efﬁciency. Some conclusions are drawn in Section VI. For
simplicity, in the following, we ignore the term FBMC for
FBMC/OQAM and FBMC/COQAM, respectively.
II.
OQAM AND GFDM BACKGROUND
In this section, we give a brief introduction of the OQAM
and GFDM schemes which clearly shows the difference be-
30
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-323-0
COCORA 2014 : The Fourth International Conference on Advances in Cognitive Radio

tween these two schemes, paving the way for an introduction
of our proposal.
A. OQAM modulation
The remarkable contribution of the OQAM concept is that
it introduced a staggered transmission structure, which allows
it to escape from the Balian-Low Theorem (BLT) [14]. So that
the OQAM scheme can simultaneously employ an improved
pulse shape; keep full orthogonality; and transmit at the Nquist
rate. Contrary to the OFDM scheme that transmits complex-
valued at subcarriers, in the staggered structure, the real and
imaginary parts of the complex-valued symbols are transmitted
separately with a delay of half OFDM symbol duration. More
details for the OQAM concept can be found in [1] and the
references therein. The baseband OQAM modulated signal
writes as [15]
sOQAM[k] =
M−1
∑
m=0
∑
n∈Z
am,n g[k − nN]ej 2π
M m(k− D
2 )ejϕm,n
|
{z
}
gm,n[k]
, (1)
where M is the number of carriers; g is the prototype ﬁlter
with a length of Lg and D = Lg −1 (here, g is assumed to be
real-valued and symmetrical); N = M/2 is the discrete-time
offset; ϕm,n is an additional phase term at subcarrier m and
symbol index n which can be expressed as π
2 (n + m). The
transmitted symbols am,n are real-valued. They are obtained
from a QAM constellation, taking the real and imaginary
parts of these complex-valued symbols. To address a perfect
reconstruction of real symbols, the prototype ﬁlter must satisfy
the orthogonality condition:
ℜ
{∑
k∈Z
gm,n[k]g∗
p,q[k]
}
= δm,pδn,q,
(2)
where ∗ denotes the complex conjugation, δm,p = 1 if m = p
and δm,p = 0 if m ̸= p.
B. GFDM modulation
The idea of GFDM is to group a set of complex-valued
symbols from time-frequency lattice into one block. Then, for
each block, a subcarrier-wise processing is carried out, which
includes the up-sampling, pulse shaping, tail biting and ﬁnally
is followed by a modulated operation to a set of subcarrier
frequencies (cf. [8, Fig. 1]). The baseband GFDM modulated
signal of one block, i.e., for k ∈ [0, MK − 1], is expressed as
sGFDM[k] =
M−1
∑
m=0
K−1
∑
n=0
cm[n]˜h[k − nM]e
j2πkm
N
,
(3)
with M the subcarrier number; K the number of symbol slots
considered in one block; cm[n] the complex-valued symbols
at m-th carrier and n-th symbol slot. The pulse shape ˜h[k]
indicates a periodic repetition of the prototype ﬁlter h[k] with
a period of MK, i.e.,
˜h[k] = h[mod(k, MK)].
(4)
The periodic ﬁlter is used to realize the circular convolution
at the transmitter, which is equivalent to the tail biting process
[8]. Note that there does not exist any orthogonality condition
for the ﬁlter design because the GFDM itself is a non-
orthogonal system.
III.
COQAM: MOTIVATION AND CONCEPT
As previously stated, the OQAM and GFDM schemes
inherit some weak points. For the OQAM scheme, due to its
continuous transform nature, it is not straightforward to use
a CP. Thus, in the radio environment, the frequency selective
fading usually ruins the orthogonality of the OQAM system,
leading to a performance degradation. Therefore, more com-
plex multi-tap equalizers are needed to warrant the quality of
the transmission [16]–[18]. Similar to the OQAM, the GFDM
itself is a non-orthogonal scheme. Thus, the performance
must be guaranteed with a more powerful receiver design.
The authors in [13] have shown that even in a distortion
free channel the matched ﬁlter cannot address a satisfactory
performance. Although the degradation can be relieved by an
appropriate ﬁlter, with an example of a raised cosine ﬁlter
given in [13], the ﬁlter must be driven close to its ideal
limit, which increases the complexity. Alternatively, the GFDM
can employ an iterative interference cancellation method [11],
resulting, nevertheless, in a high complex receiver, in particular
when it is in combination with MIMO transmission.
The drawback of OQAM is due to the fact that the OQAM
is not a block processing scheme, while the drawback of
GFDM is due to that its non-orthogonality is restricted by the
BLT. Knowing the problematic for these schemes, an intuitive
question is whether we can ﬁnd an improved modulation that
keeps all the beneﬁts of OQAM and GFDM and at the same
time gets rid of their drawbacks. With this motivation in
mind, we investigated a new MCM scheme called COQAM,
whose idea is to replace the linear convolution inherited in
the OQAM with a circular convolution used in the GFDM.
By this way we get a modulation scheme which, as CP-
OFDM and GFDM, corresponds to a block transform. The
baseband COQAM modulation structure is depicted in Fig. 1.
For a discrete-time signal s[k] deﬁned in a block interval such
×
×
×
↑ N
↑ N
↑ N
Cyclic Conv
g[k]
×
×
×
+
a0[n]
a1[n]
aM−1[n]
s[k]
ejϕ0,n
ejϕ1,n
ejϕM−1,n
1
ej 2πk
M
ej 2πk(M−1)
M
Figure 1.
FBMC/COQAM baseband modulation.
that k ∈ [0, MK − 1], the baseband COQAM modulation is
expressed as
sCOQAM[k] =
M−1
∑
m=0
K−1
∑
n=0
am[n]˜g[k − nN]ej 2π
M m(k− D
2 )ejϕm,n,
(5)
with K the number of real symbol slots per each block. Like
GFDM, to implement a circular convolution with a prototype
ﬁlter g of length L = KM, we introduce a pulse shaping ﬁlter
denoted ˜g, obtained by the periodic repetition of duration KM
31
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-323-0
COCORA 2014 : The Fourth International Conference on Advances in Cognitive Radio

of the prototype ﬁlter g, i.e.,
˜g[k] = g[mod(k, MK)].
(6)
The orthogonality condition for the ﬁlter design is in line with
(2). This can be readily proven using the symmetrical property
of the ﬁlter.
IV.
COQAM TRANSMITTER DESIGN IN A RADIO SYSTEM
In order to maintain a perfect orthogonality after a trans-
mission through a multi-path channel, we introduce a CP to
cancel the inter block interference. Moreover, as we want to
prevent an alteration of the Power Spectral Density (PSD),
resulting from a spectral leakage due to the block processing,
a windowing is applied after CP insertion. The transmission
system resulting from these two operations is named windowed
CP-FBMC/COQAM (WCP-COQAM). Denoting the CP length
by LCP, we get LCP = LGI + LRI, where LGI is the CP part used
to ﬁght against the multi-path channel interference and LRI is
the portion devoted to windowing.
The l-th block of the WCP-COQAM signal sWCP-COQAM[k],
for k = 0, · · · , KM + LCP − 1, can be obtained from the l-th
block of the COQAM signal, for k = 0, · · · , KM − 1, by
sWCP-COQAM[k]
=
l+1
∑
r=l−1
sCOQAM[mod(k − LCP, KM)]
×
w[k − rQ],
(7)
where Q = KM + LGI and w[k], deﬁned in the k =
0, · · · , KM + LCP − 1 interval, is the window function com-
puted as follows
w[k] =
{ window coeffs.
k ∈ [0, LRI − 1]
1
k ∈ [LRI, KM + LGI − 1]
w[KM + LCP − 1 − k]
otherwise.
The WCP-COQAM transmitter structure is depicted in Fig. 2,
where s1[k] denotes sCOQAM[k], which is obtained from Fig. 1
and s2[k] stands for sWCP-COQAM[k].
S/P
CP
insertion
×
×
×
↑ Q
↑ Q
↑ Q
+
+
z−1
z−1
z−1
s1[k]
w[0]
w[1]
w[KM + LCP − 1]
s2[k]
Figure 2.
Transmitter of the windowed CP-FBMC/COQAM system.
There are extensive works on the window design [19].
In this paper, we simply use the Hamming window for this
windowing process. Particular investigation on the window
design in the context of COQAM will be envisaged in the
future step. Furthermore, it is worth noting that the additional
part LRI does not reduce the spectral efﬁciency as it falls only
in the overlapped samples between two successive blocks.
V.
SIMULATION EVALUATION
To illustrate the efﬁciency of the proposed WCP-COQAM
scheme, we ﬁrst evaluate the PSD of the afore-mentioned
MCM candidates. In our simulation, the PSD is estimated
using the Welch method [20]. The parameters used in our
simulation are: number of subcarriers is ﬁxed to M = 128 for
all MCM schemes. Regarding the prototype ﬁlter for OQAM,
WCP-COQAM and GFDM, in our simulation a Square Root
Raised Cosine (SRRC) ﬁlter is used with the roll-off factor
0.5 and length up to 6M. The CP contains 32 samples
for CP-OFDM, WCP-COQAM and GFDM. In particular, the
windowing interval for WCP-COQAM is LRI = 16 samples.
The result of the PSD comparison is given in Fig. 3. It clearly
−0.5
0
0.5
−60
−50
−40
−30
−20
−10
0
Normalized frequency
PSD (dB)
 
 
CP−OFDM
Classical OQAM
WCP−COQAM
GFDM
Figure 3.
PSD simulation, M = 128, SRRC with roll-off 0.5.
shows that the WCP-COQAM can remain a satisfactory low
level of the out-of-band spectral leakage. In fact, for some CR
applications, non-contiguous bands are sometimes considered
for addressing dynamic spectrum sharing. In this sense, the in-
band notch spectrum shape becomes extremely important, as it
directly reﬂects the spectrum management granularity, which
can be used to drive its dynamics to the ultimate limit. A good
MCM scheme is expected to provide a low spectral radiation
in the notch band, in order not to create severe interference to
the neighboring bands. As shown in Fig. 4, the WCP-COQAM
is able to keep a low power leakage in the notch band. On
the other hand, we note that although the PSD of GFDM
is improved compared with CP-OFDM, it cannot provide a
similar PSD as for the OQAM and WCP-COQAM schemes,
because the block processing of GFDM still generates the
spectral leakage due to the discontinuity on the edge of each
block [19]. Hence, the windowing process can alternatively be
employed to the GFDM for further spectral leakage mitigation.
However, this cannot relieve its non-orthogonality issue.
32
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-323-0
COCORA 2014 : The Fourth International Conference on Advances in Cognitive Radio

−0.1
0
0.1
0.2
0.3
0.4
−60
−50
−40
−30
−20
−10
0
Normalized frequency
PSD (dB)
 
 
CP−OFDM
Classical OQAM
WCP−COQAM
GFDM
Figure 4.
PSD simulation with notch, M = 128, SRRC with roll-off 0.5..
Next, we provide an orthogonality evaluation to show
that the WCP-COQAM perfectly retains the orthogonality.
Moreover, it is quite robust against the frequency selective
fading. Our evaluation follows two steps. In the ﬁrst step,
which is similar to [13], we evaluate the Bit Error Rate
(BER) performance in an Additive White Gaussian Noise
(AWGN) channel. We keep the same parameter setting as in
the PSD evaluation and the symbol constellation is QPSK. The
receiver does not employ any equalizer but a matched ﬁlter.
The simulation result is reported in Fig. 5, where we use the
CP-OFDM curve as a reference because it reﬂects the QPSK
Matched-Filter (MF) bound in AWGN. It is clearly shown that
0
2
4
6
8
10
10
−3
10
−2
10
−1
10
0
SNR (dB)
BER
 
 
CP−OFDM
OQAM
WCP−COQAM
GFDM
Figure 5.
Matched ﬁlter BER for uncoded QPSK in AWGN channel.
the conventional OQAM and WCP-COQAM systems are fully
orthogonal because their BER curves are overlapped with the
CP-OFDM curve. On the other hand, the GFDM curve cannot
merge with the other ones due to its non-orthogonality. A per-
formance degradation can be seen, conﬁrming that the matched
ﬁlter cannot cancel the interference brought by the neighboring
10
15
20
25
30
10
−4
10
−3
10
−2
10
−1
SNR (dB)
BER
 
 
CP−OFDM
OQAM
WCP−COQAM
GFDM
Figure 6.
BER for uncoded QPSK in dispersive channel with ZF equalizer.
symbols. Thus, it needs a more advanced equalizer. In the
second step, we show that the WCP-COQAM is still quite
robust against the frequency selective fading. In our simulation,
we consider a wireless dispersive fading channel, similar to
[21], with impulse response hch[k] = ∑
p αpδ(k − p), where
αp are complex i.i.d. Gaussian variables with the power proﬁle
following E[|αp|2] = e−p/r and, r, the normalized delay
spread. In our simulation, we choose r = 4, reﬂecting a severe
frequency selective fading. The channel is normalized and is
truncated at −20 dB. The receiver equalization technique uses
a one-tap Zero-Forcing (ZF) equalization for all the MCM
schemes. The simulation result, presented in Fig. 6, shows that
even under a severe fading environment, the WCP-COQAM
curve is still merged with the CP-OFDM. While for the OQAM
and GFDM, a degradation by several decibels is displayed.
Hence, the result proves that the WCP-COQAM is very robust
against the frequency selective fading. With our simulations,
we can conclude that the WCP-COQAM can keep all the
beneﬁts of the proposed MCM schemes and get rid of their
drawbacks. Thus, this scheme can be seen as a good physical
layer enabler for the CR applications.
VI.
CONCLUSION AND FUTURE WORK
In this paper, we presented a novel multi-carrier modu-
lation scheme, which combines the conventional OQAM and
GFDM concepts and successfully keeps all their beneﬁts and
at the same time overcomes their drawbacks. The simulation
conﬁrmed the achievements of this new scheme and further
proved its efﬁciency as a suitable physical layer modulation
for cognitive radio applications. In the next step, we will
investigate a dedicated window design, as well as an analysis
on the Peak-to-Average-Power-Ratio (PAPR).
REFERENCES
[1]
B. Le Floch, M. Alard, and C. Berrou, “Coded Orthogonal Frequency
Division Multiplex,” Proceedings of the IEEE, vol. 83, Jun. 1995, pp.
982–996.
[2]
M. Bellanger, T. Ihalainen, and M. Renfors, “Filter bank based cognitive
radio physical layer,” in Proc. of ICT-Mobile Summit, Santander, Jun.
2009, ISBN: 978-1-905824-12-0.
33
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-323-0
COCORA 2014 : The Fourth International Conference on Advances in Cognitive Radio

[3]
M. Shaat and F. Bader, “Computationally Efﬁcient Power Allocation
Algorithm in Multicarrier Based Cognitive Radio Networks: OFDM and
FBMC systems,” EURASIP Journal on Advanced Signal Processing
(ASP), vol. 2010, 2010:528378, 13 pages.
[4]
H. Zhang, D. Le Ruyet, D. Roviras, Y. Medjahdi and H. Sun, “Spectral
Efﬁciency Comparison of OFDM/FBMC for Uplink Cognitive Radio
Networks,” EURASIP Journal on Advanced Signal Processing (ASP),
vol. 2010, 2010:621808, 14 pages.
[5]
H. Zhang, D. Le Ruyet, and M. Terr´e, “Spectral Correlation of Mul-
ticarrier Modulated Signals and its Application for Signal Detection,”
EURASIP Journal on Advanced Signal Processing (ASP), vol. 2010,
2010:794246, 13 pages.
[6]
M. Renfors,
“Spectrum monitoring schemes for FBMC cognitive
radios,” in Proc. Future Network and MobileSummit (FNMS 2010),
Florence, Italy, Jun. 2010, pp. 1–9.
[7]
T. Ihalainen, A. Viholainen, T.H. Stitz and M. Renfors,
“Reappear-
ing primary user detection in FBMC/OQAM cognitive radios,”
in
CROWNCOM conference, Cannes, France, Jun. 2010, pp. 1–5.
[8]
G. Fettweis, M. Krondorf, and S. Bittner,
“GFDM-Generalized
Frequency Division Multiplexing,”
in
IEEE Vehicular Technology
Conference (VTC Spring’09), Barcelona, Spain, Apr. 2009, pp. 1–4.
[9]
N. Michailow, M. Lentmaier, P. Rost, and G. Fettweis, “Integration of
a GFDM Secondary System in an OFDM Primary System,” in Future
Network and Mobile Summit (FNMS’11), Warsaw, Jan. 2011, pp. 1–8.
[10]
R. Datta, N. Michailow, S. Krone, M. Lentmaier, and G. Fettweis,
“Generalized Frequency Division Multiplexing in Cognitive Radio,”
in European Signal Processing Conference (EUSIPCO’12), Bucharest,
Romania, Aug. 2012, pp. 2679 – 2683.
[11]
R. Datta, N.Michailow, M. Lentmaier, and G. Fettweis,
“GFDM
Interference Cancellation for Flexible Cognitive Radio PHY Design,”
in IEEE Vehicular Technology Conference (VTC Fall’12), Quebec city,
Canada, Sept. 2012, pp. 1–5.
[12]
R. Datta, D. Panaitopol, and G. Fettweis, “Analysis of Cyclostationary
GFDM Signal Properties in Flexible Cognitive Radio,”
in
Interna-
tional Symposium on Communication and Information Technologies
(ISCIT’12), Gold Coast, Australia, Oct. 2012, pp. 663 – 667.
[13]
N. Michailow, S. Krone, M. Lentmaier, and G. Fettweis, “Bit Error
Rate Performance of Generalized Frequency Division Multiplexing,” in
IEEE Vehicular Technology Conference (VTC Fall’12), Quebec city,
Canada, Sept. 2012, pp. 1–5.
[14]
H.G. Feichtinger and T. Strohmer,
Gabor Analysis and Algorithm -
Theory and Applications, Birkh¨auser, Boston-Basel-Berlin, 1998.
[15]
P. Siohan, C. Siclet, and N. Lacaille,
“Analysis and design of
OFDM/OQAM systems based on ﬁlterbank theory,” IEEE Transactions
on Signal Processing, vol. 50, no. 5, May 2002, pp. 1170–1183.
[16]
T. Ihalainen, T. H. Stitz, M. Rinne, and M. Renfors,
“Channel
Equalization in Filter Bank Based Multicarrier Modulation for Wireless
Communications,” EURASIP Journal on Advances in Signal Process-
ing, vol. 2007, no. ID 49389, Aug. 2007, pp. 1–17.
[17]
P. Tanguy H. Lin, P. Siohan and J-P. Javaudin, “An analysis of EIC for
OFDM/OQAM systems,”
Journal of Communications (JCM), vol. 4,
no. 1, Feb. 2008, pp. 52–60.
[18]
G. Ndo, H. Lin, and P. Siohan, “FBMC/OQAM equalization: Exploiting
the imaginary interference,” in
PIMRC’12, Sydney, Australia, Sept.
2012, pp. 2359 – 2364.
[19]
F.J. Harris, “On the Use of Windows for Harmonic Analysis with the
Discrete Fourier Transform,” Proceedings of the IEEE, vol. 66, no. 1,
Jan. 1978, pp. 51 – 83.
[20]
P. D. Welch, “The Use of Fast Fourier Transform for the Estimation
of Power Spectra: A Method Based on Time Averaging Over Short,
Modiﬁed Periodograms,”
IEEE Tans. Audio and Electroacoust, vol.
AU-15, Jun. 1967, pp. 17–20.
[21]
T. Fusco, A. Petrella, and M. Tanda, “Data-Aided Symbol Timing and
CFO Synchronization for Filter Bank Multicarrier Systems,”
IEEE
Tans. on Wireless Communications, vol. 8, May 2009, pp. 2705–2715.
34
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-323-0
COCORA 2014 : The Fourth International Conference on Advances in Cognitive Radio

