Near Capacity Signaling over Fading Channels using Coherent Turbo Coded OFDM
and Massive MIMO
K. Vasudevan
Dept. of EE
IIT Kanpur
India
Email: vasu@iitk.ac.in
Abstract—The minimum average signal-to-noise ratio (SNR) per
bit required for error-free transmission over a fading channel
is derived, and is shown to be equal to that of the additive
white Gaussian noise (AWGN) channel, which is −1.6 dB.
Discrete-time algorithms are presented for timing and carrier
synchronization, as well as channel estimation, for turbo coded
multiple input multiple output (MIMO) orthogonal frequency
division multiplexed (OFDM) systems. Simulation results show
that it is possible to achieve a bit error rate of 10−5 at an
average SNR per bit of 5.5 dB, using two transmit and two receive
antennas. We then propose a near-capacity signaling method in
which each transmit antenna uses a different carrier frequency.
Using the near-capacity approach, we show that it is possible to
achieve a BER of 2×10−5 at an average SNR per bit of just 2.5
dB, with one receive antenna for each transmit antenna. When
the number of receive antennas for each transmit antenna is
increased to 128, then a BER of 2×10−5 is attained at an average
SNR per bit of 1.25 dB. In all cases, the number of transmit
antennas is two and the spectral efﬁciency is 1 bit/transmission
or 1 bit/sec/Hz. In other words, each transmit antenna sends 0.5
bit/transmission. It is possible to obtain higher spectral efﬁciency
by increasing the number of transmit antennas, with no loss
in BER performance, as long as each transmit antenna uses a
different carrier frequency. The transmitted signal spectrum for
the near-capacity approach can be restricted by pulse-shaping.
In all the simulations, a four-state turbo code is used. The
corresponding turbo decoder uses eight iterations. The algorithms
can be implemented on programmable hardware and there is a
large scope for parallel processing.
Keywords–Channel capacity; coherent detection; frequency se-
lective Rayleigh fading channel; massive multiple input multi-
ple output (MIMO); orthogonal frequency division multiplexing
(OFDM); spectral efﬁciency; turbo codes.
I.
INTRODUCTION
We begin this article with an open question: what is
the operating signal-to-noise (SNR) per bit or Eb/N0 of
the present day mobile phones [1]–[3]? The mobile phones
indicate a typical received signal strength of −100 dBm (10−10
mW), however this is not the SNR per bit.
The above question assumes signiﬁcance since future wire-
less communications, also called the 5th generation or 5G [4]–
[7], is supposed to involve not only billions of people, but
also smart machines and devices, e.g., driverless cars, remotely
controlled washing machines, refrigerators, microwave ovens,
robotic surgeries in health care and so on. Thus, we have to
deal with an internet of things (IoT), which involves device-
to-human, human-to-device and device-to-device communica-
tions. Due to the large number of devices involved, it becomes
imperative that each device operates at the minimum possible
average SNR per bit required for error-free communication.
Depending on the application, there are different require-
ments on the communication system. Critical applications like
driverless cars and robotic surgeries require low to medium
bit rates, e.g., 0.1 – 10 Mbps and low latency (the time taken
to process the received information and send a response back
to the transmitter) of the order of a fraction of a millisecond.
Some applications like watching movies on a mobile phone
require high bit rates, e.g., 10 – 1000 Mbps for high density
and ultra high density (4k) video and can tolerate high latency,
of the order of a fraction of a second. Whatever the application,
the 5G wireless communication systems are expected to share
some common features like having a large number of transmit
and receive antennas also called massive multiple input mul-
tiple output (MIMO) [8]–[11] and the use of millimeter wave
carrier frequencies (> 100 GHz) [12]–[16], to accommodate
large bit-rates (> 1 Gbps) and large number of users. In this
paper we deal with the physical layer of wireless systems
that are also applicable to 5G. The main topics addressed
in this work are timing and carrier synchronization, channel
estimation, turbo codes and orthogonal frequency division
multiplexing (OFDM). Recall that OFDM converts a frequency
selective channel into a ﬂat channel [17] [18].
Channel characteristics in the THz frequency range and
at 17 GHz for 5G indoor wireless systems is studied in [19]
[20]. Channel estimation for massive MIMO assuming spatial
correlation between the receive antennas is considered in [21]
[22]. In [23], a MIMO channel estimator and beamformer
is described. Uplink channel estimation using compressive
sensing for millimeter wave, multiuser MIMO systems is
considered in [24] [25].
Waveform design for spectral containment of the transmit-
ted signal, is an important aspect of wireless telecommuni-
cations, especially in the uplink, where many users access a
base station. We require that the signal from one user does not
interfere with the other user. This issue is addressed in [26]–
[37]. Error control coding for 5G is discussed in [38] [39].
References to carrier and timing synchronization in OFDM
can be found in [2] [3] [40].
The capacity of single-user MIMO systems under different
22
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

assumptions about the channel impulse response (also called
the channel state information or CSI) and the statistics of
the channel impulse response (also called channel distribution
information or CDI) is discussed in [41]. The capacity of
MIMO Rayleigh fading channels in the presence of interfer-
ence and receive correlation is discussed in [42]. The low SNR
capacity of MIMO fading channels with imperfect channel
state information is presented in [43].
The main contribution of this paper is to develop discrete-
time algorithms for coherently detecting multiple input, multi-
ple output (MIMO), orthogonal frequency division multiplexed
(OFDM) signals, transmitted over frequency selective Rayleigh
fading channels. Carrier frequency offset and additive white
Gaussian noise (AWGN) are the other impairments considered
in this work. The minimum SNR per bit required for error-free
transmission over frequency selective MIMO fading channels
is derived. Finally we demonstrate how we can approach close
to the channel capacity.
To the best of our knowledge, other than the work in
[40], which deals with turbo coded single input single output
(SISO) OFDM, and [2] [3], which deal with turbo coded single
input multiple output (SIMO) OFDM, discrete-time algorithms
for the coherent detection of turbo coded MIMO OFDM
systems have not been discussed earlier in the literature.
Coherent detectors for AWGN channels is discussed in [44]
[45]. Simulations results for a 2×2 turbo coded MIMO OFDM
system indicate that a BER of 10−5, is obtained at an average
SNR per bit of just 5.5 dB, which is a 2.5 dB improvement
over the performance given in [2]. If each transmit antenna
transmits at a different carrier frequency, then we show that
it is possible to achieve a BER of 2 × 10−5 at an average
SNR per bit of just 2.5 dB, with one receive antenna for each
transmit antenna. When the number of receive antennas for
each transmit antenna is increased to 128, then a BER of
2×10−5 is obtained at an average SNR per bit of 1.25 dB. In all
cases, the number of transmit antennas is two and the spectral
efﬁciency is 1 bit/transmission or 1 bit/sec/Hz. In other words,
each transmit antenna sends 0.5 bit/transmission. It is possible
to obtain higher spectral efﬁciency by increasing the number of
transmit antennas, with no loss in BER performance, as long
as each transmit antenna uses a different carrier frequency. It
is possible to band limit the transmitted signal using pulse
shaping. In all the simulations, a four-state turbo code is used.
The corresponding turbo decoder uses eight iterations.
This paper is organized as follows. Section II presents the
system model. The discrete-time algorithms and simulation
results for the coherent receiver are given in Section III.
Near-capacity signaling is presented in Section IV. Finally,
Section V concludes the paper.
II.
SYSTEM MODEL
We assume a MIMO-OFDM system with Nt transmit and
Nr receive antennas, with QPSK modulation. The data from
each transmit antenna is organized into frames, as shown in
Figure 1(a), similar to [2] [3] [40]. Note the presence of
the cyclic sufﬁx, whose purpose will be explained later. In
Figure 1(b), we observe that only the data and postamble
QPSK symbols are interleaved. The buffer QPSK symbols (B)
are sent to the IFFT without interleaving. In Figure 1, the
Ld
Ld−
point
IFFT
B
˜sk, 3, Ld−1, nt
Ld2
Data
Postamble
Lo
B
Buffer
Buffer
˜Sk, 3, 0, nt
˜Sk, 3, Ld−1, nt
(b)
˜sk, 3, 0, nt
Data
Interleaver
π(·)
Lcp
Ld
B
Data
Postamble
B
Cyclic
preﬁx
Preamble
Lp
Cyclic
sufﬁx
Lcs
˜s1, n, nt
˜sk, 2, n, nt
˜sk, 3, n, nt
˜s4, n, nt
˜sk, n, nt
(a)
˜s5, n, nt
Figure 1.
The frame structure in the time domain.
subscript k refers to the kth frame, n denotes the time index
in a frame and 1 ≤ nt ≤ Nt is the index to the transmit
antenna. The total length of the frame is
L = Lp + Lcs + Lcp + Ld.
(1)
Let us assume a channel span equal to Lh. The channel span
assumed by the receiver is [3] [40]
Lhr = 2Lh − 1
(2)
Note that Lh depends on the delay spread of the channel, and
is measured in terms of the number of symbols. Recall that,
the delay spread is a measure of the time difference between
the arrival of the ﬁrst and the last multipath signal, as seen by
the receiver. Typically
Lh = d0/(cTs)
(3)
where d0 is the distance between the longest and shortest
multipath, c is the velocity of light and Ts is the symbol
duration which is equal to the sample spacing of ˜sk, n, nt in
Figure 1(a). We have assumed a situation where the mobile is
close to the base station and the longest path is reﬂected from
the cell edge, which is approximately equal to the cell diameter
d0, as shown in Figure 2. The base stations, depicted by green
dots, are interconnected by a high data-rate backhaul, shown
by the blue lines. The cell edge is given by the red circles.
Note that d1 < d0. In order to obtain symmetry, the backhaul
forms an equilateral triangle of length d1. The base station is
at the center of each cell, whose diameter is d0. For Lh = 10,
1/Ts = 107 bauds and c = 3 × 108 meters per sec, we get
d0 = 300 meters. Similarly with Lh = 10 and 1/Ts = 108
bauds we obtain d0 = 30 meters. In other words, as the baud
rate increases, the cell size needs to decrease, and consequently
the transmit power decreases, for the same channel span Lh.
The length of the cyclic preﬁx and sufﬁx is [17]:
Lcp = Lcs = Lhr − 1.
(4)
23
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

d1
Cell edge
cell
d0/2
Figure 2.
Arrangement of cells and base stations.
Throughout the manuscript, we use tilde to denote complex
quantities. However, complex QPSK symbols will be denoted
without a tilde, e.g., S1, n, nt. Boldface letters denote vectors or
matrices. The channel coefﬁcients ˜hk, n, nr, nt associated with
the receive antenna nr (1 ≤ nr ≤ Nr) and transmit antenna
nt (1 ≤ nt ≤ Nt) for the kth frame are C N (0, 2σ2
f) and
independent over time n, that is:
1
2E
h
˜hk, n, nr, nt˜h∗
k, n−m, nr, nt
i
= σ2
fδK(m)
(5)
where “*” denotes complex conjugate and δK(·) is the Kro-
necker delta function. This implies a uniform power delay pro-
ﬁle. Note that even though an exponential power delay proﬁle
is more realistic, we have used a uniform power delay proﬁle,
since it is expected to give the worst-case BER performance,
as all the multipath components have the same power. The
channel is assumed to be quasi-static, that is ˜hk, n, nr, nt is
time-invariant over one frame and varies independently from
frame-to-frame, as given by:
1
2E
h
˜hk, n, nr, nt˜h∗
j, n, nr, nt
i
= σ2
fδK(k − j)
(6)
where k and j denote the frame indices.
The AWGN noise samples ˜wk, n, nr for the kth frame
at time n and receive antenna nr are C N (0, 2σ2
w). The
frequency offset ωk for the kth frame is uniformly distributed
over [−0.04, 0.04] radian [46]. We assume that ωk is ﬁxed for
a frame and varies randomly from frame-to-frame.
IFFT
IFFT
Channel
˜hk, n, nr, nt
˜sk, 3, Ld−1, nt
Sk, 3, Ld−1, nt
Data QPSK
symbols
Sk, 3, 0, nt
Preamble QPSK
symbols
S1, Lp−1, nt
S1, 0, nt
˜s1, 0, nt
˜s1, Lp−1, nt
˜sk, 3, 0, nt
˜rk, n, nr
˜wk, n, nr (AWGN)
P
nt
˜yk, n, nr
e j ωkn
˜sk, n, nt
Time domain
Frequency domain
Parallel
to
serial
and
add
cyclic
preﬁx
and
sufﬁx
Figure 3.
Block diagram of the transmitter.
The block diagram of the transmitter is given in Figure 3.
24
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

With reference to Figs. 1(a) and 3, note that:
˜s1, n, nt
=
1
Lp
Lp−1
X
i=0
S1, i, nte j 2πni/Lp
for 0 ≤ n ≤ Lp − 1
˜sk, 3, n, nt
=
1
Ld
Ld−1
X
i=0
Sk, 3, i, nte j 2πni/Ld
for 0 ≤ n ≤ Ld − 1
˜sk, 2, n, nt
=
˜sk, 3, Ld−Lcp+n, nt
for 0 ≤ n ≤ Lcp − 1
˜s4, n, nt
=
˜s1, n, nt
for 0 ≤ n ≤ Lcs − 1
˜s5, n, nt
=
˜s1, n, nt + ˜s4, n−Lp, nt.
(7)
From (7), it is clear that the preamble is independent of the
frame k. However, each transmit antenna has its own preamble,
for the purpose of synchronization and channel estimation at
the receiver.
The preamble in the frequency domain, for each transmit
antenna is generated as follows. Let πp(i), for 0 ≤ i ≤ Lp −1,
denote the interleaver map for the preamble. Let
Sr =
 Sr, 0
. . .
Sr, Lp−1
T
Lp×1
(8)
denote a random vector of QPSK symbols. The preamble
vector for the transmit antenna nt is ﬁrst initialized by
S1, nt
=
 S1, 0, nt
. . .
S1, Lp−1, nt
T
Lp×1
=
0Lp×1.
(9)
Next, we substitute
S1, πp(i4:i5), nt = Sr(i4 : i5).
(10)
where i4 : i5 denotes the range of indices from i4 to i5, both
inclusive, and
i4
=
(nt − 1)Lp/Nt
i5
=
i4 + Lp/Nt − 1.
(11)
Note that the preamble in the frequency domain for each
transmit antenna has only Lp/Nt non-zero elements, the rest
of the elements are zero. Moreover, due to πp(·), the Lp/Nt
non-zero elements are randomly interspersed over the Lp
subcarriers in the frequency domain, for each transmit antenna.
By virtue of the preamble construction in (9), (10) and
(11), the preambles in the frequency and time domains corre-
sponding to transmit antennas nt and mt satisfy the relation
(using Parseval’s energy theorem):
S1, i, ntS∗
1, i, mt
=
(2NtLp/Ld)δK(nt − mt)
for 0 ≤ i ≤ Lp − 1
⇒ ˜s1, n, nt ⊙Lp ˜s∗
1, −n, mt
=





0
for nt ̸= mt,
0 ≤ n ≤ Lp − 1
(2Lp/Ld)δK(n)
for nt = mt
(12)
where “⊙Lp” denotes the Lp-point circular convolution. In
other words, the preambles corresponding to distinct transmit
antennas are orthogonal over Lp samples. Moreover, the au-
tocorrelation of the preambles in frequency and time domain,
can be approximated by a weighted Kronecker delta function
(this condition is usually satisﬁed by random sequences having
zero-mean; the approximation gets better as Lp increases).
We assume Sk, 3, i, nt ∈ {±1 ± j}. Since we require:
E
h
|˜s1, n, nt|2i
=
E
h
|˜sk, 3, n, nt|2i
= 2/Ld
∆= σ2
s (13)
we must have S1, i, nt ∈
p
LpNt/Ld (±1±j). In other words,
the average power of the preamble part must be equal to the
average power of the data part, in the time domain.
Due to the presence of the cyclic sufﬁx in Figure 1 and
(7), and due to (12), we have
˜s5, n, nt ⋆ ˜s∗
1, Lp−1−n, mt
=





0
for Lp − 1 ≤ n ≤ Lp + Lhr − 2,
nt ̸= mt
(2Lp/Ld)δK(n − Lp + 1)
for nt = mt
(14)
where “⋆” denotes linear convolution.
The signal for the kth frame and receive antenna nr can
be written as (for 0 ≤ n ≤ L + Lh − 2):
˜rk, n, nr
=
Nt
X
nt=1

˜sk, n, nt ⋆ ˜hk, n, nr, nt

e j ωkn + ˜wk, n, nr
=
˜yk, n, nre j ωkn + ˜wk, n, nr
(15)
where ˜sk, n, nt is depicted in Figure 1(a) and
˜yk, n, nr =
Nt
X
nt=1
˜sk, n, nt ⋆ ˜hk, n, nr, nt.
(16)
Note that any random carrier phase can be absorbed in the
channel impulse response.
The uplink and downlink transmissions between the mo-
biles and base station could be carried out using time division
duplex (TDD) or frequency division duplex (FDD). Time
division (TDMA), frequency division (FDMA), code division
(CDMA), orthogonal frequency division (OFDMA), for down-
link transmissions and ﬁlterbank multicarrier (FBMC), for
uplink transmissions [26], are the possible choices for multiple
access (MA) techniques.
III.
RECEIVER
In this section, we discuss the discrete-time receiver algo-
rithms.
A. Start of Frame (SoF) and Coarse Frequency Offset Estimate
The start of frame (SoF) detection and coarse frequency
offset estimation is performed for each receive antenna 1 ≤
nr ≤ Nr and transmit antenna 1 ≤ nt ≤ Nt, as given by the
following rule (similar to (22) in [40] and (24) in [3]): choose
that value of m and νk which maximizes


that (17) is a two-dimensional search over m and νk, which
can be efﬁciently implemented in hardware, and there is a large
scope for parallel processing. In particular, the search over νk
involves dividing the range of ωk ([−0.04, 0.04]] radians) into
B1 frequency bins, and deciding in favour of that bin which
maximizes (17). In our simulations, B1 = 64 [3] [40].
Note that in the absence of noise and due to the properties
given in (14)
ˆmk(nr, nt) = Lp − 1 + argmaxm
˜hk, m, nr, nt

(18)
where argmaxm corresponds to the value of m for which
˜hk, m, nr, nt
 is maximum. We also have
Lp − 1 ≤ ˆmk(nr, nt) ≤ Lp + Lh − 2.
(19)
If ˆmk(·) lies outside the range in (19), the frame is declared
as erased (not detected). This implies that the peak in (17) is
due to noise, and not due to the channel. The results for SoF
detection at 0 dB SNR per bit for Lp = 512, 1024, 4096 are
given in Figs. 4, 5, and 6, respectively, for Nt = Nr = 2.
The parameter Z in the three ﬁgures denotes the correlation
magnitude given by (17).
The average value of the coarse frequency offset estimate
is given by
ˆωk =
PNr
nr=1
PNt
nt=1 ˆνk(nr, nt)
NrNt
.
(20)
B. Channel Estimation
We assume that the SoF has been estimated using (17)
with outcome m0, k given by (assuming the condition in (19)
is satisﬁed for all nr and nt):
m0, k = ˆmk(1, 1) − Lp + 1
0 ≤ m0, k ≤ Lh − 1
(21)
and the frequency offset has been perfectly canceled [3] [40].
Observe that any value of nr and nt can be used in the
computation of (21). We have taken nr = nt = 1. Deﬁne
m1, k = m0, k + Lh − 1.
(22)
For the sake of notational simplicity, we drop the subscript k
in m1, k, and refer to it as m1. The steady-state, preamble part
of the received signal for the kth frame and receive antenna
nr can be written as:
˜rk, m1, nr =
Nt
X
nt=1
˜s5, nt ˜hk, nr, nt + ˜wk, m1, nr
(23)
where
˜rk, m1, nr
=
 ˜rk, m1, nr
. . .
˜rk, m1+Lp−1, nr
T
[Lp × 1]
vector
˜wk, m1, nr
=
 ˜wk, m1, nr
. . .
˜wk, m1+Lp−1, nr
T
[Lp × 1]
vector
˜hk, nr, nt
=
 ˜hk, 0, nr, nt
. . .
˜hk, Lhr−1, nr, nt
T
[Lhr × 1]
vector
˜s5, nt
=


˜s5, Lhr−1, nt
. . .
˜s5, 0, nt
...
. . .
...
˜s5, Lp+Lhr−2, nt
. . .
˜s5, Lp−1, nt


[Lp × Lhr]
matrix
(24)
where Lhr is the channel length assumed by the receiver (see
(2)), ˜s5, nt is the channel estimation matrix and ˜rk, m1, nr is
the received signal vector after cancellation of the frequency
offset. Observe that ˜s5, nt is independent of m1 and due to the
relations in (12) and (14), we have
˜sH
5, mt˜s5, nt =

0Lhr×Lhr
for nt ̸= mt
(2Lp/Ld)ILhr
for nt = mt
(25)
where ILhr is an Lhr × Lhr identity matrix and 0Lhr×Lhr
is an Lhr × Lhr null matrix. The statement of the ML
channel estimation is as follows. Find ˆhk, nr, mt (the estimate
of ˜hk, nr, mt) such that:
 
˜rk, m1, nr −
Nt
X
mt=1
˜s5, mt ˆhk, nr, mt
!H
 
˜rk, m1, nr −
Nt
X
mt=1
˜s5, mt ˆhk, nr, mt
!
(26)
is minimized. Differentiating with respect to ˆh∗
k, nr, mt and
setting the result to zero yields [17] [47]:
ˆhk, nr, mt =

20
10
30
0
−0.005
0.005
1
20
10
30
0
−0.005
0.005
1
20
10
30
0
−0.005
0.005
1
20
10
30
0
−0.005
1
Figure 4.
SoF detection at 0 dB SNR per bit, Lp = 512.
where
L2
=
Lhr + Lp − 1
ˆy1, k, m, nr, nt
=
˜s1, m, nt ⋆ ˆhk, m, nr, nt
(33)
where ˆhk, m, nr, nt is obtained from (27). The ﬁne frequency
offset estimate (ˆνk, f(nr, nt)) is obtained by dividing the
interval [ˆωk − 0.005, ˆωk + 0.005] radian (ˆωk is given in (20))
into B2 = 64 frequency bins [44]. The reason for choosing
0.005 radian can be traced to Figure 5 of [3]. We ﬁnd that
the maximum error in the coarse estimate of the frequency
offset is approximately 0.004 radian over 104 frames. Thus
the probability that the maximum error exceeds 0.005 radian is
less than 10−4. However, from Table IV in this paper, we note
that the maximum error in the frequency offset is 2.4 × 10−2
radians for Lp = 512, and 1.1 × 10−2 for Lp = 1024, both of
which are larger than 0.005 radian. By observing this trend,
we expect that for larger values of Lp, say Lp = 4096, the
maximum error in the coarse frequency offset estimate would
be less than 0.005 radians. Increasing Lp would also imply an
increase in Ld, for the same throughput (see (54)). The average
value of the ﬁne frequency offset estimate is given by:
ˆωk, f =
PNr
nr=1
PNt
nt=1 ˆνk, f(nr, nt)
NrNt
.
(34)
D. Super Fine Frequency Offset Estimation
The ﬁne frequency offset estimate in (34) is still inadequate
for turbo decoding and data detection when Ld ≫ Lp [40].
Note that the residual frequency offset is equal to:
ωk − ˆωk − ˆωk, f.
(35)
This residual frequency offset is estimated by interpolating the
FFT output and performing postamble matched ﬁltering at the
receiver [2] [3]. If the interpolation factor is I, then the FFT
size is ILd (interpolation in the frequency domain is achieved
by zero-padding the FFT input in the time domain, and then
taking the ILd-point FFT). Let
m2, k = m1, k + Lp + Lcs
(36)
where m1, k is deﬁned in (22). Once again, we drop the
subscript k from m2, k and refer to it as m2. Deﬁne the FFT
input in the time domain as:
˜rk, m2, nr = [ ˜rk, m2, nr
. . .
˜rk, m2+Ld−1, nr ]T
(37)
which is the data part of the received signal in (15) for the kth
frame and receive antenna nr, assumed to have the residual
frequency offset given by (35). The output of the ILd-point
FFT of ˜rk, m2, nr in (37) is denoted by
˜Rk, i, nr =
Ld−1
X
n=0
˜rk, m2+n, nre−j 2πin/(ILd)
(38)
for 0 ≤ i ≤ ILd − 1.
The coefﬁcients of the postamble matched ﬁlter is obtained
as follows [2] [3]. Deﬁne
˜G′′
k, i, nr =
Nt
X
nt=1
ˆHk, i3, nr, ntSk, 3, i, nt
for i0 ≤ i ≤ i1
(39)
where ˆHk, i, nr, nt is the Ld-point FFT of the channel estimate
27
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

20
10
30
0
−0.005
0.005
1
20
10
30
0
−0.005
0.005
1
20
10
30
0
−0.005
0.005
1
0.5
20
10
30
0
−0.005
0.005
1
Figure 5.
SoF detection at 0 dB SNR per bit, Lp = 1024.
in (27), and
i0
=
B + Ld2
i1
=
i0 + Lo − 1
i3
=
B + π(i − B)
(40)
where π(·) is the data interleaver map, B, Ld2 and Lo are
the lengths of the buffer, data, and postamble, respectively, as
shown in Figure 1(b). Let
˜G′
k, i3, nr =
 ˜G′′
k, i, nr
for i0 ≤ i ≤ i1
0
otherwise
(41)
where 0 ≤ i3 ≤ Ld − 1, the relation between i3 and i is given
in (40). Next, we perform interpolation:
˜Gk, i4, nr =
 ˜G′
k, i, nr
for 0 ≤ i ≤ Ld − 1
0
otherwise
(42)
where 0 ≤ i4 ≤ ILd − 1 and i4 = iI. Finally, the postamble
matched ﬁlter is ˜G∗
k, ILd−1−i, nr, which is convolved with
˜Rk, i, nr in (38). Note that due to the presence of the cyclic
preﬁx, any residual frequency offset in the time domain,
manifests as a circular shift in the frequency domain. The
purpose of the postamble matched ﬁlter is to capture this shift.
The role of the buffer symbols is explained in [2] [3]. Assume
that the peak of the postamble matched ﬁlter output occurs
at m3, k(nr). Ideally, in the absence of noise and frequency
offset
m3, k(nr) = ILd − 1.
(43)
In the presence of the frequency offset, the peak occurs to the
left or right of ILd − 1. The average superﬁne estimate of the
residual frequency offset is given by:
ˆωk, sf = 2π/(ILdNr)
Nr
X
nr=1
[m3, k(nr) − ILd + 1] .
(44)
E. Noise Variance Estimation
The noise variance is estimated as follows, for the purpose
of turbo decoding:
ˆσ2
w =
1
2LpNr
Nr
X
nr=1
 
˜rk, m1, nr −
Nt
X
nt=1
˜s5, nt ˆhk, nr, nt
!H
 
˜rk, m1, nr −
Nt
X
nt=1
˜s5, nt ˆhk, nr, nt
!
. (45)
F. Turbo Decoding
In this section, we assume that the frequency offset has
been perfectly canceled, that is, ˜rk, m2, nr in (37) contains no
frequency offset. The output of the Ld-point FFT of ˜rk, m2, nr
for the kth frame is given by:
˜Rk, i, nr =
Nt
X
nt=1
˜Hk, i, nr, ntSk, 3, i, nt + ˜Wk, i, nr
(46)
for 0 ≤ i ≤ Ld − 1, where ˜Hk, i, nr, nt is the Ld-point FFT
of ˜hk, n, nr, nt and ˜Wk, i, nr is the Ld-point FFT of ˜wk, n, nr. It
can be shown that [3] [40]
1
2E
 ˜Wk, i, nr

2
=
Ldσ2
w
1
2E
 ˜Hk, i, nr, nt

2
=
Lhσ2
f.
(47)
28
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

20
10
30
0
−0.005
0.005
2
1
20
10
30
0
−0.005
0.005
2
1
20
10
30
0
−0.005
0.005
1
20
10
30
0
−0.005
0.005
1
Figure 6.
SoF detection at 0 dB SNR per bit, Lp = 4096.
The received signal in (46), for the kth frame and ith subcar-
rier, can be written in matrix form as follows:
˜Rk, i = ˜Hk, iSk, 3, i + ˜
Wk, i
(48)
where ˜Rk, i is the Nr × 1 received signal vector, ˜Hk, i is the
Nr × Nt channel matrix, Sk, 3, i is the Nt × 1 symbol vector
and ˜
Wk, i is the Nr × 1 noise vector.
The generating matrix of each of the constituent encoders
is given by (41) in [3], and is repeated here for convenience:
G(D) =

1
1 + D2
1 + D + D2

.
(49)
For the purpose of turbo decoding, we consider the case where
Nr = Nt = 2. The details of turbo decoding can be found
in [3], and will not be discussed here. Sufﬁces to say that
corresponding to the transition from state m to state n, at
decoder 1, for the kth frame, at time i, we deﬁne (for 0 ≤ i ≤
Ld2 − 1):
γ1, k, i, m, n = exp

0
2 000
4 000
1 000
3 000
0
2
4
6
8
Actual
Estimated
0
2 000
4 000
1 000
3 000
0
2
4
6
8
Actual
Estimated
0
2 000
4 000
1 000
3 000
0
2
4
6
8
Actual
Estimated
0
2 000
4 000
1 000
3 000
0
2
4
6
Actual
Estimated
Figure 7.
Magnitude spectrum of estimated and actual channel, Lp = 512.
H. Simulation Results
In this section, we present the simulation results for the
proposed turbo coded MIMO OFDM system with Nt = Nr =
2. The SNR per bit is deﬁned in (92). Note that one data
bit (two coded QPSK symbols) is sent simultaneously from
two transmit antennas. Hence, the number of data bits sent
from each transmit antenna is κ = 0.5, as given in (92).
We have also assumed that σ2
f = 0.5. The frame parameters
are summarized in Table I. The maximum number of frames
simulated is 2.2 × 104, at an average SNR per bit of 6.5 dB.
Each simulation run is over 103 frames. Hence, the maximum
number of independently seeded simulation runs is 22.
TABLE I.
FRAME PARAMETERS.
Lp
Ld
B
Lo
Ld2
Lh
Lcp = Lcs
512, 1024
4096
4
256, 512
10
Value
(QPSK symbols)
Parameter
18
3832, 3576
The throughput is deﬁned as [2] [3]:
T =
Ld2
Ld + Lp + Lcp + Lcs
.
(54)
The throughput of various frame conﬁgurations is given in
TABLE II.
THROUGHPUT.
Lp
Lo
Ld2
T
512
256
3832
82.515%
1024
512
3576
69.356%
Table II. The BER simulation results for the turbo coded
MIMO OFDM system with Nt = Nr = 2 is shown in
Figure 10. Here “Id” denotes the ideal receiver. For the
practical receivers (“Pr”), the interpolation factor for superﬁne
frequency offset estimation is I = 16. The practical receiver
with Lp = 1024, Lo = 512 attains a BER of 10−5 at an
SNR per bit of 5.5 dB, which is 1 dB better than the receiver
with Lp = 512, Lo = 256. This is due to the fact that
the variance of the channel estimation error with Lp = 512
is twice that of Lp = 1024 (see (31)). This difference in
the variance of the channel estimation error affects the turbo
decoding process. Moreover, the practical receiver in Figure 10
with Lp
= 1024, Lo
= 512 is 2.5 dB better than the
practical receiver with one transmit and two receive antennas
in Figure 10 of [2].
TABLE III.
PROBABILITY OF FRAME ERASURE.
Lp = 512, Lo = 256
Lp = 1024, Lo = 512
Probability of erasure
2.98 × 10−2
7 × 10−4
Frame conﬁguration
The probability of frame erasure (this happens when (19)
30
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

0
2 000
4 000
1 000
3 000
0
2
4
6
8
Actual
Estimated
0
2 000
4 000
1 000
3 000
0
2
4
6
8
Actual
Estimated
0
2 000
4 000
1 000
3 000
0
2
4
6
1
3
5
Actual
Estimated
0
2 000
4 000
1 000
3 000
0
2
4
6
Actual
Estimated
Figure 8.
Magnitude spectrum of estimated and actual channel, Lp = 1024.
is not satisﬁed) at 0 dB SNR per bit is shown in Table III.
Clearly, as Lp increases, the probability of erasure decreases.
Finally, the root mean square (RMS) and maximum frequency
offset estimation error in radians, at 0 dB SNR per bit, is given
in Table IV.
IV.
NEAR CAPACITY SIGNALING
In Sections II and III, we had presented the discrete-time
algorithms for MIMO-OFDM. The inherent assumption in
these two sections was that all transmit antennas use the same
carrier frequency. The consequence of this assumption is that
the signal at each receive antenna is a linear combination of
the symbols from all the transmit antennas, as given in (46)
and (48). This makes the estimation of symbols, Sk, 3, i in (48),
complicated for large values of Nt and Nr (massive MIMO).
In this section, we assume that distinct transmit antennas use
different carrier frequencies. Thus, the signals from distinct
transmit antennas are orthogonal. To each transmit antenna,
we associate Nr receive antennas, that are capable of receiving
signals from one particular transmit antenna. The total number
of receive antennas is now NrNt.
In order to restrict the transmitted signal spectrum, it is
desirable to have a lowpass ﬁlter (LPF) at the output of
the parallel-to-serial converter in Figure 3, for each transmit
antenna. If we assume that the cut-off frequency of the LPF is
π/10 radians and its transition bandwidth is π/20 radians, then
the required length of the linear-phase, ﬁnite impulse response
(FIR) LPF with Hamming window would be [48]
8π/LLPF
=
π/20
⇒ LLPF
=
160.
(55)
Note that an inﬁnite impulse response (IIR) ﬁlter could also
be used. However, it may have stability problems when the
cut-off frequency of the LPF is close to zero radians. If the
physical channel has 10 taps as given by (3), then the length
of the equivalent channel as seen by the receiver would be:
Lh
=
LLPF + 10 − 1
=
160 + 10 − 1
=
169.
(56)
The values of Lp and Ld in Figure 1(a) have to be suitably
increased to obtain a good estimate of the channel (see (31))
and maintain a high throughput (see 54). Let us denote the
impulse response of the LPF by pn. We assume that pn is
obtained by sampling the continuous-time impulse response
p(t) at a rate of 1/Ts, where Ts is deﬁned in (3). Note that pn is
real-valued [48]. The discrete-time Fourier transform (DTFT)
of pn is [17] [18]:
˜PP(F)
=
LLPF−1
X
n=0
pne−j 2πF nTs
=
1
Ts
∞
X
m=−∞
˜P(F − m/Ts)
(57)
where the subscript P denotes a periodic function, F denotes
the frequency in Hz and ˜P(F) is the continuous-time Fourier
transform of p(t). Observe that:
1)
the digital frequency ω in radians is given by
ω = 2πFTs
(58)
2)
˜PP(F) is periodic with period 1/Ts
31
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

0
2 000
4 000
1 000
3 000
0
2
4
6
1
3
5
Actual
Estimated
0
2 000
4 000
1 000
3 000
0
2
4
1
3
5
Actual
Estimated
0
2 000
4 000
1 000
3 000
0
2
4
6
8
Actual
Estimated
0
2 000
4 000
1 000
3 000
0
2
4
1
3
5
Actual
Estimated
Figure 9.
Magnitude spectrum of estimated and actual channel, Lp = 4096.
TABLE IV.
FREQUENCY OFFSET ESTIMATION ERROR.
5.85 × 10−5
Superﬁne
Coarse
1.71 × 10−3
Fine
3.38 × 10−4
2.4 × 10−2
1.6 × 10−2
2.6 × 10−4
RMS
Max.
Est.
Error
conﬁguration
Frame
Lp = 512
Lo = 256
Lp = 1024
Lo = 512
3.3 × 10−4
9.2 × 10−5
4.3 × 10−5
RMS
Max.
1.2 × 10−2
3.9 × 10−4
1.82 × 10−4
3)
there is no aliasing in the second equation of (57),
that is
˜PP(F) =
˜P(F)
Ts
for − 1
2Ts < F <
1
2Ts .
(59)
Now, ˜sk, n, nt in Figure 1(a) is passed through the LPF. Let
us denote the LPF output by ˜vk, n, nt. After digital-to-analog
(D/A) conversion, the continuous-time signal is denoted by
˜vk, nt(t). The power spectral density of ˜vk, nt(t) [17] [18]
S˜v(F) = 1
Ts
· σ2
s
2 ·
 ˜P(F)

2
(60)
where we have assumed that the samples of ˜sk, n, nt are
uncorrelated with variance σ2
s given in (13). Thus the one-
sided bandwidth of the complex baseband signal ˜vk, nt(t) is
1/(20Ts) Hz, for an LPF with cut-off frequency π/10 radians,
since 1/Ts corresponds to 2π radians. Thus, the passband
signal spectrum from a single transmit antenna would have
a two-sided bandwidth of 1/(10Ts) Hz.
The frame structure is given by Figure 1. The average
power of the preamble in the time domain must be equal to that
of the data, as given by (13). Due to the use of different carrier
frequencies for distinct transmit antennas, the same preamble
pattern can be used for all the transmit antennas. Therefore, the
subscript nt can be dropped from the preamble signal, both in
the time and frequency domain, in Figure 1(a) and (7). There
are also no zero-valued preamble symbols in the frequency
domain, that is [40]
S1, i ∈
q
Lp/Ld (±1 ± j)
(61)
for 0 ≤ i ≤ Lp − 1. The block diagram of the system for
near capacity signaling is shown in Figure 11. The received
signal vector at the output of the FFT for the Nr antennas
associated with the transmit antenna nt, for the kth frame and
ith (0 ≤ i ≤ Ld − 1) subcarrier is:
˜Rk, i, nt = ˜Hk, i, ntSk, 3, i, nt + ˜
Wk, i, nt
(62)
32
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

1.0e-07
1.0e-06
1.0e-05
1.0e-04
1.0e-03
1.0e-02
1.0e-01
1.0e+00
 0
 1
 2
 3
 4
 5
 6
 7
Lp=512, Lo=256, Pr
Id
Lp=1024, Lo=512, Pr
SNR per bit (dB)
BER
Figure 10.
BER simulation results.
f1
fNt
f1
fNt
Carrier
frequency
Carrier
frequency
Carrier
frequency
Carrier
frequency
Rx 1
Rx Nr
Rx 1
Rx Nr
Figure 11.
Near capacity signaling.
where Sk, 3, i, nt is given in (7), ˜Rk, i, nt, ˜Hk, i, nt and ˜
Wk, i, nt
are Nr × 1 vectors given by:
˜Rk, i, nt
=
 ˜Rk, i, nt, 1
. . .
˜Rk, i, nt, Nr
T
˜Hk, i, nt
=
 ˜Hk, i, nt, 1
. . .
˜Hk, i, nt, Nr
T
˜
Wk, i, nt
=
 ˜Wk, i, nt, 1
. . .
˜Wk, i, nt, Nr
T .
(63)
Similar to (47), it can be shown that for 1 ≤ l ≤ Nr
1
2E
 ˜Wk, i, nt, l

2
=
Ldσ2
w
1
2E
 ˜Hk, i, nt, l

2
=
Lhσ2
f.
(64)
The synchronization and channel estimation algorithms are
identical to that given in Section III with Nt = 1.
In the turbo decoding operation we assume that Nt = 2.
The generating matrix of the constituent encoders is given by
(49). For decoder 1 and 0 ≤ i ≤ Ld2 − 1, we deﬁne [2]:
γ1, k, i, m, n =
Nr
Y
l=1
γ1, k, i, m, n, l
(65)
where
γ1, k, i, m, n, l = exp

−
 ˜Rk, i, 1, l − ˆHk, i, 1, lSm, n

2
2Ldˆσ2w


(66)
where ˆσ2
w is the average estimate of the noise variance over
all the Nr diversity arms, as given by (45) with Nt = 1, and
Sm, n is the QPSK symbol corresponding to the transition from
state m to n in the encoder trellis. Similarly at decoder 2, for
0 ≤ i ≤ Ld2 − 1, we have:
γ2, k, i, m, n =
Nr
Y
l=1
γ2, k, i, m, n, l
(67)
where
γ2, k, i, m, n, l = exp

−
 ˜Rk, i, 2, l − ˆHk, i, 2, lSm, n

2
2Ldˆσ2w

 .
(68)
1.0e-05
1.0e-04
1.0e-03
1.0e-02
1.0e-01
1.0e+00
 0
 0.5
 1
 1.5
 2
 2.5
Bit error rate
SNR per bit (dB)
Nr=1
Nr=2
Nr=128
Figure 12.
BER results for near capacity signaling with Nt = 2.
The simulation results assuming an ideal coherent receiver
is given in Figure 12, for Ld = 4096, Lp = Lo = B = Lcp =
Lcs = 0 (the preamble, postamble, buffer, cyclic preﬁx or
sufﬁx is not required, since this is an ideal coherent receiver),
Nt = 2 and different values of Nr.
TABLE V.
NUMBER OF SIMULATION RUNS FOR VARIOUS Nr.
Nr
1
2
128
Time for
1 run
75
76
88
(minutes)
SNR
per
bit (dB)
2.5
1.75
1.25
Max.
no. of
of runs
51
25
30
The maximum number of independently seeded simulation
runs for various Nr and SNR per bit is given in Table V. For
33
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

lower values of the SNR per bit, the number of runs is less
than the maximum. Each run is over 103 frames. The time
taken for one run using Scilab on an i5 processor is also given
in Table V. The total time taken to obtain Figure 12 is ap-
proximately three months. The channel coefﬁcients ˜Hk, i, nt, l
in (63) are assumed to be complex Gaussian and independent
over i and l, that is
1
2E
h
˜Hk, i1, nt, l ˜H∗
k, i2, nt, l
i
=
Lhσ2
fδK(i1 − i2)
1
2E
h
˜Hk, i, nt, l1 ˜H∗
k, i, nt, l2
i
=
Lhσ2
fδK(l1 − l2).
(69)
The average SNR per bit is given by the second equation in
(92) with
Pav
=
2
Lhσ2
f
=
0.5
κ
=
0.5.
(70)
The turbo decoder uses eight iterations. Observe that in Fig-
ure 12, we obtain a BER of 2×10−5 at an average SNR per bit
of just 2.5 dB, for Nr = 1. It is also clear from Figure 12 that
increasing Nr follows the law of diminishing returns. In fact
there is only 1.25 dB difference in the average SNR per bit,
between Nr = 1 and Nr = 128, at a BER of 2 × 10−5. The
slight change in slope at a BER of 2×10−5 is probably because
the BER needs to averaged over more number of simulation
runs. We do not expect an ideal coherent detector to exhibit
an error ﬂoor.
It is interesting to compare the average SNR per bit
deﬁnitions given by (70) and (92) for Nr = 1 in this paper,
with (38) in [40]. Observe that both deﬁnitions are identical.
However, in Figure 12, we obtain a BER of 2 × 10−5 at an
average SNR per bit of 2.5 dB, whereas in Figure 7 of [40]
we obtain a similar BER at 8 dB average SNR per bit, for the
ideal receiver. What could be the reason for this difference?
Simply stated, in this section we have assumed a 4096-tap
channel (see the ﬁrst equation in (69) and equation (37) in
[40] with Lh = Ld). However, in [40] we have considered a
10-tap channel. This is further explained below.
1)
In this section, the SNR per bit for the kth frame and
Nr = 1 is proportional to (see also (22) in [2])
SNRk, bit, 1 ∝ 1
Ld
Ld−1
X
i=0
 ˜Hk, i, nt, 1

2
(71)
where the subscript 1 in SNRk, bit, 1 denotes case (1)
and ˜Hk, i, nt, 1 is deﬁned in (63). Note that ˜Hk, i, nt, 1
is a zero-mean Gaussian random variable which is
independent over i and variance given by (64). More-
over, the right hand side of (71) gives the estimate of
the variance of ˜Hk, i, nt, 1. Let us now compute the
variance of the estimate of the variance in (71), that
is
σ2
1 = E


 
1
Ld
Ld−1
X
i=0
 ˜Hk, i, nt, 1

2
− 2Lhσ2
f
!2
 (72)
where we have used (64). It can be shown that
σ2
1 = σ4
H
Ld
=
4L2
hσ4
f
Ld
(73)
where for 0 ≤ i ≤ Ld − 1
E
 ˜Hk, i, nt, 1

2
=
2Lhσ2
f
∆=
σ2
H
Hk, i, nt, 1, I + j Hk, i, nt, 1, Q
=
˜Hk, i, nt, 1
E

H2
k, i, nt, 1, I

=
σ2
H/2
∆=
σ2
H, 1
E

H2
k, i, nt, 1, Q

=
σ2
H/2
∆=
σ2
H, 1
E

H4
k, i, nt, 1, I

=
3σ4
H, 1
E

H4
k, i, nt, 1, Q

=
3σ4
H, 1
E

H2
k, i, nt, 1, IH2
k, j, nt, 1, I

=
σ4
H, 1
i ̸= j
E

H2
k, i, nt, 1, QH2
k, j, nt, 1, Q

=
σ4
H, 1
i ̸= j
E

H2
k, i, nt, 1, IH2
k, j, nt, 1, Q

=
σ4
H, 1
(74)
where we have used the ﬁrst equation in (69) and
the assumption that Hk, i, nt, 1, I and Hk, j, nt, 1, Q are
independent for all i, j.
2)
Let us now compute the SNR per bit for each frame
in [40]. Using the notation given in [40], we have
SNRk, bit, 2 ∝ 1
Ld
Ld−1
X
i=0
 ˜Hk, i

2
(75)
where the subscript 2 in SNRk, bit, 2 denotes case (2).
Again, the variance of the estimate of the variance in
the right hand side of (75) is
σ2
2 = E


 
1
Ld
Ld−1
X
i=0
 ˜Hk, i

2
− 2Lhσ2
f
!2
 .
(76)
Observe that
˜Hk, i in (76) is obtained by taking
the Ld-point FFT of an Lh-tap channel, and the
autocorrelation of ˜Hk, i is given by (37) in [40]. Using
Parseval’s theorem we have
1
Ld
Ld−1
X
i=0
 ˜Hk, i

2
=
Lh−1
X
n=0
˜hk, n

2
(77)
where ˜hk, n denotes a sample of zero-mean Gaussian
random variable with variance per dimension equal
to σ2
f. Note that ˜hk, n is independent over n (see also
(1) in [40]). Substituting (77) and the ﬁrst equation
of (74) in (76) we get
σ2
2 = E


 Lh−1
X
n=0
˜hk, n

2
− σ2
H
!2
 .
(78)
It can be shown that
σ2
2 = 4Lhσ4
f
(79)
34
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

where we have used the following relations:
E
˜hk, n

2
=
2σ2
f
hk, n, I + j hk, n, Q
=
˜hk, n
E

h2
k, n, I

=
σ2
f
E

h2
k, n, Q

=
σ2
f
E

h4
k, n, I

=
3σ4
f
E

h4
k, n, Q

=
3σ4
f
E

h2
k, n, Ih2
k, m, I

=
σ4
f
n ̸= m
E

h2
k, n, Qh2
k, m, Q

=
σ4
f
n ̸= m
E

h2
k, n, Ih2
k, m, Q

=
σ4
f
(80)
where we have assumed that hk, n, I and hk, m, Q are
independent for all n, m.
Substituting
Lh
=
10
Ld
=
4096
(81)
in (74) and (80) we obtain
σ2
1
=
0.1σ4
f
σ2
2
=
40σ4
f.
(82)
Thus we ﬁnd that the variation in the SNR per bit for each
frame is 400 times larger in case (2) than in case (1). Therefore,
in case (2) there are many frames whose SNR per bit is much
smaller than the average value given by (92), resulting in a
large number of bit errors. Conversely, the average SNR per
bit in case (2) needs to be much higher than in case (1) for
the same BER.
V.
CONCLUSIONS
Discrete-time algorithms for the coherent detection of turbo
coded MIMO OFDM system are presented. Simulations results
for a 2 × 2 turbo coded MIMO OFDM system indicate that a
BER of 10−5, is obtained at an SNR per bit of just 5.5 dB,
which is a 2.5 dB improvement over the performance given in
the literature. The minimum average SNR per bit for error-free
transmission over fading channels is derived and shown to be
equal to −1.6 dB, which is the same as that for the AWGN
channel.
Finally, an ideal near capacity signaling is proposed, where
each transmit antenna uses a different carrier frequency. Sim-
ulation results for the ideal coherent receiver show that it is
possible to achieve a BER of 2×10−5 at an average SNR per
bit equal to 2.5 dB, with two transmit and two receive antennas.
When the number of receive antennas for each transmit antenna
is increased to 128, the average SNR per bit required to attain
a BER of 2 × 10−5 is 1.25 dB. The spectral efﬁciency of the
proposed near capacity system is 1 bit/sec/Hz. Higher spectral
efﬁciency can be obtained by increasing the number of transmit
antennas with no loss in BER performance. A pulse shaping
technique is also proposed to reduce the bandwidth of the
transmitted signal.
Future work could address the issues of peak-to-average
power ratio (PAPR).
APPENDIX
A. The Minimum Average SNR per bit for Error-free Trans-
mission over Fading Channels
In this appendix, we derive the minimum average SNR per
bit for error-free transmission over MIMO fading channels.
Consider the signal
˜rn = ˜xn + ˜wn
for 0 ≤ n < N
(83)
where ˜xn is the transmitted signal (message) and ˜wn denotes
samples of zero-mean noise, not necessarily Gaussian. All
the terms in (83) are complex-valued or two-dimensional
and are transmitted over one complex dimension. Here the
term dimension refers to a communication link between the
transmitter and the receiver carrying only real-valued signals.
We also assume that ˜xn and ˜wn are ergodic random processes,
that is, the time average statistics is equal to the ensemble
average. The time-averaged signal power over two-dimensions
is given by, for large values of N:
1
N
N−1
X
n=0
|˜xn|2 = P ′
av.
(84)
The time-averaged noise power per dimension is
1
2N
N−1
X
n=0
| ˜wn|2 = σ′2
w =
1
2N
N−1
X
n=0
|˜rn − ˜xn|2 .
(85)
The received signal power over two-dimensions is
1
N
N−1
X
n=0
|˜rn|2
=
1
N
N−1
X
n=0
|˜xn + ˜wn|2
=
1
N
N−1
X
n=0
|˜xn|2 + | ˜wn|2
=
P ′
av + 2σ′2
w
=
E
h
|˜xn + ˜wn|2i
(86)
where we have assumed independence between ˜xn and ˜wn
and the fact that ˜wn has zero-mean. Note that in (86) it is
necessary that either ˜xn or ˜wn or both, have zero-mean.
Next, we observe that (85) is the expression for a 2N-
dimensional noise hypersphere with radius σ′
w
√
2N. Similarly,
(86) is the expression for a 2N-dimensional received signal
hypersphere with radius
q
N(P ′av + 2σ′2
w).
Now, the problem statement is: how many noise hyper-
spheres (messages) can ﬁt into the received signal hypersphere,
such that the noise hyperspheres do not overlap (reliable
decoding), for a given N, P ′
av and σ′2
w? The solution lies in the
volume of the two hyperspheres. Note that a 2N-dimensional
hypersphere of radius R has a volume proportional to R2N.
Therefore, the number of possible messages is
M =

N

P ′
av + 2σ′2
w
N

Therefore, the number of bits per transmission, deﬁned as the
channel capacity, is given by [49]
C
=
1
N log2(M)
=
log2

1 + P ′
av
2σ′2
w

bits per transmission (88)
over two dimensions or one complex dimension (here again the
term “dimension” implies a communication link between the
transmitter and receiver, carrying only real-valued signals. This
is not to be confused with the 2N-dimensional hypersphere
mentioned earlier or the M-dimensional orthogonal constella-
tions in [18]).
Proposition A.1: Clearly, the channel capacity is additive
over the number of dimensions. In other words, channel
capacity over D dimensions, is equal to the sum of the
capacities over each dimension, provided the information is
independent across dimensions [2]. Independence of informa-
tion also implies that, the bits transmitted over one dimension
is not the interleaved version of the bits transmitted over any
other dimension.
Proposition A.2: Conversely, if C bits per transmission are
sent over 2Nr dimensions, (Nr complex dimensions), it seems
reasonable to assume that each complex dimension receives
C/Nr bits per transmission [2].
The reasoning for Proposition A.2 is as follows. We assume
that a “bit” denotes “information”. Now, if each of the Nr
antennas (complex dimensions) receive the “same” C bits of
information, then we might as well have only one antenna,
since the other antennas are not yielding any additional infor-
mation. On the other hand, if each of the Nr antennas receive
“different” C bits of information, then we end up receiving
more information (CNr bits) than what we transmit (C bits),
which is not possible. Therefore, we assume that each complex
dimension receives C/Nr bits of “different” information.
Note that, when
˜xn
=
Nt
X
nt=1
˜Hk, n, nr, ntSk, 3, n, nt
˜wn
=
˜Wk, n, nr
(89)
as given in (46), the channel capacity remains the same as in
(88). We now deﬁne the average SNR per bit for MIMO sys-
tems having Nt transmit and Nr receive antennas. We assume
that κ information bits are transmitted simultaneously from
each transmit antenna. The amount of information received
by each receive antenna is κNt/Nr bits per transmission,
over two dimensions (due to Proposition A.2). Assuming
independent channel frequency response and symbols across
different transmit antennas, the average SNR of ˜Rk, i, nr in
(46) can be computed from (47) as:
SNRav =
2Lhσ2
fPavNt
2Ldσ2w
= P ′
av
2σ′2
w
(90)
for κNt/Nr bits, where
Pav = E
h
|Sk, 3, i, nt|2i
.
(91)
The average SNR per bit is
SNRav, b
=
2Lhσ2
fPavNt
2Ldσ2w
· Nr
κNt
=
Lhσ2
fPavNr
Ldσ2wκ
=
P ′
av
2σ′2
w
· Nr
κNt
.
(92)
Moreover, for each receive antenna we have
C = κNt/Nr
bits per transmission
(93)
over two dimensions. Substituting (92) and (93) in (88) we get
C
=
log2 (1 + C · SNRav, b)
⇒ SNRav, b
=
2C − 1
C
.
(94)
Clearly as C → 0, SNRav, b → ln(2), which is the minimum
SNR required for error-free transmission over MIMO fading
channels.
REFERENCES
[1]
K. Vasudevan, “Coherent turbo coded mimo ofdm,” in ICWMC 2016,
The 12th International Conference on Wireless and Mobile Communi-
cations, Nov. 2016, pp. 91–99, [Online].
[2]
——, “Coherent detection of turbo-coded ofdm signals transmitted
through
frequency
selective
rayleigh
fading
channels
with
receiver
diversity
and
increased
throughput,”
Wireless
Personal
Communications, vol. 82, no. 3, 2015, pp. 1623–1642. [Online].
Available: http://dx.doi.org/10.1007/s11277-015-2303-8
[3]
——, “Coherent detection of turbo-coded OFDM signals transmitted
through frequency selective rayleigh fading channels with receiver
diversity and increased throughput,” CoRR, vol. abs/1511.00776, 2015.
[Online]. Available: http://arxiv.org/abs/1511.00776
[4]
J. G. Andrews et al., “What will 5g be?” IEEE Journal on Selected
Areas in Communications, vol. 32, no. 6, June 2014, pp. 1065–1082.
[5]
O. Galinina, A. Pyattaev, S. Andreev, M. Dohler, and Y. Koucheryavy,
“5g multi-rat lte-wiﬁ ultra-dense small cells: Performance dynamics,
architecture, and trends,” IEEE Journal on Selected Areas in Commu-
nications, vol. 33, no. 6, June 2015, pp. 1224–1240.
[6]
C. L. I et al., “New paradigm of 5g wireless internet,” IEEE Journal
on Selected Areas in Communications, vol. 34, no. 3, Mar. 2016, pp.
474–482.
[7]
M. Agiwal, A. Roy, and N. Saxena, “Next generation 5g wireless
networks: A comprehensive survey,” IEEE Communications Surveys
Tutorials, vol. 18, no. 3, thirdquarter 2016, pp. 1617–1655.
[8]
F. Rusek et al., “Scaling up mimo: Opportunities and challenges with
very large arrays,” IEEE Signal Processing Magazine, vol. 30, no. 1,
Jan. 2013, pp. 40–60.
[9]
J. Hoydis, S. ten Brink, and M. Debbah, “Massive mimo in the ul/dl
of cellular networks: How many antennas do we need?” IEEE Journal
on Selected Areas in Communications, vol. 31, no. 2, Feb. 2013, pp.
160–171.
[10]
E. Bjrnson, E. G. Larsson, and M. Debbah, “Massive mimo for maximal
spectral efﬁciency: How many users and pilots should be allocated?”
IEEE Transactions on Wireless Communications, vol. 15, no. 2, Feb.
2016, pp. 1293–1308.
[11]
K. L. Wong, C. Y. Tsai, J. Y. Lu, D. M. Chian, and W. Y. Li, “Compact
eight mimo antennas for 5g smartphones and their mimo capacity
veriﬁcation,” in 2016 URSI Asia-Paciﬁc Radio Science Conference
(URSI AP-RASC), Aug. 2016, pp. 1054–1056.
[12]
Z. Pi and F. Khan, “An introduction to millimeter-wave mobile broad-
band systems,” IEEE Communications Magazine, vol. 49, no. 6, June
2011, pp. 101–107.
36
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

[13]
T. S. Rappaport et al., “Broadband millimeter-wave propagation mea-
surements and models using adaptive-beam antennas for outdoor urban
cellular communications,” IEEE Transactions on Antennas and Propa-
gation, vol. 61, no. 4, Apr. 2013, pp. 1850–1859.
[14]
——, “Millimeter wave mobile communications for 5g cellular: It will
work!” IEEE Access, vol. 1, 2013, pp. 335–349.
[15]
T. S. Rappaport, W. Roh, and K. Cheun, “Mobile’s millimeter-wave
makeover,” IEEE Spectrum, vol. 51, no. 9, Sept. 2014, pp. 34–58.
[16]
S. Niknam, A. A. Nasir, H. Mehrpouyan, and B. Natarajan, “A multi-
band ofdma heterogeneous network for millimeter wave 5g wireless
applications,” IEEE Access, vol. 4, 2016, pp. 5640–5648.
[17]
K. Vasudevan, Digital Communications and Signal Processing, Second
edition (CDROM included).
Universities Press (India), Hyderabad,
www.universitiespress.com, 2010.
[18]
——, “Digital Communications and Signal Processing, Third edition,”
2016, URL: http://home.iitk.ac.in/∼vasu/book0.pdf [accessed: 2017-02-
01].
[19]
N. Khalid and O. B. Akan, “Wideband thz communication channel mea-
surements for 5g indoor wireless networks,” in 2016 IEEE International
Conference on Communications (ICC), May 2016, pp. 1–6.
[20]
N. R. Zulkeﬂy et al., “Channel characterization for indoor environment
at 17 ghz for 5g communications,” in 2015 IEEE 12th Malaysia
International Conference on Communications (MICC), Nov. 2015, pp.
241–245.
[21]
Q. Guo, G. Gui, and F. Li, “Block-partition sparse channel estimation
for spatially correlated massive mimo systems,” in 2016 8th Inter-
national Conference on Wireless Communications Signal Processing
(WCSP), Oct. 2016, pp. 1–4.
[22]
M. Kuerbis, N. M. Balasubramanya, L. Lampe, and A. Lampe, “On the
use of channel models and channel estimation techniques for massive
mimo systems,” in 2016 24th European Signal Processing Conference
(EUSIPCO), Aug. 2016, pp. 823–827.
[23]
V. Sridhar, T. Gabillard, and A. Manikas, “Spatiotemporal-mimo chan-
nel estimator and beamformer for 5g,” IEEE Transactions on Wireless
Communications, vol. 15, no. 12, Dec. 2016, pp. 8025–8038.
[24]
H. Xie, F. Gao, and S. Jin, “An overview of low-rank channel estimation
for massive mimo systems,” IEEE Access, vol. 4, 2016, pp. 7313–7321.
[25]
Q. Wang, Z. Zhou, J. Fang, and Z. Chen, “Compressive channel
estimation for millimeter wave multiuser mimo systems via pilot reuse,”
in 2016 8th International Conference on Wireless Communications
Signal Processing (WCSP), Oct. 2016, pp. 1–6.
[26]
B. Farhang-Boroujeny, “Ofdm versus ﬁlter bank multicarrier,” IEEE
Signal Processing Magazine, vol. 28, no. 3, May 2011, pp. 92–112.
[27]
Y. Chen, F. Schaich, and T. Wild, “Multiple access and waveforms
for 5g: Idma and universal ﬁltered multi-carrier,” in 2014 IEEE 79th
Vehicular Technology Conference (VTC Spring), May 2014, pp. 1–5.
[28]
B. Farhang-Boroujeny and H. Moradi, “Ofdm inspired waveforms
for 5g,” IEEE Communications Surveys Tutorials, vol. 18, no. 4,
Fourthquarter 2016, pp. 2474–2492.
[29]
E. Basar, “Index modulation techniques for 5g wireless networks,” IEEE
Communications Magazine, vol. 54, no. 7, July 2016, pp. 168–175.
[30]
S. Venkatesan and R. A. Valenzuela, “Ofdm for 5g: Cyclic preﬁx
versus zero postﬁx, and ﬁltering versus windowing,” in 2016 IEEE
International Conference on Communications (ICC), May 2016, pp.
1–5.
[31]
P. Weitkemper et al., “Hardware experiments on multi-carrier wave-
forms for 5g,” in 2016 IEEE Wireless Communications and Networking
Conference, April 2016, pp. 1–6.
[32]
Z. Hraiech, F. Abdelkeﬁ, and M. Siala, “Pops-ofdm with different
tx/rx pulse shape durations for 5g systems,” in 2015 5th International
Conference on Communications and Networking (COMNET), Nov.
2015, pp. 1–6.
[33]
X. Zhang, L. Chen, J. Qiu, and J. Abdoli, “On the waveform for 5g,”
IEEE Communications Magazine, vol. 54, no. 11, Nov. 2016, pp. 74–
80.
[34]
A. A. Zaidi et al., “Waveform and numerology to support 5g services
and requirements,” IEEE Communications Magazine, vol. 54, no. 11,
Nov. 2016, pp. 90–98.
[35]
G. Berardinelli, K. I. Pedersen, T. B. Sorensen, and P. Mogensen,
“Generalized dft-spread-ofdm as 5g waveform,” IEEE Communications
Magazine, vol. 54, no. 11, Nov. 2016, pp. 99–105.
[36]
C. An, B. Kim, and H. G. Ryu, “Design of w-ofdm and nonlinear
performance comparison for 5g waveform,” in 2016 International Con-
ference on Information and Communication Technology Convergence
(ICTC), Oct. 2016, pp. 1006–1009.
[37]
Y. Qi and M. Al-Imari, “An enabling waveform for 5g – qam-fbmc:
Initial analysis,” in 2016 IEEE Conference on Standards for Commu-
nications and Networking (CSCN), Oct. 2016, pp. 1–6.
[38]
R. Garzn-Bohrquez, C. A. Nour, and C. Douillard, “Improving turbo
codes for 5g with parity puncture-constrained interleavers,” in 2016
9th International Symposium on Turbo Codes and Iterative Information
Processing (ISTC), Sept. 2016, pp. 151–155.
[39]
L. Guo, Z. Ning, Q. Song, Y. Cui, and Z. Chen, “Toward efﬁcient 5g
transmission: Ser performance analysis for asynchronous physical-layer
network coding,” IEEE Access, vol. 4, 2016, pp. 5083–5097.
[40]
K. Vasudevan, “Coherent detection of turbo coded ofdm signals trans-
mitted through frequency selective rayleigh fading channels,” in Signal
Processing, Computing and Control (ISPCC), 2013 IEEE International
Conference on, Sept. 2013, pp. 1–6.
[41]
A. Goldsmith, S. A. Jafar, N. Jindal, and S. Vishwanath, “Capacity
limits of mimo channels,” IEEE Journal on Selected Areas in Commu-
nications, vol. 21, no. 5, June 2003, pp. 684–702.
[42]
Y. Wang and D. W. Yue, “Capacity of mimo rayleigh fading channels in
the presence of interference and receive correlation,” IEEE Transactions
on Vehicular Technology, vol. 58, no. 8, Oct. 2009, pp. 4398–4405.
[43]
F. Benkhelifa, A. Tall, Z. Rezki, and M. S. Alouini, “On the low
snr capacity of mimo fading channels with imperfect channel state
information,” IEEE Transactions on Communications, vol. 62, no. 6,
June 2014, pp. 1921–1930.
[44]
K. Vasudevan, “Iterative Detection of Turbo Coded Offset QPSK in the
Presence of Frequency and Clock Offsets and AWGN,” Signal, Image
and Video Processing, Springer, vol. 6, no. 4, Nov. 2012, pp. 557–567.
[45]
——, “Design and development of a burst acquisition system for
geosynchronous satcom channels,” CoRR, vol. abs/1510.07106, 2015.
[Online]. Available: http://arxiv.org/abs/1510.07106
[46]
H. Minn, V. K. Bhargava, and K. B. Letaief, “A Robust Timing
and Frequency Synchronization for OFDM Systems,” IEEE Trans. on
Wireless Commun., vol. 2, no. 4, July 2003, pp. 822–839.
[47]
S. Haykin, Adaptive Filter Theory, 3rd ed.
Prentice Hall, 1996.
[48]
J. G. Proakis and D. G. Manolakis, Digital Signal Processing: Prin-
ciples, Algorithms and Applications, 2nd ed.
Maxwell MacMillan,
1992.
[49]
J. G. Proakis and M. Salehi, Fundamentals of Communication Systems.
Pearson Education Inc., 2005.
37
International Journal on Advances in Telecommunications, vol 10 no 1 & 2, year 2017, http://www.iariajournals.org/telecommunications/
2017, © Copyright by authors, Published under agreement with IARIA - www.iaria.org

