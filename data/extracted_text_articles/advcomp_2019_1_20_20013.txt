A Localized Hybrid Penalization Method for Simultaneous  
Data Reconstruction and Biase Field Correction 
Linghai Kong 
Institute of Applied Physics and Computational Mathematics 
Beijing, PR China 
email: kong_linghai@iapcm.ac.cn  
Abstract—A 
new 
variational 
model 
is 
dedicated 
to 
simultaneous image reconstruction and bias field rectification, 
where the image is corrupted by mixed Laplace-Gaussian noise. 
To solve the model numerically, an adaptive augmented 
Lagrangian mehod is combined with the expectation maximi- 
zation strategy. Some numerical results are also presented to 
validate the proposed model and algorithm. 
Keywords- Localized Regularization Method; Mixed Laplace-
Gaussian Noise; ALM; EM; Data Reconstruction; Bias 
correction 
I.
INTRODUCTION
This paper addresses the problem of rectifying bias field 
in images corrupted by mixed noise. Bias field, also known 
as intensity inhomogeneity, is the spurious smooth intensity 
variation across the whole image. It is present in many 
different imaging modalities, such as microscopy, ultrasound 
and Magnetic Resonance Imaging (MRI), and high-energy 
radiography (HER) as well (e.g., [1]).  In HER, the bias field 
can be resulted in the intensity distribution of the radiation 
source, the artifact of the image intensifier and the vignetting 
effect of the optical lens in the charge-coupled-device (CCD) 
based imager. Many image analysis processes, including 
image segmentation and Abel inverse transformation, are 
highly sensitive to the issue. 
In HER, the problem of image denoising has to be 
considered carefully. In CCD-recorded data, background hot 
noise is inherent in the current carriers, while pulse spike 
noise is also encountered due to not only the interaction 
between transmitted particles and CCD chips, but the 
tremendous flaw in the transistors as well. In other words, its 
statistical property is a combination of two different 
distributions.  In this paper, we focus on a special case of 
noise distribution, that is, Laplace and Gaussian mixture 
(LGM). Our problem is then to reconstruct an original image 
from an observation with simultaneous LGM noise removal 
and bias field correction. 
       As it is known, finite mixture models are among the 
most familiar approaches for image segmentation and 
intensity inhomogeneity elimination (i.e., [2]). They 
combine the maximum likelihood (ML) or maximum a 
posterior (MAP) probability criterion with the expectation 
maximization (EM) algorithm to construct subjective energy 
functionals. Mixture noise models have also been drawn 
much research interest in the community of image 
processing, including Poisson-Gaussian noise and impulse-
Gaussian noise (e.g., [3[-[6]). Liu et al. [7] proposed a finite 
Laplacian mixture model to approximate the impulse noise. 
The authors combined the first order total variation (FOTV) 
regularization with the EM method to gain an adaptive 
restoration method. In [8], Gong, Shen and Toh present a 
first order regularization model to recover images 
contaminated by mixed or even unknown noises. More 
recently, Calatroni et al. [9] proposed a variational model 
encoding the mixed Poisson-Gaussian noise as an infimal 
convolution of discrepancy terms of noise distributions. 
      During the last two decades, numerous approaches have 
been suggested to correct the bias field, which are mainly 
divided into two categories. The first one is parameter 
algorithms, and the second one is non-parametric methods, 
which do not require any prior knowledge on the intensity 
probability distribution and the bias field is integrated into a 
faith energy based on ML or MAP estimation.  
        In this paper, we propose a variational method by 
integrating the LGM model with the EM algorithm to 
investigate the inverse problem in the presence of bias field 
and mixed noise. The data term in our energy is derived 
from a localized LGM assumption, and the bias field is 
regarded as a parameter of the LGM model. Compared with 
earlier methods based on mixture assumptions, our model 
contains a higher-order cost term [10], used to eliminate the 
staircasing fallback of the first-order total variation, and it 
does not require extra constraints on the bias field. 
Moreover, the regularization parameters in our model are 
updated adaptively according to the change of the functional 
cost. Numerical experiments on MRI images have shown its 
efficiency. 
        The remainder of the paper is organized as follows. 
Section 2 introduces the BiLGM-TVBH model based on the 
EM algorithm. Section 3 presents briefly the numerical 
algorithm of our proposed model and some experimental 
results. Concluding remarks are given in the last section. 
II.
LGM MODEL AND EM ALGORITHM 
Some notations adopted in this paper is listed as follows. 
Let  ℝ௡ be n-dimensional real Euclidean space, ℝ = ℝଵ. In 
the following, we denote ݑ,݂: Ω ⊂ ℝଶ ⟶ ℝ  to be an 
original gray scale image and an observed image describing 
the same scene, Ω  is open and bounded with Lipschitz 
boundary.  
8
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-737-5
ADVCOMP 2019 : The Thirteenth International Conference on Advanced Engineering Computing and Applications in Sciences

Assuming no blurring effect on the observed image, the 
reconstruction problem assumes the following form 
find u s.t.  ݂(ݔ)=ܾ(ݔ)൫ܪݑ(ݔ)+݊(ݔ)൯,                          (1) 
where ܾ, ݊: Ω ⟶ ℝ  represent the bias field and the additive 
noise, respectively. ܪ is a forward map, such as Abel’s 
transform [11][12] given by 
ܪݑ(ݔ)≅ܪݑ(ݏ,ݐ)=∫
௥௨(௥,௧)
ඥ௥మି⌊௦⌋మ
ାஶ
|௦|
݀ݎ.                             (2) 
݊(ݔ) is a realization of independent and identically 
distributed random variable  with PDF 
݌ఎ(ݖ, Θ଴) = ∑ߛ௞
ଶ
௞ୀଵ
݌௞(ݖ;ߪ௞
ଶ),                      (3) 
݌ଵ(ݖ;ߪଵ
ଶ) =
ଵ
ଶఙభమ ݁ି⌊௭⌋ ఙభమ
⁄
,
݌ଶ(ݖ;ߪଶ
ଶ) =
1
ඥ2ߨߪଶ
ଶ ݁ି⌊௭⌋మ ఙమమ
ൗ
,
Θ଴ denotes the parameter set {ߪ௞
ଶ,ߛ௞,݇=1,2}, ߛ௞ is positive 
real number acting on mixture radio. 
         Following the idea in [13] and the references therein, 
the bias field function ܾ(ݔ) is assumed to be positive, 
smoothly varying function on the image domain Ωsuch that 
ܾ(s) ≈ ܾ(ݔ) for all ݏ∈ܱ௫  which is definitely small 
neighborhood with center at x. We regard the intensity of the 
observation is a realization of a random variable ߦ for all 
ݔ∈ Ω. Then, by routine computation, there holds      
݌క(ݖ; Θ) =
ఊభ
ଶ௕ఙభమ ݁
ି|೥ష್ಹೠ|
್഑భమ
+
ఊమ
ටଶగ௕మఙమమ ݁
ି|೥ష್ಹೠ|మ
మ್మ഑మమ                 (4) 
 with Θ = Θ଴ ∪ ܾ. And then, our problem is reformulated to 
reconstruct u  from relation (1) with unknown parameter set 
Θ. 
      Based on the framework of Bayesian approach [14][15], 
the MAP estimation of u  can be given by 
ݑ∗= arg min௨{− log(݂|ݑ)− log ݌(ݑ)}                        (5) 
 that is, ݑ∗ minimizes an energy functional with two different 
components: the fidelity part, − log ݌(݂|ݑ) , can be further 
specified by MAP estimation and EM algorithm; the penalty 
part, − log ݌(ݑ), can be designated as the combination of the 
first and second order total variation [6],[10] for detail 
preserving and artifact elimination. 
        Making use of the expression (3) and the assumptions 
on the bias field function, all the intensities ݂(ݐ) within a 
neighborhood ܱ௦  share the same PDF ݌క(ݖ, Θ) . For 
simplification, we introduce some notations as follows.     
ݓଵ(ݏ)=
ఊభ
ଶ௕(௦)ఙభమ ,ݓଶ(ݏ)=
ఊమ
ටଶగ௕మ(௦)ఙమమ,
and 
݃ = ݃(ݔ,ݏ)= ቚ
௙(௫)
௕(௦) −ܪݑ(ݔ)ቚ.                                 (6) 
By the independency assumption, we have a local negative 
log-likelihood functional in the neighborhood  
ℇ௦(Θ,ݑ)=−∫
log ቆݓଵ݁
ି ೒
഑భమ +ݓଶ݁
ି ೒మ
మ഑మమቇ ݀ݔ.
ைೞ
                   (7) 
Then introduce a Gaussian weighting function to identify the 
contribution of different points in the neighborhood, the local 
energy becomes 
ℇ௦(Θ,ݑ(ݏ))=−∫ܩఙ(s − x)log ቆݓଵ݁
ି ೒
഑భమ +ݓଶ݁
ି ೒మ
మ഑మమቇ ݀ݔ.
ைೞ
                                                                                               (8)   
where ܩఙ(∙) is a symmetric Gaussian kernel with a standard  
deviation ߪ such that ܩఙ(ݐ)≈0 as ݐ∉ܱ௦. 
        Then, expanding the local integral domain to the whole 
domain Ω and considering the global information of the  
given data, we have the following energy functional  
ℇ(Θ,ݑ)=−∬ܩఙlog ቆݓଵ݁
ି ೒
഑భమ +ݓଶ݁
ି ೒మ
మ഑మమቇ ݀ݔ݀ݏ.
ஐ
         (9) 
       To perform estimation on Θ, we utilize the EM algori- 
thm. Introducing a vector-valued auxiliary variable ߮ =
(߮ଵ, ߮ଶ)  in  
Δ = {߮|0 < ߮௜ < 1, ∑
߮௜
ଶ
௜ୀଵ
= 1},                      (10) 
and a functional  
Φ(Θ,ݑ,߮)=∬ܩఙ ቌ
ఝభ
ఙభమ ݃ +
ఝమ
ଶఙమమ ݃ଶ − ߮ଵ log
ఊభ
ଶ௕ఙభమ −
߮ଶ log
ఊమ
ටଶగ௕మఙమమ + ∑
߮௜ log ߮௜
ଶ
௜ୀଵ
ቍ ݀ݔ݀ݏ
      Given Θ଴,ݑ଴, compute the minimizer of  Φ(Θ,ݑ,߮) via 
the following alternating minimization scheme 
ቊ
߮௩ାଵ = arg ݉݅݊ ఝ∈୼ Φ(Θ௩,ݑ௩, ߮)
(Θ௩ାଵ,ݑ௩ାଵ) = arg ݉݅݊ ஀,௨ Φ(Θ,ݑ,߮௩ାଵ)                    (11) 
where ݒ denotes the inner iteration number.  
        It can be verified that the sequence defined by (11) has  
the following properties.  ℇ(Θ,ݑ) decreases with respect to 
ݒ,  that is, 
ℇ(߆௩ାଵ,ݑ௩ାଵ) ≤ ℇ(߆௩,ݑ௩).
Moreover, ℇ(Θ,ݑ) and Φ(Θ,ݑ,߮) possess a same global 
minimizer of Θ.
       In our context, the original image is always piecewise 
smooth, we then define a weighted regularizer in the form of 
ܴ(∇ݑ,∇ଶݑ)=∫(ݓ(ݔ)|∇ݑ|
ஐ
+ ൫1 −ݓ(ݔ)൯|∇ଶݑ|)݀ݔ, (12) 
ݓ(ݔ) is a weighting function based on edge detection 
Combining (12) with Φ(Θ,ݑ, Ψ)  in (11), denoted by 
Ψ(Θ,ݑ,߮௩ାଵ), we obtain an alternating minimization model 
(BiLGM-TVBH) for image reconstruction and bias field 
correction, i.e., 
ቊ
߮௩ାଵ = arg ݉݅݊ ఝ∈୼ Ψ(Θ௩,ݑ௩, ߮)
(Θ௩ାଵ,ݑ௩ାଵ) = arg ݉݅݊ ஀,௨ Ψ(Θ,ݑ,߮௩ାଵ)                (13) 
III.
ALGORITHM AND NUMERICAL EXPERIMENTS  
The algorithm of our proposed alternating minimization 
model is based on the variable splitting technique and the 
alternating direction method of multipliers (e.g., [16][17]). 
The minimization problem for(Θ,ݑ) can be further separated 
into two stages, that is, parameters and bias field estimation 
and image reconstruction.  
By introducing auxiliary variables, the proposed uncon- 
strained minimization problem can be reformulated by a 
constrained sequence of convex optimization subproblems,  
which can be solved separately by the augmented Lagran- 
9
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-737-5
ADVCOMP 2019 : The Thirteenth International Conference on Advanced Engineering Computing and Applications in Sciences

gian method with some modification on its penalty 
parameters. Our main idea of the modification is to employ 
anisotropic diffusion by introducing some adaptive terms in 
the equation related with the reconstruction. And then, the 
corresponding minimization problem of the Lagrangian 
functional is further divided into several sub-problems, from 
which the parameters Θ and the reconstructed version of u 
can be solved iteratively. 
By routine computation, we get 
߮ଵ
௩ାଵ =
ംభೡ
మ൫഑భమ൯ೡ ୣ୶୮൭ି |ಷೡ|
൫഑భమ൯ೡ൱
ംభೡ
మ൫഑భమ൯ೡ ୣ୶୮൭ି |ಷೡ|
൫഑భమ൯ೡ൱ା
ംమೡ
ටమഏ൫഑మమ൯ೡ ୣ୶୮൭ି |಼ೡ|
మ൫഑మమ൯ೡ൱
,          (14)    
߮ଶ
௩ାଵ = 1 − ߮ଵ
௩ାଵ.                                                       (15) 
where  
ܨ௩ = ݂ නܩఙ
ܾ௩ ݀ݏ−ܪݑ௩
ஐ
,
ܭ௩ = ∫ܩఙ|
௙
௕ೡ −ܪݑ௩|ଶ݀ݏ.
ஐ
For simplicity, we only mention the solution of the 
subproblem for updating ܾ
ܾ௩ାଵ =
ି஺మೡశభାට൫஺మೡశభ൯
మାସ஻మೡశభ
ଶ
 ,                                      (16)   
where  
ܣଶ
௩ାଵ =
ଵ
ଶ ∫
∑
ఝ೔
ೡశభ
൫ఙభమ൯ೡܩఙ
௙మ
௕ೡ ݀ݔ,
ଶ
௜ୀଵ
ஐ
                                    (17) 
ܤଶ
௩ାଵ =
ଵ
ଶ ∫
∑
ఝ೔
ೡశభ
൫ఙభమ൯ೡܩఙ݂ଶ݀ݔ,
ଶ
௜ୀଵ
ஐ
                                     (18) 
Some numerical experiments are performed to validate 
our proposed model and its algorithm on both bias field 
correction and image enhancement. Figures 1-4 show the 
results for bias field correction and detail preserving. We 
find that our method can also preserve details and no ringing 
artifacts occur near the edges in the reconstructed MR 
images. 
IV.
CONCLUSION  AND FUTURE WORK
We presented a new higher-order variational model that 
is supposed to reconstruct images which are corrupted by 
mixed noises, and adjust the intensity inhomogeneity in the 
images simultaneously.  
The alternating minimization model is solved by an 
efficient ADMM-based algorithm, which reduces the 
solution to a sequence of convex optimization subproblems. 
Numerical experiments demonstrate the effectiveness of the 
proposed model, especially for images in MR. 
The main advantage of our proposed model is that it 
provides a framework for reconstructing images corrupted by 
mixed noise and degraded by bias field. This is of 
importance since in some real applications the physics of 
image acquisition yields noise distributions are the outcome 
of several noise sources and bias field correction is also 
indispensable for the image analysis. 
Future work will perform experimental comparison with 
the variational models on the same objective. Furthermore, 
the possibility to extend the proposed model to deal with 
Poisson noise and to color images will be considered. 
REFERENCES
[1]
N. Pichoff, “The new bound of flash radiography,”. CLEFS 
CEA, vol. 54, pp. 58-66, 2006. 
[2]
U. Vovk, F. Pernuv, and B. Likar, “A review of methods for 
correction of intensity inhomogeneity in MRI,”. IEEE Trans. 
Med. Imaging, vol. 26(3), pp. 405-421, 2007. 
[3]
J. Liu, X.-C. Tai, H.-Y. Huang, and Z.-D.  Huan, “A weighted 
dictionary learning model for denoising images corrupted by 
mixed noise,” IEEE Trans Image Processing, 2013, vol. 22(3), 
pp. 1108-1120. 
[4]
J. Delon and A. Desolneux, “A patch-based approach for 
removing impulse or mixed  Gaussian-impulse noise,” SIAM 
J. Imaging Sciences, 2013, vol. 6(2),  pp. 1140-1174. 
[5]
M. Hintermüller and A. Langer,. “Subspace correction 
methods for a class fo nonsmooth and nonadditive convex 
variational problems with mixed L1/L2 data fidelity in image 
processing,”  SIAM J. Imaging Sci.,  vol. 6(4),  pp. 2134-
2173, 2013. 
[6]
K. Papafitsoros and C.-B. Shcönlieb, “A combined First and 
second order variational approach for image reconstruction,” J. 
Math. Imaging Vis., vol. 48, pp. 308-338, 2014 
[7]
J. Liu, H.-Y. Huang, Z.-D. Huan, and H.-L. Zhang, “Adaptive 
variational method for restoring  color images with high 
density impulse noise,” Inter Jour Comput Vis, vol. 90, pp. 
131-149, 2010. 
[8]
Z.Gong, Z. Shen, and K. C. Toh, “Image restoration with 
mixed or unknown,” Multiscale Model. Simul., 2014, 
vol.12(2), pp. 458-487. 
[9]
L. Calatroni, J. De Los Reyes, and C.-B. Shcönlieb, “Infimal 
convolution of data discrepancies for mixed noise removal,” 
SIAM J. Imaging Sciences, vol. 10(3), pp.1196-1223,2017. 
[10] G. Steidl, “Combined first and second order variational 
approaches for image processing,”. Jahresber Dtsch Math-Ver, 
vol. 117, pp. 133-160, 2015. 
[11] R. H. Chan, H. Liang, S. H.  Wei, M. Nikolova, and X.-C. 
Tai, “High-order total variation regularization approach for 
axially symmetric object tomography from a single 
radiograph,” Inverse Problems Imaging, vol. 9(1), pp. 55-77, 
2015. 
[12] R. Abraham,M. Bergounioux, and E. Trĕlat, “A penalization 
approach for tomographic reconstruction of binary axially 
symmetric objects,” Appl. Math. Optim., vol.58, pp. 345-371, 
2008.  
[13] J.Liu and H.-L. Zhang, “Image segmentation using a local 
GMM in a variational framework,” J. Math. Imaging Vis., 
vol.46, pp. 161-176, 2013. 
[14] J. Idier, Bayesian approach to inverse problems. Wiley, New 
York, 2008. 
[15] A. M. Stuart, “Inverse Problems: A Bayesian Perspectives,” 
Acta Numer., vol. 12,pp. 451-550,2010. 
[16] V. P. Gopi, P. Palanisamy P, K. A. Wahid, P. Babyn, and D. 
Cooper “Micro-CT image reconstruction based on alternating 
direction augmented Lagrangian method and total variation,” 
Comput. Medical Imaging Graph., 2013, vol. 37,  pp. 419-429 
[17] R. H. Chan, H. Liang, S. Wei, M. Nikolova, and X.C. Tai, 
“High-order total variation regularization approach for axially 
symmetric object tomography from a single radiograph,” 
Inverse Problems & Imaging, 2015, Vol.9(1),  pp. 55-77. 
10
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-737-5
ADVCOMP 2019 : The Thirteenth International Conference on Advanced Engineering Computing and Applications in Sciences

                             (a)                                              (b) 
Figure 1. Numerical experiment. (a):Original MRI image, (b): A reconstructed version of (a) obtained by our proposed model. 
(a)                                             (b) 
Figure 2.  Numerical experiment. (a):Original MRI image, (b): A reconstructed and enhanced version of (a) obtained by our proposed model. 
                                                                            (a)                                                            (b) 
Figure 3.  Numerical experiment. (a):Original MRI image, (b):A restored and corrected version of (a) obtained by our proposed model.  
                                                                         (a)                                                               (b) 
Figure 4. Numerical experiment. (a):Original MRI image, (b):An enhanced version of (a) obtained by our proposed model.   
11
Copyright (c) IARIA, 2019.     ISBN:  978-1-61208-737-5
ADVCOMP 2019 : The Thirteenth International Conference on Advanced Engineering Computing and Applications in Sciences

