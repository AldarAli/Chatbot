Scrambling–Exact Channel Estimation in 
W–CDMA Systems 
An Algorithm Beyond Correlation 
 
Wolfgang U. Aichmann 
Nokia Siemens Networks GmbH & Co. KG 
Lise–Meitner–Straße 7, D–89081 Ulm, Germany 
Email: wolfgang.aichmann@nsn.com 
 
 
Abstract— Multiple–input Multiple–output (MIMO) antenna 
systems require one pilot signal for each transmitting antenna. 
As scrambling is a quasi–orthogonal operation a small portion 
of the pilot energy is scattered into other pilot signals even with 
ideal conditions apart from that small non–orthogonality. In 
this paper the correlation approach of estimating the channel 
impulse response is extended analytically such as to take into 
account the full spreading sequence, improving thereby 
significantly the performance of high–speed downlink packet 
access (HSDPA) MIMO systems especially for very high data 
rates when dual stream transmission is used in combination 
with cancellation of the interference between the data streams. 
Keywords-W-CDMA; HSDPA; MIMO; channel estimation; 
scrambling 
I. 
 INTRODUCTION 
Channel estimation plays an important role in wideband 
code division multiple access (W–CDMA) networks, 
especially for very high data rates as they are achieved with 
MIMO [1]. It has therefore been topic of different 
investigations which go beyond the conventional correlation 
approach. In [2], a novel type of linear minimum mean 
square equalizer (LMMSE) was presented which is able to 
properly take into account all types of interference without 
being too complex for implementation in real systems, 
whereas [6,7] investigate smoothening the primary channel 
estimates by appropriate filtering and cancelling the inter–
antenna interference, respectively. 
In MIMO systems it is necessary to measure all physical 
channels from each transmitting to each receiving antenna. 
Therefore, each transmitting antenna has to be fed with a 
separate pilot sequence. For HSDPA systems [5], there are 
defined primary and secondary common pilot channels 
which are orthogonal either by using orthogonal patterns or 
by applying orthogonal spreading codes. In any case, the 
coded pilot sequences are scrambled. 
As scrambling is a quasi–orthogonal but not an exact 
orthogonal operation the channel information derived by the 
receiver remains distorted even under conditions being ideal 
beyond these distortions, i.e., absence of receiver noise and 
additive white Gaussian noise (AWGN) channels. If only 
one pilot channel is present, the effect is usually negligible: 
Although a certain amount of energy is scattered by the 
spreading operation into other codes the general shape 
persists as the energy reduction is more or less proportional 
to the available energy. If there are however two or more 
pilot sequences the relative error strongly increases as the 
scattering of energy from other codes also happens at time 
(slot) positions where the respective pilot signal is weak or 
even vanishes. 
If MIMO is configured for more than one data stream, 
these data streams will interfere with each other with 
strength depending on the correlation of the different 
physical channels. But this interference can effectively be 
reduced by interference cancellation as all data streams have 
the same origin and therefore are subject of the same channel 
conditions. Furthermore, the receiver has to decode all data 
streams anyway so that the effort of cancellation is limited. 
As interference cancellations is re–applying the channel 
transformation to the already detected data, any error in the 
estimated channel information takes effect three times, 
namely at first equalization, at re–application of the channel 
operation in the course of the interference cancellation and at 
re–equalization of the equivalent single stream data. Any 
error in channel estimation therefore acts non–linearly on the 
overall performance of the system. 
The scrambling distortion is mainly significant for very 
high data rates where the respective UE is served with all 
available resources. This means that intra–cell interference 
(originating from other users) is small. Furthermore, these 
mentioned high data rates are achievable under quite good 
radio conditions only, i.e., also the inter–cell interference 
must be small. Therefore, a correlation–based estimator 
might be sufficient in that range of interest but the impact of 
scrambling induced distortion should be removed. 
As the receiver knows the scrambled pilot symbol 
patterns as they are fed to the transmitting antennas it is 
possible to calculate the distortion induced by scrambling 
analytically as a function of the channel impulse response. 
Inverting this function allows to extend the correlation 
algorithm such as to take into account the distortion, leading 
to an estimated channel impulse response being exact with 
respect to scrambling effects. Although a matrix operation is 
12
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

required to solve the resulting equation system the 
corresponding matrix elements depend only on the 
scrambling vector and can hence be calculated once at the 
initial phase. As long as the scrambling code is not changed 
these elements remain stable. 
The remainder of this paper is organized as follows: In 
Section II we introduce the signal model with the basic 
equations. They are required to describe the data transfer 
through the channel and will be used in Section III for 
formulating the analytical solution for scrambling–exact 
channel estimation. Section IV then demonstrates the gain of 
the proposed algorithm with some results from link level 
simulation. Finally, we draw our conclusion in Section V. 
II. 
BASIC CHANNEL PILOT EQUATIONS 
In the following, we assume that two transmitting 
antennas are present, each fed with a separate pilot sequence, 
namely 
 
s1 n
 and 
 
s2 n
 with n counting the oversampled 
time steps. The signal  l
r
 at oversampled chip position l  is 
for a single antenna then given by (see e.g., [4], Section 1.3): 
 
 
 
















 
 




 





 

M
N
k
N
k
l
h k s
N
k
l
h k s
N
k
c l
l
r
OSF
0
OSF
2
2
OSF
1
1
OSF


With the conventional correlation approach of channel 
estimation, the received signal is de–spread ignoring the 
error made by this quasi–orthogonal operation (see, e.g., [1]): 


 
 
   
   
0
2
2
0
1
1
OSF
2
2
OSF
1
1
1
0
OSF
OSF
1
OSF
SF
0
OSF
SF
0
*
*
h d s l
d s l
h
N
d
k
l
h k s
N
d
k
l
k s
h
N
d
k
c l
N
l
c
d
r l
N
l
c
N
l
l
M
N
k
N
l
l



















 































 









In (2), we introduced a start index 
0l  for summation over 
chips in order to cope with handling of more than one 
symbol. For the first symbol, 
l0  0
, for the second one 
l  NSF
0
, and so on. If we now define 






 

















 





























SF
0
0
0
SF
OSF
0
0
0
1
OSF
,
1
OSF
OSF
OSF
,
,
*
0
*
,
N
l
l
l
j
l
N
N
l
l
j
j
l
j
l
d
r l
N
l
c
d
k
d
k
d
N
d
k
l
s
N
d
k
c l
N
l
c
k
d
k
d






eq. (2) can be written as 
TABLE 1: NAMING CONVENTIONS FOR IMPORTANT VARIABLES 
Received signal (single antenna) 
r l
 
Sent signal (index i for Tx antenna) 
si  l
 
Channel impulse response (index i for Tx 
antenna) 
hi  l
 
Scrambling code element at integer chip 
index n 
 
c n
 
Channel length 
M 1
 
Spreading sequence length 
NSF
 
Oversampling Factor 
NOSF 
Number of symbols required for CPICH 
orthogonality 
Northo
 
Number of symbols required for CPICH 
orthogonality, measured in chips 
ortho
 per slot
chips
N
N 
 
 
 


 











M
N
k
l
l
l
k
d
h k
k
d
h k
d
OSF
0
0
0
0
,2
2
1,
1





We then are able to split the summation into two parts, 
namely one counting the chips and the other stepping 
through the oversampling within each chip. With the 
definitions 
0
mod
mod
OSF
OSF
OSF
OSF
OSF
OSF











 






N
d
d
N
d
N
d
d
d
N
d
N
d
N
d






and assuming that l is an integer multiple of 
NOSF
 (generally 
spoken, oversampling can be accounted for in d ) we can 
write finally 



















k
N
d
d
k
N
h
k
N
d
d
k
N
h
j
k
N
d
d
j
k
N
h
j
k
N
d
d
j
k
N
h
d
d
l
M
k
l
l
M
k
N
j
l
l
OSF
,2
OSF
2
0
OSF
1,
OSF
1
OSF
,2
OSF
2
0
1
0
OSF
1,
OSF
1
0
0
0
OSF
0
0




















 





















In (6), we have separated integer and oversampled parts 
on the right hand side of (4) by splitting 
j
k
N
j
N
k
N
k


 






OSF
OSF
OSF


13
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

III. 
SCRAMBLING–EXACT CHANNEL ESTIMATION 
In [5], there are defined different configurations for the 
common pilot channel (CPICH) in W–CDMA systems. For 
the usage in combination with MIMO, two of them are 
relevant, namely either using only the primary CPICH spread 
with code cSF1 of length 256 and orthogonal bit sequences on 
the two transmitting antennas, or using the primary CPICH 
on the first and a secondary CPICH with code cSF2 on the 
second transmitting antenna. The secondary CPICH than 
must use the same bit sequence as the primary CPICH on 
antenna 1. The same scrambling code for both cases is used 
in any case. 
If two adjacent symbols are merged both options can 
formally be described by a virtual spreading with length of 
512 where the effective spreading codes can be defined in 
the first case as [cSF1 cSF1] and [cSF1 inv(cSF1)], and in the 
second case as [cSF1 cSF1] and [cSF2 cSF2]. As long as the 
channel estimation algorithm finally uses any filtering 
procedure over an even number of pilot symbols, both 
options are equivalent with respect to the influence of 
scrambling. We will restrict therefore the following 
investigations to the configuration with primary CPICH only 
and orthogonal bit sequences on the two transmitting 
antennas. 
A. Single Symbol Channel Estimation 
If we want to calculate 
M 1
 coefficients for both 
channels, we need 

1
2
 M 
 equations, i.e., 































































d
M
N
h
d
M
N
h
d
N
h
d
N
h
K
d
M
N
d
M
N
d
N
OSF
OSF
OSF
OSF
l
OSF
l
OSF
l
OSF
l










2
1
2
1
0
0
1
2
0
0
0
0
0





where the pilot scrambling matrix 
0l
K  is defined as 
 
 








 
 






























1
1
1
2
1
2
0
0
0
0
,2
1,
,2
1,
,2
1,
,2
1,
,2
1,
,2
1,
0
0
0
0
0
0
0
0
0
0
0
0
0
M
M
M
M
M
M
M
M
l
l
l
l
l
l
l
l
l
l
l
l
l























K


If the scrambling sequences would be completely 
orthogonal, the pilot scrambling matrix (9) would contain 
non–zero elements (
 
 j 0
) in the first M rows only, i.e., 
rows 
1
2
1


M
M

, wouldn‟t contribute at all to the 
solution and K wouldn‟t be invertible. The accuracy of these 
equations is therefore small even if the non–orthogonality of 
spreading is taken into account. To overcome this limitation 
one has therefore either to average over at least as many 
symbols as there are pilot sequences (see Section B), or the 
approach is extended such as to obtain equations of each 
pilot symbol (see Section C). This becomes obvious when 
looking to the pilot scrambling matrix for a single–tap 
channel including root raised cosine filtering as displayed in 
Fig. 1. 
The channel coefficients (at sampling positions) are 
finally given by 

 
 




 







































1
2
0
0
0
0
0
0
0
1
single,
2
1
2
1
M
M
M
h
M
h
h
h
l
l
l
l








The upper half of K shows large real entries on the main 
diagonal, whereas the other elements are dominated by the 
scrambling correlation coefficients. As expected, the 
calculation of the channel impulse response fails at least 
partly even if afterwards an averaging over all symbols of a 
frame is performed. This is shown in Fig. 2 for an AWGN 
channel with raised cosine filter. 
0
20
40
60
80
0
50
100
150
-1
-0.5
0
0.5
k
Pilot Scrambling Matrix K, 1. Symbol
d
 (K1)
 
0
20
40
60
80
0
50
100
150
-0.2
-0.1
0
0.1
0.2
k
Pilot Scrambling Matrix K, 1. Symbol
d
 (K1)
 
Figure 1.  Pilot scrambling matrix for a single tap channel including raised 
cosine filtering. 
14
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

0
10
20
30
40
50
60
70
80
-0.5
0
0.5
1
1.5
2
2.5
Hsingle Averaged Over 1 Frame
d [chips]
H
 
 
(H1)
(H1)
(H2)
(H2)
 
Figure 2.  Channel Impulse Response averaged over all symbols of a 
frame. 
B. Averaging Pilot Scrambling Matrix 
The inaccuracy of the channel impulse response 
calculated for a single symbol is caused by K  being badly 
conditioned. This can be improved by averaging both 
K  K frame
 and 
   frame
. Although the general shape 
of the pilot scrambling matrix is preserved by this operation 
the conditioning is now about 10 orders of magnitude better 
and 
K frame
 becomes invertible. For an AWGN channel with 
raised cosine filter it provides a perfectly estimated channel 
impulse response, see Fig. 3. 
C. Twin Symbol Channel Estimation 
The averaging procedure discussed in Section B assumes 
that K  and   are statistically independent and the 
averaging therefore factorizes and can be executed 
independently. Inversion is then executed with the averaged 
pilot scrambling matrix. The shown result implies that this 
assumption is correct at least for a single tap channel 
including root raised cosine filter. 
There is, however, an alternative approach which doesn‟t 
need the above restriction: Both pilot scrambling matrix and 
de–spread received signal vector are constructed using two 
symbols with different pilot sequences, 
 


 


 
 






 


 
 


 






 
 
 
 






























































M
h
M
h
h
h
M
M
M
M
M
M
M
M
M
M
l
l
l
l
l
l
l
l
l
l
l
l
l
l
l
l
l
l
l
l
2
1
2
1
1 ,2
1 1,
1 ,2
1,
1
,2
1
,2
0
1,
1
1,
0
,2
1
,2
0
1,
1
1,
0
0 ,2
0 1,
0 ,2
1,
0
1
1
0
0
0
0
0
0
0
0
0
0
0
0
0
0





































0
10
20
30
40
50
60
70
80
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
Channel Impulse Response from K and 
d [chips]
H
 
 
(Hideal)
(Hideal)
(H1)
(H1)
(H2)
(H2)
 
Figure 3.  Channel Impulse Response calculated with averaged K. 
where the pilot scrambling matrix 
Ktwin
now is defined as 
 
 






 


 
 


 






 
  























0
0
0
0
0
0
0
0
1,2
1 1,
1,2
1,
1
,2
1
,2
0
1,
1
1,
0
,2
1
,2
0
1,
1
1,
0
0 ,2
0 1,
0 ,2
1,
0
0 1,
twin,
l
l
l
l
l
l
l
l
l
l
l
l
l
l
l
l
l
M
M
M
M
M
M
M
M






























In the following, these symbols will be called twin 
symbols if the two symbols are adjacent. The channel 
coefficients are then given by 

 
 




 


 






































M
M
M
h
M
h
h
h
l
l
l
l
l
1
1
0
0
0 1,
0
0
0
0
1
twin,
2
1
2
1









Now, all rows and columns of the pilot scrambling 
matrix contain (at least) one main element as displayed in 
Fig. 4. 
The real part shows two bars, one completely in the 
lower half volume, the other in both half volumes. Whereas 
the former belongs to equal pilot symbols for both channels, 
the latter results from inverse symbols. 
The AWGN channel impulse response including raised 
cosine filter calculated from the twin pilot correlation matrix 
again matches perfectly with the ideal channel impulse 
response, not only when averaged over all symbols of a 
frame (see Fig. 5), but also for each twin symbol. This means 
that no averaging is required in the absence of noise. 
15
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

0
50
100
150
0
50
100
150
-1
-0.5
0
0.5
1
k
Pilot Scrambling Matrix Ktw in for one Twin Symbol
d
 (Ktwin)
 
0
50
100
150
0
50
100
150
-0.2
-0.1
0
0.1
0.2
k
Pilot Scrambling Matrix Ktw in for one Twin Symbol
d
 (Ktwin)
 
Figure 4.  Pilot scrambling matrix for one twin symbol. 
IV. 
LINK LEVEL SIMULATIONS 
In order to demonstrate the benefit of the scrambling–
exact channel estimation we executed link level simulations 
for a single UE moving with 3km/h and assuming a channel 
of type Pedestrian A. Two data streams were transmitted in 
MIMO mode and for both the modulation and coding 
scheme corresponding to entry 10 in the CQI mapping table 
K [6] was used. The transmitting antennas were assumed to 
be mounted crosswise diagonal (X), the receiving antennas 
crosswise perpendicular and horizontal (+) and crosstalk 
between the polarization directions was allowed. In Fig. 6, 
the block error rate (BLER) is displayed for each data stream 
as a function of SNR. The SNRs for a working point at 10% 
BLER are given in the legend for the first (solid line) and 
second (dashed line) data stream. 
As expected, there is an appreciable gain of performance 
notable by a shift of the working point of up to 2dB for the 
second data stream which mainly benefits from interference 
cancellation, but even the working point of the first data 
stream is improved by 0.5dB. 
0
10
20
30
40
50
60
70
80
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
Pilot Channel 1
d [chips]
Htwin
 
 
 Hideal
 Hideal
 Htw in
 Htw in
 Hcorr
 Hcorr
 
0
10
20
30
40
50
60
70
80
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
Pilot Channel 2
chips
Htwin
 
 
 Hideal
 Hideal
 Htw in
 Htw in
 Hcorr
 Hcorr
 
Figure 5.  Twin Channel Impulse Response averaged over all symbols, 
compared with conventional correlation result and ideal case. 
V. 
CONCLUSION 
The usual procedure for estimating the radio channels 
discards the non–orthogonality of the spreading sequence 
which causes an error of several percents in case of more 
than one pilot sequence is required as is valid for using 
spatial diversity and MIMO systems. It has to be emphasized 
that this error is present even in case of pilot channels being 
fully separated, e.g., by cross polarized wave fronts with 
each front bearing exactly one pilot and receiving antennas 
oriented along the polarization directions, as long as this fact 
is not known a priori on receiving side: The estimator has to 
assume that signals of both pilots are present at each 
receiving antenna and hence misinterprets fractions scattered 
from the „real‟ pilot by scrambling as contributions of the 
other pilot. Merely a single pilot being present combined 
with the knowledge about this fact on receiving side avoids 
this complication. 
16
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

5
10
15
20
25
30
35
-2.5
-2
-1.5
-1
-0.5
0
SIR [dB]
log10(block error rate)
 
 
twin, 1st stream, SIR10%BLER = 21.0
twin, 2nd stream, SIR10%BLER = 22.2
corr, 1st stream, SIR10%BLER = 21.5
corr, 2nd stream, SIR10%BLER = 24.1
 
Figure 6.  Link level simulation results with simple correlation (upper) and 
scrambling–exact (lower) channel estimation. 
Due to the importance of channel estimation for reaching 
high data rates, there are published many proposals for 
improving the basic correlation approach, e.g., by filtering 
the primary channel estimates [3], cancelling inter−antenna 
interference [4] or extending the RAKE correlation approach 
to a LMMSE one [2] and thus taking into account all kinds 
of interference. All of these suggestions can basically be 
extended by scrambling−exact dealing of pilot patterns as 
proposed in this paper even if we have investigated here only 
the 
simple 
RAKE 
correlation 
approach, 
including 
appropriate filtering as described in [3], in the simulator. 
Although the spreading induced error is negligible in 
many cases, high data rates in combination with MIMO and 
transmission of two data streams require a higher accuracy. 
This can be reached by taking into account the spreading 
sequence exactly in the channel estimation algorithm. As in 
the correlation case, two symbols (in case of two pilot 
signals) with different pilot code elements are required to 
resolve the channels from both transmitting antennas. 
Therefore, a twin symbol pilot scrambling matrix is 
introduced with its inverse providing the channel impulse 
response from the received data. 
The numerical effort of this approach is for sure higher 
than the conventional correlation method. This effort 
however can at least partly be shifted to an initialization 
phase because the pilot scrambling matrix only depends on 
the scrambling sequence, the pilot patterns and the maximum 
length of the channel but not on any quantities varying with 
time. Mainly the second (weaker) data stream benefits from 
this improved channel estimation if cancellation of inter–
stream interference is applied. In link level simulation it was 
shown that its working point as function of SNR can be 
improved by 2dB for 10% block error rate. 
VI. 
ACKNOWLEDGMENT 
The Author would like to thank Elke Hallmann and 
Klaus Knoche for many inspiring discussions during the 
course of this study. 
REFERENCES 
[1] S. McBeath, M. Ahmed, and K. Rohani, “Impact of imperfect 
estimators on W–CDMA receiver performance with MIMO antenna 
systems”, in Proc. IEEE 58th Vehicular Technology Conference 
(VTC 2003-Fall), vol. 2, Oct.2003, pp. 1152-1156. [Online]. 
Available: 
http://ieeexplore.ieee.org/ie15/9004/28569/01285202.pdf?tp=&arnum
ber=1285202. 
[2] Ch. Mehlführer, and M. Rupp, “Novel Tap–wise LMMSE Channel 
Estimation for MIMO W–CDMA” in Proc. 51st Annual IEEE 
Globecom Conference, 2008, New Orleans, LA, USA, Nov. 2008. 
[Online]. 
Available: 
http://publik.tuwien.ac.at/files/PubDat_169129.pdf 
[3] Bengt Lindoff, Christer Östberg, and Håkan Eriksson, “Channel 
estimation for the W–CDMA system, performance and robustness 
analysis from a terminal perspective” in Proc. IEEE 49th Vehicular 
Technology Conference (VTC 1999), vol. 2, July 1999, pp. 1565-
1569. 
[Online] 
Available: 
http://ieeexplore.ieee.org/iel5/6314/16887/00780649.pdf?tp=&arnum
ber=780649 
[4] I.R.S. Casella, E.S. Sousa, and P.J.E. Jeszensky, “Chip space–time 
block coding using iterative channel estimation with inter–antenna 
interference cancellation for W–CDMA systems using long 
scrambling codes”, in Proc. IEEE 15th International Symposium on 
Personal, Indoor and Mobile Rdio Communications, (PIMRC 2004), 
vol. 
4, 
pp. 
2313-2317. 
[Online] 
Available: 
http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=1368732&
isnumber=29952 
[5] 3GPP, “Technical specification group radio access network; physical 
channels and mapping of transport channels (FDD) (Tech. Spec. 
25.211 
V8.4.0)”, 
2009. 
[Online]. 
Available: 
http://www.3gpp.org/ftp/Specs/archive/25_series/25.211/ 
[6] John G. Proakis and Masoud Saleh, “Digital Communications”, 5th 
ed., McGraw-Hill, 2009. 
[7] 3GPP, “Technical specification group radio access network; physical 
layer procedures (FDD) (Tech. Spec. 25.214 V8.5.0)”, 2009. 
[Online]. 
Available: 
http://www.3gpp.org/ftp/Specs/archive/25_series/25.214/ 
 
17
ICWMC 2011 : The Seventh International Conference on Wireless and Mobile Communications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-140-3

