Topological Approach to Image Reconstruction
in Electrical Impedance Tomography
Tomasz Rymarczyk, Paweł Tchórzewski
Department of Research and Development
NET-ART
Lublin, Poland
tomasz@rymarczyk.com, pawel.tchorzewski@netrix.com.pl
Jan Sikora
Electrotechnical Institute
Warszawa, Poland
sik59@wp.pl
Abstract—In this paper, we investigate the application of the
topological derivative in combination with the level set method
for the topology optimization. The level set method and the
gradient
technique
are
based
on
shape
and
topology
optimization
approach
to
the
Electrical
Impedance
Tomography problems with piecewise constant conductivities.
The Finite Element Method and the Boundary Element
Method have been used to solve the forward problem. The cost
of our numerical algorithm is moderate since the shape is
captured on a fixed mesh. The proposed solution algorithm is
initialized by using topological sensitivity analysis. Shape
derivatives and topological derivatives have been incorporated
with the level set method to investigate shape optimization
problems. Then it relies on the notion of shape derivatives to
update the shape of the domains where conductivity takes
different values. The shape derivative measures the sensitivity
of boundary perturbations while the topological derivative
measures the sensitivity of creating a small object in the
interior domain. The coupled algorithm is a relatively new
procedure to overcome this problem.
Keywords-Image Reconstruction; Inverse Problem; Level Set
Method; Optimization Methods.
I.
INTRODUCTION
Numerical methods of the shape and the topology
optimization were based on the level set representation and
the shape differentiation [8][10]. Level set methods have
been applied very successfully in many areas of the scientific
modelling, for example in propagating fronts and interfaces
[6][7][12][13]. Therefore, they are used to study shape
optimization problems. Instead of using the physically driven
velocity, the level set method typically moves the surfaces by
the gradient flow of an so-called energy functional [1]. These
approaches based on shape sensitivity include the elastic
boundary design. There are two features that make these
methods suitable for the topology optimization. The structure
is represented by an implicit function such that its zero level
set defines the boundary of the object. This function is often
discretized on a regular grid that conveniently coincides with
the finite or boundary element mesh used for structural
analysis. The next valid feature is the simple update of the
implicit function using the Hamilton-Jacobi equation [8],
where the velocity function is determined by the shape
sensitivity of the structure. These properties enable natural
topology changes. The discussed technique can be applied to
the solution of inverse problems in the Electrical Impedance
Tomography [6][7][10][11][14].
In
this
work,
there
were
implemented
the
novel
algorithms to identify unknown conductivities. The purpose
of the presented method is obtaining the better image
reconstruction than gradient methods. We also want to
accelerate the iterative process by using different shapes of
the zero level set functions.
In the second section, we present some information about
Electrical Impedance Tomography. In the third section,
discussion of numerical methods is given, and in the fourth
section, numerical results are shown. The last section
contains conclusions.
II.
ELECTRICAL IMPEDANCE TOMOGRAPHY
The Electrical Impedance Tomography (EIT) is a non-
destructive
imaging
technique
which
has
various
applications. Its purpose is to reconstruct the conductivity of
hidden objects inside a medium with the help of boundary
field measurements. Efficient algorithms for solving forward
and inverse problems have to be developed in order to use
this approach for practical tasks. Moreover, it is necessity to
improve
performance
of
selected
numerical
methods.
Typical problem in EIT requires the identification of the
unknown internal area from near-boundary measurements of
the electrical potential. It is assumed that the value of the
conductivity is known in subregions whose boundaries are
unknown. The forward problem in EIT is described by
following partial differential equation:
0,
)
(


 
u

(1)
where 
denotes
conductivity.
Symbol
u
represents
electrical potential. Function u is taken under Dirichlet
condition [7] in boundary points adjacent to electrodes and
Neumann condition [7] on remaining part of the boundary.
The problem can be reduced to determination of the
minimum value of the functional:
dxdy.
2
1
]
[
2




u
I u

(2)
III.
NUMERICAL METHODS
Our optimization algorithm relays on several numerical
methods. This section is devoted to them.
42
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-354-4
ADVCOMP 2014 : The Eighth International Conference on Advanced Engineering Computing and Applications in Sciences

A.
Boundary Element Method
Boundary Element Method (BEM) is a well known
numerical technique used
to solve partial differential
equations [3]. In literature, there are a lot of extensions of
BEM. For example, a lot of effort has been put into
combining BEM and the Finite Element Method (FEM).
Another example is coupling BEM with infinite elements
[4][5]. It gives us the possibility to solve equations with
boundaries described by open curves. In the forward
problem, we start our considerations from the following
formula (proper for all boundary points) [3]:
.
*( , )
( )
*( , )
( )
2 ( )
1
1
1
j
i
N
j
j
i
N
j
i
r r d
q r u
r r d
u r q
r
u
j
j


 

 




 
 


(3)
The symbol u represents electrical potential, whereas q
defines its normal derivative. The Green’s function [4,14]
and its normal derivative are denoted by u* and q*,
respectively. In (3), we have N finite boundary elements.
Next, we have introduced infinite boundary elements and
the governing equation (4) has been derived. This integral
equation is given by:
.
( ), )
( ) *(
) *( ( ), )
(
( ), )
(
*
( ), )
( ) *(
) *( ( ), )
(
( ), )
*(
2 ( )
1
1
1
1
1
1
1
2
1
1
1
1
1
1
1
1
2
1
1
N
i
N
N
i
N
j
j
i
j
j
N
i
N
N
i
N
j
j
i
j
j
i
d
r
r
u
S
q
d
r
r
u
S
q
d
r
r
u
q
d
r
r
q
S
u
d
r
r
q
S
u
d
r
r
q
u
r
u

























































































(4)
Symbol

S denotes the sum of the interpolation functions
with exponential decay along infinite boundary elements.
One should notice that in our model there is only one open
boundary curve. However, generalizations of (4) can be
easy done. In mathematical model, we assume that in N – 2
nodes the normal derivatives q equal zero. Only in two
nodes we set the electrical potential.
B.
Level Set Method
The level set function ϕ has the following properties:
( ).
0 for (x,y)
)
,r(
( ),
0 for (x,y)
)
,r(
( ).
( )
0 for (x,y)
)
,r(
t
t
t
t
t
t
t




 








(5)
The motion is seen as the convection of values (levels) from
the function ϕ with the velocity field  . Such process is
described by the Hamilton-Jacobi equation:
 .0
 
 





t
(6)
Here,  is the desired velocity on the interface, and is
arbitrary elsewhere. Actually, only the normal component of
 is needed (










/


 n
n
), so (6) becomes:
 .0

 




n
t
(7)
We can update the level set function ϕ by solving discretized
version of the Hamilton-Jacobi equation:
.0
1






k
k
n
k
k
t




(8)
Transforming above equation, we get:
Δ .
1
t
v
k
k
n
k
k





 
(9)
The gradient of the level set function in the k-th time step
(
k
) has been calculated by the essentially non-
oscillatory (ENO) polynomial interpolation scheme. The
stability of received solution is achieved by Courant-
Friedreichs-Lewy condition (CFL condition):
.
|)
max(
)
,
min(

|
Δx Δy
Δt 
(10)
Inequality (10) is satisfied by choosing the CFL number α:
α,
)
,
min(
|)
max(

Δy
Δx
|
Δt

(11)
where 0 < α < 1. The optimum value equals 0.9.
The calculated velocity must be extended off the
interface to the whole domain. This process is called the
extension of velocity and is based on the solution of the
additional partial differential equation. The reference [1]
suggests:
,0
( )







n
n
S
t





(12)
where S(ϕ) is defined as following [1]:
.
2
2





S( ) 
(13)
In (13) |ε| << 1. Additionally, we need to extend the velocity
to neighborhood of the interface, by defining velocity along
normal direction (see Fig. 1).
a)
b)
Figure 1.
The velocity calculated for the first iteration step: a) - before
extension; b) - after extension.
a)
b)
Figure 2.
The level set function ϕ: a) - before reinitialization process;
b) - after reinitialization process.
43
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-354-4
ADVCOMP 2014 : The Eighth International Conference on Advanced Engineering Computing and Applications in Sciences

Reinitialization is necessary when flat or steep regions
complicate the determination of the zero contour. The level
set function ϕ is signed distance function if at given time for
every point (x,y):
  .1
(14)
Reinitialization is based on replacing ϕ by another function
that has the same zero level set, but satisfies condition (14)
(see Fig. 2). This process is described by following partial
differential equation [1]:
.0
)1
|
( ) (|



 




S
t
(15)
Differential equation (15) is solved until a steady state is
achieved. Similar to the velocity extension, a first order
upwind scheme for the spatial dimension and forward Euler
time discretization is used.
C.
Shape derivative
The topological methods are used in order to solve the
inverse problem in EIT. Very important concept for our
research is so-called shape derivative. The shape derivative
is often used in optimization problems [7].
Let λ be the adjoint function satisfying:
.
Δλ
 u  um

(16)
The material derivative (Lagrangian derivative)
( )
u x

is
given by:
,)r
u(
))r(
t
lim u ( r
)r(
u
t
t 0
t

 

 





(17)
where
Ωt
(x,y)

. The shape derivative is following:
u(r).
)r(
u )r(
u( )r
)r(
lim u
)r(
u'
0

 












t
t
t
(18)
The steepest descent direction  is given by [7]:
λ) .
( u
n

    
(19)
We need the shape derivative so that derive formula for
velocity (19). The normal velocity is evaluated by using
weighted least squares interpolation to get:
.
ε
k
k
k
k
n
u





 
(20)
In next step of our procedure the level set function ϕ is
updated:


,
ε
1
t
u
k
k
k
k
k
k




 
 





(21)
where
t
Δ is obtained from CFL condition (11).
D.
Optimization algorithm
For the minimization problem iterative coupling of the
level set method and the topological gradient method has
been proposed. Both methods are gradient-type algorithms,
and the coupled approach can be cast into the framework of
alternate directions descent algorithms.
The level set method relies on the shape derivative,
while the topological gradient method is based on the
topological derivative. The proposed algorithm is iterative
method, structured as follows:

From the level set function at initial time, find
necessary interface information.

Use FEM or BEM to solve the equation (1) and next
compute the difference of the obtained solution with
the observed data.

Solve the Poisson’s equation (adjoint equation) – (16).

Find velocity in the normal direction – (20).

Update the level set function – (21).

Reinitialize the level set function – (15).

Calculate value of the objective function.
IV.
NUMERICAL RESULTS
In the examples reported below, several numerical
models with different discretization elements are presented.
Additionally,
we
present
different
geometries
of
the
conductivity distributions. We assume that the electrical
conductivity
of
searched
objects
is
known.
The
representation of the boundary shape and its evolution during
an iterative reconstruction process is achieved by the level
set method and the gradient method coupled together. In
forward problem which is given by equation (1), we have
used FEM or BEM. Additionally, different zero level set
functions have been selected. Therefore, quality of the image
reconstruction can be evaluated in different cases.
a)
b)
c)
d)
Figure 3.
Images reconstruction: a), c) - the original objects and the zero
contour from the level set function; b), d) - the process of the image
reconstruction.
Fig. 3 shows the image reconstruction with two different
groups of objects. Fig. 3a) and Fig 3c) depict two objects.
The zero contour curve from the level set function is red, the
following iterations are blue. The images from Fig. 3 show
the original objects and reconstruction after indicated
number of iterations. In the example from Fig. 3c), the zero
44
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-354-4
ADVCOMP 2014 : The Eighth International Conference on Advanced Engineering Computing and Applications in Sciences

level at initial step is represented by circle. The process of
reconstruction is good, because the region borders are
located nearly the object edges. The object function in the
Fig. 3b) achieves minimum after 185 iterations, whereas the
same object in the Fig. 3d) achieves the minimum after 502
iterations.
a)
b)
Figure 4.
The image reconstruction: a) - 3 objects; b) - 4 objects.
Results of the iteration process as described above are
shown in Fig. 4. Unknown structures are marked by the
black line; simulated objects are marked by the pink line.
For indicated numbers of iterations, the unknown structures
have been found.
a)
b)
Figure 5.
The black line marks the outside border of the examined
structure with the internal unknown objects ( marked by the blue lines ).
The red line marks simulated objects of zero level contours: a) - first
iteration step; b) - the last iteration step ( 300th ).
The last example of the reconstruction technique is
given in Fig. 5. The image reconstructions were achieved by
coupling of the level set method, the gradient technique and
BEM. Our optimization algorithm works well.
V.
CONCLUSIONS
An algorithm based on topological and shape derivative
and the level set method have been proposed in this work. It
is iterative algorithm where repeatedly the shape boundary
evolves smoothly and new small objects are detected. An
efficient algorithm for solving the forward and inverse
problems would also improve a lot of the numerical
performances of the proposed methods. In the model
problem from EIT, it is required to identify unknown
conductivities from near-boundary measurements of the
potential. The level set function techniques have been shown
to be successful to identify the unknown boundary shapes.
The accuracy of the image reconstruction is better than
gradient methods. The number of iterations determine the
position and shape of zero level set functions. In this
algorithm, we can control the process of the image
reconstruction. Next advantage of this algorithm is obtaining
a good quality results for the poor mesh (16x16 and 32x32
resolution). Other methods have not such properties.
REFERENCES
[1]
S. Osher and R. Fedkiw, “Level Set Methods and Dynamic
Implicit Surfaces”, Springer, New York 2003.
[2]
J. A. Sethian, “Level Set Methods and Fast Marching
Methods”, Cambridge Univeristy Press, 1999.
[3]
P.
K. Kythe,
“An
introduction to Boundary Elements
Methods”, CRC Press, 1995.
[4]
G. Beer and J. O. Watson, “Infinite boundary elements”,
International Journal for Numerical Methods in Engineering,
vol. 28, 1989, pp. 1233-1247.
[5]
G. Beer, J. O. Watson, and G. Swoboda, “Three-dimensional
analysis
of
tunnels
using
infinite
boundary
elements”,
Computers and Geotechnics, vol. 3, 1987, pp. 37-58.
[6]
G. Allaire, F. De Gournay, F. Jouve, and A. M. Toader,
“Structural
optimization
using
topological
and
shape
sensitivity via a level set method”, Control and Cybernetics,
vol. 34, 2005, pp. 59-80.
[7]
K. Ito, K. Kunish, and Z. Li, “The Level-Set Function
Approach to an Inverse Interface Problem”, Inverse Problems,
vol. 17, no. 5, 2001, pp. 1225-1242.
[8]
S. Osher and J. A. Sethian, “Fronts Propagating with
Curvature Dependent Speed: Algorithms Based on Hamilton-
Jacobi Formulations”, Journal of Computational Physics, vol.
79, 1988, pp. 12-49.
[9]
S. Osher and R. Fedkiw, “Level Set Methods: An Overview
and Some Recent Results”, Journal of Computational Physics,
vol. 169, 2001, pp. 463-502.
[10] S. Osher and F. Santosa, “Level set methods for optimization
problems involving geometry and constraints. Frequencies of
a
two-density
inhomogeneous
drum”,
Journal
of
Computational Physics, vol. 171, 2001, pp. 272-288.
[11] T. Rymarczyk, S. F. Filipowicz, J. Sikora, and K. Polakowski,
“A piecewise-constant minimal partition problem in the
image reconstruction”, Electrical Review, vol. 12, 2009, pp.
141-143.
[12] J. Sokolowski and A. Zochowski, “On the topological
derivative in shape optimization”, SIAM Journal on Control
and Optimization, vol. 37, 1999, pp. 1251–1272.
[13] C. Tai, E. Chung, and T. Chan, “Electrical impedance
tomography using level set representation and total variational
regularization”, Journal of Computational Physics, vol. 205,
no. 1, 2005, pp. 357–372.
[14] T.
Rymarczyk,
J.
Sikora,
and
B.
Waleska,
“Coupled
Boundary Element Method and Level Set Function for
Solving Inverse Problem in EIT”, Proc. 7th World Congress
on Industrial Process Tomography, Sep. 2013, pp. 312-319.
45
Copyright (c) IARIA, 2014.     ISBN:  978-1-61208-354-4
ADVCOMP 2014 : The Eighth International Conference on Advanced Engineering Computing and Applications in Sciences

