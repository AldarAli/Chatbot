UAV Speed Estimation With Multi-bit Quantizer in Adaptive Power Control
Hyeon-Cheol Lee
Smart UAV Development Center
Korea Aerospace Research Institute
115 Gwahangno, Yuseong-gu, Daejeon, Rep. of Korea
Email: hlee@kari.re.kr
Abstract—The adaptive power control with multi-bit quan-
tizer of Code Division Multiple Access (CDMA) systems for
communications between multiple Unmanned Aerial Vehicles
(UAVs) with a link-budget based Signal-to-Interference Ratio
(SIR) estimate which has distance information is applied to
three inner loop power control algorithms. The speed estima-
tion performance of these algorithms with their consecutive
Transmit-Power-Control (TPC) ratios are compared to each
other, and it is concluded that the speed can be estimated
and shows full linearity with the TPC ratio information of
Consecutive TPC Ratio Step-size Closed Loop Power Control
(CS-CLPC) and Fixed Step-size Power Control (FSPC).
Keywords-speed estimation; adaptive power control; link-
budget; SIR; multi-bit quantizer
I. INTRODUCTION
The communication system of an Unmanned Aerial Ve-
hicle (UAV) with multiple UAVs requires a mobile wireless
network to share data between UAVs. One communication
network protocol that may be used is Code Division Multiple
Access (CDMA). CDMA differs from both Frequency Divi-
sion Multiple Access (FDMA) and Time Division Multiple
Access (TDMA) in that it uses the same frequency for
multiple users.
Since all users utilize a single frequency, the signal from
each UAV may interfere with other UAVs’ receivers [1]. This
is referred to as the near-far effect. To eliminate the near-
far effect in CDMA systems, the transmission signal power
from every UAV must be the same as the signal power at the
receiver. This technique of controlling the magnitude of the
transmission power according to the distance between the
UAV and the Base Station (BS) is ofﬁcially termed power
control. It equalizes the received power and eliminates the
near-far effect, though it is subject to such complications as
path loss, shadowing, multi-path fading, etc.
This power control technique is differentiated into open
loop power control and closed loop power control. The
closed loop power control is further divided into inner loop
power control and outer loop power control. The inner
loop power control is responsible for adjusting the power
transmitted to maintain the received Signal-to-Interference
Ratio (SIR) at the BS at a level equal to that at the
SIRtarget. The outer loop power control is responsible for
setting the SIRtarget based on the Bit Error Rate (BER) or
service requirement.
In general, an aircraft measures its air speed by pitot tube
and calculates its ground speed by Global Position Sys-
tem/Inertial Navigation System (GPS/INS). In these days,
there is an effort that optic ﬂow measurements from CCD
camera have been used to augment GPS/INS to provide more
precise velocity information [2]. In this paper, the speed is
calculated with SIR estimates. Conventional SIR estimates
[3] consider only the transmission power and the link-gain,
but this paper takes into account the link-budget, which
has more realistic parameters including distance information
than the link-gain. Using the SIR estimate that reﬂects
the link-budget, speed estimation [4] is introduced based
on a Consecutive Transmit-Power-Control Ratio (CTR) [5].
The proposed speed estimation method is applied to three
algorithms with one, two, and three-bit level quantizers, and
the results are compared.
This paper is organized as follows: The literature related
to this work is surveyed in Section II. The inner loop
power control is described in Section III. The concept of
the link-budget based SIR estimate is introduced in Section
IV, followed by description of simulation environments in
Section V. Section VI gives details of the speed estimation.
The simulation results are analyzed in Section VII. Finally,
conclusions are drawn in Section VIII.
II. RELATED WORK
Kim, Lee, and Kim introduced in [6] the Adaptive Step-
size Closed Loop Power Control (AS-CLPC) algorithm for a
narrowband CDMA system. This algorithm adapts its power
control step-size based on the optimal factors determined
with the mean fade duration which is inversely proportional
to the maximum Doppler frequency. Nourizadeh, Taaghol,
and Tafazolli [7] proposed the Blind Adaptive Closed Loop
Power Control (BA-CLPC) in which the power control step-
size is adjusted to cope with the user mobility. Taaghol [8]
introduced the Speed Adaptive Closed Loop Power Control
(SA-CLPC) algorithm in which the power control step-size
is selected based on the user speed estimation categorized
by speed ranges. Lee and Cho [9] proposed the Mobility
Based Adaptive Closed Loop Power Control (M-ACLPC)
algorithm in which the power control step-size is adjusted
depending on the combination of the cumulative information
of the three power control commands and speed estimation.
100
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

Patachaianand and Sandrasegaran [5] compared perfor-
mances of the AS-CLPC, BA-CLPC, SA-CLPC, and M-
ACLPC in terms of Power Control Error (PCE) under the
same simulation environment. In their comparisons, the AS-
CLPC showed the best performance when the target speed
was lower than 25km/h, while the SA-CLPC was the best
when the speed was greater than 25km/h.
Patachaianand and Sandrasegaran [5] presented the Con-
secutive TPC Ratio (CTR) Step-size Closed Loop Power
Control (CS-CLPC) algorithm whose power control step-
size is determined based on a parameter called CTR. They
measured the moving target speed by CTR, then, calculated
the PCE as the Root Mean Square (RMS) of the difference
between the received SIR and the SIRtarget. They also
suggested in [4] the mapping equation and mapping table
which can yield accurate speed estimation using CTR.
III. INNER LOOP POWER CONTROL
In CDMA, the process of inner loop power control occurs
as follows: In the reverse link direction (from the UAV to
the BS), the transmission power information goes to the
BS. At the BS, the SIRtarget and the received SIR are
calculated from the transmission power, the link-gain, and
the noise power. Based on these factors, the BS sends a
Transmit-Power-Control (TPC) command to each UAV at
rate of 1500Hz, or Sample Time (TS) (= 0.667ms) in the
forward link direction (from the BS to the UAV). This power
equalization increases the maximum communication number
between UAVs and consequently eliminates the near-far
effect. These procedures [3][5] are represented in (1) and
(3).
Pi(t + 1) = Pi(t) + δi(t) · TPCi(t)
(1)
where Pi(t) is the transmission power, δi(t) is the power
control step-size, and TPCi(t) is the TPC command for the
ith UAV at time t.
xi(t) = SIRtarget,i(t) − SIRi(t)
(2)
where SIRtarget,i(t) (=SIRtarget(t) here) is the target SIR
and SIRi(t) is the received SIR for the ith UAV at time t.
Non-uniform quantizer [10] used in voice coding is
introduced that (m+1)-bit TPC is adopted TPCi(t) =
{C0C1 · · · Cm} where C0 is the sign bit.
TPCi(t) = sign(xi(t))·
⌊ log((1+µ|xi(t)|)/RP )
(1+µ)
(2m − 1)⌋
(3)
where µ = 2(m+1)-1 and RP is dynamic range of power
adjustment.
Table I
TPC COEFFICIENTS
m
d
multilevel
RP
1
0.5
± 1,2
0.1
2
0.25
± 1,2,3,4
0.3
3
0.125
± 1,2,3,4,5,6,7,8
0.5
IV. LINK-BUDGET BASED SIR
The conventional SIR estimate of the ith UAV in CDMA
is described as follows :
SIRi(t) =
Pi(t)Gi(t)
P
j̸=i Pj(t)Gji(t) + PN
(4)
where Gi(t) is the link-gain between the ith UAV and the
connected BS, and Pi(t) is the transmission power from the
ith UAV. Gji(t) is the link-gain between the jth UAV and the
BS to which the ith UAV connects. Equation (4), however
does not have distance information, therefore, SIRi(t) can
not be measured by distance step.
This paper introduces the link-budget based SIR as
SIRi(t) =
PR,i(t)
P
j̸=i PR,ji(t) + PN
(5)
where PR,i is the received power from the ith UAV. PR,ji is
the received power from the jth UAV with the BS to which
the ith UAV connects. The received power is affected by
factors including the free space loss [11] which has distance
information and gaseous path loss [12] varied by humidity.
Speed estimation can be possible with distance per TS and
SIRi(t) is measured with PR,i by distance variation.
The power delivered to the receiver [11] is :
PR,i = GT,i · PT,i · GR,i/(LF (Di) · LG(Di))
(6)
where GT,i, PT,i, GR,i, LF (Di), and LG(Di) are the trans-
mission antenna gain, the transmission power, the receive
antenna gain of the ith UAV, the free space loss, and
the gaseous path loss, respectively (the component loss is
ignored here.). The speed is estimated from moving distance
of free space loss which has distance information. Di is the
distance between the ith UAV and the BS in kilometers.
LF (Di)(dB) = 92.44 + 20log10(F) + 20log10(Di).
(7)
F is the frequency in gigahertz and the speciﬁc attenuation
due to dry air and water vapor from sea level to an altitude
of 5km can be estimated by (8).
LG(Di) = (γ0 + γW ) · Di.
(8)
101
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

P.676-5 of [12] shows equations of γ0 (attenuation for
dry air) and γW (attenuation for water vapor). These attenu-
ations are dependent on σ, the water vapor density (g/m3)
speciﬁed in Table II from P.836-3 of [12]. The bigger the σ
is, the larger the attenuation is.
Table II
WATER VAPOR DENSITY AT DIFFERENT SEASONS AND REGIONS
Jan.
April
July
Oct.
Coast (edge of continent)
5
10
20
10
Inland (inside continent)
5
5
10
5
Ocean
20
20
20
20
The noise power [11] is :
PN = k · T · B
(9)
where k is the Boltzmann constant (1.38 × 10−23J/K), T is
the temperature in Kelvin, and B is the equivalent bandwidth
in hertz.
V. SIMULATION ENVIRONMENTS
This section presents a simulation of the speed estimation
using (5). The frequency, the temperature, the pressure,
the water vapor density, and the bandwidth are set to
2.0GHz, 288K, 1013hPa, 20 (Summer in Coast), and 5MHz,
respectively. In Figure 1, ﬁve UAVs are arranged and Dis are
set to 250m, 500m, 750m, 1000m, and 1250m. The antenna
gain of each UAV is set to 0dB, as is the antenna gain of
the BS. UAV1 to UAV5 complete their power control by
FSPC so that each transmission power shown in Table III is
different. Then, UAV1, which is 1250m away from the BS,
starts to move outward. It moves at ﬁve different speeds
and measures the CTR at each speed. SIRtarget is set to
the transmission power of UAV3 on this simulation. This
simulation applies one UAV movement and outward/inward
direction only.
Figure 1.
Simulation formation
VI. SPEED ESTIMATION
There are several algorithms addressing inner loop power
control, including CTR Step-size Closed Loop Power Con-
trol (CS-CLPC) [5], Adaptive Step-size Closed Loop Power
Table III
INITIAL CONDITION OF UAV1 TO UAV5
PT (dB)
GT (dB)
GR (dB)
Di (m)
UAV1
+8.048
0.0
0.0
1250
UAV2
+4.314
0.0
0.0
1000
UAV3
+0.000
0.0
0.0
750
UAV4
-5.229
0.0
0.0
500
UAV5
-13.979
0.0
0.0
250
Control (AS-CLPC) [6], Fixed Step-size Power Control
(FSPC), etc.
This section investigates changes in transmission power
for the above three algorithms with the link-budget based
SIR. UAV1 moves outward for 42000*0.667ms (the number
of the sample = 42000) at the six different speeds listed in
Table IV; 100km/h, 200km/h, 300km/h, 400km/h, 500km/h,
and 600km/h. As UAV1 moves away, the three inner loop
power control algorithms alter the transmission power to
compensate for the distance between BS and UAV1. A faster
mobile is likely to receive more consecutive TPC command
than a slower one. Therefore, average of CTR on certain
period can be used to reﬂect user speed. Equation (10) [5]
measures the CTR as follows:
Table IV
UAV1 MOVING DISTANCE FOR 28.0 SEC (=42000*0.667ms).
speed (km/h)
speed (m/s)
moving distance (m)
100
27.7778
777.78
200
55.5556
1555.56
300
83.3333
2333.33
400
111.1111
3111.11
500
138.8889
3888.89
600
166.6667
4666.67
CTR(t) =
t
X
n=t−m+1
d· | TPC(n) + TPC(n − 1) |
m
(10)
where d is a scale factor (see Table I), m = t if t < w, and
m = w if t ≥ w. w is the maximum size of the window
average.
A. CS-CLPC
Patachaianand and Sandrasegaran [5] introduced the CS-
CLPC algorithm, where the step-size is adjusted as shown
in (11).
δ(t) =
α
1 − β · min{CTR(t), CTRmax}
(11)
where α, β, and CTRmax are constants.
102
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

B. AS-CLPC
Kim, Lee, and Kim [6] suggested the AS-CLPC algo-
rithm. This algorithm adapts its step-size based on TPC
history. The step-size is given by (12).
δ(t) =
 δ(t) · K,
TPC(t) = TPC(t − 1)
δ(t)/L,
Otherwise
(12)
where K and L are positive real constants with ranges of
1 < K and 1 < L < 2.
C. FSPC
In this simulation, the algorithm uses a ﬁxed step-size.
VII. SIMULATION RESULTS
Six different speeds are measured with CTR, and the
relationships are shown in Figure 2 to Figure 7 according
to two window sizes and three quantizers. The CS-CLPC
and FSPC algorithms show a linear relationship between
speed and CTR, in addition they show more linearity and
can estimate higher speed as quantizing bits are increased.
Therefore, using the CS-CLPC or FSPC, the speed of the
vehicle can be measured by mapping the information from
CTR. The AS-CLPC algorithm, however, deviates from
linearity. In addition, the same results are obtained with
different window sizes.
Figure 2. CTR vs. UAV1 speed at 1-bit Quantizer, window size 3 (Summer,
Coast)
VIII. CONCLUSION AND FUTURE WORK
This paper introduced a speed estimation of three different
inner loop power control with consecutive TPC ratios which
use the link-budget based SIR in the CDMA communication
systems between UAVs. It was concluded that linear rela-
tionship exists between speed and Consecutive TPC Ratios,
and that UAV speed can be estimated using the Consecutive
TPC Ratios of the CS-CLPC and FSPC algorithms.
Figure 3.
CTR vs. UAV1 speed at 1-bit Quantizer, window size 12
(Summer, Coast)
Figure 4. CTR vs. UAV1 speed at 2-bit Quantizer, window size 3 (Summer,
Coast)
Future work might be applying this concept to urban fad-
ing environments, applying with GPS/INS for more precise
speed estimation, or ﬁnding the linearity on closed loop
power control with Kalman gain step-size.
ACKNOWLEDGMENT
This paper was performed for the Smart UAV Devel-
opment Program, one of the 21st Century Frontier R&D
Programs funded by the Ministry of Knowledge Economy
of Korea.
REFERENCES
[1] J. Perez-Romero, O. Sallent, R. Agusti, and M. A. Diaz-
Guerra, Radio Resource Management Strategies in UMTS.
New York: John Wiley & Sons, 2005.
103
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

Figure 5.
CTR vs. UAV1 speed at 2-bit Quantizer, window size 12
(Summer, Coast)
Figure 6. CTR vs. UAV1 speed at 3-bit Quantizer, window size 3 (Summer,
Coast)
[2] W. Ding, J. Wang, and A. Almagbile, ”Adaptive ﬁlter design
for UAV navigation with GPS/INS/Optic ﬂow Integration,”
2000 Int. Conf. Electrical and Control Engineering (ICECE),
Rome, Italy, Aug. 2010, pp. 4623-4626.
[3] R. Patachaianand and K. Sandrasegaran, ”Performance com-
parison of adaptive power control in UMTS,” Int. Conf. Wire-
less Broadband and Ultra Wideband Commun. (AusWireless
2007), Sydney, Australia, Aug. 2007, pp. 81-85.
[4] R. Patachaianand and K. Sandrasegaran, ”User speed estima-
tion techniques for UMTS,” Electronics Letters, vol. 43, no.
19, Sep., 2007, pp. 1036-1037.
[5] R. Patachaianand and K. Sandrasegaran, ”Consecutive trans-
mit power control ratio aided adaptive power control for
UMTS,” Electronics Letters, vol. 43, no. 5, March, 2007, pp.
55-56.
Figure 7.
CTR vs. UAV1 speed at 3-bit Quantizer, window size 12
(Summer, Coast)
[6] J. H. Kim, S. J. Lee, and Y. W. Kim, ”Performance of single-
bit adaptive step-size closed-loop power control scheme in
DS-CDMA system,” IEICE Trans. Commun., vol. E81-B, no.
7, July 1998, pp. 1548-1552.
[7] S. Nourizadeh, P. Taaghol, and R. Tafazolli, ”A novel closed-
loop power control for UMTS,” IEE 3G 2000 Mobile Com-
mun. Technologies (IEE 3G00), London, England, March
2000, pp. 56-59.
[8] P. Taaghol, ”Speed-adaptive power control for CDMA sys-
tems,” Bechtel Telecommunications Technical Journal, vol.
2, no. 1, Jan., 2004.
[9] H. Lee and D. H. Cho, ”A new user mobility based adaptive
power control in CDMA systems,” IEICE Trans. Commun.,
vol. E86-B, no. 5, May 2003, pp. 1702-1705.
[10] W. Li, V. K. Dubey, and C. L. Law, ”A new generic multistep
power control algorithm for the LEO satellite channel with
high dynamics,” IEEE Commun. Lett., vol. 5, no. 10, Oct.
2001, pp. 399-401.
[11] D. Roddy, Satellite Communications. New Jersey: Prentice
Hall, 1989.
[12] ITU-R Recommendations and Reports 2004. Sep. 2004.
104
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

