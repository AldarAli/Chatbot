Optimal FIR Filters for DTMF Applications
Pavel Zahradnik and Boris ˇSim´ak
Telecommunication Engineering Department
Czech Technical University in Prague
Prague, Czech Republic
{zahradni, simak}@fel.cvut.cz
Miroslav Vlˇcek
Applied Mathematics Department
Czech Technical University in Prague
Prague, Czech Republic
vlcek@fd.cvut.cz
Abstract—A fast and robust analytical procedure for the
design of high performance digital optimal band-pass ﬁnite
impulse response ﬁlters for dual-tone multi-frequency applica-
tions is introduced. The ﬁlters exhibit equiripple behavior of
the frequency response. The approximating function is based
on Zolotarev polynomials. The presented closed form solution
provides formulas for the ﬁlter degree and for the impulse
response coefﬁcients. Several examples are presented.
Keywords-FIR ﬁlter; narrow band ﬁlter; dual-tone multi-
frequency; iso-extremal approximation.
I. INTRODUCTION
There are two basic tasks in the processing of dual-tone
multi-frequency (DTMF) signals, namely the detection of
DTMF frequencies and the removal of the DTMF frequencies
in a broad band signal. The DTMF frequencies form two
groups with four frequencies each. The lower group consists
of frequencies 697, 770, 852 and 941 Hz while the higher
group comprises sinusoids of 1209, 1336, 1477 and 1633
Hz. For the processing of DTMF signals, the inﬁnite impulse
response (IIR) ﬁlters are usually applied because of their
lower number of coefﬁcients. The IIR ﬁlters are usually part
of the famous Goertzel procedure [1]. In the removal of
DTMF frequencies in a broad band signal, the IIR ﬁlters
produce substantial distortions of the output signal which
appear near its ﬂat region due to the group delay variation.
This behavior is especially apparent, if pulse like components
are present in the signal as demonstrated in [2]. In order
to minimize these distortions in the processing of DTMF
signals we propose the application of ﬁnite impulse response
(FIR) ﬁlters which inherit a constant group delay. In order
to maximize the discrimination of the DTMF sinusoids, the
selective bands of the FIR ﬁlters should be as narrow as
possible. In this paper we are focused upon the design of
narrow optimal equiripple (ER) band-pass (BP) FIR ﬁlters for
the DTMF decoding. They are optimal in terms of the shortest
possible ﬁlter length related to the frequency speciﬁcation.
Note that the proposed ﬁlter design is based on formulas, i.e.
no numerical procedures are involved. The presented closed
form solution includes the degree equation and formulas for
the robust evaluation of the impulse response coefﬁcients of
the ﬁlter.
II. TERMINOLOGY
We assume a general FIR ﬁlter of type I represented by
its impulse response h(k) with odd length of N = 2n + 1
coefﬁcients and with even symmetry (1). In our further con-
siderations we use the a-vector a(k), which is related to the
impulse response h(k)
a(0) = h(n) , a(k) = 2h(n + k) = 2h(n − k) , k = 1 ... n .
(1)
Further, we introduce an auxiliary real variable w
w = 1
2(z + z−1)|z=ejωT = cos(ωT ) = cos

2π f
fs

,
(2)
where fs is the sampling frequency. The transfer function of
the ﬁlter is
H(z) =
2n
X
k=0
h(k) z−k
= z−n
"
h(n) + 2
n
X
k=1
h(n ± k) 1
2

−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
5
10
15
20
Z12,6(w, 0.79023439)
w
w1
w2
w0
y0
Fig. 1.
Zolotarev polynomial Z12,6(w, 0.79023439).
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−60
−50
−40
−30
−20
−10
0
20 log |H(ejωT )|[dB]
ωT /π
as[dB]
∆ωT /π
ω0T
π
Fig. 2.
Amplitude frequency response 20 log |H(ejωT )| [dB] corresponding
to the Zolotarev polynomial from Fig. 1.
III. OPTIMAL BAND-PASS FIR FILTER
An optimal ER BP FIR ﬁlter (Fig. 2) is speciﬁed by the
pass band frequency ω0T (or f0 = ω0T fs/2π), width of
the pass band ∆ωT (or ∆f = ∆ωT fs/2π), attenuation in
the stop-bands as[dB] and by the sampling frequency fs. An
approximation of the frequency response of a ﬁlter is based on
the generating function. The generating function of an ER BP
FIR ﬁlter is the Zolotarev polynomial Zp,q(w, κ) which ap-
proximates a constant value in equiripple Chebyshev sense in
two disjoint intervals ⟨−1, w1⟩ and ⟨w2, 1⟩ as shown in Fig. 1.
The main lobe with the maximal value y0 = Zp,q(w0, κ) is
located inside the interval (w1, w2). The notation Zp,q(w, κ)
emphasizes the fact that the integer value p counts the number
of zeros right from the maximum w0 and the integer value q
corresponds to the number of zeros left from the maximum
w0. The real value 0 ≤ κ ≤ 1 is in fact the Jacobi elliptical
modulus. It affects the maximum value y0 and the width
w2 − w1 of the main lobe (Fig. 1). For increasing κ the
value y0 increases and the main lobe broadens. The Zolotarev
polynomial is usually expressed in terms of Jacobi elliptic
functions [6]-[8]
Zp,q(w, κ) = (−1)p
2
(6)
×




H(u − p
n K(κ))
H(u + p
n K(κ))


n
+


H(u + p
n K(κ))
H(u − p
n K(κ))


n
 .
The factor (−1)p/2 appears in (6) as the Zolotarev polynomial
alternates (p + 1)−times in the interval (w2, 1). The variable
u is expressed by the incomplete elliptical integral of the ﬁrst
kind F(x|κ), namely
u =F


sn
 p
n K(κ)|κ
v
u
u
t
1 + w
w + 2 sn2
 p
nK(κ)|κ

− 1
|κ


 .
(7)
The function H (u ± (p/n) K(κ)) is the Jacobi Eta function,
sn(u|κ), cn(u|κ), dn(u|κ) are Jacobi elliptic functions and
K(κ) is the quarter-period given by the complete elliptic inte-
gral of the ﬁrst kind. The degree of the Zolotarev polynomial is
n = p+q. A comprehensive treatise of Zolotarev polynomials
was published in [8]. It includes the analytical solution of the
coefﬁcients of Zolotarev polynomials, the algebraic evaluation
of the Jacobi Zeta function Z( p
nK(κ)| κ) and of the elliptic
integral of the third kind Π(σm, p
nK(κ)| κ). The position w0
of the maximum value y0 = Zp,q(w0, κ) is
w0 = w1 + 2
sn
 p
nK(κ)|κ

cn
 p
nK(κ)|κ

dn
 p
nK(κ)|κ

Z
 p
nK(κ)|κ

(8)
where the edges of the main lobe are
w1 = 1 − 2 sn2  p
nK(κ)|κ

(9)
w2 = 2 sn2  q
nK(κ)|κ

− 1 .
(10)
The relation for the maximum value y0
y0 = cosh 2n

σmZ( p
nK(κ)|κ) − Π(σm, p
nK(κ)|κ)

(11)
is useful in the normalization of Zolotarev polynomials. The
degree of the Zolotarev polynomial Zp,q(w, κ) is expressed by
the degree formula
n ≥
ln(y0 +
p
y2
0 − 1)
2σmZ( p
nK(κ)|κ) − 2Π(σm, p
nK(κ)|κ) .
(12)
The auxiliary value σm in (11), (12) is given by the formula
σm = F
 
arcsin
 
1
κ sn

The Zolotarev polynomial Zp,q(w, κ) satisﬁes the differential
equation
(1 − w2)(w − w1)(w − w2)
dZp,q(w, κ)
dw
2
(14)
= n2 
given
p, q, κ, y0
initialization
n = p + q , w1 = 1 − 2 sn2  p
n K(κ), κ

, w2 = 2 sn2  q
n K(κ), κ

− 1 , wa = w1 + w2
2
wm = w1 + 2
sn
 p
n K(κ), κ

cn
 p
n K(κ), κ

dn
 p
n K(κ), κ

Z
 p
n K(κ), κ

α(n) = 1 , α(n + 1) = α(n + 2) = α(n + 3) = α(n + 4) = α(n + 5) = 0
body
(for
m = n + 2
to
3)
8c(1) = n2 − (m + 3)2 , 4c(2) = (2m + 5)(m + 2)(wm − wa) + 3wm[n2 − (m + 2)2]
2c(3) = 3
4[n2 − (m + 1)2] + 3wm[n2wm − (m + 1)2wa] − (m + 1)(m + 2)(w1w2 − wmwa)
c(4) = 3
2(n2 − m2) + m2(wm − wa) + wm(n2w2
m − m2w1w2)
2c(5) = 3
4[n2 − (m − 1)2] + 3wm[n2wm − (m − 1)2wa] − (m − 1)(m − 2)(w1w2 − wmwa)
4c(6) = (2m − 5)(m − 2)(wm − wa) + 3wm[n2 − (m − 2)2] , 8c(7) = n2 − (m − 3)2
α(m − 3) =
1
c(7)
6
X
µ=1
c(µ)α(m + 4 − µ)
(end
loop
on
m)
normalization
s(n) = α(0)
2
+
n
X
m=1
α(m)
a-vector
a(0) = (−1)p α(0)
2s(n) ,
(for m = 1
to
n) ,
a(m) = (−1)p α(m)
s(n) ,
(end loop
on
m)
impulse response
h(n) = a(0) + 1
y0 + 1
,
(for m = 1
to
n) ,
h(n ± m) =
a(m)
2(y0 + 1) ,
(end loop
on
m)
TABLE I
FAST ALGORITHM FOR EVALUATING THE a-VECTOR a(k) AND THE IMPULSE RESPONSE h(k).
given
fQ,
f0,
fs,
k
initialization
if fQ < f0 : λ =
cos

2π fQ
fs

− 1
cos

2π f0
fs

− 1
, s = 1,
else : λ =
cos

2π fQ
fs

+ 1
cos

2π f0
fs

+ 1
, s = −1
λ
′ = 1 − λ
,
αk(k + 1) = αk(k + 2) = αk(k + 3) = 0
,
αk(k) = λk
body
(for µ = −3 ... k − 4 )
αk(k − µ − 4) =
{
−2s
h
(µ + 3)(2k − µ − 3) −
λ
′
λ (k − µ − 3)(2k − 2µ − 7)
i
αk(k − µ − 3)
+2 λ
′
λ (k − µ − 2) αk(k − µ − 2)
+2s
h
(µ + 1)(2k − µ − 1) −
λ
′
λ (k − µ − 1)(2k − 2µ − 1)
i
αk(k − µ − 1)
+µ(2k − µ) αk(k − µ)
} / (µ + 4)(2k − µ − 4)
(end loop on µ)
TABLE II
FAST ALGORITHM FOR EVALUATING THE COEFFICIENTS αk(m) OF TRANSFORMATION MATRIX A.
166
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-245-5
ICN 2013 : The Twelfth International Conference on Networks

by the arithmetic-geometric mean [7]. The Jacobi elliptic
integral of the third kind Π(x, y, κ) in (12) is evaluated by
a fast procedure proposed in [3].
0
500
1000
1500
2000
2500
3000
3500
4000
−80
−70
−60
−50
−40
−30
−20
−10
0
f
20 log |H(ej2πf/fs )| [dB]
0
500
1000
1500
2000
2500
3000
3500
4000
−120
−100
−80
−60
−40
−20
0
f
20 log |H(ej2πf/fs )| [dB]
0
500
1000
1500
2000
2500
3000
3500
4000
−160
−140
−120
−100
−80
−60
−40
−20
0
f
20 log |H(ej2πf/fs )| [dB]
Fig. 3.
Amplitude frequency responses 20 log |H(ej2πf/fs)| [dB].
0
500
1000
1500
2000
2500
3000
3500
4000
−100
−90
−80
−70
−60
−50
−40
−30
−20
−10
0
f
20 log |H(ej2πf/fs )| [dB]
Fig. 4.
Amplitude frequency responses 20 log |H(ej2πf/fs)| [dB] of the
ﬁlters with N = 13141 coefﬁcients.
V. EXAMPLES OF DESIGN
Let us design three sets of band pass FIR ﬁlters speciﬁed
by the DTMF frequencies f0 = 697, 770, 852, 941, 1209,
1336, 1477, 1633 Hz, width of the pass bands ∆f = 50Hz,
sampling frequency fs = 8000Hz and with the attenuations
in the stop bands as = −80dB, −120dB and −160dB.
Using the presented design procedure, we get ﬁlter lengths
N = 1083 coefﬁcients for as = −80dB, 1551 coefﬁcients
for as = −120dB and 2019 coefﬁcients for as = −160dB.
The corresponding amplitude frequency responses are shown
in Fig. 3. In order to demonstrate the remarkable selectivity
of the ER BP FIR ﬁlters and the robustness of the presented
design procedure, let us design the DTMF ﬁlters with
very narrow pass band of ∆f = 5Hz, sampling frequency
fs = 8000Hz and with the attenuation in the stop bands
as = −100dB. The ﬁlter length is N = 13141 coefﬁcients.
The amplitude frequency responses are shown in Fig. 4.
VI. CONCLUSION AND FUTURE WORK
We have presented a fast and robust procedure for the
design of optimal equiripple narrow band-pass FIR ﬁlters for
DTMF applications. In contrast to the established numerical
design procedure the proposed methodology solves the
approximation problem and provides a formula for the degree
of the ﬁlter and formulas for the evaluation of the coefﬁcients
of the impulse response of the ﬁlter. Our future activity will
include an efﬁcient implementation of the DTMF ﬁlters using
digital signal processors.
ACKNOWLEDGEMENTS
This work was thankfully supported by the grant MPO No.
FR-TI2/621.
167
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-245-5
ICN 2013 : The Twelfth International Conference on Networks

REFERENCES
[1] G. Goertzel,
An Algorithm for the evaluation of ﬁnite trigonometric
Series, Amer. Math. Monthly. Vol. 65, January 1958, pp. 34-35.
[2] M. Vlˇcek, P. Zahradnik,
Digital Multiple Notch Filters Performance,
Proceedings of the 15th European Conference on Circuit Theory and
Design ECCTD’01. Helsinky, August 2001, pp. 49-52.
[3] P. Zahradnik, M. Vlˇcek, Fast Analytical Design Algorithms for FIR Notch
Filters, IEEE Transactions on Circuits and Systems. March 2004 , Vol.
51, No. 3, pp. 608 - 623.
[4] P. Zahradnik, M. Vlˇcek, An Analytical Procedure for Critical Frequency
Tuning of FIR Filters. IEEE Transactions on Circuits and Systems II.
January 2006, Vol. 53, No. 1, pp. 72-76.
[5] N. I. Achieser, ¨Uber einige Funktionen, die in gegebenen Intervallen am
wenigsten von Null abweichen, Bull. de la Soc. Phys. Math. de Kazan,
Vol. 3, pp. 1 - 69, 1928.
[6] D. F. Lawden Elliptic Functions and Applications Springer-Verlag, New
York Inc., 1989.
[7] M. Abramowitz, I. Stegun, Handbook of Mathematical Function, Dover
Publication, New York Inc., 1972.
[8] M. Vlˇcek, R. Unbehauen, Zolotarev Polynomials and Optimal FIR Filters,
IEEE Transactions on Signal Processing, Vol. 47, No. 3, pp. 717-730,
March 1999.
168
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-245-5
ICN 2013 : The Twelfth International Conference on Networks

