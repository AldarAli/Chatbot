Improved Trend Following Trading Model by Recalling Past Strategies in 
Derivatives Market 
 
Simon Fong, Jackie Tai 
Department of Computer and Information Science 
University of Macau 
Macau SAR 
ccfong@umac.mo, ma56562@umac.mo 
 
 
Abstract—Unlike financial forecasting, trend following (TF) 
doesn’t predict any market movement; instead it identifies a 
trend at early time of the day, and trades automatically 
afterwards by a pre-defined strategy regardless of the moving 
market directions during run time. Trend following trading 
has a long and successful history among speculators. The 
traditional TF trading method is by human judgment in setting 
the rules (aka the strategy). Subsequently the TF strategy is 
executed in pure objective operational manner. Finding the 
correct strategy at the beginning is crucial in TF. This usually 
involves human intervention in first identifying a trend, and 
configuring when to place an order and close it out, when 
certain conditions are met. In this paper, we proposed a Trend 
Recalling model that operates in a computer system. It works 
by partially matching the current trend with one of the proven 
successful patterns from the past. Our experiments based on 
real stock market data show that this method has an edge over 
the other trend following methods in profitability. The results 
show that TF however is still limited by market fluctuation 
(volatility), and the ability to identify trend signal. 
Keywords- Trend Following; Automatic Trading System; 
Futures Contracts; Mechanical Trading 
I. 
 INTRODUCTION 
Trend following (TF) [1] is a reactive trading method in 
response to the real-time market situation; it does neither 
price forecasting nor predicting any market movement. Once 
a trend is identified, it activates the trading rules and adheres 
rigidly to the rules until the next prominent trend is identified. 
Trend following does not guarantee profit every time, but 
nonetheless in a long term period it may probably profit by 
obtaining more gains than loses. Since TF is an objective 
mechanism that is totally free from human judgment and 
technical forecasting, the trends and patterns of the 
underlying data play an absolutely influential role in 
deciding its ultimate performance. 
It was already shown in [2] that market fluctuation 
adversely affects the performance of TF. Financial cycles are 
inevitable phenomena and it is a controversy whether cycles 
can be predicted or past values cannot forecast future values 
because they are random in nature. Nonetheless, we 
observed that cycles could not be easily predicted, but the 
abstract patterns of such cycles can be practically recalled by 
simple pattern matching. The formal interpretation of 
financial cycle (or better known as economic cycle) refers to 
economy-wide fluctuations in production or economic 
activity over several months or years. Here we consider it as 
the cycle that run continuously between bull market and bear 
market, some people refer this as market cycle (although 
they are highly correlated), In general a cycle is made of four 
stages, and these four stages are: “(1) consolidation (2) 
upward advancement (3) culmination (4) decline” [3]. 
Despite being termed as cycles, they do not follow a 
mechanical or predictable periodic pattern. But similar 
patterns are observed to always repeat themselves in the 
future, just as a question of when, though in approximate 
shapes. We can anticipate that some exceptional peak (or 
other particular pattern) of the market trend that happen 
today, will one day happen again, just like how it did happen 
in history. For instance, in the “1997 Asian Financial Crisis” 
[4], the Hang Seng Index plunged from the top to bottom (in 
stages 3 to 4); then about ten years later, the scenario repeats 
itself in the “2008 Financial Crisis” [5]. 
Dow Theory [6] describes the market trend (part of the 
cycle) as three types of movement. (1) The "primary 
movement", main movement or primary trend, which can 
last from a few months to several years. It can be either a 
bullish or bearish market trend. (2) The "secondary 
movement", medium trend or intermediate reaction may last 
from ten days to three months. (3) The "minor movement" or 
daily swing varies from hours to a day. Primary trend is a 
part of the cycle, which consist of one or several 
intermediate reaction and the daily swings are the minor 
movements that consist of all the detailed movements. Now 
if we project the previous assumption that the cycle is ever 
continuously rolling, into the minor daily movement, can we 
assume the trend that happens today, may also appear some 
days later in the future?  
 
 
Figure 1.  Intra-day of 2009-12-07 and 2008-01-31 day trend graphs  
31
PATTERNS 2011 : The Third International Conferences on Pervasive Patterns and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-158-8

Here is an example for this assumption; Figure 1 shows 
respectively two intra-day 2009-12-07 (top) and 2008-01-31 
(bottom) trend graphs of Hang Seng Index Futures, which 
are sourced from two different dates. Although they are not 
exactly the same, in terms of major upwards and downwards 
trends the two graphs do look alike. 
This is the underlying concept of our recalling trading 
strategies that are based on searching for similar patterns 
from the past. This concept is valid for TF because TF works 
by smoothing out the averages of the time series. Minor 
fluctuations or jitters along the trend are averaged out. This 
is important because TF is known to work well on major 
trending cycles aka major outlines of the market trend. 
II. 
RECALLING PAST TRENDS 
An improved version of Trend Following algorithm is 
proposed in this paper, which looks back to the past for 
reference of selecting the best trading strategy. The design of 
a TF system is grounded on the rules that are summarized by 
Michael W. Covel, into the following five questions [7]: 
1. How does the system determine what market to buy 
or sell at any time? 
2. How does the system determine how much of a 
market to buy or sell at any time? 
3. How does the system determine when you buy or sell 
a market? 
4. How does the system determine when you get out of a 
losing position? 
5. How does the system determine when you get out of a 
winning position? 
The first and second questions are already answered in 
our previous work [1]. The third question is rather 
challenging, that is actually the core decision maker in the 
TF system and where the key factor in making profit is; 
questions 4 and 5 are related to it. Suppose that we have 
found a way to identify trend signal (to buy or sell), and we 
have a position opened. Now if the system along the way 
identifies another trend signal, which complies with the 
current opened position direction, then we should keep it 
open, since it suggested that the trend is not yet over. 
However, if it is counter to the current position, we should 
probably get a close out, regardless whether you are 
currently winning or losing, as it indicates a trend reversion. 
Our improved TF algorithm is designed to answer this 
question: when to buy or sell. It is a fact that financial cycles 
do exist, and it is hypothesized that a trend on a particular 
day from the past could happen again some days later. This 
assumption supports the Recalling trading mechanism, which 
is the basic driving force that our improved trend following 
algorithm relies on. The idea is expressed in Figure 2. As it 
can be seen in the diagram there’s four major processes for 
the decision making. Namely they are Pre-processing, 
Selection, Verification and Analysis. Figure 2 shows the 
process of which our improved TF model works by recalling 
a trading strategy that used to perform well in the past by 
matching the current shape of the pattern to that of the old 
time. A handful of such patterns and corresponding trading 
strategies are short-listed; one strategy is picked from the list 
after thorough verification and analysis. 
 
Figure 2.  Improved TF process with Recalling function. 
A. Pre-processing 
In this step, raw historical data that are collected from the 
past market are archived into a pool of samples. A sample is 
a day trend from the past with the corresponding trading 
strategy attached. The trend is like an index pattern for 
locating the winning trading strategy that is in the format of a 
sequence of buy and sell decisions. Good trading strategy is 
one that used to maximize profit in the past given the 
specific market trend pattern. This past pattern which is 
deemed to be similar to the current market trend, is now 
serving as a guidance to locate the strategy to be applied for 
decision making during the current market trade session.  
Since the past day trend that yielded a great profit before, 
reusing it almost can guarantee a perfect trading strategy that 
is superior than human judgment or a complex time series 
forecasting algorithm. The past samples are referenced by 
best trading strategies on an indicator that we name it as 
“EDM” (exponential divergence in movement). EDM is a 
crisp value indicator that is based on two moving average 
differences. 
(
( ))
( )
( )
l t
s t
t
EMA
f EMA
EDM
−
=
, 
1)
(
1)
(
( )
( )
1
2
−
−
 +





+
×
−
=
t
t
t
t
EMA
n
EMA
price
EMA
 
where price(t) is the current price at any given time t, n is 
the number of periods, s denotes a shorter period of EMA(t) 
at time t, l represents a longer period EMA(t), f(.) is a 
function for generating the crisp result. The indicator sculpts 
the trend; and base on this information, a TF program finds a 
list of best trading strategies, which can potentially generate 
high profit. The following diagram is an example of pre-
processing a 2009-12-07 day trend that shows the EDM. As 
indicated from the diagram the program first found a long 
position at 10:00 followed by a short position at around 
10:25, then a long position at 11:25, finally a short position 
around 13:51 and closes it out at the end of the day, which 
reaps a total of 634 index points. In Hong Kong stock market, 
there is a two hours break between morning and afternoon 
sessions. To avoid this discontinuation on the chart, we shift 
the time backward, and joined these two sessions into one, so 
13:15 is equivalent to 15:15. 
B. Selection 
Once a pool of samples reached a substantial size, the 
improved TF with recalling mechanism is ready to use. The 
stored past samples are searched and the matching ones are 
selected. The goal of this selection process is to find the most 
32
PATTERNS 2011 : The Third International Conferences on Pervasive Patterns and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-158-8

similar samples from the pool, which will be used as a 
guideline in the forthcoming trading session. A foremost 
technical challenge is that no two trends are exactly the same, 
as they do differ day by day as the market fluctuates in all 
different manners. Secondly, even two sample day trends 
look similar but their price ranges can usually be quite 
different. With consideration of these challenges, it implies 
that the sample cannot be compared directly value to value 
for a simple match. Some normalization is necessary for 
enabling some rough matches. Furthermore the comparison 
should allow certain level of fuzziness. Hence each sample 
trend should be converted into a normalized graph, and by 
comparing their rough edges and measure the difference, it is 
possible to quantitatively derive a numeric list of similarities. 
In pattern recognition, the shape of an image can be 
converted to an outline like a wire-frame by using some 
image processing algorithm. The same type of algorithm is 
used here for extracting features from the trend line samples 
for quick comparison during a TF trading process. 
In our methodology, each sample is first converted into a 
normalized graph, by calculating their technical indicators 
data. Indicators such as RSI and STC have a limited value 
range (from 1 to 100) which is suitable for fast comparison, 
and they are sufficient to reflect the shape of a trend. In other 
words, these indicators help to normalize each trend sample 
into a simple 2D line graph. We can then simply compare 
each of their graphical difference by superimposing these 
line graphs on top of each other for estimating the 
differences. This approach produces a hierarchical similarity 
list, such that we can get around with the inexact matching 
problem and allows a certain level of fuzziness without 
losing their similarity attributes. Figure 4 shows an example 
of two similar samples trend graphs with the RSI displayed. 
 
Figure 3.  Example of EDM and preprocessed trend of 2009-12-17 
 
Figure 4.  Example of 2009-12-07 sample with best fitness (2008-01-31) day trend and RSI graph. 
2009-12-07 
closed market 
day trend 
Best fitted 
sample 2008-
01-31 
33
PATTERNS 2011 : The Third International Conferences on Pervasive Patterns and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-158-8

C. Verification 
During this process, each candidate from the list will be 
tested against the current market state. Ranking from the top 
smallest number as the most similar, they will be passed 
through fitness test. Each trend sample is corresponding to a 
specific trading strategy (that was already established in the 
pre-processing step). Each trading strategy will be extracted 
and evaluated against historical data and calculating how 
well it performed as a trial. Each of their performances will 
be recorded. The trial performance will be used as a criterion 
to rearrange the list. Here we have an example before and 
after the fitness test, which was run on the 2009-12-07 
during the middle of simulated trade session.  
 
 
Figure 5.  Fitness test applied on 2009-12-07 at the time 14:47 
Verification is needed because the selection of these 
candidates is by a best effort approach. That is because the 
market situations now and the past may still differ to certain 
extent.  
D. Confirmation 
After the verification process is finished, the candidate 
list is re-sorted according to the fitness test results. The fittest 
one will be used as the reference of subsequent trading 
strategy during the TF decision making. In order to further 
improve the performance on top of the referencing to the past 
best strategy, some technical analysis is suggested to be 
referenced as well. By the advice of Richard L. Weissman 
from his book [8], the two-moving average crossover system 
should be used as a signal confirmation. (The two-moving 
average crossover system entails the rise of a second, 
shorter-term moving average.) But instead of using simple 
moving average, EMA - exponential moving average with 
RSI should be used, that is a short-term RSI EMA and a 
long-term RSI EMA crossover system. When a trend is 
identified and it appears as a good trading signal, the 
crossover system must also be referenced and check if it 
gives a consistent signal. Otherwise the potential trend is 
considered as a false signal or noise. For example in our case 
the trading strategy from the recalled sample hints a long 
position trade. We check if RSI crossover system shows a 
short-term EMA crossing over its long-term EMA or not. 
In addition to validating the hinted trading signals from 
past strategy, market volatility should be considered during 
decision making. There are many ways to calculate volatility; 
the most common one is finding the standard deviation of an 
asset closing price over a year. The central concept of 
volatility is finding the amount of changes or variances in the 
price of the asset over a period of time. So, we can measure 
market volatility simply by the following equation: 
(
)
(
C)
price
price
SMA
Volatility
t
t
n
t
×
−
=
− )
ln(
)
ln(
1)
(
( )
( )
, 
n
Close
Close
Close
SMA
n
t
t
t
t
1)
(
1)
(
( )
( )
......
+
−
−
+
+
=
 
where ln(.) is a natural logarithm, n is the number of 
periods, t is the current time, C is a constant that enlarges the 
digit to a significant figure. By observing how the equation 
responds to historical data, we can find the maximum 
volatility as ±15. Base on the previous fluctuation test result, 
we can define it as the following fuzzy membership. 
 
 
Figure 6.  Volatility membership defination. 
During the trading session, volatility will be constantly 
referenced while the following rules apply at the TF system: 
 
IF volatility is too positive high and long position is opened THEN 
close it out 
  
IF volatility is too positive high and no position is opened THEN 
open short position 
 
IF volatility is too low THEN do nothing 
 
IF volatility is too negative high and short position is opened THEN 
close it out 
 
IF volatility is too negative high and no position is opened THEN 
open long position 
 
These rules have a higher priority over the trade 
strategies, such that when the condition has met any of these 
rules, it will take over the control regardless of what decision 
that the trade strategies has made. We now summarize these 
four processes as pseudo codes shown in Appendix. 
III. 
EXPERIMENT 
The improved TF algorithm with recalling function is 
programmed as an automated trading simulator, written in 
JAVA. All trials of simulations are run on historical market 
data within 2.5 years prior to the year of 2010. A price that 
spread between bid and ask price is considered on each trade. 
34
PATTERNS 2011 : The Third International Conferences on Pervasive Patterns and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-158-8

In the simulation each trade is calculated in the unit of 
index point, each index point is equivalent to 50 HKD, 
which is subject to overhead cost as defined by Interactive 
Broker unbundled commission scheme at 19.3 HKD per 
trade. ROI is the prime performance index that is based on 
Hong Kong Exchange current Initial margin requirement 
(each contract 7400 HKD in year of 2010). 
From the simulation result, we observed as shown in 
Table 1 that a 333% ROI is achieved at the end of the 
experimental run. This is a significant result as it implies the 
proposed TF algorithm can reap more than three folds of 
whatever the initial investment is over just 2.5 years of 
trading. The trading pattern is shown in Figure 7 that shows 
overall the trading strategy is ever winning in a long run. 
Figure 8 shows a horizon of trading results, overall there are 
more profits than losses.  
TABLE I.  
RESULTS OF THE OVERALL SIMULATION RUNS 
 
IV. 
CONCLUSION AND FUTURE WORKS 
Trend following has been known as a rational stock 
trading technique that just rides on the market trends with 
some preset rules for deciding when to buy or sell. TF has 
been widely used in industries, but none of it was studied 
academically in computer science communities. We 
pioneered in formulating TF into algorithms and evaluating 
their performance. Our previous work has shown that its 
performance suffers when the market fluctuates in large 
extents. In this paper, we extended the original TF algorithm 
by adding a market trend recalling function. Trading strategy 
that used to make profit from the past was recalled for 
serving as a reference for the current trading. The trading 
strategy was recalled by matching the current market trend 
with the past market trend at which good profit was made by 
the strategy. Matching market trend patterns was not easy 
because patterns can be quite different in details, and the 
problem was overcome in this paper. Our simulation showed 
that the improved TF model is able to generate profit from 
stock market trading at more than three times of ROI. Our 
next step is to test the algorithms on other stock market data. 
REFERENCES 
[1] Fong S. and Tai J., "The Application of Trend Following 
Strategies in Stock Market Trading", The 5th International 
Conference on Networked Computing, 25-27 August 2009, 
Seoul, Korea, pp. 1971-1976. 
[2] Fong S., Tai J., and Si Y.W., "Trend Following Algorithms 
for Technical Trading in Stock Market", Journal of Emerging 
Technologies in Web Intelligence (JETWI), Academy 
Publisher, ISSN 1798-0461, Volume 3, Issue 2, May 2011, 
Oulu, Finland, pp. 136-145. 
[3] Stan Weinstein's, Secrets for Profiting in Bull and Bear 
Markets, pp. 31-44, McGraw-Hill, USA, 1988. 
[4] Wikipedia, 1997 Asian Financial Crisis, Available at 
http://en.wikipedia.org/wiki/1997_Asian_Financial_Crisis, 
accessed Sep-2010. 
[5] Wikipedia, Financial crisis of 2007–2010, Available at 
http://en.wikipedia.org/wiki/Financial_crisis_of_2007, 
accessed Sep-2010. 
[6] Schannep J., "Dow Theory for the 21st Century: Technical 
Indicators for Improving Your Investment Results", Wiley, 
USA, 2008. 
[7] Covel M.W., "Trend Following: How Great Traders Make 
Millions in Up or Down Markets", New Expanded Edition, 
Prentice Hall, USA, 2007, pp. 220-231. 
[8] Weissman R.L., "Mechanical Trading Systems: Pairing 
Trader Psychology with Technical Analysis", Wiley, USA, 
2004, pp. 10-19. 
Smart Trend Following Simulation Result in the Year of 2010
Smart Trend Following Simulation Result in the Year of 2010
Smart Trend Following Simulation Result in the Year of 2010
Smart Trend Following Simulation Result in the Year of 2010
0
1000
2000
3000
4000
5000
6000
7000
8000
20100104
20100111
20100118
20100125
20100201
20100208
20100217
20100224
20100303
20100310
20100317
20100324
20100331
20100412
20100419
20100426
20100503
20100510
20100517
20100525
20100601
20100608
20100615
20100623
20100630
20100708
20100715
20100722
20100729
20100805
20100812
20100819
20100826
20100902
20100909
20100916
20100924
20101004
20101011
20101018
20101025
20101101
20101108
Date
Date
Date
Date
Index Point
Index Point
Index Point
Index Point
 
Figure 7.  Performance of the improved TF algorithm with recalling function 
35
PATTERNS 2011 : The Third International Conferences on Pervasive Patterns and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-158-8

Daily Profit and Loss
Daily Profit and Loss
Daily Profit and Loss
Daily Profit and Loss
-400
-300
-200
-100
0
100
200
300
400
500
600
Date
Date
Date
Date
Index Point
Index Point
Index Point
Index Point
 
Figure 8.  Daily profit and loss diagram. 
Appendix 
 
 
36
PATTERNS 2011 : The Third International Conferences on Pervasive Patterns and Applications
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-158-8

