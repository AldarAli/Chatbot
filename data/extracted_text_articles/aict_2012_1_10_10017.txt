A Two-Stage Pilot-Assisted CFO Estimation Scheme for OFDM Signals 
 
Omar Al-Sammarraie  
Department of Electrical Engineering 
American University of Sharjah 
Sharjah, UAE 
b00024985@aus.edu 
Mohamed El-Tarhuni  
Department of Electrical Engineering 
American University of Sharjah 
Sharjah, UAE 
mtarhuni@aus.edu 
 
 
Abstract— In this paper, a pilot-assisted two-stage carrier 
frequency offset (CFO) estimation algorithm is proposed for 
OFDM signals. The proposed scheme performs a coarse search 
over a window of possible carrier offsets to obtain an initial 
estimate of the CFO. Then, a fine search is carried over a much 
smaller search window to obtain better accuracy of the carrier 
frequency offset. The pilot signal used in this algorithm results 
in a slowly varying correlation function with peaks at the 
correct offset. This is exploited by the proposed algorithm to 
reduce the search window for the second stage. Simulation 
results presented in this paper show that a significant 
improvement in the mean-square error performance is 
achieved by using this two-stage approach without increasing 
the complexity of implementation compared to single-stage 
conventional algorithms. It is also demonstrated that the 
proposed scheme outperforms the conventional cyclic-prefix 
based CFO estimation algorithm under both flat and 
frequency-selective Rayleigh fading channel conditions.   
Keywords-Carrier Frequency Offset Estimation, OFDM 
Synchronization; Multi-stage Search. 
I. 
 INTRODUCTION 
Orthogonal Frequency Division Multiplexing (OFDM) 
has been proposed to support high data rate applications in 
future mobile radio systems. This is due to its improved 
spectral efficiency and efficient implementation structure. 
Furthermore, OFDM has inherent features in terms of 
mitigating multipath and intersymbol interference (ISI) that 
are dominant in high data rate scenarios [1]–[3]. OFDM 
avoids the ISI problem by transmitting the data over a large 
number of narrow band channels (subcarriers) and by using 
a cyclic prefix at the start of every OFDM symbol.  
A successful deployment of OFDM-based systems, 
however, needs to overcome several challenges. One of the 
main problems is the high peak-to-average power ratio of 
the transmitted signal resulting in a loss of power efficiency. 
Another major issue, which is the focus of this paper, is the 
need for accurate subcarrier synchronization, also called 
carrier frequency offset (CFO) estimation, to maintain 
orthogonality between the subcarriers and, consequently, 
prevent inter-carrier interference (ICI). Frequency offsets 
occur in OFDM systems mainly due to frequency 
mismatches between the transmitter and receiver oscillators 
and partly due to Doppler shifts owing to user mobility. 
Since all the subcarriers should be orthogonal to one another 
to ensure successful data recovery, frequency offsets pose a 
major issue that must be accurately resolved for a successful 
OFDM system implementation [4][5].  
OFDM frequency offset estimators can be classified into 
non pilot-based and pilot-based techniques.  Non pilot-based 
schemes rely on the OFDM symbol structure features such as 
the cyclic prefix (CP) [6]. These schemes are more 
bandwidth efficient than pilot-based schemes but they tend to 
suffer under frequency-selective fading channel conditions 
[7]. However, pilot-based schemes tend to be more accurate 
in estimating the CFO. Furthermore, the use of pilot-based 
schemes is justified since the pilot data can be utilized for 
other purposes such as channel estimation. 
Pilot-based CFO estimation schemes use known training 
symbols sent by the transmitter over specific subcarriers and 
time slots. The pilot symbols may be transmitted as a 
preamble over all subcarriers during the first OFDM symbol 
and then regular data transmission is started. Different 
maximum likelihood (ML) CFO estimators were developed 
in [8]-[13] for both flat and frequency-selective fading 
channels. Although ML schemes provide good performance 
in terms of the mean square estimation error but they tend to 
require high computational complexity. 
In this paper, we introduce a two-stage pilot-based CFO 
synchronization technique that provides accurate carrier 
offset estimation. The proposed scheme uses different search 
steps to find the offset resulting is a reduced complexity 
compared to single-stage searching strategy.  The 
performance of the proposed scheme is presented under both 
flat and frequency selective fading channel conditions. 
The rest of the paper is organized as follows: Section II 
describes the system model. The proposed scheme is 
presented in Section III. Simulation results and conclusions 
are given in Sections IV and V, respectively 
II. 
SYSTEM MODEL 
The block diagram of the OFDM system under 
consideration in this work is shown in Figure 1. An OFDM 
signal is formed by modulating several orthogonal 
subcarriers with different data symbols. The input binary 
data is first applied to the modulation block that maps the 
input data to corresponding modulation symbols. Then, serial 
to parallel (S/P) conversion is performed followed by inverse 
Fast Fourier Transform (IFFT) operation to distribute the 
symbols to the different subcarriers. A cyclic prefix is added 
to form an OFDM symbol and then converted from parallel 
1
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

to serial (P/S) for transmission after digital to analog 
conversion (DAC).  
The transmitted OFDM symbol is expressed as 
                
              
   
                   
   (1) 
where T is the symbol period, N is the number of orthogonal 
subcarriers, and bk is the data symbol of the kth subcarrier. 
A sampled version of the OFDM signal is obtained by 
taking samples every nT/N seconds, where n is an integer, to 
get 
 
       
    
     
 
   
   
. 
 
      (2) 
The OFDM signal is transmitted through a wireless 
channel and experiences fading, noise, and carrier frequency 
offset to obtain the received signal given by 
                                , 
(3) 
where      is the impulse response of the channel,      is 
the additive white Gaussian noise (AWGN), and    is the 
unknown frequency offset (in Hz) to be estimated. In 
discrete form, this reduces to 
        
     
                               (4) 
where       is the normalized frequency offset 
(frequency offset normalized by the symbol rate). For a flat 
fading channel, the received signal is written as 
         
     
 
 
    
         
 
   
   
        
(5) 
where   is the complex channel gain modeled with 
Rayleigh amplitude and uniform phase and   is the channel 
delay. In case of slowly varying channels, this represents a 
sinusoidal signal shifted in frequency by   and multiplied 
by a constant complex number. 
To recover the transmitted data, the receiver performs 
reverse operations on the received signal as shown in Fig. 1. 
However, a frequency synchronization block is needed to 
estimate the unknown frequency offset that is provided to the 
FFT block for correction. The proposed frequency 
synchronization algorithm is discussed in the following 
section. 
III. 
PROPOSED SYSTEM 
The proposed CFO estimation scheme, shown in Fig. 2, 
performs a search over a window of possible frequency 
offsets in order to estimate the unknown offset     The 
scheme uses a two-stage, also known as double-dwell (DD), 
search strategy. The first stage performs a coarse search 
over the possible frequency offset search window with a 
relatively large frequency separation (called step size) 
between the test offsets in order to reduce the complexity of 
the synchronization algorithm. The second stage uses a 
much smaller step size than the first stage but searches over 
a much smaller window of possible offsets as specified by 
the largest correlation peaks from the first stage. This results 
in a significant improvement in the estimation accuracy 
while maintaining a low complexity of implementation.  
We assume that a known pure sinusoidal preamble pilot 
data sequence,    
   is transmitted for synchronization 
purposes. Although using a pilot sequence causes some 
degradation to the bandwidth efficiency, especially in fast 
fading channels, these pilots are needed for channel 
estimation and hence their use for accurate frequency offset 
estimation is justified. Furthermore, the distribution of pilot 
symbols over the time-frequency grid can vary depending 
on channel conditions (time and frequency selectivity). 
During the pilot sequence transmission, the received signal 
is reduced to 
       
    
     
  
      
 
  
         
 
            (6) 
The first stage of correlation is performed by correlating 
the received signal in (6) with a number of complex-
conjugate versions of the pilot sequence each with a test 
normalized frequency offset         , where       is 
the normalized search step size for the first stage and   is 
the search step size in Hz and   is an integer with values 
   
 
     
 
                
 
      
 
    
 Without 
loss of generality, we assume 
 
   to be an even number so we 
have m as an integer. The step size for the first stage is 
typically large, e.g., 10% of the frequency offset          
in order to reduce the number of correlations and hence 
reduce the complexity. For the mth offset, correlating the 
received signal with the known pilot symbols during the 
first search stage results in  
          
 
          
 
  
   
   
        
 (7) 
where     
   
     
   
   
is a complex constant and      is 
due to the noise component. 
The objective is to find the value of    that maximizes 
the magnitude of the correlation function in (7). It can be 
shown that this is equivalent to maximizing the following 
function over    
      
                                    
                
 
  
 
              
 
  
    
(8) 
which is maximized when     ; i.e., when the test offset 
equals to the actual frequency offset to be estimated. Fig. 3 
displays some examples for the above function for a 
normalized frequency offset   of               , 
demonstrating that the maximum is achieved when the test 
offset equals to the actual frequency offset.  
2
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

In practical implementations, only a finite number of test 
offsets are searched. Thus, it is possible to have an error due 
to the limited resolution of the search process. This error can 
be reduced by increasing the number of search steps, i.e., 
reduce the step size. However, the hardware and 
computational power could be used more efficiently if the 
predictability of the correlation function is exploited since 
the exact offset corresponds to the function’s global 
maximum. Therefore, if the exact offset does not coincide 
with the search steps, it must then be between the two 
offsets corresponding to the two highest correlation peaks. 
Thus, we use a second search stage with a smaller step 
size,       in order to improve the accuracy of the 
estimation. The search window is limited to the range 
between the two frequency offsets with the largest 
correlation values obtained over the first search stage such 
that the computational complexity is reduced. Suppose that 
        has it is largest or peak value at m =   , then the 
second stage search is either performed between     and 
      if                       or between     
and       if                      . The search is 
done in steps of    and thus limits the maximum offset 
estimation error to      .  
The following correlation operation is performed for the 
second stage 
          
 
          
 
  
   
   
       
 (9) 
where    is the normalized test offset and      is the noise 
component. The normalized test offset is determined as:  
 
 
Figure 1.  OFDM system block diagram. 
 
 
           
                         
       
                                (10) 
for                  where     is the integer value 
greater than or equal to  . Finally, the offset that results in 
the largest correlation in (9) is used as the estimate for the 
actual normalized frequency offset   . The estimated offset 
is then provided to the FFT block at the receiver for offset 
correction prior to the FFT operation. 
IV. 
SIMULATION RESULTS 
In this section, the performance of the proposed double-
dwell (DD) synchronization technique is presented in terms 
of the mean-square error (MSE) in estimating the frequency 
offset. The proposed scheme performance is compared to 
the performance of the conventional cyclic extension (CE) 
synchronization technique. The channel is assumed to 
follow a Rayleigh fading model with either flat fading or 
frequency selective fading. The OFDM system is assumed 
to have N = 128, 256, or 512 subcarriers and the cyclic 
extension is 1/8th of the OFDM symbol duration. The 
double-dwell scheme uses a first stage with a normalized 
search step size of        and a second stage with a 
normalized search step size of        . These values were 
used for illustration purposes and other values could be used 
without loss of generality. 
Fig. 4 compares the MSE performance of the double-
dwell scheme with that of the cyclic-extension based 
scheme under flat fading for an OFDM system with 128, 
256, or 512 subcarriers. The results show that the double-
dwell 
scheme 
provides 
a 
significant 
improvement, 
especially at low signal-to-noise ratio, with a gain of more 
than one order of magnitude. It is observed that the 
performance for both schemes improves as the number of 
subcarriers increases. 
 
 
Figure 2.  Block diagram of the proposed double-dwell frequency 
synchronization scheme. 
 
3
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

 
Figure 3.  Examples of the correlation function for different frequency 
offsets. 
 
The gain achieved by the double-dwell scheme is 
significantly increased when the channel undergoes 
frequency-selective fading as shown in Fig. 5. In this case, 
the channel has five multipath components with equal 
energy and a maximum delay spread of 75% of the guard 
time. It is noticed that the cyclic-extension based scheme 
suffers from the presence of the multipath components 
while the proposed scheme maintains a good performance.  
Finally, we remark that the number of complex 
multiplications and additions needed by the proposed 
scheme is               while a conventional single 
stage search scheme with the same accuracy as the proposed 
scheme 
would 
require 
       
 operations. 
This 
demonstrates that the proposed scheme reduces the 
complexity by a factor of       
  
   .  
The performance will always be accurate to within     . 
Therefore, given a desired maximum error     , a first 
stage step size,   , that gives the minimum number of search 
steps,   , required for the desired estimation accuracy can 
be calculated 
   
   
 
   
     
   
   
   
                                                                           (11) 
V. 
CONCLUSION AND FUTURE WORKS 
In this paper, a two-stage pilot-based CFO estimation 
algorithm has been proposed. The algorithm uses a large 
step size to test for the CFO during the first stage to reduce 
the complexity. Then, a second search stage is used with a 
small step size to improve the CFO estimation accuracy. 
Simulation results demonstrate significant improvement in 
the MSE of the proposed scheme over both flat and 
frequency-selective Rayleigh fading channels. Future work 
will focus on optimizing the number of search stages and 
step sizes to have further performance improvement and 
complexity reduction. 
 
Figure 4.  MSE frequency offset estimation performance under flat fading 
channel conditions: CE – Cyclic Extension; DD – Double-dwell. 
 
Figure 5.  MSE frequency offset estimation performance under frequency-
selective fading channel conditions. 
 
REFERENCES 
[1] T. Hwang, C. Yang, G. Wu, S. Li, and G. Li, “OFDM and Its 
Wireless Applications: A Survey,” IEEE Trans. Veh. Technol., vol. 
58, no. 4, pp. 1673 – 1694, May 2009. 
[2] J. Bingham, “Multicarrier modulation for data transmission: An idea 
whose time has come,” IEEE Commun. Mag., vol. 28, no. 5, pp. 5–
14, May 1990. 
[3] R. Prasad, OFDM for Wireless Communication Systems, Boston: 
Artech House Inc, 2004. 
[4] H. Steendam and M. Moeneclaey, “Analysis and optimization 
of the performance of OFDM on frequency-selective time-
selective fading channels,” IEEE Trans. Commun., vol. 47, no. 
12, pp. 1811–1819, Dec. 1999. 
[5] Y. Mostofi and D. Cox, “Mathematical analysis of the impact 
of timing synchronization errors on the performance of an 
OFDM system,” IEEE Trans. Commun., vol. 54, no. 2, pp. 226–
230, Feb. 2006. 
4
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

[6] N. Lashkarian and S. Kiaei, “Class of cyclic-based estimators for 
frequency-offset estimation of OFDM systems,” IEEE Trans. 
Commun., vol. 48, no. 12, pp. 2139–2149, Dec. 2000. 
[7] H. Steendam and M. Moeneclaey, “Analysis and optimization 
of the performance of OFDM on frequency-selective time-
selective fading channels,” IEEE Trans. Commun., vol. 47, no. 
12, pp. 1811–1819, Dec. 1999. 
[8] Y. Li, H. Minn, N. Al-Dhahir, and A. R. Calderbank, “Pilot designs 
for consistent frequency-offset estimation in OFDM systems,” IEEE 
Trans. Commun., vol. 55, no. 5, pp. 864–877, May 2007. 
[9] Y. Li and H. Minn, “Robust and consistent pilot designs for 
frequency offset estimation in MIMO OFDM systems,” IEEE Trans. 
Commun., vol. 56, no. 10, pp. 1737–1747, October 2008. 
[10] J. Zheng and W. Zhu, “An algorithm for calibration of TDS-OFDM 
carrier frequency offset,” IEEE Trans. Consum. Electron., vol. 55, no. 
2, pp. 366–370, May 2009. 
[11] M. Morelli and U. Mengali, “Carrier-frequency estimation for 
transmission over selective channels,” IEEE Trans. Commun., vol. 
48, no. 9, pp. 1580–1589, Sep. 2000. 
[12] J. Chen, M. Li, and Y. Kuo, “Adaptive OFDM synchronization 
algorithm in frequency selective fading channels,” IEEE Trans. 
Consum. Electron., vol. 55, no. 4, pp. 1841 – 1846, Nov. 2009. 
[13] W. Chin, “ML estimation of timing and frequency offsets using 
distinctive correlation characteristics of OFDM signal over dispersive 
fading channels,” IEEE Trans. Veh. Technol., vol 60, no. 2, pp. 444 – 
456, Feb. 2011. 
 
 
 
5
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-199-1
AICT 2012 : The Eighth Advanced International Conference on Telecommunications

