Underlay Cognitive Radio Wireless Networks using Repetition Coding
and Spread Spectrum
Saed Daoud, David Haccoun, and Christian Cardinal
Department of Electrical Engineering
´Ecole Polytechnique de Montr´eal
Montr´eal, QC, Canada
Email: saed.daoud@polymtl.ca, david.haccoun@polymtl.ca, christian.cardinal@polymtl.ca
Abstract—In this paper, we investigate the use of repetition coding
(RC) in conjunction with code division multiple access (CDMA)
spread spectrum (SS), as a means to spread the signal power of a
secondary (cognitive) underlay system, operating at the same time
and on the same frequency band with a primary system. First, we
consider single user (SU) systems, where we ﬁnd the bit error rate
(BER) at the secondary receiver (SR), satisfying a given quality
of service (QoS) requirement for the primary system. Then, we
ﬁnd the maximum coding rate required to satisfy the QoS of both
systems. Also, we investigate the combination of RC and SS in
multiuser (MU) systems, where SS is used as a means to separate
the signals from each others. Simulation results show that, using
RC with low coding rate, can maintain the interference level
at the primary receiver (PR) below the maximum allowed level,
while, at the same time, improving the BER performance of the
secondary system. Furthermore, the largest coding rate required
to satisfy both systems’ QoS grows fast, as the transmit power of
the primary system gets larger than the minimum value for the
secondary system to operate. Finally, it is shown that, in some
cases, dividing the bandwidth between RC and SS is a better
option than allocating the whole bandwidth to SS only.
Keywords–Bit error rate, cognitive radio, repetition coding,
quality of service, spread spectrum.
I.
INTRODUCTION
Future wireless communication systems will require ever
increased data rate (or equivalently, bandwidth), required by
the demanding multimedia applications. This is challenging
as most of the electromagnetic (EM) spectrum is licensed
to primary users. However, close investigations reveal that,
the EM spectrum can be utilized more efﬁciently, by making
the transmissions’ parameters adaptable to the surrounding
environment, as well as to the users’ demands [1]–[4].
These ﬁndings have triggered huge research activities on
developing techniques on how to access the spectrum more
efﬁciently, resulting in the so-called dynamic spectrum access
(DSA) techniques. In the literature, two models of DSA are
mainly studied: interweave and underlay models [5]. In the
interweave model, a cognitive secondary unlicensed system
uses only the white spaces, i.e., the portions of the spectrum
that are not currently utilized by the primary system, to whom
the spectrum is licensed, and hence has priority in using it.
This model, however, involves detection and tracking of the
white spaces, which are complex to implement, and could
lead to false detection. As a consequence, the quality of
service (QoS) of the primary system is sometimes jeopardized,
or white spaces can be gone unused by ready-to transmit
secondary users. Furthermore, the required white spaces are
not guaranteed to be found at the time a secondary system
is ready to transmit. On the other hand, in underlay model,
which is our focus, there are no temporal or spatial constraints,
but there are interference power constraints imposed by the
primary users, which has to be maintained below a given noise
ﬂoor, in order to maintain a given QoS. These interference
constraints can be met in one of two ways: using beamforming
in multiple antenna systems by focusing the signal power
toward the secondary receivers, and away from the primary
receivers, or spreading the signal power over large bandwidth,
to decrease the interference level within the primary users’
bandwidth of interest [5].
In this paper, our focus is on the underlay model, where
we investigate the usage of repetition codes (RC) as a means
to spread the signal power, with possibly spread spectrum (SS)
techniques for multiuser systems, i.e., code division multiple
access (CDMA) [6]. In particular, we consider a secondary
system operating at the same time and on the same frequency
band with a primary system. First, we consider single user
(SU) systems, and we set a QoS limit on the primary system
in terms of the largest bit error rate (BER) allowed at the
primary receiver (PR), and derive the BER performance at the
secondary receiver (SR) for different coding rates. Then, we
set a QoS requirement at the secondary system in terms of the
maximum BER tolerable at the SR for a satisfying service,
and ﬁnd the maximum coding rate required to satisfy the QoS
of both systems. We then consider multiuser (MU) systems,
where the primary system uses orthogonal spreading codes
such as Walsh-Hadamard (WH) codes [7], where the cross-
correlation between the spreading codes is zero, as a means to
spread and separate the primary signals, while the secondary
system uses a combination of RC and WH codes to spread
and distinguish the secondary signals. Simulation results show
that RC with low coding rate can be used as a simple means
to spread the signal power to satisfy the QoS of both the
primary and secondary systems. Furthermore, in MU systems,
it is shown that, in some cases, dividing the total available
bandwidth between RC and SS is a better option in terms of
BER at SRs than allocating the whole available bandwidth to
SS only.
To the best of the authors’ knowledge, the above proposed
systems haven’t been considered in the literature. The rest of
the paper is organized as follows: In Section II, the system and
channel model are presented, in Section III, the performances
21
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-456-5
COCORA 2016 : The Sixth International Conference on Advances in Cognitive Radio

of SU and MU systems are investigated, in Section IV, simula-
tion results are presented and discussed, and ﬁnally in Section
V, a conclusion is provided.
II.
SYSTEM MODEL
A. SU Systems
First, we consider a secondary (cognitive) system consist-
ing of one secondary transmitter (ST) and one SR, which
operates at the same time and over the same frequency band as
a primary system consisting of one primary transmitter (PT)
and one PR. All channels are assumed to be additive white
Gaussian noise (AWGN) channels, where the additive noise at
the front-end receivers is assumed to have a single-sided power
spectral density (PSD) N0 Watts/Hz, and both systems use
binary phase shift keying (BPSK) modulation with the same
bit rate Rb bits/sesond, and thus both systems have the same
baseband bandwidth, W = Rb Hz, where rectangular pulse
shaping is assumed, and null-to-null bandwidth is considered.
Both systems are assumed to be synchronous. The power
received at the front-end receivers is noted to be P from the PT
and S from the ST. The QoS of the primary system is protected
by setting a maximum BER value τp allowable at the PR. This
implies that the minimum data bit energy-to-interference-plus-
noise PSD allowed at the PR, denoted by ηp,min, is given by
[8]
ηp,min = Q−1(τp)2
2
,
(1)
where
Q(.)
is
the
Q-function
given
by
Q(x)
=
1
√
2π
R ∞
x e−u2/2 du, and Q−1(.) is its inverse. From (1),
it is implied that the interference is approximated as a white
Gaussian random process. The secondary system uses a RC
scheme with coding rate Rc = 1/N, as a means to spread
its signal power over a wider bandwidth. At the SR, the
majority logic detection is used for decoding, where a bit is
declared 1(0), if the majority of decoded bits are 1s(0s). The
secondary system might have its own QoS requirement in
terms of maximum allowable BER at the SR, denoted by τs.
B. MU Systems
In multiuser systems, we consider a secondary system with
Ns transmitter-receiver (Tx-Rx) pairs operating simultaneously
with a primary system with Np Tx-Rx pairs, where all trans-
missions are assumed to be synchronous at both the bit and
chip levels. WH codes are used in both systems as a means
to spread and separate the signals from different transmitters
in a given system. It is assumed that the primary signals are
spread over the entire available bandwidth, with a spreading
factor (SF) Gp. For the secondary system, ﬁrst a RC with
coding rate Rc = 1/Ms is used, and then each coded bit is
spread by a SF Qs, where Qs = Gp/Ms, such that the signal
after coding and SS occupies the total available bandwidth, i.e.,
MsQs = Gp. The above description implies that, each user,
whether in the primary or secondary system, has a transmission
rate of GpRb chips/second at the channel input, where Rb is the
information bit rate measured in bits/second. Since WH code
matrices are squared matrices with dimensions of power 2, and
for mathematical convenience, we assume that the parameters
Gp, Np, and Ms are also variables of power 2, i.e., Gp = 2gp,
Np = 2np, and Ms = 2ms, where gp, np, and ms are all non-
negative integers. Also, it is assumed implicitly that Np ≤ Gp
and Ns ≤ Qs. Finally, all receivers are assumed to receive a
power P from all PTs, and power S from all STs. The other
parameters are the same as in SU systems.
III.
PERFORMANCE ANALYSIS
A. SU Systems
Let that the PSD of the primary signal be denoted Jp, and
that of the secondary signal Js. Then we have P = JpW
and S = JsW. In SU case, since RC coding with coding rate
Rc = 1/N is used, the secondary signal is spread by a factor
N, i.e., the bandwidth and PSD after coding are given by NW
and Js/N, respectively. Thus, the signal-to-interference-plus-
noise ratio (SINR) at the PR is given by
JpW
Js
N × W + N0W =
P
S
N + N0 W ,
(2)
where N0W is the noise power within the primary sig-
nal’s bandwidth, and the corresponding data bit energy-to-
interference-plus-noise PSD is given by [9]
ηp =
γp
γs
N + 1,
(3)
where γp
=
(Eb)p/N0 and γs
=
(Eb)s/N0 are the
interference-free signal-to-noise ratio (SNR) at PR and SR,
respectively, where (Eb)p = P/W and (Eb)s = S/W. To
satisfy the QoS requirement of the primary system, we need
ηp =
γp
γs
N + 1 ≥ ηp,min,
(4)
which results in
γs
N ≤
γp
ηp,min
− 1.
(5)
At the input of the SR, and following the same logic as
done above for the PR, the SINR can be found to be
S
P + N0NW ,
(6)
and the corresponding coded bit energy-to-interference-plus-
noise PSD is given by
ηs,c = γs/N
γp
N + 1.
(7)
For the majority logic detector at the SR, the BER is given
by
BERs =
N
X
k=L
N
k

BERk
s,c (1 − BERs,c)N−k ,
(8)
where L = ⌊N/2⌋ + 1, and
BERs,c = Q
p
2 ηs,c

,
(9)
is the BER per coded bit.
If the secondary system also has a QoS requirement, then
we aim to ﬁnd the largest coding rate, or equivalently, the
smallest value of N that is required to satisfy the QoS of both
systems. Toward that end, the BER at the SR needs to be
simpliﬁed as a function of N. It can be upper bounded, for
BERs,c ≪ 1, by [10]
BERs ≤

2pBERs,c
N ≤ 2N/2 exp

−N
2 ηs,c

,
(10)
22
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-456-5
COCORA 2016 : The Sixth International Conference on Advances in Cognitive Radio

where the second inequality is due to the Chernoff upper bound
of the Q-function: Q(x) ≤ 1
2 exp

− x2
2

. To make sure that
BERs is less than a predeﬁned maximum BER τs, we need to
satisfy the following inequality
2N/2 exp

−N
2 ηs,c

≤ τs,
(11)
or equivalently
N
2 ln 2 −
γs
2
 γp
N + 1
 ≤ ln τs,
(12)
where ln(.) is the natural logarithm. Solving (12) for γs yields
γs ≥ 2
hγp
N + 1
i N
2 ln 2 − ln τs

.
(13)
Combining (5) and (13) results in
2
hγp
N + 1
i N
2 ln 2 − ln τs

≤ γs ≤ N
 γp
ηp,min
− 1

. (14)
Since
2
hγp
N + 1
i N
2 ln 2 − ln τs

≤ N
 γp
ηp,min
− 1

,
(15)
and assuming that N ≥ 1, we can solve (15) for N, which
yields the following quadratic function
N 2
 γp
ηp,min
− 1 − ln 2

|
{z
}
A
+N [2 ln τs − γp ln 2]
|
{z
}
B
+ 2γp ln τs
|
{z
}
C
≥ 0.
(16)
Using the general quadratic solution formula, N can be found
to be
N ≥ −B ±
√
B2 − 4AC
2A
,
(17)
and thus, denoting the minimum real value in the right hand
side of (17) that is grater than or equal to 1 by Nmin, the
maximum RC coding rate that satisﬁes the QoS of both the
primary and secondary systems is given by Rc,max = 1/Nmin.
B. MU Systems
In MU systems, it can be shown that the SINR at each PR
is given by [11]
P
Ns S + σ2n,p
,
(18)
where σ2
n,p = N0GpW is total noise power at the front-end of
the PR. Then, the bit-energy-to-interference-plus-noise PSD at
each PR after despreading is given by [11]
ηp =
γp
Ns
Gp γs + 1.
(19)
Hence, we need that
ηp =
γp
Ns
Gp γs + 1 ≥ ηp,min,
(20)
to satisfy the QoS of the primary system, which, when solved
for γs, yields
γs ≤ Gp
Ns
 γp
ηp,min
− 1

.
(21)
In (21), we have found the maximum allowable power that
each SR can receive from the corresponding STs, which will
be used next to evaluate the BER at each secondary receiver
for different values of Ms, and Ns. Using the majority logic
detection for (Ms, 1) RC, the BER at each SR is given by
BERs,RCSS =
Ms
X
k=⌊ Ms
2 ⌋+1
Ms
k

εk
s,RC (1 − εs,RC)Ms−k , (22)
where εs,RC is the BER per coded bit, which is given by [8]
εs,RC = Q
p
2ηs,RC

,
(23)
where ηs,RC is the secondary system’s coded bit energy to
interference-plus-noise PSD, and can be shown to be [9]
ηs,RC =
γs/Ms
Np
Gp γp + 1
.
(24)
Note that if the secondary users are spread the same way
as the primary users, i.e., if Ns ≤ Gp secondary users are
spread over the entire bandwidth using a WH code matrix of
dimension Gp×Gp, then nothing would change for the primary
receivers. However, the BER at the secondary receivers will
differ, as the BER in this case will be given by
BERs,SS = Q


s
2γs
Np
Gp γp + 1

 .
(25)
In next section, we will compare the performance of coded SS
(using RC and WH codes), and uncoded SS (when only WH
codes are used).
γp [dB]
8
10
12
14
16
18
20
γs [dB]
-40
-30
-20
-10
0
10
20
30
N=1, 5, 10, 20, 30
Figure 1. SNR at SR γs in dB vs. SNR at PR γp in dB for
τp = 10−4 and N = 1, 5, 10, 20, 30.
IV.
SIMULATION RESULTS
In this section we evaluate the analytical results we derived
in the previous sections. First we show the results for SU
systems, when only the primary system has to meet a QoS
requirement, and then when both the primary and secondary
systems have to meet their respective QoSs. Then we illustrate
the performance of MU systems, and compare coded SS with
uncoded SS systems. All simulations were conducted using
MATLAB program version R2015a.
23
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-456-5
COCORA 2016 : The Sixth International Conference on Advances in Cognitive Radio

γp [dB]
8
10
12
14
16
18
20
BERs
10-5
10-4
10-3
10-2
10-1
100
N=1
N=5
N=10
N=20
N=30
Figure 2. BER at SR BERs vs. SNR at PR γp in dB for
τp = 10−4 and N = 1, 5, 10, 20, 30.
A. SU Systems
First we consider the following parameters: τp = 10−4 and
N = 1, 5, 10, 20, 30. In Figure 1, the interference-free SNR
at the SR, γs, in dB vs. the interference-free SNR at the PR,
γp, in dB is shown. It is shown that as N increases, i.e., the
rate decreses, the allowed power from the secondary system
increases as well. This is because the interference margin at PR
is constant, while at the same time, increasing N decreases the
actual interference from the ST. The corresponding BER at the
SR, BERs, vs. the interference-free SNR at the PR, γp, in dB
is shown in Figure 2, where we can see that, as N increases,
the BER decreases for a given value of γp. This improvement
is attributed to coding gain, where as N increases, each bit is
repeated a larger number of times, while the SNR per coded
bit, γs/N, is kept constant, because of the increased power
allowed by the low coding rate, as it is shown in (5).
We now examine the case when both the primary and
secondary systems have a QoS requirements, we consider
the following parameters: τp = 10−2, 10−3, 10−4, 10−5 and
τs = 10−4. In Figure 3, the minimum number of repetitions
per bit to satisfy the QoS of both systems Nmin in dB vs. the
interference-free SNR at the PR γp in dB is shown. We can
observe two things here: ﬁrst, as the QoS requirement at the PR
becomes more stringent, the secondary system requires higher
power from the PT, to create enough interference margin to
start operating. Second, when γp is high enough for a given
τp for the secondary system to start operating satisfactory,
the coding rate required to satisfy both systems’ QoS is very
low, i.e., Nmin is very large. This is because the interference
margin is very low at the PR. However, Nmin decays fast as γp
gets larger than the minimum value required for the secondary
system to operate, and then it becomes almost constant at yet
higher γp. For example, if we want the secondary system to
operate immediately at γp ≃ 12 dB for τp = 10−5, then we
would need Nmin as large as 1000. However, Nmin ≃ 100 at
γp ≃ 12.5 dB, and Nmin ≃ 25 for γp ≥ 16 dB. In Figure 4 the
corresponding interference-free SNR at the SR normalized by
Nmin, i.e., γs/Nmin in dB is shown versus the interference-free
SNR at the PR γp in dB, where it is apparent that ST can
transmit at higher power for lower QoS requirements at the
PR.
It is worth mentioning here that, using RC to spread the
secondary system’s power, decreases the secondary system
bandwidth efﬁciency, because we transmit the same bit several
times. This is the cost the secondary system has to pay, in
exchange of accessing the channel, in the presence of a primary
system, with QoS constraints on the secondary and/or primary
systems. However, RC serves as a very simple coding scheme,
where all we have to do, is just to repeat each data bit at the
transmitter, and use the majority logic detection principle at the
receiver, and thus, very low coding rates can be realized with
reasonable complexity. More complex low coding rate codes
require increased hardware and computational complexities for
the encoding and decoding processes, although they may offer
better performance.
γp [dB]
6
8
10
12
14
16
18
20
Nmin [dB]
0
10
20
30
40
50
60
τp=10-2
τp=10-3
τp=10-4
τp=10-5
Figure 3. The value Nmin in dB vs. SNR at PR γp in dB for
τp = 10−2, 10−3, 10−4, 10−5 and τs = 10−4.
γp [dB]
6
8
10
12
14
16
18
20
γs/Nmin [dB]
-2
0
2
4
6
8
10
12
14
16
τp=10-2
τp=10-3
τp=10-4
τp=10-5
Figure 4. SNR at SR normalized by Nmin γs/Nmin in dB vs.
SNR at PR γp in dB for τp = 10−2, 10−3, 10−4, 10−5 and
τs = 10−4.
B. MU Systems
In the MU case, we consider the following parameters
for the numerical simulations: the total available bandwidth,
normalized by the baseband bandwidth is Gp = 210 = 1024,
and the number of primary users is Np = 29 = 512. The
maximum allowable BER at each PR is set to be 10−4.
24
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-456-5
COCORA 2016 : The Sixth International Conference on Advances in Cognitive Radio

In Figure 5, the interference-free SNR at each SR γs in dB
vs. the interference-free SNR at each PR γp in dB, is shown for
Ms = 21 = 2 repetitions per bit, and the number of secondary
users (SUs) is Ns = 2ns for ns = 4, 5, 6, 7, 9. We can see
that as the number of SUs increases, the allowed transmit
power at each ST decreases for a given γp. This is natural,
since as Ns increases, the interference at each PR increases,
and thus to maintain the maximum allowed interference power
at each PR, the transmit power at each ST must be decreased.
In Figure 6, the coded SS BER BERs,RCSS vs. interference-
free SNR at each PR in dB, is shown for Ns = 64 and
Ms = [1, 2, 4, 8, 16]. For each value of Ms, a WH matrix
of dimensions Qs × Qs is used for SS, where Qs = Gp/Ms.
Also shown the case when the whole available bandwidth is
allocated to SS only (i.e., no coding is used), where a WH
matrix of dimensions 1024×1024 is used. We can see that for
Ms = 2, 4 coded SS outperforms uncoded SS, signiﬁcantly so
for Ms = 2. However, for Ms = 8, 16, coded SS has inferior
performance compared to uncoded SS. This trend holds true
for different values of Ns. The implication from this ﬁgure
is that, dividing the total available bandwidth between coding
and SS, is more beneﬁcial in some cases compared to uncoded
SS.
γp [dB]
5
10
15
20
25
30
γs [dB]
-40
-30
-20
-10
0
10
20
30
40
Ns=512, 128, 64, 32, 16
Figure 5. SNR at each SR γs in dB vs. SNR at each PR γp in
dB for Gp = 1024, Np = 512, Ms = 2,
Ns = [16, 32, 64, 128, 512], and maximum BER of
τp = 10−4.
V.
CONCLUSIONS AND FUTURE WORKS
In this paper, we investigated the use of repetition coding,
as a means to spread the signal power, possibly in conjunction
with other spreading techniques such as spread spectrum, in an
underlay cognitive radio system. We considered single user and
multiuser systems. In single user systems, we considered two
cases: when the primary system only has a QoS requirement,
and when both the primary and secondary systems have QoS
requirements. In multiuser systems, we incorporated Walsh-
Hadamard coding as an a means to distinguish the signals
from each others, while deploying repetition coding at each
secondary transmitter. Simulation results showed that, in single
user systems, repetition codes with low enough coding rate,
can decrease the interference level at the primary receiver
effectively, only by repeating each data bit, instead of using
more complex spreading techniques, while at the same time
10
12
14
16
18
20
22
24
26
28
30
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
γp [dB]
BERs,RCSS
 
 
Ms=1 (Coded SS)
Ms=1 (Uncoded SS)
Ms=2
Ms=4
Ms=8
Ms=16
Figure 6. BER at each SR BERs,RCSS vs. SNR at each PR γp
in dB for Gp = 1024, Np = 512, Ms = [1, 2, 4, 8, 16],
Ns = 64, and maximum BER of τp = 10−4.
enhancing the bit error rate at the secondary receiver due
to coding gain. In multiuser systems, it is shown that, in
some cases, dividing the total bandwidth between coding and
spread spectrum, is more beneﬁcial, in terms of bit error rate
performance at each secondary receiver, than allocating the
total available bandwidth to spread spectrum only. As a future
work, convolutional codes will be investigated and compared
with RC in terms of performance, as well as complexity
requirements.
REFERENCES
[1]
J. Ma, G. Li, and B. H. Juang, “Signal processing in cognitive radio,”
Proc. IEEE, vol. 97, no. 5, May 2009, pp. 805–823.
[2]
M.
Buddhikot,
“Understanding
dynamic
spectrum
access:
Mod-
els,taxonomy and challenges,” in 2nd IEEE International Symposium on
New Frontiers in Dynamic Spectrum Access Networks, 2007. DySPAN
2007., April 2007, pp. 649–663.
[3]
S. Haykin, D. Thomson, and J. Reed, “Spectrum sensing for cognitive
radio,” Proc. IEEE, vol. 97, no. 5, May 2009, pp. 849–877.
[4]
Q. Zhao and B. Sadler, “A survey of dynamic spectrum access,” IEEE
Signal Processing Mag., vol. 24, no. 3, May 2007, pp. 79–89.
[5]
A. Goldsmith, S. Jafar, I. Maric, and S. Srinivasa, “Breaking spectrum
gridlock with cognitive radios: An information theoretic perspective,”
Proc. IEEE, vol. 97, no. 5, May 2009, pp. 894–914.
[6]
R. Pickholtz, D. Schilling, and L. Milstein, “Theory of spread-spectrum
communications–a tutorial,” IEEE Trans. Commun., vol. 30, no. 5, May
1982, pp. 855–884.
[7]
A. Viterbi, “Very low rate convolution codes for maximum theoretical
performance of spread-spectrum multiple-access channels,” IEEE J.
Select. Areas Commun., vol. 8, no. 4, 1990, pp. 641–649.
[8]
J. Proakis, Digital Communications, 4th ed.
McGraw-Hill, 2000.
[9]
A. Viterbi, “When not to spread spectrum - a sequel,” IEEE Commun.
Mag., vol. 23, no. 4, April 1985, pp. 12–17.
[10]
P. Azmi, “The effect of channel coding rate on the resistance of
direct-sequence spread-spectrum communication systems to narrow-
band interference,” Prog. Electromagn. Res., vol. 7, 2008, pp. 89–103.
[11]
K. Gilhousen, I. Jacobs, R. Padovani, A. Viterbi, J. Weaver, L.A., and
C. Wheatley, E. III, “On the capacity of a cellular CDMA system,”
IEEE Trans. Veh. Technol., vol. 40, no. 2, May 1991, pp. 303–312.
25
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-456-5
COCORA 2016 : The Sixth International Conference on Advances in Cognitive Radio

