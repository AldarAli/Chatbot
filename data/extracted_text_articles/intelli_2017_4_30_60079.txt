Evaluation of Reference Model for Thermal Energy System Based on Machine 
Learning Algorithm 
 
Minsung Kim 
School of Energy Systems Engineering 
Chung-Ang University 
Seoul, Republic of Korea 
email: minsungk@cau.ac.kr  
Young-Soo Lee 
Thermal Energy System Laboratory 
Korea Institute of Energy Research 
Daejeon, Republic of Korea 
email: yslee@kier.re.kr 
 
 
Abstract—Since thermal energy systems are comprised in a 
number of heat exchangers and fluid machinery, it is 
complicated and time consuming to analyze the systems 
mathematically. For heat pumps, a number of mathematical 
studies have been carried out to identify their operating status; 
however, accurate models are very difficult to develop due to 
numerous cases of different installation and operating 
conditions. As an alternative way to estimate the performance, 
a methodology using machine learning algorithm is introduced 
to develop a reference model. A steady-state detector with a 
simple low pass filter is applied to filter signals. Once steady 
state of the system is identified, the real-time measurements 
are collected to train the system model. From the study, the 
semi-expert based learning algorithm is effective to develop 
reference models of heat pump systems. 
Keywords-Thermal energy systems; Steady state; Machine 
learning; Fault detection and diagnosis. 
I. 
 INTRODUCTION 
An increasing emphasis on energy saving and 
environmental conservation requires air conditioners and 
heat pumps to be highly efficient. In the first place, a variety 
of research and development on a cycle as well as its basic 
components have been performed to increase overall 
efficiency of heat pump systems. A survey of over 55,000 
residential and commercial units found the refrigerant charge 
to be incorrect in more than 60 % of the systems [1].  
Another independent survey of 1500 rooftop units showed 
that the average efficiency was only 80 % of the expected 
value, primarily due to improper refrigerant charge [2]. To 
this end, various technologies were reported to analyze the 
performance of heat pump systems including the function of 
fault detection and diagnosis [3]-[5].  
The development of Fault Detection and Diagnosis 
(FDD) method includes a laboratory phase during which 
fault-free and faulty operations are mapped, and an analytical 
phase during which FDD algorithms are formulated. These 
techniques typically produce the reference data under the 
combinations of test conditions which were modulated in 
laboratory. However, it is very difficult to produce a set of 
reference data in field systems since the configurations of 
heat pumps are different. Even in the cases of previous 
studies performed in laboratories, great efforts are taken to 
build up reference experiment. From this end, a machine 
learning algorithm is introduced in this study to produce the 
reference model out of field operating data of a heat pump 
system. The reference model was generated at steady states. 
To generate machine learning procedure, two environmental 
chambers were programmed randomly reflecting field 
environment. From the study, a reference model of the heat 
pump system was obtained very handful and convenient way 
with an acceptable accuracy. 
In this paper, a reference model was described for a heat 
pump system in section II and the model was statistically 
evaluated in section III. From the analysis, methodological 
approach was introduced for a machine learning in section 
IV.  
II. 
STEADY STATE MODELING OF HEAT PUMPS 
In this study, the FDD process was envisioned to be 
performed every time the system is in steady state. The 
concept of the steady-state detector originates from noise 
filter theory. When a system is not steady, thermodynamic 
system parameters are highly unstable.  The variance, or 
standard deviation, of important parameters is typically 
utilized to indicate the statistical spread within the data 
distribution and can be used to characterize random variation 
of the measured signals. 
A. Determination of characteristic variables 
Typical temperature-entropy (T-s) diagram presenting a 
vapor compression cycle is plotted in Figure 1. Since 
temperature measurements are most suitable and costly 
effective, the 7 parameters were selected as characteristic 
variables. The selected seven features are: Evaporator exit 
refrigerant saturation temperature (TE), evaporator exit 
refrigerant superheat (Tsh), condenser inlet refrigerant 
saturation temperature (TC), compressor discharge refrigerant 
temperature (TD), condenser exit liquid line refrigerant 
subcooled temperature (Tsc), evaporator air temperature 
change (ΔTEA), and condenser air temperature change (ΔTCA). 
As inputs of the characteristic variables, three parameters 
were chosen; outdoor dry-bulb temperature (TOD), indoor 
dry-bulb 
temperature 
(TID), 
and 
indoor 
dew 
point 
temperature (TIDP). The reference model was developed with 
the 3 independent variables and the 7 dependent variables. 
The temperature sensors are T-type thermocouples with 
0.5°C of uncertainties. Although the above features are 
limited only by 7 points and the temperature sensors are with 
68
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-576-0
INTELLI 2017 : The Sixth International Conference on Intelligent Systems and Applications (includes InManEnt)

relatively large uncertainties, limited measurements are 
maintained to reflect field measurements. 
The variables were regressed upon the generated from 
the experimental database. Equations were in the form of the 
1st, 2nd, and 3rd order Multivariate Polynomial Regression 
(MPR) models. After the residuals of the characteristic 
parameters can be obtained from the system, FDD process 
identifies defects of the system by analyzing the residuals 
with thresholds value which determine the system status. 
B. Determination of characteristic variables 
According to the features defined above, the variables 
were regressed upon the database generated from the 
experiments. Equations below show a general form of the 
regressed equations for the ith feature (or ith dependent 
variable) as the 2nd and 3rd order MPR models. 
 
 
(2)
2
2
0
1
OD
2
ID
3
IDP
4
OD
5
ID
2
6
IDP
7
OD
ID
8
ID
IDP
9
IDP
OD











i
a
a T
a T
a T
a T
a T
a T
a T T
a T T
a T T
 
(1) 
 
(3)
(2)
3
3
3
10
OD
11
ID
12
IDP
13
OD
ID
IDP
2
2
2
2
14
OD
ID
15
OD
IDP
16
ID
OD
17
ID
IDP
2
2
18
IDP
OD
19
IDP
ID

 










i
i
a T
a T
a T
a T T T
a T
T
a T
T
a T T
a T T
a T
T
a T
T
 (2) 
 
From the above equations, residuals of the characteristic 
parameters can be obtained. After the residuals are measured 
from the system, FDD process identifies defects of the 
system by analyzing the residuals with thresholds value 
which determine the system status.  
C. Machine learning process 
Once the steady-state is identified, key performance 
parameters were evaluated from the references. We validated 
measured Coefficient of Performance (COP) – an efficiency 
parameter – and heating/cooling capacity by comparing the 
manufacturer’s data. If there is no manufacturer’s data, the 
system with no fault incorporated was pre-operated to 
evaluate the reference operation of the system. Once the key 
parameters are evaluated as no fault operation, the measured 
features are used to train the reference module. When the 
COP or heating capacity is out of range from the reference 
value, the system is assigned to be at a faulty status and FDD 
procedure is carried out. 
III. 
VALIDATION OF THE MACHINE LEARNING BASED 
REFERENCE MODEL 
To determine a realistic value of the threshold, validation 
of the measurements is mandatory. We counted three 
uncertainties of steady state, repeatability, and model itself. 
Naturally, the system measurements have uncertainties due 
to sensors – mostly thermocouples – and due to lack of 
measurement repeatability. Once the uncertainties by sensors 
will be evaluated, model uncertainty will be evaluated by the 
sensor uncertainties. In this section, the uncertainties are 
evaluated in statistical values. 
A. Uncertainties due to steady-state variation and lack of 
measurement repeatability 
The uncertainty of a thermocouple may come from 
measurement noise and drift. Considering that the 
measurement noise behaves like zero-mean white noise, its 
natural variation can be characterized closely by the steady-
state standard deviation, i,SS. Thermocouple drift is the 
measurement bias that varies over longer time periods than 
noise.  However, the thermocouple drift can be regarded as 
negligible in this research since the same built-in sensors are 
used for model development and application to the tested 
system for FDD, thus their bias has been considered in the 
reference model measurements for this investigation. To 
observe the repeatability of the system measurements, we 
analyzed 38 repetitive tests of Kim et al. (2006) [6]. The 
feature standard deviations from repeatability tests, i,Repeat, 
are listed in Table 1. In the table, the measurement 
uncertainties were provided due to by due to steady-state 
variation, i,SS, and due to by the variation from test-to-test 
(measurement repeatability), i,Repeat, for similar test 
conditions.  These two values will be used to calculate the 
total residual threshold uncertainty for each feature. 
TABLE I.  STANDARD DEVIATION OF THE SELECTED FEATURES 
Units of °C 
Tsh 
Tsc 
TE 
TD 
TC 
ΔTCA ΔTEA 
Steady-state standard 
deviation (i,SS) 
0.124 0.052 0.024 0.058 0.035 0.063 0.058 
Standard deviation from 
repeatability tests (i,Repeat)
0.101 0.156 0.084 0.280 0.166 0.088 0.111 
 
B.  Uncertainties due to the reference models 
Since measurements are used with the reference model 
predictions to determine residuals, the square-root of the sum 
of residuals presents a non-Gaussian root-mean-square 
(RMS) error. Thus we analyze the no-fault measurements 
distribution in detail to provide the methodology for 
determining a proper value of the threshold i. In most cases, 
it is hard to obtain a reference model covering all operating 
conditions. To train a reference model after installation, a 
real-time decision of fault-free or faulty status is mandatory. 
In contrast to the steady-state and repetition uncertainty, the 
model uncertainty comes from the imperfections associated 
with any mathematical model. We define average bias of the 
 
Figure 1.  T-s diagram of a vapor compression heat pump system 
69
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-576-0
INTELLI 2017 : The Sixth International Conference on Intelligent Systems and Applications (includes InManEnt)

model estimation as the averaged residual between the model 
and current measurement in no zero-mean noise.  
 
 
2
2
2
,NF
,SS
,Model





i
i
i
 
(3) 
TABLE II.  NET MODEL UNCERTAINTIES OF THE FEATURES USING THE 1ST, 
2ND, AND 3RD ORDER MPR MODELS 
Model uncertainties, 
i,Model (°C) 
Tsh 
Tsc 
TE 
TD 
TC 
ΔTCA ΔTEA 
1st order MPR model 
0.557 0.244 0.549 0.799 0.179 0.150 0.581 
2nd order MPR model 
0.328 0.197 0.147 0.319 0.047 0.040 0.131 
3rd order MPR model 
0.197 0.133 0.123 0.250 0.029 0.019 0.071 
 
Model standard deviation, i,Model, characterizes model 
uncertainty. Since zero-mean noise uncertainty (i,SS) and 
model uncertainties (i,Model) amplify the variability of 
residuals independently, it is reasonable to assume that no 
joint effect exists between the two uncertainties. Therefore, 
the covariance between the two uncertainties (i,SS·i,Model) is 
zero, and i,NF will be a squared sum of i,SS and i,Model as 
shown below. By combining the equation with Table 1, 
i,Model can be estimated in Table 2. From the evaluated 
uncertainty, the no fault threshold is determined in section IV. 
IV. 
DETERMINATION OF NO FAULT THRESHOLD 
In this section, confidence intervals – the thresholds of 
the uncertainties evaluated in previous section – will be 
determined for required credibility. 
A.  Confidence interval, k1, for the steady-state uncertainty 
Since we use measurements and standard deviations in a 
preset moving window, their distribution depends on the 
characteristics of the moving window. When n no-fault data 
are sampled Gaussian with standard deviation, i, the t can 
be defined below, where i is the current mean of the moving 
window of n samples.  In such a case, t follows a Student’s t-
distribution with n – 1 degrees of freedom. When we set 1 – 
 probability that the two values are equal (xi = μi), the 
confidence interval, k1= tn–1, is described as below where 
tn–1 is a two-sided confidence interval.  
 
 
/ 2,
1
1
i
i
i
n
P
x
t
n







 






 
(6) 
 
With a 1 –  = 99 % confidence, t0.005,9 = 3.25 which is 
larger than Gaussian distribution of 2.58.  Table 3 shows the 
values of k1 = t. For 99 % confidence (or credibility) 
level, k1 is 3.25.  
TABLE III.  TWO-SIDED CONFIDENCE INTERVALS WITH DEGREES OF 
FREEDOM OF FOUR AND NINE 
1 –  (%) 
80.0 
90.0 
95.0 
99.0 
 
10.0 
5.0 
2.5 
0.5 
t,41 
1.533 
2.132 
2.776 
4.604 
k1=t,92 
1.383 
1.833 
2.262 
3.250 
1 5 sample moving window 
2 10 sample moving window 
B. Confidence interval, k2 , for model uncertainty 
The distribution of the Tsh residual using MPR model 
applied to the NFSS data is a Gaussian.  However, residuals 
near zero are distributed narrower than a Gaussian.  At high 
residual values where | r(Tsh) | > 1.67°C (3.0°F), a Gaussian 
assumption underestimates the probability. From the 
Gaussian approach, 99 % of data fall within the range of 
±0.6°C (±1.08°F), but no-fault test data have a wider range 
of ±0.78°C (±1.41°F) to cover 99 % of all data.   
C. Confidence interval, k3 , for lack of measurement 
repeatability 
Repetitive measurements of a random variable will 
follow a Gaussian distribution, thus, under similar 
measurement conditions; repetitively measured feature 
residuals will also follow a Gaussian distribution.  Table 5 
shows the confidence interval with regard to the confidence 
level for a Gaussian distribution at various confidence levels. 
For example, with 99 % credibility, k3 equals 2.576. From 
the confidence intervals k1, k2, and k3 obtained above, Table 
5 is calculated for the feature thresholds with 50 %, 95 % 
and 99 % credibility for the moving window size of 10 
samples. 
TABLE IV.  TWO-SIDED CONFIDENCE INTERVAL OF THE SEVEN FEATURES 
FOR THE 3RD ORDER MPR MODEL (TEMPERATURE IN °C) 
1 –  (%) 
75.0 
97.5 
99.5 
k2 = tα/2, n-1 
Tsh 
1.00 
2.26 
2.96 
Tsc 
0.93 
2.22 
3.37 
TE 
1.10 
2.06 
2.65 
TD 
1.15 
1.96 
2.63 
TC 
1.03 
2.03 
3.03 
ΔTCA
1.14 
1.95 
2.64 
ΔTEA
0.95 
2.16 
3.22 
 
TABLE V.  FEATURE THRESHOLDS AT DIFFERENT CONFIDENCE LEVELS 
FOR 10 SAMPLES (TEMPERATURE IN °C) 
Threshold of the features 
Tsh 
Tsc 
TE 
TD 
TC 
∆TCA ∆TEA 
50 % credibility, i,0.50 
0.130 0.134 0.092 0.243 0.082 0.064 0.086 
95 % credibility, i,0.95 
0.496 0.411 0.323 0.755 0.237 0.187 0.271 
99 % credibility, i,0.99 
0.735 0.574 0.424 0.983 0.313 0.248 0.373 
V. 
CONCLUSION 
In this study, we developed no fault reference model of 
vapor compression heat pump by machine learning process 
with statistical evaluations. Characteristic variables were 
assumed to behave independently, and uncertainties were 
estimated in three different ways; steady-state uncertainty, 
repeatability uncertainty, and reference model uncertainty. 
From the analysis, we obtained each uncertainty and 
thresholds depending on the credibility. Distribution of 
residuals was unique compared to typical Gaussian or 
student t-distribution, especially larger residuals. To reduce 
uncertainty that may be occurred by the large residuals, it is 
necessary to increase threshold values to minimize false 
detection. From the study, a reference model of the heat 
pump system was obtained very handful and convenient way 
with an acceptable accuracy. 
70
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-576-0
INTELLI 2017 : The Sixth International Conference on Intelligent Systems and Applications (includes InManEnt)

ACKNOWLEDGEMENTS 
This paper is supported by Korea Evaluation Institute of 
Industrial Technology (KEIT) (No. 10063187) funded from 
Ministry of Trade, Industry and Energy of Republic of Korea, 
and authors appreciate their support. 
REFERENCES 
[1] J. Proctor, “Residential and small commercial central air 
conditioning; Rated efficiency isn’t automatic,” ASHRAE 
Winter Meeting, Jan. 26, Anaheim, CA., 2004 
[2] M. S. Breuker and J. E. Braun, “Evaluating the performance 
of a fault detection and diagnostic system for vapor 
compression equipment,” Int. J. of HVAC&R Research, vol. 
4, no. 4, pp. 401-425, 1998. 
[3] T. M. Rossi, “Detection, diagnosis, and evaluation of faults in 
vapor compression cycle equipment,” Ph.D. Dissertation, 
Purdue Univ., West Lafayette, IN, USA, 1995. 
[4] A. S. Glass, P. Gruber, M. Roos, and J. Tödtli, “Qualitative 
model-based fault detection in air-handling units,” IEEE 
Control Systems Magazine, vol. 15, no. 4, pp. 11-22, 1995. 
[5] H. Li, “A decoupling-based unified fault detection and 
diagnosis approach for packaged air conditioners,” Ph.D. 
Dissertation, Purdue Univ., West Lafayette, IN, USA, 2004. 
[6] M. Kim, W. V. Payne, P. A. Domanski, and C. J. L. Hermes, 
“Performance of a residential heat pump operating in the 
cooling mode with single faults imposed,” NISTIR 7350, 
National Institute of Standards and Technology, Gaithersburg, 
MD, USA, 2006. 
 
71
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-576-0
INTELLI 2017 : The Sixth International Conference on Intelligent Systems and Applications (includes InManEnt)

