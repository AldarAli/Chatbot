Comb Filters for Communication Technology
Pavel Zahradnik and Boris ˇSim´ak
Department of Telecommunication Engineering
Czech Technical University in Prague
Prague, Czech Republic
zahradni, simak@fel.cvut.cz
Miroslav Vlˇcek
Department of Applied Mathematics
Czech Technical University in Prague
Prague, Czech Republic
vlcek@fd.cvut.cz
Abstract—An extension of the design of digital equiripple comb
FIR ﬁlters is presented. We introduce the ﬁfth type of comb
FIR ﬁlter which complements the existing four standard types.
The design runs from the ﬁlter speciﬁcations through the degree
formula to the impulse response coefﬁcients, which are evaluated
by an efﬁcient recursive algorithm. One example is included.
Keywords-comb ﬁlter; FIR ﬁlter; recursive algorithm; fast
design; robustness;
I. INTRODUCTION
Comb FIR ﬁlters are often used in the digital processing
of communication signals. They are mainly used in the sup-
pression of unwanted spectral components in the signal, e.g.
for the attenuation of induced power line interferences. The
standard design of a comb FIR ﬁlter starts with a prototype
ﬁlter which is usually a low pass or high pass ﬁlter. The comb
FIR ﬁlter is obtained by inserting of a ﬁnite number of zeros
between the values of the impulse response of the prototype
[1]. In [2], [3] we have demonstrated an efﬁcient design of
optimal equiripple comb FIR ﬁlters which outperforms the
standard design both in terms of speed and robustness. All the
design procedures [1] - [3] lead to the comb FIR ﬁlters of four
types (Fig. 1) with available notch frequencies summarized in
Tab. I. In this paper we introduce the design of comb FIR
ﬁlter of another type (Fig. 2). We call it comb5 FIR ﬁlter. The
comb5 FIR ﬁlter cannot be designed using design procedures
[1] - [3]. The reason for this is that the frequency response of
the comb5 FIR ﬁlter is not obtained by the repetition of a LP
or HP prototype ﬁlter resulting from the interleaving of the
impulse response of the prototype ﬁlter by zeros. Moreover,
it cannot be derived from the types 1-4, e.g. using frequency
transformation. The organization of the paper is as follows.
In Section II the impulse response of the ﬁlter is deﬁned.
In Section III we summarize available positions of notch
frequencies. In Section IV the idea of the comb5 FIR ﬁlter is
introduced. In Section V we present the design of the comb5
FIR ﬁlter. Finally, Section VI illustrates the practical design
of the comb5 FIR ﬁlter.
II. IMPULSE RESPONSE
We assume the impulse response h(k) with odd length N =
2ν + 1 coefﬁcients and with even symmetry
a(0) = h(ν) , a(k) = 2h(ν + k) = 2h(ν − k) , k = 1 ... ν .
(1)
0
0.2
0.4
0.6
0.8
1
−60
−50
−40
−30
−20
−10
0
ωT / π
20log |H(ejω T)|  [dB]
Type 1
0
0.2
0.4
0.6
0.8
1
−60
−50
−40
−30
−20
−10
0
ωT / π
20log |H(ejω T)|  [dB]
Type 2
0
0.2
0.4
0.6
0.8
1
−60
−50
−40
−30
−20
−10
0
ωT / π
20log |H(ejω T)|  [dB]
Type 3
0
0.2
0.4
0.6
0.8
1
−60
−50
−40
−30
−20
−10
0
ωT / π
20log |H(ejω T)|  [dB]
Type 4
Fig. 1.
Four types of comb FIR ﬁlter [3].
TABLE I
NOTCH FREQUENCIES.
Type 1
r even
Type 2
r even
Marginal :
none
Marginal :
ω = 0, ω = π
Non-marginal : ωi = (2i + 1)π
r
Non-marginal : ωi = 2i π
r
i = 0, . . . , r
2 − 1
i = 1, . . . , r
2 − 1
Type 3
r odd
Type 4
r odd
Marginal :
ω = π
Marginal :
ω = 0
Non-marginal : ωi = (2i + 1)πr
Non-marginal : ωi = 2i πr
i = 0, . . . , r − 3
2
i = 1, . . . , r − 1
2
The transfer function of the ﬁlter is
H(z)=
2ν
X
k=0
h(k) z−k =z−ν
"
h(ν)+2
ν
X
k=1
h(ν ± k)

0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−60
−50
−40
−30
−20
−10
0
ω T/ π
20log |H(ejω T)|  [dB]
Fig. 2.
Comb5 FIR ﬁlter.
The function Q(w) represents a polynomial in the variable
w = 1
2(z + z−1) which on the unit circle z = ejωT reduces to
the real valued zero phase transfer function Q(w) of the real
argument
w = cos(ωT ) .
(4)
III. NOTCH FREQUENCIES
There are two types of notch bands. First, the marginal
notch bands are located at the notch frequencies ωT = 0 and
ωT = π. The width of the marginal notch band(s) is ∆ωT/2.
Second, the non-marginal notch bands are located inside the
frequency interval (0, π). The width of the non-marginal notch
band(s) is ∆ωT . Four types of comb FIR ﬁlters are generated
containing either none, or one, or two marginal notch bands
(Fig. 1, Tab. I). The comb5 FIR ﬁlter (Fig. 2) introduced here
consists of one marginal notch band at ωT = π and of non-
marginal notch band(s) inside the interval (0, π).
IV. THE COMB5 FIR FILTER
The comb5 FIR ﬁlter (Fig. 2) is in fact a comb FIR ﬁlter
of type 2 with compensated attenuation at and near the
frequency ωT = 0. Its frequency behavior is obtained by the
parallel combination of a comb FIR ﬁlter of the type 2 and of
a DC-pass FIR ﬁlter which is an inverted DC-notch FIR ﬁlter
[4]. In the discrete time domain, the impulse response h(k)
of the comb5 FIR ﬁlter is the sum of the impulse response
hC2(k) of the comb FIR ﬁlter of the type 2 and of the impulse
response hDC(k) of the DC-pass FIR ﬁlter. Consequently
the design of the comb5 FIR ﬁlter is a co-design of the
two partial FIR ﬁlters. The approximation theory behind the
partial ﬁlters was treated in [3] and [4] in detail. Here we are
focused on the practical aspects of the design.
V. DESIGN PROCEDURE
The design procedure of the comb5 FIR ﬁlter consists of
two basic steps. In the ﬁrst step we design the comb FIR ﬁlter
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−80
−70
−60
−50
−40
−30
−20
−10
0
ω T/ π
20log |H(ejω T)|  [dB]
ω0T/π
ωPT/π
ωST/π
aS[dB]
aP[dB]
∆ω T/π
Fig. 3.
Forming of the frequency response of comb5 FIR ﬁlter.
of the type 2 with the zero phase transfer function [3]
Q(w) = 1 −
1 + (−1)nTn
Tr(w) − κ2
1 − κ2

1 + (−1)n cosh

n acoshκ2 + 1
κ2 − 1
 .
(5)
The impulse response hC2(k) corresponding to the zero phase
transfer function (5) consists of N = 2rn + 1 coefﬁcients.
The design of the comb FIR ﬁlter of the type 2 proceeds as
follows:
• Specify the number b of non-marginal notch bands, the
width of the non-marginal notchbands ∆ωT , the maximal
attenuation in the pass bands ap [dB] and the minimal
attenuation at notch frequencies as [dB] (Fig. 3).
• Evaluate the degree n of the outer Chebyshev polynomial
Tn() in (5)
n ≥
acosh1 + 100.05ap[dB]
1 − 100.05ap[dB]
acosh1 + κ2
1 − κ2
(6)
where κ2 is
κ2 =
1 − cos

r∆ωT
2

1 + cos

r∆ωT
2

(7)
and
r = 2(b + 1) .
(8)
• Evaluate the impulse response hc1(k) of the comb ﬁlter
of the type 1 (Tab. II).
• Convert the impulse response hc1(k) of the comb FIR
ﬁlter of type 1 into the impulse response hc2(k) of the
comb FIR ﬁlter of type 2 using matrix multiplication
364
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

TABLE II
EVALUATION OF THE IMPULSE RESPONSE hC1(k).
given
n, r (integer values) ,
κ2 ̸= 0 (real value)
initialization
a(n) =
1
(1 − κ2)n ,
a(n + k) = 0 for k = 1, 2, 3 ,
h(k) = 0 for k = 0, . . . , 2nr
body
(for k = 1 ... n)
a(n − k) =
{
− 1
2

(2n − k + 1)(k − 1) + κ2(n + 1 − k)(2(n − k) + 1)
a(n + 1 − k)
− κ2(n + 2 − k) a(n + 2 − k)
+ 1
2

(2n − k + 3)(k − 3) + κ2(n + 3 − k)(2(n − k) + 7)
a(n + 3 − k)
+ 1
4(2n + 4 − k)(k − 4) a(n + 4 − k)
o
/ 1
4 k(2n − k)
(end loop on k)
a(0) = a(0)
2
,
C = cosh

n cosh κ2 + 1
κ2 − 1

impulse response
hC1(rn) = 1 − 1 + (−1)na(0)
1 + (−1)nC
(for k = 1 ... n)
hC1 (r(n ± k)) = −(−1)n 1
2
a(k)
1 + (−1)nC
(end loop on k)
TABLE III
EVALUATION OF THE IMPULSE RESPONSE hDC (k).
given
n = nDC (integer value),
λ (real value)
initialization
A(n) = λn ,
A(n + 1) = A(n + 2) = A(n + 3) = 0
body
(for k = 2 ... n + 1)
A(n + 1 − k) =
{
2
(k − 1)(2n + 1 − k) − (λ
′/λ)(n + 1 − k)(2n + 1 − 2k)
A(n + 2 − k)
+ 4 (λ
′/λ)(n + 2 − k) A(n + 3 − k)
− 2 
(k − 3)(2n + 3 − k) − (λ
′/λ)(n + 3 − k)(2n + 7 − 2k)
A(n + 4 − k)
+ (k − 4)(2n + 4 − k) A(n + 5 − k)
} / k(2n − k)
(end loop on k)
impulse response
hDC (nDC ) =
A(0)
2
+ 1
Tn(2λ − 1) + 1
(for k = 1 ... n)
hDC (nDC ± k) = 1
2
A(k) + 1
Tn(2λ − 1) + 1
(end loop on k)
365
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

hc2(k) =
2rn
X
m=0
Λ(k − rn, l − rn) hc1(m) , k = 0, . . . , 2rn
(9)
using the matrix where
Λ(x, y) =













cos

y π
r

if x = y
2 sin

y π
r

π(y − x)
if x ̸= y and |x − y| is even
0
otherwise
.
(10)
In the second step, we design the DC-pass FIR ﬁlter based on
the zero phase transfer function [4]
QDC(w) = 1 −
TnDC (λ w + λ − 1) + 1
TnDC (2λ − 1) + 1
.
(11)
An important issue is the proper choice of the stop-band
frequency ωsT of the DC-pass FIR ﬁlter. This choice guar-
antees the value of the ripple at ω0T equal to the values of
remaining ripples in the pass bands of the comb5 FIR ﬁlter
(Fig. 3). We have no formula for the calculation of the value
ωsT . Consequently we calculate the value ωsT numerically
by minimizing of the function
|HC2(ejω0T )| + |HDC(ejω0T ) − ap|
 .
(12)
The design of the DC-pass FIR ﬁlter continues as follows:
• Calculate the real parameter λ
λ =
1
1 − sin2 ωs T
2
.
(13)
• Evaluate the degree nDC of the zero phase transfer
function (11)
nDC ≥
acosh1 + 100.05as[dB]
1 − 100.05as[dB]
acosh
1 + sin2 ωs T
2
1 − sin2 ωs T
2
.
(14)
• Evaluate the impulse response hDC(k) of the length
2nDC +1 coefﬁcients of the DC-pass FIR ﬁlter (Tab. III).
• Finally, calculate the impulse response h(k) of the comb5
FIR ﬁlter
h(k) = hC2(k) + hDC(k) .
(15)
VI. EXAMPLE OF THE DESIGN
Design a comb5 FIR ﬁlter with 9 non-marginal notch
bands of the width ∆ωT = π/100, maximal attenuation in
the pass bands ap = −3 dB and minimal attenuation in the
stop bands as = −60 dB.
We get r = 20 using (Tab. I) and (8), κ2 = 0.02508563
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−60
−50
−40
−30
−20
−10
0
ω T/ π
20log |H(ejω T)|  [dB]
Fig. 4.
Amplitude frequency response of the comb FIR ﬁlter of type 2.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−80
−70
−60
−50
−40
−30
−20
−10
0
ω T/ π
20log |H(ejω T)|  [dB]
Fig. 5.
Amplitude frequency response of the DC-pass FIR ﬁlter.
(7), n = 7.67506483 → n = 8 (6). Using the recursive
algorithm (Tab. II) we get the impulse response hC1(k)
of the equiripple comb FIR ﬁlter of type 1. The impulse
response hC2(k) of the equiripple comb FIR ﬁlter of type 2
is obtained from hC1(k) using (9), (10). The length of the
impulse response hC2(k) is 321 coefﬁcients. The actual
attenuation in the pass bands is ap act = −2.7029 dB. The
amplitude frequency response 20log|H(ejωT)| [dB] of the
comb FIR ﬁlter of type 2 is shown in Fig. 4. The value
ωsT = 0.00668686π of the DC-pass FIR ﬁlter was evaluated
numerically (12). Further, we get λ = 1.00067186 (13) and
nDC = 394.8084 → n = 395 (14). Using the recursive
algorithm (Tab. III) we get the impulse response hDC(k) of
the DC-pass FIR ﬁlter. Its length is 791 coefﬁcients. The
amplitude frequency response 20log|H(ejωT)| [dB] of the
DC-pass FIR ﬁlter is shown in Fig. 5. The ﬁnal impulse
366
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−60
−50
−40
−30
−20
−10
0
ω T/ π
20log |H(ejω T)|  [dB]
Fig. 6.
Amplitude frequency response of the comb5 FIR ﬁlter.
response h(k) of the length 791 coefﬁcients of the comb5
FIR ﬁlter is calculated using (15). The amplitude frequency
response 20log|H(ejωT)| [dB] of the comb5 FIR ﬁlter is
shown in Fig. 6.
VII. CONCLUSION
In this paper a ﬁfth type of the comb FIR ﬁlter was
introduced and its design procedure was presented. The
coefﬁcients of the impulse response of the ﬁlter are evaluated
based on the ﬁlter speciﬁcation. Independent control can be
exercised over the number of notch bands, the width of the
notch bands and attenuations in both pass bands and stop
bands.
ACKNOWLEDGEMENT
This
activity
was
supported
by
the
grant
No.
MSM6840770014, Ministry of Education, Czech Republic.
REFERENCES
[1] Sanjit K. Mitra, Digital Signal Processing A Computer-Based Approach,
McGraw-Hill, 1998.
[2] P. Zahradnik, M. Vlˇcek, Analytical Design Method for Optimal Equirip-
ple Comb FIR Filters, IEEE Transactions on Circuits and Systems - II,
Vol. 52, No. 2, February 2005, pp. 112-115.
[3] P. Zahradnik, M. Vlˇcek, R. Unbehauen, P. Design of Optimal Comb FIR
Filters-Speed and Robustness, IEEE Signal Processing Letters, Vol. 16,
No. 6, 2009, pp. 465-468.
[4] P. Zahradnik, M. Vlˇcek, Note on the Design of an Equiripple DC-Notch
FIR Filter, IEEE Transactions on Circuits and Systems - II, Vol. 54, No.
2, February 2007, pp. 196-199.
367
ICN 2011 : The Tenth International Conference on Networks
Copyright (c) IARIA, 2011              ISBN:978-1-61208-113-7

