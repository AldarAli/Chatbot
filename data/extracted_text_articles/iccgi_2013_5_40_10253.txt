A P300-Based Word Typing Brain Computer Interface System Using a Smart 
Dictionary and Random Forest Classifier 
Faraz Akram, Hee-Sok Han, and Tae-Seong Kim  
Department of Biomedical Engineering 
Kyung Hee University,  
Yongin-si, Republic of Korea 
farsun@gmail.com, hshan@khu.ac.kr, tskim@khu.ac.kr    
 
 
Abstract² The conventional P300 brain computer interface 
(BCI) system for character spelling is typically composed of a 
paradigm that displays flashing rows or columns of characters 
and a P300 classifier from which a target character gets 
recognized. One significant drawback of this system in practice 
is its typing speed which could take a few minutes to type each 
character of a target word. In this work, we propose a novel 
BCI system through which a whole word can be typed with 
much higher word typing speed and accuracy. In our 
presented system, we have integrated a custom-built smart 
dictionary to give word suggestions upon few key characters 
initially typed by the user. Upon the suggested words, the user 
can select one out of the given suggestions to complete word 
typing. Our novel paradigm significantly reduces the word 
typing time and makes words typing more convenient. In the 
classification part, we have also adopted a new classifier, 
Random Forest (RF) instead of a commonly used Support 
Vector Machine (SVM). Our results with four subjects using 
the presented word typing system demonstrate an average 
typing time of 1.66 minutes per word, whereas the 
conventional took 2.9 minutes, improving the typing time by 
42.75%. Also RF improves the P300 classification accuracy 
significantly, outperforming SVM. Our presented system could 
be 
useful 
for 
practical 
human 
computer 
interaction 
applications. 
Keywords-P300; Brain Computer Interface; Word Typing;  
Human Computer Interaction 
I. 
 INTRODUCTION 
Brain Computer Interface (BCI) is a system that provides 
a way of communication between a computer or device and 
the brain. The primary goal of a BCI is to enable severely 
disabled peoples to communicate and control their external 
environment without relying on peripheral nerves and 
muscles. Yet it is not restricted to disabled peoples only, 
many applications for normal peoples are emerging. A BCI 
system that utilizes P300 event related potentials of the brain 
is known as P300 BCI. One application of P300 BCI was 
first demonstrated for character spelling by Farwell and 
Donchin [1]. Since then Farwell and Donchin (FD) paradigm 
has been most widely used for P300-based character spelling 
[2,3]. Most of the later research followed the same scheme 
and was focused on improving the classification accuracy 
and speed.  
To improve the classification accuracy, many techniques 
have been suggested for P300 classification such as support 
vector machine (SVM) [4], linear discriminant analysis 
(LDA) [5], and neural network [6] and lately for P300 
extraction such as independent component analysis (ICA) [3] 
and constrained ICA [7]. Recently, there is a growing 
interest in designing efficient paradigms. Various attempts 
have been made to modify the FD paradigm. For instance, in 
[8] Salvaris and Sepulveda made various changes to the 
visual aspects of the FD paradigm. In [9], Allison and Pineda 
tried three different matrix sizes such as 4×4, 8×8, and 
12×12 to investigate the effect of matrix size on the 
amplitude of P300. In [10], Guan et al. used a single 
character flipping instead of row and column intensifications 
to improve classification accuracy. Single character flipping 
reduced the target probability, hence increasing the 
amplitude of P300. In [11], Townsend et al. used an 8×9 
checkerboard paradigm to eliminate this double flash 
problem, improving accuracy. 
A common drawback of all these conventional P300 
spelling systems is that to type a word a user has to spell 
each character of a word one at a time. This spelling process 
is slow and can take several minutes to finish typing a single 
word. A new paradigm is in need by which a user can type a 
whole word in less typing time and effort. Some attempts 
have been made in this regards. In [12], Ahi et al. used a 
dictionary driven P300 speller. They integrated a custom-
built dictionary of 942 four-lettered words into the 
classification system of P300 speller for automatic correction 
of misspellings. However, the dictionary was used only for 
word correction and the user had to spell all the characters of 
a target word. In [13], Ryan et al. proposed a predictive 
spelling scheme with words suggestions, but in their work, 
classification accuracy was decreased due to a higher 
workload in their displays. In [14], Kaufmann et al. used a 
German language predictive speller with some commonly 
used German words. They obtained the similar results due to 
the required high attentions.  
In this paper, we propose an improved BCI system in the 
words suggestions and selection paradigms by reducing the 
workload to the user and by employing a better classifier. In 
this work, we have implemented a smart dictionary to give 
words suggestions to the user in order to reduce the typing 
time. In our proposed scheme, a user only needs to spell few 
initial characters of a word. Then possible words matching 
the typed initials will be suggested to the user. Finally, the 
user only needs to select one of the suggestions. This scheme 
reduces the spelling time and thereby increases information 
transfer rate. Our proposed scheme also reduces the visual 
fatigue by reducing the number of characters required to type 
a word, hence a user can better concentrate on typing in 
longer trials. We have tested our P300 words typing BCI and 
106
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-283-7
ICCGI 2013 : The Eighth International Multi-Conference on Computing in the Global Information Technology

have increased the typing speed by 42.75% in comparison to 
the conventional character typing under the same conditions. 
Also, we have adopted a new RF classifier for P300 
classification to improve the accuracy of typing. Our results, 
in comparison to a commonly used classifier in BCI, show 
that RF outperforms SVM in the typing accuracy. Our 
presented system should be useful as a practical P300 BCI 
spellers. Also it could be used in the application areas of 
human computer interaction for word typing. 
The paper is organized as follows: Section II describes 
the conventional speller and our proposed word typing 
methodology with classification. The results are presented in 
Section III, followed by a conclusion in Section IV. 
II. 
METHODOLOGY 
A. The Conventional P300 Speller 
The conventional P300 speller consists of a 6x6 matrix of 
characters and numbers (much similar to Fig. 1 (a)) in which 
each row and column flashes randomly. A user is asked to 
focus on a target character. P300 is elicited when a row or 
column containing the target character flashes. The target 
character is detected by identifying the row and column 
containing P300s. The user completes word typing by 
spelling every character of the target word. 
B. Overview of Our Proposed P300-based Word Typing 
System 
In our proposed system, we have added a words 
suggestion mechanism with a smart dictionary to the 
conventional character spelling paradigm. Our system 
consists of two paradigms: the first paradigm is a matrix of 
6×5 with characters, as shown in Fig. 1(a). When a session 
starts, the first paradigm is shown to a user and the user 
spells few initial characters of a desired word.  The typed 
initial characters get in to the dictionary module and the 
dictionary searches for the words matching the initial 
characters. When the number of suggested words is less than 
a pre-specified threshold (in our case of nine), the searched 
words are displayed as suggestions. Finally, the user is asked 
to select one out of those suggestions as shown in Fig. 1(b). 
The user selects the target word using the second paradigm.  
C. Initial Character Spelling Paradigm 
In the implementation of the initial character spelling 
paradigm as shown in Fig. 1 (a), we have used a 6×5 matrix 
of characters similar to the FD paradigm in which each row 
and column gets intensified randomly. Intensifications are 
block 
randomized 
and 
in 
each 
block 
of 
eleven 
intensifications, each row or column gets intensified exactly 
once in a random order. For one character epoch, this block 
of intensifications is repeated fifteen times. After each 
character epoch, there is a 2.5s blank time before starting for 
the next character. This blank time indicates a user that one 
character is completed and the user must spell the next 
character of a word to be typed. Intensification time is 
100ms with a 75ms blank time between the intensifications 
according to the standard P300 BCI data of BCI competition 
III [2]. 
 
 
 
 
Figure 1.  Our word typing paradigms. (a) The first paradigm for spelling 
initial characters, (b) a words suggestion screen,  (c) the second word 
selection paradigm, and (d) a display showing the final typed word 
A randomly chosen target word is displayed before the 
start of intensifications. The user focuses on a target 
character and silently counts the number of times of each 
row or column containing the target character intensified. 
P300 potentials are elicited when the row or column 
containing each target character gets flashed. 
D. Dictionary Module 
The dictionary module is implemented in the form of a 
Ternary Search Tree (TST). TST is a special prefix tree 
µ7ULH¶GDWDVWUXFWXUHWKDWFDQILQGDOONH\ZRUGVKDYLQJD
given prefix. Partial matches can easily be searched. The 
advantage of using the prefix tree is its fast searching, but it 
has a disadvantage of its high storage requirements [15]. 
TST handles the storage requirement by combining prefix 
tree with the binary search tree [16]. For an online system, a 
 
(a) 
 
(b) 
 
(c) 
 
(d) 
107
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-283-7
ICCGI 2013 : The Eighth International Multi-Conference on Computing in the Global Information Technology

method is needed to search the dictionary with less access 
time. TST can perform this very efficiently with less storage 
requirements. Implementation of TST was done based on 
the work of Bentley and Sedgewick [16]. Our dictionary 
consists of 2,000 most commonly used English words. 
E. The Second Word Selection paradigm 
The second paradigm is a matrix of 3×3 used to select a 
word out of the suggested words given by the dictionary as 
shown in Fig. 1(c). Since it is known that the row or column-
wise intensifications with the 3x3 matrix size decrease P300 
amplitude and the P300 amplitude has an inverse 
relationship with a priori probability of target stimulus [9], in 
the 
second 
paradigm, 
we 
used 
a 
single 
number 
intensification, instead of intensifying rows and columns, to 
decrease the priori probability of the target stimulus. After 
the word selection, the final word gets typed as shown in Fig. 
1(d). Table I shows the timing specification for both  
paradigms. 
TABLE I. TIMING INFORMATTION OF BOTH PARADIGMS 
Timings of both the paradigms are same except the total 
number of stimuli: the first paradigm has 11 stimuli (i.e., 
6×5 matrix) whereas the second paradigm only 9 (i.e., 3×3 
matrix). 
F. Classification 
In this study, we adopted the RF classifier, an ensemble 
learning technique introduced by Breiman [17]. It is a 
powerful classifier that has been used efficiently in other 
areas of classification but is relatively unknown in the field 
of BCI. The main idea of RF is to combine multiple 
independent decision trees and let them vote for the popular 
class. We have compared the performance of RF against 
SVM. Each subject participated in training and testing 
sessions. In the training session, each subject was instructed 
to spell ten randomly selected characters. We applied a band-
pass filter with the cutoff frequencies of 0.1Hz and 25Hz. 
Then epochs of 600ms after the stimulus onset were 
extracted. One character data contains two targets and 9 non-
target epochs (i.e., two out of eleven rows and columns 
contain P300s). To balance the training data, only two 
randomly chosen non-targets and two targets are used. 
Segments of data are concatenated over the channels to 
create a single feature vector. A total of six channels was 
used for classification. Both classifiers were trained using the 
same features. 
III. 
RESULTS 
We conducted the word typing experiments with four 
healthy subjects. The consent forms were obtained from each 
subject. The EEG data was acquired through a 32-channel 
BrainAmp MR amplifier [18] with a sampling frequency 
250Hz. Electrodes were placed according to the 10-20 
international standards. Six channels out of 32: namely Cz, 
Pz, P3, P4, O1, and O2, were used in typing words with the 
proposed system. There were ten test sessions and in each 
session, each subject typed one word, totaling ten words per 
subject. Table II shows the accuracy of four subjects in terms 
of words using SVM and RF. 
TABLE II. ONLINE ACCURACY 
Based on the timing information given in Table I, we 
have computed the time required to spell one character using 
both the paradigms. For the conventional and our first 
paradigm, the total number of intensification is 165 (i.e., 11 
stimuli×15 repetitions) and 175 ms (i.e., intensification 
time+blank time between intensifications) is the time for one 
intensification. Therefore the time required to spell a single 
character using the conventional paradigm comes out to be 
31.375s (i.e., [165×175] ms + 2.5s blank time between 
characters). In the same way, this comes out to be 26.125s 
for the second paradigm. 
With these numbers, we computed the time required by 
the conventional paradigm to spell the target words and 
compared it with the actual time taken by the proposed 
paradigm for the same words. Table III shows the time 
required to spell these words using the conventional 
paradigm with 100% accuracy. 
TABLE III. WORD TYPING TIME USING THE CONVENTIONAL SCHEME 
Table IV shows the time taken by the proposed scheme 
to spell the same words. The conventional spelling required 
an average time of 2.9 minutes per word while with the 
proposed took an average typing time of 1.66 minutes per 
word, decreasing the typing time by 42.75 %. Note that in 
this study, we have used the standard timings as used in the 
conventional spellers to compare the performance of the 
proposed against the conventional paradigm. Typing speed 
 
First 
Paradigm 
Second 
paradigm 
Intensification time 
100ms 
100ms 
Blank time between intensifications 
75ms 
75ms 
Total stimuli 
11 
9 
Character repeat 
15 
15 
Blank time between characters 
2.5s 
2.5s 
Subject 
Accuracy (%) 
SVM 
RF 
S1 
60 
70 
S2 
80 
90 
S3 
80 
80 
S4 
90 
100 
Mean 
77.5 
85 
Word 
Number 
Word Typing Time Using the Conventional 
Scheme (minutes) 
S1 
S2 
S3 
S4 
1 
2.61 
2.09 
2.09 
4.18 
2 
2.61 
2.61 
3.13 
2.09 
3 
3.13 
2.61 
2.09 
3.66 
4 
2.09 
2.61 
2.61 
4.18 
5 
4.71 
4.18 
4.18 
2.09 
6 
3.13 
3.66 
3.13 
2.09 
7 
3.13 
2.61 
3.66 
3.13 
8 
2.61 
2.61 
2.61 
2.61 
9 
2.09 
3.13 
2.61 
2.09 
10 
2.61 
4.18 
2.61 
2.09 
Mean 
2.87 
3.03 
2.88 
2.82 
Grand mean 
2.9 
108
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-283-7
ICCGI 2013 : The Eighth International Multi-Conference on Computing in the Global Information Technology

can be improved by reducing the number of stimulus 
repetitions and stimulation rate. 
TABLE IV. WORD TYPING TIME USING THE PROPOSED SCHEME 
We also compared the offline classification results of RF 
against SVM for different number of stimulus repetitions. 
Fig. 2 shows the grand mean classification accuracy vs. the 
number of stimulus repetitions for both SVM and RF over 
all subjects. 
 
Figure 2.  Grand averaged classification results over four subjects for RF 
vs. SVM with different number of repetitions 
Our results show that the RF classifier gives a better 
performance on P300 classification even under lesser 
repetitions. 
IV. 
CONCLUSION 
This study is aimed at developing an efficient and 
convenient P300-based word typing BCI. The word typing 
will be enhanced in terms of speed and accuracy through the 
proposed word typing paradigm, a smart dictionary, and RF 
classifier. Our results show that the proposed method of 
P300 word typing system not only increases the speed of 
typing but also makes the spelling task easier for users with 
less fatigue. This could be one important advantage to 
become a practical BCI. 
ACKNOWLEDGMENT 
This research was supported by MKE (The Ministry of 
Knowledge Economy), Korea under the ITRC (Information 
Technology Research Center) support program supervised 
by the NIPA (National IT Industry Promotion Agency) 
(NIPA-2013-(H0301-13-2001)). 
REFERENCES 
[1] L. A. Farwell and E. Donchin ³7DONLQJ RII WKH WRS RI \RXU KHDG
toward a mental prosthesis utilizing event-UHODWHG EUDLQ SRWHQWLDOV´
Electroencephalography and Clinical Neurophysiology, vol. 70, issue 
6, Dec. 1988, pp. 510-528. 
[2] B. Blankertz, et al. ³The BCI competition III: Validating alternative 
approaches to actual BCI problems,´ IEEE Transactions on Neural 
Systems and Rehabilitation Engineering, vol. 14, no. 2, June 2006, 
pp. 153-159. 
[3] H. Serby, E. Yom-7RYDQG*),QEDU³An improved P300-based 
brain-FRPSXWHULQWHUIDFH´ IEEE Transactions on Neural Systems and 
Rehabilitation Engineering, vol. 13, no. 1, Mar. 2005, pp. 89-98. 
[4] M. Kaper, P. Meinicke, U. Grossekathoefer, T. Lingner, and H. 
Ritter, ³BCI competition 2003 - Data set IIb: Support vector 
machines for the P300 speller paradigm,´ IEEE Transactions on 
Biomedical Engineering, vol. 51, no. 6, June. 2004, pp. 1073-1076. 
[5] U. Hoffmann, J. M. Vesin, T. Ebrahimi, and K. Diserens, ³An 
efficient P300-based brain-computer iQWHUIDFHIRUGLVDEOHGVXEMHFWV´ 
Journal of Neuroscience Methods, vol. 167, no. 1, Jan. 2008, pp. 115-
125. 
[6] H. Cecotti and A. Graser, ³Convolutional neural networks for P300 
detection with application to brain-computer interfaces,´ IEEE 
Transactions on Pattern Analysis and Machine Intelligence, vol. 33, 
no. 3, Mar. 2011, pp. 433-445. 
[7] O. I. Khan, HWDO³Robust extraction of P300 using constrained ICA 
for BCI applications,´ Medical & Biological Engineering & 
Computing, vol. 50, no. 3, Mar. 2012, pp. 231-241. 
[8] M. Salvaris and F. Sepulveda, ³Visual modifications on the P300 
speller BCI paradigm,´ Journal of Neural Engineering, vol. 6, no. 4 
Aug. 2009, p. 046011. 
[9] B. Z. Allison and J. A. Pineda, ³ERPs evoked by different matrix 
sizes: Implications for a brain cRPSXWHU LQWHUIDFH %&, V\VWHP´ 
IEEE 
Transactions 
on 
Neural 
Systems 
and 
Rehabilitation 
Engineering, vol. 11, no. 2, June. 2003, pp. 110-113. 
[10] C. Guan, M. Thulasidas, and J. :X³+LJKSHUIRUPDQce P300 speller 
for brain-FRPSXWHU LQWHUIDFH´ Proc. IEEE Int. Workshop Biomed. 
Circuits Syst., Dec. 2004, pp. S3-5/INV-S3/13-16. 
[11] G. Townsend, et al. ³A novel P300-based brain-computer interface 
stimulus presentation paradigm: Moving beyond rows and columns,´ 
Clinical Neurophysiology, vol. 121, no. 7, July. 2010, pp. 1109-1120. 
[12] S. T. Ahi, H. Kambara, and Y. Koike, ³A dictionary-driven P300 
speller with a modified interface,´ IEEE Transactions on Neural 
Systems and Rehabilitation Engineering, vol. 19, no. 1, Feb. 2011, pp. 
6-14. 
[13] D. B. Ryan, et al. ³3UHGLFWLYH VSHOOLQJ ZLWK D 3-based brain±
FRPSXWHU LQWHUIDFH ,QFUHDVLQJ WKH UDWH RI FRPPXQLFDWLRQ´ 
International Journal of Human-Computer Interaction, vol. 27, no. 1, 
Dec. 2010, pp. 69-84. 
[14] T. Kaufmann, S. Völker, L. Gunesch, and A. Kübler, ³Spelling is just 
a click away±a user-centered brain±computer interface including 
auto-calibration and predictive text entry,´ Frontiers in Neuroscience, 
vol. 6, no.72, May. 2012, doi: 10.3389/fnins.2012.00072. 
[15] E. Fredkin, ³7ULHPHPRU\´&RPPXQLFDWLRQVRIWKH$&0YROQR
9, Sept. 1960, pp. 490-499, doi:10.1145/367390.367400. 
[16] J. L. Bentley and R. 6HGJHZLFN ³)DVW DOJRULWKPV IRU VRUWLQJ DQG
VHDUFKLQJVWULQJV´62'$
3URFHHGLQJVRIWKHHLJKWKDQQXDO$&0-
SIAM symposium on Discrete algorithms, Society for Industrial and 
Applied Mathematics Philadelphia, USA, Jan. 1997, pp. 360-369. 
[17] L. Breiman, "Random forests," Machine Learning, vol. 45, no. 1, pp. 
5-32, Oct.2001. 
[18] BrainProducts, 
Munich, 
Germany, 
BrainAmp 
MR, 
http://www.brainproducts.com 
 
 
Word 
Number 
Word Typing Time Using the Proposed 
Scheme (minutes) 
S1 
S2 
S3 
S4 
1 
1.48 
1.48 
2.00 
1.48 
2 
1.48 
2.00 
0.96 
1.48 
3 
2.00 
1.48 
1.48 
2.00 
4 
0.96 
2.00 
2.00 
2.00 
5 
1.48 
2.00 
2.00 
1.48 
6 
2.00 
2.00 
2.00 
1.48 
7 
1.48 
2.00 
1.48 
2.00 
8 
1.48 
1.48 
1.48 
1.48 
9 
1.48 
2.00 
2.00 
1.48 
10 
1.48 
0.96 
2.00 
1.48 
Mean 
1.53 
1.74 
1.74 
1.64 
Grand mean 
1.66 
2
4
6
8
10
12
14
16
0
20
40
60
80
100
Word typing Accuracy (%)
number of repetitions
 
 
RF
SVM
 
109
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-283-7
ICCGI 2013 : The Eighth International Multi-Conference on Computing in the Global Information Technology

