Cloud Based Optimal Routing and Powertrain Management for Hybrid 
and Electric Vehicles 
  
 
Can Kurtulus 
Team Leader, SW & Controls, AVL Turkey 
PhD Candidate, Istanbul Technical University 
Istanbul, Turkey 
email: can.kurtulus@avl.com 
G√∂khan Inalhan 
Assoc. Prof., Aeronautical Engineering Department 
Director, Controls and Avionics Laboratory 
 Istanbul Technical University 
Istanbul, Turkey 
email: inalhan@itu.edu.tr
 
 
Abstract‚Äî Hybrid and electric vehicles have been gaining 
significant traction in the vehicle market for the past few years, 
and this necessitates that further attention should be given to 
their unique characteristics. This paper illustrates a combined 
route guidance and power management approach, where the 
required computation is distributed across an on-board/off-
board system architecture. A model of the vehicle and the 
powertrain is utilized to calculate arc costs of a road network 
for optimal route guidance purposes, and the calculated power 
reference is later on used for dynamic programming based 
power management. This approach has the potential to 
improve vehicle efficiency significantly, and an application 
scenario based on recorded real world trip information is used 
to demonstrate system operation. 
Keywords - hybrid-electric vehicles; powertrain management; 
vehicle route guidance; cloud computing 
I. 
 INTRODUCTION 
Hybrid and electric vehicles have been gaining a large 
importance lately as the primary answer to the demands of 
ever lower levels of noxious emissions as well as lower fossil 
fuel consumption [1]. These vehicles either have an electric 
drive component in addition to the conventional combustion 
engine, or completely get rid of the combustion engine and 
have fully electric powertrains [2]. The higher efficiency of 
the electric drive, as well as the possibility to capture 
normally wasted kinetic energy (i.e., during braking), bring 
about a significant level of improvement in both fossil fuel 
consumption and noxious emissions. The main barrier 
holding back an even more widespread adoption of these 
types of powertrain configurations is the added system cost, 
especially for the battery, and the relatively lower energy 
density of electrochemical energy storage as opposed to 
fossil fuels, which in turn limits the range of electric driving. 
The resulting effect of the current situation is that utilization 
and flow of energy is an even bigger and critical concern for 
electrified powertrains as compared to conventional, 
combustion engine based ones. 
This work builds upon previous results [3], that 
demonstrated an algorithm to determine the optimal route 
with respect to a composite cost function of distance, time, 
energy and battery wear, for a given source location and 
target destination pair in a road network. The approach to 
determination of the optimal route was Bellman‚ÄìFord‚Äì
Moore (BFM) algorithm [4], which builds on the idea of 
dynamic programming applied to the shortest path problem 
[5]-[7]. This algorithm has a bound on worst case 
performance of O(mn) in graph of n nodes and m arcs. 
Another important feature of the previously reported 
approach was that external data sources enabled by the 
benefits of intelligent transportation systems ‚Äì such as road 
topology, traffic and weather could be used as additional 
information to calculate the optimal route.  
To be able to obtain the highest efficiency of hybrid 
electric vehicles, it is a prerequisite to have a combination of 
route guidance, and management of powertrain operation, 
which is a currently unexplored area of work. Past work has 
mainly focused on powertrain management of hybrid 
vehicles alone [8][9], or on determining the optimal path 
between two nodes in a road network with respect to time or 
distance [4] independent of the actual vehicle operation. The 
aim of this paper is to propose an architecture for this 
combination, and initial results, hence build upon previous 
work which focused on route guidance alone [3]. 
It is clear that for large road networks, which run into 
millions of nodes and several millions of arcs [10], it is not a 
straightforward task to compute optimal routes through the 
network, especially considering the fact that external data is 
incorporated into the calculation, and has to be processed in 
real time. For this purpose, it is proposed that the 
computation and memory intensive operations are shifted off 
board from the vehicle, to the cloud, and a simple 
communication strategy ensures that the optimal routing and 
powertrain operation is relayed to the vehicle, which has 
limited computing ability on-board.  
The main theme of this work revolves around an 
integrated system architecture where a hybrid and electric 
vehicle focused route guidance is in constant interaction with 
hybrid powertrain management in a multi-layered fashion. 
The route guidance layer hinges on a model of the vehicle 
and the powertrain to determine energy efficient routes. This 
model, used to calculate costs for traversing the road 
network, is also important for the powertrain management 
29
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-406-0
ENERGY 2015 : The Fifth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

layer since expected future power profile during traversal of 
the route should be utilized to enable predictive powertrain 
management. 
In Section 2, the problem is introduced, and the algorithm 
to find the minimum cost route through the road network, 
and power management is defined. In Section 3, the vehicle 
and powertrain model to calculate the energy costs for road 
network links is presented. In Section 4, the combined route 
guidance and power management algorithm is presented, and 
finally Section 5 gives an application example using a real 
world driving profile recorded from a trip, and the associated 
powertrain management strategy. 
II. 
PROBLEM DEFINITION 
A road network is a directed graph G{N,A}, where N is a 
set of nodes to represent road intersections, and A is a set of 
arcs to represent road segments connecting two nodes. Each 
edge of this graph, i.e., the arcs, represents a pair of 
connected nodes, (i and j), and is associated with a cost cij 
and arc(i,j) ‚àà A. The shortest path is a sequence of arcs (a1, 
a2,‚Ä¶, an) ‚àà A, that minimizes the total cost 
over 
this sequence. The cost, cij is a weighted sum of distance, 
time, energy and battery wear where wx are respective 
weights such that; 
 
 
cij = wd*cd + wt*ct + we*ce + wb*cb . 
 ÔÄ†ÔÄ†ÔÄ†ÔÄ†ÔÄ†ÔÄ®ÔÄ±ÔÄ© 
 
Previous work [3] demonstrated that equal weighting of 
all cost functions provide a well-balanced route in terms of 
time, distance, energy use and battery ageing that can serve 
as a basis for everyday driving. The weights can also be 
adjusted based on preferences of each driver. 
Power management is the control of power and energy 
sources in a hybrid powertrain where the power demand of 
the vehicle is distributed to power providers according to 
pre-defined criteria. Fuel consumption is a widely used 
criterion [8], and the associated cost function can be defined 
as  
 
ùêΩ =  ùëöùëì 
ùë°
0
(ùë°, ùë¢(ùë°))ùëëùë° 
 
ÔÄ®ÔÄ≤ÔÄ© 
where fuel mass flow 
 is minimized over the trip 
duration, t, via determining the optimal control sequence, 
u*. 
Dynamic Programming is a preferred approach for 
optimization based power management for hybrid vehicles, 
and the problem definition is already well covered in the 
literature [8][11].  
III. 
VEHICLE AND POWERTRAIN MODEL 
The vehicle and powertrain architecture selected for 
modeling is a range extended electric vehicle. This 
architecture is a part of the ‚ÄúSeries Hybrid‚Äù family, where 
the combustion engine does not have a direct connection to 
the wheels, but drives a generator to support the electrical 
power network, and charge the battery whenever necessary. 
The main difference of this architecture to a battery electric 
vehicle is addition of a generator, which is comprised of a 
combustion engine, and an e-motor driven by that engine to 
support the power network. The architecture can be seen in 
Figure 1.  
The powertrain components were modeled in a ‚ÄúQuasi-
Static‚Äù fashion based on the concept of [12], which is the 
preferred approach for purposes of energy management and 
control. This approach neglects high frequency dynamics 
irrelevant to energy based modeling, and relies on look-up 
tables of powertrain components (e.g., engine, e-motor etc.) 
to relate power conversion and efficiency in a steady-state 
manner. These look-up tables are validated by test data, and 
dynamics are incorporated to a level they are necessary, 
such as battery state of charge (SoC) behavior, where the 
charge stored in the battery is modeled as a function of 
charge and discharge power of the battery over time, and 
battery voltage is related to SoC and power [13].  
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 1.  Powertrain and Vehicle Model Structure 
The model was parameterized based on publicly available 
data for the Audi A1 e-tron [14], which is a good example 
of a range extended electric vehicle for urban use. The 
parameter set is listed in Table 1. 
TABLE I.  
AUDI A1 E-TRON PARAMETERS 
E-Motor 
Type 
PMSM 
- 
Continuous Power 
45 
kW 
Peak Power 
75 
kW 
Range Extender 
Type 
Wankel Engine 
 
Electrical Power 
15 
kW 
Battery 
Capacity 
12 
kWh 
Voltage 
270 
V 
Vehicle 
Mass 
1410 
kg 
 
30
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-406-0
ENERGY 2015 : The Fifth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

IV. 
ROUTE GUIDANCE AND POWERTRAIN MANAGEMENT 
ALGORITHM 
The overall route guidance and power management 
algorithm consists of a pre-processing and query steps.  
Pre-processing step 
- 
Input: Nodes and arcs of the road network,  
- 
For every arc in the network, periodically carry out the 
following; 
- 
Acquire/load any additional data available for 
the network (e.g., topography, weather, traffic 
etc.). Data collection period depends on the 
type of data (i.e., daily for road work, 5 
minutes for traffic, 15 minutes for weather)  
- 
Calculate the time to traverse each arc (might 
be different due to weather and/or traffic), if 
there is an update from the previous sample 
- 
Run the powertrain model to compute energy 
cost for each link, and post process simulation 
output for battery ageing calculation, as well as 
the composite cost. 
Query step  
- 
For the source and target nodes, calculate the optimal 
path with the least composite cost with BFM algorithm 
- 
Run Dynamic Programming for the optimal path 
utilizing the pre-calculated power profile  
- 
Send the path and range extender on and off command 
coordinates to the vehicle 
The pre-processing step is run periodically for the road 
network of an area, and only the model based cost 
calculation of the step is specific to a particular vehicle, 
whereas the other steps are common for any number of 
vehicles, therefore benefit all vehicles that make use of the 
system. For a particular vehicle (or a family of vehicles 
sharing similar design parameters and powertrains), only the 
last step of pre-processing needs to be carried out, and it 
could also be possible to geographically constrain the 
evaluated arcs for cost calculation, due to the fact that it is 
usually possible to have knowledge of common and recent 
locations for a particular vehicle.  
The link of route determination algorithm with the power 
management is through the vehicle and powertrain model 
and arc cost calculation, where the power demand profile to 
be negotiated in the calculated path was already found when 
calculating arc costs. This power profile is later on used to 
decide when to utilize the generator for range extension as 
part of a 2nd optimization step that is part of the powertrain 
management layer. The overall concept is shown in Figure 2. 
The interaction between the vehicle and the cloud can be 
seen in Figure 3, where the vehicle handles user interface 
functionality to get the source and target locations, and carry 
out the range extender operation reference command based 
on location tracking to the range extender operation 
reference profile. All computations to determine optimal 
routes and range extender operation strategy are carried out 
in the cloud. In the case of relatively short trips, 
communication between the vehicle and the cloud would be 
necessary only once. Further communication to send route 
and range extender operation updates from the cloud could 
be needed for long trips, due to the fact that traffic and 
weather may change during the trip.  
 
 
Figure 2.  Multi Layered Architecture for Powertrain Management  
V. 
APPLICATION EXAMPLE 
The application example is based on a real world 
recorded trip, where the route has been determined 
previously, and power management behavior is evaluated to 
judge feasibility of the approach. The trip route can be seen 
in Figure 4, and is nearly 64 km long. The route includes a 
large variation in altitude and speed, which makes it a good 
candidate to understand behavior of dynamic programming 
based operation control of the range extender.  
 
Figure 3.  System Architecture 
31
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-406-0
ENERGY 2015 : The Fifth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

Figures 5 and 6 show the speed profile used during 
simulations in green (scaled 1/100 to fit in the same graph), 
battery SOC in blue, and finally the generator operation 
command in red (scaled by ¬Ω to fit in the same graph). For 
comparison purposes, the same driving profiles were 
simulated with Charge-Depleting/Charge-Sustaining (CD-
CS) control for generator operation that is used in Plug-in 
Hybrid Electric Vehicles (PHEV) and range extender electric 
vehicles (REEV). This strategy is a rule based one, and 
commonly used in industry as well as serving as the starting 
point for academic work [13]. The strategy is quite 
straightforward and aims to initially use most of the electric 
energy stored in the battery, called the ‚ÄúCharge Depleting‚Äù 
mode, and then switch to conventional hybrid vehicle 
operation, called the ‚ÄúCharge Sustaining‚Äù mode. In this 
second mode, the generator is operated to keep battery SOC 
around a pre-determined level. 
 
Figure 4.  An overview of the route where the real world driving cycle was 
recorded.
0
1000
2000
3000
4000
5000
6000
7000
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
Time - [s]
Battery SOC [Blue], Generator Control/2 [Red], Speed/100 [m/s - Green]
Real World Driving Profile X 2
 
Figure 5.  Figure 1 Generator operation and battery SOC behavior during a 
real world driving profile with CD-CS strategy 
0
1000
2000
3000
4000
5000
6000
7000
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
Time - [s]
Battery SOC [Blue], Generator Control/2 [Red], Speed/100 [m/s - Green]
Real World Driving Profile X 2
 
Figure 6.  Generator operation and battery SOC behavior during a real 
world driving profile that minimizes fuel consumption 
A quick evaluation of the results demonstrate key 
differences between a rule based decision on generator 
operation, and the operation strategy determined via dynamic 
programming. One of the significant differences is the 
starting point for generator operation. CD-CS strategy starts 
to operate the generator whenever the battery SOC drops 
below the pre-determined threshold (set at 30% for these 
simulations) as the name indicates, and continues to operate 
the generator to keep the battery at this threshold. Dynamic 
Programming based algorithm (DP) has knowledge of the 
complete driving profile, as determined already by the 
optimal routing algorithm, therefore starts to operate the 
generator much earlier during the profile to enable balanced 
operation of the battery and the generator as the energy 
source, and the battery reaches the pre-determined threshold 
significantly later during the driving profile. This contributes 
to the fact that battery is operating in a more efficient region 
for the duration of the trip, leading to lower fuel 
consumption, on the order of 3.7%. 
VI. 
CONCLUSION 
We have discussed a novel approach for combined route 
guidance and power management for hybrid and electric 
vehicles, carried out in an on-board/off-board coordinated 
computation architecture. This aspect has not previously 
been explored in literature, and is meant to serve as a starting 
point for further research where the interplay between route 
guidance and powertrain management will be explored in 
detail. 
ACKNOWLEDGMENT 
The authors would like to thank the anonymous reviewers 
for their constructive feedback, which helped improve 
presentation of ideas and overall quality of the paper. 
REFERENCES 
[1] G. Rizzoni, L. Guzzella, and B. M. Baumann, ‚ÄúUnified modeling of 
hybrid 
electric 
vehicle 
drivetrains,‚Äù 
IEEE/ASME 
Trans. 
Mechatronics, vol. 4, no. 3, 1999, pp. 246‚Äì257. 
[2] A. Emadi, K. Rajashekara, S. S. Williamson, and S. M. Lukic, 
‚ÄúTopological Overview of Hybrid Electric and Fuel Cell Vehicular 
32
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-406-0
ENERGY 2015 : The Fifth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

Power System Architectures and Configurations,‚Äù IEEE Trans. Veh. 
Technol., vol. 54, no. 3, May 2005, pp. 763‚Äì770. 
[3] C. Kurtulus and G. Inalhan, "Model Based Optimal Route Guidance 
for Hybrid and Electric Vehicles," unpublished. 
[4] B. V. Cherkassky, A. V. Goldberg, and T. Radzik, "Shortest paths 
algorithms: Theory and experimental evaluation," Mathematical 
programming, vol. 73, no. 2, May 1996, pp. 129-174, 
[5] R.E. Bellman, "On a routing problem," Quarterly of Applied 
Mathematics, vol. 16, 1958, pp. 87‚Äì90. 
[6] L. R. Ford and D. R. Fulkerson, Flows in networks. Princeton: 
Princeton University Press, 1962 
[7] E. F. Moore, "The shortest path through a maze," Proc. Internat. 
Sympos. Switching Theory 1957, Part II. Cambridge, Mass.: Harvard 
Univ. Press, 1959, pp. 285‚Äì292. 
[8] A. Sciarretta and L. Guzzella, ‚ÄúControl of hybrid electric vehicles,‚Äù 
IEEE Control Syst. Mag., vol. 27, no. 2, Apr. 2007, pp. 60‚Äì70. 
[9] S. G. Wirasingha and A. Emadi, ‚ÄúClassification and Review of 
Control Strategies for Plug-In Hybrid Electric Vehicles,‚Äù IEEE Trans. 
Veh. Technol., vol. 60, no. 1, Jan. 2011, pp. 111‚Äì122. 
[10] [Online]. Available http://snap.stanford.edu/data/roadNet-CA.html 
[Accessed: 09-Jan-2015]. 
[11] X. Zhang and C. Mi, "Vehicle Power Management," London: 
Springer-Verlag,  2011, pp 179-208 
[12] L. Guzzella and A. Sciarretta, Vehicle Propulsion Systems: 
Introduction to Modeling and Optimization. Berlin, Germany: 
Springer-Verlag, 2007, p. 350. 
[13] S. Stockar, V. Marano, M. Canova, G. Rizzoni, and L. Guzzella, 
‚ÄòEnergy-Optimal Control of Plug-in Hybrid Electric Vehicles for 
Real-World Driving Cycles‚Äô, IEEE Transactions on Vehicular 
Technology, vol. 60, no. 7, Jan. 2011, pp. 2949‚Äì2962. 
[14] [Online].Available:http://origin-
www.audi.com/etc/medialib/ngw/product/a1/a1/my_2010_catalog_im
ages/pdf.Par.0009.File.pdf/2012_07_ams1512_120.pdf 
[Accessed: 
09-Jan-2015]. 
33
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-406-0
ENERGY 2015 : The Fifth International Conference on Smart Grids, Green Communications and IT Energy-aware Technologies

