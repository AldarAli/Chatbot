Modular Structure of Neural Networks for Classification of Wooden Surfaces with PLC 
Industrial Implementation 
 
Irina Topalova 
Automation of Discrete Production Engineering 
Technical University of Sofia 
Sofia, Bulgaria 
itopalova@tu-sofia.bg 
Alexander Tzokev 
Automation of Discrete Production Engineering 
Technical University of Sofia 
Sofia, Bulgaria 
alextz@tu-sofia.bg 
 
 
Abstract—This paper presents development and research 
results, applying new approaches and means to the design of 
Modular Structure of Neural Network for classification of 
wooden balks (MSNN). It is based on machine vision, unified 
recognition algorithm and modular neural network structure 
for real time operation in a standard Programmable Logic 
Controller (PLC). MSNN is modular, which provides 
possibility for constructing different structures using in 
parallel many neural network function blocks with different 
topologies. It includes development of decision making method 
for 
obtaining 
high 
recognition 
accuracy 
in 
texture 
classification using histograms as input data. The method 
simplicity 
combined 
with 
the 
modular 
performance 
contributes to fast computations and high flexibility of the 
proposed system. The modular MSNN, containing standard 
functional blocks, can find application in different applied 
science fields. 
Keywords 
– 
texture 
classification; 
machine 
vision; 
automation; PLC. 
I. 
 INTRODUCTION  
The main disadvantage of the processes at the enterprises 
for production of high quality wooden items is the lack of 
objective quality control on the textures of the used wooden 
balks before any further treatment process. The identification 
of the type and quality of the balks is accomplished through 
subjective assessment, which leads to a lower material 
utilization factor and lower the quality of the produced items. 
There is a demand for automated visual control, which 
should include the recognition of defects within the whole 
range of produced surface structures and their classification. 
This will result in optimized cutting up and fitting of the 
produced parts. The international state-of-the-art shows that 
the 
company 
“Michael 
Weining-Technowood” 
Ltd, 
Germany [1] is the leading producer that has introduced in 
the woodwork a method for texture quality automated 
control applying optical scanning of the surface and cutting 
optimization with defects elimination. The firm has not 
developed automated selection of wood balks with different 
textures in the process of wedge-shaped splicing, as well as it 
offers complete technological equipment at a very high 
market price. In this case, the use of different visual sensors 
does not contribute to the unification of the used methods for 
recognition. The system is developed in accordance with the 
specific equipment, available at the company.  
A. Current state of similar approaches   
Most research in the wood product industry has been 
applied in the development of automatic visual inspection 
systems for the purpose of grading and edging based on the 
quality of the wood and the presence of defects. These 
technologies use devices such as ultrasound, microwave, 
laser ranging, cameras and spectrometers, which are rather 
expensive. Another wood classification system based on 
several multi - layered - perceptron (MLP) neural network 
models has been developed [2]. The MLP structure has been 
trained by the authors, using 20 input features (Angular 
Second Moment, Contrast, Correlation, Inverse Difference 
Moment, Entropy, etc., for five different image rotations), 
extracted from the texture. In this case, the authors have 
obtained 1sec overall computation time and 95% accuracy. 
The main difference considering our approach is the 
obtained 679 ms computation time and the implementation 
of the method in standard industrial PLC. Another method 
[3,4] for defect detection in textured wood surfaces relies on 
the analysis and fusion of image series with variable 
illumination. This method can be considered as filter-based, 
where the filters or feature detectors are learned from a set 
of training surfaces. It spends 0.5 to 1.6 seconds to process 
an image of 256x256 pixels and is tested in MatLab.  
B. Motivation for the research 
Considering the existing texture classification methods 
[2, 3, 4] and technologies, we came to the conclusion that 
they are not effective for textures having identical structures, 
they need significant computational time, and in the most 
cases cannot obtain high recognition accuracy. The existing 
neural network software for texture recognition is applicable 
for simulating and testing the methods but is not intended for 
implementation in standard modules as PLCs widely used 
for control of different automated technological processes in 
industry.  
The paper structure consists of MSNN and functioning 
modes description, definition of image processing and 
texture feature extraction. As next training of the neural 
network structure is described and the results of the 
recognition of seven wood textures are represented and 
discussed. The results are compared to these obtained by 
13
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

similar approaches. The main benefits of the developed 
system, together with the applied method are discussed.  
II. 
SYSTEM STRUCTURE 
The designed system for texture recognition of wooden 
surfaces with a modular recognition structure of neural 
networks (NN) is implemented in a PLC for real-time 
operation as shown in Fig. 1. The system uses only standard 
devices and interfaces such as a high resolution (Charged 
Coupled Device) CCD camera, standard personal computer 
(PC), Siemens PLC model S317 and technological terminal 
(TT), Siemens Operational Panel (OP) 73 with liquid crystal 
(LC) display. The Siemens proprietary Multi Point Interface 
(MPI) - (based on the standard EIA-485) is used for 
connecting the PC to the PLC. The system functionality is 
described in the next section. 
 
PC
PLC
MPI
TT
...
Pre-processing
NN1n
NN2n
NNmn
NNi
max 
value
FDL
1
2
m
FDL
CCD
H1÷n
H2÷n
Hm÷n
 
Figure 1. Experimental MSNN with PLC implementation 
III. 
FUNCTIONAL MODES 
The system works in two modes – Off line or pre-
processing and training mode; On-line or recognition and 
classification mode.  
In “off-line” mode, after image acquisition of a large 
wooden surface, MxN dimensional grid with M rows and N 
columns is applied on the image. The histogram of each 
MxN cell is calculated and defined as a different class 
parametrical description. The correlation coefficients rij 
between each two classes are calculated according to [5]. All 
classes with rij greater than 0.75 (i.e., they are high correlated 
having almost the same histograms) are attributed to one and 
the same new class. Thus, the cells containing some defects 
will be separated in a different class because of a small 
correlation with the dominant surface background - Fig. 3. 
The class definition is performed with different samples of 
the same texture some of which with different defect 
inclusions. Next step in this mode is training of M different 
neural networks (NNs) with the obtained histograms, 
corresponding to each defined class. The “оff-line” mode 
operation takes place completely in the PC. After finishing 
this mode, the trained NNs are downloaded to the PLC in 
different function blocks.  
In “on-line” mode the chosen MxN grid is applied to the 
current CCD camera acquisition and the histograms are 
calculated for each cell. Each histogram column (1÷n) of the 
same raw (M) is used consecutively as input data to the 
corresponding NNmn in the PLC (Fig. 1). The recognized 
class results in a maximal value at one of the outputs in the 
corresponding NN. Additional logic for the assessment of the 
NN output values and for the finding the maximum one is 
developed in the PLC using ladder diagram technique. In 
case of good homogeneous surface, all NNs give the same 
output with maximum value i.e., one and the same 
recognized class. If a defect or other inhomogeneous area 
exists, the corresponding NNmn recognizes one of its input 
samples as another class. The defected region is defined as a 
cell that is a cross-point between raw (NN number) and 
column (number of the current NN input sample) in the MxN 
grid. A Final Decision Logic (FDL) in the PLC is developed 
to combine grid cell regions, recognized as one and the same 
class and to announce them as corresponding homogeneous 
areas. Finally, the FDL classifies the grid cells with some 
homogeneity variations and all the rest homogeneous areas. 
A technological terminal is used to assign the two system 
modes and display the classification results. FDL results are 
directly usable for the purpose of connecting to the control 
logic, actuating the physical outputs of the PLC. Next step is 
to analyze the feasible combinations between structural 
ranges for wedge-shaped splicing of wooden balks and to 
develop logic for any technological process control. 
IV. 
IMAGE PROCESSING 
The image preprocessing algorithms are executed on a 
separate PC after acquiring the image from the camera. The 
generalized block scheme of these algorithms is presented 
on Fig. 2. These algorithms are very important since the 
recognition of the objects depends on their results, as well as 
on the overall system performance. 
The first step after receiving the image from the camera, 
is to extract the region, which contains only the inspected 
object by applying edge detection algorithms (and 
calculating the rotation angle if required). The second step is 
to segment the image into M rows and N columns. The 
values N and M are user defined and they depend on the 
size of the object and the required texture analysis accuracy.  
After segmenting the image into objects (O), a parallel 
execution of histogram calculation for each object is 
performed. The number of the parallel processes is N. 
Following the parallel calculation of  the histograms, each 
of the results form an input data vector, that is send in serial 
order (OX,0 – OX,N) to the neural network for further 
analyses. 
V. 
NN TRAINING – EXPERIMENTS AND RESULTS 
Each NN in the MSNN is of type multi-layer perceptron. 
Each NN topology was optimized applying the method given in 
[6]. The method is based on changing the number of hidden 
layers, number of neurons in each layer and reducing the mean 
square error (MSE) till all NN outputs have regions, where the 
output stays near to “1” or “-1” as shown in Fig. 4b. Finally, all 
NNs were trained with MSE between 0.05 and 0.1 and different 
 
14
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

 
 
Figure 2. Image preprocessing algorithm 
 
 
  
                  
                      Class2-A                                       Class2-B 
a) 
0
5000
10000
15000
20000
25000
30000
35000
40000
45000
1
19
37
55
73
91
109
127
145
163
181
199
217
235
253
Number of Pixels
Grey Levels
class2-B
class2-A
 
b) 
Figure 3. a) Two cells defined as class2-A and class2-B 
b) The calculated histograms of class2-A and class2-B 
topologies: 42-20-10, 42-50-10, 42-80-10 where 42 (input 
neurons) is the number of sampled histogram values, 80 is 
the chosen optimal number of hidden layer neurons, and 10 
(output neurons) is the number of recognized wooden 
surface classes. Tangent hyperbolic was used as NNs 
transfer function. Each trained NN is downloaded to the 
PLC in a different Function Block (FB) using NeuroSystem 
Run-time tool [7]. When calling the FBs, the NN inputs 
must be provided with the desired values, i.e., the addresses 
of where the inputs are stored should be stated. After being 
processed by the FB, the values written to the outputs are 
read out from the instance Data Block (DB). 
The maximal number of different NNs is 256. The 
classification performance was validated with a histogram 
dataset different from the training dataset. 1100 training 
samples and 100 test samples were used. Fig. 5 shows the 
recognized classes given in Fig. 3, 6 and 7. Each NN1n ÷ 
NN5n recognizes (x) the corresponding sample (column in 
the MxN grid) as a predefined class in the training phase. 
For example the defected texture given in Fig. 3a will be 
recognized as class 2-A in the outputs of NN1n ÷ NN2n for 
all n samples (in our experimental grid n=4) and also for 
samples 3, 4 of NN3n ÷ NN5n. Samples 1, 2 of NN3n ÷ NN5n 
are recognized as class 2-B. The recognition accuracy given 
in % (Fig. 5) is calculated as the overall number of correct 
classifications, divided by the number of samples in the 
testing dataset for each class. 
 
 
 
a) 
b) 
Figure 4. a) Undesirable change of a NN output Z depending on two 
inputs X, Y of the corresponding histograms in training phase 
b) Desirable change of a NN output Z depending on two inputs X, Y of the 
corresponding histograms in training phase 
 
class                
NN
NN1n
NN2n NN3n NN4n NN5n
recognition 
accuracy [%]
class1-A
xxxx
xxxx
x  xx
xxxx
xxxx
88
class1-B
  x
93
class2-A
xxxx
xxxx
   xx
   xx
   xx
98
class2-B
xx
xx
xx
98
class 3
xxxx
xxxx
xxxx
xxxx
xxxx
100
class 4
xxxx
xxxx
xxxx
xxxx
xxxx
100
class 5
xxxx
xxxx
xxxx
xxxx
xxxx
100
 
 
Figure 5. Recognition (x) of a corresponding sample (column in the MxN 
grid) for classes given in Fig. 3,6,7. 
 
Fig. 7a) and b) shows the output values of all NNs 
(m=1÷5) for columns 1 and 3 respectively when recognizing 
texture surface in Fig. 1. For column 3 all NNs give the 
same result, till for column 1, NN31 and NN41 recognize a 
different class. The maximal value of the time needed for 
image acquisition, histogram calculation, and providing the 
15
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

values to the PLC NN Function Block, recognition through 
the trained NN, and sending the result to the text display 
OP73 takes 579 ms on the average with a Siemens PLC 
model S317. The obtained recognition accuracy is between 
93% and 100% for real-time performance in the PLC.A 
complete model for the inspection system is shown on Fig. 
 
 
 
Class 3 
a) 
Class 4 
b) 
Class 5 
c) 
0
10000
20000
30000
40000
50000
60000
70000
80000
1
17
33
49
65
81
97
113
129
145
161
177
193
209
225
241
Number of Pixels
Grey Levels
class3
class4
class5
 
 
Figure 6. a), b) and c) Three cells defined as classes 3,4,5 
d) The calculated histograms of classes 3,4,5 
 
A system prototype has been built in the laboratory 
“Intelligent Manufacturing Systems” at the Technical 
University of Sofia, Bulgaria. 
 
 
 
a) Class1 – B 
b) Class1 – A 
 
0
5000
10000
15000
20000
25000
30000
35000
40000
45000
1
17
33
49
65
81
97
113
129
145
161
177
193
209
225
241
Number of Pixels
Grey Levels
class1-A
class1-B
 
c) 
Figure 7. a) and b) Two cells defined as class1-A and class1-B 
c) The calculated histograms of classes 1-A and 1-B 
 
The system functioning is quasi-parallel because after the 
texture acquisition and image segmentation in mxn cells, the 
histogram calculation goes in parallel, but the histogram 
downloading as input parametrical vectors to the NNs in the 
PLC is accomplished as a serial communication.     
VI. 
COMPARISON OF THE RESULTS 
Many similar approaches [8, 9, 10] have the common 
disadvantage that they are not intended for implementation 
in standard modules as PLCs widely used for control of 
different automated technological processes in industry. The 
results of our research can be compared to the neural 
network approach given in [2]. The proto-type PC-based 
wood recognition system is capable of classifying 30 
different tropical Malaysian woods according to their 
species based on the macroscopic wood anatomy. Image 
processing is carried out using newly developed in-house 
image processing library referred to as “Visual System 
Development Platform”. The textural wood features are 
extracted using a co-occurrence matrix approach. A multi-
layered neural network based on the popular back-
propagation algorithm (BPG) is trained to learn the wood 
samples for the classification purposes. The system can 
provide wood identification within seconds. The results 
obtained show a high rate of recognition accuracy. Several 
MLP models (with different structures) are trained by the 
authors, using 20 input features (Angular Second Moment, 
Contrast, Correlation, Inverse Difference Moment, Entropy 
etc., for five different image rotations), extracted from the 
texture. In this case, the authors have obtained 1sec overall 
computation time and 95% recognition success of 20 
different tropical wood species. But this system is not 
intended for implementing the recognition results in an 
automated system for further process control.    
object-11
object-21
-2
-1.5
-1
-0.5
0
0.5
1
1
2
3
4
5
6
7
8
9
10
NNm1 - Outputs value
NNm1  - Outputs Number
object-11
object-41
object-31
object-21
object-51
 a) 
 
object -13
object -43
-2
-1
0
1
2
1
2
3
4
5
6
7
8
9 10
NNm3 - Outputs Value
NNm3 - Outputs Number
object -13
object -23
object -33
object -43
object -53
 b) 
 
Figure 8. a) Output values of all NNs (m=1÷ 5) for column 1 when 
recognizing texture surface in Fig. 1 
b) Output values of all NNs (m=1÷ 5) for column 3 when recognizing 
texture surface in Fig. 1  
16
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

In our case, the overall computation time is 579 ms and 
the obtained recognition accuracy is between 93% and 
100% for real-time performance in a PLC S7-317. The 
proposed in this paper MSNN system provides that the 
techniques used is suitable to be implemented for industrial 
purposes. The development of additional FDL working in 
“on-line” mode is used for assessment and further logical 
interpretation of NNs outputs at the recognition stage. FDL 
results are directly usable for connecting to the control 
logic, actuating the physical outputs of the PLC. 
 
 
 
Figure 9. Model of the inspection system 
VII. CONCLUSION 
· 
A MSNN is designed, implemented, and proved for 
real-time work on standard PLC SIMATIC S7-317 
instead on FPGA, because PLCs are widely used as 
control devices in automated production.  
· 
The parallel work of many different NNs, which 
number is practically limited to the PLC 
functionality (256 MLP NNs in our case), provides 
a good opportunity for using different texture (or 
objects) parametrical description data as input data 
for the NNs; Additional FDL is developed for 
assessment and further logical interpretation of 
NNs outputs at the recognition stage (in On-line 
mode); 
· 
MSNN has been tested for classification of wooden 
textures. It shows high recognition rate and fast 
performance for the tested samples; 
· 
FDL results are directly usable for connecting to 
the control logic, actuating the physical outputs of 
the PLC. The developed MSNN includes standard 
devices and interfaces and is easily stackable with 
already introduced different automated control 
systems in many automated productions at a low 
price, affordable for small and medium enterprises 
(SMEs). 
 
 
 
 
REFERENCES 
[1] 
http://www.weinig.com/ ,  last accessed on 06.4.2011 
[2] 
Marzuki, K., et al., “Design of an Intelligent Wood Species 
Recognition System”, IJSSST, Vol. 9, No. 3, pp. 9-19, September, 
2008. 
[3] 
Grassi, A.P., et al., “Illumination and model-based detection of 
finishing defects”, Reports on Distributed Measurement Systems, 
Shaker Verlag,  pp. 31-35, 2008. 
[4] 
Puente, F. and Dostert, K., “Reports on Industrial Information 
Technology”, Karlsruhe Institute of Technology, Vol 12, pp. 35-54, 
2010.  
[5] 
Widrow, B. and Stearns, S., “Adaptive Signal Processing”, Prentice-
Hall Inc., Englewood Cliffs, N.J. 07632, pp. 36-40, 2004.   
[6]  Topalova, I. and Tzokev, A., “Automated Classification of Marble 
Plate Textures with MLP-PLC Implementation, International 
Conference on Engineering and Meta-Engineering”, ICEME 2010, 
pp. 115-119, 6-9 April, Orlando, USA, 2010. 
[7]    NeuroSystem V5.0 User Manual, Siemens GmBH, pp. 169-187, 
2005. 
[8]   Iivarinen, J., “Surface defect detection with histogram-based texture 
features”, In SPIE Intelligent Robots and Computer Vision XIX: 
Algorithms, Techniques, and Active Vision, volume 4197, pp. 140–
145, 2000. 
[9]   Brandtberg, T., “Individual tree-based species classification in high 
spatial resolution aerial images of forests using fuzzy sets.” Fuzzy 
Sets and Systems 132(3), pp. 371-387, 2002.  
[10] Tremeau, A. and Borel, N., “A Region Growing and Merging 
Algorithm to Color Segmentation”, Pattern Recognition, Vol. 30, 
No.7, pp. 1191-1203, 1997.  
 
17
ICAS 2011 : The Seventh International Conference on Autonomic and Autonomous Systems
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-134-2

