Data Analysis-Based Gas Identification with a Single Metal Oxide Sensor Operating
in Dynamic Temperature Regime
Nicolas Morati, Thierry Contaret, Jean-Luc Seguin
and Marc Bendahan
Aix-Marseille Univ, Univ Toulon, CNRS, IM2NP
Marseille, 13397, France
e-mails: nicolas.morati@im2np.fr;
thierry.contaret@im2np.fr; jean-luc.seguin@im2np.fr;
marc.bendahan@im2np.fr
Oussama Djedidi and Mohand Djeziri
Aix-Marseille Univ, Univ Toulon, CNRS, LIS
Marseille, 13397, France
e-mails: oussama.djedidi@lis-lab.fr; mohand.djeziri@lis-
lab.fr
Abstract—This paper deals with a preliminary evaluation of a
new data-driven approach aiming to discriminate several gases
in a gas mixture, with a single Metal Oxide (MOX) sensor,
under real conditions of use, i.e. in the permanent presence of a
gas concentration. This method relies on a database obtained
using temperature modulation of the sensor, for fixed gas
concentrations. The database is increased by extracting the
temporal attributes of the signal, and then reduced using
principal
component
analysis
to
extract
only
useful
information. Gas discrimination is achieved by the online
projection of measurements in the principal space consisting of
the two main components. Experimental results obtained on a
test bench show the effectiveness of the proposed approach:
carbon monoxide, ozone and nitrogen dioxide are clearly
discriminated using one single MOX gas micro sensor.
Keywords-MOX
gas
sensor;
temperature
modulation;
temporal attributes; multivariate analysis; gas discrimination.
I.
INTRODUCTION
The quality of outdoor and indoor air has become a very
important health, societal and political issue. The health issue
is recognized by institutions (World Health Organization in
the leading position) and, for populations, air quality has
become a major concern. The most harmful pollutant gases
to health include carbon monoxide (CO), ozone (O3),
nitrogen dioxide (NO2) and sulphur dioxide (SO2). The
variety
of
pollutants
being
large
and
the
harmful
concentrations for health being very low, it has become
imperative to design detection systems that are both highly
sensitive and highly selective. Today, only measurements by
on-site sampling and laboratory analysis can meet these
requirements, but remain expensive and incompatible with
real-time monitoring. The development of highly sensitive,
reliable, portable and low-cost detection systems is still
limited because they are not sufficiently selective. Metal
oxide (MOX) gas sensors are readily available and widely
used in portable and low-cost gas monitoring devices
because of their high sensitivity, stability and attractive
lifetime. However, this type of gas sensor suffers from an
inherent
lack
of
selectivity,
since
the
gas
detection
mechanism is rather nonspecific and more or less any type of
reducing or oxidizing gas is detected. To overcome this low
selectivity, MOX type gas sensors are most often assembled
to form an electronic nose. The electronic nose is a complex
system consisting of a set of multiple sensors, an information
processing unit, software with digital pattern recognition
algorithms, and databases with reference libraries [1][2]. The
challenges of miniaturization and reduction of energy
consumption involve minimizing the number of sensors. For
this purpose, it is necessary to increase the amount of
information
provided
by
one
sensor
using
advanced
measurements,
such
as
temperature
modulation
or
fluctuation enhanced sensing [3]-[5].
The
purpose
of
this
study
is
to
provide
gases
identification methods that can discriminate several gases
with a single MOX sensor, under real conditions of use, i.e.
in the permanent presence of a gas concentration. As a first
step of the study, we report here on the evaluation of a new
method based on temperature modulation of the sensor and
data treatment using temporal attributes of the sensor
response. The used methodology and the experimental set-up
are described in Sections II and III, respectively. In Section
IV, we present the results for three air quality gases (O3, NO2
and CO). Then, the capability of discriminating gases was
evaluated using Principal Component Analysis (PCA). We
conclude the work in Section V.
II.
METHODOLOGY
The methodology is summarized in Figure 1. First, a
database is created by measuring the sensor’s resistance
when modulating its operating temperature for fixed gas
concentrations. Then, the database is increased by extracting
the temporal attributes of the obtained signal, and then
reduced using principal component analysis to extract only
useful information. Gas discrimination is achieved by the
online projection of measurements in the principal space
consisting of the two main components. PCA is a robust and
unsupervised model recognition approach commonly used
for multivariate data analysis. It is a statistical procedure that
converts a set of observations of possibly correlated variables
into a new set of values called principal components. PCA
has proven its effectiveness in many areas of application [6]-
[8], including electronic noses [2].
26
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-766-5
ALLSENSORS 2020 : The Fifth International Conference on Advances in Sensors, Actuators, Metering and Sensing

Figure 1.
Summary of the used methodology.
III.
EXPERIMENTS
In order to obtain a large amount of data, we have chosen
to operate our microsensor in variable temperature mode: the
heating voltage of the sensitive layer is varied triangularly
between two extreme values with a very small voltage step.
The maximum value of the triangular signal will correspond
to the optimal detection temperature for the targeted gases.
The sensor must have a transducer with a fast and efficient
heating system. The sensor used in this study comes from a
new technology developed by the IM2NP laboratory and the
NANOZ-SAS company [9]. The sensor device has two
distinct heaters and four detection zones offering several
operating modes in single or multi-sensors. Figure 2 shows a
picture of the sensor indicating the contact pads for the four
sensors, the two heaters and the ground.
Figure 2.
IM2NP - NANOZ sensor device [9]:1- Contact pads; 2- SiO2
membrane; 3- WO3 sensing layer covering the two heaters and the four
detection zones. The transducer design showing the four sensitive zones
and the two heaters is hidden for copyright reasons.
One of the innovations of our sensor is that the heating
element is located on the same plane as the sensing element,
on a SiO2 membrane. The heaters and sensing electrodes
were first realized in a sputtered platinum thin film using
classical photolithography. Then, the WO3 thin sensing layer
was
deposited
by
reactive
magnetron
radio-frequency
sputtering and annealed at a temperature well above the
operating temperature during two hours to improve its nano-
crystallization and stability. As part of this study, we chose
to operate in single sensor mode according to the diagram in
Figure 3. We note RS1, RS2, RS3 and RS4 the sensor
resistances of the four detection zones, and RH1 and RH2 the
resistances of the two heaters.
Figure 3.
Electrical configuration of the sensor. VS1, VS2, VS3 and VS4 are
the voltage across sensor resistances RS1, RS2, RS3 and RS4, respectively. VH1
and VH2 are the voltage across heating resistances RH1 and RH2,
respectively.
The four sensors are biased at 0.9V using National
Instrument PXIe 4140 source meter. The two integrated
heaters are powered by a staircase waveform of amplitude
0.4V centered on 1.6V, as illustrated in Figure 4. The voltage
value 1.8V allows to heat the sensitive layer at a temperature
of 252 °C. This temperature corresponds to an optimal
detection
of
the
tested
gases.
The
voltage
of
1.4V
corresponds to a temperature of 199 °C, which is the limit of
detection.
The
staircase
waveform
is
generated
by
programming the PXIe 4113 voltage source. The variation
between each step is 10mV and the duration of each step is
1s. The configuration and control of the PXIe devices are
performed with our developed LabVIEW application.
Figure 4.
A period of the voltage applied to the heaters.
27
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-766-5
ALLSENSORS 2020 : The Fifth International Conference on Advances in Sensors, Actuators, Metering and Sensing

The sensor device is placed in a 3D-printed prototype test
chamber developed in the IM2NP laboratory. This chamber
enhances the gas flow hydrodynamics, in particular the gas
concentration
homogeneity
and
the
reduction
of flow
recirculation and dead volumes [10]. To generate gas
concentrations and measure sensor responses, we developed
an experimental test bench shown in Figure 5. The dilution
system provides a concentration range of 200 ppb to 16 ppm
in order to test the limit thresholds of the tested pollutants.
Mixed gases are admitted and evacuated from the test
chamber via distribution valves.
Figure 5.
Experimental set up for micosensor characterization.
IV.
RESULTS
This work is focused on the monitoring of air quality
using metal oxide sensors. The microsensor has been
exposed to three gases related to the air quality: ozone (O3),
nitrogen dioxide (NO2) and carbon monoxide (CO). For each
gas, we have chosen three concentrations close to the
sanitary thresholds (see Table I). The WO3 sensitive thin film
deposited on our specific transducer enables to detect all
these concentrations.
TABLE I.
VARIOUS GASES CONCENTRATION USED IN EXPERIMENTAL
SET UP.
Gases
Concentrations
C1
C2
C3
NO2
200 ppb
400 ppb
800 ppb
O3
80 ppb
110 ppb
160 ppb
CO
2 ppm
8 ppm
16 ppm
For each gas concentration, we proceeded with the
following protocol:

constant exposure of the sensor to a given gas
concentration;

biasing sensors at VS=VS1=VS2=VS3=VS4 = 0.9V.

heating of the sensitive layer at the optimum
detection temperature (VH = VH1 = VH2 = 1.8V)
during 5 minutes;

heating
of
the
sensitive
layer
using
staircase
waveform during four periods of the signal described
in Figure 4;

return to the optimal detection temperature.
In Figure 6, we present an example of the response of the
sensor (bottom curve) to the staircase waveform in thermal
modulation (top curve) for an ozone concentration. We have
obtained similar responses for all gases, but all responses
have
different
signal
parameters.
The
proposed
gas
discrimination method is based on the characterization of the
temporal attributes of the signal, including certain statistical
parameters. Indeed, these mathematical moments enable to
characterize a distribution and are interesting to take into
account when studying transient phenomena. In our case,
they
can
characterize
mechanisms
related
to
gases
adsorption-desorption processes on the surface of the
sensitive layer.
Figure 6.
Example of sensor response (bottom curve) to triangular
temperature variation (top curve) for 160 ppb of O3.
To obtain a sufficient number of variables and to
constitute a statistics database, we calculated the following
temporal attributes for each gas response:

peak to peak value.

mean value.

the root mean square value.

the third standardized moment called skewness.

the fourth standardized moment called kurtosis.

the crest factor.

the shape factor.

the variance.
From the sets of calculated parameters of each gas
concentration,
we
have
evaluated
the
possibility
of
identifying
the
three
studied
gases
using
Principal
Component Analysis. In PCA, the score diagrams show the
relationships between the analyzed
variables (different
concentrations of the three gases in our studies). PCA has
been performed using the Pearson matrix calculation. The
PCA variables are the parameters of the temporal attributes.
All PCA variables have a significant length in the PC1 / PC2
plane. The scores graph of the first two principal components
(PC1 and PC2) is given in Figure 7. We clearly observe three
groups of data. Each group corresponds to a gas. A first
separation can be made according to the component PC1.
28
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-766-5
ALLSENSORS 2020 : The Fifth International Conference on Advances in Sensors, Actuators, Metering and Sensing

The corresponding CO data have a strongly positive PC1,
while the NO2 and O3 have negative PC1 values.
Figure 7.
PCA scores plot.
The component PC2 makes it possible to separate these
two gases. Indeed, the values of O3 have a negative value of
PC2. Conversely, the values for NO2 have a positive value
on PC2. The results of the PCA show that a clear distinction
is possible between the three studied gases. Our results are
consistent with other studies which have shown that the
staircase waveform to modulate the temperature of sensing
layer was the most effective to distinguish several gases with
one single sensor [4].
V.
CONCLUSION AND FUTURE WORK
In this paper, we have presented a preliminary evaluation
of a new gases identification method aiming to discriminate
several gases with a single MOX sensor, under real
conditions of use, i.e. in the permanent presence of a gas
concentration.
This
method
is
based
on
temperature
modulation of the sensing layer of the sensor, for a fixed gas
concentration, followed by data treatment using temporal
attributes
of
the
sensor
response.
Finally,
the
PCA
multivariable analysis method, applied to all data, has shown
that it is possible to discriminate NO2, O3 and CO using one
single MOX sensor.
After this preliminary step, more work is in progress in
order to:

study whether the number of temporal attributes can
be reduced;

increase
the
database
by
adding
more
gas
concentrations and mixing the gases with each other
and with humidity;

apply and test classification algorithms such as
Support Vector Machines, k Nearest Neighbors or
Neural Networks.
ACKNOWLEDGMENT
Nicolas Morati would like to thank Région Sud of France
and Nanoz SAS for financial support. We also thank Tomas
Fiorido for his technical support throughout this work.
REFERENCES
[1]
J. Gutiérrez and M.C. Horrillo, “Advances in artificial
olfaction: sensors and applications”, Talanta, vol. 124, pp.
95–105, 2014.
[2]
W. Hu et al., “Electronic Noses: From Advanced Materials to
Sensors Aided with Data Processing”. Advanced Materials
Technologies,
vol.
4,
2019,
1800488.
https://doi.org/10.1002/admt.201800488.
[3]
J. M. Smulko et al., “New approaches for improving
selectivity and sensitivity of resistive gas sensors: a review.”
Sensor
Review,
vol.
35,
pp.
340–347,
2015.
https://doi.org/10.1108/SR-12-2014-0747
[4]
S. M. Hosseini-Golgoo, F. Salimi, A. Saberkari, and S.
Rahbarpour, “Comparison of information content of temporal
response of chemoresistive gas sensor under three different
temperature modulation regimes for gas detection of different
feature reduction methods.” J. Phys.: Conf. Ser. 939, 2017,
012005. https://doi.org/10.1088/1742-6596/939/1/012005
[5]
S. Gomri et al., “A Noise Spectroscopy-Based Features
Extraction Method to Detect Two Gases Using One Single
MOX Sensor”, IEEE Sensors Journal, Vol.19, No.20, pp.
9063-9070, 2019, DOI: 10.1109/JSEN.2019.2923699
[6]
M. A. Djeziri, S. Benmoussa, and R. Sanshez. "Hybrid
method for remaining useful life prediction in wind turbine
systems. " Renewable Energy, vol. 116, pp. 173-187, 2018.
[7]
L. Nguyen, M. A. Djeziri, B. Ananou, M. Ouladsine, and J.
Pinaton. "Fault prognosis for batch production based on
percentile measure and gamma process: Application to
semiconductor manufacturing". in Journal of Process Control,
Vol. 48. pp. 72-80, 2016.
[8]
L. Nguyen, M. A. Djeziri, B. Ananou, M. Ouladsine, and J.
Pinaton. “Health Indicator Extraction for Fault Prognosis in
Discrate Manufacturing Processes”, IEEE Transaction on
Semiconductor Manufacturing, vol.28, no. 3, pp. 306-317,
2015.
[9]
K. Aguir, M. Bendahan, and V. Laithier, “Heated sensitive
layer gas sensor” patent N◦FR 13 59494, 2013, international 
extension in 2016, US20160238548
[10] F. E. Annanouch et al., “Hydrodynamic evaluation of gas
testing
chamber:
Simulation,
experiment”,
Sensors
&
Actuators: B. Chemical, vol. 290 pp. 598–606, 2019 DOI:
10.1016/j.snb.2019.04.023
29
Copyright (c) IARIA, 2020.     ISBN:  978-1-61208-766-5
ALLSENSORS 2020 : The Fifth International Conference on Advances in Sensors, Actuators, Metering and Sensing

