Pose Identification and Updating in Autonomous Vehicles 
 
Antoni Grau, Yolanda Bolea 
Automatic Control Dept. 
Technical University of Catalonia, UPC 
Barcelona, Spain 
e-mail: {antoni.grau;yolanda.bolea}@upc.edu 
Rodrigo Munguia 
Computer Science Dept. 
University of Guadalajara 
Guadalajara, Mexico 
e-mail: rodrigo.munguia@upc.edu
 
 
Abstract—In this paper, a novel algorithm to know the pose of 
any autonomous vehicle is described. Such a system (Attitude 
and Heading Reference System, AHRS) is essential for real 
time vehicle navigation, guidance and control applications. For 
low funded projects, with simple sensors, efficient and robust 
algorithms become necessary for an acceptable performance, 
and the well-known extended Kalman filter (EKF) fulfills those 
requirements. In this kind of applications, the use of the EKF 
in direct configuration has been much less explored than its 
counterpart, the EKF in indirect configuration. Specifically, in 
this paper a novel method based on an Extended Kalman 
Filter in direct configuration is proposed, where the filter is 
explicitly derived from both kinematic and errors models. 
Experiments with real data show that the proposed method is 
able to maintain an accurate and drift-free attitude and 
heading estimation.  
Keywords—Attitude Estimation; Sensor Fusion; Vehicle 
Navigation. 
I. 
 INTRODUCTION 
Autonomous Vehicle applications (Unmanned Ground 
Vehicles, Micro-Air Vehicles, Unmanned Aerial Vehicles 
(UAV), and Marine Surface Vehicles) all require accurate 
position and attitude to be effective [1]. While navigation 
grade Inertial Measurement Units (IMU) have existed for 
many years, they remain very expensive, and out of reach 
both in terms of cost and payload for all but the best funded 
projects. Small UAVs, even if the can afford the cost, cannot 
supply the necessary power to these units. A combination of 
instruments capable of maintaining an accurate estimate of 
the vehicle attitude, while it maneuvers, is called Attitude 
and Heading Reference System (AHRS). The first AHRS 
implementations were based only in gyroscopes. Gyros are 
prone to bias, which could produce large errors after long 
periods of integration. Filtering techniques are often required 
if less reliable (low-cost) gyros are used. Using filtering 
techniques, 
other 
sensors 
(i.e., 
accelerometers 
and 
magnetometers) can be combined with gyros in order to limit 
the attitude errors in time. With the availability of hardware 
(i.e., 
MEMS 
sensors 
and 
microcontrollers) 
several 
approaches for AHRS systems in the literature have been 
appearing, especially in the last decade. Nowadays, AHRS 
are typically based on gyros that are updated by gravity 
sensors (i.e., accelerometers) for pitch and roll and by 
magnetic field sensors for yaw. Nevertheless, depending on 
the application, it is common to find approaches relying in 
alternative sensors for bounding attitude errors in time, [2]-
[5].  
Several estimation techniques have been used for attitude 
determination. Schemes presented in [2] and [3] use Linear 
Filtering and Iterated least-squares methods, respectively. 
The linear Kalman filter (KF), commonly used for estimating 
the system state variables and for suppressing the 
measurement noise has been recognized as one of the most 
powerful state estimation techniques. Some methods relying 
on linear Kalman Filtering are presented in [5][6]. 
There are two basic ways for implementing the EKF: 
total state space formulation (also referred to as the direct 
formulation) and error state space formulation (also referred 
as the indirect formulation).  
EKF in indirect formulation estimates a state vector 
which represents the errors between the estimated state and 
the estimated nominal trajectory. The measurement in the 
error state space formulation is made up entirely of system 
errors and is almost independent of the kinematic model. 
Most of the approaches follow this kind of configuration 
[4][7][8]. The differences among those methods mainly 
consist of variations in the design of the error models. 
In EKF, in direct configuration the vector state is updated 
implicitly with the predicted state and the measurement 
residual (the difference between the predicted and current 
measurement). In this kind of EKF configuration, the system 
is essentially derived from the system kinematics. One of the 
characteristics of the direct configuration is its conceptual 
clarity and simplicity. In addition, it is possible to found 
other methods which rely in variations of Kalman filtering as 
the Unscented Kalman filtering [9]. Another interesting 
family of methods for attitude estimation is the nonlinear 
observers [10], but unsuitable for this research due to high 
computation load and real time purposes. 
In a previous work [11], an uncoupled approach is 
presented. In that method, an EKF in direct configuration 
derived from the kinematic model estimates the attitude of 
the device, whereas an extra KF derived from the error 
sensor model estimates the gyro bias. However, the main 
drawback for the previous architecture was not to use 
optimally the full information available in the system 
covariance matrix. These data are useful to make a finest 
estimation of the system errors. As a consequence, some 
parameters had to be artificially tuned in order to improve 
the performance of the method.  
87
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-581-4
SENSORDEVICES 2017 : The Eighth International Conference on Sensor Device Technologies and Applications

This paper describes a novel algorithm for implementing 
an Attitude and Heading Reference System based on an 
Extended Kalman Filter in direct configuration. In this 
approach, the filter is explicitly derived from both the 
kinematic and error models. One of the advantages of the 
proposed approach is due to the clarity and simplicity 
associated with the implementation of the EKF in direct 
configuration. Section II describes the proposed method and 
the novel system architecture. Results with real data are 
presented in Section III, and some conclusions and future 
work are presented at the end of the paper.  
II. 
METHOD DESCRIPTION 
A. Vector state and system specification 
The goal of the proposed method is the estimation of the 
following system state x̂: 
ˆx
x
nb
b
g
q
ω
′


= 
                             (1) 
where qnb = [q1,q2,q3,q4] is a unit quaternion representing 
the orientation (roll, pitch and yaw) of the body (device); ωb 
= [ωx ωy ωz] is the bias-compensated velocity rotation of the 
body expressed in the body frame; xg = [xg_x xg_y xg_z] is the 
bias of gyros.  
In this work, the axes of the coordinate systems follow 
the North, East, Down (NED) convention. For simplicity, the 
orientation of the body follows Euler angles α, β and γ 
denoting respectively roll, pitch and yaw, respectively. Euler 
angles can be computed from quaternion qnb. 
In order to estimate the system state x̂, measurements 
obtained with an IMU of 9-DOF are considered. The IMU is 
formed by a 3-axis gyroscope, a 3-axis accelerometer, and a 
3-axis magnetometer. 
1) Gyroscope measurements 
The angular rate ωb of the vehicle, measured by the gyros 
(in the body frame) and indicated as yg, can be modeled by:  
                           
xg
b
g
g
y
v
= ω
+
+
                              (2) 
where xg is an additive error (bias) and vg is a Gaussian 
white noise with power spectral density (PSD) σg2.  
2) Accelerometer measurements 
The acceleration of the device ab, measured by the 
accelerometers (in the body frame) as ya, can be modeled by: 
                          
xa
b
a
a
b
y
a
g
v
=
−
+
+
                         (3) 
where gb is the gravity vector expressed in the body 
frame, xa is an additive error (bias), and va is a Gaussian 
white noise with PSD σa2. Bias in accelerometers triads are 
often relatively small, thus in this work it is neglected. 
Magnetometer measurements: The earth field mb 
measured (in the body frame) as ym can be modeled by: 
                             
xm
m
b
ym
m
v
=
+
+
                            (4) 
where vm is a Gaussian white noise with PSD σm2. 
Magnetometer bias xm could be fairly large but extremely 
slow time varying; therefore in this work it is not considered 
for online estimation; instead a calibration technique, as the 
presented one in [10], could be used for setting its initial 
value. 
B. Architecture of the system 
Figure 1 shows the architecture of the system which is 
defined by the typical loop of prediction-update steps in the 
EKF in direct configuration:  
System Prediction: Prediction equations propagate along 
the time the estimation of the system state, by means of the 
measurements 
obtained 
from 
gyroscopes. 
Prediction 
equations offer correct estimates at high frequency, but only 
for a short period of time. 
System Update: The unavoidable small errors in gyro 
readings produce large errors in attitude estimation after long 
periods of integration. The use of aiding sensors capable of 
measuring external references becomes essential in order to 
limit the estimation error. In this work, the gravity vector g 
and the magnetic earth field m are used as external references 
for correcting roll, pitch and yaw estimations: 
i) During the periods when the device is in a non-
accelerating mode (variable rate), information about the 
attitude of the device-vehicle (roll and pitch) is incorporated 
into the system by means of the observation of the gravity 
vector.  
ii) Information about the heading (yaw) of the device-
vehicle is incorporated into the system (at a predefined 
constant rate) by means of the observation of the earth 
magnetic field.  
System Prediction: At every step k, when gyroscope 
measurements are available, the system state x̂  is updated by 
the following (discrete) nonlinear model. 
              
(
)
(
)
(
)
4 4
(
1)
( )
(
1)
( )
( )
g(k 1)
g(k)
sin
w
cos
w
I
W
w
x
x
(1-
)x
nb
nb
k
k
b
k
g k
g k
xg
q
q
y
t
ω
λ
×
+
+
+






+










=
= −
−
=
∆
       (5) 
In the model represented by (5), a closed form solution of 
q̇  = 1/2(W)q is used for integrating the current bias-
compensated velocity rotation ωb over the quaternion qnb. In 
this case w = [ωb(k+1)∆t/2]´ and: 
                         
1
2
3
1
3
2
2
3
1
3
2
1
0
-w
-w
-w
w
0
-w
w
W
w
w
0
-w
w
-w
w
0






= 





                   (6) 
Also an alternative kinematic model for modeling the 
orientation of a camera by a quaternion can be found in a 
previous authors’ work, [12]. Parameter λxg is a correlation 
time factor which models how fast the bias of gyro is 
varying. ∆t is the sampling time of the system. 
The state covariance matrix P is taken a step forward by: 
             
(
1)
( )
k
x
k
x
u
u
P
F P
F
F U
F
+
′
′
= ∇
∇
+ ∇
∇
             (7) 
88
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-581-4
SENSORDEVICES 2017 : The Eighth International Conference on Sensor Device Technologies and Applications

The measurement noise of gyroscope vg is incorporated 
into the system by means of the process’ noise covariance 
matrix U, through parameter σg2: 
              
2
2
3 3
3 3
g
xg
U
diag
I
I
σ
σ
×
×
=



                      (8) 
 
The full model used for propagating the sensor bias error 
is: biask+1=(1-λ∆t)biask + vb, where vb models the uncertainty 
in the bias drift. The uncertainty in bias for gyro vxg is 
incorporated into the system through the noise covariance 
matrix U via PSD parameter σxg2.  
0
0
0
x
x
0
0
x
x
nb
nb
nb
b
b
g
g
g
F
fq
fq
q
f
f
ω
ω










∇










∂
∂
∂
∂
∂
=
∂
∂
∂
     
xg
0
0
0
y
x
0
b
u
g
g
F
f
f
v
ω










∇










= ∂
∂
∂
∂
    
(9)
 
The Jacobian ∇Fx is formed by the partial derivatives of 
the nonlinear prediction model, (5), with respect to the 
system state x̂. In Jacobian notation, "∂fx/∂y" is used for 
partial derivatives and it must be read as the partial 
derivative of the function f (which estimates the state 
variable x) with respect to the variable y. Jacobian ∇Fu is 
formed by the partial derivatives of the nonlinear prediction 
model, (5), with respect to the system inputs. 
A. System Updates 
The filter can be updated as follows: 
                     
1
ˆ
ˆ
x
x
(
)
k
k
i
i
W z
h
+
=
+
−
                         (10) 
                           
1
k
k
i
P
P
WSW
+
′
=
−
                            (11) 
where zi is the current measurement and hi = h(x̂) is the 
predicted measurement; W is the Kalman gain computed 
from:  
1
k 1
i
i
W
P
H S −
+
′
=
∇
                             (12) 
Si is the innovation covariance matrix: 
1
i
i
i
i
k
S
H P
H
R
+
′
∇
= ∇
+
                        (13) 
∇Hi is the Jacobian formed by the partial derivatives of 
the measurement prediction model h(x̂) with respect to the 
system state x̂. Ri is the measurement noise covariance 
matrix. Equations (10) to (13) will be used for system 
updates together with the proper definitions of zi, hi, ∇Hi and 
Ri.  
1) Roll and pitch updates 
If the device is not accelerating, (i.e., ab ≈ 0), then (3) can 
be approximated as ya ≈ −gb + va (xa is neglected). In this 
situation, accelerometer measurements ya provide noisy 
observations about the gravity vector (in the body frame). 
The gravity vector g is used as an external reference for 
correcting roll and pitch estimations.  
In order to detect the time (corresponding to k instants) 
that the body is in a non-accelerating mode, the Stance 
Hypothesis Optimal Detector (SHOE) is used [13].  
The gravity vector g is predicted to be measured by the 
accelerometers as hg: 
                             
0
R
0
nb
g
c
h
g




=





                                  
(14)
 
where gc is the gravity constant and Rnb is the navigation 
to body rotation matrix computed from the current 
quaternion qnb.  
 
Figure 1.  System architecture defined by an EKF in direct configuration. 
89
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-581-4
SENSORDEVICES 2017 : The Eighth International Conference on Sensor Device Technologies and Applications

If the device is not accelerating and a minimum period 
(corresponding to t1 seconds) have elapsed since the last roll 
and pitch update, then the filter is updated (using (10) to 
(13)) with: 
 
i
a
z
= y
  
i
g
h
= h
    
2
3 3
a
I
iR
× σ
=
   
ˆx
i
g
H
h
∇
= ∂
∂      (15) 
1) Yaw updates 
The model hγ used for predicting the heading (yaw) of the 
device is defined as: 
       
(
)
2
2
2
3
1
4
3
4
atan2 2(
),1
2(
)
h
q q
q q
q
q
γ =
−
−
+
      (16) 
where qnb=[q1,q2,q3,q4] is the current quaternion; atan2 
is a two-argument function that computes the arctangent of 
y/x given y and x, within the range [-π, π].  
As it can be observed in (16), the model does not predict 
the earth magnetic field to be measured. Instead, the model 
directly predicts the yaw angle to be measured. The idea of 
the selection of this measurement prediction model is due to 
the scalability of the system. In this sense, an alternative 
measurement device could be directly attached to the AHRS 
in order to correct the heading estimations. 
In order to use the proposed measurement prediction 
model hγ in the 3-axis magnetometer which is included in the 
9-DOF IMU, a yaw measurement zγn is obtained from the 
measured magnetic field ym.  
Due to the angle of inclination of the magnetic field 
vector, the measured magnetic vector is first projected to the 
north-east plane, by removing its z component: 
    
n
bn
m
m
= R y
                                   (17) 
    
1
[
0]
n
n
n
x
y
m
m
m
=
                           (18) 
where mn=[mxn, myn, mzn] and Rbn is the body to 
navigation rotation matrix computed from the current 
quaternion qnb. The magnetic field vector mn1 (expressed in 
the navigation frame), from which the z component has been 
removed, is projected back to the body frame by: 
    
1
b
nb
n
m
= R m
                                   (19) 
where mb=[mxb, myb, mzb] and Rnb is the navigation to 
body rotation matrix computed from the current quaternion 
qnb. Finally, the measured yaw zγn is obtained by: 
    
(
)
atan2
,
n
b
b
y
x
z
m
m
γ
=
−
                        (20) 
In this work it is assumed that the angle of declination of 
the magnetic field is ignored or is previously known. 
Measurements zγn are assumed to be corrupted by Gaussian 
white noise vγ with PSD σγ2. 
At constants intervals of t2 seconds the filter is updated 
(using (10) to (13)) with: 
  
n
iz
= zγ
       
ih
= hγ
     
2
iR
=σγ
     
ˆx
Hi
hγ
∇
= ∂
  (21) 
III. 
EXPERIMENTAL RESULTS 
In order to validate the performance of the proposed 
method, a comparative study with real data is presented. In 
this case, the output estimated by the proposed algorithm 
(Direct method) is compared with the output obtained from 
the method described in [14], which is based in an EKF in 
indirect formulation (Indirect method). For the comparative 
study, the output obtained from a commercial 3DM-
GX3®45 AHRS unit is considered as the ground truth. This 
unit can be easily mounted in any ground vehicle. 
For each test the 3DM-GX3®45 was randomly gyrate 
while it was held in a hand. At the same time, raw data 
obtained 
from 
the 
accelerometers, 
gyroscopes 
and 
magnetometers included in the unit, along with the attitude 
computed by the same unit, were recorded in a plain text file 
at a frequency of 100 Hz. Several data captures were carried 
out trying to cover different dynamic circumstances like 
periodic and soft turns as well as random and strong shakes. 
Each capture lasts about 3 minutes. 
A MATLAB implementation of both, the proposed 
approach (Direct method), as well as the Indirect method 
were executed in off-line mode, using the raw sensor data 
stored in the plain text files as input signals. The execution 
time was: i) Direct method = 736 microseconds/step, ii) 
Indirect method = 586 microseconds/step. It is important to 
note that for the Indirect method the size of the system state 
is 6 (actual rotational velocity is not included), instead of 9. 
So (as is typical in EKF applications) difference in execution 
time should be mostly related with the size of the system 
state.  
The outputs obtained with: i) the Direct method, ii) the 
Indirect method and iii) the 3DM-GX3®45 unit have been 
compared. In experiments the mean absolute error (MAE) 
was used for comparing the performance of both methods: 
1
1
MAE
n
k
k
k
f
y
n
=
=
−
∑
 
where n is the number of samples, fk is the angle 
measured by the 3DM-GX3®45 unit at instant k, and yk is 
the angle estimated by a method at instant k. In experiments, 
for clarity purposes, Euler angles are obtained every time 
that they are needed from the current estimated quaternion 
qnb. 
For the comparative study two aspects were evaluated: 
a) The performance of the methods for estimating the 
gyro bias xg. That is, the ability of the filters to converge 
when the initial conditions differ considerably from the 
actual value, in order to minimize the error in estimations.   
b) The performance of the methods when the frequency 
of operation is reduced (or the sample time is increased).   
For the case (a), the methods were executed over the 
input signals stored in the plain text files. After that, the 
methods were run again over the same input signals, but 
artificially introducing a huge extra bias xg(a) into each gyro 
measurement yg, so that: yg = ωb + xg + vg + xg(a), see (2). In 
experiments xg(a) = [.05  -.05  .025] radians.  
For the case (b), the methods were first executed over all 
the samples captured. After this operation, the methods were 
executed again but in this case periodically skipping samples 
in order to emulate different frequencies of operation. In this 
case, 100Hz, 50Hz and 25Hz were considered.  
Table I shows the average MAE obtained with the Direct 
method and the Indirect method for several captures of data 
(considering all the conditions previously described). As it 
can be appreciated, the computed MAE is in general very 
90
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-581-4
SENSORDEVICES 2017 : The Eighth International Conference on Sensor Device Technologies and Applications

similar for both methods. In a more detailed observation, the 
Direct method performs slightly better for converging (and 
thus minimizing the error in estimation) when an initial huge 
gyro bias is present. On the other hand, the Indirect method 
shows a slightly better response at very low frequency of 
operation. 
Figure 2 shows the progression over time for the 
estimations obtained with the Direct and the Indirect 
methods, for a test with random turns and strong shakes. The 
plots correspond to the response of both methods when an 
extra gyro bias and a frequency of operation of 100Hz are 
considered. In Figure 2, at the beginning of the test (before 
second 30th) it can be clearly appreciated the adverse effect 
in the estimated roll, pitch and yaw due to the integration of 
the contaminated gyro measurements (observe the absolute 
error corresponding to this period). However, the estimated 
gyro bias rapidly converges to its actual value due to the 
system updates carried out in the filters. When the gyro bias 
is estimated then the absolute error is minimized. For this 
test, also it can be appreciated that the convergence of the 
Direct method is faster than the Indirect Method, thus 
accelerating the minimization of errors estimation. 
 
TABLE I 
MEAN ABSOLUTE ERROR (DEGREES) 
No extra bias 
100Hz 
50 Hz 
25 Hz 
Roll  (Direct) 
0.65 
0.84 
2.62 
Roll (Indirect) 
0.66 
0.83 
2.50 
Pitch (Direct) 
0.36 
0.58 
1.80 
Pitch (Direct) 
0.35 
0.56 
1.74 
Yaw (Direct) 
0.68 
0.96 
2.42 
Yaw (Indirect) 
0.81 
1.02 
2.10 
Extra Bias 
100Hz 
50 Hz 
25 Hz 
Roll  (Direct ) 
1.12 
1.28 
3.01 
Roll (Indirect) 
1.39 
1.54 
2.92 
Pitch (Direct) 
0.87 
1.07 
2.30 
Pitch (Direct) 
0.98 
1.19 
2.33 
Yaw (Direct) 
2.52 
3.52 
5.76 
Yaw (Indirect) 
3.10 
3.33 
5.21 
IV. 
CONCLUSION AND FUTURE WORK 
This work presents a practical method for implementing 
an attitude and heading reference system that can applied to 
autonomous vehicles for an automatic navigation. The 
architecture of the system is based on an Extended Kalman 
filtering approach in direct configuration. Experiments with 
real data show that the proposed method is able to maintain 
an accurate and drift-free attitude and heading estimation. 
Moreover, it is capable of estimating the parameters of 
sensors error (i.e., gyro bias) in a robust manner, thereby 
improving the system estimations even when the quality of 
the measurements obtained from gyros is very poor.  
Therefore, the accuracy of the estimates is almost only 
limited by the pre-calibration of accelerometers and 
magnetometers. Based on the experimental results, it is 
considered that the method is enough robust for its use along 
with low-cost sensors. The modularity of the proposed 
architecture permits the scalability of the system. In such a 
case, an alternative measurement device could be easily 
attached to the system (replacing the magnetometers) in 
order to correct the heading estimations. 
The EKF in general is not an optimal estimator (owned to 
its linearization nature). In addition, if the process is modeled 
incorrectly, the filter may quickly diverge. Also, it has been 
seen that the EKF tends to underestimate the true covariance 
matrix and therefore the filter could become inconsistent. 
ACKNOWLEDGMENT 
This work has been funded with project CICYT 
DPI2016-78957-R AEI/FEDER/UE. 
REFERENCES 
[1] 
G.H. Elkaim, “The Atlantis Project: A GPS-Guided Wing-Sailed 
Autonomous Catamaran”, Journal of the Institute of Navigation, 
53(4), 237–247, 2006. 
[2] 
D. Gebre-Egziabher, R. C. Hayward, and J. D. Powell, "Design of 
multi-sensor attitude determination systems," IEEE Transactions on 
Aerospace and Electronic Systems 40(2), 627- 649, April 2004. 
[3] 
F. L. Markley, "Attitude error representations for Kalman filtering", 
Journal of guidance control and dynamics 26, 311-317, 2003. 
[4] 
J. F. G. Castellanos, S. Lesecq, N. Marchand, and J. Delamare, "A 
low-cost air data attitude heading reference system for the tourism 
airplane applications," IEEE Sensors, vol. 1, 44-47, 2005.  
[5] 
M. Euston, P. Coote, R. Mahony, K. Jonghyuk, and T. Hamel, "A 
complementary filter for attitude estimation of a fixed-wing UAV," 
Intelligent Robots and Systems, 2008, 10.1109/IROS.2008.4650766.  
[6] 
L. Wang, S. Xiong, Z. Zhou, and J. Lan, "Constrained Filtering 
Method for MAV Attitude Determination", IEEE IMTC Conf., 2005, 
10.1109/IMTC.2005.1604397. 
[7] 
Mei Wang, Yunchun Yang, R. R. Hatch, and Yanhua Zhang, 
"Adaptive filter for a miniature MEMS based attitude and heading 
reference system," Position Location and Navigation Symp. 2004, 
10.1109/PLANS.2004.1308993 
[8] 
Young Soo Suh, "Orientation Estimation Using a Quaternion-Based 
Indirect Kalman Filter With Adaptive Estimation of External 
Acceleration," IEEE Trans on Instrumentation and Measurement 
59(12), 3296-3305, 2010. 
[9] 
H.G. de Marina, F.J. Pereda, J.M. Giron-Sierra, and F. Espinosa, 
“UAV Attitude Estimation Using Uncented Kalman Filter and 
TRIAD”, IEEE Trans on Ind. Electronics 59(11), 4465-4474, 2012. 
[10] J. F. Vasconcelos, G. Elkaim, C. Silvestre, P. Oliveira, and B. 
Cardeira, "A Geometric Approach to Strapdown Magnetometer 
Calibration in Sensor Frame", IFAC Workshop Navigation, Guidance 
and 
Control 
of 
Underwater 
Vehicles, 
2008, 
10.1109/TAES.2011.5751259 
[11] R. Munguia, and A. Grau, "An Attitude and Heading Reference 
System (AHRS) based on a Dual Filter", IEEE Conference on 
Emerging Technologies and Factory Automation ETFA 2011, 
10.1109/ETFA.2011.6059089  
[12] R. Munguia, and A. Grau, “Closing Loops With a Virtual Sensor 
Based on Monocular SLAM”, IEEE Trans on Instrumentation and 
Measurement  58(8), 2377-2384, 2009. 
[13] I. Skog, P. Handel, J. O. Nilsson, and J. Rantakokko, "Zero-Velocity 
Detection An Algorithm Evaluation," IEEE Trans on Biomedical 
Engineering 57(11), 2657-2666, 2010. 
[14] J. Farrell, Aided Navigation, Mac Graw-Hill, 2008. 
 
 
91
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-581-4
SENSORDEVICES 2017 : The Eighth International Conference on Sensor Device Technologies and Applications

 
 
Figure 2. Estimation results for a test with random turns and strong shakes with a duration about 170 seconds. 
92
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-581-4
SENSORDEVICES 2017 : The Eighth International Conference on Sensor Device Technologies and Applications

