Balanced Reduction of an IDE-based Spatio-Temporal Model
Kenneth Scerri∗, Michael Dewar†, Parham Aram‡, Dean Freestone§ Visakan Kadirkamanathan‡, David Grayden§
∗Department of Systems and Control Engineering, University of Malta, Msida, Malta
Email: kenneth.scerri@um.edu.mt
†Department of Applied Physics and Applied Mathematics, Columbia University, New York, USA
‡Department of Automatic Control and Systems Engineering, University of Shefﬁeld, Shefﬁeld, UK
§Department of Electrical and Electronics Engineering, University of Melbourne, Melbourne, Australia
Abstract—Spatio-temporal models have the potential to rep-
resent a wide variety of dynamic behaviour such as the growth
of bacteria, the dispersion of a pollutant or the changing spatial
patterns in house prices. Classical methods for the simulation
of such behaviours suffer from large computational demands
due to their high dimensionality. Recent advances in spatio-
temporal modelling have proposed a method based on a state-
space representation of the spatio-temporal integro-difference
equation. Although the dimension reduction obtained when
using this model is signiﬁcant, it is frequently not sufﬁcient
for online computation or rapid simulation. Thus this model
is revisited in this work and a method for further dimension
reduction based on a balanced realization of the state-space
model is developed. The results will show that the computa-
tional cost reduction obtained is signiﬁcant at the expense of
a minor loss in accuracy.
Keywords-spatio-temporal simulation, balanced model reduc-
tion, integro-difference equation.
I. INTRODUCTION
Various natural phenomena in a wide spectrum of scien-
tiﬁc disciplines exhibit complex interactions over both space
and time. These interactions are particularly common in
biology, ecology, meteorology, epidemiology, physics, en-
vironmental science and economics. Broad ranging methods
have been used to describe spatio-temporal behaviour. For
example, in physics, reaction-diffusion processes have been
successfully modelled via Coupled Map Lattices (CML)
with parameters estimated directly from data [1], [2]. Geo-
statistical spatio-temporal models have also been estimated
from data in both ecological applications such as the moni-
toring of pollution [3] and in meteorology for, among others,
the modelling for rainfall [4] and wind behaviour [5], [6]. In
epidemiology, Auto-Regressive Moving-Average (ARMA)
models have been used to describe the diffusion of fowl-
pest diseases [7] while hierarchical Bayesian models have
been used to analyze geographic disease rates [8].
A problem common to most spatio-temporal models is
their usually high dimensionality leading to large com-
putational demands for simulation and prediction. Certain
methods suffer from further limitations such as the need of
CML to have data measured on a regular grid; an impractical
condition in applications such as meteorology and epidemi-
ology. Moreover, CMLs also require some knowledge of
the natural laws involved to propose an adequate model
structure. This knowledge is not always at hand when
modelling complex behaviour common for ecological or
meteorological applications. Finally, even when measure-
ments are taken on a regular grid, it is often required to
infer estimates at other locations among the measurement
sites. Unfortunately, most modelling strategies do not pro-
vide efﬁcient and rigorous methods to perform such spatial
interpolations.
A promising mathematical description of spatio-temporal
behaviour that has the potential to overcome or minimize the
effect of these limitations is the Integro-Difference Equation
(IDE) [9], [10]. In this representation, the spatio-temporal
dynamics are governed by a convolution integral in space
and a difference equation in time, with the spatio-temporal
dynamics dictated by a convolution kernel. In some recently
proposed representations, the evolving ﬁeld modelled by the
IDE is decomposed into a set of weighted basis functions
also used to decompose the convolution kernel [11], [12].
These decompositions allow the approximate representation
of the IDE by a ﬁnite dimension state-space model. This
framework has the advantage of decoupling the number
of states from observation locations with the potential of
overcoming the dimensionality issues hampering various
other models. Moreover, since in the proposed methods the
convolution kernel is completely estimated from data, no
prior knowledge of the natural laws involved is required.
Finally, since the spatio-temporal behaviour is represented
by a basis function decomposition, spatial interpolation is
both computationally efﬁcient and mathematically sound.
Other recent additions to this IDE-based spatio-temporal
model have proposed a method based on spectral analysis
to identifying an adequate number of basis functions to
represent some measured behaviour [13], [14]. Nevertheless,
the models obtained may still suffer from large computa-
tional demands when the spatial bandwidth and/or the spatial
domain under investigation are large. Thus in this work a
method from systems theory is used to further reduce the
dimensionality of the model obtained. The errors introduced
by this order reduction procedure will be given analytically
and shown experimentally.
The remainder of this paper is organised as follows.
7
COMPUTATION TOOLS 2011 : The Second International Conference on Computational Logics, Algebras, Programming, Tools, and Benchmarking
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-159-5

In Section II the state-space representation of the IDE is
presented, followed by the dimension reduction procedure
and the errors introduced in Section III. Section IV expands
on the advantages of the proposed method based on a
synthetic example. Finally, Section V gives some concluding
remarks and possible future enhancements.
II. STATE-SPACE REPRESENTATION OF THE IDE
Consider the spatially continuous, temporally discrete
spatio-temporal process z(s, t) ∈ R : s ∈ S ⊂ Rn, t ∈ Z+
where n = {1, 2, 3, . . .}, S is a ﬁxed spatial domain and s
and t are spatial and temporal indexes, respectively.
Deﬁnition 1. The temporally Markovian, spatially homoge-
neous, time invariant, Gaussian spatio-temporal IDE is given
by
z(s, t) =
Z
S
k(s − r)z(r, t − 1) d r +η(s, t)
(1)
where k(s − r) : Rn → R is a spatially homogeneous
convolution kernel and η(s, t) is a zero mean stationary
Gaussian noise process with covariance Ση given by
Ση = COV[z(s, t), z(s +s, t + t)] =
(
λ(s)
if t = 0
0
otherwise
(2)
Remarks.
1) The spatio-temporal dynamics of the system are gov-
erned by the shape of the convolution kernel. The choice
on the space of the kernel is dictated by the process un-
der investigation; for example, simple reaction-diffusion
processes can be modelled by Gaussian kernels [9].
2) Although a spatially homogenous, time-invariant kernel
will be considered here, heterogenous, time-varying
kernels can easily be incorporated in the representation
as shown in [11].
3) The temporal dynamics are here limited to ﬁrst order
Markovian, this assumption can be lifted by including
higher order terms with different convolution kernels.
The stochastic process z(s, t) is observed via a number
of identical noisy sensors located at {si, i = 1, 2, . . . , ny}
to obtain the data-set Y = {yt, t = 1, 2, . . . , T} where
yt = [y(s1, t) y(s2, t) . . . y(sny, t)]⊤. Each sensor can be
characterized by the spatial convolution
y(si, t) =
Z
S
h(si − r)z(r, t)d r +v(t)
(3)
where h(si − r) is the spatial response of the sensors used
and v(t) is a zero mean white Gaussian noise process
uncorrelated with η(s, t).
The direct computational representation of the stochastic
process z(s, t) is intractable due to the continuous nature
of the spatial domain. To overcome this problem, [11],
[12] have suggested a method based on basis function
decompositions of the stochastic process, the convolution
kernel, the spatial response of the sensor and the noise
covariance to obtain an approximate discrete state-space
representation of the IDE. In these methods, the state-
space dimension is given by the number of basis functions
used to decompose the dynamic ﬁeld. In [13] a method
based on spectral analysis and multi-dimensional extensions
of Shannon sampling theorem have been used to obtain
an initial estimate of the number, position and parameters
of the basis functions used for the decomposition. Joint
estimation of the stochastic process and the convolution
kernel from noisy data can then be performed by a variety of
methods such as the dual Kalman ﬁlter [15], the Expectation
Maximization (EM) algorithm [16] or in a Bayesian setting,
by a 2-stage Gibbs sampler [17].
Such a state-space representation of the IDE requires that
the Assumptions 1 and 2 are satisﬁed.
Assumption 1 (Spatial Low-Pass Response). The spatio-
temporal process z(s, t) must exhibit a spectral low-pass
behaviours, that is:
Z(ν, t) ≈ 0 ∀ t, ν /∈ V
(4)
where Z(ν, t) is the Fourier transforms of z(s, t) and V =
[0, νc]n, with νc being the spatial cut-off frequency.
Assumption 2 (Spatial Semi-Compact Support). The spatio-
temporal process z(s, t) must be semi-compactly supported,
that is:
z(s, t) ≈ 0 ∀ t, s /∈ S .
(5)
Remarks.
1) Assumption 1 implies that the spatio-temporal process
must exhibit some spatial smoothness. Such a condition
is generally satisﬁed by most practical processes.
2) Assumption 2 implies that the spatial domain under
observation must be ﬁnite, again a condition that is
usually satisﬁed in most spatio-temporal studies.
Using the basis function approximations
z(s, t) ≈
nx
X
j=1
⟨z(s, t), φxj(s)⟩φxj(s) = x(t)⊤ φx(s)
(6)
k(s) ≈
nθ
X
j=1
⟨k(s), φθj(s)⟩φθj(s) = θ⊤ φθ(s)
(7)
h(s) ≈
nϑ
X
j=1
⟨h(s), φϑj(s)⟩φϑj(s) = ϑ⊤ φϑ(s)
(8)
λ(s) ≈
nϱ
X
j=1
⟨λ(s), φϱj(s)⟩φϱj(s) = ϱ⊤ φϱ(s)
(9)
8
COMPUTATION TOOLS 2011 : The Second International Conference on Computational Logics, Algebras, Programming, Tools, and Benchmarking
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-159-5

where
x(t) = [⟨z(s, t), φx1(s)⟩
. . .
⟨x(s, t), φxnx(s)⟩]⊤
θ = [⟨k(s), φθ1(s)⟩
. . .
⟨k(s), φθnθ (s)⟩]⊤
ϑ = [⟨h(s), φϑ1(s)⟩
. . .
⟨h(s), φϑnϑ (s)⟩]⊤
ϱ = [⟨λ, (s)φϱ1(s)⟩
. . .
⟨λ(s), φϱnϱ (s)⟩]⊤
φi(s) = [φi1(s) . . . φini(s)]⊤
(10)
and φi(s) are some chosen basis functions, an approximate
state-space representation of the IDE with known error
bounds is given by Theorem 1.
Theorem 1. Using the spatially discrete representations (6)
to (9) with Assumptions 1 and 2 satisﬁed, the stochastic
IDE of Deﬁnition 1 and the observation equation (3) can be
approximated by the ﬁnite dimension state-space model
x(t + 1) = A(θ) x(t) + w(t)
(11)
and
y(t) = C(ϑ) x(t) + v(t)
(12)
where
A(θ) = Ψ -1
Z
S
φx(s) θ⊤ Ξθ(s)d s
(13)
Ψ =
Z
S
φx(s) φx(s)⊤d s
(14)
Ξθ(s) =
Z
S
φθ(s − r) φx(r)⊤d r
(15)
C(ϑ) =



ϑ⊤ Ξϑ(s1)
...
ϑ⊤ Ξϑ(sny)



Ξϑ(s) =
Z
S
φϑ(s − r) φx(r)⊤d r
(16)
w(t) ∼ N(0, Σw)
(17)
with
Σw = Ψ−1
Z
S
φϱ(s)ϱ(s)⊤Ξϱ(s)d s Ψ−⊤
(18)
Ξϱ(s) =
Z
S
φϱ(s − r) φx(r)⊤d r
(19)
and v(t) ∼ N(0, Σv) with Σv = σvIny; with errors in the
approximation of z(s, t) given by
ϵz = |z(s, t)−x(t)⊤ φx(s)| ⩽ ϵ′
z
Z
Rn:ν>νc
Φx(ν)d ν (20)
where
ϵ′
z =
sup
Rn:ν>νc
|Z(ν)Φ−1
x (ν)|
(21)
Remarks.
1) Proof of Theorem 1 is given in [13].
2) The given error bounds assume that a closed form
solution for (14), (15), (16) and (19) exist. Such a
condition is satisﬁed by Gaussian basis functions.
3) The state evolution equation (11) of the state-space
model of Theorem 1 can be rewritten as
x(t + 1) = A(θ) x(t) + B `w(t)
(22)
where `w(t) is a zero-mean Gaussian white noise pro-
cess with covariance Σ `
w = Inx and B being the
Cholesky decomposition of Σw, that is BB∗ = Σw
where B∗ denotes the conjugate transpose of B.
The computation cost of simulating a spatio-temporal
process using this model depends on the state-space model
dimension. Based on Theorem 1, good approximations can
only be obtained if the full spatial extent and the full band-
width are considered. This often results in computationally
expensive models. A choice to limit the system bandwidth
can be taken, but this results in the spatial smoothing of the
ﬁeld estimates and predictions. As an alternative, Section III
presents a dimension reduction method based on a balanced
realization of the state-space model.
III. DIMENSION REDUCTION
Balanced reduction methods of state-space models rely on
two steps:
1) The original state-space model is ﬁrst transformed into
a balanced realisation with the states most effected by
noise being also the most observable states.
2) The states that are less effected by noise in the balanced
realisation (and therefore also less observable) are re-
moved to obtain an approximate truncated state-space
model.
The initial transformation into a balanced realization
requires that all states of the state-space model are both
perturbable and observable. This allows for a linear transfor-
mation of the state-space model into a balanced realization.
This balanced model can then be truncated to retain only
the perturbable and observable states. The perturbability and
observability requirements are ensured if conditions 1 and 2
are satisﬁed.
Condition 1 (Perturbability). All the states of the state-space
model of Theorem 1 are perturbable iff, the matrix
P = [B AB A2B . . . Anx−1B]
(23)
is of full rank.
Condition 2 (Observability). All the states of the state-space
model of Theorem 1 are observable iff, the matrix
O = [C CA CA2 . . . CAnx−1]⊤
(24)
is of full rank.
Remarks.
9
COMPUTATION TOOLS 2011 : The Second International Conference on Computational Logics, Algebras, Programming, Tools, and Benchmarking
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-159-5

1) For the state-space model of the IDE of Theorem 1,
conditions 1 and 2 are easily satisﬁed by a well spread
arrangement of both the sensors and basis functions
used to represent the dynamic ﬁeld. Such an arrange-
ment requires that no two identical sensors or basis
functions are positioned at the same spatial location.
Given that these conditions are satisﬁed, a balance realiza-
tion of the state-space model of the IDE is given by Lemma
1.
Lemma 1 (Balance Realization). If conditions 1 and 2 are
satisﬁed, then a balance realization of the states space model
of Theorem 1 is given by:
˘x(t + 1) = ˘A˘x(t) + ˘B `w(t)
(25)
and the observation equation
y(t) = ˘C˘x(t) + v(t)
(26)
where ˘x(t) = T x(t), ˘A = TAT -1, ˘B = TB, ˘C = CT -1
and T ∈ Rnx × Rnx is a linear transformation such that the
matrices P and O of the transformed model satisfy P ⊤P =
O⊤O = Υ, where
Υ = diag(σ1, σ2 . . . σny)
(27)
and where {σi, i = 1, 2, . . .} are the Hankel singular values
of the state-space model with σ1 > σ2 > σ3 . . ..
Remarks.
1) Proof of Lemma 1 is given for general state-space
models in [19].
2) Conditions 1 and 2 ensure that the linear transforma-
tion T exists.
3) Standard matrix computation packages provide accu-
rate methods for obtaining the transformation matrix T.
These methods are mostly based on the contragradient
algorithm [18].
A reduced order model with known error bounds based
on the balanced realization of Lemma 1 is given in Theorem
2
Theorem 2. Using the balanced state-space model of
Lemma 1, an approximate reduced order state-space model
is given by:
˜x(t + 1) = ˜A˜x(t) + ˜B ˜w(t)
(28)
and
y(t) = ˜C˜x(t) + v(t)
(29)
where ˘x(t) = [˜x(t)⊤ . . .]⊤, `w(t) = [ ˜w(t)⊤ . . .]⊤, with
˜x(t), ˜w(t) ∈ Rnr and
˘A =
 ˜A
. . .
...
...
!
(30)
˘B =
 ˜B
. . .
...
...
!
(31)
˘C =

Figure 1.
Typical spatio-temporal process z(s, t) generated by ﬁrst order
numerical integration.
Figure 2.
Approximate reconstructed spatio-temporal process ˆz1(s, t)
using the discretized model.
Note that the spatially discrete model has a state-space
dimension of nx = 13. Thus its system behaviour is captured
by a 13 × 13 matrix which is used in all the computa-
tions. Given this state-space representation and the model
reduction method of Theorem 2, a reduced order model
was obtained with all balanced states with Hankel singular
values σi < 0.1 removed. This reduced order model has
a state-space dimension of nx = 6 and therefore obtains a
signiﬁcant reduction in computational costs since operations
are now performed on 6 × 6 matrices. This reduced order
model generates the approximate ﬁeld ˆz2(s, t) shown in
Figure 3.
The error ﬁeld e(s, t) showing the error in ˆz2(s, t) intro-
duced by the model reduction procedure when compared to
the discretized model ﬁeld ˆz1(s, t) is shown in Figure 4. This
error ﬁeld indicates that the model reduction procedure has
eliminated some higher frequency components but still pro-
duced a reasonable approximation to the original stochastic
ﬁeld.
The Root Mean Squared Error (RMSE) between ˆz1(s, t)
Figure 3.
Approximate reconstructed spatio-temporal process ˆz2(s, t)
using the reduced order model.
Figure 4.
Error ﬁeld e(s, t) between ˆz1(s, t) and ˆz2(s, t).
and ˆz2(s, t) for the example being considered is 0.051. To
verify the repeatability of this result, a Monte Carlo run of
100 different stochastic realizations was performed obtaining
the RMSE spread shown in Figure 5, with a mean and
standard deviation given by 0.0498 ± 0.0048.
Figure 5.
Histogram of RMSE values.
The histogram of Figure 5, indicates the excellent re-
11
COMPUTATION TOOLS 2011 : The Second International Conference on Computational Logics, Algebras, Programming, Tools, and Benchmarking
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-159-5

peatability of the results obtained. Moreover, an error of
approximately 0.05 is equivalent to 8% of the average
measured observation; a remarkable accuracy considering
the 54% reduction in the state-space dimension.
V. CONCLUSION
Mathematical models of spatio-temporal phenomena are
continuously gaining in popularity in various scientiﬁc ﬁelds.
Such models are fundamental for mathematical simula-
tion and therefore prediction of spatio-temporal behaviour.
However, these models are frequently severely hampered
by the high computation demands of most spatio-temporal
simulation methods. Thus in this paper a simulation method
based on balanced model reduction of an IDE-based spatio-
temporal model is given. The simulation results show the
ability of the proposed method to represent spatio-temporal
behaviour accurately with signiﬁcant reductions in the com-
putational costs.
Further work is currently being carried out on this com-
putational method to enhance its applicability to varied
applications. While a non-linear growth term, as required
in biomedical and ecological applications, has already been
included [14], heterogeneous and time-varying implemen-
tations have still to be developed. Moreover, applying this
computational method to various engineering applications,
such as ﬂuid dynamics and mechanical structure analysis,
requires the inclusion of boundary conditions. Such addi-
tions are also being investigated.
REFERENCES
[1] S. Billings, L. Guo, and H. Wei, “Identiﬁcation of cou-
pled map lattice models for spatio-temporal patterns using
wavelets,” International Journal of System Science, vol. 37,
no. 14, pp. 1021–1038, 2006.
[2] D. Coca and S. Billings, “Analysis and reconstruction of
stochastic coupled map lattice models,” Physics Letters A,
vol. 315, pp. 61–75, 2003.
[3] P. Guttorp and P. Sampson, “Methods for estimating het-
erogeneous spatial convariance functions with environmental
applications,” in Handbook of statistics, G. Patil and C. Rao,
Eds.
Elsevier Science, 1994, vol. 12, pp. 661–689.
[4] A. Amani and T. Lebel, “Lagrangian kriging for the esti-
mation of Sahelian rainfall at small time steps,” Journal of
Hydrology, vol. 192, pp. 125–157, 1997.
[5] X. de Luna and M. Genton, “Predictive spatio-temporal
models for spatially spase environmental data,” Statica Sinica,
vol. 15, pp. 547–568, 2005.
[6] T. Gneiting, “Nonseparable, stationary covariance functions
for space-time data,” Journal of the American Statistical
Association, vol. 97, pp. 590–600, 2002.
[7] R. Martin and J. Oeppen, “The identiﬁcation of regional
forecasting models using space-time correlation functions,”
Transactions of the Institute of British Geographers, vol. 66,
pp. 95–118, 1975.
[8] L. Waller, B. Carlin, H. Xia, and A. Gelfand, “Hierarchical
spatio-temporal mapping of disease rates,” Journal of the
American Statistical Association, vol. 92, pp. 607–617, 1997.
[9] M. Kot, M. Lewis, and P. van den Driessche, “Dispersal data
and the spread of invading organisms,” Ecology, vol. 77, pp.
2027–2042, 1996.
[10] G. Storvik, A. Frigessi, and D. Hirst, “Stationary space time
Gaussian ﬁelds and their time autoregressive representation,”
Statistical Modelling, vol. 2, pp. 139–161, 2002.
[11] C. Wikle, “A kernel-based spectral model for non-Gaussian
spatio-temporal processes,” Statistical Modelling: An Interna-
tional Journal, 2002.
[12] M. Dewar, K. Scerri, and V. Kadirkamanathan, “Data driven
spatiotemporal modelling using the integro-difference eqau-
tion,” IEEE Transactions on Signal Processing, vol. 57, no. 1,
pp. 83–91, 2009.
[13] K. Scerri, M. Dewar, and V. Kadirkamanathan, “Estimation
and model selection of an IDE-based spatio-temporal mod-
els,” IEEE Transactions on Signal Processing, vol. 57, no. 2,
pp. 482–492, 2008.
[14] D. Freestone, P. Aram, M. Dewar, K. Scerri, D. Grayden,
and V. Kadirkamanathan, “A data-driven framework for neural
ﬁeld modelling,” NeuroImage, vol. 56, pp. 1043–1058, 2011.
[15] E. Wan and R. van der Merwe, “The unscented Kalman
ﬁlter,” in Kalman ﬁltering and neural networks, S. Haykin,
Ed.
Wiley, 2001, ch. 7.
[16] S. Gibson and B. Ninness, “Robust maximum-likelihood
estimation of multivariable dynamic systems,” Automatica,
vol. 41, pp. 1667–1682, 2005.
[17] C. Robert and G. Casella, Monte Carlo Statistical Methods.
Springer, 2004.
[18] A. Laub, M. Heath, C. Paige, and R. Ward, “Computation of
system balancing transformations and other applications of
simultaneous diagonalization algorithms,” IEEE Transactions
on Automatic Control, vol. 32, no. 2, pp. 115–122, 1987.
[19] K. Zhou and J. Doyle, Essentials of Robust Control. Prentice
Hall, 1998.
12
COMPUTATION TOOLS 2011 : The Second International Conference on Computational Logics, Algebras, Programming, Tools, and Benchmarking
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-159-5

