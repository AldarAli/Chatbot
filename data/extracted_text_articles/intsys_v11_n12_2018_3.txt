25
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Adaptive Portfolio Asset Allocation Optimization with Deep Learning
Samer Obeidat
Investifai Inc.
Ottawa, Ontario, Canada
Email: sam@investifai.com
Daniel Shapiro
School of Electrical Engineering and Computer Science
University of Ottawa
Ottawa, Ontario, Canada
Lemay Solutions Consulting Inc.
Ottawa, Ontario, Canada
Investifai Inc.
Ottawa, Ontario, Canada
Email: daniel@investifai.com
Mathieu Lemay
Lemay Solutions Consulting Inc.
Ottawa, Ontario, Canada
Email: matt@lemay.ai
Mary Kate MacPherson
Lemay Solutions Consulting Inc.
Ottawa, Ontario, Canada
Email: marykate@lemay.ai
Miodrag Bolic
School of Electrical Engineering and Computer Science
University of Ottawa
Ottawa, Ontario, Canada
Email: mbolic@eecs.uottawa.ca
Abstract—Portfolio management is a well-known multi-factor
optimization problem facing investment advisors. The system
described in this work can assist in automating portfolio manage-
ment, and improving risk-adjusted returns. The asset allocation
action recommendations were personalized to the portfolio under
consideration, and were examined empirically in this work in
comparison to standard portfolio management techniques. This
work presents a Long Short-Term Memory approach to adaptive
asset allocation, building upon prior work on training neural net-
works to model causality. The neural network model discussed in
this work ingests historical price data and ingests macroeconomic
data and market indicators using Principal Components Analysis.
The model then estimates the expected return, volatility, and
correlation for the selected assets. These neural network outputs
were then turned into action recommendations using a Mean-
Variance Optimization framework augmented to use a forward-
looking rolling window technique. Testing was performed on a
dataset with a 7.66 year duration. The observed mean annualized
return for classical passive portfolio management approaches
were 4.67%, 3.49%, and 4.57%, with mean Sharpe ratios of
0.46, 0.20, and 0.54. 10 simulations using the new Long Short-
Term Memory model from this work provided a mean annualized
return of 10.07%, with a Sharpe ratio of 0.98. This work provides
the conclusion that a Long Short-Term Memory model can
generate better risk-adjusted returns than conventional strategic
passive portfolio management.
Keywords–Recommender
systems;
Deep
learning;
Portfolio
management.
I.
INTRODUCTION
Whereas our prior work investigated learning causality
from observing computer user actions [1], this extension of
that work continues that line of research, using Long Short-
Term Memory (LSTM) neural networks to model the cause
and effect inherent in portfolio management decisions. The
objective of this work is to develop an artiﬁcial intelligence
(AI) approach for adaptive investment portﬁolio management
by examining the assets for a long time period and by looking
and diverse asset classes on a global scale. This approach will
be contrasted against conventional strategic passive investment
portfolio management strategies. Adaptive asset allocation is
a timely area of research, as deep learning innovations are
being productized to create ﬁnancial products such as robo-
advisors [2], ETFs [3], and hedge funds [4]. The decision
engine from [1] was replaced by the Markowitz’s Mean-
Variance Optimization (MVO) framework, and the learning
algorithm was replaced by a LSTM model. Prior work on
LSTM portfolio management [5] was extended in this work.
In recent years, there has been an increasing focus on
investments into passively managed funds. These aim to repli-
cate the market’s performance rather than beating it [6]. In
2011, Burton Malkiel made the case for passive investing
by empirically proving that investing in the S&P 500 during
the period of 1969 to 2010 would have generated 80% more
returns than the average actively managed fund [7]. This
has encouraged investment managers to enjoy the beneﬁts of
diversiﬁcation using cross-asset correlations within a certain
risk proﬁle [8]. The dilemma of managing a portfolio has thus
become deciding what proportion of the investment should
be allocated to each asset available. Modern portfolio theory
(MPT) suggests the use of the MVO framework to elimi-
nate risks that are not systematic, and determine the optimal
distribution of the investment between the different assets.
It is important to note here that the optimality of the asset
allocation does not imply that the estimate of asset-related
features is optimal. Rather, on the assumption that the asset-
related parameters were error-free, the MVO asset allocation
is guaranteed not to add any additional error.
Markowitz’s MVO framework aims to achieve portfolio
diversiﬁcation while minimizing speciﬁc risks and determining

26
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 1. Markowitz Frontier (Modiﬁed from Wikimedia Commons) [12]
the risk-return tradeoffs for each asset [9]. The ﬁrst step for
MVO is to develop estimates of the expected returns and
volatilities for each asset. These estimates can be achieved
using classical indexing models such as the Capital Asset
Pricing Model (CAPM) [10] or the Three-Factor Model (3FM)
[11], or by using computational methods. After projecting the
expected returns and volatilities for each asset, the algorithm
selects the allocation of assets that has the highest expected
return for a deﬁned level of risk, or the lowest level of risk
for a given level of expected return. As shown in Figure 1,
the optimal portfolio lies on the hyperbolic curve called the
efﬁcient frontier.
This work examines the asset return and volatility estimates
generated by LSTM Recurrent Neural Networks (RNNs). The
model incorporates economic and market input features to
adapt to changes in the ﬁnancial markets, by regularly adjust-
ing the asset allocation. This work used a globally diversiﬁed
multi-asset portfolio consisting of 11 asset classes in a variety
of different markets. Most of the previous studies have used
short testing periods, while this work examined a broader
testing horizon (January 2010 to August 2017).
The challenge of this work was to:
(TASK 1) Predict the return of any asset under consideration,
by training an LSTM to model the asset perfor-
mance.
(TASK 2) Optimize the allocation of assets within a model
portfolio using the MVO framework.
The following sections review the prior art (Section II),
present the causality-learning LSTM model (Section III and
asset allocation model (Section IV), followed by a description
of the dataset (Section V), a description of the empirical exper-
imentation (Section VI) and presentation of the results (Section
VII), closing with conclusions and future work (Section VIII).
II.
RELATED WORK
Random chance and many hidden variables can inﬂuence
asset returns. It is therefore challenging to estimate the future
returns for any asset, which is required in order to perform
MVO asset allocation. Asset returns can be affected by eco-
nomic conditions, commodities prices and political events,
along with many other factors [13]. While conventional models
tend to assume that relationships are linear when forecasting
future returns, many of the real-world cases in the ﬁnancial
markets are non-linear [14]. Artiﬁcial Neural Networks (ANN)
are excellent approximators of non-linear functions, and so the
use of these ANN models in computational ﬁnance research
has persisted. It has been known for decades that multilayer
feedforward neural networks are capable of approximating
any measurable function to any desired degree of accuracy
[15]. The difference between ANN and other approximation
methods is that it uses one or more hidden layers to transform
the input variables, using a transfer function to deal with
nonlinear statistical functions [16]. ANNs can analyse huge
quantities of data to recognize patterns and make sense of
incomplete or noisy data, and therefore provide an excellent
alternative to linear models for forecasting and estimating
ﬁnancial time-series [17] [16].
An important part of the portfolio management process is
the method of performance evaluation. Many techniques and
models have been developed to evaluate portfolio performance
based upon the portfolio’s return-risk characteristics. The
Sharpe ratio is measured by dividing the difference between the
portfolio’s expected return and the risk-free interest rate by the
portfolio’s standard deviation. The ratio computes the excess
returns per unit of total risk [18]. The Treynor ratio is measured
by dividing the portfolio’s excess returns by the portfolio’s
beta (systematic risk) [19]. Jensen’s alpha (αi) is the intercept
of Jensen’s excess return of the single-index model, and it
measures the abnormal return over holding the investment
portfolio of an index fund [20]. As the various methods of
weighting the portfolios have different standard deviations,
this work uses the Sharpe ratio to enable comparison between
results.
A number of studies have been conducted to evaluate
neural networks’ ability to predict ﬁnancial time-series. The
work available in the literature tends to focus on a speciﬁc
stock market over a relatively short testing period. Freitas et al
(2001) focused on the Brazilian Stock Exchange (BSE) over a
21 week testing period using an autoregressive neural network
[21]. Jang & Lai (1994) focused on the Taiwan Stock Exchange
(TSE) over two years of testing with a DAS network [22]. Ko
& Lin (2008) had the same focus, looking at the TSE over a
two-year period with a multi-layer resource allocation neural
network [23]. Raei (2006) conducted a comparitive empirical
study to examine the ability of a four layer Perceptron network
to beat a classical portfolio that comprised of stocks from
the Tehran Stock Exchange over a period of 13 months [24].
Overall, the literature lacks a strong body of comparative
empirical analysis to examine the ability of machine learning
(speciﬁcally LSTM neural networks) to achieve better esti-
mates of the returns than the classical indexing models within
multi-asset investment portfolios. As well, very few of them
involved the use of a wide range of assets that covered different
classes on a global scale. The vast majority of published work
focuses on a speciﬁc market (such as a US market or Australian
market) or a particular asset class (such as stock market or
ﬁxed income market).
Portfolios with exposure to global equity markets generate
better risk-adjusted returns than portfolios dominated with
domestic equities [25]. Empirical studies have also shown
that globally diversiﬁed portfolios containing both equities and
bonds outperform portfolios of equities alone [26]. Therefore,
bonds should play a vital role in the portfolio.

27
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
One of the commonly-used classes of ANNs is the Recur-
rent Neural Network (RNN). While feed-forward networks are
designed to have no feedback loops [27], RNNs contain at least
one directed cycle to create an internal memory. Long Short-
Term Memory (LSTM) networks are a form of RNN designed
to deal with modeling temporal sequences [28]. Because of
this, LSTMs can be readily applied to ﬁnancial time series. Lee
& Yoo (2017) looked into using LSTMs to predict potential
returns of a variety of investments. They decided against using
MVO to ﬁnd the optimal set of assets’ weights because MVO
makes the simplifying and often incorrect assumption that asset
returns are normally distributed [29]. Their dataset consisted
of 10 top stocks in terms of market value from the S&P500
from 2004 to 2016. This work aims to expand on the use of
LSTMs for asset allocation by bringing in additional market
and economic data, to improve the quality of the predictions.
It will also focus more on the parameters of the LSTM model
itself.
III.
OVERALL AI MODEL
Figure 3 presents the building blocks of the adaptive asset
allocation system discussed in this work. The output from the
system is a set of asset weights within an investment portfolio.
The iterative process of asset allocation begins with preparing
the input dataset, including historical returns of the 11 assets
(ETFs) in the portfolio, and additional economic and market
data that may inﬂuence future returns for each asset.
Once the input data has been prepared, Principal Com-
ponents Analysis (PCA) is used to reduce the dimensionality
of the additional economic and market data down from 387
features. After dimensionality reduction, only key economic
and market features are passed along. This information com-
pression helps to reduce the number of dimensions without
much loss of information, going from a sparse to a dense data
representation [30].
The reduced market and economic data are then passed to
an LSTM RNN, along with the historical prices for the assets.
Using this data, the RNN produces a prediction of the assets’
future returns.
Finally, these predictions are used by the MVO model to
generate the optimal weighting of the assets.
Figure 2 shows the overall algorithm of the model. Con-
straints a and b are chosen depending on the level of risk
desired for MVO.
Input: Economic data h0; Market data h1; Assets’
historical data h2; Minimum weight constraint
a := 0.05; Maximum weight constraint
b := 0.35; TIP minimum weight constraint
aT IP := 0.0
Output: Optimal set of assets’ weights
optimal asset allocation
1 e0 = merge(h0, h1)
2 e1 = scale(e0)
3 reduced = PCA(e1)
4 prices = scale(h2)
5 returns = LSTM predict(reduced, prices)
6 optimal asset allocation =
MV O(returns, a, b, aT IP )
Figure 2. Overall LSTM-based asset allocation algorithm.
IV.
MEAN-VARIANCE OPTIMIZER
The MVO framework maximizes returns for a certain level
of risk, or minimizes risk for a given expected return. MVO
requires the estimations of expected returns of all included
assets, their standard deviations, and the variance-covariance
(or correlation) matrix in order to ﬁnd the optimal asset
allocations and calculate a set of efﬁcient portfolios. The MVO
method was used in this work to generate three outputs of
asset allocations: CAPM-based weights, 3FM-based weights,
and LSTM-based weights.
Given n assets, MVO requires expected returns on each
asset ri, standard deviation of returns σi, and covariance P to
be used as inputs to generate an efﬁcient frontier of optimal
portfolios. The total portfolio return rp can be solved with the
equation
rp = ωtr
where ω is an n × 1 column vector of portfolio weights, ωt is
the transpose of the vector ω, and r is an n×1 column vector
of assets’ returns ri. The total portfolio variance σ2
p can be
solved with
σ2
p = ωt X
ω
The asset allocation optimization problem can then be reduced
to the following:
minimize
ω
ωtCω
subject to:
rp = ωtr,
n
X
i=1
ωi = 1,
No short selling constraint, thus ωi ≥ 0,
a < ωi < b
where C is an n × n covariance matrix, rp is the total
portfolio return, a is the minimum weight constraint, and
b is the maximum weight constraint. For this work, the
maximum weight constraint was set arbitrarily to 35% for all
of the portfolio assets. The minimum weight constraint was
set arbitrarily to 5% for all portfolio assets except for TIP,
which had a minimum constraint of 0%. Treasury Inﬂation
Protected Securities (TIPs) link principal and coupon payments
to the Consumer Price Index (CPI), to help protect investors
from inﬂation [31]. They have no minimum weight constraint
because they are inefﬁcient for investors with moderate to high
risk tolerance [32].
V.
DATA DESCRIPTION AND ANALYSIS
The dataset used to evaluate and compare approaches
consisted of historical, economic, and market data, as well
as an economic event calendar.
A. Input Data
The input data can be grouped into three categories: asset
historical data, macroeconomic data, and market data. While
the classical models used only the historical data, the LSTM
model used all three types of input data.

28
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 3. Block diagram for the overall asset allocation AI system [5].
1) Historical Data: Historical monthly adjusted closing
prices were used to calculate the monthly expected returns and
volatilities of each asset in the portfolio. The researched period
was 115 months, from February 2008 to August 2017. The
time-series data for each asset was obtained from Thomson
Reuters (2017) [33]. Table I presents the asset classes consid-
ered for portfolio inclusion, and the functions of each asset.
It can be observed that some of the portfolio’s asset classes
cover different stock markets to achieve global diversiﬁcation.
The chosen asset classes were the same as used by Wealthfront
[32].
2) Macroeconomic Data: As can be seen in Table I, the
portfolio’s asset classes cover a variety of markets, not just
the US equity market. Although the main focus is a US-
based portfolio, the status of economies such as the Euro
zone, the UK, Japan, and BRIC (Brazil, Russia, India and
China) economies have a noticeable inﬂuence on the US
market. Thus, the input dataset included as many economic
indicators as possible for the US and other major economies
in the developed and emerging markets, by including all of
the economic indicators available on the Thomson Reuters
Datastream [33].
3) Market Data: It is safe to assume that market variables
generally inﬂuence asset returns. For this work, the LSTM
neural network was exposed to market data consisting of major
global equity market indices, commodities, major currencies’
exchange rates, and the VIX index. The VIX index, also
known as the market’s “fear gauge”, reﬂects the implied
volatility of the S&P500 index options in the Chicago Board
Options Exchange. It is a forward-looking measure of market
expectations over the coming month’s volatility [34]. This data
should help to adjust the assets’ weights during extreme or
unexpected economic events over the analyzed time frame.
VI.
EXPERIMENT
Classical passive portfolio management approaches CAPM,
3FM, EQWT (equally weighted portfolio rebalancing) were
evaluated for this work in comparison with an LSTM-based
approach. For CAPM and 3FM, the only input was the
historical data of the various assets. For EQWT, the allocation
in each of the 11 assets was set to 9.09%. This results in
an equally weighted portfolio containing US stocks, foreign
stocks, emerging market stocks, dividend stocks, real es-
tate, natural resources, Treasury Inﬂation-Protected Securities
(TIPS), municipal bonds, corporate bonds, emerging market
bonds, and US bonds. CAPM assumes that all investors have
all information at the same time, cannot inﬂuence prices,
and can trade without paying for transactions [10]. 3FM
assumes that value beats growth and that smaller companies
do better than larger ones. Over the long term, investors
must be able to handle extra short-term volatility for better
long-term performance [11]. An initial version of the LSTM
approach (LSTM in Table II and Figures 4 and 5), and a
reﬁned version developed through hyperparameter exploration
(LSTM2 in Table II and Figures 4 and 5) are described in this
work.
All computations were based on a ﬁxed 24-month rolling
window. A minimum of 5% (except TIPS have 0%) and
maximum of 35% weight boundaries were used to achieve
diversiﬁcation and mitigate the MVO sensitivity problem. The
use of multi-period optimization for CAPM and 3FM, and
the rolling window method in MVO, enabled forward-looking
estimations, and generated time-varying optimal weights for
the portfolio assets.
Each model (CAPM, 3FM, EQWT, LSTM1, LSTM2)
performed a rebalancing step on a monthly basis from January
2010 to August 2017, to maintain the target asset allocation
scheme as determined by the investor’s risk tolerance. The
initial portfolio value for each approach was set to 100 USD,
and recalculated monthly according to the consequences of
the recommendations from the model for each approach.
This traditional back testing methodology enables simple and
straightforward comparisons of absolute returns. However,
other statistical properties such as the Sharpe Ratio were
observed to capture the risk adjusted return. Recall that a
higher Sharpe Ratio generally indicates a more attractive
investment.
The LSTM network from [5] (LSTM1) used the Mean
Absolute Error (MAE) loss function. It used PCA to reduce
the dimensionality of the market and macroeconomic data to
70 dimensions. It had a layer width of 16 and one hidden layer.
To develop the LSTM2 model reported in this work,
the research team experimented with both MAE and Mean
Squared Error (MSE) to observe which loss function would
generate increased risk-adjusted returns. A variety of other
parameters were experimented with as well. The number of
dimensions outputted by the PCA function ranged from 10 to
200. The batch sizes used in the model were further explored,
with values ranging from 1 to 512. Other values modiﬁed
were the size of each epoch, the dropout rate, the width of
the model, and the number of layers. Finally, early stopping
was implemented to see if it would have a signiﬁcant impact.

29
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
TABLE I. 11 assets considered for portfolio inclusion, and a description of their key beneﬁts. The 10 year Sharpe ratio for each asset was obtained from
Yahoo Finance for the period covering 2008 to 2018.
Assets Class
Ticker
Investment
Functions
Sharpe Ratio
US Stocks
IVV
iShares S&P500 Index ETF
Investment growth, long-term inﬂation protection, and tax efﬁciency
0.68
Developed Market Stocks
EFA
iShares MSCI EAFE Index ETF
Investment growth, long-term inﬂation protection, and tax efﬁciency
0.26
Emerging Market Stocks
EEM
iShares MSCI Emerging Market Index ETF
Investment growth, long-term inﬂation protection, and tax efﬁciency
0.24
Dividend Growth Stocks
VIG
Vanguard Dividend Appreciation Index Fund ETF
Investment growth, long-term inﬂation protection, and tax efﬁciency
0.74
US Government Bonds
SHY
iShares 1-3 year US treasury Bond ETF
Income, low historical volatility, diversiﬁcation
0.75
Corporate Bonds
LQD
iShares iBoxx $ Inv Grade Corporate Bond ETF
Income, low historical volatility, diversiﬁcation
0.74
Emerging Market Bonds
EMB
iShares JPMorgan USD Emerging Markets Bond ETF
Income, diversiﬁcation
0.69
Municipal Bonds
MUB
iShares National Muni Bond ETF
Income, low historical volatility, diversiﬁcation, tax efﬁciency
0.71
TIPS
TIP
iShares TIPS Bond ETF
Income, low historical volatility, diversiﬁcation, inﬂation protection
0.45
Real Estate
VNQ
Vanguard REIT Index Fund ETF
Income, diversiﬁcation, inﬂation protection
0.40
Natural Resources
XLE
Energy Select Sector SPDR Fund
Diversiﬁcation, inﬂation protection, tax efﬁciency
0.22
The result of the described hyperparameter search was a
model that used PCA to reduce market and macroeconomic
data to 150 dimensions. The LSTM network had 3 hidden
layers with a width of 128, and made use of early stopping.
LSTM1 and LSTM2 were both trained iteratively over a 92
month period, predicting the assets’ future returns for the next
month. These predictions were then passed along to the MVO
calculations to reshufﬂe the asset weights. The training period
increased by one month with each prediction. Each model was
ﬁtted using the Adam optimizer. This simulation was run ten
times for each network.
VII.
PERFORMANCE EVALUATION
The performance of classical passive portfolio management
approaches (EQWT, CAPM, 3FM) and the active AI-based
approaches described in this work (LSTM and LSTM2) were
measured in terms of statistical properties (Table II) and
percentage returns over time (Figure 4 and Figure 5). As
can be seen, the results signiﬁcantly outperformed both the
classical methods and the previous LSTM model. Speciﬁcally,
the observed mean annualized return for LSTM2 was 10.07%,
whereas the other approaches generated less than half: 4.67%
(CAPM), 3.49% (3FM), and 4.57% (EQWT), and 4.18%
(LSTM). This much higher return was generated for a much
improved risk-adjusted return. The mean Sharpe ratios of
CAPM (0.46), 3FM (0.20), EQWT (0.54), and LSTM (0.43)
were signiﬁcantly lower that that of LSTM2 (0.97).
The results obtained for the conventional methods were
in line with expectations. Whereas the return of individual
assets under consideration may have been high (e.g. IVV
returned over 100% growth), the risk of holding only that
asset is unattractive in terms of the Sharpe ratio. Not knowing
the future, any successful strategy should create risk-adjusted
returns above the risk-free rate (e.g. ﬁxed income treasury
bonds) in order to justify the risk involved in following the
strategy. LSTM2 was able to deliver high risk adjusted returns
by holding growing assets with low volatility. The model
was not explicitly trained to avoid volatility. Rather, it is
likely that the training data led the model to converge upon a
solution that allocates assets assessed to provide high return
with high conﬁdence into the portfolio. It is probable that the
LSTM2 model has keyed in on low volatility by maximizing
the probability of the expected return for each asset. In other
words, the backpropagation “push” on the LSTM2 model to
make high conﬁdence asset allocations naturally discounts high
volatility assets, adjusting their expected returns downward due
to the relatively lower conﬁdence.
Figure 4 shows that the return generated by LSTM2 was
higher than the other approaches for all of the computed
performance metrics. A more in-depth look is provided in
Figure 5, where the growth of the portfolio returns for each
simulation is tracked. The assets considered for the portfolio
were the same for all models. The implication of a higher
Sharpe ratio is that the volatility of the underlying assets held
by LSTM2 was low. Another observation is that the returns
for LSTM2 covered a broader range of outcomes than the
single layer LSTM1. The higher variance in outcomes is tied
in part to the fact that each month in the simulation requires
the retraining of a new LSTM model, which trains using a
new random seed in the random number generator. The large
differences in the results of LSTM2 imply that chance does
play a role in the future returns predictions. The future returns
estimates approximate an unknown result with some error. This
error aggregates each month resulting in different holdings for
the models with different random seeds.
Figure 6 shows the average percentage returns of LSTM1
and LSTM2 along with the classical models, and the percent-
age returns of each individual asset in the portfolio. As can be
seen, LSTM2 makes the best use of the more proﬁtable assets,
while still keeping a much lower Sharpe ratio than investing
solely in those stocks. Figure 7 shows how the various Sharpe
ratios did over time; each point is the rolling Sharpe ratio
measured over the past year. LSTM2 consistently has a higher
Sharpe ratio than the other methods.
It can be helpful to see how the different methods fared
over the course of various economic events, to compare the
performance and risk associated with each strategy. Figure 8
shows the percentage returns of the various methods over the
course of the US downgrade in August of 2011 [35]. LSTM2
had the strongest recovery after the event, and as can be seen
in Figure 9, and also maintained the highest rolling Sharpe
ratio during this period of increasing market risk. Because
there is a 5% minimum holdings requirement in the MVO for
LSTM2, it is expected that the Sharpe ratio will broadly track
market trends. Note in Figure 9, and more generally in Figure
7, that LSTM2 tracked the overall trend in the market, while
reducing the risk exposure over other approaches for most of
the simulated backtest period. During the time period of the
US downgrade event, the LSTM2 model balanced the portfolio
to favor US stocks, emerging markets, corporate bonds, real
estate, and natural resources (IVV, EEM, LQD, VNQ, XLE).
This balance of assets recovered slightly better during the
recovery than other approaches. In addition, the LSTM2 model
generated more consistent risk-adjusted returns than the other

30
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
approaches.
LSTM2 also fared well during the European debt crisis
of June 2012 [36]. It had a similar return on investment to
the other methods (Figure 10), but was the only method to
maintain a positive rolling Sharpe ratio throughout (Figure 11).
During the time period of the European debt crisis, the LSTM2
model balanced the portfolio to favor stocks (developed mar-
ket, emerging market, and dividend growth), corporate bonds,
and real estate (EFA, EEM, VIG, LQD, VNQ). This balance
of assets created a similar return as compared to the other
approaches. Post crisis, the model shifted more into real estate,
signalling a recovery in housing that was perhaps unrelated to
the debt crisis in Europe.
During the Taper Tantrums of May 2013 [37], CAPM
actually outperformed both LSTM models, both in percentage
return and in rolling Sharpe ratio (Figures 12 and 13). This
demonstrates that sometimes the LSTM2 model misjudges
market movements and suffers in terms of risk exposure
and returns as a result. This is the expected observation, as
many of these crises are unforeseeable, and took the broader
market by surprise. The Taper tantrums were a good example
of market distortions driven by regulator action, rather than
market fundamentals. This type of intervention should not be
easily predicted by LSTM2, and indeed it underperformed
during this period, generating a small positive return with a
lower Sharpe ratio than CAPM and 3FM. During the time
period of the Taper tantrums, the LSTM2 model balanced the
portfolio to favor stocks (US, emerging markets, and dividend
growth), TIPs, and real estate (IVV, EEM, VIG, TIP, VNQ).
This balance of assets had worse returns than CAPM, though
it still outperformed both the 3FM and LSTM1 methods. The
LSTM2 model consistently had a lower Sharpe ratio than the
classic approaches over those months. During this period, the
model seems to have predicted a rise in inﬂation, and hedged
by getting the portfolio into TIPs. This turned out to be wrong,
but gives some interesting insight into what the model was
expecting.
In Figure 14, LSTM2 can be seen to outperform the other
models during the Russian ﬁnancial crisis of December 2014
[38]. During the time period of the Russian ﬁnancial crisis,
the LSTM2 model balanced the portfolio to favor stocks (US,
emerging markets, dividend growth), municipal bonds and real
estate (IVV, EEM, VIG, MUB, VNQ). This balance of assets
away from EFA (developed markets including European coun-
tries with Russian exposure) resulted in a much faster recovery
after the event than the classic models. It also generated a
signiﬁcantly higher rolling Sharpe ratio (Figure 15).
Over the course of the China market crash of August 2015
[39], LSTM2 generated a negative return, and had a negative
rolling Sharpe ratio, but still outperformed the other models
(Figures 16 and 17). During the time period of the China
market crash, the LSTM2 model balanced the portfolio to
favor US stocks, dividend growth stocks, municipal bonds, real
estate and natural resources (IVV, VIG, MUB, VNQ, XLE).
The model was invested in MUB (municipal bonds) prior to
the crash, and sold out to favor IVV and VNQ (US stocks
and real estate) during and after the crisis. This balance of
assets resulted in higher returns than other approaches, and
fewer losses during the crisis. In addition, the LSTM2 model
generated more consistent risk-adjusted returns than the other
approaches as measured by the Sharpe ratio. The model seems
Figure 4. A comparison of the percentage return for each portfolio
management method over 10 simulations
to have predicted that the bond market yields would shrink due
to government intervention, implying a shift in assets away
from bonds and into stocks and other assets. This idea is further
supported by the continuous drop in consistent returns among
all of the observed strategy as shown in Figure 17.
Finally, when Brexit happened in June of 2016 [40], the
3FM model had better percentage returns, but the LSTM2
model maintained a higher rolling Sharpe ratio over the same
period (Figures 18 and 19). During the time period of Brexit,
the LSTM2 model balanced the portfolio to favor US stocks,
developed market stocks, emerging market stocks, real estate
and natural resources (IVV, EFA, EEM, VNQ, XLE). There
is signiﬁcant UK exposure in EFA, and the model allocated
away from EFA in the month following the crisis. In effect,
the model missed the risk, as one would expect for such a low
probability event. The asset allocation for LSTM2 resulted in
lower returns than the 3FM method, but the LSTM2 model
generated more consistent risk-adjusted returns than the other
approaches as measured by the rolling Sharpe ratio.
Most returns generated by LSTM2 were generated during
times of relative stability (non-crisis periods), as one would
expect from a predictive model trained on historical data.
VIII.
CONCLUSION
This work presented a neural network based approach to
adaptive asset allocation recommendations. It combined LSTM
and MVO models with data on historical prices, macroeco-
nomic data, and market indicators. These signals were pro-
cessed (e.g. scaling, PCA, rolling window) and then applied
to address the portfolio management problem. The trained
model was able to estimate the returns for a selected group
TABLE II. Statistics for the classical passive portfolio management
approaches (EQWT, CAPM, 3FM) and active AI-based approaches (LSTM
and LSTM2). The back testing period was from January 2010 to August
2017.
Statistics (Annualized)
CAPM
3FM
EQWT
LSTM
LSTM2
Mean Return
4.67%
3.49%
4.57%
4.18%
10.07%
Std Dev.
9.69%
10.64%
8.08%
9.26%
10.13%
R-f Average
0.24%
0.24%
0.24%
0.24%
0.24%
Sharpe Ratio
0.46
0.20
0.54
0.43
0.98

31
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 5. Percentage return comparison between the 10 simulations for
LSTM1 (purple) and LSTM2 (green)
of diversiﬁed assets, and make investment recommendations
with higher returns than traditional portfolio management
approaches. The described system can assist in automating
portfolio management. The asset allocation action recommen-
dations were personalized to the portfolio under consideration,
and were examined empirically in this work in comparison to
standard portfolio management techniques. This work provides
an empirical conclusion that an LSTM can provide better risk-
adjusted returns than conventional strategic passive portfolio
management approaches.
REFERENCES
[1]
D. Shapiro, H. Qassoud, M. Lemay, and M. Bolic, “Unsupervised
deep learning recommender system for personal computer users,” in
INTELLI 2017 : The Sixth International Conference on Intelligent
Systems and Applications, 2017.
[2]
J.
Schlesinger,
“How
chatbots
and
artiﬁcial
intelligence
are
changing
wealth
management,”
May
2017.
[Online].
Available:
https://www.theglobeandmail.com/report-on-business/will-
computer-deep-learning-lead-to-higher-earnings/article34842587/
[3]
“Horizons ETFs launches canada’s ﬁrst ETF driven by A.I.” Nov 2017.
[Online]. Available: https://www.newswire.ca/news-releases/horizons-
etfs-launches-canadas-ﬁrst-etf-driven-by-ai-654424823.html
[4]
C. Metz, “The rise of the artiﬁcially intelligent hedge fund,” Jun
2017. [Online]. Available: https://www.wired.com/2016/01/the-rise-of-
the-artiﬁcially-intelligent-hedge-fund/
[5]
S. Obeidat, “Adaptive asset allocation optimization using artiﬁcial
intelligence,” Master’s thesis, Royal Roads University, 2017.
[6]
F. Cai, N.-A. LeKhac, and M.-T. Kechadi, “An integrated model
for ﬁnancial data mining,” in Multi-disciplinary Trends in Artiﬁcial
Intelligence, C. Sombattheera, N. K. Loi, R. Wankar, and T. Quan, Eds.
Berlin, Heidelberg: Springer Berlin Heidelberg, 2012, pp. 306–317.
[7]
B. G. Malkiel, A Random Walk Down Wall Street: The Time-Tested
Strategy for Successful Investing.
WW Norton & Company, 2011.
[8]
F.
J.
Fabozzi,
“The
legacy
of
modern
portfolio
theory,”
CFA
Digest,
vol.
33,
no.
2,
2003,
pp.
50–52.
[Online].
Available:
https://doi.org/10.2469/dig.v33.n2.1273
[9]
H. Markowitz, “Portfolio selection,” The journal of ﬁnance, vol. 7, no. 1,
1952, pp. 77–91.
[10]
W. F. Sharpe, “Capital asset prices: A theory of market equilibrium
under conditions of risk,” The journal of ﬁnance, vol. 19, no. 3, 1964,
pp. 425–442.
[11]
E. F. Fama and K. R. French, “Common risk factors in the returns on
stocks and bonds,” Journal of ﬁnancial economics, vol. 33, no. 1, 1993,
pp. 3–56.
[12]
W. Commons, “File:markowitz frontier.jpg — wikimedia commons,
the free media repository,” 2015, [Online; accessed 30-January-2018].
[Online]. Available: https://commons.wikimedia.org/w/index.php?title=
File:Markowitz frontier.jpg&oldid=164635807
[13]
C. L. Dunis, P. W. Middleton, A. Karathanasopolous, and K. Theoﬁ-
latos, Artiﬁcial Intelligence in Financial Markets: Cutting Edge Appli-
cations for Risk Management, Portfolio Optimization and Economics.
Springer, 2016.
[14]
T. Marwala, Economic modeling using artiﬁcial intelligence methods.
Springer, 2013.
[15]
K. Hornik, M. Stinchcombe, and H. White, “Multilayer feedforward
networks are universal approximators,” Neural networks, vol. 2, no. 5,
1989, pp. 359–366.
[16]
P. D. McNelis, Neural networks in ﬁnance: gaining predictive edge in
the market.
Academic Press, 2005.
[17]
L. Medsker, “Design and development of hybrid neural network and
expert systems,” in Neural Networks, 1994. IEEE World Congress on
Computational Intelligence., 1994 IEEE International Conference on,
vol. 3.
IEEE, 1994, pp. 1470–1474.
[18]
R. Vince, The Handbook of Portfolio Mathematics: Formulas for
optimal allocation & leverage.
John Wiley & Sons, 2008, vol. 400.
[19]
J. L. Treynor, “How to rate management of investment funds,” Harvard
business review, vol. 43, no. 1, 1965, pp. 63–75.
[20]
M. C. Jensen, “Risk, the pricing of capital assets, and the evaluation of
investment portfolios,” The Journal of Business, vol. 42, no. 2, 1969,
pp. 167–247.
[21]
F. D. De Freitas and A. R. De Almeida, “Portfolio selection with
predicted returns using neural networks,” in IASTED International
Conference on Artiﬁcial Intelligence and Applications, 2001, pp. 99–
103.
[22]
G. Jang and F. Lai, Intelligent trading of an emerging market.
John
Wiley & Sons Inc, 1994.
[23]
P.-C. Ko and P.-C. Lin, “Resource allocation neural network in portfolio
selection,” Expert Systems with Applications, vol. 35, no. 1, 2008, pp.
330–337.
[24]
R. Raei, “Risky portfolio selection through neural networks,” The
Iranian Accounting and Auditing Review, vol. 13, no. 46, 2007, pp.
71–85.
[25]
F. Black and R. Litterman, “Global portfolio optimization,” Financial
analysts journal, vol. 48, no. 5, 1992, pp. 28–43.
[26]
P. Jorion, “Portfolio optimization in practice,” Financial Analysts Jour-
nal, vol. 48, no. 1, 1992, pp. 68–74.
[27]
D. Davidian, “Feed-forward neural network,” Aug. 1 1995, US Patent
5,438,646.
[28]
S. Hochreiter and J. Schmidhuber, “Long short-term memory,” Neural
computation, vol. 9, no. 8, 1997, pp. 1735–1780.
[29]
S. Il Lee and S. J. Yoo, “A new method for portfolio construction
using a deep predictive model,” in Proceedings of the 7th International
Conference on Emerging Databases, W. Lee, W. Choi, S. Jung, and
M. Song, Eds.
Singapore: Springer Singapore, 2018, pp. 260–266.
[30]
L. I. Smith et al., “A tutorial on principal components analysis,” Cornell
University, USA, vol. 51, no. 52, 2002, pp. 12–20.
[31]
Q. C. Chu and D. N. Pittman, Treasury Inﬂation-Protected Securities.
Boston, MA: Springer US, 2013, pp. 257–262. [Online]. Available:
https://doi.org/10.1007/978-1-4614-5360-4 8
[32]
“Wealthfront investment methodology white paper.” [Online]. Available:
https://research.wealthfront.com/whitepapers/investment-methodology/
[33]
“Thomson
reuters
datastream.”
[Online].
Available:
https://ﬁnancial.thomsonreuters.com/en/products/tools-applications/
trading-investment-tools/datastream-macroeconomic-analysis.html
[34]
A. Schrager, “The stock market’s “fear gauge” is at a 23-year
low,
and
traders
are
terriﬁed,”
May
2017.
[Online].
Avail-
able:
https://qz.com/979370/volatility-and-the-vix-index-the-stock-
markets-fear-gauge-is-at-a-23-year-low-and-traders-are-terriﬁed/

32
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 6. The % return for each underlying asset during the testing period was reported with purple dots. The average % returns for LSTM1 and LSTM2 were
overlaid onto the graph. The % returns of CAPM and 3FM were also overlaid onto the graph.
Figure 7. Average rolling Sharpe ratios for LSTM1 and LSTM2 along with
rolling Sharpe ratios for CAPM and 3FM
Figure 8. Percentage returns during the timeframe of the US downgrade of
August 2011. The % return for each underlying asset during the testing
period was reported with purple dots.
[35]
C. Riley, “S & P downgrades U.S. credit rating,” Aug 2011.
[Online]. Available: http://money.cnn.com/2011/08/05/news/economy/
downgrade rumors/index.htm
[36]
S.
Steiner,
“Timeline
of
European
debt
crisis,”
Oct
2012.
Figure 9. Rolling Sharpe ratios during the timeframe of the US downgrade
of August 2011
Figure 10. Percentage returns during the timeframe of the European debt
crisis of June 2012. The % return for each underlying asset during the
testing period was reported with purple dots.
[Online].
Available:
http://www.bankrate.com/banking/timeline-of-
european-debt-crisis/
[37]
A. Kaletsky, “The markets and Bernankes “taper tantrums”,” Nov 2013.
[Online]. Available: http://blogs.reuters.com/anatole-kaletsky/2013/09/

33
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 11. Rolling Sharpe ratios during the timeframe of the European debt
crisis of June 2012
Figure 12. Percentage returns during the timeframe of the Taper tantrums of
May 2013. The % return for each underlying asset during the testing period
was reported with purple dots.
19/the-markets-and-bernankes-taper-tantrums/
[38]
N.
Kitroeff
and
J.
Weisenthal,
“Here’s
Why
the
Russian
Ruble
Is
Collapsing,”
Dec
2014.
[Online].
Available:
https://www.bloomberg.com/news/articles/2014-12-16/no-caviar-is-
not-getting-cheaper-everything-you-need-to-know-about-the-russian-
ruble-collapse
[39]
J.
Mchugh,
“China
‘Black
Monday’
Timeline:
The
Chinese
Stock
Market
Crash
And
How
It
Happened,”
Aug
2015.
[Online].
Available:
http://www.ibtimes.com/china-black-monday-
timeline-chinese-stock-market-crash-how-it-happened-2065173
[40]
G. Rachman, “Brexit and the making of a global crisis,” Jun 2016.
[Online]. Available: https://www.ft.com/content/5490d754-3a0e-11e6-
9a05-82a9b15a8ee7
Figure 13. Rolling Sharpe ratios during the timeframe of the Taper tantrums
of May 2013
Figure 14. Percentage returns during the timeframe of the Russian debt
crisis of December 2014. The % return for each underlying asset during the
testing period was reported with purple dots.
Figure 15. Rolling Sharpe ratios during the timeframe of the Russian debt
crisis of December 2014

34
International Journal on Advances in Intelligent Systems, vol 11 no 1 & 2, year 2018, http://www.iariajournals.org/intelligent_systems/
2018, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 16. Percentage returns during the timeframe of the China market
crash of August 2015. The % return for each underlying asset during the
testing period was reported with purple dots.
Figure 17. Rolling Sharpe ratios during the timeframe of the China market
crash of August 2015
Figure 18. Percentage returns during the timeframe of Brexit, June 2016.
The % return for each underlying asset during the testing period was
reported with purple dots.
Figure 19. Rolling Sharpe ratios during the timeframe of Brexit, June 2016

