Classiﬁcation of Hand Flexion/Extension Using High-density ECoG
Tianxiao Jiang, Tao Jiang, Taylor Wang, Shenshen Mei, Qingzhu Liu, Yunlin Li,
Xiaofei Wang, Sujit Prabhu, Zhiyi Sha, Nuri F. Ince∗
∗Department of Biomedical Engineering,
University of Houston, Houston, Texas, USA 77204–5060
Email: nﬁnce@uh.edu
Abstract—Grasping is one of the most important hand move-
ments performed in daily life and therefore a hand neuro-
prosthetic should be able to achieve this function with high
accuracy. Electrocorticogram (ECoG) recorded from standard
clinical electrodes has been proposed as a potential control
signal in brain-machine interfaces (BMIs) and used to provide
information about executed motor activity such as arm movement
direction and individual ﬁnger movements. Here, we investigate
the value of ECoG recorded from human motor cortex with
high density electrodes to distinguish between hand ﬂexion and
extension in single trial level for a hand neuroprosthetic. Two
subjects were asked to execute spontaneous hand extension and
ﬂexion during the recording. Event-related desynchronization
(ERD) and event-related synchronization (ERS) in low-frequency
band (LFB: 8-32 Hz) and high-frequency band (HFB: 60-200 Hz)
were observed in both subjects during these executed movements.
ECoG signal was bandpass ﬁltered in three subbands, alpha (8-13
Hz), beta (13-32 Hz) and gamma (60-200 Hz) for classiﬁcation.
A common spatial pattern (CSP) algorithm fused with linear
discriminant analysis (LDA) was used to distinguish between
executed movements. In both subjects, the gamma band yielded
classiﬁcation accuracies close to 100%. Alpha and beta bands
provided poor classiﬁcation results with higher latency compared
to gamma band. These results suggested that the gamma band
spatial patterns of motor cortex captured with high-density ECoG
can effectively distinguish between hand extension and ﬂexion.
High-density ECoG can be a promising modality to drive a neural
prosthetic which can help paralyzed patients to regain crucial
daily hand functions.
Keywords—High-density ECoG; Time-frequency map; CSP;
LDA.
I.
INTRODUCTION
ECoG was initially performed in clinical setting to deter-
mine the extent of resection in epilepsy cases intraoperatively
[1][2]. Nowadays, ECoG is used not only for clinical decision
making but also in BMI studies to establish the communication
and control function. Compared to scalp electroencephalogram
(EEG), the ECoG provides higher signal quality and wider
bandwidth as it is recorded directly from the cortex.
Previous studies have found that sensorimotor activity is
correlated with the power changes in speciﬁc subbands of
ECoG [3]. Amplitude modulations in gamma band (40-200 Hz)
were found to be closely related to motor behaviors. In the past
few years, features extracted from the gamma range of ECoG
or local ﬁeld potentials have been extensively used to decode
hand movements of both human and non-human primates [4]–
[6]. Previous ECoG based BMI studies generally use large
clinical grids with an inter-electrode spacing of 10 mm. With
the advancements in micro electrode technology today, the
spatial resolution of ECoG has dramatically increased. Recent
studies have just started to show the potential of high-density
ECoG in decoding human motor functions including cursor
control [7], differentiation between multiple hand gestures [5]
and to drive a prosthetic limb online [8].
In this study we explored the spatial patterns of ECoG
recorded from two subjects during hand ﬂexion and exten-
sion tasks. In particular, a customized high-density grid with
120 channels (12×10, 1.2 mm contact exposure and 4 mm
spacing) was used to assess cortical activity with superior
resolution compared to clinical electrodes with 10mm contact
spacing. We characterized the time-frequency dynamics and
investigated to what extend the recorded activity can be used
to distinguish between hand extension and ﬂexion to drive a
neuroprosthetic. In detail, we studied the contribution of ECoG
subbands to the classiﬁcation of the executed tasks. Moreover,
rather than focusing on grasping only, we focused on the
differentiation between hand ﬂexion and extension to improve
the functions of a hand prosthetic and aimed to answer the
question whether these activities are associated with different
patterns in ECoG.
II.
MATERIALS AND METHODS
Below we describe the experimental setup and signal
processing techniques used in this study.
A. Experimental setup
A customized 120 (12×10) channel high-density electrode
grid with a contact diameter of 1.2 mm and inter-electrode
distance of 4 mm was used in this study. The electrodes were
placed on the cortex of two subjects who require functional
mapping and monitoring during awake brain surgery. The
ECoG were intraoperatively recorded along with forearm EMG
and bipolar ECG (lead-II) for 15-20 mins period with a 2
kHz sampling frequency and 16 bit A/D resolution. During
the recordings, the subjects were asked to perform hand exten-
sion/ﬂexion according to auditory instructions. Each movement
type was executed for 30 times and followed by 2-3 seconds
resting period. Hand movements and the ﬁnger positions were
digitized by a digital glove. The ﬁnger position data provided
by the digital glove are further synchronized with the ECoG
via simultaneously recorded trigger signal. The details of the
system setup were described in [9].
B. Time-frequency maps
ECoG data were manually scrutinized to exclude bad
channels. A series of FIR notch ﬁlters were applied to suppress
50 Hz power line noise and its harmonics up to 200 Hz. The
movement onsets were annotated according to the changes in
ﬁnger positions and EMG data. The ECoG data were aligned
with respect to movement onset and each trial consisted three
seconds of data centered at movement onset (1.5s before and
1
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-526-5
BRAININFO 2016 : The First International Conference on Neuroscience and Cognitive Brain Information

Extension
C1
Mapping
Flexion
-1.5 to 1.5 s
0-230 Hz
C120
S1
S2
0.5
1
1.5
2
2.5
3
3.5
0.5
1
1.5
-10
-5
0
5
10
0.5
1
1.5
2
2.5
0.5
1
1.5
-8
-4
0
4
8
C13
C108
C109
C12
C1
CS
C1
CS
Figure 1. Electrode locations are shown on a 3D rendering of a template brain surface (left). Contacts with clear power increase (ERS) in the high gamma band
during movements are marked as red. The central sulcus (CS) is highlighted by a purple line. Each time-frequency map is from -1.5 to 1.5 s, with movement
onset at zero second, and covers 0-230 Hz. All maps are displayed in dB scale (S1: -10 to 10, S2: -8 to 8).
1.5s after). After eliminating those segments with artifacts, 25
trials of ﬂexion and 22 trials of extension in total were available
for S1. For S2, the total number of trials were 26 and 20 for
ﬂexion and extension respectively. Using available trials for
each task, an averaged time-frequency map of each channel
was computed using short-time Fourier transform (STFT) with
256-sample long Hanning window. The window was shifted
with 90% overlap at each step. After computing the averaged
time-frequency maps for each channel in hand movement, they
were normalized by the average spectrum of the ﬁrst 500 ms
(SB):
SN = 10 × log10
SA
SB
(1)
The normalized time-frequency maps were used to inspect the
power changes in peri-movement period in different frequency
bands. Identiﬁed bands were used to quantify the amount of
ERD and ERS in each. In this study, ERD was computed in
LFB (8-32 Hz) and ERS was computed in HFB (60-200 Hz)
based on our observation from time-frequency analysis.
C. Classiﬁcation
In order to distinguish between the executed tasks, a CSP
algorithm was used to extract the spatial patterns of ECoG.
CSP is designed to search for an optimal spatial projection
that maximizes the variance ratio of projected data between
two conditions [10]. Originally implemented in EEG studies
to capture the movement related subband power change (LFB-
ERD), CSP has been successfully extended to ECoG studies as
ERD and ERS were consistently observed in ECoG recordings.
Although both alpha (8-13 Hz) and beta (13-32 Hz) in
LFB were associated with ERD, they were usually separately
studied as different information conveyed within each subband.
In this study, three subbands, alpha (8-13 Hz), beta (13-32 Hz)
and gamma (60-200 Hz), were tested for classiﬁcation. After
ﬁltering the data in each subband, averaged spatial covariance
matrix was computed for each movement. The optimization
problem of CSP can be transformed to the equivalent general-
ized eigenvalue problem [11]:
Σ0w = λΣ1w
(2)
where, w is the generalized eigenvector and λ is the gen-
eralized eigenvalue. Σ0 denotes the averaged covariance of
ﬂexion while Σ1 denotes extension. The variance (energy) ratio
between ﬂexion and extension is equivalent to λ here. After
obtaining the eigenvalue spectrum, usually a few eigenvectors
related to the top and bottom of the spectrum were used for
feature extraction [11]. In order to avoid overﬁtting, we only
used two projections, one related to the largest eigenvalue
and the other related to the smallest eigenvalue. The two
dimensional feature extracted by these two projections was
used in LDA for classiﬁcation. Classiﬁcation error rates were
estimated at each time point using 800 ms of data before that
time point. 5×5 cross-validations were performed to generalize
the classiﬁcation accuracies. At each cross validation, the
training subset was used to compute the averaged covariance
matrices (Σ0 and Σ1). In more detail, at each trial, the
covariance matrix was computed based on the multi-channel
data of 800 ms at speciﬁc time point. For each movement, the
obtained covariance matrices were averaged across all trials
2
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-526-5
BRAININFO 2016 : The First International Conference on Neuroscience and Cognitive Brain Information

(a)
(b)
(c)
(d)
Figure 2. Average ERD (blue) and ERS (red) and average ﬁnger positions
(green). LFB: 8-32 Hz. HFB: 60-200 Hz. Shaded regions denote the standard
deviations across trials.
to yield Σ0 and Σ1. After solving Equation 2, the resulting
linear projections were used in conjunction with LDA for
classiﬁcation on the test set.
III.
RESULTS
The signal analysis and classiﬁcation results of this study
are provided in this section. Speciﬁcally, the time frequency
analysis of each channel, ERD/ERS analysis and ﬁnally the
classiﬁcation results are presented in detail.
A. Time-frequency maps of ECoG grid
The electrode grid was registered onto a template brain
surface by comparing the landmarks (central sulcus, midline)
of the individual MRI and intraoperative photographs (Fig-
ure 1). The normalized time-frequency maps of all channels
are displayed on the right side of Figure 1. Although there
existed differences between individuals in terms of the level
of spectral modulations, for both subjects, we observed clear
power decrease in LFB (8-32 Hz) and increase in HFB (60-
200 Hz) from sensorimotor areas. ERS in HFB was observed
to be more spatially localized while ERD in LFB was more
widespread.
B. Event related power changes
ERD in LFB and ERS in HFB from selected channels were
averaged and displayed from 1.5 seconds before movement
onset to 1.5 seconds after it (Figure 2). Averaged ﬁnger posi-
tions were also provided in each hand ﬂexion and extension
(Figure 2, green). The shaded regions represent the standard
deviations across all trials. ERD were observed to have smaller
magnitude than ERS in terms of absolute value. Generally,
both ERD and ERS happened slightly before the movement
onset.
C. Classiﬁcation
The classiﬁcation results obtained from three subbands
are provided in Figure 3. For both subjects, gamma band
(a)
(b)
Figure 3. The classiﬁcation error rates using three different sub-bands: alpha
(8-13 Hz, green), beta (13-32 Hz, blue) and high gamma (60-200 Hz, red) in
S1 (a) and S2 (b).
consistently yielded better classiﬁcation results compared to
alpha and beta bands. Speciﬁcally, in S1, the classiﬁcation
error rate of gamma band at movement onset was 38.54%
while alpha and beta band only provided chance level (50%)
decoding accuracy. The minimum error rate (2.31%) in S1
was obtained by gamma band at around 500 ms. Both alpha
and beta band achieved their maximum classiﬁcation accura-
cies at around 1000 ms. However, beta band yielded better
classiﬁcation accuracy compared to alpha band. For S2, the
classiﬁcation error rate at movement onset of gamma band was
27.56% which is clearly better than alpha and beta. Gamma
band achieved zero classiﬁcation error rate at 500 ms. At 250
ms, gamma band already yielded an error rate of 1.82%. Alpha
and beta bands reached their best decoding at around 1200 ms.
Similar to S1, beta band outperformed alpha band in terms of
minimum classiﬁcation error rate (9.96% versus 36.44%).
IV.
DISCUSSION
Neural prosthetics based on ECoG in future can potentially
improve the quality of life of paralyzed patients by helping
them regain crucial daily hand functions. To our knowledge,
for the ﬁrst time, this study demonstrated the use of ECoG
data recorded from a high-density grid to distinguish hand
ﬂexion and extension movements of human subjects for a
neuroprosthetics. In particular, a high-density ECoG electrode
grid (12×10) with 1.2 mm contact size and 4mm spacing was
used in this study to investigate cortical activity of hand ﬂexion
and extension at very ﬁne temporal and spatial resolution.
We decoded the ECoG signal by using the CSP algorithm
and LDA to distinguish between executed movements. The
decoding system achieved 98-100% discrimination accuracy
between hand ﬂexion and extension using the gamma band
(60-200 Hz). The classiﬁcation accuracies in the alpha (8-
13 Hz) and beta (13-32 Hz) band were poor and lagged the
movement onset dramatically. These results indicated that the
gamma band signal from high-density ECoG can be effectively
used to differentiate between hand ﬂexion and extension.
Through visual inspection of the time-frequency maps
of all channels (Figure 1), ERD in LFB presents similar
widespread spatial extent between two tasks while ERS in
gamma band is spatially localized and distinct between hand
ﬂexion and extension. The most activated ERS channels differ
slightly between movements. In addition to the differences in
spatial extent, ERS during ﬂexion is also stronger in terms
of magnitude compared to extension. The spatial differences
together with magnitude differences between movements in
gamma band might be utilized by the CSP algorithm to form
3
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-526-5
BRAININFO 2016 : The First International Conference on Neuroscience and Cognitive Brain Information

an optimal spatial projection that can effectively distinguish
between hand ﬂexion and extension.
The best classiﬁcation accuracies were achieved between
250- 500 ms following the movement onset in both subjects.
Since the CSP features are computed in a 800ms window, this
might suggest that data from both motor planning phase and
execution period contribute to the decoding accuracy. However,
as CSP in this study utilized all channels, sensory feedback
from those channels located on the sensory cortex might also
contribute to the classiﬁcation results after movement onset. In
future studies, CSP needs to be restricted to motor cortex to
exclude sensory feedback. We also noticed that ERS in gamma
band generally lasts for a few hundred milliseconds (Figure 2)
following the movement onset and was stronger during the
initiation of the movement but not during the maintenance.
Although the study was executed in two subjects only,
we observed that the gamma band consistently yielded almost
perfect classiﬁcation accuracies. Consistently in both subjects,
the low band was associated with poor classiﬁcation accuracies
and larger latency. Given the consistent results obtained from
both subjects, in the future, our decoding technique based
on high-density ECoG can be extended to real-time online
decoding applications to establish a hand neural prosthetic.
ACKNOWLEDGMENT
We appreciate the cooperations of our subjects and valuable
support of Haidian Hospital in this study.
REFERENCES
[1]
W. Penﬁeld and H. Jasper, Epilepsy and the functional anatomy of the
brain.
Boston: Little Brown, 1954.
[2]
A. Palmini, “The concept of the epileptogenic zone: a modern
look
at
Penﬁeld
and
Jasper’s
views
on
the
role
of
interictal
spikes.” Epileptic disorders : international epilepsy journal with
videotape, vol. 8 Suppl 2, aug 2006, pp. S10–5. [Online]. Available:
http://www.ncbi.nlm.nih.gov/pubmed/17012068
[3]
K. J. Miller, M. DenNijs, P. Shenoy, J. W. Miller, R. P. N. Rao, and
J. G. Ojemann, “Real-time functional brain mapping using electrocor-
ticography,” NeuroImage, vol. 37, 2007, pp. 504–507.
[4]
N. F. Ince, R. Gupta, S. Arica, A. H. Tewﬁk, J. Ashe, and G. Pellizzer,
“High accuracy decoding of movement target direction in non-human
primates based on common spatial patterns of local ﬁeld potentials.”
PloS one, vol. 5, no. 12, jan 2010, p. e14384. [Online]. Available:
http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0014384
[5]
M.
G.
Bleichner,
Z.
V.
Freudenburg,
J.
M.
Jansma,
E.
J.
Aarnoutse, M. J. Vansteensel, and N. F. Ramsey, “Give me a
sign: decoding four complex hand gestures based on high-density
ECoG.” Brain structure & function, oct 2014. [Online]. Available:
http://www.ncbi.nlm.nih.gov/pubmed/25273279
[6]
Y. Nakanishi, T. Yanagisawa, D. Shin, C. Chen, H. Kambara,
N. Yoshimura, R. Fukuma, H. Kishima, M. Hirata, and Y. Koike,
“Decoding ﬁngertip trajectory from electrocorticographic signals in
humans.” Neuroscience research, vol. 85, aug 2014, pp. 20–7. [Online].
Available: http://www.ncbi.nlm.nih.gov/pubmed/24880133
[7]
W. Wang, J. L. Collinger, A. D. Degenhart, E. C. Tyler-Kabara,
A. B. Schwartz, D. W. Moran, D. J. Weber, B. Wodlinger, R. K.
Vinjamuri, R. C. Ashmore, J. W. Kelly, and M. L. Boninger, “An
electrocorticographic brain interface in an individual with tetraplegia.”
PloS one, vol. 8, no. 2, jan 2013, p. e55344. [Online]. Available:
http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0055344
[8]
G. Hotson, D. P. McMullen, M. S. Fifer, M. S. Johannes, K. D.
Katyal, M. P. Para, R. Armiger, W. S. Anderson, N. V. Thakor,
B. A. Wester, and N. E. Crone, “Individual ﬁnger control of a
modular prosthetic limb using high-density electrocorticography in
a human subject,” Journal of Neural Engineering, vol. 13, no. 2,
2016,
p.
026017.
[Online].
Available:
http://stacks.iop.org/1741-
2552/13/i=2/a=026017?key=crossref.2d5ef8bc47143308a3a1ff00aabb53dd
[9]
T.
Jiang,
N.
F.
Ince,
T.
Jiang,
T.
Wang,
S.
Mei,
Y.
Li,
X. Wang, S. Prabhu, and Z. Sha, “Investigation of the spatial
and spectral patterns of hand extension/ﬂexion using high-density
ECoG,” in 7th International IEEE/EMBS Conference on Neural
Engineering (NER). IEEE, apr 2015, pp. 589–592. [Online]. Available:
http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=7146691
[10]
H. Ramoser, J. Muller-Gerking, and G. Pfurtscheller, “Optimal
spatial
ﬁltering
of
single
trial
EEG
during
imagined
hand
movement,”
IEEE
Transactions
on
Rehabilitation
Engineering,
vol.
8,
no.
4,
2000,
pp.
441–446.
[Online].
Available:
http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=895946
[11]
B.
Blankertz,
R.
Tomioka,
S.
Lemm,
M.
Kawanabe,
and
K.-r.
Muller,
“Optimizing
Spatial
ﬁlters
for
Robust
EEG
Single-Trial
Analysis,”
IEEE
Signal
Processing
Magazine,
vol.
25,
no.
1,
2008,
pp.
41–56.
[Online].
Available:
http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=4408441
4
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-526-5
BRAININFO 2016 : The First International Conference on Neuroscience and Cognitive Brain Information

