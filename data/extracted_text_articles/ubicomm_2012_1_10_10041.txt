Compass and WLAN Integration for Indoor Tracking on Mobile Phones
Moritz Kessel, Martin Werner, Claudia Linnhoff-Popien
Mobile and Distributed Systems Group
Ludwig-Maximilians-University Munich
Munich, Germany
{moritz.kessel,martin.werner,linnhoff}@iﬁ.lmu.de
Abstract—Indoor positioning with smartphones in ubiqui-
tuos computing scenarios still poses some problems with respect
to accuracy and precision as well the need for a calibrated
infrastructure and map data. This paper presents a method
for indoor positioning based on the combination of 802.11
WLAN ﬁngerprinting using weighted kNN and a simple indoor
movement model based on digital compass information. We
introduce a novel computation scheme for the distance in
WLAN signal space, additionally considering the Euclidean
real world distance between each ﬁngerprint and the position
predicted by the movement model. A detailed evaluation in a
test environment at our site demonstrates a performance gain
of more than 10% as compared to a classical Kalman ﬁlter.
Moreover, we also show that the Kalman ﬁlter offers a slightly
better capability to correct the accumulation of errors over
time when accurate movement information in form of step
detection is available.
Keywords-Indoor Location Systems; 802.11 Fingerprinting;
Mobile Phone Tracking; Location-Based Services.
I. INTRODUCTION
Location-based Services (LBS) [1], such as navigation
and information services, are among today’s most popular
mobile services in ubiquitous computing scenarios. Fur-
thermore, the position of objects or persons is essential in
many ubiquitous computing applications since information
about the surroundings is often more important than in-
formation on places far away. Fortunately, the increasing
market penetration of modern smartphones, small devices
with high processing power and localization capabilities,
boosts the availability of location-dependent information. An
example is the Global Positioning System (GPS) [2] offering
accurate positioning free of charge in outdoor environments.
However, GPS is (for the moment) not able to provide
accurate indoor position information for ubiquitous services.
Especially in the case of indoor navigation the position error
should not exceed a few meters to be able to distinguish
between several rooms and ﬂoors to provide step-by-step
guidance and generate navigation instructions.
In the past few years, multiple indoor positioning tech-
niques have been developed. Systems based on ultra wide-
band or ultrasonic systems utilize an expensive dedicated
infrastructure, but offer high accuracy position estimates.
Those are often only available in a small area, where higher
accuracy compensates the high cost. An advantage of these
precise systems is that tracking functionality can easily be
integrated by sampling position estimates over time. Since
the error of each estimate is small, a realistic track can be
observed over a period of time.
Other systems make use of existing infrastructure with
little or no additional expenses and therefore are limited in
their accuracy. These kinds of positioning systems are often
based on WLAN, Bluetooth or inertial measurement units
(IMU). In contrast to expensive systems, they are often used
to offer localization services in large indoor areas, especially
in complex buildings such as museums, shopping malls,
airports, hospitals, or university buildings. Adding high qual-
ity tracking functionality to these systems is considerably
more complex, due to the possibility of unrealistic jumps of
consecutive position estimates over a large distance (WLAN)
and the accumulation of errors over time (IMU). But exactly
the high quality tracking information is of great importance
to a large number of services such as navigation, tracking
of users and goods, or automated quality control in factory
settings. Zheng and Xiaofang offer a good overview on use-
cases and techniques for computing and working with spatial
trajectories in [3].
In this paper, we expand SMARTPOS [4], an indoor posi-
tioning system for smartphones based on WLAN ﬁngerprint-
ing and a digital compass, to support continuous positioning
and tracking. While the unmodiﬁed system achieves a high
accuracy within few meters for positioning it is prone to
jump between consecutive estimates and therefore offers low
quality tracks. We show that the user’s orientation measured
by the digital compass of the smartphone can be used for a
more stable position estimation. The key contribution is the
inclusion of the predicted position based on the previous
position and a movement model into the ﬁngerprint nearest
neighbor calculation. Basically, this favors ﬁngerprints near
the last position estimate resulting in smoother paths, which
are more realistic and more accurate as we demonstrate in
this paper. The applied movement model is either simply
deﬁned by constant velocity or step detection with constant
step-length, both enhanced with a direction measured by a
digital compass.
The remainder of this paper is structured as follows: In the
next section, a short overview of existing indoor positioning
and tracking systems is given and differences to our system
1
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-236-3
UBICOMM 2012 : The Sixth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

mentioned. In Section III, the original SMARTPOS system
[4] is presented, while in Section IV the enhancements of
the system for continuous positioning are explained in detail.
In Section V, their impact on the tracking performance is
analyzed and discussed. Section VI concludes the paper and
gives hints on future work.
II. RELATED WORK
The topic of indoor positioning and tracking is deeply
investigated in academic and industrial research and one
of the most active research topics concerning LBS. A vast
variety of technologies and algorithms have been proposed
and still no satisfactory solution exists that offers satisfactory
position information for every use case.
Many pedestrian indoor positioning systems rely on
WLAN ﬁngerprinting algorithms [4], [5], [6], [7], which
offer position estimates with sufﬁcient accuracy (i.e., 1-
3m) while utilizing the existing WLAN infrastructure and
therefore avoiding high expenses. These algorithms belong
to the area of pattern matching and work in two phases: The
ﬁrst phase is called the calibration phase, where a database is
created by the collection of received signal strength indicator
(RSSI) at certain reference positions from the surrounding
access points (AP). The accumulated information of RSSI,
AP and reference position at a speciﬁc time/interval is
called a ﬁngerprint. In the second phase, the positioning is
carried out by comparing current RSSI measurements with
the previously stored values from the database. Different
algorithms calculate the position as the reference position
of the nearest ﬁngerprint in signal space [5], the average of
the k-nearest neighbors (kNN) with or without the distance
in signal space as additional weight [4]. Some algorithms
also utilize Bayesian methods [6], [7] based on probability
distributions derived by multiple measurements over a length
of time. COMPASS [7] is one of the ﬁrst ﬁngerprinting
systems that addresses the problem of attenuation effects
caused by the human body by adding a digital compass to
the system. In the calibration phase, ﬁngerprints for several
selected orientations (typically each 45◦ or 90◦) are collected
at reference positions. In the positioning phase, the user’s
orientation is measured by a digital compass and only the
ﬁngerprints with a similar orientation estimate are used for
the positioning algorithm. However, none of the above-
mentioned approaches considers the user’s movement. A
good overview of other existing positioning systems using
radio frequency (RF) technologies such as radio frequency
identiﬁcation (RFID), ultra wide band, WLAN and Blue-
tooth is given in [8].
Another class of pedestrian indoor positioning systems
is based on IMUs such as accelerometer or magnetometer.
These systems offer only relative positioning capacities
as they measure position changes rather than an absolute
position. This results in an accumulation of sensor errors
over time, which is the reason why most systems consider
additional information, e.g., WLAN ﬁngerprinting or map
information, for recalibration. Woodman and Harle show
in [9] that a building model can compensate the drift of
inertial sensors and add WLAN positioning for obtaining an
initial position ﬁx in their Dead Reckoning system. However,
WLAN positioning is not considered for the correction of
position data. Evennou and Marx compare a Kalman and
a particle ﬁlter for fusing location estimates of a WLAN
ﬁngerprinting algorithm with high quality accelerometer data
[10]. They report a high increase in accuracy compared
to individual systems, but do not yet include the target’s
or its predicted position in the WLAN ﬁngerprinting. Ruiz
et al. utilize a tightly coupled Kalman ﬁlter to fuse foot-
mounted IMU-based position estimates with additional RSSI
information by RFID tags [11]. Their approach is similar to
ours, since they include the estimated position by IMU in the
position estimation by RFID, but they use pathloss instead of
ﬁngerprinting techniques and foot-mounted sensors instead
of cell phones. Chan et al. describe a system [12], which uti-
lizes orientation information to predict the region, in which
the next matching ﬁngerprint is to be expected. Fingerprints
outside that predicted region are completely ignored for
the nearest neighbor estimation, so that wrong orientation
information can lead to wrong location assumptions. Our
system is not as restrictive and weights several factors
applying the distance calculation on ﬁngerprints all around
instead of a regional limited choice.
In the last few years, many indoor positioning systems
have been adopted or developed for deployment on cell
phones. These offer additional sensors, which can directly
be integrated to enhance the position accuracy of existing
systems by combining the information of different sources to
a position estimate of higher accuracy than any single source
could provide. Martin et al. present one of the ﬁrst WLAN
positioning systems, which integrates both calibration and
positioning on a mobile phone [13]. They use various
nearest neighbor algorithms, but do not use additional sen-
sors nor a prediction model. Perttula et al. show in [14]
that modern smartphones have enough processing power to
support Bayesian location estimation methods for WLAN
ﬁngerprinting, but no further sensors are added to the system
to improve the localization capabilities. In [15], Liu et al.
propose a particle ﬁlter based on a hidden Markov model to
combine the inertial sensors of a smartphone with WLAN
ﬁngerprinting and report a signiﬁcant increase in accuracy.
Nevertheless, they do not include the predicted position in
the choice of position candidates by the measurement model.
In our approach, we integrate WLAN ﬁngerprinting with
IMU data by the means of a prediction model based on
the IMU data and a measurement model based on the
predicted position and WLAN ﬁngerprinting. The novelty of
our approach is given by the direct inclusion of the predicted
position in the WLAN ﬁngerprinting approach by combining
the Euclidean distance in map and signal space.
2
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-236-3
UBICOMM 2012 : The Sixth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

III. THE SMARTPOS SYSTEM
In this section, we give a short overview of SMARTPOS
(for more details see [4]), an indoor positioning system based
on 802.11 ﬁngerprinting and a digital compass. The focus
is on the functionality and the previously gathered results,
which are helpful to understand enhancements for tracking
functionality described in the following section.
A. Description
SMARTPOS runs stand-alone on a mobile phone and
consists of a management module for the creation and
maintenance of a ﬁngerprint database and a module for
location determination. In the database creation step, RSSI is
stored for several reference positions (RP) in the building. At
each reference position four ﬁngerprints are recorded, each
time aligning the phone along one of the four main axes of
the building. A single ﬁngerprint consists of
• a list of the average RSSI values of ﬁve consecutive
measurements for each visible access point (AP) along
with the MAC-address of the speciﬁc AP
• the pixel coordinates of the reference position on a
bitmap of the ﬂoor
• and the average of the measurements of the phone’s
compass during the sampling time, which is an indica-
tor for the user’s orientation
B. Previous Results
We evaluated the impact of several variations of deter-
ministic ﬁngerprinting, using a k-nearest-neighbor (kNN)
algorithm with varying parameter k. In a testbed consisting
of a wing of a university building (approximately 200m2)
and with a database consisting of 79 RPs and thus 316
individual ﬁngerprints, we evaluated the impact of weighted
kNN, the treatment of missing values, and the performance
gain by including the user’s orientation in the position
estimation step. The evaluation was carried out with respect
to the accuracy and the precision of SMARTPOS with the
following results:
• Weighted kNN results in a slightly higher accuracy than
non-weighted kNN
• Ignoring missing RSSI causes higher accuracy and
precision for larger k as compared to assigning a ﬁxed
minimal RSSI value (which was −100dBm) below the
phone’s sensibility for all missing AP information
• Considering orientation information greatly increases
accuracy and precision for a smaller k
IV. CONTINUOUS POSITIONING
To increase the accuracy of SMARTPOS in continuous
positioning scenarios, we enhance the position estimation
with a prediction step. This step is computed by the means of
a movement model supported by the smartphone’s compass.
There are several ways to combine WLAN position updates
with a movement model and measurements from inertial
sensors. Most commonly either a Kalman or a particle ﬁlter
is used to fuse the data from different sources (compare
[10]). While a particle ﬁlter is a discrete approximation
of a probability density function, a Kalman ﬁlter is an
approximation of a linear dynamic system from noisy
measurements. For indoor positioning, a Kalman ﬁlter is
usually a linear combination of the position estimated by a
measurement model pmes,i and the estimate of a prediction
model ppre,i−1 based on the previous state vector and the
direction and velocity of movement (see equation (1)).
pi|i−1 = pmes,i · (1 − γ) + ppre,i−1 · γ
(1)
This algorithm works well, but we see the possibility of
optimization using kNN. Since a new estimated position (or
one of the k nearest neighbors) can be at an unrealistically
large distance from the last estimate, we want to modify the
choice of nearest neighbors. Therefore, we propose a novel
approach similar to a Kalman ﬁlter, applying a measurement
and a prediction model, but instead of interpolating the
predicted position estimate and the measured estimate, we
include the interpolation into the nearest neighbor algorithm.
We inﬂuence the choice of nearest neighbors in signal
space by the deviation (Euclidean distance) of the position
predicted by the movement model and the position of each
neighbor candidate in the real world. Hence, we include
a probability of presence into the distance to neighbors in
signal space.
A. Measurement Model
The measurement model consists of a basic weighted
kNN algorithm with a reﬁned distance deﬁnition (between a
current measurement and a ﬁngerprint) allowing to include
the map distance directly into the computation of the nearest
neighbors: Let si be the Euclidean distance of the current
RSSI measurement (at time t) to the recordings of the
i’th ﬁngerprint in the database. Let mi be the Euclidean
distance on a map between the predicted position pt at
time t and the position of the i’th ﬁngerprint. We deﬁne
the distance di = (1 − α) · si + α · mi between the current
measurement and the i’th ﬁngerprint as a linear interpolation
of si and mi, assigning a ﬁxed constant weighting factor
α. This deﬁnition of a distance between a measurement
at a given predicted position and a previously recorded
ﬁngerprint leads to smoother paths favoring ﬁngerprints
near to a predicted position over ﬁngerprints further away.
Obviously, the value of α needs to be conﬁgured in order to
balance the prediction model and the measurement model.
B. Prediction Model
Having obtained a position estimate at least once, we
can apply a prediction model to continuously estimate the
current position of a moving target until another measure-
ment can be utilized to recalibrate the predicted position.
We apply either a constant movement model or a step
3
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-236-3
UBICOMM 2012 : The Sixth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

counter mechanism (similar to the one from Link et al. [16]
without map correction) based on accelerometer data, both
enhanced with the readings of the smartphone’s compass.
In the ﬁrst case, the position is updated according to the
constant speed, the elapsed time and the current orientation
of the phone between two consecutive compass readings. In
the case of the step counter, a step is detected whenever
the vertical acceleration drops by more than 2m/s2 within
ﬁve consecutive accelerometer readings (i.e., approx. 1s).
Those readings are not considered for step detection twice,
so when a step is detected, the previous readings are dis-
carded. This mechanism ensures that a single large drop in
vertical acceleration measured by consecutive accelerometer
readings is not interpreted as multiple steps. A constant
step-length is assigned and every detected step is mapped
in the direction derived by the compass at the same time.
Note that the smartphone needs to be held in approximate
horizontal fashion for either the step detection algorithm and
the compass. For the moment, we do not apply any map
matching techniques to clarify the impact of the prediction
model on the measurement model.
V. EVALUATION
For the evaluation, a test database of ﬁngerprints in a wing
of our site was created. All information was gathered with
a HTC Desire smartphone. The 57 reference positions are
arranged in an approximate grid with ﬁngerprints measured
in the direction of all four main axes of the building, which
results in 228 ﬁngerprints in total (the gray dots in Figure
1).
Figure 1: Reference positions (gray dots) and access points
(gray rounded rectangles).
We then recorded two tracks (see Figure 2) storing the
RSSI values of consecutive active scans (approx. sample rate
of 1 Hz) together with the MAC-address of the APs and the
readings of the compass as well as the accelerometer (both
with an approx. sample rate of 5 Hz). All data is enriched
with a timestamp of the speciﬁc measurement time and saved
in a ﬁle. This ensures that our results originate from an
identical setting for all the different positioning methods.
The quality of the positioning method is evaluated in respect
to two criteria: the accuracy indicated by the mean position
error and the precision indicated by the standard deviation.
In the following the results from a detailed evaluation in the
described setting are presented and discussed.
Figure 2: Two test tracks (T1 in light gray with a length of
42m, T2 in darker gray with a length of 27m) starting from
right to left.
SMARTPOS is evaluated as follows: First the tracking
performance of the deterministic kNN approach and the
impact of using orientation information is analyzed. Af-
terwards, a movement model is added and the Euclidean
distance between the reference position and the user’s cur-
rently estimated position is introduced into the distance
calculation of the current RSSI readings and each ﬁngerprint
as described. We show that the right choice of the movement
model is crucial to the accuracy of the system. Furthermore,
we demonstrate the accuracy of the compass by combin-
ing an experimentally calculated movement model to the
compass readings without considering RSSI. Finally, our
proposed algorithm is then compared to a classical Kalman
ﬁlter.
A. Tracking Accuracy of the original SMARTPOS
While standard kNN with k = 3 (3NN) is based on RSSI
measurements only, we include the user’s orientation into
our algorithm in the oriented kNN with k = 3 (O3NN). In
the latter case, only those ﬁngerprints that have a maximal
deviation of 50◦ of the user’s orientation are considered for
the nearest neighbor algorithm. Table II shows the results
for both tracks. As assumed, the consideration of the user’s
orientation leads to a signiﬁcant reduction in error (above
10%) and a even larger precision gain (approx. 33%).
Table I: Tracking Accuracy of the original SMARTPOS:
3NN T1
3NN T2
O3NN T1
O3NN T2
Average error
2.01 m
1.74 m
1.72 m
1.52 m
Standard dev.
1.52 m
1.00 m
1.02 m
0.67 m
4
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-236-3
UBICOMM 2012 : The Sixth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

B. Combining Euclidean Distance in Signal and Map Space
In this section, the effect of the combination of the
Euclidean distance in map and signal space (see Section
IV) on the tracking accuracy is further investigated. We
experimented with different movement models, alternating
the ﬁxed velocity value, and different measurement models
for the empirical determination of the parameter α in our
test environment.
Small values of alpha result in a smaller inﬂuence of the
prediction model on the measurement model while larger
values add weight to the prediction model. In our test
environment α = 0.7 (with a speed of 1m/s (A07V10))
lead to the best results in both tracks, resulting in a mean
tracking error of 1.33m (T1) and 1.00m (T2) with a standard
deviation of 0.85m (T1) and 0.62m (T2). It has to be noted
that the lower accuracy of the ﬁrst track has its origin in the
varying walking speed (zero velocity at turn-points), which
the movement model is unable to take into account.
With the empirically solved assignment of a ﬁxed value
α = 0.7, different velocities for the movement model
were evaluated. In our model, velocities between 0.8m/s
and 1.0m/s are suitable for tracking indoor movement of
pedestrians, even in the case of non-constant walking speed.
Even so, the mean error can vary to a maximal amount of
approximately 10% within this speed interval. The minimal
measured mean error was 1.22m (T1) and 0.90m (T2) with
a standard deviation of 0.81m (T1) and 0.65m (T2) for a
velocity of 0.8m/s.
Finally, the accuracy of the combination of the proposed
measurement model with a prediction model based on step
detection is evaluated. Each time a step is detected, the
predicted position is moved 1.0m in the direction of the
current compass heading. The results with our testdata show
that the inﬂuence of the measurement model should be
reduced and α = 0.85 leads to a minimal mean error in
both tracks, which was 1.33m (T1) and 0.88m (T2) with a
standard deviation of 0.78m (T1) and 0.46m (T2). In this
case, one can use the measurement model to overcome the
accumulation of errors of the step detection algorithm such
as wrong step-length, heading, or unreliable step detection.
C. Accuracy of Orientation Information
It is crucial for the prediction model to obtain realistic
data readings. While accelerometer readings of todays smart-
phones are assumed to be too noisy for double integration
or even simple integration for the assignment of a velocity
to a movement model (a claim which is supported by our
data), they can be used for step detection. Furthermore,
we observe a high reliability in the compass information.
There is an information lag in cases of abrupt turning,
but the overall accuracy of the compass values in indoor
environments is astonishing. Figure 3 shows an estimated
track, which was computed by entering the real starting
position and using solely the movement model with an
empirically solved constant movement speed applied on the
second track (i.e., a track which was recorded while moving
with a constant speed). The average error to the real track is
0.82m with a standard deviation of 0.55m and therefore even
better than the advanced SMARTPOS system. This is clearly
due to the over-ﬁtting of the model to the data, however, it
remarkably supports the claim that compass readings contain
valuable information for indoor positioning even for low cost
smartphone sensors. The accumulated error over time in this
experiment was 2.96m.
When using the step detection algorithm instead of a
movement model, the average error was 1.20m (T1) and
1.10m (T2) with a standard deviation of 0.77m (T1) and
0.61m (T2) for a step-length of 1.0m. Moreover, the error
accumulated over time at the end of each track (i.e. 1.90m
in T1 and 0.85m in T2) was less than 5% of the track-
length. These results indicate that hand-held step detection
with smartphone accelerometer and measuring the direction
of the step with a smartphone compass is possible and even
without any additional correction schemes quite accurate.
However, even a small percentage of error can result in large
errors after some time, which makes correction methods
indispensable.
Figure 3: The real track in light gray, the estimated track in
dark gray, error vectors are the thin lines in between.
D. Comparison with a Kalman Filter
We compare our results with a classical Kalman ﬁlter
computing the position estimate as a linear combination
of the position estimate computed by either the prediction
and the measurement model. In this case, the measurement
model does not use the novel measurement scheme, but a
standard kNN approach for WLAN position estimation. A
weighting factor γ ∈ [0, 1] is applied to equation (1), with
pmes,i being the position estimate of the measurement model
at time i and ppre,i−1 being the position estimate of the
prediction model, based on the last estimated position pi−1.
The minimal mean error achieved by the Kalman ﬁlter (with
a speed of 1.0m/s) is 1.51m (T1, γ = 0.7) and 1.14m (T2,
5
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-236-3
UBICOMM 2012 : The Sixth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

γ = 0.8) with a standard deviation of 0.89m (T1) and 0.53m
(T2), which means the best case error is still 14−18cm (i.e.,
more than 10%) larger than that of our proposed algorithm
using the same movement model.
When using the step detection algorithm, however, the
contrary is the case. Since step detection also models non
constant speed and is therefore in many cases more accurate
as a constant speed movement model, the prediction model
becomes also more accurate than the measurement model.
The system needs only minor corrections to compensate for
the accumulation of errors, which is better achieved by a
classical Kalman ﬁlter. The minimal mean error with γ =
0.85 in either track is 1.24m (T1) and 0.83m (T2) with a
standard deviation of 0.69m (T1) and 0.42m (T2), meaning
that the classical Kalman ﬁlter is about 7% better than our
proposed algorithm.
Furthermore, both algorithms can easily be combined, by
utilizing our algorithm for determining the nearest neighbors
in the measurement model and the Kalman ﬁlter for the
interpolation with the predicted position. Since this proce-
dure obviously favors the prediction model, the interpolation
parameters need to be applied to compensate for this effect.
With α = 0.75 and γ = 0.5 the minimal mean error was
1.14m (T1) and 0.87m (T2) with a standard deviation of
0.81m (T1) and 0.50m (T2), which is a error reduction in the
ﬁrst track, but an increase in the second track. Table II shows
an overview on the evaluated parameters. The table also
includes accuracies of related research systems for reasons of
comparability with respect to the order of magnitude of the
expected position error. A direct comparison is not possible
due to different set ups and test environments.
Table II: Overview of evaluated tracking accuracies:
T1
avg. err.
std. dev.
end err.
Alpha0.7Velocity1.0
1.33 m
0.85 m
-
Alpha0.7Velocity0.8
1.22 m
0.81 m
-
Alpha0.85Steplength1.0
1.33 m
0.78 m
-
PredictionSteplength1.0
1.20 m
0.77 m
1.90 m
Gamma0.7Velocity1.0
1.51 m
0.89 m
-
Gamma0.85Steplength1.0
1.24 m
0.69 m
-
Alpha0.75Gamma0.5Steplength1.0
1.14 m
0.81 m
-
T2
Alpha0.7Velocity1.0
1.00 m
0.62 m
-
Alpha0.7Velocity0.8
0.90 m
0.65 m
-
Alpha0.85Steplength1.0
0.88 m
0.46 m
-
PredictionVelocity0.975
0.82 m
0.55 m
2.96 m
PredictionSteplength1.0
1.10 m
0.61 m
0.85 m
Gamma0.8Velocity1.0
1.14 m
0.53 m
-
Gamma0.85Steplength1.0
0.83 m
0.42 m
-
Alpha0.75Gamma0.5Steplength1.0
0.87 m
0.50 m
-
Other Systems
Woodman and Harle [9]
<0.5 m
-
-
Evennou and Marx [10]
1.53 m
-
-
Ruiz et al. [11]
1.35 m
-
<1.5 m
Chan et al. [12]
1.82 m
-
-
VI. CONCLUSION AND FUTURE WORK
This paper presents enhancements for SMARTPOS, a po-
sitioning system running stand-alone on smartphones based
on deterministic WLAN ﬁngerprinting and a digital com-
pass. The key concept is the addition of a prediction model
to the system. We tested both a simple indoor pedestrian
movement model with constant speed and a model based
on step detection. For orientation information the digital
compass of the smartphone is used. The position estimate
p of the prediction model is utilized to include the map
distance from p and a ﬁngerprint’s reference position into
the nearest neighbor search in signal space.
We evaluated different weighting factors for the com-
bination of map and signal distance and researched the
effect of the walking speed on our model. All experiments
were carried out in a testbed of approximately 200m2 and
evaluated on two different tracks. One track was recorded
while walking with a constant speed, while the other tracks
included turn points with zero velocity. In the track with
constant speed the mean error was reduced to 0.90m with
a standard deviation of 0.65m, while with the more compli-
cated track we were able to reduce the mean error to 1.22m
with a standard deviation of 0.81m. The results show that
our approach outperforms a classical Kalman ﬁlter, using a
linear combination of the prediction and the measurement
model, when no accurate information about the movement
of the target is available. If high quality position prediction is
possible (e.g., with a sophisticated step detection algorithm
using the smartphone accelerometer), the Kalman ﬁlter with
a heavy weight on the prediction model is a better option.
REFERENCES
[1] A. K¨upper, Location-Based Services: Fundamentals and Op-
eration.
John Wiley and Sons Ltd, 2005.
[2] E. Kaplan, Understanding GPS: Principles and Applications,
ser. Artech House Mobile Communications.
Artech House
Publishers, 2006.
[3] Y. Zheng and X. Zhou, Computing with Spatial Trajectories.
Springer, 2011.
[4] M. Kessel and M. Werner, “SMARTPOS: Accurate and pre-
cise indoor positioning on mobile phones,” in Proceedings of
the International Conference on Mobile Services, Resources,
and Users (MOBILITY’11), 2011, pp. 158–163.
[5] P. Bahl and V. N. Padmanabhan, “RADAR: An in-building
RF-based user location and tracking system,” in Proceedings
of the Annual Joint Conference of the IEEE Computer and
Communications Societies (INFOCOM’00), vol. 2, 2000, pp.
775–784.
[6] M. Youssef and A. Agrawala, “The horus WLAN location
determination system,” in Proceedings of the International
Conference on Mobile Systems, Applications, and Services
(MobiSys’05), 2005, pp. 205–218.
6
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-236-3
UBICOMM 2012 : The Sixth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

[7] T. King, S. Kopf, T. Haenselmann, C. Lubberger, and W. Ef-
felsberg, “COMPASS: A probabilistic indoor positioning
system based on 802.11 and digital compasses,” in Pro-
ceedings of the International Workshop on Wireless Net-
work Testbeds, Experimental Evaluation and Characteriza-
tion (WiNTECH’06), 2006, pp. 34–40.
[8] H. Liu, H. Darabi, P. Banerjee, and J. Liu, “Survey of
wireless indoor positioning techniques and systems,” IEEE
Transactions on Systems, Man, and Cybernetics, Part C:
Applications and Reviews, vol. 37, no. 6, pp. 1067–1080,
2007.
[9] O. Woodman and R. Harle, “Pedestrian localisation for indoor
environments,” in Proceedings of the International Confer-
ence on Ubiquitous Computing (UbiComp’08), 2008, pp.
114–123.
[10] F. Evennou and F. Marx, “Advanced integration of WIFI and
inertial navigation systems for indoor mobile positioning,”
EURASIP Journal on Advances in Signal Processing, vol.
2006, pp. 1–11, 2006.
[11] A. R. J. Ruiz, F. S. Granja, J. C. P. Honorato, and J. I. G.
Rosas, “Accurate pedestrian indoor navigation by tightly
coupling foot-mounted imu and rﬁd measurements,” IEEE
Transactions on Instrumentation and Measurement, vol. 61,
no. 1, pp. 178–189, 2012.
[12] E. C. L. Chan, G. Baciu, and S. C. Mak, “Orientation-
based wi-ﬁ positioning on the google nexus one,” in 6th
International Conference on Wireless and Mobile Computing,
Networking and Communications, ser. WiMob 2010, pp. 392–
397.
[13] E. Martin, O. Vinyals, G. Friedland, and R. Bajcsy, “Precise
indoor localization using smart phones,” in Proceedings of
the International Conference on Multimedia (MM’10), 2010,
pp. 787–790.
[14] A. Perttula, H. Lepp¨akoski, S. Tikkinen, and J. Takala,
“WLAN positioning on mobile phone,” in IAIN World
Congress, Stockholm, Sweden, 2009.
[15] J. Liu, R. Chen, L. Pei, W. Chen, T. Tenhunen, H. Kuusniemi,
T. Kroeger, and Y. Chen, “Accelerometer assisted robust
wireless signal positioning based on a hidden markov model,”
in Proceedings of the Position Location and Navigation
Symposium (IEEE/ION PLANS’10), 2010, pp. 488–497.
[16] J. A. B. Link, P. Smith, N. Viol, and K. Wehrle, “FootPath:
Accurate map-based indoor navigation using smartphones,” in
Proceedings of the 2011 International Conference on Indoor
Positioning and Indoor Navigation (IPIN’11), 2011.
7
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-236-3
UBICOMM 2012 : The Sixth International Conference on Mobile Ubiquitous Computing, Systems, Services and Technologies

