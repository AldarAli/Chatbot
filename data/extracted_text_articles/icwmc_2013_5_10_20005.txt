A New Approach for Multistage Analog Complex Filter Design 
 
Daniele Grasso, Giuseppe Avellone 
Automotive Product Group - Radio Frequency Competence Center 
STMicroelectronics 
Catania, Italy 
daniele.grasso@st.com, giuseppe.avellone@st.com. 
 
 
Abstractâ€” In this paper, a design approach for gm-C complex 
filter for intermediate frequency (IF) is formalized. It is based 
on decoupled first order gm-C sections, each one centered at a 
different frequency with respect to the others that can be 
stacked in series to get the final band pass filter response, with 
order equal to the number of stages.  A simple case with two 
stages is presented to show selectivity improvement when 
difference between the two center-bands increase, with ripple 
increase as drawback. An optimal setup with good selectivity 
increment and still zero ripple (flat pass-band) is also shown. 
Then, the approach is extended to third order. The approach 
has been used for IF filtering in STMicroelectronics GNSS 
receivers, but it is applicable to other wireless receivers. 
Keywords- gm-C filter, complex filtering, low-IF receivers. 
I. 
 INTRODUCTION  
The complex intermediate frequency (IF) filters have 
been proposed for radio frequency (RF) front-end (especially 
for the low-IF ones) for their characteristic of rejecting both 
out-of-band and image signals, due to their asymmetrical 
transferring function [1].  Several implementations have been 
disclosed in technical literature, such as [1]-[8], mainly based 
on active circuits, while related impairments has been also 
analyzed in [9] and the references therein. Amongst these 
implementations, it has been chosen the one based on 
decoupled first order stacked stages with operational trans-
conductor amplifier (OTA) and frequency shift of low-pass 
prototype. This choice presents lower current consumption, 
good response at high frequency and simple, reconfigurable, 
modular design [10].  
In the state-of-the-art implementation of gm-C multistage 
complex IF filter, each stage is centered on the same 
frequency with the same bandwidth, as in [1], [4] and [15] 
and the references therein. In this contribution, we formalize 
an approach considering different center frequency for each 
stage (and eventually different bandwidth). These center 
frequencies will be placed symmetrically around the center 
frequency of the final filter. This approach achieves better 
performances, especially in terms of out-of-band attenuation, 
image rejection and flatness in group delay response with 
lower current consumption (as shown in [10]). Moreover, it 
allows more freedom in shaping the filter frequency response 
for a given filter order. We adopted it in designing an IF 
filter for Global Navigation Satellite Systems (GNSS) 
receivers described in [10]-[12]. 
Section II describes the complex IF filter architecture, as 
in [10]; Section III presents the proposed approach 
considering the second order complex filter case, providing 
equations for filter design, and comparing the behavior 
between coincident center and non-coincident center cases. 
Section IV gives a brief extension to third order, and the 
main conclusions are drawn in Section V. 
II. 
COMPLEX FILTER ARCHITECTURE 
Filter architecture is based on decoupled first order 
sections stacked in series to get the final band-pass filter 
order. Each single stage band-pass filter response is a 
frequency shifted version of a low-pass one, designed using 
active components with trans-conductors and capacitors (gm-
C or OTA-C). Fig. 1 shows the architecture used in [10]-[12] 
for the single-stage, where the first order low-pass frequency 
response is set by the OTA gm1 and capacitor C values, with 
bandwidth given by: fLP = (gm1/2Ï€C). The structure with the 
gm2 OTA is a gyrator that creates a feedback between in-
phase (I) and quadrature (Q) branches performing the 
frequency shift of the low-pass prototype response, obtaining 
a band-pass centered at a frequency defined through gm2 and 
C values according to the formula: fcenter =(gm2/2Ï€C). The 
transfer function can be obtained just putting the translation 
 jÏ‰â†’jÏ‰-jÏ‰center 
 
 
(1) 
in the transfer function of the low pass version, [1],[13]-[14]: 
 
LP
LP
j
G
j
H
Ï‰ Ï‰
Ï‰
) = 1+
(
 
(2) 
resulting in 
 
(
)
LP
center
BP
j
G
j
H
Ï‰
Ï‰
Ï‰
Ï‰
âˆ’
) = 1+
(
  
(3) 
with G = (gm3/gm1), where the third OTA, gm3, is used both to 
decouple each stage with the previous one and to provide a 
gain (as a free parameter).  
In [10], we performed several schematic level 
simulations for defining design parameters values as a better 
trade-off amongst requirements of bandwidth, in-band 
group-delay variation, image and out-of-band rejection. We 
considered a 3rd or 4th order filter comparing in detail two 
cases: 
76
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

â€¢ stages with same center frequency and bandwidth; 
â€¢ stages with different center frequencies, same 
bandwidth. 
 
  
Figure 1.  Complex filter single-stage basic architecture.  
It was easily recognizable as the second case presents 
better performances, especially in terms of out-of-band 
attenuation, image rejection and flatness in group delay 
response. In fact, in [10], we have observed that, when all 
stages share the same center frequency, if wider bandwidth 
are needed with low-order filters, the properties of both out-
of-band and image rejection rapidly becomes not acceptable. 
On the contrary, the different center frequency configuration 
can achieve wider bandwidth while maintaining low-order IF 
filter with good rejection for both out-of-band and image 
signals. The drawback of this latter approach is that the 
implementation needs different gyrators, one for each stage, 
instead of only one type for all the stages. Once fixed the 
stages main parameters (fcenter, fLP and G), then gm1, gm2 and 
gm3 are fixed from the previous formulas and all the trans-
conductors can be designed. For the details of the circuit 
design and measurement results, see [10]-[12]. 
III. 
COMPLEX FILTER FORMALIZATION 
To formalize what has been observed both by simulation 
and by measurements on the implemented IF filters, it is 
better to take into account a simplified version with only two 
stages, obtaining a second order filter (but the approach and 
the conclusions can be straightforwardly extended to higher 
order complex analog filters). In this case, the transfer 
function for two equal stages is  
 
2
2
1
)
(
ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
âˆ’
+
=
LP
center
C
j
G
j
H
Ï‰
Ï‰
Ï‰
Ï‰
.    
(4)
 
Meanwhile, for two stages with centers respectively in 
Ï‰center1 and Ï‰center2 is 
 
LP
center
LP
center
BP
BP
NC
j
G
j
G
j
H
j
H
j
H
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
2
1
2
1
1
1
)
(
)
(
)
(
âˆ’
+
â‹…
âˆ’
+
=
=
â‹…
=
   . 
(5) 
For a final pass-band filter centered at Ï‰center and band 
equal to 2Ï‰B, Ï‰center1 and Ï‰center2 must be chosen symmetrical 
to Ï‰center, that is
(
2 ) 2
1
center
center
center
Ï‰
Ï‰
Ï‰
+
=
. Normalizing 
all the frequencies with respect to Ï‰B, (4) and (5) become: 
 
2
2
1
)
(
ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
âˆ’
+
=
o
c
n
n
C
j
G
j
H
Ï‰
Ï‰
Ï‰
Ï‰
   
(6) 
 
ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
âˆ’
+
â‹…ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
âˆ’
+
=
o
c
n
o
c
n
n
NC
j
j
G
j
H
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
2
1
2
1
1
)
(
   
(7) 
where 
B
n
Ï‰ = Ï‰ Ï‰
, 
B
center
c
Ï‰
Ï‰ = Ï‰
, 
B
LP
o
Ï‰
Ï‰ = Ï‰
, 
B
center
c
Ï‰
Ï‰
Ï‰
1
1 =
, 
B
center
c
Ï‰
Ï‰
Ï‰
2
2 =
,  and the normalized 
filter bandwidth is 2. In the same way the upper 3dB corner 
of the band is 
Ï‰c +1
 and the lower is 
Ï‰c âˆ’1
. 
A. Coincident Center Frequency Case 
Without losing general validity, we set 
1
)
(
=
Hcoinc j c
Ï‰
, 
this lead to G=1. Now, we want calculate the single stage 
low-pass normalized band Ï‰o needed for a final normalized 
bandwidth equal to 2 of the two stages filter. This happens 
when the magnitude at the normalized upper band corner 
Ï‰c +1
 is 3dB lower than the center-band one, that is: 
 
(
)
[
]
(
)
[
]
2
1
1
=
+
c
C
c
C
j
H
j
H
Ï‰
Ï‰
 ; 
(8) 
considering (6), condition (8) is verified for Ï‰o=1.554. 
This means that in order to have a two coincident stages 
band-pass filter with bandwidth of 2Ï‰B we need a low pass 
bandwidth of 1.554â‹…Ï‰B for each single stage. 
B. Different Center Frequency Case 
Setting 
(
1) 2
2
c
c
d
Ï‰
Ï‰
Ï‰
âˆ’
=
, then Ï‰c1=Ï‰c-Ï‰d and 
Ï‰c2=Ï‰c+Ï‰d, and equation (7) may be written as: 
 
(
)
(
)(
)
(
)
2 2
2
2
2
2
4
4
4
2
2
)
(
o
d
c
n
d
o
c
n
o
n
NC
G
j
H
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
+
+
âˆ’
âˆ’
+
âˆ’
=
=
   (9) 
Analyzing this function it is possible to distinguish two 
cases: 
â€¢ if  Ï‰d<Ï‰o then the filter frequency response has only 
one maximum (MAX) at Ï‰n=Ï‰c equal to  
 
(
2 )
2
2 2
)
(
o
d
o
c
NC
G
j
H
MAX
Ï‰
Ï‰
Ï‰
Ï‰
+
=
=
 
 (10) 
 
gm1
+
-
gm1
+
-
gm3
+
-
gm3
+
-
+
-
gm2
gm2
+
-
C
C
Low pass section
I
Q
gm1
+
-
gm1
+
-
gm1
+
-
gm1
+
-
gm3
+
-
gm3
+
-
gm3
+
-
gm3
+
-
+
-
gm2
+
-
+
-
gm2
gm2
+
-
gm2
+
-
C
C
Low pass section
I
Q
77
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

â€¢ if  Ï‰d>Ï‰o then the filter frequency response has one 
minimum (min) at Ï‰n=Ï‰c equal to 
 
(
2 )
2
2 2
)
(
o
d
o
c
NC
G
j
H
min
Ï‰
Ï‰
Ï‰
Ï‰
+
=
=
 
(11) 
and two equal maximum values at 
 
2
2
o
d
c
MAX
n
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
âˆ’
Â±
=
=
 
 (12) 
both with value 
 
d
o
o
d
c
C
G
j
H
MAX
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
2
)
(
2
2
2
ï£ºï£» =
ï£¹
ï£¯ï£°
ï£®
âˆ’
Â±
=
.    (13) 
Considering the first case, we want to calculate, also for 
non-coincident center, the single stage low-pass normalized 
band needed for a final normalized bandwidth equal to 2 for 
the two-stage filter. In general, we obtain a different value 
respect the one calculated in section A; for this reason, let 
put 
o
Ï‰â€²  instead of Ï‰o to distinguish the new variable. Further, 
we set 
1
)
(
=
HNC j c
Ï‰
 obtaining from (9)  
 
(
)
2
2
2
2
o
o
d
G
Ï‰
Ï‰
Ï‰
â€²
â€²
+
=
    
(14) 
and 
(
)
(
)(
)
(
)
2 2
2
2
2
2
4
2
2
2
)
(
o
d
c
n
d
o
c
n
o
d
NC j n
H
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
â€²
+
+
âˆ’
â€² âˆ’
+
âˆ’
â€²
+
=
=
.
       
(15) 
Then, setting (8) for 3dB cut off at 
Ï‰c +1
 we obtain:
 
 
 
2
4
1
2
4
2
2
+
âˆ’
Â±
âˆ’
=
â€²
d
d
d
o
Ï‰
Ï‰
Ï‰
Ï‰
.    
(16) 
These 
are 
valid 
when 
;2
2
0
âˆ’
â‰¤
â‰¤
Ï‰d
 and 
;2
2 +
Ï‰d â‰¥
 the plot of (16), â€˜+â€™ case, results as in Fig. 2: 
all the negative values are not acceptable, so we can discard 
the values for 
2
2 +
Ï‰d â‰¥
. Furthermore, we must discard 
the solutions not compliant with 
o
d
Ï‰
Ï‰
â€²
<
; plotting the 
square root of (16), it is easy to verify that only the solutions 
for  
.0 7596
0
â‰¤
â‰¤
Ï‰d
 can be considered. Other solutions of 
(16) can be found in the â€˜-â€˜ case, but the condition 
o
d
Ï‰
Ï‰
â€²
<
 
is never satisfied and cannot be considered. So, final solution 
in 
o
d
Ï‰
Ï‰
â€²
<
 case is  
 
2
4
1
2
4
2
+
âˆ’
+
âˆ’
â€² =
d
d
d
o
Ï‰
Ï‰
Ï‰
Ï‰
   
(17) 
true for 
.0 7596
0
â‰¤
â‰¤
Ï‰d
. Fig. 3 shows the needed low-pass 
bandwidth of each stage versus frequency distance of the 
responses of the two stages. Observing this plot, for Ï‰d=0 we 
should have the previous coincident center case, and in fact 
we found the previous value 
= .1 554
â€² =
o
o
Ï‰
Ï‰
; when Ï‰d 
increases then 
o
Ï‰â€² decreases: this means that each stage can 
have a narrower bandwidth for obtaining the desired 
resulting bandwidth of the whole two-stage filter, that is a 
normalized value equal to 2. This lead to higher slope of the 
out-of-band response, that is higher out-of-band attenuation 
with the same bandwidth, so it is possible to obtain a more 
selective filter. Just to make an example, choosing Ï‰d =0.7, 
we obtain 
o
Ï‰â€² =1.0194, less than 
.1 554
Ï‰o =
in the coincident 
center case also satisfying condition:
o
d
Ï‰
Ï‰
â€²
<
. 
In order to evaluate the selectivity improvement, the out-
of-band attenuation can be calculated anywhere for both 
cases, e.g. in Ï‰c+10. For not coincident case from (15), 
substituting Ï‰d=0.7 and 
Ï‰â€²o = .1 0194
, we have  
 
(
)
dB
A
c
NC
Ï‰ +10 = 36 4.
  
(18) 
for coincident center case, from (6), (8) and G=1, we have 
 
(
)
dB
A
c
C
Ï‰ +10 = 32 5.
  
(19) 
with 3.9dB of more attenuation in the not coincident case, 
resulting in more selectivity as both have same normalized 
bandwidth equal to 2. 
Choosing another value of out-band frequency, nearer the 
band of the filter, for example Ï‰c+3, we have 
 
( )
( )
dB
A
A
C
NC
5.2
13 5.
16 0.
3
3
=
âˆ’
=
âˆ’
    
(20) 
and that confirms the selectivity enhancement. 
 
Figure 2.  Plot of Eq. 16, plus case,  for the allowed values of Ï‰d.  
 
0
0.5
1
1.5
2
2.5
3
3.5
4
-2.5
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
2.5
Ï‰d
Ï‰0
2
78
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

 
Figure 3.  Plot of Eq. 17, for the allowed values of Ï‰d.  
Now, letâ€™s consider 
o
d
Ï‰
Ï‰
â€²
>
, still with not-coincident 
center, and set the values of the two peaks equal to MAX=1 
without losing general validity, so from (13) is 
 
o
d
G
Ï‰
Ï‰
â€²
2 = 2
     
(21), 
and (9) becomes 
(
)
(
)(
)
(
)
2 2
2
2
2
2
4
2
2
2
2
4
)
(
o
d
c
n
d
o
c
n
o
d
NC j n
H
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
â€²
+
+
âˆ’
â€² âˆ’
+
âˆ’
â€²
=
=
 
(22) 
Then, once again, we impose a normalized bandwidth of 
the resulting filter equal to 2; this means that in 
Ï‰c Â±1
the 
response must be 
2
1
times the maximum. From (22) 
imposing the condition (8) we obtain: 
 
1
2
2
1
3
2
2
âˆ’
Â±
âˆ’
â€² =
d
d
d
o
Ï‰
Ï‰
Ï‰
Ï‰
 
(23) 
valid for 
2
Ï‰d â‰¥ 1
. The plot of (23) results as in Fig. 4: as 
easily recognizable the â€˜+â€™ case (dashed line) does not match 
the condition 
o
d
Ï‰
Ï‰
â€²
>
, so can be discarded. Observing the â€˜-
â€™ case (continuous line) is possible to split the curve in two 
parts: the first one, on which we focus our interest, with 
decreasing value of 
o
Ï‰â€² for 
1
2
1
<
â‰¤
Ï‰d
, up to 
Ï‰d =1
, 
that means when the center frequency separation of the two 
stage is equal to the bandwidth of the whole filter. In this 
point the 
o
Ï‰â€² required is zero, so it is only a theoretical limit. 
The second part for 
Ï‰d >1
, that is center frequency 
separation of the two stages greater than the bandwidth of the 
whole filter, lacks of interest because the response of each 
stage is completely separated from the other, so not useful to 
obtain an appropriate overall pass-band response. 
Returning to the range 
1
2
1
<
â‰¤
Ï‰d
 in (23), as noted 
before, the decreasing characteristic of 
o
Ï‰â€² suggests more 
selective behavior for higher Ï‰d; further, the presence of two 
peaks, as formalized in (11), (12) and (13), means presence 
of in-band ripple: when Ï‰d increases, the minimum in Ï‰c 
becomes lower and the ripple increases. It is important to 
check when ripple is too big. 
If the difference between maximum and minimum 
becomes greater than 3dB then we can consider the response 
completely separated into two distinct lobes, non-acceptable 
as band-pass characteristic. The limit of the center 
frequencies separation 
d
Ï‰  that still gives us a unique filter 
band is given for ripple equal to 3dB, that is: 
 
(
)
(
)
[
]
(
)
[
]
2
= 1
=
MAX
NC
c
NC
d
j
H
j
H
F
Ï‰
Ï‰
Ï‰
 . 
(24) 
Considering the (21) and the (22) then is 
 
(
)
(
2 )
2
2
d
o
o
d
d
F
Ï‰
Ï‰
Ï‰ Ï‰
Ï‰
â€² +
â€²
=
 
(25) 
where 
o
Ï‰â€² has the value for a final band equal to 2,  given by 
(23) for 
1
2
1
<
â‰¤
Ï‰d
; substituting it we have: 
 
(
)
1 1
2
2
4
1
2
2
2
2
2
âˆ’ âˆ’
âˆ’
ï£·ï£¸
ï£¶
ï£¬ï£­
ï£«
âˆ’
âˆ’
=
d
d
d
d
d
d
d
F
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
   
(26) 
Plotting (26) (see Fig. 5) the condition in (24) is satisfied for 
Ï‰d =0.77679; this value gives the maximum acceptable 
ripple. Observing the same plot is fine to note that for 
2
Ï‰d = 1
we found F(Ï‰d)=1. This is the case with no 
ripple, because the minimum is equal to the two maximum 
values, and coincides with the case previously studied for 
o
d
Ï‰
Ï‰
â€²
<
having only one maximum, where we observed that 
higher Ï‰d brings to higher selective filter. 
 
Figure 4.  Plot of Eq. 23, for the allowed values of Ï‰d.  
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.7
0.8
0.9
1
1.1
1.2
1.3
1.4
1.5
1.6
Ï‰0
Ï‰d
0.5
1
1.5
2
2.5
0
1
2
3
4
5
6
 
 
eq.24 with +
eq.24 with -
Ï‰0
Ï‰d
79
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

 
Figure 5.  Plot of Eq. 26, for the allowed values of Ï‰d.  
So, choosing  = 1 âˆš2  
â„
 gives the resulting filter with 
higher selectivity and no ripple; if we can accept ripple, we 
can choose a greater value of Ï‰d in the range 
1 âˆš2 â‰¤  â‰¤ 0.77679
â„
. In particular we can choose values 
nearer to 0.77679 for better selectivity despite of worse 
ripple. If for example we choose Ï‰d = 0.77 from (23), â€˜-â€™ 
case, we have 
 = 0.3389, very low compared with the 
one of the best values we can have for  < 
 , for example 
for Ï‰d =0.7 from (16) we already found 
 = 1.0194 â‰«
0.3389; in this way, with so low 
 , we have much more 
selectivity. If we compare it with the coincident center case, 
the 
difference 
is 
even 
bigger 
(from 
(9) 
it 
was 
1.554>>0.3389). Evaluating the attenuation in the same out-
of-band frequencies used in the examples in all the previous 
cases we obtain the values in Table I. 
Another interesting example can be considered for the 
â€œoptimumâ€ 
setup 
that 
gives 
maximum 
out-of-band 
attenuation with still zero ripple. As already discussed, it is 
for  = 1 âˆš2  
â„
in  â‰¥ 
  case, and for about Ï‰d =0.7596 
in  < 
 case. The values of 
 are 1 âˆš2
â„
 and 0.7622 
respectively, while the related attenuations for Ï‰c+3 and 
Ï‰c+10 are in Table II. In both cases, the maximum 
attenuation with zero ripple is when the two-stages frequency 
separation, Ï‰d, is equal to the single stage bandwidth 
 . 
TABLE I.  
COMPARISON OF OUT-OF-BAND ATTENUATIONS AMONGST 
NON COINCIDENT FREQUENCIES CASES AND COINCIDENT FREQUENCIES 
 
Ripple Ï‰Ï‰Ï‰Ï‰d=0.77 
No ripple Ï‰Ï‰Ï‰Ï‰d=0.7 
Equal Freq. 
Ï‰Ï‰Ï‰Ï‰c+3 
ANC = 24.3 dB 
ANC = 16.0 dB 
AC = 13.5 dB 
Ï‰Ï‰Ï‰Ï‰c+10 
ANC = 45.6 dB 
ANC = 36.4 dB 
AC = 32.5 dB 
 
TABLE II.  
MAXIMUM OUT-OF-BAND ATTENUATION WITH NO RIPPLE 
 
No ripple 
o
d
Ï‰
Ï‰
â€²
â‰¥
 
No ripple 
o
d
Ï‰
Ï‰
â€²
<
 
Ï‰Ï‰Ï‰Ï‰c+3 
ANC = 19.1 dB 
ANC = 17.9 dB 
Ï‰Ï‰Ï‰Ï‰c+10 
ANC = 40.0 dB 
ANC = 38.7 dB 
Lastly, maximum selectivity, with 3dB ripple, is for Ï‰d = 
0.77679, obtaining ANC(Ï‰c+3)=24.6dB and ANC(Ï‰c+10) = 
46.0dB. 
IV. 
THIRD ORDER CASE 
In this section, we will give a brief look to the third order 
case. For three stages with normalized centers, respectively, 
in Ï‰c1, Ï‰c2 and Ï‰c the transferring function is 
ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
âˆ’
+
ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
âˆ’
+
â‹…ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
âˆ’
+
=
=
o
c
n
o
c
n
o
c
n
n
NC
j
j
j
K
j
H
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
1
1
1
)
(
2
1
   . 
(27) 
where K=G1G2G3 is the filter gain, 
B
n
Ï‰ = Ï‰ Ï‰
, 
B
center
c
Ï‰
Ï‰ = Ï‰
, 
B
center
c
Ï‰
Ï‰
Ï‰
1
1 =
, 
B
center
c
Ï‰
Ï‰
Ï‰
2
2 =
, 
B
LP
o
Ï‰
Ï‰ = Ï‰
 and the normalized filter bandwidth is 2. 
Moreover, Ï‰c1 and Ï‰c2 must be chosen symmetrical to Ï‰c, 
that is 
(
2 ) 2
1
c
c
c
Ï‰
Ï‰
Ï‰
+
=
. Setting 
(
1) 2
2
c
c
d
Ï‰
Ï‰
Ï‰
âˆ’
=
, then 
Ï‰c1=Ï‰c-Ï‰d and Ï‰c2=Ï‰c+Ï‰d, equation (27) may be written as 
ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
âˆ’
+
ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
âˆ’
âˆ’
+
â‹…ï£·ï£·
ï£¸
ï£¶
ï£¬ï£¬
ï£­
ï£«
+
âˆ’
+
=
o
c
n
o
d
c
n
o
d
c
n
n
NC
j
j
j
K
j
H
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
Ï‰
1
1
1
)
(
 (28) 
Setting 
(
c )
n
x
= Ï‰ âˆ’Ï‰
 and developing denominator in 
(28) we obtain: 
 
 =
 !
" # $%&'$()
$*(+'#& $%'$()
$*, . (29) 
The square modulus becomes: 
 
||. =
$ 
/
0 $# $%&'$()
$*
$('$#& $%'$()
$*
$1 (30) 
Maximum and minimum values will be related to 
minimum and maximum values of denominator in (30). So, 
let us consider the derivate of the denominator with respect 
to x equating it to zero (defining for which x there could be 
maximum and minimum values): 
 
623 + 42&3
. âˆ’ 2
. + 223
. + 
. = 0 (31) 
The first solution is x=0 => Ï‰n=Ï‰c; other solutions from: 
 
26 +
.
& 2.3
. âˆ’ 2
. +
7
& 3
. + 
. = 0 (32) 
setting x2=y, solution of (32) has the following expressions: 
 
87,. = âˆ’
7
& 3
. âˆ’ 2
. Â±
7
& ;
. âˆ’ 12
.. (33) 
Solutions (33) are real for 
. â‰¥ 12
.. If this last holds, 
these are acceptable solutions for x if and only if y1,2â‰¥0. In 
this latter case, both solutions are non-negative; so there are 
two couples of frequencies to be considered: 
0.7
0.75
0.8
0.85
0.9
0.95
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Ï‰Ï‰Ï‰Ï‰d
F((((Ï‰Ï‰Ï‰Ï‰d)
80
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

 
7 = < Â± ;87
. = < Â± ;8.
. 
(34) 
On the contrary, if y1,2<0, there will be only one real 
solution for (33) and for Ï‰n=Ï‰c the transfer function present 
only a  maximum and no ripple: 
 
|<|. =
$ =
# $()
$*
$ . 
(35) 
Considering y1,2â‰¥0 for the frequencies in (34), the transfer 
function presents more solutions. In this case, we can have 
three maxima (one always from (35)) and two minima, and 
ripple will be present as in Fig. 6.  
 
Figure 6.  Third order complex filter transfer function (dot) and transfer 
function of each first order stage.  
For this case, we have to verify both that Ï‰n=Ï‰c+1 is cut-
off frequency and the in-band ripple; imposing the maximum 
value for this last parameter in order to verify if there are 
acceptable solutions for Ï‰0 and Ï‰d. For instance, for Ï‰?
. =
12Ï‰
.  the ripple is not acceptable. Moreover, it can be 
observed that the selectivity increases as a function of Ï‰d. 
V. 
CONCLUSIONS AND FUTURE WORK 
We have described an approach for multistage complex 
IF filter design able to reach a good tradeoff between in-band 
ripple and rejection of both out-of-band and image frequency 
using different center frequencies in each stage, also 
choosing properly their bandwidths. Formulas are also 
provided for the filter design in the two stages case, 
obtaining the desired selectivity and ripple just choosing the 
bandwidth and the center frequency of each stage. We have 
also briefly described the third order case and extension to 
higher order is quite straightforward. We have adopted this 
approach for IF filter design in STMicroelectronics GNSS 
receiver, [10]-[12].  
Future work could be the extension of the proposed 
approach to design filter where each stage shows different 
order, bandwidth and center frequency asymmetrically 
placed respect to the center of the passband. 
ACKNOWLEDGMENT 
The authors are grateful to Angela Bruno for support, 
discussions and helpful advices. 
REFERENCES 
[1] K.W. Martin, "Complex signal processing is not complex" , 
IEEE Trans. on Circ. and Syst. I: Regular Papers, vol.51, 
no.9, pp.1823,1836, Sept. 2004 
[2] P. Khumsat and A. Worapishet, â€œ5th-order Chebyshev 
Active-RC Complex Filter Employing Current Amplifiersâ€, 
Proc. IEEE Int. Symp. on Integrated Cicuit, Sept. 26-28, 
2007, pp. 281-284, Singapore. 
[3] V. Della Torre, M. Conta, R. Chokkalingam, G. Cusmai, P. 
Rossi, and F. Svelto, â€œA 20 mW 3.24 mm2 Fully Integrated 
GPS Radio for Location Based Servicesâ€, IEEE J. of Solid-
State Circuits, vol. 42, no. 3, March 2007, pp. 602-612. 
[4] L. Laccisaglia, â€œProgetto di un filtro passa banda per segnali 
I-Q in un ricevitore a low-IF per applicazione GPS in 
tecnologia CMOSâ€ Master Thesis, Rome University â€œLa 
Sapienzaâ€, 2004. 
[5] F. Behbahani, H. Firouzkouhi, R. Chokkalingam, S. 
Delshadpour, A. Kheirkhahi, M. Nariman, et al., â€œA 27mW 
GPS Radio in 0.35Âµm CMOSâ€, Proc. IEEE Int. Solid-State 
Circ. Conf., vol.1, Feb. 3-7, 2002, pp. 398-476, San 
Francisco. 
[6] C-W Chen, Y-C Chung, O. T-C. Chen, and R.Y.J. Tsen, â€œA 
Concurrent L1 and L2-band GPS Receiver Using an 
Integrated Low-IF and Weaver Architectureâ€, Proc. IEEE Int. 
Symp. on Micro-NanoMechatronics and Human Science, 
Dec. 27-30, 2003, vol.3, pp. 1163-1166. 
[7] A. Abuelmaâ€™atti and M.T. Abuelmaâ€™atti, â€œA new active 
polyphase filter for image rejection using second generation 
current conveyorsâ€, Proc. 9th WSEAS Int. Conf. on Circuits, 
July 11-13, 2005, Athens, Greece. 
[8] H. Kondo, M. Sawada, N. Murakami, S. Masui, M. Fujioka, 
K. Maruyama, M. Naganuma, and H. Fujiyama, â€œComplex 
BPF for Low-IF receivers with an Automatic Digital Tuning 
Circuitâ€, RFIT2007-IEEE Int. Workshop on Radio-Frequency 
Integration 
Technology, 
Dec. 
9-11, 
2007, 
pp.74-77, 
Singapore. 
[9] J. Mahattanakul, â€œThe effect of I/Q imbalance and complex 
filter component mismatch in Low-IF receiversâ€, IEEE Trans. 
on Circ. and Syst. I: Regular Papers, vol. 53, no. 2, Feb. 2006, 
pp. 247-253. 
[10] D. Grasso, G. Avellone, G. Rivela, G. CalÃ­, and S. 
Scaccianoce, â€œAn Adaptive Low-Power Complex gm-C IF 
Filter for L1/E1 GPS/Galileo Signalsâ€, IEEj Int. Analog VLSI 
Workshop, AVLSIWS 2010, Sept. 8-10, 2010, Pavia, Italy. 
[11] G. Rivela, P. Scavini, D. Grasso, A. Calcagno, M. Castro, G. 
Di Chiara, G. Avellone, G. CalÃ­, and S. Scaccianoce, â€œA 65 
nm CMOS Low Power RF Front-End for L1/E1 GPS/Galileo 
Signalsâ€, Great Lake Symposium on VLSI, GLSVLSI, May 
2-4, 2011, Lausanne, Switzerland. 
[12] G. Rivela, P. Scavini, D. Grasso, M. Castro, A. Calcagno, G. 
Avellone, A. Di Mauro, G. CalÃ­, and S. Scaccianoce, "A low 
power RF front-end for L1/E1 GPS/Galileo and GLONASS 
signals in CMOS 65nm technology," Localization and GNSS 
Int. Conf. on , ICL-GNSS, June 29-30, 2011, pp.7-12. 
[13] C. Cuypers, N.Y. Voo, M. Teplechuk, and J.I. Sewell, 
â€œGeneral synthesis of complex analogue filtersâ€, IEE Proc. 
Circuits, Dev. and Syst., vol. 152, no. 1, Feb. 2005, pp.7-15. 
[14] S. Hintea, G. Csipkes, C. Rus, D. Csipkes, and H. Fernandez-
Canque, â€œOn the Design of a Reconfigurable OTA-C Filter 
for Software Radioâ€, IEEE 2nd NASA/ESA Conf. on Adaptive 
Hardware and Systems (AHS 2007), Aug. 5-8, 2007, pp. 541-
546, Edinburgh.  
[15] H. Liu, Z. Fu, F. Lin, â€œA Low Power Gm-C Complex Filter 
for ZigBee Receiverâ€, IEEE Microwave and Millimeter Wave 
Technology (ICMMT 2012) Int. Conf. on, May 5-8, 2012, 
pp.1-4, Shenzen, China. 
81
Copyright (c) IARIA, 2013.     ISBN:  978-1-61208-284-4
ICWMC 2013 : The Ninth International Conference on Wireless and Mobile Communications

