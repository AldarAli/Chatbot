Seamless Medical Image Processing on the Grid on the Example of Segmentation and
Partition of the Airspaces
Andrzej Rutkowski, Michał Chlebiej
Faculty of Mathematics and Computer Science
N. Copernicus University
Toru´n, Poland
Email: {rudy,meow}@mat.umk.pl
Marcelina Borcz, Rafał Kluszczy´nski,
Krzysztof Benedyczak, Piotr Bała
Interdisciplinary Centre for Mathematical and
Computational Modeling, University of Warsaw
Warsaw, Poland
Email: {mborcz,klusi,golbi,bala}@icm.edu.pl
Abstract—In this paper, we present method to process medical
images on the grid in the seamless manner. The only software
required on the client side is a web browser which is used to
upload ﬁles, submit analysis and present results. The proposed
solution is easy to deploy and use. It meets user requirements
to focus on medical diagnosis rather than technical details.
The proposed system is built based on the UNICORE grid
middleware including recently developed UNICORE Portal. It
is deployed on the Polish National Grid Infrastructure (PL-
Grid). Due to the novel grid technology, the whole process is
handled in the secure way without additional inconveniences. The
developed infrastructure has been used to segment and partition
the airspaces in a human head.
Keywords–Medical imaging; Segmentation; Grid computing;
Web portal.
I.
INTRODUCTION
The development in the imaging techniques makes analysis
of the medical images important part of the medical doctor
activities [1]. However, an automatic analysis of the images
still cannot be trusted and the process depends on the doctor’s
experience and knowledge.
The number of different approaches and tools used for
processing and analysis of the medical images is large which
makes diagnoses more complicated [2]. Progress in the com-
puter technology leads to more and more sophisticated and
resources consuming applications. Usage of emerging tech-
nologies, such as clouds and grids, leads to the security and
privacy issues which have to be addressed properly. In addition,
access to the remote resources is still not easy and requires
dedicated software which has to be installed on the user’s
computer.
Based on the grid technology, we have developed solution
to process medical images in the seamless manner. With the
web browser available on the user’s computer it is possible
to upload ﬁles, submit analysis and present results with no
additional software needed. Due to the novel grid technology
used, the whole process fulﬁlls security requirements without
additional inconveniences.
The analysis is based on the 3D CT images of the patient
head. The traditional segmentation of the airspace is difﬁcult
and leads to uncertain results [3][4]. Therefore, we rely on the
atlas based, non-linear registration paradigm that allows for
high level automation of the whole volumetric processing.
The developed IT infrastructure [5][6] has been used to seg-
ment and partition the airspaces in a human head. In particular,
the detailed analysis of the separated sinuses in terms of their
shape, symmetry and anatomy deviations are detected. The
computer analysis of the images requires signiﬁcant computer
resources and cannot be performed in the short time using
typical desktop or workstation computer.
The paper is organized as follows: in Section II, we present
algorithm used to to segment and partition the airspaces in
a human head as well as overview of the computational
infrastructure. Section III provides description of the grid mid-
dleware used. In Section IV the SinusMed application written
in the Java language and installed on the high performance
computing system together with the portal access is presented.
The conclusions are presented in the Section V.
II.
IMPLEMENTATION
To address the problem, we have created a segmented
and partitioned atlas model using healthy patient data. The
aerial segments were separated using interactive tools with a
guidance of skilled throat specialist. For every single patient
data, we selected automatically the most suitable data from
the series of measurements differing with the volume size and
spatial orientation.
Figure 1. The schematic view on the detection of the airspaces through
deformation.
After that, the registration phase of model CT data and
selected volume begins. We apply the afﬁne registration fol-
lowed by the non-linear Free Form Deformation parametrized
by B-splines. The resulting deformation ﬁeld is applied to the
248
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-384-1
eTELEMED 2015 : The Seventh International Conference on eHealth, Telemedicine, and Social Medicine

segmented and labeled sinuses atlas to delineate the proposed
partitioning of aerial spaces for a given patient. Due to the
signiﬁcant differences in anatomy, the result is used as a
starting point for a ﬁnal segmentation. The last stage consists
of the volumetric tuning of every segment boundary using
patients original data. The segmentation process as a sequence
of the deformation ﬁelds starting form a rough estimate to
more detailed approximation is presented in the Figure 1.
The whole process is time consuming. It can take several
hours on a typical computer if a high resolution is required.
Another problem is access to the atlas data. With the avail-
ability of new image data, the atlas can be extended leading to
the better quality of the segmentation. This leads to a frequent
updates and can be difﬁcult while locally installed software
is used. The ultimate solution is to use external resources to
perform whole analysis.
Non-linear registration portion of the algorithm is paral-
lelized on the level of optimizing position of a single control
points of B-spline grid, with respect to energy function. The
main challenge is that multiple threads can’t work on a close
control points, because each has an impact on energy function
in a signiﬁcant portion of adjacent voxels. In current imple-
mentation, the work manager spawns work to separate threads
by ﬁnding non colliding areas that need to be registered. It
is possible to allow slight overlay between these areas, since
the effects of deformation by single control point are very
slim on edges of these areas. We found that allowing control
points to be as close as 3.5 units in index space is suitable.
Each thread works locally and tries to minimize local energy
function. After receiving results from the thread, the manager
tries to allocate new job for that worker. Threads don’t need
to communicate with each other during local minimization.
Spawning jobs and gathering results are the only points where
threads communicate with manager.
The presented parallelization strategy does not scale to the
larger number of threads. Therefore we are working on a new
implementation that will make use of a multiple nodes of the
most time consuming registration phase. As more atlas data
with variant anatomical structures will be available, it will be
natural to process input data against all atlases in parallel. Final
result will be constructed from atlas that ﬁts the input the best,
i.e. requires the smallest deformation to achieve the same level
of energy function.
The CT images uploaded to the remote storage can be
analyzed using high performance systems with multiple pro-
cessors. Such model allows to reduce processing time to
several or even single minutes. In addition, the extensive
repository of patient data can be built.
Since processing of patient data requires high level of the
security and privacy, the grid technology is ultimate choice [5].
The grid middleware allows for an access to the distributed
resources with secure manner. The tools vary and depend on
the software used. The typical grid middleware has three tier
architecture with the client layer exposed to the end user. The
technology used ranges from the command line type of access
through libraries, graphical clients up to a web interfaces. The
web access is particularly important for the medical users,
since they are focused on the analysis of the images rather
than technical issues.
The web access to the remote resources have been de-
veloped by the numerous groups using different technologies,
such as web gateways or web portals [7][8][9]. Unfortunately,
most of them is complicated and requires extensive software
stack. In result they are difﬁcult to install and manage. The
extensions such as introduction of new functionality or adop-
tion to new application areas is especially time consuming.
The ultimate solution is UNICORE, which provides whole
software stack including web interface. What is also important,
the UNICORE does not require signiﬁcant effort to install and
maintain.
III.
UNICORE INFRASTRUCTURE
Typical UNICORE [10][11] infrastructure consists of two
groups of services. First one contains services UNICORE
Registry, UVOS, Service Orchestrator and Workﬂow Engine.
They are run at ICM with redundant instances of Registry and
UVOS at WCSS site. Second group contains services which
allows access to sites’ resources. Those are UNICORE/X and
UNICORE TSI together with the UFTPD for fast ﬁle transfer.
After UNICORE 7 has been released, there has been started
migration to new main attribute source for UNICORE servers.
This was mostly because of new features allowing users to
access resources without complicated certiﬁcate setup. For that
reason, new service called Unity IDM [12] was designed and
developed. The goal is to replace UVOS in nearest future and
to use it as the main authentication and authorization service
in PL-Grid for UNICORE users.
The Rich Client based on the Eclipse Rich Client Platform
is the main access tool for the users. The Rich Client is
easy to install and conﬁgure, however for the unexperienced
user this task is still too complicated. The UNICORE Portal
is the recently added element to the UNICORE portfolio of
client applications [13]. It is much different from the other,
already existing, client software, as it is using two separate
software components to realize the clients functionality: a
thin web browser client (UNICORE unaware) and the Portal
servlet which serves as a Grid gateway. Such design, typical
for the Web applications, brings several challenges: the Portal
application has to be used by multiple users simultaneously
what requires proper context separation and careful manage-
ment of resources (disk space, memory) which are much more
constrained than in the standalone client case. The UNICORE
Portal provides ready to be used interface for a generic jobs.
This interface is a web version of the Generic Grid Bean
available in the UNICORE Rich Client. The UNICORE portal
allows for the development of a domain speciﬁc interfaces
tuned for the particular use cases. This work still requires
programming skills, but is much more easier compare to the
other science gateways software stacks.
IV.
RESULTS
The described algorithm for the segmentation of airspaces
has been implemented as a SinusMed application written in
the Java language and installed on the high performance
computing system. It has been parallelized using Java threads
which allowed us to reduce computation time from hours
to several minutes. Further parallelization is in progress and
should lead to reduction of the analysis time to few minutes
with hundreds of cores used.
The disk space and computational resources are provided
by the Polish National Grid Infrastructure (PL-Grid) [6][14]
249
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-384-1
eTELEMED 2015 : The Seventh International Conference on eHealth, Telemedicine, and Social Medicine

which is open for research and education usage and is provided
to the Polish research community free of charge.
The UNICORE Portal has been installed and integrated
with the PL-Grid infrastructure as presented in the Figure 2.
In particular, it has been integrated with the Unity authorization
and authenticated system. Unity allows its users to enable
authentication (or login) to their web services using various
protocols, with different conﬁgurations for many relaying
parties. The authentication can be performed using the built-in,
feature-rich users database or can be delegated to one of the
supported upstream identity providers (IdPs). The information
obtained from the IdPs can be ﬂexibly translated and merged
with the local database (if needed) and re-exported using other
protocols.
Figure 2. The UNICORE Portal Deployment in the PL-Grid.
In terms of the PL-Grid infrastructure, users using the
UNICORE Portal or working with the standalone clients like
UCC or URC, may use login and password provided during
their registration in the PL-Grid portal. Those credentials are
stored using central LDAP server. Unity binds to this server
during authentication and reads user attributes and groups. This
data is further processed by the Unity using input translation
rules. The details of the authorization and authentication pro-
cess in the PL-Grid are presented in the Figure 3. The main
beneﬁt is that user do not have to hassle with the certiﬁcates
and the communication stays secure and trustworthy which is
especially important while processing medical data.
Figure 3. The communication ﬂow between different infrastructure
components during user authentication and authorization.
Unity is not yet another bundle of several, coupled together
systems. It is a solution built from the ground up. All pieces
perfectly ﬁt together. Startup is fast, administration of all parts
is performed in the same style and the whole solution is fully
web and cloud ready.
Thanks to the the UNICORE Portal solution, user can
submit a job, monitor it and see results from all UNICORE
clients. Using the portal he can switch to simple mode where
jobs for only one application type are displayed in the web
browser.
Figure 4. The interface to the SinusMed application: input data for the
analysis.
The developed by us SinusMed extension to the UNICORE
Portal allows to upload packed images in the DICOM-Dir
format and process them on the grid. As presented in the Figure
4, the user has to select the atlas to be used and quality of the
results. Than simulation is started using Submit button.
250
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-384-1
eTELEMED 2015 : The Seventh International Conference on eHealth, Telemedicine, and Social Medicine

In return, the user obtains set of images with the paranasal
sinuses areas marked. He can modify display parameters with
the buttons and display different 2D layers with the navigation
bar (see Figure 5).
Figure 5. The interface to the SinusMed application deployed in the
UNICORE Portal. The results of example analyses are presented.
The images are processed on the grid with the parallel
application described above. It produces high quality images
and allows for reliable determination of the important regions,
their size and volume in the reasonable time. Since SinusMed
application is parallelized, it can beneﬁt from the multicore
nodes available in the PL-Grid. The same time, the access is
simple and no dedicated software is required on the client side.
V.
CONCLUSIONS
Presented example clearly shows that grid technology be-
came mature enough to offer reliable, high quality services
designed to suit requirements of a different scientiﬁc commu-
nities. In particular, web interface as well as automation of the
processing of selected applications have been developed using
UNICORE Portal. In result, the medical doctors can focus on
the diagnosis instead of writing complicated scripts, transfer-
ring the ﬁles and mastering complicated IT infrastructure.
With the UNICORE Portal, creation of the application and
domain speciﬁc solution become simple and straightforward.
The software stack necessary to build full featured gateway
is now small and easy to handle. Presented work shows, that
based on the UNICORE framework service to support medical
diagnosis can be bring to the users.
In the near future, we plan to extend system by additional
functionality such as estimation of the key parameters of the
segmented areas and extraction of the segmented objects for
further processing. The database of the patient data will be
used with the extensive search functionality and will be used
to improve segmentation results and to aid doctors in the
diagnosis process.
ACKNOWLEDGMENT
This work was made possible thanks to the PL-Grid Plus
and PL-Grid NG projects. This research was supported in part
by the PL-Grid Infrastructure. This research was supported in
part by the PL-Grid Infrastructure. The authors thank prof.
A. Kukwa from Faculty of Medical Sciences, University of
Warmia and Mazury for providing inspiration and medical data
for tests.
REFERENCES
[1]
G. Dougherty, Ed., Medical Image Processing.
Springer, 2011.
[2]
I. Bankman, Ed., Handbook of medical image processing and analysis.
Academic Press, 2008.
[3]
A. S. Naini, T.-Y. Lee, R. V. Patel, and A. Samani, “Estimation of
lung’s air volume and its variations throughout respiratory ct image
sequences,” Biomedical Engineering, IEEE Transactions on, vol. 58,
no. 1, 2011, pp. 152–158.
[4]
M. Alves Jr, C. Baratieri, C. T. Mattos, D. Brunetto, R. d. C. Fontes,
J. R. L. Santos, and A. C. d. O. Ruellas, “Is the airway volume being
correctly analyzed?” American Journal of Orthodontics and Dentofacial
Orthopedics, vol. 141, no. 5, 2012, pp. 657–661.
[5]
P. Bala, K. Baldridge, E. Benfenati, M. Casalegno, U. Maran, and
L. Miroslaw, “Unicore: A middleware for life sciences grid,” in
Handbook of Research on Computational Grid Technologies for Life
Sciences, Biomedicine, and Healthcare.
IGI Global, 2009, pp. 615–
643.
[6]
J.
Kitowski,
K.
Wiatr,
P.
Bała,
M.
Borcz,
A.
Czy˙zewski,
R. Kluszczy´nski, J. Kotus, P. Kustra, N. Meyer, A. Milenin et al., “De-
velopment of domain-speciﬁc solutions within the polish infrastructure
for advanced scientiﬁc research,” in Parallel Processing and Applied
Mathematics.
Springer Berlin Heidelberg, 2014, pp. 237–250.
[7]
M. Thomas, S. Mock, and J. Boisseau, “Development of web toolk-
its for computational science portals: The npaci hotpage,” in High-
Performance Distributed Computing, 2000. Proceedings. The Ninth
International Symposium on.
IEEE, 2000, pp. 308–309.
[8]
N. Wilkins-Diehr, D. Gannon, G. Klimeck, S. Oster, and S. Pamidighan-
tam, “Teragrid science gateways and their impact on science,” Com-
puter, vol. 41, no. 11, 2008, pp. 32–41.
[9]
Z. Farkas and P. Kacsuk, “P-grade portal: a generic workﬂow system
to support user communities,” Future Generation Computer Systems,
vol. 27, no. 5, 2011, pp. 454–465.
[10]
A. Streit, P. Bala, A. Beck-Ratzka, K. Benedyczak, S. Bergman,
R. Breu, J. M. Daivandy, B. Demuth, A. Eifer, A. Giesler et al., “Unicore
6 - recent and future advancements,” Annales des t´el´ecommunications,
vol. 65, no. 11-12, 2010, pp. 757–762.
[11]
“UNICORE,” 2014, URL: http://www.unicore.eu/ [accessed: 2014-01-
02].
[12]
“UNITY,” 2014, URL: http://www.unity-idm.eu/ [accessed: 2014-10-
22].
[13]
M. Petrova, V. Huber, B. Demuth, K. Benedyczak, and B. Schuller,
“The unicore portal,” UNICORE Summit 2013: Proceedings, 18th June
2013— Leipzig, Germany, vol. 21, 2013, p. 47.
[14]
J. Kitowski, M. Turała, K. Wiatr, and L. Dutka, “Pl-grid: Foundations
and perspectives of national computing infrastructure,” in Building
a National Distributed e-Infrastructure
PL-Grid, ser. Lecture Notes
in Computer Science, M. Bubak, T. Szepieniec, and K. Wiatr, Eds.
Springer Berlin Heidelberg, 2012, vol. 7136.
251
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-384-1
eTELEMED 2015 : The Seventh International Conference on eHealth, Telemedicine, and Social Medicine

