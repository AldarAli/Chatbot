Mathematical Modeling of Water Purification Process of Iron Containing
Impurities
Tatiana Kudryashova and Sergey Polyakov
Keldysh Institute of Applied Mathematics RAS
Moscow 125047, Russia
e-mail: kudryashova@imamod.ru, sergepol@mail.ru
Abstract—This paper is devoted to mathematical modeling
processes of water treatment from iron impurities. This
problem is relevant for many applications, including the
preparation of ultrapure water for medicine. The paper deals
with a process of removing iron ions and iron oxides from
water by means of a magnetic field. The two-dimensional
formulation of the model problem is examined through the
incompressible
flow
approximation
in
a
channel
with
rectangular cross section. A special numerical method and
parallel program were designed to solve the problem. The
distributions of the concentration of the iron ions under the
effect or lack of transverse magnetic field were obtained in
numerical experiments.
Keywords-mathematical
modeling;
numerical
methods;
parallel algorithms; water treatment processes.
I.
INTRODUCTION
This paper deals with modeling the processes of
magnetic treatment of water. The processing can be applied
to many industries, such as heat energetics and related
industries. Water treatment of impurities and hardness salts
(carbonate, chloride and sulfate salts of Ca2+, Mg2+, Fe2+ and
Fe3+) is used in the heat exchangers, piping and plumbing
systems in various ways, including mechanical, chemical,
electrophysical ones, etc. Nowadays, one of the most acute
problems deals with obtaining drinking water and ultrapure
water for pharmacology. For these purposes, all possibilities
of water purification are used (water structuring and
catching finely dispersed salts of heavy metals by a
magnetic
field).
Magnetic
water
treatment
is
widely
implemented in different industries, such as construction
industry and agriculture. In the construction industry, the
use of magnetic water in the hydration phase of cement
processing reduces the time of solidification of cement
clinker components with water. A fine-grained structure of
the generated solid hydrates makes the product far stronger
and increases its resistance to aggressive environmental
influences [1]. In agriculture, five-hour seed soaking in
magnetized water improves seed germination and can
significantly increase the yield. Watering with magnetized
water stimulates 15-20% growth and yield of soybean,
sunflower, corn, tomatoes [2]. In medicine, the use of
magnetized water helps to dissolve kidney stones and has a
bactericidal effect.
It is well known that the effect of magnetic fields on
water is of a complex multifactorial nature. It results in
water structure changes, its physical and chemical properties
and
dissolved
inorganic
salts
behavior
in
water
[1].
Chemical reactions in water have different speeds under the
influence of amagnetic field. Magnetic treatment water
softening appears to be very promising. Scale-forming salts
accelerated crystallization in water occurs during such
processing.
This
leads
to
a
significant
reduction
of
concentrations of dissolved ions
2
Ca+ ,
2
Mg+ , and other
metals. The crystals size reduction under heating is also the
result of water magnetic treatment. The magnetized water
can
change
the
aggregate
stability
and
accelerate
coagulation (adhesion and sedimentation) of suspended
particles with subsequent formation of finely dispersed
sediment. This ability is implemented to remove sediments
from water. Magnetization of water can also be applied for
water supply plants with significant turbidity of natural
waters. Such magnetic treatment of industrial waste water
allows us to precipitate fine dirt quickly and effectively.
Magnetic treatment of water helps to prevent the scale-
forming salts precipitation and significantly reduces the
organic substances deposits, such as paraffin. Magnetic
treatment
is
useful
for
the
high
paraffin
crude
oil
production. The influence of magnetic field increases
provided the oil contains water.
In this work, the influence of the magnetic field on water
is studied. A water stream contains ions of iron and/or iron
salts ions and
flows through a nonmetallic pipe. A
magnetohydrodynamic model was created for this problem.
The model takes into account the magnetic induction direct
effect on the stream of water. In this case, the ion flux
generates a secondary electric field. The paper deals with
the two-dimensional plane-parallel flow. The flow is formed
in the middle section of a rectangular tube with a strong
anisotropy of sides. A magnetic field is applied in the
transverse direction of the flow and generates circular
motions in this section of the tube. In this case, the flow
structure is similar to the two-dimensional model and can be
seen as an initial approximation for the three-dimensional
problem [3] [4]. The isothermal laminar flow of fluid is
examined to simplify the analysis. The drift-diffusion
approximation is used to describe the behavior of the finely
dispersed impurities.
This paper is organized as follows. In Section 2, we
describe the mathematical model of the problem. We then
present, in Section 3, some details of the numerical
algorithm. In Section 4, the main results obtained for the
35
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-506-7
ADVCOMP 2016 : The Tenth International Conference on Advanced Engineering Computing and Applications in Sciences

steady state distribution in the stream are shown, including
distribution of electrical potential, distribution of impurity
concentration, and distribution of electrical field.
This
paper
discusses
water
purification
of
iron
impurities processes. We propose some approaches to the
issue in question, and finally we offer some conclusions.
II.
MATHEMATICAL DESCRIPTION
An isothermal variant of water flow with impurity of iron
is considered. The flow is studied in the non-conductive pipe
with rectangular cross-section and with a big difference
between the sizes of sides (Fig. 1).
The impurities are finely dispersed and we do not take
into account the processes of association and dissociation of
individual ions in clusters.
The basic equations describe water motion with impurity
in the computational domain Ω [5]. This area is section z=0
of the original three-dimensional domain and its size is
L
× H
. The equations (1)-(3) in dimensional variables have
form [6]:
(
)
,
0,
p
div
t
ρ
ρ
η
∂
+
∇
= −∇ + ∆
=
∂
u
u
u
u
u
(1)
(
) (
)
,
,
n
div D n
q
n
u
n
t
µ
∂
=
∇ −
+
∇
∂
F
(2)
(
)
(
)
* ,
,
div
q n
n
ε
ϕ
=
−
= −∇
E
E
(3)
where
(
)
,
,0
x
y
u
u
u =
– velocity vector of water stream,
( )
0
T
ρ
= ρ ρ
– water density at the specified temperature T,
p – pressure in water stream,
0 ( )
T
η
=η η
– dynamic
viscosity coefficient of water stream at the specified
temperature,
*n and n – equilibrium and non-equilibrium
concentrations of impurity ions in water,
( )
0
D
= D D T
,
( )
0
T
µ
= µ µ
– diffusion coefficient and coefficient of ion
mobility, q – ion charge,
[
]
=
+
×
F
E
u B
– the total vector
field acting on the ions, E and ϕ – strength and potential of
the electric field,
0
B = B z
e
– vector of magnetic field
strength
(
(
ez = 0,0,1)
),
div
and
∇
–
operators
of
divergence and gradient in the spatial coordinates (
)
,x y , ε
– dielectric constant of water.
Initial conditions (4):
(
)
0
0
,
,
0,
,
.
n
n
t
x y
=
=
=
∈Ω
u
u
(4)
Boundary conditions (5) - (7):
( )
0
0 :
,
0,
,
0;
x
n
y
x
u
u
y
u
n
n
x
∂ϕ
=
=
=
=
=
∂
(5)
:
0,
0,
0,
0;
y
x
u
u
n
x
L
x
x
x
x
ϕ
∂
∂
∂
∂
=
=
=
=
=
∂
∂
∂
∂
(6)
0,
:
0,
0,
0,
0.
x
y
u
n
y
H
u
y
y
y
ϕ
∂
∂
∂
=
=
=
=
=
∂
∂
∂
(7)
At low speeds, the flow becomes stationary and can be
determined by the transition to the variables ψ (current
function) and ω (vortex). If we assume that the flow is
irrotational, the Laplace’s equation (8), (9) can be used to
calculate water stream [7]:
(
)
2
2
2
2
0,
,
;
x y
x
y
ψ
ψ
ψ
∂
∂
∆
≡
+
=
∈Ω
∂
∂
(8)
(
)
,
,
,
.
x
y
u
u
x y
y
x
ψ
ψ
∂
∂
=
= −
∈Ω
∂
∂
(9)
The boundary conditions for the current function are
expressed as follows (10), (11):
(
)
( )
(
)
0
0,
;
,
0;
y
n
y
u
y dy
L y
x
ψ
ψ
∂
=
=
∂
∫
(10)
(
)
(
)
,0
0;
,
0.
x
x H
x
x
ψ
ψ
∂
∂
=
=
∂
∂
(11)
The equation for the concentration can be written in form
(12):
(
)
,
,
n
div
Qn
t
∂
=
+
+
∂
W
R W
(12)
where
(
)
D
n
n
=
∇ −
W
P
,
q D 1
µ
−
P =
F
,
R = D−1
u
,
(
)
1
,
Q
q D
µ
−
=
u F .
For solving of the problem we used the dimensionless
variables
'
/
x
= x H
,
'
/
y
= y H
,
0
'
/
t
= t t
,
0
'
/ u
ψ
=ψ
,
0
'
/ u
u =
u
,
0
'
/
n
= n n
,
0
'
/
ϕ
= ϕ ϕ
,
0
'
/ E
E =
E
,
(
)
(
) (
)
{
}
'
',
'
0,
0,1
x y
L
Ω =
∈
×
,
0
/ 0
t
= H u
,
2
0
0
qn H /
ϕ
ε
=
,
0
0 /
E
H
= ϕ
.
We neglect the temperature dependence of the diffusion
coefficient and the mobility coefficient.
Then, the resulting formulation of the problem (13) - (15)
is written as [3], [4]:
0,
,
,
x
y
u
u
y
x
ψ
ψ
ψ
∂
∂
∆
=
=
= −
∂
∂
(13)
36
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-506-7
ADVCOMP 2016 : The Tenth International Conference on Advanced Engineering Computing and Applications in Sciences

Figure 1.
3D (a) and 2D (b) computational domains.
(
)
,
,
n
div
Qn
t
∂
=
+
+
∂
W
u W
(14)
(
)
* ,
,
n
n
E
ϕ
ϕ
∆
= −
−
= −∇
(15)
where
(
),
n
n
D
n
P
n
=
∇ −
W
F
(
)
0
0
/
,
Dn
D
Hu
=
1
0
0
0 ,
nP
q
µ E u
−
=
(
, )
,
n
Q
= Q
u F
1
0
0
0 ,
Qn
q
µ E HD
−
=
[
],
n
z
B
=
+
×
F
E
u e
1
0
0
0
Bn
= u B E −
. The basic dimensionless
parameters of the problem are: L ,
n
D ,
nP ,
n
Q ,
n
B .
The initial conditions take the form:
( ) (
)
( )
(
)
2
0
1,0 ,
1,
1
2
1
.
n
n
u
y
n
u
y
y
=
=
×
=
≡ −
−
u
u
(16)
The boundary conditions for
x = 0
(17):
(
)
( )
0
'
',
,
0,
1,
0.
y
n
x
n
y
u
y
dy u
u
y
u
n
x
ϕ
ψ
∂
=
=
=
=
∂ =
∫
(17)
The boundary conditions for x
= L
take the form (18):
,
,
,
,
0.
y
x
u
u
n
x
x
x
x
x
ψ
ϕ
∂
∂
∂
∂
∂
=
∂
∂
∂
∂
∂
(18)
The boundary conditions for
y = 0,1
are formulas (19):
,
,
,
,
0.
x
y
u
n
u
x
y
y
y
ψ
ϕ
∂
∂
∂
∂
=
∂
∂
∂
∂
(19)
III.
NUMERICAL ALGORITHM
The finite difference method is proposed to solve the
problem.
To
do
this,
we
introduce
a
uniform
grid
h
x
y
ω
ω
Ω =
×
in domain Ω . The grid is multiplication of 1D
grids
{
}
,
0,...,
,
/
x
i
x
x
x
x
x
h
i i
N
h
L N
ω =
=
⋅
=
=
and
{
}
,
0,...,
,
1/
y
j
y
y
y
y
y
h
j j
N
h
N
ω =
=
⋅
=
=
, where
x
N ,
y
N
– the number of network segments on x and y. We introduce
also
grid
h
x
y
ω
ω
Ω =
×
,
where
we
use
1D
grids
(
)
{
}
1/2
1
0.5
,
1,...,
,
x
i
i
i
x
x
x
x
i
N
ω
−
−
=
=
+
=
and
(
)
{
}
1/2
1
0.5
,
1,...,
y
j
j
j
y
y
y
y
j
N
ω
−
−
=
=
+
=
, and uniform grid
on time
{
}
,
0,...,
t
k
t
t
k k
N
ω
τ
=
=
⋅
=
(τ – the time step,
t
N
– number of steps). The current function is defined on
h
Ω
grid (in grid nodes), other functions – on the grid
h
Ω (in the
centers of the cells).
Standard differential equations are written for the current
function, of the velocity vector and the potential of electric
field [5][6]. They can be supplemented with boundary
conditions (20), (21), if it is necessary:
(
)
(
)
(
)
0,
,
;
h
h
h
h
h
xx
yy
x y
ψ
ψ
ψ
Λ
≡
+
=
∈Ω
(20)
(
)
(
)
(
)
,
,
,
,
,
,
0.5
,
,
;
0.5
,
x h
h y
h y
h
y h
h x
h x
u
x y
u
ψ
ψ
ψ
ψ

= +
+

∈Ω

= −
+

(
)
(
)
(
)
(
)
* ,
,
;
h
h
h
h
h
h
xx
yy
n
n
x y
ϕ
ϕ
ϕ
Λ
≡
+
= −
−
∈Ω
(21)
(
)
,
,
.
h
h
h
h
E
x y
= −∇ ϕ
∈Ω
To approximate the equation for the concentration, we
write it in a modified form (22), using a double integral
transformation [7][8]:
(
)
(
)
1
1
,
x
x
y
y
x
y
n
g W
g W
Qn
t
g
x
g
y
∂
∂
∂
=
+
+
∂
∂
∂
(22)
where
(
),
n
x
x
y
y
Q
Q
u F
u F
=
+
,
x
x
n
y
F
E
B u
=
+
,
y
y
n
x
F
E
B u
=
−
0
exp
' ,
x
x
x
g
 u dx

=




∫
0
exp
' ,
y
y
y
g
u dy


=






∫
(
)
1
,
x
n
x
x
W
D
e n
e
x
∂
=
∂
(
)
1
,
y
n
y
y
W
D
e n
e
y
∂
=
∂
0
exp
' ,
x
x
n
x
e
P F dx


=
−



∫
0
exp
' .
y
y
n
y
e
P F dy


=
−





∫
Explicit-implicit
difference
scheme
is
written,
supplemented by appropriate boundary conditions (23), (24):
0
ˆ
ˆ
ˆ ,
1,
h
h
h
h
h
h
h t
n
n
n
Q n
n
τ
=
−
= Λ
+
=
(23)
37
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-506-7
ADVCOMP 2016 : The Tenth International Conference on Advanced Engineering Computing and Applications in Sciences

(
)
(
)
(
)
(
)
,
,
,
,
,
,
1
1
ˆ
,
h
h
x h
x h
y h
y h
x
x
x
x
x h
y h
n
g
W
g
W
g
g
Λ
=
+
(24)
where
,
0
'
exp
,
x h
x
x
x
x
g
u h
≤
≤


=




∑
,
0
'
exp
,
y h
y
y
y
y
g
u h
≤
≤


=




∑
(
)
,
,
,
1
,
x h
n
x h
h
x
x h
W
D
e
n
e
=
(
)
,
,
,
1
,
y h
n
y h
h
y
y h
W
D
e
n
e
=
,
,
0
'
exp
,
x h
n
x h
x
x
x
e
P F h
≤
≤


=
−



∑
,
,
0
'
exp
.
y h
n
y h
y
y
y
e
P F
h
≤
≤


=
−



∑
The implementation of schemes is performed by using
iterative algorithms of alternating directions [9] and methods
of non-monotonic sweep.
The parallel realization of the algorithm is based on the
methods of domain decomposition [10] [11], and [12] and a
sweep parallel algorithm. Computer
implementation is
performed by using Message Passing Interface (MPI) and
Open Multi-Processing (OpenMP) technologies [13], [14].
There are both advantages and disadvantages of the
proposed mathematical approach.
Firstly, the proposed model, of course, is incomplete
because it does not take into account the reverse influence of
changes of the ions concentration on flow characteristics.
However, in many cases, these corrections are of little
significance. At the same time, the rejection enables us to
calculate
relatively
easily
the
basic
process
of
an
electromagnetic treatment of water.
Secondly, the transition to the current function enables us
not to worry about condition
0
div
u =
, that (in alternative
numerical algorithms) is a big problem.
Thirdly, the rejection of the calculation of the vortex
structure of flow at low speeds does not have much value,
but saves computation time.
Fourthly, the use of staggered grids enables us to reduce
errors during interpolation of solution from one grid to
another.
Fifthly, the application of exponential schemes releases
from the problem of stability of the solution equation
algorithm for the concentration and separation of boundary
layers. Of course, the implementation of an exponential
scheme increases the computation time. However, this
increase is not catastrophic and can be compensated by using
parallel computing.
Thus,
the
proposed
approach
has
the
following
advantages:
low
time-consuming
and
highly
stable
calculations.
IV. COMPUTATIONAL RESULTS
In this section of the paper, the data on numerical
experiments are described. To test the numerical algorithm,
we chose the calculation variant with values of the
dimensionless parameters
L = 6
,
1
n
D =
,
nP =1
,
1
n
Q =
,
1
n
B =
. Grid parameters are equal:
300
x
N =
,
50
y
N =
,
0.02
x
y
h
= h
=
,
10 4
τ
−
=
.
Figure 2. The stream function distribution in the computational domain.
Figure 3. The velocity modulus distribution in the computational domain.
Figure 4. The steady state distribution of impurity concentration.
Figure 5. The steady state distribution of electrical potential.
Figure 6. The steady state distribution of impurity concentration for
2
n
B =
.
38
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-506-7
ADVCOMP 2016 : The Tenth International Conference on Advanced Engineering Computing and Applications in Sciences

Figure 7. The steady state distribution of impurity concentration into and
near localized area for
1
n
B =
.
Figure 8. The steady state distribution of electrical potential into and near
localized area for
1
n
B =
.
Figure 9. The steady state distribution of electrical field into and near
localized area for
1
n
B =
.
The results of calculations are shown in several figures.
Fig. 2 presents the stream function distribution in the
computational domain. The velocity modulus distribution in
the computational domain is displayed in Fig. 3. The steady
state distribution of impurity concentration is given in Fig. 4.
We can estimate the distribution of electrical potential from
Fig. 5.
Analysis of the data shows the following. The influence
of the magnetic field leads to decreasing ions concentration
at the top of the area for positive values of
n
B parameter and
formation of increased ion concentration at the bottom layer.
Thus, the purification effect of the upper liquid layer is
realized.
The value of cleaning depends on the
n
B parameter. It
becomes noticeable when the Lorentz force is comparable to
the hydrodynamic pressure forces, that is
1
n
B =
. Our
executed calculations show that reduction of impurity
concentration is achieved approximately 2 times for
1
n
B = .
If parameter
2
n
B =
, the reduction of impurity concentration
at the upper liquid layer is about 3.5 times (Fig. 6).
The
space
localized
effect
of
magnetic
field
is
implemented in industrial purification systems. In our work,
we introduce
n
B parameter dependence on the longitudinal
coordinate x . For example, we consider a localization of a
magnetic field in the area
[
x ∈ 1.5,4.5]
and value
1
n
B =
.
The calculation results are presented in Fig. 7 and Fig. 8.
They show that the layer of purified water is situated in the
upper part of the localized area. Water taking may be done
from the region, for example, through a special membrane.
The steady state distribution of electrical field into and near
localized area for
1
n
B =
is shown in Fig. 9.
V.
CONCLUSIONS
The issue of water purification of iron impurities by
means of electro-magnetic methods is discussed in this
paper. A simplified mathematical model was developed for
the model problem, describing the the purification process. A
numerical algorithm was proposed and the parallel code was
constructed for computer experiments. Tests of the code with
various sets of parameters confirmed the operability of the
proposed computational approach.
ACKNOWLEDGMENT
This work was supported by Russian Foundation for
Basic Research (grants №№ 15-01-04620-а, 16-07-00206-а). 
REFERENCES
[1]
O. V. Mosin, E. N. Karnaukhova, A. B. Pshenichnikova, and O. S.
Reshetova, “Electron impact spectrometry in bioanalysis of stable
isotope labeled bacteriorhodopsin.” Sixth International Conference on
Retinal Proteins. Leiden. The Netherlands. . P.115, 19-24 June 1994.
[2]
V. I. Shvets, A. M Yurkevich, O. V Mosin., and D. A Skladnev,
“Preparation
of
deuterated
inosine
suitable
for
biomedical
application.” Journal of Medical Sciences. V. 8. № 4. Pp. 231-232, 
1995.
[3]
B.N.
Chetverushkin,
“Kinetic
Schemes
and
Quasi-Gasdynamic
System of Equations,” Barcelona: CIMNE, 2008.
[4]
T.G. Elizarova, “Quasi-Gas Dynamic Equations,” Berlin Heidelberg
New York: Springer-Verlag, 2009.
[5]
A.A. Samarskii, “The Theory Of Difference Schemes,” New York:
Marcel Dekker, Inc., pp. 1-762, 2001.
[6]
A.A. Samarskii and P.N. Vabishchevich, “Numerical methods for
solving inverse problems of mathematical physics,” Walter de
Gruyter, pp. 1-438, 2007.
[7]
S.V. Polyakov, “Exponential Difference Schemes with Double
Integral
Transformation
for
Solving
Convection-Diffusion
Equations,” Mathematical Models and Computer Simulations, Vol. 5,
No. 4, pp. 338-340, 2013.
[8]
A.A. Samarskii and E.S. Nikolaev, “Numerical Methods for Grid
Equations,” Vol. I: Direct Methods, Vol. II: Iterative Methods, Basel-
Boston-Berlin, Birkhäuser Verlag, pp. 1-502, 1989.
[9]
I.A. Graur, T.G. Elizarova, T.A. Kudryashova, and S.V. Polyakov,
“Numerical investigation of jet flows, using multiprocessor computer
systems.” Mathematical Modelling, 14(6), pp. 51-62., 2002.
[10] T.A. Kudryashova, S.V. Polyakov, V. Podryga, and Yu. Karamzin,
“Multiscale
modeling
of
nonlinear
processes
in
technical
microsystems.” Mathematical modelling, № 7, V 27, pp. 65-74, 2015. 
39
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-506-7
ADVCOMP 2016 : The Tenth International Conference on Advanced Engineering Computing and Applications in Sciences

[11] A. Toselli and O. Widlund, “Domain Decomposition Methods” -
Algorithms and Theory. Springer, 2004.
[12] N. Wilt, CUDA Handbook: “A Comprehensive Guide to GPU
Programming,”
2013,
[Online].
Available
from:
http://www.cudahandbook.com/..
[13] Official documentation and manuals on OpenMP. [Online]. Available
from:
http://www.openmp.org,
http://www.llnl.gov/computing/
tutorials/openMP
[14] Yu. Karamzin, T. Kudryashova, V. Podryga, and S. Polyakov, “Two-
Scale Computation of N2-H2 Jet Flow Based on QGD and MMD on
Heterogeneous Multi-Core Hardware, Advances in Engineering
Software,”
Engineering Computational Technology (ECT 2014):
Book of Summaries of The Ninth International Conference, 2-5
September 2014, Naples, Italy. - Stirlingshire, Scotland: Civil-Comp
Press, p. 28, 2014.
40
Copyright (c) IARIA, 2016.     ISBN:  978-1-61208-506-7
ADVCOMP 2016 : The Tenth International Conference on Advanced Engineering Computing and Applications in Sciences

