On the Distribution of the Distances Between Pairs of Leaves in Phylogenetic Trees
Arnau Mir
Department of Math and Computer Science
University of Balearic Islands
Palma de Mallorca, Spain
arnau.mir@uib.es
Francesc Rossell´o
Department of Math and Computer Science
University of Balearic Islands
Palma de Mallorca, Spain
cesc.rossello@uib.es
Abstract—The distance, or path length, between two nodes
in a phylogenetic tree (rooted or unrooted) is deﬁned as the
length of the unique undirected path connecting these nodes.
In this paper we study the distribution of the distances between
pairs of leaves in fully resolved phylogenetic trees with a
ﬁxed number of leaves. More precisely, we prove both in
the unrooted and the rooted cases that, when the trees are
equiprobably chosen, this distribution approximates a gamma
distribution.
Keywords-phylogenetic trees; statistical distribution;
I. INTRODUCTION
Over the last years there has been an increasing interest in
the study of the statistical behaviour of topological features
in phylogenetic trees under different evolution models [2],
[3], [9], [10]. The motivations for such studies are the
assessment of the validity of an evolutionary model for a
given set of phylogenetic trees, and the objective evaluation
of how atypical a given phylogenetic tree is.
One feature whose behaviour has been studied is the
topological distance, or path length, between pairs of leaves.
Steel and Penny [11] computed the mean value and the
variance of this distance d between two leaves in a fully
resolved unrooted phylogenetic tree with n leaves. The
statistical analysis of this random variable was continued
in [6], where Steel and Penny’s results were generalized to
rooted phylogenetic trees, and in [7], [8], where the median
and the mode of d were computed, both in the rooted and
the unrooted cases. Let us mention that the study of the
distance between pairs of leaves has a further motivation, as
it may be used in the study of the statistical properties of
the nodal distance between phylogenetic trees, an interesting
and mostly open problem in phylogenetics [6], [11].
In this paper, instead of focusing on the exact computation
of the statistical measures for d, we focus on its distribu-
tion, and we prove that, in the fully resolved case, it is
approximately a gamma distribution, in the sense that the
mean quadratic error between the distribution of d and a
gamma distribution of the same mean and mode has limit 0
as n → ∞.
The rest of this paper is organized as follows. In Section
II, we prove our main result for unrooted fully resolved
trees. Then, in Section III we brieﬂy describe how this result
translates to the rooted case, and in Section IV we report
on some experimental results showing the fast convergence
between d and the corresponding gamma distribution. The
paper ends with a Conclusions section.
II. THE UNROOTED CASE
Throughout this paper, by a phylogenetic tree on a set S
we mean a fully resolved (that is, with all its internal nodes
of degree 3) unrooted tree with its leaves bijectively labelled
in the set S. Although in practice S may be any set of taxa,
to ﬁx ideas we shall always take S = {1,...,n}, where n is
the number of tree leaves. For simplicity, we shall always
identify a leaf of a phylogenetic tree with its label.
Let T u
n be the set of (isomorphism classes of) phyloge-
netic trees with n leaves. It is well known [4] that |T u
1 | =
|T u
2 | = 1 and |T u
n | = (2n − 5)!! = (2n − 5)(2n − 7)···3 · 1,
for every n ⩾ 3.
Let k,l ∈ S = {1,...,n} be any two different labels of
trees in T u
n . The distance, or path length, du
T(k,l) between
the leaves k and l in a phylogenetic tree T ∈ T u
n is the length
of the unique path between them. Let’s consider the random
variable
du
kl = distance between k and l in one tree in T u
n .
The possible values of du
kl are Ωu = {1,2,...,n−1}.
Our goal is to approximate the distribution of the vari-
able du
kl on T u
n when the tree and their leaves are chosen
equiprobably. In this case, du
kl = du
12, and thus we can reduce
our problem to study the distribution of the variable du
n :=
du
12.
For every i ∈ Ωu, let
cu
i,n = |{T ∈ T u
n | du
T(1,2) = i}|
(2n−5)!!
denote the fraction of trees in T u
n
where the leaves 1
and 2 are at distance i. The sequence (cu
i,n)i=1,...,n−1 is the
distribution of the variable du
n. From [11, p. 140] and [8],
we have the following result.
Lemma 1: (a) cu
n−1 =
(n−2)!
(2n−5)!! and, for every i = 1,...,n−
2,
cu
i,n =
(i−1)(2n−i−4)!
(2(n−i−1))!!·(2n−5)!!.
100
BIOTECHNO 2011 :  The Third International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-137-3

(b) The mean of du
n is
µn =
n−1
∑
i=2
icu
i,n = 2n−2(n−2)!
(2n−5)!!
(c) The mode of du
n is
mn =
1+
√
8n−15
2

.
Let γ(k,θ) denote a gamma distribution with parameters k
(shape) and θ (scale), and let fγ(k,θ) be its density function.
Recall that the mean of γ(k,θ) is k·θ and its mode is (k−
1) · θ. Our goal in this section is to prove the following
result:
Theorem 1: Consider the gamma distribution γ(kn,θn),
with parameters kn and θn given by
kn ·θn = µn,
(kn −1)·θn = mn,
where
kn
=
2n−2 ·(n−2)!
2n−2 ·(n−2)!−(2n−5)!!⌈(
√
8n−15+1)/2⌉,
θn
=
2n−2(n−2)!
(2n−5)!! −
1+
√
8n−15
2

.
In other words, γ(kn,θn) is the gamma distribution with the
same mean and mode as du
n on T u
n . Let MQEu
n be the mean
quadratic error between the random variable du
n and this
gamma distribution:
MQEu
n =
1
n−1
n−1
∑
i=1
(cu
i,n − fγ(kn,θn)(i))2.
Then, lim
n→∞MQEu
n = 0.
Proof: Let gn(x) be the following function:
gn(x) = (x−1)·2x−1 ·Γ(2n−x−3)·Γ(n−1)
Γ(n−x)·Γ(2n−3)
.
This function satisﬁes that gn(i) = cu
i,n for every i = 1,...,n−
1, and therefore it can be seen as the extension to R+ of the
discrete distribution of du
n.
The sequence (gn(i))n=1,...,n−1 reaches its maximum at mn
of du
n. We want to approximate gn(mn). To do that, we shall
use the following expansion of the logarithm of the Gamma
function:
lnΓ(x) ≈ ln(2π)
2
+

x− 1
2

ln

x− 1
2

−

x− 1
2

,
(1)
for large values of x. Using this expansion and using that
mn =
√
2n+ 1
2 +O((1/n)1/2),
the
expansion
of
the
value
of
lngn(mn)
=
lngn
√
2n+ 1
2 +O

Using these expansions, we obtain the following expres-
sion for the value of fγ(kn,θn)(mn) = mkn−1
n
·e− mn
θn
Γ(kn)·θkn
n
:
fγ(kn,θn)(mn) =
α
β(n),
where:
α
=
2(1/2)·(√π/(√π−
√
2)−1),
β(n)
=
e
√
2/(√π−
√
2) ·Γ
√π/(√π −
√
2)

·(√π −
√
2)
√π/(√π−
√
2) ·n−1/2 +O
1
n

.
We conclude that:
(gn(mn)+ fγ(kn,θn)(mn))2 = C
n +O
 1
n√n

,
where the constant C could be found using the expansions
of gn(mn) and fγ(kn,θn)(mn).
Finally, an upper bound for the mean quadratic error
MQEu
n is found:
MQEu
n
=
1
n−1
n−1
∑
i=1
(cu
i,n − fγ(kn,θn)(i))2
⩽
n
n−1 ·((gn(mn)+ fγ(kn,θn)(mn))2
=
C
n−1 +O
 1
n√n

,
and the right hand side term in this inequality tends to zero
as n goes to inﬁnity, as we claimed. This ﬁnishes the proof
of Theorem 1.
III. THE ROOTED CASE
By a rooted phylogenetic tree on S we mean a fully
resolved (which in this case means with all its internal
nodes of out-degree 2) rooted tree with its leaves bijectively
labelled in the set S. As in the previous section, for simplicity
we consider only the sets of labels Sn = {1,...,n}, with
n the number of leaves of the tree. Let T r
n be the set of
(isomorphism classes of) rooted phylogenetic trees on Sn. It
is well known [4, Ch. 3] that |T r
n | = |T u
n+1| for every n ⩾ 1.
Let k,l ∈ Sn be any two different labels and let T ∈ T r
n .
The distance, or path length, dr
T(k,l) between the leaves
k and l in T is the length of the unique undirected path
between them. We consider now the random variable
dr
kl = distance between k and l in one tree in T r
n ,
which takes values in Ωr = {2,3,...,n}. Arguing as in Sec-
tion II, when the trees and the leaves are chosen equiprob-
ably, we are reduced to study the variable dr
n := dr
12.
For every i ∈ Ωr, let
cr
i,n = |{T ∈ T r
n | dr
T(1,2) = i}|.
The sequence (cr
i,n)i=2,...,n is the distribution of the variable
dr
n.
We have the following result connecting cr
i,· with cu
i,·. For
the sake of completeness, we sketch a direct proof, although
it could be deduced from the explicit computations provided
in [6], [11].
Lemma 3: cr
i,n = cu
i,n+1, for every n ⩾ 2 and i = 2,...,n,
Proof: Consider the usual bijection Φ : T r
n → T u
n+1 that
sends a rooted tree T ∈ T r
n to the unrooted tree Φ(T) ∈ T u
n+1
obtained by adding a new leaf labeled n+1 and a new edge
connecting the root of T with this leaf (cf. [4, Ch. 3]). Then,
dr
T(1,2) = du
Φ(T)(1,2), and therefore Φ induces a bijection
{T ∈ T r
n | dr
T(1,2) = i} → {T ∈ T u
n+1 | du
T(1,2) = i}.
This lemma allows one to translate Theorem 1 into the
rooted case as follows:
Theorem 2: Let γ(kn+1,θn+1) be the gamma distribution
with parameters kn+1 and θn+1 given by
kn
=
2n−2 ·(n−2)!
2n−2 ·(n−2)!−(2n−5)!!⌈(
√
8n−15+1)/2⌉,
θn
=
2n−2(n−2)!
(2n−5)!! −
1+
√
8n−15
2

.
Let MQEr
n be the mean quadratic error between the random
variable dr
n and this gamma distribution:
MQEr
n =
1
n−1
n−1
∑
i=1
(cu
i,n − fγ(kn+1,θn+1)(i))2.
Then, lim
n→∞MQEr
n = 0.
IV. EXPERIMENTAL RESULTS
Figure 1 shows the data plot of (cu
i,n)i=1,...,n−1 and the
gamma density function with parameters k =
√π
√π−
√
2 and
θn = (√π −
√
2)√n as functions of i, for n = 5000 leaves.
The ﬁgure conﬁrms that the distribution of du
n approximates
well this gamma density function.
Figure 2 shows the data plot of minus the logarithm of the
mean quadratic error function (−ln(MQEn)) as a function
of the number n of leaves. The curve hints at the existence
of parameters α and β such that −ln(MQEn) ≈ α +β ln(n),
that is, MQEn ≈ e−α ·n−β. If we adjust the values of the α
and β using the least squares method, we obtain α ≈ 4.659
and β ≈ 1.44. This conﬁrms the theoretical result in Section
II.
V. CONCLUSION
In this paper, we have proven that the distribution of the
distance between a ﬁxed pair of leaves in an equiprobably,
randomly chosen, fully resolved phylogenetic tree with n
leaves approximates a gamma distribution as n goes to ∞.
This result holds in the rooted and the unrooted case.
Our result is purely numerical, and it remains to be seen
whether there is some deep meaning in the relationship
between the distribution of the distances in phylogenetic
102
BIOTECHNO 2011 :  The Third International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-137-3

0
1000
2000
3000
4000
5000
0.000
0.002
0.004
0.006
0.008
distances
ci
Figure 1. Data plot of (cu
i,n)i=1,...,n−1 and the corresponding gamma density
function for n = 5000 leaves. The higher curve corresponds to the gamma
density function, the lower one to du
n.
G
G
G
G
G
G
G
G
G
G
2000
4000
6000
8000
10000
number of leaves
−logarithm of the mean square error
1000
2000
3000
4000
5000
6000
7000
8000
9000
10000
14.60
15.58
16.16
16.57
17.16
17.58
Figure 2. Data plot of −ln(MQEn) as a function of the number n of leaves.
trees and a gamma distribution. Another unanswered ques-
tion is whether the distances between pairs of leaves in the
phylogenetic trees contained in some phylogenetic database,
see TreeBASE ([1]) or PhylomeDB ([5]) are well approx-
imated by using a gamma distribution. A negative answer
would give information on the random model for real-life
phylogenetic trees. We are working currently in this topic.
ACKNOWLEDGMENT
This work has been partially supported by the Span-
ish Government, through projects MTM2009-07165 and
TIN2008-04487-E/TIN.
REFERENCES
[1] M. J. Sanderson, M. J. Donoghue, W. Piel, and T. Eriksson,
TreeBASE: a prototype database of phylogenetic analyses
and an interactive tool for browsing the phylogeny of life.
American Journal of Botany 81 (1994), pp. 183-189. http:
//www.treebase.org/ (last visited: March 11, 2011)
[2] M. Blum, N. Bortolussi, E. Durand, and O. Franc¸ois, AP-
Treeshape: statistical analysis of phylo- genetic tree shape.
Bioinformatics 22 (2006), pp. 363-364.
[3] H. Chang and M. Fuchs, Limit theorems for patterns in phy-
logenetic trees. Journal of Mathematical Biology 60 (2010),
pp. 481-512.
[4] J. Felsenstein: Inferring Phylogenies. Sinauer Associates Inc.
(2004)
[5] J. Huerta-Cepas, A. Bueno, J. Dopazo, and T. Gabald´on,
PhylomeDB: a database for genome-wide collections of gene
phylogenies. Nucleic Acids Research 36 (2008), D491-6.
http://phylomedb.org/ (last visited: March 11, 2011)
[6] A. Mir and F. Rossell´o, The mean value of the squared path-
difference distance for rooted phylogenetic trees. Journal of
Mathematical Analysis and Applications 371 (2010), pp. 168-
176
[7] A. Mir and F. Rossell´o, The median of the distance between
two leaves in a phylogenetic tree. Advances in Bioinformatics,
Proc. IWPACBB 2010 (M.P. Rocha et al, eds.), Advances in
Intelligent and Soft Computing, vol. 74 (Springer, 2010), pp.
131-135.
[8] A. Mir and F. Rossell´o, The mode of the distance between two
leaves in a phylogenetic tree. X Jornadas de Bioinform´atica
(M´alaga, Spain, october 2010).
[9] N. Rosenberg, The mean and variance of the numbers of r-
pronged nodes and r-caterpillars in Yule-generated genealog-
ical trees. Annals of Combinatorics 10 (2006), pp. 129-146.
[10] M. Steel and A. Mooers, The expected length of pendant and
interior edges of a Yule tree. Applied Mathematics Letters 23
(2010), pp. 1315-1319
[11] M.A. Steel and D. Penny, Distributions of tree comparison
metrics—some new results. Systematic Biology 41 (1993),
pp. 126-141
103
BIOTECHNO 2011 :  The Third International Conference on Bioinformatics, Biocomputational Systems and Biotechnologies
Copyright (c) IARIA, 2011.     ISBN: 978-1-61208-137-3

