Recurrent Fuzzy Neural Network Controller Design for  
Ultrasonic Motor Rotor Angle Control 
 
Tien-Chi Chen 
Dept. of Computer and Communication 
Kun Shan University 
Tainan, Taiwan 
e-mail: tchichen@mail.ksu.edu.tw 
Tsai-Jiun Ren 
Dept. of Information Engineering 
Kun Shan University 
Tainan, Taiwan 
e-mail: cyrusren@mail.ksu.edu.tw 
Yi-Wei Lou 
Dept. of Electrical Engineering 
Kun Shan University 
Tainan, Taiwan 
e-mail: oalatraszi@msn.com 
 
 
Abstract—The ultrasonic motor (USM) has significant high 
precision, 
fast 
dynamic, 
simple 
structure 
and 
no 
electromagnetic interference features that are useful in many 
industrial, medical, robotic and automotive applications. The 
USM, however has nonlinear characteristics and dead-zone 
problems due to increasing temperature and motor drive issues 
under various operating conditions. To overcome these 
problems a recurrent fuzzy neural network controller 
(RFNNC) combined with a compensated controller with 
adjustable parameters and on line learning algorithm is 
presented in this paper. The proposed control scheme can take 
the nonlinearity into account and compensate for the USM 
dead-zone. The proposed control scheme provides robust 
performance against parameter variations. The experimental 
results demonstrate the effectiveness of the proposed USM 
control scheme. 
Keywords- ultrasonic motor; recurrent fuzzy neural network; 
compensated controller; adjustable parameters; on line learning 
algorithm. 
I. 
 INTRODUCTION 
The USM has many excellent features such as high 
precision, fast dynamics, simple structure, compactness in 
size and no electromagnetic interference, which is useful in 
many industrial, medical and automotive applications [1-4]. 
However, the USM has nonlinear characteristics and a dead-
zone problem due to the large static friction torque appearing 
at low speed [5]. Hence, it is difficult to design a perfect 
controller to accurately control the USM at all times.  
Conventional PI controllers for common motors have the 
advantages of simple and easy design, high-stability margin 
and high-reliability when the controllers are tuned properly 
[6-7]. However, the PI controller cannot maintain these 
virtues at all times. The USM has nonlinear speed 
characteristics which vary with the drive operating 
conditions. A dynamic controller with adjustable parameters 
and on line learning algorithms is therefore suggested for 
nonlinear or uncertain dynamics systems [8-11]. 
This paper presents a new control scheme for USM rotor 
angle control, the RFNNC combined with a compensated 
controller that has adjustable parameters and an on-line 
learning algorithm to overcome the nonlinear characteristic 
and dead-zone problem. The RFNNC is effective in handling 
nonlinear motor characteristic variations due to connecting 
weight updating in the RFNNC. Furthermore, a compensated 
controller is presented to compensate the USM dead-zone 
effect, which deteriorates the dynamic response. The 
proposed control scheme can take the nonlinearity into 
account and compensate for the USM dead-zone. Robust 
performance against parameter variations is obtained by the 
proposed approach. The usefulness and validity of the 
proposed control scheme is examined through experimental 
results. The experimental results reveal that the proposed 
control scheme maintains good, stable performance under 
different motion conditions. 
II. 
THE PROPOSED CONTROL SCHEME 
Fig. 1 shows the proposed control scheme for the USM 
combined with the RFNNC and compensated controller that 
has adjustable parameters and an on-line learning algorithm 
to overcome the nonlinear characteristic and dead-zone 
problem, where 
c
  the USM rotor angle command, 
r
  the 
USM rotor angle, 
R
u  the RFNNC output control force, 
C
u  
the compensated controller output control force and u is the 
total control force. 
A. RFNNC Structure 
Fig. 2 shows the RFNNC structure, comprised of an 
input layer, membership layer, rule layer and output layer. 
The RFNNC mathematical model is summarized as 
follows. 
(1) Input layer 
The RFNNC inputs are 
c
r
e




 and e . The outputs 
1
,e i
x  and 
1
,e i
x  can be expressed as: 
u
C
u
e
r
uR
c

 
Figure 1. The proposed control scheme for the USM. 
150
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-390-2
COGNITIVE 2015 : The Seventh International Conference on Advanced Cognitive Technologies and Applications

1
w
2
w
9
w
e
e
1
,1
ex
2
,1
ex
1
ex ,9
2
,9
ex
1
,1
ex
2
,1
ex
1
ex,9
2
,9
ex
R
u
11 

12 

19 

21 

22 

29 





1
2
2
,2
ex
2
,2
ex
Layer 1:
Input layer
Layer 2:
Membership layer
Layer 3:
Rule layer
Layer 4:
Output layer
3
1x
3
2x
3
9x
1r
2r
9r
 
Figure 2. The RFNNC structure. 
 
1
,
,   
1,...,9
xe i
e
i


                               (1) 
1
,
,   
1,...,9
xe i
e
i




                               (2) 
(2) Membership layer 
The membership layer outputs 
2
y ,e i
 and 
2
y,e i
 can be 
expressed as a Gaussian function: 
   
2
1
,
,
2
,
,
exp
,  
1,...,9
e i
e i
e i
e i
x
s
x
i
z




















              (3) 
2
1
,
,
2
,
,
exp
,  
1,...,9
e i
e i
e i
e i
x
s
x
i
z
























              (4) 
where 
,1
,9
,1
,9
,...,
,
,...,
T
e
e
e
e
s
s
s
s


 

S


 the 
mean 
Gaussian 
function vector and 
,1
,9
,1
,9
,...,
,
,...,
T
e
e
e
e
z
z
z
z


 

Z


 is the 
Gaussian function standard deviation vector. 
(3) Rule layer  
The rule layer outputs are expressed as: 
3
3
2
2
,
,
(
1)
1
( )
1
( )
( ),  
1,...,9
1 exp
i i
i
e i
e i
r x
t
x t
x
t x
t
i















   (5) 
where 


1
r ,..., 9
r
R 
 is the recurrent weight vector.  
(4) Output layer 
The output layer outputs 
R
u  can be expressed as: 
9
3
1
T T( , , , )
R
i
i
i
u
w x
x s z r




W
                  (6) 
where 
3
3
1
9
( , , , )
,...,
T
x s z r
x
x


 

T
 is fuzzy rule function vector 
and 


1
9
,...,
T
w
w
W 
 is the adjustable output weight vector. 
B. RFNNC and Compensated Controller Design 
Consider the USM nonlinear dynamic system is 
expressed as: 
( )
( ) ( )
( )
y
f y
g y u t
d t




                      (7) 
where f(y) and g(y) are unknown USM functions and assume 
they are bounded, u(t) the control input, d(t) the external 
disturbance.  
The control goal is to design a RFNNC such that the 
USM rotor angle tracks the reference model output angle. 
The tracking error vector is first defined as 


, 
E  e e T

                                   (8) 
From (7) and (8), an ideal controller can be chosen as 
*
1
( )
[
( )
( )
]
( )
T
n
n
n
u t
y
f
y
d t
g
y



 K E

         (9) 
In (9) , 


2
, 1
T
k
k
K 
, in which 
1k  and 
2k  are positive 
constants. Applying (7) to (9), the error dynamics can be 
expressed as 
1
2
0
e
k e
k e





                       (10) 
If K is chosen to correspond to the coefficients of a 
Hurwitz polynomial, that is a polynomial whose roots lie 
strictly in the open left half of the complex plane, then the 
result achieved where 
lim  
0
t
 e t

 for any initial conditions. 
Nevertheless, the functions f(y) and g(y)  aren’t accurate 
known and the external load disturbances are perturbed. 
Thus, the ideal controller 
u*  
t
 cannot be practical 
implemented. Therefore, the RFNNC will be designed to 
approximate this ideal controller.  
The proposed control scheme for the USM combined by 
RFNNC and compensated controller is show in Fig. 1. The 
control force for the USM is the following form: 
R
C
u
u
u


                            (11) 
where the RFNNC output control force 
R
u  is the main 
tracking control to approximate the ideal control force 
 
u*
t . 
From (7), (9) and (11), an error equation is rewritten as: 
( *
)
R
C
u
u
u




E
AE
B

                   (12) 
where 
2
1
0
1
k
k


 





A
 and 
0
( )
g y


 



B
. 
Assume that an optimal RFNNC exists to approximate 
the ideal control force such that 
*
*
*
*
*
*
*
*
( ,
,
,
,
)
T
R
u
u
e






W S Z R
W T
         (13) 
where   is a minimum reconstructed error, 
*
*
*
*
,
,
,
W  S  Z  R  
and 
*
T  are optimal parameters of 
, ,
,
W  S  Z  R  and T , 
respectively. Thus, the control force is assumed to take the 
following form: 
( ,
, , ,
)
T
R
C
C
u
u
e
u
u




W S Z R
W T
 
 


            (14) 
151
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-390-2
COGNITIVE 2015 : The Seventh International Conference on Advanced Cognitive Technologies and Applications

where 
, , , 
W S Z R



 and T  are the optimal parameter 
estimations provided by tuning the algorithms to be 
introduced 
later. 
Subtracting 
(14) 
from 
(13) 
an 
approximation error u  is obtained as 
*
*
*
*
  
T
T
C
T
T
C
u
u
u
u
u












W T
W T
W T
W T






          (15) 
where 
*


W
W
W

 and 
*


T
T
T

. The linearization 
technique transforms the multidimensional receptive-field 
basis functions into a partially linear form such that the 
expansion of T  in Taylor series becomes 
3
3
1
9
,...,
T
s
z
r
v
x
x









T
T S
T Z
T R
O






        (16) 
where 
3
3*
3
i
i
i
x
x
x

 

, 
3*
ix  is the optimal parameter, 
3
ix  is the 
estimated parameter of 
ix3*
, 
 *

S
S
S


, 
*


Z
Z
Z

, 
*


R
R
R

, 
Ov
 is 
higher-order 
terms, 
3
3
1
9
/
,...,
/
T
s
s s
x
s
x
s



 





T
 , 
3
3
1
9
/
,...,
/
T
z
z z
x
z
x
z



 





T

, 
3
3
1
ˆ
/
,...,
/
T
r
k
r r
y
r
y
r



 





T
. 
(16) can be rewritten as 
*
s
z
r
v





T
T
T S
T Z
T R
O




               (17) 
Substituting (17) into (15), it can be rewritten as: 
(
)
T
T
s
z
r
C
u
u
D






W T
W
T S
T Z
T R







          (18) 
where 
*
(
)
T
T
s
z
r
v
D






W
T S
T Z
T R
W O




 is 
the 
uncertainty term and this term is assumed to be bounded 
with a small positive constant  （let D
 
）. From (15) 
and (18), (12) can be rewritten as 
( *
)
  
(
)
T
T
s
z
r
C
u
u
u
u
D
















E
AE
B
AE
B
AE
B W T
WW
T S
T Z
T R








 (19) 
Consider the USM dynamic system is represented by (7) 
if the RFNNC control law is designed as (14) with the 
adaptive laws for networks parameters, as shown in (20)–
(23), and the compensated controller control law is designed 
as (24) with the estimation law given in (25). The stability of 
the proposed control scheme can then be guaranteed, where 
1
2
3
4
5
,  
,  
,  
,  




 are strictly positive constants. 
1
T
W 
TE PB



                                   (20) 
2
T
T
s
S 
T WE PB



                             (21) 
3
T
T
z
Z 
T WE PB



                            (22) 
4
T
T
r
R 
T WE PB



                            (23) 
sgn(
)
T
uC
 
E PB

                             (24) 
5
T


E PB

                                   (25) 
Proof: Define a Lyapunov function candidate as 
1
2
2
3
4
5
1
1
1
( )
(
)
2
2
2
1
1
1
          
2
2
2
T
T
T
T
T
V t
 tr











E PE
W W
S S
Z Z
R R
 



 


               (26) 
where P is a symmetric positive definite matrix which 
satisfies the following Lyapunov equation 
T

 
A P
PA
Q                             (27) 
where Q  is a positive definite matrix. Here, the uncertainty 
boundary estimation error is defined as 






. Taking 
the Lyapunov function (26) differential and using (18) and 
(27), it is concluded that 
 
1
2
3
4
5
1
2
3
4
5
1
1
1
(
)
2
2
1
1
1
1
          
1
      
(
)
2
1
1
1
1
1
         
T
T
T
T
T
T
T
T
T
T
T
s
z
r
C
T
T
T
T
V t
u
u
D












 









 













E QE
E PB
B PE
W W
S S
Z Z
R R
E QE
E PB W T
W
T S
T Z
T R
W W
S S
Z Z
R R





































(28) 
Take (20)-(25) into (28), the derivative of V can be 
rewritten as 
 
5
1
1 (
)
2
1
      
(
)
2
1
      
(
)
0
2
T
T
T
C
T
T
T
T
T
T
V t
D
u
D
D

 





 




 




 



E QE
E PB
E PB
E QE
E PB
E PB
E PB
E QE
E PB
 



  (29) 
This implies that 
E t
will converge to zero as t   . 
As a result the stability of the proposed control system can 
be guaranteed. 
III. 
EXPERIMENTAL RESULTS 
The USM experimental setup is shown in Fig. 3. The 
TMS320F2812 digital signal processor (DSP) is used for 
design the proposed control scheme. The USM driver is used 
to drive the USM, which encoder signal of rotor angle and 
speed are fed back to the TMS320F2812 to construct closed-
loop control. 
 
Figure 3. The USM experiment setup. 
152
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-390-2
COGNITIVE 2015 : The Seventh International Conference on Advanced Cognitive Technologies and Applications

A. A square angle command from -45 to 45 degree 
In Figs. 4, 5 and 6, the USM rotor angle command is a 
periodic square from -45 to 45 degree. The USM rotor angle 
and speed responses using the proposed control scheme are 
depicted in Fig. 4(a). The angle error between the angle 
command and USM rotor angle is depicted in Fig. 4(b). By 
observing the experimental result in Fig. 4, the tracking 
errors can both converge to an acceptable region and the 
control performance is excellent. The proposed controller 
retains control performance and has no dead-zone in the 
construction. 
The USM rotor angle and speed responses using the 
RFNNC without compensated controller are depicted in Fig. 
5(a). The angle error is depicted in Fig. 5(b). Compared with 
the RFNNC without compensated controller in Fig. 5, it can 
be seen that the RFNNC without compensated controller can 
achieve barely satisfactory response in each state. But, it 
exhibits a chattering phenomenon due to the dead-zone 
especially in slow speed nearby zero. 
The USM rotor angle and speed responses using the PI 
control are depicted in Fig. 6(a). The angle error is depicted 
in Fig. 6(b). In Fig. 6 illustrated that the PI control has a 
chattering phenomenon that cannot maintain the control 
performance when the parameter plant variation is large and 
the drive conditions change frequently. 
 
 
(a) 
 
 
(b) 
Figure 4. The experimental results using the proposed control scheme for a 
periodic square command from -45 to 45 degree. (a)USM rotor 
angle and speed responses, (b) angle error. 
 
(a) 
 
(b) 
Figure 5. The experimental results using the RFNNC without compensated 
controller for a periodic square command from -45 to 45 degree. 
(a) USM rotor angle and speed responses, (b) angle error. 
 
(a) 
 
(b) 
Figure 6. The experimental results using the PI control for a periodic square 
command from -45 to 45 degree. (a) USM rotor angle and speed 
responses, (b) angle error. 
B. A sinusoidal angle command from -45 to 45 degree 
In Figs. 7, 8 and 9 show the USM rotor angle command 
is a sinusoidal from -45 to 45 degrees. The USM rotor angle 
and speed responses using the proposed control scheme are 
depicted in Fig. 7(a). The angle error between angle 
command and USM rotor angle is depicted in Fig. 7(b). Fig. 
7 shows the experimental results with the proposed control 
scheme that the favorable tracking error is quickly reduced to 
zero. 
153
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-390-2
COGNITIVE 2015 : The Seventh International Conference on Advanced Cognitive Technologies and Applications

The USM rotor angle and speed responses using the 
RFNNC without compensated controller are depicted in Fig. 
8(a). The angle error is depicted in Fig. 8(b). Compared with 
the RFNNC without compensated controller in Fig. 8, it can 
be seen that the RFNNC without compensated controller can 
achieve barely satisfactory response which is similar to the 
proposed control scheme. However, it exhibits a chattering 
phenomenon due to the dead-zone especially in slow speed 
nearby zero.  
The USM rotor angle and speed responses using the PI 
control are depicted in Fig. 9(a). The angle error is depicted 
in Fig. 9(b). Fig. 9 illustrates that the PI controller tracking 
response is slower and the steady state error is larger than 
that of proposed control schemes. The drawbacks of the PI 
control are interference with the dead-zone and the motor 
speed has a serious chattering phenomenon at slow speed 
near zero. 
 
C. A constant speed command of 100 rpm with 0.5 N-m 
load 
Fig. 10 shows the USM rotor speed command is constant 
at 100 rpm with 0.5N-m load. Fig. 10(a) shows the 0.5N-m 
load applied to the USM rotor. The USM rotor speed and 
speed error between the speed command and USM rotor 
speed using the proposed control scheme are depicted in Fig. 
10(b). The USM rotor speed and speed error between the 
speed command and USM rotor speed using the PI control 
are depicted in Fig. 10(c). The experimental results in Fig.10 
depict that the PI control has larger speed ripple response 
than the proposed control scheme. Based on the experimental 
results, the control performance of the proposed control 
scheme is better than that of PI control. 
 
  
rotor angle
-45°
0°
45° 
rotor speed (rpm)
-50    0    50   
 
   (a) 
0.25s
0°
1°
 
(b)          
Figure 7. The experimental results using the proposed control scheme for a 
sinusoidal command from -45 to 45 degree. (a)USM rotor angle 
and speed responses, (b) angle error. 
 
   (a) 
 
   (b) 
Figure 8. The experimental results using the RFNNC without compensated 
controller for a sinusoidal command from -45 to 45 degree. (a) 
USM rotor angle and speed responses, (b) angle error. 
 
 
(a) 
0.25s
5°
 
(b) 
Figure 9. The experimental results using the PI control for a sinusoidal 
command from -45 to 45 degree. (a) USM rotor angle and speed 
responses, (b) angle error. 
154
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-390-2
COGNITIVE 2015 : The Seventh International Conference on Advanced Cognitive Technologies and Applications

  
 
(a) 
  
 
(b) 
  
 
(c) 
Figure 10. The experimental results for the USM rotor speed command of 
100 rpm with 0.5N-m load. (a) applied load, (b) rotor speed and 
speed error using the proposed control scheme, (c) rotor speed 
and speed error using the PI control. 
IV. 
CONCLUSIONS 
A novel control scheme, using RFNNC combined with a 
compensated controller, has been applied to USM rotor angle 
control. The RFNNC is designed in handling nonlinear 
motor characteristic variations to track the reference angle. A 
compensated controller is designed to compensate the USM 
dead-zone effect, which deteriorates the dynamic response. 
The RFNNC parameters are tuned in the Lyapunov sense; 
thus, the system stability can be guaranteed. Experimental 
results show that the proposed control scheme is better than 
that of PI control. 
ACKNOWLEDGMENT 
The authors would like to express their appreciation to 
Ministry of Science Technology for supporting under contact 
MOST 103-2627-E-168 -001. 
REFERENCES 
[1] M. A. Tavallaei, Y. Thakur, S. Haider, and M. Drangova,” 
Magnetic-resonance-imaging-compatible 
remote 
catheter 
navigation system,” IEEE Trans. Biomedical Engineering, vol. 
60, no. 4, pp. 899-905, April 2013. 
[2] M. Guo, J. Hu, H. Zhu, C. Zhao, and S. Dong, “Three-degree-
of-freedom 
ultrasonic 
motor 
using 
a 
5-mm-diameter 
piezoelectric ceramic tube,” IEEE Trans. Ultrasonics, 
Ferroelectrics, and Frequency control, vol. 60, no. 7, pp. 
1446-1452, July 2013. 
[3] H. Y. Wang, K. C. Fan, J. K. Ye, and C. H. Lin, “A long-
stroke nanopositioning control system of the coplanar stage,” 
IEEE Trans. Mechatronics, vol. 19, no. 1, pp. 348-356, 
February 2014. 
[4] P. Ci, G. Liu, Z. Chen, S. Zhang, and S. Dong, “High-order 
face-shear modes of elaxor-PbTiO3 crystals for poezoelectric 
motor  applications,” Applied Physics Letters, vol. 104, no. 24, 
pp. 242911 - 242911-4, July 2014 
[5] F. Giraud, P. Sandulescu, M. Amberg, B. Lemaire-Semail, 
and F. Ionescu, “Modeling and compensation of the internal 
friction torque of a travelling wave ultrasonic motor,” IEEE 
Trans. Haptics, vol. 4, no. 4, pp. 327-331, 2011. 
[6] R. E. Precup, R. C. David, E. M. Petriu, M. B. Radac, and S. 
Preitl, “Adaptive GSA-based optimal tuning of PI controlled 
servo systems with reduced process parametric sensitivity, 
robust stability and controller robustness,” IEEE Trans. 
Cybernetics, vol. 44, no. 11, pp. 1997-2009, November 2013. 
[7] T. S. Franklin, J. J. F. Cerqueira, and E. S. de Santana, “Fuzzy 
and PI controllers in pumping water system using 
photovoltaic electric generation,” IEEE Latin America 
Transactions, vol. 12, no. 6, pp. 1049-1054, September 2014. 
[8] J. Jingzhuo, and B. Liu, “Optimum efficiency control of 
traveling-wave ultrasonic motor system,” IEEE Trans. 
Industrial Electronics, vol. 58, no. 10, pp. 4822-4829, October 
2011. 
[9] N. T. Hieu, S. Odomari, T. Yoshida, T. Senjyu, and A. Yona, 
“Nonlinear adaptive control of ultrasonic motors considering 
dead-zone,” IEEE Trans. Industrial Informatics, vol. 9, no. 4, 
pp. 1847-1854, November 2013. 
[10] S. Zhou and Z. Yao , “Design and optimization of a modal- 
independent linearultrasonic motor,” IEEE Trans. Ultrasonics, 
Ferroelectrics, and Frequency control, vol. 61, no. 3, pp. 535-
546, March 2014. 
155
Copyright (c) IARIA, 2015.     ISBN:  978-1-61208-390-2
COGNITIVE 2015 : The Seventh International Conference on Advanced Cognitive Technologies and Applications

