Method of Dynamically Determining the Nodes that Hold Advertisements Suitable 
for the User’s Preference and a Relay Routing Method Based on Area Division 
 
Hideo Tomiyama, Kazumasa Takami 
Information System Science,  
Faculty of Engineering, Soka University 
Hachioji-shi, Tokyo, Japan 
{e0852258, k_takami}@t.soka.ac.jp 
 
 
Abstract—Mobile communications carriers are providing GPS-
based, location-dependent advertisement delivery services as 
supplementary services. As the number of mobile terminal 
types and the number of mobile users increase, the need is 
rising for a network that can handle location-dependent traffic 
within a locality efficiently. This paper presents an ad hoc 
network for location-oriented advertisement delivery, with an 
advertising node installed in each shop in a busy shopping area. 
Specifically, it describes a way to express the user’s preference, 
such as their hobbies, based on a Bloom Filter, and a way to 
dynamically determine the nodes that hold advertisements 
suitable for the preference of the target user. In addition, the 
paper also presents a routing method based on area division, 
which can reduce the number of relay nodes. It has been 
confirmed, by using simulation, that the proposed method 
reduces the number of relay nodes by about 70% compared 
with a case where messages are unicast to collect suitable 
advertisements.  
Keywords-location-dependent advertisement delivery; ad hoc 
network; user’s preference; bloom filter; routing. 
I. 
 INTRODUCTION 
As mobile terminals and one-segment broadcasting 
become widely used, a system has been proposed that 
delivers advertisements of shops to nearby pedestrians using 
weak radio waves for one-segment broadcasting. However, a 
network that interconnects shops and a system that delivers 
advertisements of multiple shops close to the target 
pedestrian are yet to be implemented. A service is being 
provided, in a wide-area network, in which the advertisement 
delivery server receives GPS (Global Positioning System) 
data of mobile terminals and sends by email those 
advertisements of shops that are judged to be suitable based 
on the locations of the pedestrians and their pre-registered 
preference data [1]. However, despite of the fact that 
delivery of advertisements is confined to a certain locality, 
the delivery traffic is centrally handled by the possibly 
remote advertisement delivery server that covers a wide area. 
As such, the rapid growth in access traffic and the number of 
smartphones are increasing the traffic load on the core 
network. To simplify the traffic design of the network, 
service providers are increasingly using public Wi-Fi LANs 
(Local Area Networks) [2], which are provided by installing 
Wi-Fi access points at cafés and other types of shops. If an 
advertising node is installed at each access point and these 
nodes are interconnected in a network, regionally confined 
advertisement traffic can be handled locally. Since different 
shops have different business hours, this network must be 
configured dynamically so that it will interconnect the nodes 
of only those shops that are open. A wireless ad hoc network 
is suitable for this purpose. Routing protocols that have been 
defined by IETF as RFC for an ad hoc network include 
OLSR (Optimized Link State Routing), AODV (Ad hoc On-
Demand Distance Vector) and DSR (Dynamic Source 
Routing) [3]-[6]. In addition, there are reports of protocols 
that extend these and incorporate the concept of link life [7]-
[9]. However, it is necessary to study an application-level 
routing method suitable for providing an advertisement 
delivery service in an ad hoc network. 
With a view to building an ad hoc advertisement delivery 
network, this paper proposes a way to dynamically determine 
nodes that hold advertisements suitable for the target 
pedestrian, and a routing method based on area division, 
which reduces the number of relay nodes. Section II 
discusses the conditions for providing an advertisement 
delivery service in an ad hoc network, and issues for 
implementing this service. Section III describes a way to 
express the user’s preference based on a Bloom Filter, and a 
way to dynamically determine nodes that hold the suitable 
advertisements. Section IV presents a method of selecting 
efficiently routes to the nodes holding advertisements 
suitable for the pedestrian’s preference in order to reduce 
ineffective traffic handled by advertising nodes. Section V 
describes a simulator developed to examine the proposed 
method, and how the proposed method reduces the number 
of relay nodes. Section VI describes the related works. 
Finally, Section VII gives conclusions and future issues. 
II. 
AD HOC ADVERTISEMENT DELIVERY NETWORK 
Busy shopping districts are often formed near train 
stations, with shops patronized by commuters and students. 
Districts with many specialty shops are also formed in other 
areas where people gather. In addition, when there is a 
special event, such as a festival at a shrine, many temporary 
shops open at the event site. The shops in such an area 
cooperate with each other, forming a shop owners’ 
community. This paper assumes that each shop in an area has 
an advertising node, and that these nodes form an ad hoc 
network, as shown in Fig. 1. Each advertising node has 
1
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-210-3
MESH 2012 : The Fifth International Conference on Advances in Mesh Networks

information about the locations of all the advertising nodes 
in the area. It also holds the data on the advertisement types 
held by each node in the form of an Ad Filter (AF), which is 
generated using the Bloom Filter (BF) algorithm [10]. Data 
about advertisements are collected in this network in the 
following steps: 
Step 1: The pedestrian registers his/her preference 
information in his/her mobile terminal in advance. The 
mobile terminal generates a Preference Filter (PF) from 
that information using the BF algorithm. 
Step 2: The mobile terminal puts the PF in an 
advertisement acquisition message (AAM) and sends it to 
the advertising node closest to the terminal. 
Step 3: The node that has received the AAM compares the 
PF in the AAM with the AFs of all the nodes in this area, 
and determines the nodes that hold the AFs that are 
suitable for the PF. 
Step 4: This node determines the optimal route to pass the 
AAM to all the selected nodes, puts that routing 
information in the AAM, and sends the AAM to the next 
node. 
Step 5: The advertising node that has received this AAM 
compares the PF in the AAM with its own AF to 
determine whether it holds an advertisement suitable for 
the pedestrian. 
 5-1: If it determines that it does not have such an 
advertisement, it passes the AAM to the next node 
designated in the routing information in the AAM. 
 
5-2: If it determines that it does have such an 
advertisement, it sends that advertisement to the user, 
and passes the AAM to the next node designated in 
the routing information. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 1.  Example of an ad hoc advertisement delivery network. 
To build an ad hoc advertisement delivery network, such 
as the one shown in Fig. 1, this paper address the following 
two issues: 
 
Issue 1: How to generate a PF and an AF using the BF 
algorithm 
A PF and an AF are generated using the BF algorithm, 
which can compare filters at high speed, and can express the 
elements of the user preference data and those of the 
advertisement data held by each node with small data. To 
generate these filters, it is necessary to specify the elements 
of the PF and to determine the bit array lengths of the PF and 
the AF taking the false positives of the BF algorithm into 
consideration. 
 
Issue 2: How to determine the route that minimizes the 
number of relay nodes 
To 
reduce 
the 
routing 
overhead 
in 
acquiring 
advertisement information in an ad hoc network, it is 
necessary to find a routing method that minimizes the 
number of advertising nodes that only relay advertisement 
information. 
 
III. 
ELEMENTS OF THE PF AND THE AF AND THE LOGIC 
FOR GENERATING AND TESTING THESE ELEMENTS 
A. Elements 
To make it possible to check a match between an 
advertisement 
information 
and 
the 
user 
preference 
information, an element set, D, is defined as follows. The 
elements in D are the basic user data, such as the user’s 
gender and job. An element, d, is defined as a combination of 
the element name, d_name, and its value, d_value. This 
definition allows two elements with the same element name 
but different values to be handled as different elements. 
D={d1, d2,・・・, dn} ,   where di=(di_name: di_value). 
To enable the user to express different aspects of his/her 
preference, and the advertisement provider to select potential 
receivers of their advertisements from different perspectives, 
the following element names have been defined: gender 
(gender), date of birth (year, month, day), body-mass index 
(bmi), job (job), annual income (income), whether married or 
not (partner), whether the user has a child or not (child), 
child’s age (child_age), and hobby (hobby). Examples of 
element values are shown below. The number of elements, n, 
is 17. The element values for job have been defined in 
advance. 
D={gender:0, year:1988, month:5, day:21, bmi:1, job:14, 
income:0, partner:0, child:0, hobby:1, hobby:9, hobby:10, 
hobby:17, hobby:18, hobby:19, hobby:20, hobby:21} 
Elements are classified into two categories: those in the 
main element set, Dm, and those in the sub-element, Ds. Dm 
includes gender, job and hobby, which do not vary greatly 
from user to user. On the other hand, Ds includes date of 
birth, annual income and child’s age, which can vary greatly. 
Thus, 
D={Dm, Ds} 
       Dm={gender:0, job:14, hobby:1, hobby:9, hobby:10, 
hobby:17, hobby:18, hobby:19, hobby:20, hobby:21} 
   Ds={year:1988, month:5, day:21, bmi:1, income:0, 
partner:0, child:0} 
If elements for a filter are to include all the elements in 
Dm and Ds, the users at whom an advertisement is targeted 
(Note)
：Advertisement packets
： Route for passing an AAM
：Advertising node
：Node that holds an advertisement suitable for user A’s preference
：Area covered by the radio from each node
：Shop
User A
2
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-210-3
MESH 2012 : The Fifth International Conference on Advances in Mesh Networks

will be extremely narrow, and the BF’s advantage of high 
data efficiency will be reduced. Therefore, we have decided 
that the PF and AF, which are used to check a match 
between an advertisement information and the user 
information should contain only Dm. Ds is used by 
advertising nodes to determine whether it should store a 
specific advertisement or not. This paper does not consider 
this aspect. 
B. Algorithm for Generating Filters and Filter Size 
The BF algorithm passes one element through a hash 
function and generates multiple hash values. This 
computation is applied to all the elements. A filter is 
generated by replacing 0 with 1 at the bit positions specified 
by all the hash values in a bit array, initialized with 0, of an 
arbitrary size. The algorithm for generating a PF and an AF 
in a case where each filter is an m-bit array, the number of 
elements is n, and the number of hash values obtained is k, is 
as follows (see Fig. 2). 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 2.  Example of generating a PF and an AF using the BF algorithm. 
Step 1: The m-bit array is initialized with 0. 
Step 2: The character string making up element, di, is 
multiplied with an arbitrary numerical value associated 
with each alphanumeric in the character string, and again 
multiplied with the character sequence information. The 
results for all the characters are added together, and this 
is converted into a numerical value, X(di). For example, 
if di=[gender: 0], then the numerical value are associated 
with each character in advance, as g=16, e=14, n=23, 
d=13, r=17, :=36, 0=0. This is multiplied by the 
character sequence information: g=1, e=2, n=3, d=4, e=5, 
r=6, :=7, and 0=8. The result is as follows: 
X(di)=16×1+14×2+23×3+13×4+14×5+17×6+36×7+0×8 
= 589. 
Step 3: To calculate k hash values from X(di), X(di) is 
multiplied by k different constants, α1, ~, αk, and k 
X(di)1= X(di) ×α1, ~ , X(di)k= X(di) ×αk is obtained. 
Step 4: X(di)1, ~, X(di)k are input to the following hash 
function, H, to produce k hash values, h(di)1, ~, h(di)k. 
        h(di)k =H(X(di)k)= ( X(di)k mod C ) mod m 
  where mod is an operator to obtain the remainder of the 
preceding value divided by constant, C, or constant, m. m 
is the filter’s bit length. After the two mod operations, 
this bit length becomes smaller or equal to the bit array 
length of the defined filter. 
Step5: Replace 0 with 1 of the m-bit array at bit positions 
specified by hash values h(di)1, ~, h(di)k obtained in 
Step4. 
Step6: Repeat Steps 2 to 5 for the number of elements, n. 
 
High bit efficiency of the BF algorithm is achieved by 
tolerating false positives [10]. A false positive means 
incorrectly identifying the presence of an element not in the 
relevant filter, when a match between the PF and the AF is 
checked. For example, some of the k hash values obtained 
from element, di, and those obtained from element, dj, in 
Step 4 can be the same sometimes. In such a case, the bit 
positions specified by the hash value obtained from element, 
dj, have already been specified by the hash value obtained 
from element, di, and have been replaced with 1. In other 
words, 
these 
bits 
are 
discrimination 
information 
encompassing both elements, di and dj. Therefore, in 
checking a match between the filters, di and dj are not 
accurately distinguishable. Let m be the size of the BF, n the 
number of elements, and k the number of hash values 
obtained by applying the hash function, then the probability 
at which a false positive occurs can be calculated by 
 
                                                                                              (1) 
 
Eq. (1) indicates that, if m and n are fixed, there is a k that 
minimizes this probability. If false positives occur in the 
proposed ad hoc advertisement delivery network, the number 
of relay nodes increases. Therefore, we have set m=150, n = 
15, and k = 7 to keep the false positive occurrence 
probability to 1% or lower. The number of elements, n, has 
been determined based on a questionnaire survey conducted 
with multiple subjects. 
C. Advertisement Suitability Test 
The advertising node that was the first to receive an 
advertisement acquisition message (AAM) from the user 
must check a match between the user preference information 
in the AAM and the advertisement information held by each 
node, and determine the nodes that hold advertisements 
suitable for the user. A node that has received an AAM from 
another node must determine whether it should send an 
advertisement to the user or simply relay the AAM to the 
next node. With the BF, information is contained at bit 
positions of a bit array. Therefore, whether information is 
present or not can be determined by checking whether the 
value at the relevant bit position is 0 or 1. In other words, if 
the value is 1 at all bit positions specified by the k hash 
values computed from a given element, that element is valid. 
On the other hand, if the value at any specified bit position is 
0, that element is invalid. The steps for this advertisement 
suitability test are as follows: 
Step 1: A bit AND operation is performed on the PF and 
the AF to produce a Result Filter (RF). 
…0000000000…
k hash values
…0011010110…
・・・
・・・
The filter size is m bits
d1
d2
dn
k hash values
k hash values
Hash function
0 is replaced with 
1 at bit positions 
specified by the n
× k hash values
Element
3
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-210-3
MESH 2012 : The Fifth International Conference on Advances in Mesh Networks

Step 2: If the RF and the AF are identical, the element 
concerned is determined to be valid. If not, invalid. 
IV. 
ROUTING BASED ON AREA DIVISION 
Since advertising nodes are assumed to be installed in 
shops, they will be at fixed places for a relatively long time. 
In such a case, a proactive protocol, for which the routing 
table is predetermined, is an efficient protocol for use as the 
basic routing protocol. However, if the source node is to 
search for nodes holding advertisements suitable for the 
specific user based on a routing table designed for point-to-
point connections, it must send many unicast packets to all 
the target nodes. For example, in a simple node configuration 
in which the radio from a node can reach only its adjacent 
nodes as shown in Fig. 3, the routes from node 1 to 
advertisement holding nodes 3, 6, 8, 9, 10 and 15 are as 
shown in Table I. Nodes 2, 5 and 7 only relay an AAM, 
twice, twice and once, respectively. Since the relayed AAM 
has nothing to do with the delivery of their own 
advertisements, the AAM traffic is invalid traffic for these 
nodes. It is desirable that such an AAM do not come to these 
nodes. Nodes 6 and 10 deliver their own advertisements and 
also relay an AAM separately. It is desirable that they can 
handle these in one access attempt. For example, if the 
routing is such that the AAM is passed in the sequence of 
nodes 1→2→3→8→7→6→9→10→15, the nodes that only 
relay an AAM are reduced to only nodes 2 and 7, thus 
reducing the overall traffic load on nodes and the network. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 3.  Node configuration example. 
TABLE I.  
ROUTING EXAMPLE USED WHEN THE STARTING NODE, 
NODE 1, PASSES AN AAM TO ADVERTISEMENT HOLDING NODES 3, 6, 8, 9, 
10 AND 15 
 
 
 
 
 
 
 
 
The control of the relay routing to divided areas is based 
on an existing proactive protocol but is overlaid on it as 
shown in Fig. 4. In the upper layer, the area with shops is 
divided either vertically or horizontally to make up multiple 
long, thin sub-areas. A set of advertisement holding nodes 
belonging to the same sub-area are selected, and an AAM is 
passed from one end of a sub-area if the sub-area number is 
odd, and from the other end of a sub-area if the sub-area 
number is even. For example, if the area is divided 
horizontally, an AAM is passed from the leftmost node in a 
sub-area whose sub-area number is odd, and from the 
rightmost node in a sub-area whose sub-area number is even. 
In the lower layer, an AAM is passed in the sequence 
determined in the upper layer. If the current node cannot 
reach the next node in one hop, an alternate route is searched 
for and used to pass the AAM. By determining the routing 
this way, an AAM can be passed to nodes in the area in a 
unicursal line. This is an efficient routing because it reduces 
the number of nodes that only relay the AAM. Figure 5 
shows this routing method for a case where an area is 
divided into q areas vertically. 
 
 
 
 
 
 
 
 
 
 
Figure 4.  Two-layered routing control. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 5.  Example of the relay routing based on area division. 
The detail routing control is performed as follows. A 
given area can be divided vertically, horizontally or in other 
division patterns depending on the layout of shops and users’ 
locations. In the following, we assume that the area is 
divided vertically into q sub-areas as shown in Fig. 5, and 
that the starting point is at the top left. Additionally, we 
assume that each node has the following control data, RD: 
RD={node identifier (node_id), IP address (ip_address), 
location coordinates (location_xy), AF, division pattern 
identifier (div_id), sub-area number (subarea_no)} 
Sub-area number is determined as follows: 
10
11
Starting node
Relay node
Advertisement holding node
12
13
12
15
16
9
3
8
6
2
4
5
7
1
(Note)
Area covered by the radio of node 6
(Note)UC: Unicast, S: Starting node, H: Advertisement holding node, R: Relay node
　　Node number
UC number
1
2
3
5
6
7
8
9
10
15
UC1
S
R
H
UC2
S
R
R
H
UC3
S
H
UC4
S
R
H
UC5
S
R
H
UC6
S
R
R
H
Proactive routing in an ad hoc network
Relay routing based on area division
Sub-area 1
Sub-area 2
Sub-area i
Sub-area q
：Direction in which an AAM is passed
：Route in which an AAM is relayed
X
Y
(Note)
：Advertising node
・・・
・・・
4
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-210-3
MESH 2012 : The Fifth International Conference on Advances in Mesh Networks

Xs+(q-1) × w < subarea_no(q) < Xs+q × w, where  
(W/w) ＞q≧1 and W is the width of the area, Xs is 
the X-axis coordinate of the starting point, and w is 
the width of a sub-area. 
 
Step 1: The node that has received an AAM, node NA, 
checks a match between the AF in its RD and the PF in 
the AAM in accordance with the test criteria described in 
Section III.C, and generate a list of nodes that hold 
suitable advertisements, nodelist NLA. Note that NLA 
and RD share the same attributes. 
Step 2: Node, NA, determines the user location based on its 
own position, and determines the division pattern 
identifier. It searches the NLA for nodes that have this 
identifier. The nodes found are sorted in the sequence of 
the sub-area number. 
Step 3: Sub-areas are classified into two groups depending 
on whether the sub-area number is odd or even: io={2r－
1} and ie={2r} (q/2＞r≧1). It is assumed that r=1 for 
node, NA, and the node belongs to io. 
Step 4: A routing node list RNL is generated by sorting 
nodes in the sub-area in io with r=1 in the order of 
closeness to node NA. Note that RNL is an ordered array 
of node identifiers. 
Step 5: Conversely, nodes in the sub-area in ie with r=1 are 
sorted in the order of distance to node NA, and added to 
the RNL. 
Step 6: Make r=r+1. Steps 3 through 5 are repeated for the 
number of sub-areas belonging to the same division 
pattern. 
Step 7: The completed RNL is put in an AAM, and sent to 
the next node via the lower layer. 
V. 
DEVELOPMENT OF A SIMULATOR AND THE 
EVALUATION RESULTS 
A. Development of a Simulator 
To evaluate the methods proposed in Sections III and IV, 
we specified the size of the target area, developed 5 different 
node layout lists showing different layouts of randomly 
placed advertising nodes, and also developed a simulator 
shown in Fig. 6, which takes the above data as inputs, and 
outputs suggested routes. We considered 16 types of 
occupation and 24 types of hobby for the main elements in 
the AF, which specify advertisement information held in 
nodes. By combining these with gender, we created 20 AFs 
and allocated each of them to a node randomly. We also 
created a PF, which contains one set of elements that indicate 
the user preference. Only one division pattern shown in Fig. 
5 was used. We also developed a unicast simulation program 
so that we can compare the routing results of the relay 
routing based on area division with those obtained by using 
unicast for acquiring advertisement information. A relay 
node counting program was developed to collect data on the 
number of relay nodes in the results of both the proposed 
method and the unicast method. We also developed a relay 
routing drawing program in order to make it possible to 
understand different routings visually. 
 
 
 
 
 
 
 
 
 
 
 
Figure 6.  Simulator software configuration. 
Figure 7 shows the relay routing in a case where the area 
with shops measures 800 m × 800 m, the number of 
advertising nodes is 200, the distance that can be reached by 
the ratio from each node is 200 m and the area is divided in 5 
sub-areas. The number of valid advertising nodes is 66. The 
number of nodes that relayed AAMs is 67, of which 2 are 
relay nodes. Nodes are represented by either squares or 
circles in the figure. Squares indicate nodes that hold 
advertisements suitable for the user. The selected routes are 
shown in solid lines. The distance between N:163 and N:80 
and that between N:146 and N:53 are longer that the distance 
that can be reached by the radio waves of these nodes. 
Therefore, N:194 and N:63 serve as relaying nodes for these 
pairs of nodes respectively. The new alternate routes are 
N:163-N:194-N:80 and N:146-N:63-N:53 respectively. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 7.  Routes selected for the relay routing based on area division. 
(Number of sub-areas: 5; number of advertisement holding nodes: 66; total 
number of nodes that relayed AAMs: 67, number of pure relay nodes: 2, and 
number of node layout lists: 1) 
B. Number of Sub-areas and Number of Relay Nodes 
In the proposed routing, the number of sub-areas greatly 
affects how many node become relay nodes. The relationship 
between the two as examined with the 5 created node layout 
lists (nodelists 1 to 5) is shown in Fig. 8. The assumptions 
used in this examination are the same as those used in 
Section V.A. Figure 8 shows that the number of relay nodes 
Random node list 
generation 
program
Advertising 
node list
Windows 7
Sample data reading program
Unicast-based 
routing 
simulation 
program
Area division-
based routing 
simulation 
program
Relay node counting program
Relay routing drawing program
User information 
registration 
program
PF generation 
program
PF
Alternate route
Alternate route
(note)
●：node
■：specific node including 
advertisements suitable 
for the user.
5
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-210-3
MESH 2012 : The Fifth International Conference on Advances in Mesh Networks

is minimal when the number of sub-areas is 5. The reason is 
that, when the number of sub-areas is smaller or larger than 
this figure, the distances between advertisement holding 
nodes are beyond the distance that can be reached by the 
radio waves from nodes, thus increasing the number of cases 
where alternate routes with relay nodes must be used to pass 
AAMs from one advertisement holding node to another. 
 
 
 
 
 
 
 
 
 
 
 
Figure 8.  Relationship between the number of sub-areas and the number 
of relay nodes. 
C. Comparison with a Unicast-Based Advertisement 
Information Acquisition in Terms of the Number of 
Relay Nodes 
The proposed method (method p) was compared with 
the method of unicasting AAMs (method u) in terms of the 
number of relay nodes. The size of the area, the number of 
advertising nodes, the distance reached by the radio waves 
from nodes, and the number of valid advertising nodes were 
the same for the both methods. The computation result for 
method u is shown in Fig. 9. In this method, the advertising 
node closest to the user sends AAMs to all the nodes that 
hold advertisements that are considered to be suitable for the 
user. Therefore, even though the number of advertisement 
holding nodes was 66 as in the case of method p, the 
number of relay nodes jumped up to 258. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 9.  Relay routing based on unicast-type advertisement information 
acquisition. 
(Number of advertisement holding nodes: 66; total number of relay nodes: 
258; and the number of node layout lists: 1) 
Figure 10 shows comparison of methods p and u in terms 
of the number of relay nodes. For method u, all the 
advertising nodes that have relayed an AAM sent by the 
advertising node closest to the user before the AAM reaches 
a node holding an advertisement suitable for the user are 
counted as relay nodes. Such nodes were added together for 
all the advertisement holding nodes. For method p, the 
number of sub-areas was 5, and 5 advertising node lists were 
used. A total of 10 simulations were performed for methods 
u and p. The route through which an advertisement message 
is sent from an advertisement holding node to the user is 
assumed to be the same for methods u and p. In Fig. 10, the 
results for method u are designated by u while those for 
method p are designated by p, followed by the list number of 
the advertising node list used. Figure 10 shows that the 
number of relay nodes for method p is much smaller than for 
method u. The percentage of this reduction ranged from 
68.2% to 74.5% with the average being 71.9%. 
 
 
 
 
 
 
 
 
 
 
 
Figure 10.  Comparison with a unicast-type advertisement information 
acquisition in terms of the number of relay nodes. 
VI. 
RELATED WORKS 
Typical overlay-based multicasting protocols that use the 
proactive routing of ad hoc networks include AMRoute (Ad 
hoc 
Multicast 
Routing 
protocol) 
[11], 
PAST-DM 
(Progressively Adaptive Subtree in Dynamic Mesh) [12] and 
ALMA (Application Layer Multicast Algorithm) [13]. In 
these protocols, each member node forms a mesh-based 
virtual topology. Information delivery is achieved using a 
multicast tree in the case of AMRoute, and a source-based 
tree in the cases of PAST-DM and ALMA. ALMA takes a 
receiver-driven approach to improve the performance of 
PAST-DM.   
Our proposed method also relies on a source-based tree. 
It differs from PAST-DM in the following aspects. Since 
PAST-DM’s meshed-based virtual topology assumes node 
mobility, the link states are updated periodically. The source-
based tree used for information delivery is dynamically 
generated by the source-based steiner tree algorithm from 
this virtual mesh. Therefore, control packets for obtaining the 
latest routing information are periodically flooded, which 
results in an increase in network traffic. The parent node, 
which is the branching point of the tree, manages the 
participation and withdrawal of child nodes, copies the 
packets as many times as there are child nodes, and sends the 
copied packets.  
0
5
10
15
20
25
30
2
3
4
5
6
7
8
9
10
11
12
13
14
15
Number of relay nodes
Number of sub-areas
nodelist1
nodelist2
nodelist3
nodelist4
nodelist5
0
50
100
150
200
250
300
u1
p1
u2
p2
u3
p3
u4
p4
u5
p5
Total number of relay nodes
u: unicast
p: routing based on area division
6
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-210-3
MESH 2012 : The Fifth International Conference on Advances in Mesh Networks

In contrast, in our proposed relay routing method based 
on area division, the nodes that make up the ad hoc network 
are shops at fixed locations. Therefore, in setting up the 
network, it is possible to build a virtual topology as an 
unbranched source-based tree in which nodes are connected 
in the sequence of physical distances between nodes for each 
area division pattern. This also reduces the number of control 
packets. In addition, the source-based relay routing tree for 
the transmission of advertisement information acquisition 
messages over the network is reconfigured as an unbranched 
relay routing tree by selecting, from this virtual topology at 
the time when the advertisement information acquisition 
messages is received from the user, only those nodes that 
hold advertisements suitable for the preferences of the user. 
The participation or withdrawal of a delivery member is 
updated as part of the operations and maintenance system 
data when the relevant node is physically included in or 
disconnected from the advertising delivery ad hoc network. 
The routing at the time of node failures is left to the lower 
layers as is the case with other methods. 
VII. CONCLUSIONS AND FUTURE ISSUES 
This paper has proposed a locality-oriented ad hoc 
advertisement delivery network. It has described the filter 
structure and the algorithm used to determine whether an 
advertisement is suitable for a specific user based on the 
Bloom Filter algorithm. In addition, it has proposed a relay 
routing method based on area division. This method can 
reduce the number of nodes that purely relay advertisement 
information acquisition messages in an ad hoc network. This 
method 
has 
been 
compared 
with 
a 
unicast-type 
advertisement information acquisition using simulation, and 
it was found that the proposed method uses 70% fewer relay 
nodes than the unicast-type method. 
In the future, it will be necessary to examine cases that 
take into consideration node layouts that reflect actual cases, 
different area division patterns, the impacts of users’ 
movements and those of buildings on reachability of radio 
waves. In addition, it is necessary to study in detail the 
protocol that enables the proposed relay routing algorithm 
based on area division, and to use general-purpose network 
simulators, such as Opnet [14] and NS-2 [15], to evaluate the 
delay up to the final node when the network’s background 
traffic is taken into consideration, and the effects of node 
failures. It is also necessary to investigate the standard used 
for the optimization of the relay routing tree based on area 
division. The quantitative difference in performance between 
the proposed method and the existing ALM (Application 
Layer Multicast) needs to be found out through these studies. 
REFERENCES 
[1] C. Yoon, H. Lee, S. Hyun Jeon, and Hyunwoo Lee, “Mobile 
digital signage system based on service delivery platform 
location based targeted advertisement service,” International 
Conference on ICT Convergence (ICTC), 28-30 Sept. 2011,  
pp. 582 - 586. 
[2] Public Wireless LAN, http: //www.swisscom.ch/res /internet/ 
pwlan/index.htm(2012/7/7). 
[3] S. Kumar Sarkar, T. G. Basavaraju, and C. Puttamadappa, 
“Ad Hoc Mobile Wireless Networks,” Principles, Protocols 
and Applications, Auerbach Publications, Boston, MA, 2007. 
[4] T. Clausen and P. Jacquet, “Optimized Link State Routing 
(OLSR),”  IETF  RFC 3626, Oct. 2003. 
[5] C. E. Perkins, E. Belding-Royer, and M. Lewis, “Ad hoc On-
Demand Distance Vector (AODV), IETF RFC 3561, July 
2003. 
[6] D. B. Johnson, D. A. Maltz, and J. Brock, “The dynamic 
source routing protocol for mobile ad hoc networks (DSR),” 
IETF  RFC 4728, July 2004. 
[7] J. J. Garcia-Luna-Aceves and E. L. Madruga, “The core-
assisted mesh protocol (CAMP),” IEEE Journal on Selected 
Areas in Communications, Special Issue on Ad-Hoc 
Networks, 17. No.8 (1999), pp. 1380–1394. 
[8] L. Ji and M. S. Corson, “Differential destination multicast - a 
MANET multicast routing protocol for small groups (DDM),” 
in Proc. of INFOCOM 2001, 2001, pp. 1192–1202. 
[9] S. Lee, W. Su, and M. Gerla, “On-demand multicast routing 
protocol in multihop wireless mobile networks (ODMRP),” in 
ACM Mobile Networks and Applications, special issue on 
Multipoint Communication inWireless Mobile Networks, 
2000. 
[10] Marcelo D. D. Moreira, Rafael P. Laufer, Pedro B. Velloso, 
Otto Carlos M. B. Duarte, “Capacity and Robustness 
Tradeoffs in Bloom Filters for Distributed Applications,” 
IEEE Transactions on Parallel and Distributed Systems, 
March 2012 pp. 266-275. 
[11] J. Xie, R. R. Talpade, A. Mccauley, and M. Liu, “AMRoute: 
Ad hoc multicast routing protocol,” ACM Mobile Networks 
and Applicaions, 7. No. 6 (2002). 
[12] C. Gui and P. Mohapatra, “Efficient overlay multicast for 
mobile ad hoc networks(PAST-DM), ”  in IEEE WCNC’03, 
2003. 
[13] Min Ge, Srikanth V. Krishnamurthy, and Michalis Faloutsos, 
“Overlay Multicasting for Ad Hoc Networks (ALMA),” Proc. 
Med-Hoc-Net, pp. 131-143, June 2004. 
[14] Opnet, http://www.opnet.com/, (July 31, 2012). 
[15] The Network Simulator - ns-2, http://www.isi.edu/nsnam/ns/, 
(July 31, 2012)
 
 
 
 
 
7
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-210-3
MESH 2012 : The Fifth International Conference on Advances in Mesh Networks

