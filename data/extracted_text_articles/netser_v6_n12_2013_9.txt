108
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Detecting Pedestrian Flows on a Mobile Ad Hoc Network
and Issues with Trends and Feasible Applications
Ryo Nishide and Hideyuki Takada
Faculty of Information Science and Engineering
Ritsumeikan University
Kusatsu, Japan
nishider@fc.ritsumei.ac.jp, htakada@cs.ritsumei.ac.jp
Abstract—Due to the rapid development of mobile and ad
hoc communication technology, research on extracting social
contexts including the movement and density of pedestrians
has also emerged in recent years. This study explores methods
to extract pedestrian ﬂows in a distributive manner from
Bluetooth detection logs. Bluetooth devices are widely installed
in mobile equipment such as laptops, tablet PCs, cell phones
and PDAs, which pedestrians carry with them in daily life. The
results of experiments have revealed that detection logs implic-
itly record traces of surrounding pedestrian ﬂows, which might
provide possibilities to analyze and distinguish pedestrian ﬂow
patterns in various situations. Moreover, the paper discusses
the data management system on a serverless ad hoc network,
including methods for interpolating detections in order to pick
up missing devices and conﬁgurating a range query designated
to gather data within the geographical range. While examining
problems to be faced with technological changes, several
possible scenarios are also presented for feasible applications.
Keywords-distributed database; Bluetooth; social context; mo-
bile devices; ad hoc network.
I. INTRODUCTION
This study is an extension of a previous paper [1] dealing
with the methods and issues in extracting pedestrian ﬂows
in a distributive manner by examining the detectable signals
from mobile devices.
With the increase of urban population and the expansion
of social activities, we cannot avoid sharing the same public
spaces with other people when traveling or in day-to-day life.
On many occasions, it will be one of the major concerns
for people whether the area is crowded or less-crowded,
and sometimes it is necessary to know what is actually
going on in such places, including the changing ﬂow of
pedestrians. Many location-based services have appeared on
the market, thanks to the enhancement of computational
ability and wireless communication technology in mobile
devices. These include Bluetooth, WiFi and GPS technology.
These advancements have paved the way to methods for
detecting pedestrian ﬂows or social contexts using high
performance mobile devices [2], [3].
Our research employs methods to extract the density and
ﬂows of pedestrians from Bluetooth detection logs, while
considering the data management scheme on a mobile ad
hoc network [4]. This ad hoc network can be generated from
connections between mobile devices to work as a distributed
database, which can manage and update the detection log
data, or modify the log data by accessing geometrically
adjacent devices to check for missing detections. The policy
of this work is to avoid initial preparations, such as installing
a large number of expensive immovable sensors and high
performance computational equipment in physical space, in
order to minimize cost, time and effort. In this research, we
focus on extracting pedestrian ﬂows in physical world, while
the speciﬁc services to utilize the detection results are left
for future work.
We attempt to grasp social contexts such as changes of
pedestrian ﬂows and density by detecting the surrounding
electronic equipment. Recent hand-held electronic equip-
ment such as cell phones, smart phones, PDAs and laptops
contain wireless devices such as WiFi and Bluetooth, which
pedestrians carry with them in their daily lives. If these
devices surrounding the user are detected and logged con-
tinuously, it may be possible to detect not only the density
of crowd, but also the changes of pedestrian movements.
We have conducted a preliminary investigation to examine
the statistics of detectable types of terminal (mobile phone,
PC, etc.) at various locations [5]. Comparing two wire-
less technologies, WiFi and Bluetooth, WiFi was detected
from many types of electronic equipment either carried by
pedestrians or ﬁxed in the environment. Therefore, it seems
difﬁcult to discriminate the type of equipment by WiFi, and
in particular whether they are carried by the pedestrians
or not. On the other hand, most of the detected Bluetooth
radios were from mobile devices. In this paper, we focus
on Bluetooth devices installed in equipment to be carried
by users in order to examine the ﬂows and movements of
pedestrians.
Related research and comparable studies are reviewed in
Section II. Section III explains our method of extracting
pedestrian ﬂows using Bluetooth detection logs. Based on
the results of experiments, the density and movements
of pedestrians are examined in different situations by the
analysis of detection patterns in Section IV. Section V
discusses the distributive and autonomous data management

109
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
scheme, and the interpolation of missing detections. Section
VI describes issues arising from technological changes and
then suggests possible applications of the proposed method
in related ﬁelds. Section VII reviews the research with
conclusion.
II. RELATED WORK
The development of mobile equipment and ad hoc com-
munication has led to several attempts to analyze social
context. O’ Neill et al. [6] and Nicolai et al. [7] examined
the correlation between Bluetooth detections and pedestrian
movement by deploying stationary Bluetooth sensors in the
environment and analyzing the logs. Eagle et al. [8] have
shown methods to analyze social patterns of users’ daily
activities. These studies show that scanning for Bluetooth
(or other wireless devices) and analyzing detection logs
give us the possibilty to extract the ﬂow of pedestrians
or discover relationships in the community. However, not
every Bluetooth device can be guaranteed to be detected
depending upon the performance of the device and its
physical environment. Thus, their methods may not be able
to cope when too much incoming data is generated in
crowded environments.
To cope with such problems, Kim et al. [9] examined the
detection pattern of Bluetooth device logs, and employed
a clustering algorithm and Gaussian blur to remove noise
caused by inquiry fault of undetected Bluetooth devices.
They inferred the transition time of events from multiple
device detections. However, inquiry faults for devices cannot
be detected individually. As there are many complicated
situations in the physical world, this method may not be
enough to cope with all situations. Weppner et al. [10]
estimated crowd density through collaboration with multiple
devices to improve the accuracy of detections. Users carried
multiple devices for Bluetooth scanning, which might be
awkward or inconvenient.
Other related work includes Bulut et al. [11], which
exploits friendship-based features of a mobile social network
to perform efﬁcient routing. Friendship is deﬁned from
the traces of surrounding personal wireless devices, and
the closeness relationship is analyzed from frequency and
duration of the connectivity between devices. Our work aims
to extract users’ activities and the situation occurring around
them, while Bulut examines the social relationship between
a user and the surrounding pedestrians.
Our research is designed to extract social context by
scanning Bluetooth devices in the surrounding environment,
with consideration given to the user’s location and the
communication range of Bluetooth devices. The method is
proposed to work autonomously and distributively with the
users’ devices on an ad hoc network, avoiding such troubles
as installing ﬁxed sensors or carrying multiple devices.
It also enables to deal with inquiry faults by performing
computation collaboratively with nearby devices.
Figure 1.
Detections for different places and situations
III. DETECTION OF PEDESTRIAN FLOWS
A. Concept of our Research
Our objective is to extract social contexts such as changes
of pedestrian ﬂows or the crowdedness of pedestrians from
the traces of detected devices carried with them in their daily
activities. These devices include cell phone, smart phone,
PDA, portable games, tablet PC and laptop equipped with
wireless devices such as WiFi and Bluetooth. In fact, the
detection pattern differs depending upon the situations of the
surrounding pedestrians (Figure 1). Thus, by analyzing the
detection patterns, it might be possible to infer the social
contexts or trends and changes of surrounding situations.
We avoid extracting the personal information of pedestrians,
such as location and name, since recording this kind of infor-
mation might violate the privacy of pedestrians. Instead, we
examine the detection patterns (e.g., numbers and changes
of simultaneous or continuous detections) of devices carried
by pedestrians surrounding the user.
B. Features of Bluetooth Devices
During the manufacturing process of a Bluetooth device,
it is assigned a unique ID in the form of a 48-bit MAC
address. This address is called a Bluetooth Device Address
(BDA) and is used for communicating with other devices
by exchanging BDAs for identiﬁcation. Thus, BDAs are
sent constantly without requiring authentication to build
connections with other Bluetooth devices. We target class 2
Bluetooth devices embedded in hand-held mobile equipment
as cell phones, laptops, PDAs, etc., having a communication
range of approximately 10 meters. The protocol for the
Bluetooth inquiry ﬁrst receives the BDA of surrounding
Bluetooth devices, and then requests the names of these
devices. A combination of BDAs and timestamps are stored
in the log ﬁle for each ﬁxed time interval.
Figure 2 shows an example of the pedestrian’s Bluetooth
Device, which has entered the reachable communication

110
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 2.
Detection of pedestrian ﬂows
range of user’s device. The user’s device continuously in-
quires for nearby pedestrian devices, and logs the time and
BDA of devices which respond. From the log, different types
of detection patterns can be veriﬁed, such as continuously
detected, newly detected, undetected or disappeared, and so
on. These are the key to determining the dynamic ﬂow of
pedestrians in the physical world.
The model of Bluetooth device can be determined by
inspecting the 24-bit preﬁx of the BDA. In other words,
every device which has the same BDA preﬁx has the same
manufacturer, which enables to identify what kind of device
it is. For example, a BDA with preﬁx 0022F3 identiﬁes
a cell phone from a certain manufacturer, the device with
preﬁx 001BDC a certain desktop computer, the device with
preﬁx 001D4F a certain laptop computer, and so on. We
can identify the device models without retrieving the device
name and classify whether the device is cell phone, smart
phone, laptop, PDA, iPad, and so on.
C. Trends for Detectabe Types of Bluetooth Devices
Here we discuss some points about the detectability of
Bluetooth devices arising from a preliminary investigation
examining the detectable types of terminal.
Bluetooth devices can only be detected when the Blue-
tooth function is turned on with Discovery mode enabled
(a conﬁguration option to enable the surrounding terminals
to discover the user’s terminal). Fortunately, many mo-
bile phones were detected easily, probably because several
models with Bluetooth functions were sold in Discovery
mode as a default setup. Moreover, it seems that there
are several cases in which inexperienced mobile phone
users unintentionally accept the mobile phone application’s
request to turn on the Bluetooth device without knowing
what it is. For example, a chat application for Softbank
mobile phones has been popular for several years in Japan
[12] allowing users to communicate with other users within
Table I
CHARACTERISTICS OF PEDESTRIAN FLOW BY SITUATIONS
User
Surrounding ppl
Sharing Space
Stay
Move
Stay
Move
Town
△
⃝
△
⃝
△ or ×
Conference room
⃝
×
⃝
×
⃝
Cafeteria
⃝
×
⃝
⃝
⃝ or ×
Train
Moving
×
⃝
×
⃝
⃝
Stopping
⃝
×
⃝
⃝
⃝ or ×
notations: (⃝)many; (△)some; (×)few/none
the Bluetooth device detection range. This application asks
users to enable the Bluetooth function, but does not ask
them to disable it when no longer needed. Another example
is users who purchase cell phone and then try to use all
the functions of the phone while reading the instruction
manual, inadvertently turning on the Bluetooth function on
without paying attention. In either case, the result is that
many users walk around town with their mobile phone’s
Bluetooth device turned on and discoverable, enabling the
method described here for detecting those devices.
We have chosen Bluetooth devices as our detection target
in order to extract the ﬂows and movements of pedestrians,
because most Bluetooth devices are installed in equipment
to be carried by users. The method we have proposed can be
performed using only the mobile device carried by the user,
without installing additional equipment such as mounting
ﬁxed sensors or video cameras in the environment.
IV. VERIFICATION OF DETECTION PATTERNS
The authors have done several investigations to observe
surrounding Bluetooth devices in various situations, such
as: (i) normal daily routine for commuting to and working
at a university, (ii) special events such as conferences and
school festivals, and (iii) other off-campus activities such
as tourism, shopping, public festivals and new year cele-
brations. To collect data, we used a HP iPAQ 112 Classic
Handheld PDA set to record BDA with a timeout interval
of 6 seconds and a 30-second inquiry signal cycle.
Table I shows Bluetooth detection logs in different situ-
ations, and their characteristics for speciﬁc movements of
the user and the surrounding people. Four different cases
have been examined in this paper, namely strolling in town,
traveling by train, attending a conference, and taking lunch
at a cafeteria.
The results of examination of detection logs are summa-
rized in Figure 3. The upper half of Figure 3 shows the
detection pattern of Bluetooth devices, with the time-line
expressed on the horizontal axis and the device ID assigned
in chronological order of the incoming BDA on the vertical
axis. The mobile phones are shown in red, and PCs and
devices other than mobile phones in green, and unidentiﬁed
devices in blue. The lower half of Figure 3 shows the number
of detected devices, with the time-line expressed on the
horizontal axis and the quantity of BDA on the vertical axis.

111
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
(a) In Town
(b) On a Train
(c) In a Conference Room
(d) In a Cafeteria
Figure 3.
Detection pattern of BDA (upper), detected number of BDA (lower)
(a) Strolling in Town: Figure 3(a) shows the changes of
multiple detection logs encountered while strolling in town.
The number of BDAs is not constant as the number of
passers-by is always changing. Even if the pedestrians are
walking in the same direction, their devices disappeared
occasionally probably because their directions coincided
only for a while or their walking speed was different. On
the other hand, the same BDA was continuously identiﬁed
in some places while the examiner was lingering in a store.
(b) Transporting by Train: Figure 3(b) shows the detection
in a train during rush hour. From the log, we can iden-
tify characteristics such as: (i) devices were continuously
detected from passengers in the same carriage; (ii) many
incoming and outgoing devices were detected when chang-
ing trains; and (iii) a large number of people got on/off
the train at major stations. The passenger’s devices can be
constantly detected while the train is moving. However, due
to the limited size and shape of the carriage, the detection has
been low even in rush hour. This observation shows that it
is necessary to identify the situation from detection patterns
by integrating the analysis from different points of view, as
it cannot be inferred merely by the quantity of devices.
(c) Attending a Conference: Figure 3(c) shows that many
BDAs were detected continuously in the same room. As
most of the participants were staying in the room during
the conference, the number of BDAs was almost constant
(14 to 18 devices), except during the coffee break. As the
room was wide enough to hold many people, the quantity
of detections remained high.
(d) Taking lunch at a Cafeteria: Figure 3(d) shows that
many devices have been detected during lunch time, as
customers enter, take lunch and leave the cafeteria one after
another. Some devices are detected continuously with long
duration, and others are divided into several times with short
duration, because two types of situation are mixed together:
people sitting and eating lunch, and people walking around
to look for seats or friends.
These results show that pedestrian ﬂow can be inferred
by analyzing the detection logs as follows:
• The number of logged BDA detections: crowdedness
of people (requiring reference to the scale of space)
• Time length of BDA detection: people staying in same
space or duration of the event
• Appearance/Disappearance in BDA detection: peo-
ple staying, entering, leaving, or passing by
The detection logs show that there are several undetected
devices even among those staying in the same space. There-
fore, a method to interpolate the missing detections is also
explored in the following sections.
V. CONSTRUCTION OF THE AD HOC NETWORK
Another issue of concern is the management of the log
of pedestrian ﬂow obtained from each mobile device. It is
not efﬁcient to collect and manage the entire data sent from
mobile devices on a server. In this section, we describe a
peer-to-peer (P2P) mechanism necessary to manage data and

112
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 4.
Delaunay network and Voronoi diagram
perform computation between mobile devices cooperatively,
and provide a method to perform location-based range
queries for retrieving the data managed on mobile devices.
A. Scheme for Distributive Data Management
To build this mechanism we propose an ad hoc network
between the mobile devices to manage the data and com-
municate with other devices. In this network, each device
builds connections directly with other devices without com-
municating to a base station. In generating connections, it is
important to employ an efﬁcient scheme to choose mobile
devices to connect with, considering their location and lim-
ited communicable distance. Note that not all surrounding
pedestrians with mobile devices are viable for generating
connections on the ad hoc network. Some of their devices
might be cell phones or other devices with limited or no
computational capability.
We propose a peer-to-peer Delaunay network, which is
a geometry-based network whose topology is deﬁned by
the geometric adjacency of mobile devices (see Figure 4)
[13], [14]. These devices are connected in a geometrical
structure called a Delaunay Diagram, which is well-known
in computational geometry. It has the following features:
(i) each device connects to nearby devices based on geo-
graphical distance, (ii) the degree of connection for each
device is low (approximately six), (iii) the network can deal
with join/leave of a device only affecting the surrounding
devices to reconstruct and update the connection, and (iv)
the data on distant devices is retrievable through multi-hop
communication.
A P2P Delaunay Network lets us construct an environ-
ment in which the mobile devices are connected to each
other autonomously and distributively. It is not necessary
to prepare a server in order to maintain the system or
manage pedestrian ﬂow data on it. Moreover, it also provides
possibilities to perform collaborative computation or pro-
Figure 5.
Selection of nodes to connect
cessing to work with set of mobile devices nearby. Delaunay
Networks are effective for accessing data in geometrically
adjacent devices, which can expose missing detections by
comparing the detection logs of nearby devices. In this paper,
we refer to the geographical location of each mobile device
as a node.
A Voronoi Diagram is the dual of Delaunay Diagram and
is generally used to determine the governing regions for each
node. Let V = {v1, v2, . . . , vn} be a set of nodes distributed
in a plane. The Voronoi diagram for V is a partition of
the plane into n Voronoi regions, each region associated
with each point vi of V . For example, the shaded region in
Figure 4 is a Voronoi region of a node with a man in the
center. Each node vi has its own Voronoi region, and the
entire n Voronoi regions cover the entire plane, of which any
particular point is managed by one of the nodes of V . The
edges of the Voronoi Diagram are generated by connecting
the perpendicular lines stretched out from the midpoint of
the edges of the Delaunay Diagram. In this work, we use a
Voronoi Diagram to determine the nodes to which point or
range queries are sent for access to distant nodes.
B. Network Construction
In the present investigation, we apply a method proposed
previously [13] to generate a P2P Delaunay Network with
mobile devices. We assume that each mobile device only
has the location information of other devices, but not the
knowledge of how the other devices are connected. Thus,
each mobile device must choose the appropriate mobile
devices to connect to, using their locations to generate a
P2P Delaunay Network.
To build connections of a P2P Delaunay Network under
such conditions, each node draws an inscribed circle with
two other nodes on a plane, with the Delaunay Network
property that no other nodes shall be enclosed within the
circle. Figure 5 shows an example of v0 determining the
nodes to generate connections to on a plane. Inscribed circles

113
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 6.
Interpolation of BDA data (BDA1)
are generated connecting three nodes each, namely (v0, vi,
vj) {0 ≤ i ≤ 17, 0 ≤ j ≤ 17, i ̸= j}, which any of
these circles has no nodes in the internal. The nodes (v2,
v8, v9, v10, v17) are assigned as the neighbors of v0 to
generate connections with. If the rest of the nodes (v1 -
v17) perform the same processes, a Delaunay Diagram can
be generated. The detailed algorithm for generating and
maintaining connections are discussed in the previous work
[13]. Delaunay Network can be used not only to generate
or maintain connections with adjacent nodes on a plane,
but also to perform collaborative computation with adjacent
nodes as described in the following section.
C. Interpolation of Missing Detection
We have described methods to extract and manage the
Bluetooth detection logs on an ad hoc network. However,
there are false-negative cases in which some devices within
the communication range may not be detected. That is, too
much BDA data arrives at once in a crowded place, and the
device cannot handle it all within the limited time interval
while scanning for the surrounding Bluetooth devices.
To deal with such problems, we consider methods to
check the detection logs of adjacent nodes on Delaunay
network, and interpolate the BDA data which is deﬁnitely
within the communication range of Bluetooth device. Ini-
tially, each node sends a copy of its own detection logs
to adjacent nodes, and receives their copy of detection
logs. Then, it extracts the BDA data which is not detected
from its device, but detected from other adjacent nodes’
devices. These BDA data will be the target data to perform
interpolation, and the location of these adjacent nodes will
be the criterion to determine whether or not to perform
interpolation.
We validate only the BDA data owned by more than three
adjacent nodes to perform interpolation. That is, a polygon is
drawn using the location of adjacent nodes with the target
Figure 7.
Geometric-based routing method for range query
BDA data as vertices. If the location of its own node is
within the polygon, then the target BDA will be interpo-
lated. We have chosen a polygonal shape to determine the
interpolation because it is obvious that the entire polygonal
region is covered from the communication range of the
Bluetooth device. The purpose of this interpolation method
is to deal with missing detection, and the deformation of
communication range caused by walls, buildings, and other
obstacles is beyond our focus.
Figure 6 shows the interpolation process using the same
Delaunay Network as Figure 4. Node v0 has ﬁve adjacent
neighbor nodes, namely v2, v8, v9, v10, v17, and has the copy
of their BDA detection logs. Among the BDA on detection
logs, BDA1 is the only one that v0 does not have, but more
than three adjacent nodes (v2, v8, v10, v17) do have it. Using
these nodes as vertices, a polygon is drawn starting from
the upper node in clockwise direction. Finally, BDA1 can
be determined to be included in v0’s detection data, as it is
allocated within the polygon area.
D. Location-based Range Query
When users would like to know the pedestrian ﬂows or
the situation of a physical area, they designate a particular
location or range and ask what is going on in that location.
Therefore, the location should be used as a key for searching
and gathering data on the ad hoc network.
In order to send a query or data to a destination, each node
vi generates a Voronoi diagram using vi and the neighbor
nodes of vi. Here, we deﬁne global Voronoi diagram as a
Voronoi diagram drawn with all the nodes on a plane, and
local Voronoi diagram as a Voronoi diagram drawn only with
a given local node and its neighbor nodes. Using its local
Voronoi diagram, each node vi selects the neighbor node
to send the query, and performs multihop communication
between nodes. The shape and locational data of the query
range is sent together along with the query.
Figure 7 shows the process of sending a query to a
particular range on a plane. First of all, v0 determines the
nodes from its neighbor nodes v2, v8, v9, v10, v17 to send
the query. Among these nodes, v2 is the only node selected

114
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
to send the query, as its Voronoi region of v2’s local Voronoi
diagram covers the entire query range. Next, v2 determines
the nodes from its neighbor nodes v1, v3, v5, v6, v8, v0, v17
to send the query. For this situation, v3 and v5 cover the
query range and so the query is sent to both of the nodes.
This process is performed recursively until the query has
reached the destination.
Using this method, we can generate either a point query
search, by designating a particular point on a plane, or
a range query search which can request data within a
designated range. Thus, the global view of the location of
nodes is not required to send data to a destination.
VI. ISSUES WITH TRENDS AND APPLICATIONS
A. Considerations for Technological Changes
We have continuously attempted to collect the Bluetooth
detection logs in order to observe the changes in various
environments for a couple of years. We have also noticed
that the technological advancements and changes in con-
sumers’ lifestyle have considerably affected the results of
detection. In general, it is noticeable that the detection
rate by Bluetooth device logs has gradually been reducing
even during these past couple of years. In particular, it has
become difﬁcult to collect Bluetooth device logs in college
environments such as school buses, campus cafeteria or
restaurants, lecture rooms, and so on. It can be assumed that
students and the younger generations are using smart phones
instead of feature phones, and that these smart phones are
probably programmed to turn off the Bluetooth connection
if not used during a certain amount of time.
We have observed, at the same time, that the detection
rate by Bluetooth devices is changing among age groups
when we compared the data with those detected in the train,
train stations, stores, or while strolling in towns. As these
places are likely to be occupied or visited by mixed age
groups, including commuters, holiday goers, travelers, chil-
dren, students, elderly groups, and many others, the changes
of Bluetooth detection rate are rather gradual, though not
increasing, compared with the detection on campus or while
boarding the school bus where the majority of the passengers
are young students.
On the other hand, the number of WiFi detections has
been increasing rapidly especially in campus environment,
probably because several mobile WiFi terminals have ap-
peared on market, or some smart phones are equipped with
WiFi connection technology which works as an access point.
Therefore, we are also going to collect WiFi logs along with
Bluetooth detection logs, and are planning to examine WiFi
logs to see whether the device can be classiﬁed between
static devices that are ﬁxed at a single location, or dynamic
devices that move along with people. If both Bluetooth and
WiFi log data are detected and examined together, it might
be possible to perform more accurate analysis.
Figure 8.
Applications to deploy the extracted pedestrian ﬂows
Table II shows the changes in detection logs from the
initial experimental stage in 2010 to the most recent data in
2013. The average number of detected logs by minute are
calculated for 10 weekday mornings when the user himself
is commuting. The results indicate that WiFi detection has
been increasing in general even in the train where people
with various age groups and different occupations are on
board, and that it is more evident with the campus bus in
which most of the passengers are students. Therefore, it
seems important to detect and analyze using both Bluetooth
and WiFi logs in future research.
It is also noted that there may be other reasons to prioritize
differently for the detection devices which can be used
for the experiment, since the technological advancement as
well as lifestyles and cultures are different depending upon
particular regions and localities.
B. Possible Applications for Practical Scenarios
It is necessary to consider efﬁcient applications to deploy
our method for detecting pedestrian ﬂows. Some of the
possible applications are mentioned here as suggestions for
further research.
1) Map Visible of Pedestrian Flows: One of the systems
to consider for the feasible applications is a map to visualize
the ﬂow and situation of pedestrians or the location of
congested area as shown in Figure 8 upper left. Pedestrian
ﬂows are dynamic and likely to change frequently, therefore
it is necessary to gather and process the information as
soon as possible. Our method of detecting and analyzing
Bluetooth devices may be applicable as it can collect the
data seamlessly in real-time, and pass it to the application
at the same time. Moreover, it is desirable for users to input
time and place so that they can view the past or present
location of congested area or pedestrian ﬂows, in order to
estimate the future pedestrian ﬂows based on the calculated
patterns from the same daily routine of pedestrian activities.
Visualization method of pedestrian ﬂows might also be an
important factor for users to understand the situation. The
crowded area can be expressed as a circle, and locations

115
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Table II
NUMBER OF BLUETOOTH VS WIFI DETECTED IN THE TRAIN AND BUS
Train, Year 2010
Date
Time(min.) Bluetooth
BT per min.
WiFi WiFi per min.
Day 1
71
275
3.87
116
1.63
Day 2
72
182
2.53
207
2.88
Day 3
81
370
4.57
223
2.75
Day 4
88
532
6.05
150
1.70
Day 5
82
399
4.87
170
2.07
Day 6
70
132
1.88
236
3.37
Day 7
64
389
6.08
122
1.91
Day 8
64
344
5.38
77
1.20
Day 9
77
372
4.83
127
1.65
Day 10
83
466
5.61
181
2.18
Avg/Total
4.57/6.70(68%)
2.14/6.70(32%)
Bus, Year 2010
Date
Time(min.) Bluetooth
BT per min.
WiFi WiFi per min.
Day 1
29
38
1.31
116
4.00
Day 2
13
58
4.46
37
2.85
Day 3
13
27
2.08
84
6.46
Day 4
12
0
0.00
31
2.58
Day 5
13
28
2.15
87
6.69
Day 6
13
29
2.23
81
6.23
Day 7
14
0
0.00
38
2.71
Day 8
21
125
5.95
85
4.05
Day 9
18
111
6.17
88
4.89
Day 10
12
4
0.33
92
7.67
Avg/Total
2.47/7.28(34%)
4.81/7.28(66%)
Train, Year 2013
Date
Time(min.) Bluetooth
BT per min.
WiFi WiFi per min.
Day 1
50
71
1.42
386
7.72
Day 2
53
297
5.60
208
3.92
Day 3
54
181
3.35
314
5.81
Day 4
53
129
2.43
132
2.49
Day 5
55
107
1.94
318
5.78
Day 6
54
139
2.57
194
3.59
Day 7
57
142
2.49
350
6.14
Day 8
58
108
1.86
425
7.33
Day 9
54
58
1.07
371
6.87
Day 10
57
18
0.32
481
8.44
Avg/Total
2.30/8.12(28%)
5.81/8.12(72%)
Bus, Year 2013
Date
Time(min.) Bluetooth BT per min. WiFi WiFi per min.
Day 1
13
33
2.54
93
7.15
Day 2
13
0
0.00
74
5.69
Day 3
15
3
0.20
100
6.67
Day 4
15
41
2.73
96
6.40
Day 5
17
3
0.18
99
5.82
Day 6
12
0
0.00
103
8.58
Day 7
16
8
0.05
159
9.94
Day 8
14
0
0.00
120
3.57
Day 9
25
0
0.00
134
5.36
Day 10
15
4
0.27
63
4.20
Avg/Total
0.64/7.48(9%)
6.83/7.48(91%)
with many Bluetooth detections may be ﬁlled with dark
colors together with numbers expressing the congestion rate.
However, the circle may not be enough if there are many
sensing devices which cause the creation of multiple over-
lapping circles or numbers. As an alternative, expressing it
with coloring the Voronoi diagrams, instead of circles, might
be very helpful in that case. Coloring circles and Voronoi
diagrams have both merits of their own. Coloring circles
may express the location of sensing devices accurately in
vacant areas and Voronoi diagrams may express the detection
results from many sensing devices. Therefore, it might be
effective to use the advantageous aspects from both methods
and choose the preferable ones depending on the situation.
The graphical user interface for expressing congestion and
frequent changes of pedestrian activities and movements are
in our plans for future work.
2) Context-adaptable Pedestrian Navigation System: We
have also been working on the context-adaptable pedestrian
navigation system shown in the upper right of Figure 8,
which is a navigation system to provide users with the
preferable route considering the user objectives and condi-
tions of each area, such as with roof (to avoid rain) or no
roof, lighted or dark, with stairs or elevators, narrow path
or wide road, safe or dangerous facilities, and crowded or
less crowded area [15]. Most of these situations are static,
except for the crowdedness which changes according to the
pedestrian ﬂows.
In relation to this topic, we have previously proposed
an algorithm to perform path search considering the user’s
preference and spatial context. The graph-based approach
was employed using metadata to represent logical space
built over the real space, and a scoring scheme was applied
by partitioning target region into homogeneous cells. Path
search was performed by accumulating negative or positive
scores to each of the cells according to the user’s intention or
situation, and the path with the lowest scores to destination
was provided. However, not much discussion has been held
with the method to detect the situation in space.

116
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Figure 9.
Immobile wireless sensors to detect pedestrian ﬂows
To detect pedestrian ﬂows, we had previously thought
to prepare many ﬁxed immobile devices on site, such as
stepped-on sensors, wireless sensors, video cameras, etc., as
shown in Figure 9. This approach is inefﬁcient, however,
as it is expensive, requires a massive number of sensors,
takes time and effort to install sensors, and cannot be
deployed in all desirable locations. It requires abundant
initial preparations to build such systems. Our method to
extract pedestrian ﬂows from Bluetooth detection logs may
be helpful to solve these problems.
3) Multi-avatar
Simulation
on
Virtual
Collaborative
Space: We have worked on constructing an autonomous
dynamic multi-avatar simulation in a 3D virtual collaborative
space (lower part of Figure 8), in which the avatars move
according to their behavioral patterns deﬁned beforehand
[16]. If the avatar’s location and congestion information are
mapped to 3D virtual collaborative space, we may be able
to perform simulations based on the real world situation.
Though our Bluetooth detection method cannot provide the
exact number of pedestrians, if we can estimate the number
of pedestrians in the real as a ratio to the number of detected
pedestrians, we might be able to produce an atmosphere
similar to the real world with dynamic pedestrians walking
around in the virtual environment. Such simulation is useful
in order to understand intuitively the situation occurring at
the physical site.
4) Pedestrian Flow Analysis in Airport Environment:
Our work might also be a possible extention to Pestana’s
work which proposes an approach to provide security and
safety concerning mobile objects in an airport environment
[17]. In the airport environment, there are many gates,
restaurants, gift shops, etc., and passengers from various
countries congregate in these locations. However, the pas-
sengers’ behavior patterns might differ depending on their
cultural backgrounds. For example, a particular restaurant
might be preferred by people from the same or neighboring
countries, or some people from the same region or areas
might prefer buying many souvenirs at gift shops. Thus,
collecting and analyzing the detection logs might contribute
to recommending the passengers the preferable shops and
restaurants depending on their nationalities, or sometimes
suggesting to them uncrowded cafeterias or benches to take
a rest.
Moreover, as the departure time of the ﬂight and the
departure gates are the same for every day’s routine, the
analysis of detection logs may clarify the daily routine
of pedestrian’s behavioral patterns. For example, if United
Airlines uses the gate number 15 at 12 pm every day,
passengers to the United States may gather at the gate
around that time. Most of those passengers might take a
lunch at McDonalds fast-food restaurant, even if there are
various restaurants other than McDonalds. Such analysis
based on the application of our method may contribute to
a recommendation system or navigation system, which will
provide comfortable, safe, and preferable navigation in the
airport.
VII. CONCLUSION AND FUTURE WORK
We have shown possibilities for inferring pedestrian ﬂows
by examining the detection patterns of surrounding Blue-
tooth devices, and proposed methods for generating mobile
ad hoc networks and managing the detection data on the
network, adhering to our policy to avoid initial prepara-
tions to install cameras or sensors on the environment, or
manage data on a single server. For deployment in actual
environments, energy consumption is an important issue
that has to be considered, as the battery for HP iPAQ
112 Classic Handheld PDA used for our experiment lasts
for approximately 4 hours. In addition, privacy issues are
another concern because such personal data as user name
and location should not be exposed to others.
For future work, we plan to perform detailed analysis of
Bluetooth device logs, examine the applicability of other
sensory data including WiFi, and provide location-based ap-
plications using social contexts such as pedestrian ﬂows. We
also plan to continue further study on Delaunay networks,
explore efﬁcient ways of managing social context data and
log ﬁles, and evaluate our methods to interpolate missing
data caused by inquiry faults.
In addition, from the observations presented in Section
VI-A, we have found that Bluetooth devices are becoming
harder to detect year by year. Therefore, analysis simply by
Bluetooth device detection may not be enough to extract the
ﬂow of pedestrians. On the other hand, WiFi is being de-
tected increasingly every year from portable devices, which
should be another target to perform analysis on. Moreover,
there may be many variations of wireless technologies
coming out in the future, and thus, it is important to keep
up with new technologies and trends to extend this research
in the future.
ACKNOWLEDGMENT
This work was partially supported by MEXT/JSPS KAK-
ENHI Grant Number 23650033, and The Telecommunica-
tions Advancement Foundation. We would also acknowledge

117
International Journal on Advances in Networks and Services, vol 6 no 1 & 2, year 2013, http://www.iariajournals.org/networks_and_services/
2013, © Copyright by authors, Published under agreement with IARIA - www.iaria.org
Prof. Yasuyuki Kono of Kwansei Gakuin University, Prof.
Satoshi Nakamura of Kyoto University and Dr. Ian Piumarta
of Viewpoints Research Institute for their valuable comments
and suggestions.
REFERENCES
[1] R. Nishide and H. Takada, “Methods and Issues in Detecting
Pedestrian Flows on a Mobile Adhoc Network,” The Second
International Conference on Mobile Services, Resources, and
Users (MOBILITY 2012), pp.76–79, 2012.
[2] P. Lukowicz, A. Pentland, and A. Ferscha, “From Context
Awareness to Socially Aware Computing,” IEEE Pervasive
Computing, 11 (1), pp. 32–41, 2012.
[3] A. Campbell, N. Lane, E. Miluzzo, R. Peterson, H. Lu, X.
Zheng et al., “The Rise of People-Centric Sensing,” IEEE
Internet Computing, 12 (4), pp. 12–21, 2008.
[4] R. Nishide and H. Takada, “Exploring Efﬁcient Methods to
Extract Pedestrian Flows on a Mobile Adhoc Network,” The
Sixth International Conference on Mobile Ubiquitous Comput-
ing, Systems, Services and Technologies (UBICOMM 2012),
pp. 29–34, 2012.
[5] R. Nishide, T. Ushikoshi, S. Nakamura, and Y. Kono, “De-
tecting Social Contexts from Bluetooth Device Logs,” 11th
International Conference on Ubiquitous Computing (UbiComp
2009) Supplemental Proceedings, pp. 228–230, 2009.
[6] E. O’Neill, V. Kostakos, T. Kindberg, A.F. Schiek, A. Penn, D.
Fraser and T. Jones. “Instrumenting the city: Developing meth-
ods for observing and understanding the digital cityscape,” 8th
International Conference on Ubiquitous Computing (Ubicomp
2006), pp. 315–332, 2006.
[7] T. Nicolai and H. Kenn. “About the relationship between
people and discoverable bluetooth devices in urban environ-
ments,” 4th international conference on mobile technology,
applications, and systems (Mobility ’07), pp. 72–78, 2007.
[8] N. Eagle and A. Pentland. “Reality mining: sensing complex
social systems,” Personal and Ubiquitous Computing, 10, pp.
255–268, 2006.
[9] D. Kim and D.-K. Cho, BlueSense: Detecting individuals,
locations, and regular activities from Bluetooth Signals,
http://www.cs.ucla.edu/∼dhjkim/ﬁles/pdf/cs219 BlueSense.pdf
(Retrieved August 23, 2012)
[10] J. Weppner and P. Lukowicz, “Collaborative Crowd Density
Estimation with Mobile Phones,” Second International Work-
shop on Sensing Applications on Mobile Phones (PhoneSense
2011) at ACM SenSys, pp.26–30, 2011.
[11] E. Bulut and B. K. Szymanski, “Exploiting Friendship Rela-
tions for Efﬁcient Routing in Mobile Social Networks,” IEEE
Transactions on Parallel and Distributed Systems, 23 (12),
pp.2254–2265, 2012.
[12] Chika-game
/
Chika-Chat
|
Softbank
(in
Japanese),
http://mb.softbank.jp/mb/service/3g/communication/chika/
(Retrieved August 23, 2012)
[13] M. Ohnishi, R. Nishide, and S. Ueshima, “Incremental Con-
struction of Delaunay Overlaid Network for Virtual Collabora-
tive Space,” The Third International Conference on Creating,
Connecting and Collaborating through Computing (C5’05),
IEEE CS Press, pp. 77–84, 2005.
[14] Y. Sun, Q. Jiang, and M. Singhal, “An Edge-Constrained
Localized Delaunay Graph for Geographic Routing in Mobile
Ad Hoc and Sensor Networks,” IEEE Transactions on Mobile
Computing, 9(4), pp. 479–490, 2010.
[15] M. Kawabata, R. Nishide, M. Ueda, and S. Ueshima,
“The Context-adaptable Pedestrian Navigation System and
Usability in Practical Settings,” IEEE Paciﬁc Rim Confer-
ence on Communications, Computers and Signal processing
(PACRIM2005), Vol.1 No.05CH37690, pp.368–371, 2005.
[16] R. Nishide, I. Kimura, M. Ohnishi, and S. Ueshima, “Model-
ing of Dynamic Behavior of Multi-Avatars in Virtual Collab-
orative Space,” IEEE Paciﬁc Rim Conference on Communica-
tions, Computers and Signal processing (PACRIM2003), Vol.1
No.03CH37490, pp.25–28, 2003.
[17] G. Pestana, A. Casaca, P. Reis, S. Heuchler, and J. Metter,
“Management of Mobile Objects in an Airport Environment,”
The Second International Conference on Mobile Services,
Resources, and Users (MOBILITY 2012), pp. 55–59, 2012.

