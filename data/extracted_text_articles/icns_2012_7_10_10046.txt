 
UE
RN 
Source DeNB
Target DeNB 
MME 
serving -GW 
X2 
S1 
S1 
Cell1 
Cell2 
A Relay-assisted Handover Pre-authentication Protocol in the LTE Advanced 
Network 
Ling Tie 
The Department of Information Science and Technique  
The Chengdu University 
Chengdu, Sichuan, China 
tlcd4579@gmail.com 
Di He 
The Department of Electronic Engineering  
      The Shanghai Jiaotong University 
Shanghai, China 
dihe@sjtu.edu.cn
 
 
Abstract—With the help of relaying, The Long Term Evolution 
Advanced network is improved on the coverage and capacity. 
But relaying concept brings many problems on handover 
management. In this paper, a relay node is introduced in the 
system structure. We extend the handover procedure to 
support relaying and transmit security context. We design a 
relay assisted handover pre-authentication protocol, which 
happened before the mobile node handovers to the target cell. 
This article focuses on formal analysis of our proposed security 
protocol. Finally, an improved strand space and ideal formal 
analysis method, which includes message authentication code, 
is introduced. We use it to prove that our proposed protocol 
can meet the security and authentication proprieties. 
Keywords- Long Term Evolution; relay; handover; security;  
strand space;  ideal 
I. 
 INTRODUCTION  
The Long Term Evolution Advanced network (LTE-A) is 
considered as one of the main standards for the 4th generation 
broadband wireless network. Recently, due to the increasing 
demand for high transport rate and capacity, the relaying 
concept is introduced. The implementation of relay can 
overcome the restriction of coverage, especially at the 
cellular boundary. With the help of relay node (RN) located 
at the overlap between two adjacent cells, the user equipment 
(UE) being served by a source cell can pre-handover to the 
target cell. The handover interrupt rate and delay will be 
reduced significantly.  
There are many papers have talked about handover 
schemes happened in the relay LTE-A network. In [1], five 
relay handover scenarios are categorized in multi-hop 
cellular network (MCN). Several handover frameworks for 
relay enhanced LTE Network are introduced in [2]. Some 
relay handover procedures supporting centralized and 
decentralized relaying are illustrates. But，these articles do 
not discuss security and authentication issues. 
In the 3GPP draft 36.300 [3], a Relay Node (RN) is 
connected to an evolution Node B (eNB) wirelessly. The 
eNB serving the RN is called Donor eNB (DeNB). The Draft 
36.300 gives an end-to-end authentication and key 
agreement (AKA) procedure when the RN first attaches to 
the LTE. The 3GPP draft 33.816 [4] proposes many 
solutions that support LTE relay node security. But，these 
standards do not discuss pre-handover authentication issue. 
In this paper, a relay-assisted handover pre-authentication 
protocol is provided. The UE, RN and Target DeNB 
authenticate mutually before handover occurs. This protocol 
will reduce the handover delay significantly. But, this paper 
focuses on only formal analysis of our proposed security 
protocol. The performance of our proposed protocol will be 
discussed in future works. 
The rest of the paper is organized as follows. The system 
architecture is given in Section II. In Section III, the 
proposed relay assisted handover authentication protocol is 
presented. The extended strand space is introduced in 
Section IV. The security is proved using this strand space 
model. Section V gives a brief introduction of the 
performance improvement. Section VI concludes this paper. 
II. 
SYSTEM STRUCTURE 
The system architecture of the proposed scheme is 
illustrated in Figure1. During the UE handovers from cell 1 
to cell 2, the signal strength between the UE and the sourcing 
DeNB decreases. When the signal strength falls below 
certain threshold, handover will happen. However, the UE 
still remain in the source cellular. The UE will try to find one 
RN located at the coverage area between the source DeNB 
and the target DeNB. The RN helps the UE to pre-
authentication to the target DeNB.  
Figure 1.  Relay handover structure 
The LTE-A consists of the following major components: 
 
User Equipment (UE): It is mobile host. 
159
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

 
K 
USIM/AuC
CK,IK 
kASME 
UE/HSS 
kNAS enc/int 
keNB 
kRelay 
UE/MME 
kUP enc/int 
kRRC enc/int 
UE/eNB 
UE/Relay 
kRelay enc/int 
 
 Relay Network (RN):    It provides multi-hop Wire-  
less connectivity from the UE to the Target DeNB. 
 
  Donor eNB (DeNB):   It is an eNB serving the RN. 
III. 
RELAY ASSISTED HANDVER PRE-AUTHENTCAITON 
PROTOCOL 
A. Notations 
Before we describe the relay assisted pre-authentication 
protocol, we will specify some of notations used in the 
protocol, as shown in Table I. 
TABLE I.  
NOTATIONS 
symbol 
Explanation 
kX
 
The Key known by the X  
, )
(
h
k
MAC
X
 
Message authentication code 
 produced by 
kX
 
{h}kX
 
The message is encrypted by the key 
X
k
NX
 
The nonce value produced by X  
IDX
 
The identification of X  
|| 
Concatenation 
, )
(
h
k
KDF
X
 
Security  key produce function by 
kX
 
  
B. Handover Key Hierarchy 
According to the 3GPP draft 33.816 [4], the calculation 
of 
*
keNB
 and 
kRelay
 is based on the key hierarchy in Figure 
2. The 
keNB
  is achieved from traditional AKA 
authentication method defined in the draft 33.401 [5].The 
handover key  
*
keNB
is produced according to the method 
published in the draft 33.401 .The relay key is calculated as 
in (1).  
kRelay
 =KDF (
keNB
|| SSIDrelay)                                       (1)                            
C. Relay Assisted  Handover Procedure 
Figure 3 shows the relay assisted pre-handover procedure. 
This procedure is based on [2]. We extended this procedure 
to include the calculation and transmission of security key. 
All the handover messages are protected by the key in Figure 
2.   
The Steps are as follows: 
Step 1: The RN sends the measurement control message 
to the UE. 
Step 2: The UE sends the measurement report message to 
the RN and forward it to the Source DeNB. 
Step 3: Based on the measurement report, the Source 
DeNB makes RN handover decision. If RN 
handover is allowed, the source DeNB initiates 
the handover process. The source DeNB will 
calculate 
*
keNB
 as the handover key for the target 
Figure 2.  Handover key hierarchy 
 DeNB[5]. It can also produce the key 
kRelay
 for 
the RN. 
Step 4: The source DeNB sends the handover request 
message to the Target DeNB. This message 
includes  
*
keNB
 and
kRelay
, which are protected 
by the RRC key. 
Step 5: The target DeNB accepts the handover request 
message. 
Step 6: After completing admission control, the target 
DeNB sends the handover request acknowledge 
message to the source DeNB.  
Step 7: The source DeNB sends the handover command 
message to the RN securely. This message 
includes 
kRelay
 for the RN. 
Step 8: The RN receives the handover command message 
and 
kRelay
 for the RN. It sends the handover 
command message to the UE, which includes 
Relay SSID. 
Step 9: The UE uses information received from the 
handover command message to create
*
keNB
. It 
calculates 
kRelay
 simultaneously. Now，the UE 
has keys 
*
keNB
 and
kRelay
. 
160
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

 
UE 
RN 
Source DeNB 
2 Measurement Report  
MME 
Target  DeNB 
Serving 
Gateway 
1 Measurement control 
3 RN HO Decision  
Derive keNB
* ,kRelayfrom keNB 
10 relay assisted handover authentication protocol  
4 Handover Request (keNB
* , kRelay) 
5 Admission control 
6 Handover Request Ack 
7 Handover Command (kRelay) 
8 Handover Command (Relay ssid) 
9 Derive keNB
* ,kRelay  
from keNBa and Relay ssid  
11Handover Confirm  
12 Handover Complete  
13 User Plan Update Request 
14 User Plan Update Responses  
15 Handover Complete Ack 
16 Release Resources 
17 Release Resources 
 
 
 
 
 
 
Figure 3.  Relay-assisted  handover Pre-authentication Sequence  
Step 10: The UE achieves relay-assisted handover pre-
authentication with the Target DeNB through 
the RN. 
Step 11: The UE sends the handover confirm message to 
the RN and forward it to the Target DeNB. 
Step 12: The Target DeNB sends the handover complete 
message to the MME. 
Step 13: The MME sends the user plan update Request 
message to the Serving GW. 
Step 14: The Serving GW sends the user plan update 
Response message to The MME. 
Step 15: The MME sends the handover complete Ack 
message to the Target DeNB. 
Step 16: The Target DeNB sends the release resource 
message to the Source DeNB 
Step 17: The Source DeNB sends the release resource 
message to the RN. 
D. Relay Assisted Handover Pre-authetication Protocol 
 In this section, a detailed description of our proposed 
pre-authentication protocol is given. It is the step 10 in figure 
3. The extension of the step 10 sequence in Figure 3 is 
showed in Figure 4. 
Step10. 1: When the UE still remain in the cell 1, it begins 
the pre-authentication procedure, with the help of 
RN. 
The 
UE 
sends 
the 
relay 
handover 
authentication request message to the RN. The 
UE generates two nonces. 
N2UE
 is used for RN, 
the other 
N1UE
 is used for Target DeNB. The 
nonce is encrypted by the key known only by the 
RN and the Target DeNB. The UE calculates the 
message authentication code (MAC) of the RN 
and the Target DeNB. 
Step 10.2: Upon receiving the relay authentication request 
message, the RN decrypts the message and 
verifies the MAC using the key
kRelay
. If the 
verifications succeed, the RN authenticates the 
UE.The RN produces a nonce 
N1RN
 and 
generates the MAC using the key 
kRelay
 .The 
nonce and the identification of the relay are 
encrypted using the key
kRelay
. Then the RN 
sends a Target authentication request message to 
the Target DeNB. 
Step 10.3: When this message reaches the Target DeNB, the 
Target DeNB carries out the same MAC 
computation. If the verification is correct. The  
Target DeNB will successfully authenticate the 
UE and the Relay. The Target DeNB produces 
two nonces, 
T
N1 and
T
N2 . The Target DeNB 
constructs 
Target 
authentication 
response 
messages include the session key 
kU T
  as in (2) 
share between the UE and Target DeNB and the 
key 
kR T

as in (3) share between the RN and 
Target DeNB. The Target DeNB uses the MAC 
algorithm to produce two message authentication 
codes for the RN and the UE. 
kU T

 =KDF (
*
keNB
, N1T, N1UE+1, IDT, IDUE)    (2) 
kR T
 =KDF (
kRelay
 , N1RN+1, N2T, IDRN, IDT) (3) 
Step 10.4: The RN receives the Target authentication 
response message and uses the key 
krelay
 to 
decrypt the 
kR T
 as in (3). The RN verifies the 
MAC and authenticates the Target DeNB. Then, it 
calculates the key 
kU R
 as in (4) between the UE 
and RN. Then it adds the MAC of the UE into the 
161
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

 
RN 
UE 
Target  DeNB 
1 Relay handover Authentication Request 
2 Target handover Authentication Request 
3 Target handover Authentication Response 
4 Relay handover Authentication Response 
relay authentication response message and sends 
it to the UE. 
kU R

 =KDF (
kRelay
, N2Relay, N2UE+1, IDRN, DUE)     (4) 
Step 10.5: The UE receives the relay authentication 
message and decrypts  
kU T
  and 
kU R

 .The 
UE uses the same MAC algorithm to 
authenticate the RN and Target DeNB. 
 
Figure 4.  Relay assisted handover pre-authentication protocol 
The protocol described in detail below:  
UE →RN:  
} *
,
1
{
keNB
N UE IDUE
,
)
||
1
,
(
*
UE
UE
eNB
ID
N
MAC k
, 
          
lay
k
UE IDUE
N
} Re
,
2
{
,
)
||
2
,
(
Re
UE
UE
lay
ID
N
MAC k
 
RN →Target DeNB:  
} *
,
1
{
keNB
N UE IDUE
,
)
||
1
,
(
*
UE
UE
eNB
ID
N
MAC k
 ,
lay
k
RN
UE
UE
RN
ID
ID
N
N
} Re
,
,
2
,
1
{
,
)
||
||
2
||
1
,
(
Re
UE
RN
UE
RN
lay
ID
ID
N
N
MAC k
 
Target DeNB → RN:  
} *
,
,1
1
1 ,
,
{
keNB
UE
T
UE
T
U T
ID
ID
N
N
k


, 
)
||
1||
1
1 ||
||
,
(
*
UE
T
UE
T
U T
eNB
ID
ID
N
N
K
MAC k


,
lay
k
UE
T
RN
T
RN
R T
ID
ID
ID
N
N
k
} Re
,
,
2 ,
,1
1
,
{


, 
)
||
||
||
2
1||
1
||
,
(
Re
UE
T
RN
T
RN
R T
lay
ID
ID
ID
N
N
k
MAC k


 
RN→UE: 
 
} *
,
,1
1
1 ,
,
{
keNB
UE
T
UE
T
U T
ID
ID
N
N
k


, 
                  
)
||
1||
1
1 ||
||
,
(
*
UE
T
UE
T
U T
eNB
ID
ID
N
N
K
MAC k


, 
lay
k
T
UE
RN
UE
RN
U R
ID
ID
ID
N
N
k
} Re
,
,
,1
2
,
2
,
{


 , 
)
||
||
||
1
2
||
2
||
,
(
Re
T
UE
RN
UE
RN
R
U
lay
ID
ID
ID
N
N
k
MAC k


 
This protocol happens before the UE handovers to the 
target cell. Due to space limitations, we do not discuss the 
performance of the proposed protocol. This paper will pay 
more attention on security formal analysis.   
IV. 
SECURITY FORMAL ANALYSIS 
In this section, we will use strand space formal analysis 
method to prove that our protocol is secure. Although strand 
space method [6] is efficient, there are some shortcomings. 
We 
extend 
strand 
space 
to 
include 
message 
authentication code (MAC) item. 
A. Extend Strand Space  
We define the set A  of terms. The element in A  is the 
information exchanged among subjects. In particular, we will 
assume: 
 
A set T  of texts (represent the atomic messages) 
T  A
. 
 
A set of cryptographic keys K  disjoint from T . 
K  A
. 
 
A unary operator
K
inv K

:
. 
 
 Three binary operators 
A
A
encr K


:
 
A
A
join A


:
 
A
A
MAC K

' 
:
 
As usual, we will write 
inv(K)
as
K 1
,
)
,
(
encr K m
 
as
{m}K
, and 
( , )
join a b
asab . 
We redefine axioms as follows. 
Axiom 1: for 
A
m m
' 
,
 and 
K
k k
1, 2 
, 
K
k k
' 
2
'
1,
 
If 
2
1
}
{
}
{
'
k
k
m
m

then 
m  m'
 and 
2
1
k  k
; 
  If 
)
,
(
)
,
(
'
2
1'
m
MAC k
MAC k m

then 
m  m'
 
and 
'
2
1'
k  k
. 
Axiom 2:  for
A
m m m m
' 
1
1
'
0
0
,
,
,
, and 
K
k k
' 
,
 
(1)
'
1
1
'
1
0
'
1
'
0
0 1
m
m
m
m
m m
m m





 
(2) 
} '
{
'
0
1
0
k
m
m m

                                          
(3)
T
K
m m

1 
0
                                   
(4)
T
K
m
k

} 
{
'
0
   
(5) 
)
,
(
'
0
'
0 1
MAC k m
m m

 
(6) 
T
K
MAC k m

)
,
(
'
0
'
 
We extend it to include MAC item according to [7]. 
Definition 1   A strand space is a set
  with a trace 
mapping tr : 


( A *)
.  
162
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

Definition 2 A penetrator trace is one of the following: 
M. Text message :< +t>, where
t T
 
F.  Flushing :<-g> 
T.  Tee : <-g,+g,+g> 
G. Concatenation : <-g,-h, +gh> 
S. Separating into components:<-gh, +g,+h> 
K. Key :< +k>, where
k  K
   
E. Encryption: <-k,-h, +
{h}k
 > 
D. Deception : <-k,-h. - 
{h}k
,+h> 
MAC . Message authentication code:  
<-k’,-h,
, )
(
MAC k' h
 > 
Definition 3 Let C  be a set of edges, and let 
C
 be the set 
of nodes incident with any edge inC .C  is bundle if : 
(1). C  is finite. 
(2). If 
C
n
1  
 and 
)
(
1n
term
is negative, then there is a 
unique 
2
n  such that
C
n
n
 

1
2
. 
(3). If 
C
n
1  
 and 
1
2
n  n
  then
C
n
n
 

1
2
. 
(4). C  is acyclic. 
Definition 4 If C  is a bundle and
s
, then the C  
height of s , denoted C-
height(s)
, is the largest 
( ( ))
i  length tr s
 , such that 
s 
 and 
C
i
s 
,
 
Definition 5 An infiltrated strand space is a  
pair  
,
with 
a strand space and

  
such that 
tr(p)
 is a penetrator trace for all 
p
 
Definition 6 The sub-term relation 
 is defined  
Inductively, so that: 
(1) a
t  for  
t T
 iff a =t  
(2) a
k for  
k  K
 iff a = k  
(3) a
{g}k
 iff a
g  or a =
{g}k
  
(4)a
gh  iff a
h , a
g  or a  = gh  
(5)a
, )
(
MAC k' g
 iff a
g  or a = 
, )
(
MAC k' g
 
 We redefine the ideal and honest idea [8] including the 
MAC. 
Definition 7 If
  
, a  -ideal of A  is a subset I   of 
A  such that for all 
h I
 ,
g  A
and
k 
 
   (1) 
I
gh hg

,
 
   (2)
h k  I
{ }
 
(3)
I
MAC k h
, )
(
'
 
The smallest  - ideal containing h  is denoted
I [h]
. 
Definition 8 h is a sub-term of g , written h
g  
 , defined as 
I [h]
g
 
. 
Proposition 1 
 is a transitive ,reflextive relation .  
More over ,if 
A
h g

,
 and 
k,k' 
, then  
(1) h
 h g  and g
g h  
(2) h
 
{h}k
 
(3) h
, )
(
MAC k' h
 
Definition 9   If 
S  A
 
I [S]
 is the smallest  
 -  ideal containing S . 
Definition 10 Support 
  
. 
s A
 is a  - subterm  
of 
t  A
, written s  
 t  iff 
I [s]
t
 
 
Proposition 2 if 
S  A
, 
[ ]
[ ]
x
I
S
I
x S


  
 
Lemma 1   Let
S  S
0
, 
}
], ,
[
],
[
:)
,
(
} ,
{{
'
'
1








k k
S
I
g
S
I
g
MAC k g
g
S
i
i
k
i
 
then 
]
[
]
[
i
i
S
I
S
I


 
 
Proposition 3 Suppose
S  A
, and every 
s S
 is 
simple 
.If 
I [S]
gh
 
 then 
either 
I [S]
g
 
 or 
I [S]
h
 
 
Proposition 4   Suppose
k,k' 
; 
S  A
, and for every 
s S
, s  is simple and is not of the form 
{g}k
 or 
, )
(
MAC k' g
. 
 if 
[ ]
{ }
S
I
h k
 
or
[ ]
, )
(
'
S
I
MAC k h
 
,then 
I [S]
h
 
. 
 Lemma 2   Suppose
'
2
'
1
k  k
, and 
               
)
,
(
1
'
MAC k1 h
)
,
(
2
'
MAC k2 h
, 
Then 
)
,
(
1
'
MAC k1 h
2h  
Proposition 5  Suppose 
k,k' 
,
S  A
,and every 
s S
 is simple and is not of the form 
, )
(
MAC k' h
 or 
{h}k
.If 
[ ]
, )
(
'
S
I
MAC k h
 
 or 
[ ]
{ }
S
I
h k
 
, then 
k 
 or 
'k 
. 
Proposition 6  Suppose C  is a bundle over A. If m  is 
minimal in
}
( )
:
{
I
C term m
m


, then m is an entry 
point for I . 
Definition 11  A set 
I  A
 is honest relative to a bundle 
C  if and only if whenever a penetrator node p  is an 
entry point for I  , p is an M  node or a K  node. 
Theorem 
1 
 
Suppose 
C
 is 
a 
bundle 
over 
A,
S  T 
,
  
, 
1

 

S
,  Then 
I [S]
 
is honest. 
163
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

 
RN 
UE 
Target  DeNB 
.
.
.
M1,M 2 
.
.
.
.
.
M1, M 3 
M 4,M 5 
M 4,M 6 
Corollary 1  Suppose C is a bundle,
1

 

S
, and 
 
 

S
.If 
[ ]
( )
S
I
term m
 
 for some 
mC
, 
then for some regular node 
nC
, n  is an entry point 
for 
I [S]
. 
Corollary 
2 
 
Suppose 
C
 is 
a 
bundle, 
1

 

S
,
 


S
, and no regular node 
C
 is an entry point for 
I [S]
. Then any term of the 
form
{g}k
 and 
, )
(
MAC k' g
 for 
S
k k
' 
,
 does not 
originate on a penetrator strand. 
B. The Bundle  
We will use extended honest and ideal concept to prove 
the security of our proposed protocol. The goal of this 
protocol is to mutually authenticate hop-by-hop. The bundle 
of our proposal is shown in Figure. 5. 
Figure 5.  Our propose strand space 
M1=
} *
,
1
{
keNB
N UE IDUE
)
||
1
,
(
*
UE
UE
eNB
ID
N
MAC k
  
M2=
lay
k
UE IDUE
N
} Re
,
2
{
)
||
2
,
(
Re
UE
UE
lay
ID
N
MAC k
 
M3=
lay
k
RN
UE
UE
RN
ID
ID
N
N
} Re
,
,
2
,
1
{
, 
)
||
||
2
||
1
,
(
Re
UE
RN
UE
RN
lay
ID
ID
N
N
MAC k
 
M4=
} *
,
,1
1
1 ,
,
{
keNB
UE
T
UE
T
U T
ID
ID
N
N
k


 
)
||
1||
1
1 ||
||
,
(
*
UE
T
UE
T
U T
eNB
ID
ID
N
N
K
MAC k


 
M5=
lay
k
UE
T
RN
T
RN
R T
ID
ID
ID
N
N
k
} Re
,
,
2 ,
,1
1
,
{


 
)
||
||
2 ||
1||
1
||
,
(
Re
UE
T
RN
T
RN
R T
lay
ID
ID
ID
N
N
k
MAC k


 
M6=
lay
k
T
UE
RN
UE
RN
U R
ID
ID
ID
N
N
k
} Re
,
,
,1
2
,
2
,
{


 , 
)
||
||
1||
2
||
2
||
,
(
Re
T
UE
RN
UE
RN
R
U
lay
ID
ID
ID
N
N
k
MAC k


 
Definition 12   An infiltrated strand space 
, )
(  is a 
space if 
is the union of three kinds of strands: 
(1) Penetrator’s strand 
s 
; 
(2)  UE ‘s Strand  
]
,
,
,
,
,
2
1 ,
,
2
,
1
[
R
U
U T
RN
T
UE
RN
T
UE
UE
k
k
ID
ID
ID
N
N
N
UE N
s



      with trace, defined to be: 
<
 M1
,
 M 2
,
 M 4
,
 M 6
> 
    
(3) Relay’s strand 
]
,
,
,
,
,
,
,
2
,
1
2 ,
,
2
[
H G
k
k
ID
ID
ID
N
N
N
RN N
s
R
U
T
R
T
RN
UE
RN
RN
T
UE



  
with trace, defined to be: 
 H,
 M 2
,
 H
,
 M 3
,
 G
,
 M 5
,
 G
,
 M 6
> 
(4) Target DeNB’s Strand 
s 
 Target DeNB 
[
,
1
2 ,
1 ,
,
1
,
,
RN
T
T
UE
R T
U T
N
N
N
N
k
k


 
T
RN
UE
ID
ID
ID
,
,
,H] 
with trace defined to be: 
< 
 H,
 M 3
,
 M 4
,
 M 5
> 
For 




R 
U
R T
U T
k
K
k
,
,
}
,
{
,
,
*
Re
eNB
lay
R
U
R T
U T
k
k
k
K
k




,
1

x
x
k
k
 
 
Proposition 7 The set UE,RN and Target DeNB are disjoint 
each other.  
C. Security Analysis  
We first prove that session keys can not be disclosed 
unless penetrator posses one of the long term keys.  
Theorem 2  suppose C  is a bundle in strand space 

 , 
RN Tname
, session key 
kR T

 are uniquely 
originating ; 


kR T 
; and 
 
RN
s
has C - height 3. 
Let 
}
,
,
{
*
Re
R T
eNB
lay
k
k
k
S


 and
   \ S
 For every 
node
mC
, 
]
[
)
(
kR T
I
term m



. 
PROOF: By proposition 2, it suffices to prove that stronger 
statement that for every node m ,
[ ]
( )
S
I
term m
 
. 
Since
 


S
,
   1
, and 
 S
 

 by 
Corollary 1, It suffices to show that no regular node m  is 
an entry point for
I [S]
. 
164
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

We will argue by contradiction and assume m  is a 
regular node which is an entry point for 
I [S]
. Since m  
is an entry point for 
I [S]
, by the definitions, it follows 
that 
term(m)
 is an element of 
I [S]
. By proposition 2, 
this implies that one of the keys 
R T
eNB
lay
k
k
k

,
,
*
Re
 is a sub 
term of  
term(m)
. Now, no regular node contains any key 
*
Re
,
lay keNB
k
 as a sub-term. In fact, the only session keys 
which occur as sub-terms of 
term(m)
for m  regular, are 
the session keys emanating from the Target DeNB.   If m  
is a positive regular node on a strand s , then 
kR T
  
term(m)
 implies either: 
(1) 

et DeNB
T
s
arg
 and 
2,s
m 
, 
in 
which 
case
kR T
  is the session key; 
(2) 

RN
s
 and 
3,s
m 
 
kR T

H  
In case 2, m  is not an entry point for 
I [S]
, because  H  
 
1,s
 , which is a preceding negative node. So m  is not 
entry point of 
I [S]
. 
So consider case 1. By the unique origination of 
kR T
  , 
et DeNB
ST
s
arg

, so 
term(m)
= M5 or 
term(m)
=M4 
By Proposition 3, either 
1) 
[ ]
}
,
,
2 ,
,1
1
,
{
Re
S
I
ID
ID
ID
N
N
k
lay
k
UE
T
RN
T
RN
T
R




 
2) 
[ ]
}
,
,1
1
1 ,
,
{
*
S
I
ID
ID
N
N
k
keNB
UE
T
UE
T
U T
 


3)   
[ ]
)
||
||
2 ||
||
1
1
||
,
(
Re
S
I
ID
ID
ID
N
N
k
k
MAC
UE
T
RN
T
RN
R T
lay




  
4)
)
||
1||
1
1 ||
||
,
(
*
UE
T
UE
T
U T
eNB
ID
ID
N
N
K
MAC k



I [S]
 
But，the first and the second are impossible. The third 
and the fourth are impossible by   Proposition 5.□ 
Similarly, we can prove that 
kU T
  and 
kU R
  are secure. 
So, we can conclude that session keys can not be disposed. 
Our protocol is secure. 
D. Authetication Analysis 
In this section we will prove the authentication 
guarantees to its UE, RN and Target DeNB. 
Proposition 8 Consider a bundle C  in 
, Suppose 
Target DeNBTname
 and 

*
keNB
. Then no 
term of the form
} *
{
g keNB
,
, )
(
*
g
MAC k
eNB
can originate 
on a penetrator node in C . 
     PROOF: Let 
}
{
*
S  keNB
 and
  
. To apply 
Corollary 2, we must check that no regular node is an 
entry point for
I [S]
, or equivalently, the 
*
keNB
 does 
not originate on any regular node.   
 A key originates on a regular node only if it is a 
session key k  originating on a Target DeNB strand 
et DeNB
T
s
arg
 
 . However, by the definition 
of
 T arget DeNB
, the session key k  is never a long 
term key
*
keNB
. 
 Hence we may apply Corollary 2 to 
I [S]
 , so any 
term 
} *
{
g keNB
,
, )
(
*
g
MAC k
eNB
can only originate on a 
regular node. □ 
 Lemma 3 Consider a bundle C  in 
, Suppose 
RN Tname
 and
kRelayB 
. Then no term of 
the form
k lay
g
{ } Re
,
, )
(
Re
g
MAC k
lay
 can originate 
on a penetrator node inC . 
Proposition 9   
1)   If 
} *
{
H keNB
originates on a regular strand s, then  
If

et DeNB
T
s
arg
,  
then 
UE
T
UE
T
U T
ID
ID
N
N
k
H
||
1||
1
1 ||
||



  
and 
kU T 
 
2)      If 
k lay
H
} Re
{
 originates on a regular strand s, then  
If 

et DeNB
T
s
arg
  then  
UE
T
lay
lay
T
R T
ID
ID
ID
N
N
k
H
||
||
1||
1
2 ||
||
Re
Re



 
 and 
kRT 
 
If 

RN
s
  then  
T
UE
RN
UE
RN
U R
ID
ID
ID
N
N
k
H
||
||
1||
2
||
2
||



  
and 
kU R 
 
3) 
  If 
)
,
(
*
H
MAC k
eNB
 originates on a regular strand 
s  then If 

UE
s
 ,then       
UE
UE
ID
N
H
||
1

           
If 

et DeNB
T
s
arg
 , 
then 
T
UE
UE
T
U T
ID
ID
N
N
k
H
||
1||
1
1 ||
||



 
4) If 
)
,
(
Re
H
MAC k
lay
 originates on a regular strand s  , 
then If 

RN
s
,  
165
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

     
RN
UE
UE
RN
ID
ID
N
N
H
||
||
2
||
1

  
      Or 
T
UE
RN
UE
RN
U R
ID
ID
ID
N
N
k
H
||
||
1||
2
||
2
||



 
(5) If 
)
,
(
Re
H
MAC k
lay
 originates on a regular strand s  , 
then If 

et DeNB
T
s
arg
then  
UE
T
lay
UE
lay
T
R T
ID
ID
ID
N
N
N
k
H
||
||
||
1
2
1||
1
2 ||
||
Re
Re




 
PROOF: By the definition of originating, if the term 
 k
H
originates on m  , then m  is positive . 
     If

et DeNB
T
s
arg
then
2,s
m 
. Thus the encrypted 
subterm 
of 
 
term(m)
 
} *
||
1||
1
1 ||,
,
{
keNB
T
UE
UE
T
U T
ID
ID
N
N
k


is of from (1) 
If the term 
)
( ,
MAC k H
originates on m , then m  is 
positive.  If 

UE
s
 then 
1,s
m 
. The subterm of 
this term is of the form (3). 
If 

RN
s
 , If the term 
)
( ,
MAC k H
originates on 
m , then m  is positive. Then the positive nodes of the s  
is
3,s
m 
  and the sub-term of this term is of the form (4). 
□ 
Corollary 3 Suppose s is a regular strand of 
 
(1) IF 
} *
,
,1
1
1 ,
,
{
keNB
T
UE
UE
T
U T
ID
ID
N
N
k


 originates 
on s , then

et DeNB
T
s
arg
. The term originates on the 
node 
2,s
and 
kU T
   originates on s .  
(2) If 
lay
k
UE
T
RN
T
RN
R T
ID
ID
ID
N
N
k
} Re
,
,
2 ,
,1
1
,
{


 
originates on s  , then 

et DeNB
T
s
arg
 . The term 
originates on the node 
2,s
, and 
kR T
  originates on s .  
(3) If 
lay
k
T
UE
RN
UE
RN
U R
ID
ID
ID
N
N
k
} Re
,
,
,1
2
,
2
,
{


 
originates on s  , then 

RN
s
 , the term originates 
on the node 
3,s
 and 
kU R
  originates on s . 
(4) If 
} *
,
1
{
k eNB
N UE IDUE
 originates on s  ,   then 

UE
s
, then the term 
} *
,
1
{
k eNB
N UE IDUE
 
originates on node 
1,s
 
(5) If 
lay
k
UE IDUE
N
} Re
,
2
{
 originates on s  ,   then 

UE
s
,
lay
k
UE IDUE
N
} Re
,
2
{
 originates on node 
1,s
 
(6) If
)
||
1
,
(
*
UE
UE
eNB
ID
N
MAC k
 originates on s  ,then 

UE
s
, 
)
||
1
,
(
*
UE
UE
eNB
ID
N
MAC k
originates on 
node 
1,s
  
(7) If 
}
||
2
,
(
Re
UE
UE
lay
ID
N
MAC k
 originates 
on 
s  ,then 

UE
s
}
||
2
,
(
Re
UE
UE
lay
ID
N
MAC k
 
originates on node 
1,s
 
(8) If
)
||
||
2
||
1
,
(
Re
UE
RN
UE
RN
lay
ID
ID
N
N
MAC k
 
originates 
on 
s
 ,then 

RN
s
 
)
||
||
2
||
1
,
(
Re
UE
RN
UE
RN
lay
ID
ID
N
N
MAC k
origin
ates on node 
2,s
 
(9) If 
)
||
||
||
2
1||
1
||
,
(
Re
UE
T
RN
T
RN
R T
lay
ID
ID
ID
N
N
k
MAC k


 
originates 
on
s
 , 
then

et DeNB
T
s
arg
 
)
||
||
||
2
1||
1
||
,
(
Re
UE
T
RN
T
RN
R T
lay
ID
ID
ID
N
N
k
MAC k


  
originates on 
2,s
 
 If 
)
||
||
||
1
2
||
2
||
,
(
Re
T
UE
RN
UE
RN
R
U
lay
ID
ID
ID
N
N
k
MAC k


 
originates 
on 
s
 , 
then 

RN
s
, 
the 
)
||
||
||
1
2
||
2
||
,
(
Re
T
UE
RN
UE
RN
R
U
lay
ID
ID
ID
N
N
k
MAC k


 
originates on 
3,s
. 
PROOF: 
Since 
s
 is 
regular, 






et DeNB
T
RN
UE
s
arg
  Apply proposition 9. 
□ 
The following theorem asserts that if a bundle contains a 
strand 

UE
s
then under reasonable assumptions, there 
are regular strand

RN
s
, 

et DeNB
T
s
arg
， Which 
agrees on the UE, RN, Target DeNB 
Theorem 3  Support C  is a bundle in 
; 
RN
et DeNB
T
UE


arg
; 
N UE N UE
2
,
1
 is uniquely 
originating 
in 
C
 ; 
and 
keNB k lay 
* , Re
 If 

UE
s
has C - height 2,  then there are regular strands : 
(1) 

RN
s
of height 3 at least  
166
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

(2) 

et DeNB
T
s
arg
 of height 2 
PROOF:   According to the trace of

UE
s
  
Since 
keNB k lay 
Re
* ,
 , by Lemma 3  
 M 6
 originates 
on a regular node in C . By Corollary 3, this node belongs 
to a strand 

RN
s
  which has C - height 3 at least. 
Since 
keNB k lay 
Re
* ,
 , by Lemma 3,
 M 4
 originates 
on a regular node in C . By Corollary 3, this node belongs 
to a strand 

et DeNB
T
s
arg
 which C - height 2. □ 
  Theorem 4  Support C  is a bundle in 
; 
RN
et DeNB
T
UE


arg
, 
UE
UE
RN
N
N
N
1
,
2
,
1
 are 
uniquely originating in C  ; and 
keNB k lay 
* , Re
 If 

et DeNB
T
s
arg
  has C- height 2 , then there are regular 
strands : 
(1)

RN
s
 of height 2 at least  
(2)

UE
s
 of height  1  at  least 
PROOF:  According to the trace of 

et DeNB
T
s
arg
  
  Since 
keNB k lay 
Re
* ,
 , by lemma 3, 
 M 3
 originates 
on a regular node in C . By Corollary 3 , this node belongs 
to a strand 

RN
s
which C - height 2 at least.  
    Since 
keNB k lay 
Re
* ,
 , by lemma 3 
 M1
 originates 
on a regular node in C  By  Corollary 3, this node belongs 
to a strand 

UE
s
which C - height 1 at least. □ 
Theorem 5 Support C
 is a bundle in 
; 
RN
et DeNB
T
UE


arg
; 
T
RN
UE
N
N
N
1
,
1
,
2
 are 
uniquely originating in C
 ; and 
kRelay 
 If 

RN
s
 has C -height 3 , then there are regular strands : 
(1) 

et DeNB
T
s
arg
 of height 2  
(2)

UE
s
of height 1 at least 
PROOF:  According to the trace of

RN
s
 
Since 
kRelay 
 , by lemma 3,  
 M 5
 originates on a 
regular node inC . By Corollary 3 , this node belongs to a   
strand 
 
et DeNB
T
s
arg
with C - height 2.  Since 
kRelay 
 , by lemma 3, 
 M1
, originates  on a regular 
node in C . By Corollary 3, this node belongsto a strand 

UE
s
 have height 1 at least. □ 
  So we can conclude that UE, RN and Target deNB can 
authenticate each other. 
V. 
PERFORMANCE EVALUATION 
In this section, we will discuss the performance of our 
proposal scheme.  
In the traditional handover scheme, the UE will tear 
down the connection with the Source eNB first. When the 
UE moves into the target cellular, it will establish the 
connection with the Target eNB. The handover messages are 
transmitted from the UE to the Source eNB, then to the 
MME and finally to the serving GW, as in figure 1. UE and 
Target eNB will finish end-to-end authentication using AKA 
protocol.  
But ， in the relay-assisted handover procedure, the 
handover messages are transmitted among the source DeNB, 
RN and Target DeNB. With the help of the RN, the handover 
information does not need to be transmitted on the S1 
interface. The handover delay will be reduced significantly.   
In our extended relay-assisted handover procedure, 
security keys are carried on the handover messages. They are 
protected by the RRC key. Some security keys are 
transmitted to the target DeNB and RN before the handover 
happens.  
With the help of the RN, wireless connection is 
established among the UE, RN and the Target DeNB.  
Before the UE handovers to the target DeNB, Our proposed 
pre-authentication protocol can be executed among the UE, 
RN and Traget DeNB hop-by-hop.  Because this protocol is 
happened before handover, the overhead is not calculated on 
handover delay. When the UE handovers to the target DeNB, 
it does not need to run the AKA protocol from scratch. The 
UE only needs to finish local authentication process with the 
target DeNB. The handover authentication delay will be 
reduced.  
VI. 
CONCLUSION 
Relaying is key technique in future LTE-A network. 
Relay node is introduced to extend coverage and capacity. In 
order to enable relaying, handover procedure, architecture 
and protocol have to be modified. This paper introduced a 
new relay assisted handover mechanism. Handover messages 
are exchanged among UE, RN and DeNB. We consider the 
security issue about the relay-assisted handover procedure. 
Before the UE moves into the target cellular, security 
contexts are transferred on the handover messages to the 
target cellular. With the aid of the relay nodes, the UE 
performs pre-authentication protocol when the UE still 
remain in the source cellular. The UE, RN and Target DeNB 
mutual authenticate using hop-by-hop communications. 
When the UE handovers to the target cellular, it does not 
need to perform end-to-end authentication from scratch. 
Handover authentication delay is reduced significantly. The 
security formal analysis is our main task. We also extend 
traditional strand space including message authentication 
167
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

code. We use the extended ideal and honest idea to prove the 
security of our pre-authentication protocol. But, in this paper, 
we do not discuss the handover delay and loss rate.  In future 
work, we will evaluate the overhead of our scheme using 
simulation and analytical methods.     
ACKNOWLEDGMENT 
This research work is supported by the National Natural 
Science Foundation of China (NSFC) under Grant No. 
60802058, and the SMC young scholar sponsorship of 
Shanghai Jiao Tong University. 
REFERENCES 
  
[1] 
C. Sunghyun, E. W. Jang, and J. M. Cloffi, “Handover in multihop 
Cellular network,” IEEE  Communication Magzine, Vol. 47, pp. 529–
551, July 2009. 
[2] 
O. Teyeb, V. V. Phan, B. Raaf, and D. Redana, “Handover 
framework for relay enhanced LTE networks,” IEEE International 
Conference on communications workshops, pp. 1–5,  June  2009. 
[3] 
The 3GPP draft 36.300, “Evolved Universal Terrestrial Radio Access 
(E-UTRA) and Evolved Universal Terrestrial Radio Access Network 
(E-UTRAN); Overall description; Stage 2”. 
[4] 
The 3GPP draft 33.816, “Feasibility Study on LTE Relay Node 
Security.” 
[5] 
The 3GPP draft 33.401 , “3GPP System Architecture Evolution 
(SAE); Security architecture.” 
[6] 
F. J. Thsyer Fabreqa, J. C. Herzog, and J.  D. Guttman, “Strand 
spaces: Why is a Security Protocol Correct,” proceedings of IEEE 
Symposium on security and Privacy,  pp. 160-171, May 1998. 
[7] 
Y. Li Li, P. Dai Yuan, and G. Yue Xiang, “Analysis and 
Improvement of Sensor Networks Security Protocol,” Journal on 
Communications ,Vol . 32, No. 5, pp. 139–145, May  2011. 
[8] 
 F. J. Thayer Fabreqa, J. C. Herzog, and J. D. Guttman, “Strand 
Spaces: Honest Ideals on Strand spaces,”  Proceedings of the 11th 
IEEE Computer Security Foundations Workshop, pp. 66–77, June 
1998. 
 
, 
168
Copyright (c) IARIA, 2012.     ISBN:  978-1-61208-186-1
ICNS 2012 : The Eighth International Conference on Networking and Services

