Spread Spectrum-Based Underlay Cognitive Radio Wireless Networks
Saed Daoud, David Haccoun, and Christian Cardinal
Department of Electrical Engineering
¬¥Ecole Polytechnique de Montr¬¥eal
Montr¬¥eal, QC, Canada
Email: saed.daoud@polymtl.ca, david.haccoun@polymtl.ca, christian.cardinal@polymtl.ca
Abstract‚ÄîIn this paper, we investigate the performance of
underlay cognitive radio (CR) systems that employ spread
spectrum (SS). In particular, we consider a single-user secondary
(cognitive) system that coexists with a multiple-user primary
system. The quality of service of the primary system is protected
by placing a maximum allowable interference power at the
primary receiver (PR). We Ô¨Årst derive the cumulative distribution
function of the signal-to-interference-plus-noise ratio (SINR) at
the secondary receiver (SR), which is then used to evaluate the
outage probability and average bit error rate (ABER) of the
secondary system. Simulation results veriÔ¨Åed by Monte-Carlo
simulations show that SS-based underlay CR systems outperform
conventional underlay CR systems by adapting the spreading
factor (SF) of the spreading sequences.
Keywords‚ÄîCognitive radio; spread spectrum; outage proba-
bility; average bit error rate.
I. INTRODUCTION
Cognitive radio (CR) is a new promising technology, that
makes an efÔ¨Åcient use of the spectrum, by making the
spectrum access process more dynamic, by adapting the
transmissions‚Äô parameters to the surrounding environment,
as well as to the users‚Äô demands [1]‚Äì[4]. In underlay CR
mode [5], the adaptation is on the transmitted power from
the unlicensed secondary (cognitive) system, such that the
aggregate interference at the licensed primary receiver (PR)
is below a certain threshold.
In [6], the author studied the capacity of underlay (also
called spectrum-sharing) secondary system over additive white
Gaussian noise (AWGN) channels, where the constraint is
placed on the channel output signal, instead of the conven-
tional problem formulation, where the constraint is placed
on the channel input signal, mainly because of hardware
limitation. In [7][8], the capacity of such system is studied over
Rayleigh fading channels under peak and average interference
power constraints placed at the primary receiver. In [9], the
authors consider a multiuser secondary system which coexists
with a primary system with one transmitter-receiver (TX-RX)
pair. They found the outage probability at the best secondary
receiver (SR) in terms of the received signal-to-interference-
plus-noise ratio (SINR). The authors considered the effect
of the primary system on the secondary receiver, which was
something missing in the previously mentioned works.
f Hz
PSD W/Hz
Interference
Threshold
Secondary
Signal
Primary Signal
W
GW
IM
Figure 1. The primary and secondary signals‚Äôs spectra at the PR.
In [10], the authors studied the problem of distributed
frequency spectrum and power allocation and optimization
for multicarrier direct sequence code division multiple access
(MC DS-CDMA) system in an ad hoc setting. They considered
the interweave mode, where the entire available spectrum is
sensed, and only the subcarriers that are not being used are
assigned to the secondary users. The optimization is done with
a target data rate and available power constraints for each
secondary user. In [11], the authors considered code division
channelization, with joint transmit power and code assignment
optimization, such that the interference from the secondary
system to the primary system is considered acceptable, while
SINR at the secondary receiver satisÔ¨Åes a pre-deÔ¨Åned quality
of service (QoS). In [12], the authors proposed a MC CDMA
secondary system that aggregates non contiguous subbands
such that the bandwidth of subbands isn‚Äôt Ô¨Åxed.
In [13], we investigated the performance of a secondary
system when spreading is done by repetition channel coding
as a simple means of spreading. Also, we investigated the
performance when a combination of channel coding and
spread spectrum is used over AWGN channels. In [14],
we investigated the problem of maximizing the throughput
of a secondary system using CDMA under some idealistic
assumptions. In this paper, we consider the coexistence of
a primary system with an underlay secondary system, where
the secondary system is assumed to be using direct sequence
spread spectrum (DS-SS) with a spreading factor (SF) G. See
Figure 1. The primary system consists of multiple primary
transmitters (PTs) and one primary receiver (PR), while the
20
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-551-7
COCORA 2017 : The Seventh International Conference on Advances in Cognitive Radio

secondary system consists of one secondary transmitter (ST)
and one secondary receiver (SR). The performance of the sec-
ondary system in terms of outage probability and average bit
error rate (ABER) is investigated, by taking into account the
effect of the primary system on SR. Simulation results veriÔ¨Åed
by Monte-Carlo simulations show that SS-based CR systems
outperform conventional underlay systems by adapting the
spreading factor (SF) of the spreading sequences, which makes
SS a promising technique to be used in such systems.
PU1
PU2
PUK
PR
SR
ST
hps(1)
hps(2)
hps(K)
hsp
hss
Q
PO,s
Figure 2. System Model. The dashed lines are interference links.
The rest of the paper is organized as follows: In Section II,
the system and channel‚Äôs model are presented, in Section III,
the outage probability and ABER are investigated. In Section
IV, simulation results are provided, and Ô¨Ånally, we conclude
in Section V.
II. SYSTEM AND CHANNEL‚ÄôS MODELS
We consider the coexistence of a multiple primary user (PU)
system with K users and a secondary cognitive system with
one user. See Figure 2. It‚Äôs assumed that all PUs communicate
with one PR, i.e., multiple access uplink communication.
Also, one secondary transmitter (ST) is communicating with
one secondary receiver (SR). ST employs DS-SS with an SF
of G, where we assume that G ‚â• K, while the primary
system is assumed to employ frequency division multiple
access (FDMA) such that there is no interuser interference
(IUI) within the primary system. The channel between PUk
and the SR is denoted by h(k)
ps for k = 1, 2, . . . , K, while
the channels between ST and PR and between ST and SR are
denoted by hsp and hss, respectively. All channels are assumed
to be complex-valued Gaussian random variables with zero
mean and unit variance. To protect the QoS of the primary
system, a maximum interference threshold Q is set at the PR.
PUs are assumed to transmit using a Ô¨Åxed power P, while ST
is assumed to adapt its power such that the interference on PR
is below Q.
III. PERFORMANCE ANALYSIS: OUTAGE PROBABILITY
AND AVERAGE BIT ERROR RATE
In this section, the performance of SS-based underlay CR
system in the presence of multiple-user primary system is
evaluated in terms of outage probability and ABER.
A. Outage Probability
Outage probability of the CR system is deÔ¨Åned as, the
probability that the instantaneous SINR falls below a ceratin
threshold, Œ≥th. Hence, Ô¨Årst, SINR at SR will be quantiÔ¨Åed
mathematically and statistically. The statistics of SINR then
will be used to evaluate the outage probability (and ABER
in the next subsection). Since it is assumed that G ‚â• K, the
SINR at SR is given by
Œìs =
|hss|2 S(hsp)
P
G
K
P
k=1
|h(k)
ps |2 + œÉ2n
,
(1)
where S(hsp) is the transmit power from ST, and œÉ2
n is the
AWGN power. The transmit power S(hsp) must be adjusted
such that the total interference at PR is less than or equal to
the maximum allowable interference power. Mathematically,
we need
1
G|hsp|2S(hsp) ‚â§ Q,
(2)
where the factor 1/G is due to spreading the secondary
signal‚Äôs power over a bandwidth that is G times larger than
the minimum required bandwidth. Since we didn‚Äôt place any
physical power budget on ST, we can set it to its maximum
allowable value, which is given by
S(hsp) = G Q
|hsp|2 .
(3)
Substituting (3) into (1) yields to
Œìs =
|hss|2
|hsp|2 G Œ≥Q
Œ≥P
G
K
P
k=1
|h(k)
ps |2 + 1
,
(4)
where Œ≥Q = Q/œÉ2
n and Œ≥P
= P/œÉ2
n. Having the SINR
expression at SR as in (4), the outage probability at SR can
be expressed as
PO,s =Pr [Œìs ‚â§ Œ≥th]
=Pr
 Œ±1 G Œ≥Q
Œ≥P
G Œ±2 + 1 ‚â§ Œ≥th

,
(5)
where Œ≥th is the threshold below which the system will be in
outage, Œ±1 = |hss|2
|hsp|2 and Œ±2 =
K
P
k=1
|h(k)
ps |2. Let Œ±XY = |hXY |2,
then the CDF of Œ±1 can be expressed as
FŒ±1(x) =Pr
Œ±ss
Œ±sp
‚â§ x

=
Z ‚àû
0
Pr {Œ±ss ‚â§ xŒ≤|Œ±sp = Œ≤} fŒ±sp(Œ≤) dŒ≤,
(6)
where FY (y) and fY (y) are the CDF and probability dis-
tribution function (PDF) of the random variable Y . Since
the channels‚Äô coefÔ¨Åcients are assumed to be complex-valued
Gaussian random variables with zero mean and unit variance,
21
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-551-7
COCORA 2017 : The Seventh International Conference on Advances in Cognitive Radio

the channels‚Äô magnitude squares are exponentially distributed
with unit mean, i.e.,
FŒ±ss(x) =1 ‚àí exp(‚àíx)
(7a)
fŒ±sp(x) = exp(‚àíx).
(7b)
It is straightforward to show that the CDF of the random
variable Œ±1, denoted by FŒ±1(x) to be
FŒ±1(x) = Pr [Œ±1 ‚â§ x] = 1 ‚àí
1
x + 1.
(8)
Also note that Œ±2 is the summation of K squared complex-
valued Gaussian random variables with variance 1/2 per
dimension, i.e., Œ±2 is central Chi-square random variable with
2K degrees of freedom. Thus, its PDF is given by [15]
fŒ±2(Œ±2) =
1
(K ‚àí 1)! Œ±K‚àí1
2
e‚àíŒ±2.
(9)
Then, the outage probability in (5) can be re-written as
PO,s =
Z ‚àû
0
FŒ±1
 Œ≥th
G Œ≥Q
hŒ≥p
G Œ±2 + 1
i
fŒ±2(Œ±2) dŒ±2
=1 ‚àí
1
(K ‚àí 1)! Œ≥thŒ≥P
G2Œ≥Q
Z ‚àû
0
Œ±K‚àí1
2
e‚àíŒ±2
Œ±2 + G2Œ≥Q
Œ≥thŒ≥P
h
Œ≥th
GŒ≥Q + 1
i dŒ±2
|
{z
}
I
,
(10)
where FŒ±i(.) and fŒ±i(.) are the CDF and PDF of the random
variable Œ±i. From [16, eq. 3.353.5], the integral I can be
expressed as
I = (‚àí1)n‚àí1Œ≤neŒ≤¬µEi (‚àíŒ≤¬µ) +
n
X
k=1
(k ‚àí 1)!(‚àíŒ≤)n‚àík¬µ‚àík,
(11)
where n = K ‚àí 1, ¬µ = 1, and Œ≤ = G2Œ≥Q
Œ≥thŒ≥P
h
Œ≥th
GŒ≥Q + 1
i
.
B. Average Bit Error Rate (ABER)
Another useful performance metric is the ABER, which will
be derived next. Toward that end, let
X = Œ±1 G Œ≥Q
Œ≥P
G Œ±2 + 1.
(12)
Without any loss of generality, and for simplicity of expo-
sition, coherent binary phase shift keying (BPSK) is assumed.
In this case, the conditional BER is given by
Œµs(x) =Q
h‚àö
2x
i
‚â§1
2e‚àíx,
(13)
where we used the Chernoff upper bound of the Gaussian Q-
function in the second line of (13). Then the ABER is upper
bounded as
Œµs ‚â§ 1
2
Z ‚àû
0
e‚àíx fX(x) dx
(14)
where fX(x) is the PDF of the random variable X. It can be
shown by integration by parts that
Z ‚àû
0
e‚àíxfX(x) dx =
Z ‚àû
0
e‚àíxFX(x) dx,
(15)
where FX(x) is the CDF of the random variable X. This
implies that we don‚Äôt need to derive the PFD of the random
variable X, but instead, we can use the CDF directly in
evaluating the ABER. The ABER in (14) can be re-written
as
Œµs ‚â§ 1
2
Z ‚àû
0
e‚àíx FX(x) dx.
(16)
The CDF to evaluate the ABER has the same expression as
the outage probability in (10) by replacing Œ≥th with x. The
ABER can be re-written then as
Œµs = 1
2 ‚àí
G2Œ≥Q
2(K ‚àí 1)!Œ≥p
Z ‚àû
0
1
xe‚àíxI(x) dx,
(17)
where
I(x) =(‚àí1)n‚àí1
 G
Œ≥p
+ G2Œ≥Q
xŒ≥p
n
e
G
Œ≥p +
G2Œ≥Q
xŒ≥p Ei

‚àí
 G
Œ≥p
+ G2Œ≥Q
xŒ≥p

+
n
X
k=1
(k ‚àí 1)!

‚àí
 G
Œ≥p
+ G2Œ≥Q
xŒ≥p
n‚àík
,
(18)
where n = K ‚àí 1.
IV. NUMERICAL RESULTS
In this section, numerical evaluation veriÔ¨Åed by Monte-
Carlo simulations are provided for the above mathematical
derivations.
-10
-5
0
5
Œ≥Q [dB]
10-3
10-2
10-1
100
PO,s
Num (G=1)
Sim (G=1)
Num (G=10)
Sim (G=10)
Num (G=50)
Sim (G=50)
Figure 3. Outage probability at SR vs. Œ≥Q [dB] for Œ≥P = 3 dB, Œ≥th = 0
dB, G = {1, 10, 50}, and K = 1.
In Figure 3, outage probability vs. Œ≥Q in [dB] is shown for
single user system (i.e., K = 1), and for G = {1, 10, 50},
Œ≥P = 3 dB, and Œ≥th = 0 dB. Monte-Carlo simulations are
22
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-551-7
COCORA 2017 : The Seventh International Conference on Advances in Cognitive Radio

also shown, where 105 channel realizations were generated for
each Œ≥Q point. Two observations can be made. First, underlay
cognitive radio system that employs spread spectrum (i.e.,
G > 1) has better performance than conventional systems
that don‚Äôt employ SS (i.e., G = 1). This is because of two
reasons, a) by spreading the secondary signal‚Äôs spectrum over
larger bandwidth using spreading sequences, the interference
caused at PR is reduced per unit bandwidth, and that allows
ST to transmit at higher power (see Figure 1), and b) the
interference caused by PT at SR is also reduced, because
depreading the secondary received signal by a synchronized
replica of the spreading sequence has the effect of spreading
the primary signal‚Äôs power over larger bandwidth, and thus its
effect within the secondary signa‚Äôs bandwidth is signiÔ¨Åcantly
reduced, which contributed more to better performance. That
is why the performance as seen in Figure 3 is improved as
G increased. In conventional systems, the secondary system
cannot do anything beyond adapting its power to meet the
interference threshold requirement at PR. Because of this,
secondary systems usually don‚Äôt have enough interference
margin that allows the secondary system to be operational, by
transmitting at an acceptable power level. On the other hand,
in SS-based underlay CR systems, SF G can be adapted such
that the interference threshold at PR is met, and making the
secondary system operational. The second observation is that,
Monte-Carlo simulations are in agreement with the numerical
evaluation, which implies that our mathematical derivations
are correct.
In Figure 4, outage probability vs. Œ≥Q in [dB] is shown
for multiple primary user system for K
=
5, and for
G = {10, 50} (note that we didn‚Äôt include G = 1 for non
SS systems, because it is assumed that G ‚â• K, such that
the effect of the secondary system is the same for all primary
users), Œ≥P = 3 dB, and Œ≥th = 0 dB. Monte-Carlo simulations
are also shown, where 105 channel realizations were generated
for each Œ≥Q point. The same observations as before can be
made.
In Figure 5, outage probability vs. Œ≥Q [dB] is shown for
K = {1, 5, 10}, G = 50, Œ≥p = 10 dB, and Œ≥th = 5 dB.
In this case, when G is Ô¨Åxed, and K is variable, we note
that, as K is increased, the performance deteriorates. Which
is expected, because, although the primary signals‚Äô power are
despread at SR, the interference from the primary system at
SR is the sum of the interference from all primary users. We
notice that, the difference in performance as K is increased
is not signiÔ¨Åcant. Maybe this due to that fact that G is large
enough to make the interference from the primary system to be
small, and in the limit when G ‚Üí ‚àû, the system performance
approaches that of point-to-point system with no interference.
In Figure 6, ABER vs. Œ≥Q [dB] is shown for K = 2
users, and G = {10, 100}. The corresponding Monte-Carlo
simulation curves are shown as well. It can be observed that
there is an error Ô¨Çoor. This is due to the fact that, although the
primary signals are spread at the SR, the interference is the
sum of the primary spread signals. However, as G is increased,
-10
-5
0
5
Œ≥Q [dB]
10-3
10-2
10-1
100
PO,s
Num (G=10)
Sim (G=10)
Num (G=50)
Sim (G=50)
Figure 4. Outage probability at SR vs. Œ≥Q [dB] for Œ≥P = 3 dB, Œ≥th = 0
dB, G = {10, 50}, and K = 5.
-10
-5
0
5
Œ≥Q [dB]
10-2
10-1
100
PO,s
Num (Np=1)
Sim (Np=1)
Num (Np=5)
Sim (Np=5)
Num (Np=10)
Sim (Np=10)
Figure 5. Outage probability at SR vs. Œ≥Q [dB] for Œ≥P = 10 dB, Œ≥th = 5
dB, G = 50, and K = {1, 5, 10}.
the performance is improved, which is again attributed to the
fact that the interference level from each PU is decreased
within the secondary signal‚Äôs bandwidth of interest. We can
also observe that there is a small constant difference between
the numerical evaluation and Monte-Carlo simulations, which
we believe is due to an inherit error in the numerical evaluation
of the integral (17).
V. CONCLUSIONS AND FUTURE WORK
In this paper, we considered SS-based underlay cognitive
radio systems, and the performance of such systems was
evaluated. In particular, Ô¨Årst the CDF of the SINR at SR was
derived, which was then used to evaluate the outage probability
and ABER of the secondary system. Numerical results veriÔ¨Åed
by Monte-Carlo simulations showed that, deploying SS in
23
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-551-7
COCORA 2017 : The Seventh International Conference on Advances in Cognitive Radio

0
0.5
1
1.5
2
2.5
3
3.5
Œ≥Q [dB]
10-3
10-2
10-1
100
ABERs
G=10: Num.
G=10: Sim.
G=100: Num.
G=100: Sim
Figure 6. ABER vs. Œ≥Q [dB] for Œ≥P = 5 dB, G = [10 100], and K = 2.
underlay CR systems, can improve the performance signiÔ¨Å-
cantly compared to non-SS underlay CR systems. This study
showed that underlay CR systems can be considered a viable
option besides the interweave mode, because a limiting factor
in underlay systems was that the transmit power is too low for
the secondary system to be operational. Spread spectrum can
alleviate this limitation.
As a future work, we will consider the case when both the
primary and secondary systems consist of multiple users. Fur-
thermore, the effect of channel estimation and synchronization
for the spreading sequences will be considered.
REFERENCES
[1] J. Ma, G. Li, and B. H. Juang, ‚ÄúSignal processing in cognitive radio,‚Äù
Proc. IEEE, vol. 97, no. 5, pp. 805‚Äì823, May 2009.
[2] M.
Buddhikot,
‚ÄúUnderstanding
dynamic
spectrum
access:
Mod-
els,taxonomy and challenges,‚Äù in 2nd IEEE International Symposium on
New Frontiers in Dynamic Spectrum Access Networks, 2007. DySPAN
2007., April 2007, pp. 649‚Äì663.
[3] S. Haykin, D. Thomson, and J. Reed, ‚ÄúSpectrum sensing for cognitive
radio,‚Äù Proc. IEEE, vol. 97, no. 5, pp. 849‚Äì877, May 2009.
[4] Q. Zhao and B. Sadler, ‚ÄúA survey of dynamic spectrum access,‚Äù IEEE
Signal Processing Mag., vol. 24, no. 3, pp. 79‚Äì89, May 2007.
[5] A. Goldsmith, S. Jafar, I. Maric, and S. Srinivasa, ‚ÄúBreaking spectrum
gridlock with cognitive radios: An information theoretic perspective,‚Äù
Proc. IEEE, vol. 97, no. 5, pp. 894‚Äì914, May 2009.
[6] M. Gastpar, ‚ÄúOn capacity under receive and spatial spectrum-sharing
constraints,‚Äù IEEE Trans. Inform. Theory, vol. 53, no. 2, pp. 471‚Äì487,
Feb. 2007.
[7] A. Ghasemi and E. S. Sousa, ‚ÄúFundamental limits of spectrum-sharing
in fading environments,‚Äù vol. 6, no. 2, pp. 649‚Äì658, Feb 2007.
[8] L. Musavian and S. Aissa, ‚ÄúCapacity and power allocation for spectrum-
sharing communications in fading channels,‚Äù IEEE Trans. Commun.,
vol. 8, no. 1, pp. 148‚Äì156, Jan 2009.
[9] C. Kabiri, H. J. Zepernick, and H. Tran, ‚ÄúOutage probability and ergodic
capacity of underlay cognitive radio systems with adaptive power
transmission,‚Äù in 2013 9th International Wireless Communications and
Mobile Computing Conference (IWCMC), vol. 2, 2013, pp. 785‚Äì790.
[10] Q. Qu, L. B. Milstein, and D. R. Vaman, ‚ÄúCognitive radio based multi-
user resource allocation in mobile ad hoc networks using multi-carrier
CDMA modulation,‚Äù IEEE J. Select. Areas Commun., vol. 26, no. 1, pp.
70‚Äì82, 2008.
[11] M. Li et al., ‚ÄúCognitive code-division links with blind primary-system
identiÔ¨Åcation,‚Äù IEEE Trans. Wireless Commun., vol. 10, no. 11, pp.
3743‚Äì3753, Nov. 2011.
[12] A. Attar, M. R. Nakhai, and A. H. Aghvami, ‚ÄúSequence design for cog-
nitive cdma communications under arbitrary spectrum hole constraint,‚Äù
IEEE Trans. Wireless Commun., vol. 7, no. 4, pp. 1157‚Äì1162, 2008.
[13] S. Daoud, D. Haccoun, and C. Cardinal, ‚ÄúUnderlay cognitive radio
wireless networks using repetition coding and spread spectrum,‚Äù in
The Sixth International Conference on Advances in Cognitive Radio,
COCORA 2016, Lisbon, Portugal. Feb. 2016. (Best paper award).
[14] ‚Äî‚Äî, ‚ÄúOn the achievable rate and average sum capacity of spread spec-
trum underlay cr networks,‚Äù in 2016 IEEE 84th Vehicular Technology
Conference: VTC2016-Fall, Montreal, Canada. Sept. 2016.
[15] J. Proakis, Digital Communications, 4th ed.
McGraw-Hill, 2000.
[16] I. S. Gradshteyn and I. M. Ryzhik, Table of Integrals, Series, and
Products, sixth edition ed.
San Diego, CA: Academic Press, 2000.
24
Copyright (c) IARIA, 2017.     ISBN:  978-1-61208-551-7
COCORA 2017 : The Seventh International Conference on Advances in Cognitive Radio

